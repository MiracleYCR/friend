var __defProp=Object.defineProperty,__defProps=Object.defineProperties,__getOwnPropDescs=Object.getOwnPropertyDescriptors,__getOwnPropSymbols=Object.getOwnPropertySymbols,__hasOwnProp=Object.prototype.hasOwnProperty,__propIsEnum=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?__defProp(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))__hasOwnProp.call(t,n)&&__defNormalProp(e,n,t[n]);if(__getOwnPropSymbols)for(var n of __getOwnPropSymbols(t))__propIsEnum.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__spreadProps=(e,t)=>__defProps(e,__getOwnPropDescs(t)),__objRest=(e,t)=>{var n={};for(var o in e)__hasOwnProp.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&__getOwnPropSymbols)for(var o of __getOwnPropSymbols(e))t.indexOf(o)<0&&__propIsEnum.call(e,o)&&(n[o]=e[o]);return n},__publicField=(e,t,n)=>(__defNormalProp(e,"symbol"!=typeof t?t+"":t,n),n),__async=(e,t,n)=>new Promise(((o,a)=>{var i=e=>{try{s(n.next(e))}catch(t){a(t)}},r=e=>{try{s(n.throw(e))}catch(t){a(t)}},s=e=>e.done?o(e.value):Promise.resolve(e.value).then(i,r);s((n=n.apply(e,t)).next())}));if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const t=this.constructor;return this.then((n=>t.resolve(e()).then((()=>n))),(n=>t.resolve(e()).then((()=>{throw n}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";var t,n,o,a,i,r,s,l,c,u;function d(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const n in e)if("default"!==n){const o=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,o.get?o:{enumerable:!0,get:()=>e[n]})}return t.default=e,Object.freeze(t)}function p(e,t){for(var n=0;n<t.length;n++){const o=t[n];if("string"!=typeof o&&!Array.isArray(o))for(const t in o)if("default"!==t&&!(t in e)){const n=Object.getOwnPropertyDescriptor(o,t);n&&Object.defineProperty(e,t,n.get?n:{enumerable:!0,get:()=>o[t]})}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const h=d(e);class f{constructor(e){this._reject=null,this.promise=new Promise(((t,n)=>{e(t,n),this._reject=n}))}abort(e){this._reject&&this._reject(e)}then(e,t){return this.promise.then(e,t)}catch(e){return this.promise.catch(e)}}function g(){return m()+m()+m()+m()+m()+m()+m()+m()}function m(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}function v(e){return Number.isNaN(Number(e))?`${e}`:`${e}px`}function _(e){return"[object Object]"===Object.prototype.toString.call(e)||"object"==typeof e}function y(e){const t=Object.prototype.toString.call(e).match(/\[object (\w+)\]/);return t&&t.length?t[1].toLowerCase():""}const I=function(e,t){const n=(null==t?void 0:t.labelKey)||"value";return Array.isArray(e)?e.map((e=>e[n])).join(", "):e[n]},C=e=>null!=e,k=(e,t="value")=>{if(e<0)throw new Error(`${t} shouldn't be less than zero`)};function E(e,t,n){const o=(e<<16|t<<8|n).toString(16);return"#"+"0".repeat(Math.max(0,6-o.length))+o}function T(e){const t=[];for(let n=1;n<7;n+=2)t.push(parseInt("0x"+e.slice(n,n+2),16));return t}const S=(e,t,n)=>Math.min(Math.max(e,t),n),M=(e,t)=>{if(e===t)return!0;if(!Array.isArray(e)||!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0},w=(e,t=2)=>{let n=e.toString();for(;n.length<t;)n="0"+n;return n},b={id:1e3};function D(e,t,n,o){return new Promise(((o,a)=>{let i=null;i=n?uni.createSelectorQuery().in(n):uni.createSelectorQuery();const r=e=>{t&&N(e)&&e.length>0||!t&&e?o(e):a(new Error("No nodes found"))};i[t?"selectAll":"select"](e).boundingClientRect(r).exec()}))}function N(e){return"function"==typeof Array.isArray?Array.isArray(e):"[object Array]"===Object.prototype.toString.call(e)}function R(e){return"function"===y(e)||"asyncfunction"===y(e)}function L(e){return"string"===y(e)}function A(e){return"number"===y(e)}function O(e){return!(!_(e)||!C(e))&&(R(e.then)&&R(e.catch))}function P(e){return N(e)?e.filter((function(e){return null!=e&&""!==e})).map((function(e){return P(e)})).join(";"):L(e)?e:_(e)?Object.keys(e).filter((function(t){return null!=e[t]&&""!==e[t]})).map((function(t){return[(n=t,n.replace(/[A-Z]/g,(function(e){return"-"+e})).toLowerCase()),e[t]].join(":");var n})).join(";"):""}const U=(e=1e3/30)=>new f((t=>{const n=setTimeout((()=>{clearTimeout(n),t(!0)}),e)}));function x(e,t=new Map){if(null===e||"object"!=typeof e)return e;if(z(e))return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e.source,e.flags);if(e instanceof Error){const t=new Error(e.message);return t.stack=e.stack,t}if(t.has(e))return t.get(e);const n=Array.isArray(e)?[]:{};t.set(e,n);for(const o in e)Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=x(e[o],t));return n}function V(e,t){if("object"!=typeof(e=x(e))||"object"!=typeof t)throw new Error("Both target and source must be objects.");for(const n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}function B(e,t){return Object.keys(t).forEach((n=>{const o=e[n],a=t[n];_(o)&&_(a)?B(o,a):e[n]=a})),e}function G(e,t,n={}){let o,a,i,r=null;const s=!!C(n.leading)&&n.leading,l=!C(n.trailing)||n.trailing;function c(){void 0!==o&&(i=e.apply(a,o),o=void 0)}function u(){r=setTimeout((()=>{r=null,l&&c()}),t)}return function(...e){return o=e,a=this,null===r?(s&&c(),u()):l&&(null!==r&&(clearTimeout(r),r=null),u()),i}}const F=(e,t)=>{const n=t.split(".");try{return n.reduce(((e,t)=>null!=e?e[t]:void 0),e)}catch(o){return}},z=e=>"[object Date]"===Object.prototype.toString.call(e)&&!Number.isNaN(e.getTime());function H(e){return/\.(mp4|mpg|mpeg|dat|asf|avi|rm|rmvb|mov|wmv|flv|mkv|video)/i.test(e)}function j(e){return/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg|image)/i.test(e)}const q=[Number,String],K=e=>({type:e,required:!0}),Y=()=>({type:Array,default:()=>[]}),$=e=>({type:Boolean,default:e}),W=e=>({type:Number,default:e}),Z=e=>({type:q,default:e}),J=e=>({type:String,default:e}),X={customStyle:J(""),customClass:J("")},Q=__spreadProps(__spreadValues({},X),{customImage:J(""),src:String,round:$(!1),mode:J("scaleToFill"),lazyLoad:$(!1),width:q,height:q,radius:q,enablePreview:$(!1),showMenuByLongpress:$(!1)}),ee=(e,t)=>{const n=e.__vccOpts||e;for(const[o,a]of t)n[o]=a;return n},te=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-img",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Q,emits:["error","click","load"],setup(t,{emit:n}){const o=t,a=n,i=e.computed((()=>{const e={};return C(o.height)&&(e.height=v(o.height)),C(o.width)&&(e.width=v(o.width)),C(o.radius)&&(e["border-radius"]=v(o.radius),e.overflow="hidden"),`${P(e)};${o.customStyle}`})),r=e.computed((()=>`wd-img  ${o.round?"is-round":""} ${o.customClass}`)),s=e.ref("loading");function l(e){s.value="error",a("error",e)}function c(e){o.enablePreview&&o.src&&"success"==s.value&&uni.previewImage({urls:[o.src]}),a("click",e)}function u(e){s.value="success",a("load",e)}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(r.value),onClick:c,style:e.normalizeStyle(i.value)},[e.createElementVNode("image",{class:e.normalizeClass(`wd-img__image ${t.customImage}`),style:e.normalizeStyle("success"!==s.value?"width: 0;height: 0;":""),src:t.src,mode:t.mode,"show-menu-by-longpress":t.showMenuByLongpress,"lazy-load":t.lazyLoad,onLoad:u,onError:l},null,46,["src","mode","show-menu-by-longpress","lazy-load"]),"loading"===s.value?e.renderSlot(t.$slots,"loading",{key:0},void 0,!0):e.createCommentVNode("",!0),"error"===s.value?e.renderSlot(t.$slots,"error",{key:1},void 0,!0):e.createCommentVNode("",!0)],6))}})),[["__scopeId","data-v-f297d41f"]]);function ne(e){return weex.requireModule(e)}function oe(e,t,...n){uni.__log__&&uni.__log__(e,t,...n)}function ae(e,t){return"string"==typeof e?t:e}const ie=t=>(n,o=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(t,n,o)},re=ie("onShow"),se=ie("onHide"),le=ie("onLaunch"),ce=ie("onLoad"),ue=ie("onReady"),de=ie("onUnload"),pe=ie("onNavigationBarButtonTap"),he=__spreadProps(__spreadValues({},X),{type:J("default"),text:Z(""),size:J(""),mode:J("text"),decoration:J("none"),call:$(!1),bold:$(!1),format:$(!1),color:J(""),prefix:String,suffix:String,lines:Number,lineHeight:J(""),customStyle:J(""),customClass:J("")});class fe{constructor(e){this.utc=!1;const t=this.parseConfig(e);this.date=new Date(t),this.timeZone=this.date.getTimezoneOffset()/60,this.timeZoneString=this.padNumber(String(-1*this.timeZone).replace(/^(.)?(\d)/,"$10$200"),5,"+"),this.mYear=this.date.getFullYear(),this.mMonth=this.date.getMonth(),this.mDay=this.date.getDate(),this.mWeek=this.date.getDay(),this.mHour=this.date.getHours(),this.mMinute=this.date.getMinutes(),this.mSecond=this.date.getSeconds()}parseConfig(e){return e?z(e)?e:/^(\d){8}$/.test(e)?(this.utc=!0,`${e.substr(0,4)}-${e.substr(4,2)}-${e.substr(6,2)}`):e:new Date}padNumber(e,t,n){return!e||e.length>=t?e:`${Array(t+1-e.length).join(n)}${e}`}year(){return this.mYear}month(){return this.mMonth}unix(){const e=this.utc?60*this.timeZone*60*1e3:0;return Math.floor((this.date.getTime()+e)/1e3)}toString(){return this.date.toUTCString()}startOf(e){switch(e){case"year":return new fe(new Date(this.year(),0,1));case"month":return new fe(new Date(this.year(),this.month(),1));default:return this}}add(e,t){let n;switch(t){case"m":case"minutes":n=60;break;case"h":case"hours":n=3600;break;case"d":case"days":n=86400;break;case"w":case"weeks":n=604800;break;default:n=1}const o=this.unix()+e*n;return new fe(1e3*o)}subtract(e,t){return this.add(-1*e,t)}format(e="YYYY-MM-DDTHH:mm:ssZ"){const t=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];return e.replace(/Y{2,4}|M{1,2}|D{1,2}|d{1,4}|H{1,2}|m{1,2}|s{1,2}|Z{1,2}/g,(e=>{switch(e){case"YY":return String(this.mYear).slice(-2);case"YYYY":return String(this.mYear);case"M":return String(this.mMonth+1);case"MM":return this.padNumber(String(this.mMonth+1),2,"0");case"D":return String(this.mDay);case"DD":return this.padNumber(String(this.mDay),2,"0");case"d":return String(this.mWeek);case"dddd":return t[this.mWeek];case"H":return String(this.mHour);case"HH":return this.padNumber(String(this.mHour),2,"0");case"m":return String(this.mMinute);case"mm":return this.padNumber(String(this.mMinute),2,"0");case"s":return String(this.mSecond);case"ss":return this.padNumber(String(this.mSecond),2,"0");case"Z":return`${this.timeZoneString.slice(0,-2)}:00`;case"ZZ":return this.timeZoneString;default:return e}}))}}function ge(e){return new fe(e)}const me=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-text",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:he,emits:["click"],setup(t,{emit:n}){const o=t,a=n,i=e.ref("");e.watch((()=>({type:o.type,text:o.text,mode:o.mode,color:o.color,bold:o.bold,lines:o.lines,format:o.format})),(({type:e})=>{e&&["primary","error","warning","success","default"].includes(e),function(){const{type:e,color:t,bold:n,lines:a}=o,r=[];t||r.push(`is-${e}`);C(a)&&r.push(`is-lines-${a}`);n&&r.push("is-bold"),i.value=r.join(" ")}()}),{deep:!0,immediate:!0});const r=e.computed((()=>`wd-text ${o.customClass} ${i.value}`)),s=e.computed((()=>{const e={};return o.color&&(e.color=o.color),o.size&&(e["font-size"]=`${o.size}`),o.lineHeight&&(e["line-height"]=`${o.lineHeight}`),o.decoration&&(e["text-decoration"]=`${o.decoration}`),`${P(e)};${o.customStyle}`}));const l=e.computed((()=>{const{text:e,mode:t,format:n}=o;return"date"===t?ge(Number(e)).format("YYYY-MM-DD"):"price"===t?function(e){const t=(e=Number(e).toFixed(2)).split(".");let n=t[0];const o=t.length>1?"."+t[1]:"",a=/(\d+)(\d{3})/;for(;a.test(n);)n=n.replace(a,"$1,$2");return n+o}(e):function(e,t,n){if(t){if("phone"===n)return e.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2");if("name"===n)return e.replace(/^(.).*(.)$/,"$1**$2");throw new Error("mode must be one of phone or name for encryption")}return e}(`${e}`,n,t)}));function c(e){a("click",e)}return(t,n)=>(e.openBlock(),e.createElementBlock("text",{onClick:c,class:e.normalizeClass(r.value),style:e.normalizeStyle(s.value)},[t.$slots.prefix||t.prefix?e.renderSlot(t.$slots,"prefix",{key:0},(()=>[e.createTextVNode(e.toDisplayString(t.prefix),1)]),!0):e.createCommentVNode("",!0),e.createElementVNode("text",null,e.toDisplayString(l.value),1),t.$slots.suffix||t.suffix?e.renderSlot(t.$slots,"suffix",{key:1},(()=>[e.createTextVNode(e.toDisplayString(t.suffix),1)]),!0):e.createCommentVNode("",!0)],6))}})),[["__scopeId","data-v-4c80c9a8"]]),ve=__spreadProps(__spreadValues({},X),{name:K(String),color:String,size:String,classPrefix:J("wd-icon")}),_e=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-icon",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:ve,emits:["click","touch"],setup(t,{emit:n}){const o=t,a=n,i=e.computed((()=>C(o.name)&&j(o.name))),r=e.computed((()=>{const e=o.classPrefix;return`${e} ${o.customClass} ${i.value?"wd-icon--image":e+"-"+o.name}`})),s=e.computed((()=>{const e={};return o.color&&(e.color=o.color),o.size&&(e["font-size"]=v(o.size)),`${P(e)}; ${o.customStyle}`}));function l(e){a("click",e)}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{onClick:l,class:e.normalizeClass(r.value),style:e.normalizeStyle(s.value)},[i.value?(e.openBlock(),e.createElementBlock("image",{key:0,class:"wd-icon__image",src:t.name},null,8,["src"])):e.createCommentVNode("",!0)],6))}})),[["__scopeId","data-v-16dab615"]]),ye=[..."ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"],Ie=e=>e.replace(/[+/]/g,(e=>"+"===e?"-":"_")).replace(/=+\$/m,""),Ce="function"==typeof btoa?e=>btoa(e):e=>{if(e.charCodeAt(0)>255)throw new RangeError("The string contains invalid characters.");return((e,t=!1)=>{let n="";for(let o=0,a=e.length;o<a;o+=3){const[t,a,i]=[e[o],e[o+1],e[o+2]],r=t<<16|a<<8|i;n+=ye[r>>>18],n+=ye[r>>>12&63],n+=void 0!==a?ye[r>>>6&63]:"=",n+=void 0!==i?ye[63&r]:"="}return t?Ie(n):n})(Uint8Array.from(e,(e=>e.charCodeAt(0))))};function ke(e,t=!1){const n=Ce((e=>unescape(encodeURIComponent(e)))(e));return t?Ie(n):n}const Ee=__spreadProps(__spreadValues({},X),{plain:$(!1),round:$(!0),disabled:$(!1),hairline:$(!1),block:$(!1),type:J("primary"),size:J("medium"),icon:String,classPrefix:J("wd-icon"),loading:$(!1),loadingColor:String,openType:String,hoverStopPropagation:Boolean,lang:String,sessionFrom:String,sendMessageTitle:String,sendMessagePath:String,sendMessageImg:String,appParameter:String,showMessageCard:Boolean,buttonId:String,scope:String}),Te=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-button",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Ee,emits:["click","getuserinfo","contact","getphonenumber","error","launchapp","opensetting","chooseavatar","agreeprivacyauthorization"],setup(t,{emit:n}){const o=t,a=n,i=e.ref(20),r=e.ref(70),s=e.ref(""),l=e.computed((()=>`background-image: url(${s.value});`));function c(e){o.disabled||o.loading||a("click",e)}function u(e){"phoneNumber"===o.scope?h(e):"userInfo"===o.scope&&d(e)}function d(e){a("getuserinfo",e.detail)}function p(e){a("contact",e.detail)}function h(e){a("getphonenumber",e.detail)}function f(e){a("error",e.detail)}function g(e){a("launchapp",e.detail)}function m(e){a("opensetting",e.detail)}function v(e){a("chooseavatar",e.detail)}function _(e){a("agreeprivacyauthorization",e.detail)}return e.watch((()=>o.loading),(()=>{!function(){const{loadingColor:e,type:t,plain:n}=o;let a=e;if(!a)switch(t){case"primary":a="#4D80F0";break;case"success":a="#34d19d";break;case"info":case"default":a="#333";break;case"warning":a="#f0883a";break;case"error":a="#fa4350"}const i=((e="#4D80F0",t=!0)=>`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><defs><linearGradient x1="100%" y1="0%" x2="0%" y2="0%" id="a"><stop stop-color="${t?e:"#fff"}" offset="0%" stop-opacity="0"/><stop stop-color="${t?e:"#fff"}" offset="100%"/></linearGradient></defs><g fill="none" fill-rule="evenodd"><path d="M21 1c11.046 0 20 8.954 20 20s-8.954 20-20 20S1 32.046 1 21 9.954 1 21 1zm0 7C13.82 8 8 13.82 8 21s5.82 13 13 13 13-5.82 13-13S28.18 8 21 8z" fill="${t?"#fff":e}"/><path d="M4.599 21c0 9.044 7.332 16.376 16.376 16.376 9.045 0 16.376-7.332 16.376-16.376" stroke="url(#a)" stroke-width="3.5" stroke-linecap="round"/></g></svg>`)(a,!n);s.value=`"data:image/svg+xml;base64,${ke(i)}"`}()}),{deep:!0,immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("button",{id:t.buttonId,"hover-class":""+(t.disabled||t.loading?"":"wd-button--active"),style:e.normalizeStyle(t.customStyle),class:e.normalizeClass(["wd-button","is-"+t.type,"is-"+t.size,t.round?"is-round":"",t.hairline?"is-hairline":"",t.plain?"is-plain":"",t.disabled?"is-disabled":"",t.block?"is-block":"",t.loading?"is-loading":"",t.customClass]),"hover-start-time":i.value,"hover-stay-time":r.value,"open-type":t.disabled||t.loading?void 0:t.openType,"send-message-title":t.sendMessageTitle,"send-message-path":t.sendMessagePath,"send-message-img":t.sendMessageImg,"app-parameter":t.appParameter,"show-message-card":t.showMessageCard,"session-from":t.sessionFrom,lang:t.lang,"hover-stop-propagation":t.hoverStopPropagation,scope:t.scope,onClick:c,"on:getAuthorize":u,onGetuserinfo:d,onContact:p,onGetphonenumber:h,onError:f,onLaunchapp:g,onOpensetting:m,onChooseavatar:v,onAgreeprivacyauthorization:_},[e.createElementVNode("view",{class:"wd-button__content"},[t.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-button__loading"},[e.createElementVNode("view",{class:"wd-button__loading-svg",style:e.normalizeStyle(l.value)},null,4)])):t.icon?(e.openBlock(),e.createBlock(_e,{key:1,"custom-class":"wd-button__icon",name:t.icon,classPrefix:t.classPrefix},null,8,["name","classPrefix"])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-button__text"},[e.renderSlot(t.$slots,"default",{},void 0,!0)])])],46,["id","hover-class","hover-start-time","hover-stay-time","open-type","send-message-title","send-message-path","send-message-img","app-parameter","show-message-card","session-from","lang","hover-stop-propagation","scope"]))}})),[["__scopeId","data-v-7f9ef195"]]);
/*!
    * pinia v2.0.36
    * (c) 2023 Eduardo San Martin Morote
    * @license MIT
    */
let Se;const Me=e=>Se=e,we=Symbol();function be(e){return e&&"object"==typeof e&&"[object Object]"===Object.prototype.toString.call(e)&&"function"!=typeof e.toJSON}var De,Ne;(Ne=De||(De={})).direct="direct",Ne.patchObject="patch object",Ne.patchFunction="patch function";const Re=()=>{};function Le(t,n,o,a=Re){t.push(n);const i=()=>{const e=t.indexOf(n);e>-1&&(t.splice(e,1),a())};return!o&&e.getCurrentScope()&&e.onScopeDispose(i),i}function Ae(e,...t){e.slice().forEach((e=>{e(...t)}))}function Oe(t,n){t instanceof Map&&n instanceof Map&&n.forEach(((e,n)=>t.set(n,e))),t instanceof Set&&n instanceof Set&&n.forEach(t.add,t);for(const o in n){if(!n.hasOwnProperty(o))continue;const a=n[o],i=t[o];be(i)&&be(a)&&t.hasOwnProperty(o)&&!e.isRef(a)&&!e.isReactive(a)?t[o]=Oe(i,a):t[o]=a}return t}const Pe=Symbol();const{assign:Ue}=Object;function xe(t,n,o={},a,i,r){let s;const l=Ue({actions:{}},o),c={deep:!0};let u,d,p,h=e.markRaw([]),f=e.markRaw([]);const g=a.state.value[t];let m;function v(n){let o;u=d=!1,"function"==typeof n?(n(a.state.value[t]),o={type:De.patchFunction,storeId:t,events:p}):(Oe(a.state.value[t],n),o={type:De.patchObject,payload:n,storeId:t,events:p});const i=m=Symbol();e.nextTick().then((()=>{m===i&&(u=!0)})),d=!0,Ae(h,o,a.state.value[t])}r||g||(a.state.value[t]={}),e.ref({});const _=r?function(){const{state:e}=o,t=e?e():{};this.$patch((e=>{Ue(e,t)}))}:Re;function y(e,n){return function(){Me(a);const o=Array.from(arguments),i=[],r=[];let s;Ae(f,{args:o,name:e,store:C,after:function(e){i.push(e)},onError:function(e){r.push(e)}});try{s=n.apply(this&&this.$id===t?this:C,o)}catch(l){throw Ae(r,l),l}return s instanceof Promise?s.then((e=>(Ae(i,e),e))).catch((e=>(Ae(r,e),Promise.reject(e)))):(Ae(i,s),s)}}const I={_p:a,$id:t,$onAction:Le.bind(null,f),$patch:v,$reset:_,$subscribe(n,o={}){const i=Le(h,n,o.detached,(()=>r())),r=s.run((()=>e.watch((()=>a.state.value[t]),(e=>{("sync"===o.flush?d:u)&&n({storeId:t,type:De.direct,events:p},e)}),Ue({},c,o))));return i},$dispose:function(){s.stop(),h=[],f=[],a._s.delete(t)}},C=e.reactive(I);a._s.set(t,C);const k=a._e.run((()=>(s=e.effectScope(),s.run((()=>n())))));for(const S in k){const n=k[S];if(e.isRef(n)&&(T=n,!e.isRef(T)||!T.effect)||e.isReactive(n))r||(!g||be(E=n)&&E.hasOwnProperty(Pe)||(e.isRef(n)?n.value=g[S]:Oe(n,g[S])),a.state.value[t][S]=n);else if("function"==typeof n){const e=y(S,n);k[S]=e,l.actions[S]=n}}var E,T;return Ue(C,k),Ue(e.toRaw(C),k),Object.defineProperty(C,"$state",{get:()=>a.state.value[t],set:e=>{v((t=>{Ue(t,e)}))}}),a._p.forEach((e=>{Ue(C,s.run((()=>e({store:C,app:a._a,pinia:a,options:l}))))})),g&&r&&o.hydrate&&o.hydrate(C.$state,g),u=!0,d=!0,C}function Ve(t,n,o){let a,i;const r="function"==typeof n;function s(t,o){const s=e.getCurrentInstance();(t=t||s&&e.inject(we,null))&&Me(t),(t=Se)._s.has(a)||(r?xe(a,n,i,t):function(t,n,o){const{state:a,actions:i,getters:r}=n,s=o.state.value[t];let l;l=xe(t,(function(){s||(o.state.value[t]=a?a():{});const n=e.toRefs(o.state.value[t]);return Ue(n,i,Object.keys(r||{}).reduce(((n,a)=>(n[a]=e.markRaw(e.computed((()=>{Me(o);const e=o._s.get(t);return r[a].call(e,e)}))),n)),{}))}),n,o,0,!0)}(a,i,t));return t._s.get(a)}return"string"==typeof t?(a=t,i=r?o:n):(i=t,a=t.id),s.$id=a,s}function Be(e,t){var n;return e="object"==typeof(n=e)&&null!==n?e:Object.create(null),new Proxy(e,{get:(e,n,o)=>"key"===n?Reflect.get(e,n,o):Reflect.get(e,n,o)||Reflect.get(t,n,o)})}function Ge(e,{storage:t,serializer:n,key:o,debug:a}){try{const a=null==t?void 0:t.getItem(o);a&&e.$patch(null==n?void 0:n.deserialize(a))}catch(vs){}}function Fe(e,{storage:t,serializer:n,key:o,paths:a,debug:i}){try{const i=Array.isArray(a)?function(e,t){return t.reduce(((t,n)=>{const o=n.split(".");return function(e,t,n){return t.slice(0,-1).reduce(((e,t)=>/^(__proto__)$/.test(t)?{}:e[t]=e[t]||{}),e)[t[t.length-1]]=n,e}(t,o,function(e,t){return t.reduce(((e,t)=>null==e?void 0:e[t]),e)}(e,o))}),{})}(e,a):e;t.setItem(o,n.serialize(i))}catch(vs){}}var ze="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function He(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var je={exports:{}};je.exports=function(){function e(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),o.push.apply(o,n)),o}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t)}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function d(e,t,n){return(d=u()?Reflect.construct:function(e,t,n){var o=[null];return o.push.apply(o,t),t=new(Function.bind.apply(e,o)),n&&c(t,n.prototype),t}).apply(null,arguments)}function p(e){var t="function"==typeof Map?new Map:void 0;return function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,n)}function n(){return d(e,arguments,l(this).constructor)}return n.prototype=Object.create(e.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),c(n,e)}(e)}function h(e,t){if(null==e)return{};var n,o=function(e,t){if(null==e)return{};for(var n,o={},a=Object.keys(e),i=0;i<a.length;i++)n=a[i],0<=t.indexOf(n)||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols)for(var a=Object.getOwnPropertySymbols(e),i=0;i<a.length;i++)n=a[i],0<=t.indexOf(n)||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n]);return o}function f(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){var t=u();return function(){var n,o=l(e);if(n=t?(n=l(this).constructor,Reflect.construct(o,arguments,n)):o.apply(this,arguments),o=this,n&&("object"==typeof n||"function"==typeof n))return n;if(void 0!==n)throw new TypeError("Derived constructors may only return object or undefined");return f(o)}}function m(e,t){return _(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,i=[],r=!0,s=!1;try{for(n=n.call(e);!(r=(o=n.next()).done)&&(i.push(o.value),!t||i.length!==t);r=!0);}catch(l){s=!0,a=l}finally{try{r||null==n.return||n.return()}finally{if(s)throw a}}return i}}(e,t)||I(e,t)||k()}function v(e){return function(e){if(Array.isArray(e))return C(e)}(e)||y(e)||I(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _(e){if(Array.isArray(e))return e}function y(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function I(e,t){if(e){if("string"==typeof e)return C(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?C(e,t):void 0}}function C(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function k(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function E(e,t){var n,o="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!o){if(Array.isArray(e)||(o=I(e))||t&&e&&"number"==typeof e.length)return o&&(e=o),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,i=!0,r=!1;return{s:function(){o=o.call(e)},n:function(){var e=o.next();return i=e.done,e},e:function(e){r=!0,a=e},f:function(){try{i||null==o.return||o.return()}finally{if(r)throw a}}}}var T={SDK_READY:"sdkStateReady",SDK_NOT_READY:"sdkStateNotReady",SDK_DESTROY:"sdkDestroy",MESSAGE_RECEIVED:"onMessageReceived",ROOM_CUSTOM_DATA_RECEIVED:"onRoomCustomDataReceived",MESSAGE_MODIFIED:"onMessageModified",MESSAGE_REVOKED:"onMessageRevoked",MESSAGE_READ_BY_PEER:"onMessageReadByPeer",MESSAGE_READ_RECEIPT_RECEIVED:"onMessageReadReceiptReceived",MESSAGE_EXTENSIONS_UPDATED:"onMessageExtensionsUpdated",MESSAGE_EXTENSIONS_DELETED:"onMessageExtensionsDeleted",MESSAGE_REACTIONS_UPDATED:"onMessageReactionsUpdated",CONVERSATION_LIST_UPDATED:"onConversationListUpdated",TOTAL_UNREAD_MESSAGE_COUNT_UPDATED:"onTotalUnreadMessageCountUpdated",CONVERSATION_GROUP_LIST_UPDATED:"onConversationGroupListUpdated",CONVERSATION_IN_GROUP_UPDATED:"onConversationInGroupUpdated",GROUP_LIST_UPDATED:"onGroupListUpdated",GROUP_ATTRIBUTES_UPDATED:"groupAttributesUpdated",GROUP_COUNTER_UPDATED:"onGroupCounterUpdated",TOPIC_CREATED:"onTopicCreated",TOPIC_DELETED:"onTopicDeleted",TOPIC_UPDATED:"onTopicUpdated",PROFILE_UPDATED:"onProfileUpdated",USER_STATUS_UPDATED:"onUserStatusUpdated",BLACKLIST_UPDATED:"blacklistUpdated",FRIEND_LIST_UPDATED:"onFriendListUpdated",FRIEND_GROUP_LIST_UPDATED:"onFriendGroupListUpdated",FRIEND_APPLICATION_LIST_UPDATED:"onFriendApplicationListUpdated",MY_FOLLOWERS_LIST_UPDATED:"onMyFollowersListUpdated",MY_FOLLOWING_LIST_UPDATED:"onMyFollowingListUpdated",MUTUAL_FOLLOWERS_LIST_UPDATED:"onMutualFollowersListUpdated",KICKED_OUT:"kickedOut",ERROR:"error",NET_STATE_CHANGE:"netStateChange",ALL_RECEIVE_MESSAGE_OPT_UPDATED:"onAllReceiveMessageOptUpdated"},S={MSG_TEXT:"TIMTextElem",MSG_IMAGE:"TIMImageElem",MSG_SOUND:"TIMSoundElem",MSG_AUDIO:"TIMSoundElem",MSG_FILE:"TIMFileElem",MSG_FACE:"TIMFaceElem",MSG_VIDEO:"TIMVideoFileElem",MSG_GEO:"TIMLocationElem",MSG_LOCATION:"TIMLocationElem",MSG_GRP_TIP:"TIMGroupTipElem",MSG_GRP_SYS_NOTICE:"TIMGroupSystemNoticeElem",MSG_CUSTOM:"TIMCustomElem",MSG_MERGER:"TIMRelayElem",MSG_PRIORITY_HIGH:"High",MSG_PRIORITY_NORMAL:"Normal",MSG_PRIORITY_LOW:"Low",MSG_PRIORITY_LOWEST:"Lowest",CONV_C2C:"C2C",CONV_GROUP:"GROUP",CONV_TOPIC:"TOPIC",CONV_SYSTEM:"@TIM#SYSTEM",CONV_AT_ME:1,CONV_AT_ALL:2,CONV_AT_ALL_AT_ME:3,CONV_MARK_TYPE_STAR:1,CONV_MARK_TYPE_UNREAD:2,CONV_MARK_TYPE_FOLD:4,CONV_MARK_TYPE_HIDE:8,GRP_PRIVATE:"Private",GRP_WORK:"Private",GRP_PUBLIC:"Public",GRP_CHATROOM:"ChatRoom",GRP_MEETING:"ChatRoom",GRP_AVCHATROOM:"AVChatRoom",GRP_COMMUNITY:"Community",GRP_ROOM:"Room",GRP_LIVE:"Live",GRP_MBR_ROLE_OWNER:"Owner",GRP_MBR_ROLE_ADMIN:"Admin",GRP_MBR_ROLE_MEMBER:"Member",GRP_MBR_ROLE_CUSTOM:"Custom",GRP_TIP_MBR_JOIN:1,GRP_TIP_MBR_QUIT:2,GRP_TIP_MBR_KICKED_OUT:3,GRP_TIP_MBR_SET_ADMIN:4,GRP_TIP_MBR_CANCELED_ADMIN:5,GRP_TIP_GRP_PROFILE_UPDATED:6,GRP_TIP_MBR_PROFILE_UPDATED:7,GRP_TIP_BAN_AVCHATROOM_MEMBER:10,GRP_TIP_UNBAN_AVCHATROOM_MEMBER:11,MSG_REMIND_ACPT_AND_NOTE:"AcceptAndNotify",MSG_REMIND_ACPT_NOT_NOTE:"AcceptNotNotify",MSG_REMIND_DISCARD:"Discard",RECEIVE_WITH_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT:"AcceptNotNotifyExceptAt",NOT_RECEIVE_MSG_EXCEPT_AT:"NotReceiveMsgExceptAt",GENDER_UNKNOWN:"Gender_Type_Unknown",GENDER_FEMALE:"Gender_Type_Female",GENDER_MALE:"Gender_Type_Male",KICKED_OUT_MULT_ACCOUNT:"multipleAccount",KICKED_OUT_MULT_DEVICE:"multipleDevice",KICKED_OUT_USERSIG_EXPIRED:"userSigExpired",KICKED_OUT_REST_API:"REST_API_Kick",ALLOW_TYPE_ALLOW_ANY:"AllowType_Type_AllowAny",ALLOW_TYPE_NEED_CONFIRM:"AllowType_Type_NeedConfirm",ALLOW_TYPE_DENY_ANY:"AllowType_Type_DenyAny",FORBID_TYPE_NONE:"AdminForbid_Type_None",FORBID_TYPE_SEND_OUT:"AdminForbid_Type_SendOut",JOIN_OPTIONS_FREE_ACCESS:"FreeAccess",JOIN_OPTIONS_NEED_PERMISSION:"NeedPermission",JOIN_OPTIONS_DISABLE_APPLY:"DisableApply",JOIN_STATUS_SUCCESS:"JoinedSuccess",JOIN_STATUS_ALREADY_IN_GROUP:"AlreadyInGroup",JOIN_STATUS_WAIT_APPROVAL:"WaitAdminApproval",INVITE_OPTIONS_DISABLE_INVITE:"DisableInvite",INVITE_OPTIONS_NEED_PERMISSION:"NeedPermission",INVITE_OPTIONS_FREE_ACCESS:"FreeAccess",GRP_PROFILE_OWNER_ID:"ownerID",GRP_PROFILE_CREATE_TIME:"createTime",GRP_PROFILE_LAST_INFO_TIME:"lastInfoTime",GRP_PROFILE_MEMBER_NUM:"memberNum",GRP_PROFILE_MAX_MEMBER_NUM:"maxMemberNum",GRP_PROFILE_JOIN_OPTION:"joinOption",GRP_PROFILE_INVITE_OPTION:"inviteOption",GRP_PROFILE_INTRODUCTION:"introduction",GRP_PROFILE_NOTIFICATION:"notification",GRP_PROFILE_MUTE_ALL_MBRS:"muteAllMembers",SNS_ADD_TYPE_SINGLE:"Add_Type_Single",SNS_ADD_TYPE_BOTH:"Add_Type_Both",SNS_DELETE_TYPE_SINGLE:"Delete_Type_Single",SNS_DELETE_TYPE_BOTH:"Delete_Type_Both",SNS_APPLICATION_TYPE_BOTH:"Pendency_Type_Both",SNS_APPLICATION_SENT_TO_ME:"Pendency_Type_ComeIn",SNS_APPLICATION_SENT_BY_ME:"Pendency_Type_SendOut",SNS_APPLICATION_AGREE:"Response_Action_Agree",SNS_APPLICATION_AGREE_AND_ADD:"Response_Action_AgreeAndAdd",SNS_CHECK_TYPE_BOTH:"CheckResult_Type_Both",SNS_CHECK_TYPE_SINGLE:"CheckResult_Type_Single",SNS_TYPE_NO_RELATION:"CheckResult_Type_NoRelation",SNS_TYPE_A_WITH_B:"CheckResult_Type_AWithB",SNS_TYPE_B_WITH_A:"CheckResult_Type_BWithA",SNS_TYPE_BOTH_WAY:"CheckResult_Type_BothWay",NET_STATE_CONNECTED:"connected",NET_STATE_CONNECTING:"connecting",NET_STATE_DISCONNECTED:"disconnected",MSG_AT_ALL:"__kImSDK_MesssageAtALL__",READ_ALL_C2C_MSG:"readAllC2CMessage",READ_ALL_GROUP_MSG:"readAllGroupMessage",READ_ALL_MSG:"readAllMessage",USER_STATUS_UNKNOWN:0,USER_STATUS_ONLINE:1,USER_STATUS_OFFLINE:2,USER_STATUS_UNLOGINED:3,IOS_OFFLINE_PUSH_NO_SOUND:"push.no_sound",IOS_OFFLINE_PUSH_DEFAULT_SOUND:"default"},M={NEW_INVITATION_RECEIVED:"newInvitationReceived",INVITEE_ACCEPTED:"ts_invitee_accepted",INVITEE_REJECTED:"ts_invitee_rejected",INVITATION_CANCELLED:"ts_invitation_cancelled",INVITATION_TIMEOUT:"ts_invitation_timeout",INVITATION_MODIFIED:"ts_invitation_modified",ACTION_TYPE_UNKNOWN:0,ACTION_TYPE_INVITE:1,ACTION_TYPE_CANCEL_INVITE:2,ACTION_TYPE_ACCEPT_INVITE:3,ACTION_TYPE_REJECT_INVITE:4,ACTION_TYPE_INVITE_TIMEOUT:5},w=(i(G,[{key:"use",value:function(e){if("function"!=typeof e)throw"middleware must be a function";return this.cache.push(e),this}},{key:"next",value:function(e){if(this.middlewares&&0<this.middlewares.length)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}},{key:"run",value:function(e){return this.middlewares=this.cache.map((function(e){return e})),this.options=e,this.next()}}]),G),b=(i(B,[{key:"equal",value:function(e){return null!==e&&this.low===e.low&&this.high===e.high}},{key:"toString",value:function(){var e=Number(this.high).toString(16),t=Number(this.low).toString(16);if(t.length<8)for(var n=8-t.length;n;)t="0"+t,n--;return e+t}}]),B),D={TEST:{CHINA:{DEFAULT:"wss://wss-dev.tim.qq.com"},OVERSEA:{DEFAULT:"wss://wss-dev.tim.qq.com"},SINGAPORE:{DEFAULT:"wss://wsssgp-dev.im.qcloud.com"},KOREA:{DEFAULT:"wss://wsskr-dev.im.qcloud.com"},GERMANY:{DEFAULT:"wss://wssger-dev.im.qcloud.com"},IND:{DEFAULT:"wss://wssind-dev.im.qcloud.com"},JPN:{DEFAULT:"wss://wssjpn-dev.im.qcloud.com"},USA:{DEFAULT:"wss://wssusa-dev.im.qcloud.com"},INDONESIA:{DEFAULT:"wss://wssidn-dev.im.qcloud.com"}},PRODUCTION:{CHINA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",IPV6:"wss://wssv6.im.qcloud.com",BACKUP:"wss://wss.tim.qq.com",STAT:"https://events.im.qcloud.com",ANYCAST:"wss://162.14.13.203"},OVERSEA:{DEFAULT0:"wss://*w4c.my-imcloud.com",DEFAULT:"wss://wss.im.qcloud.com",BACKUP:"wss://wss.my-imcloud.com",STAT:"https://api.my-imcloud.com"},SINGAPORE:{DEFAULT0:"wss://*w4s.my-imcloud.com",DEFAULT:"wss://wsssgp.im.qcloud.com",IPV6:"wss://wsssgpv6.im.qcloud.com",BACKUP:"wss://wsssgp.my-imcloud.com",STAT:"https://apisgp.my-imcloud.com",ANYCAST:"wss://162.14.19.159"},KOREA:{DEFAULT0:"wss://*w4k.my-imcloud.com",DEFAULT:"wss://wsskr.im.qcloud.com",IPV6:"wss://wsskrv6.im.qcloud.com",BACKUP:"wss://wsskr.my-imcloud.com",STAT:"https://apikr.my-imcloud.com",ANYCAST:"wss://162.14.13.104"},GERMANY:{DEFAULT0:"wss://*w4g.my-imcloud.com",DEFAULT:"wss://wssger.im.qcloud.com",IPV6:"wss://wssgerv6.im.qcloud.com",BACKUP:"wss://wssger.my-imcloud.com",STAT:"https://apiger.my-imcloud.com",ANYCAST:"wss://162.14.3.17"},IND:{DEFAULT0:"wss://*w4i.my-imcloud.com",DEFAULT:"wss://wssind.my-imcloud.com",IPV6:"wss://wssindv6.im.qcloud.com",BACKUP:"wss://wssind.im.qcloud.com",STAT:"https://apiind.my-imcloud.com",ANYCAST:"wss://162.14.19.46"},JPN:{DEFAULT0:"wss://*w4j.my-imcloud.com",DEFAULT:"wss://wssjpn.im.qcloud.com",IPV6:"wss://wssjpnv6.im.qcloud.com",BACKUP:"wss://wssjpn.my-imcloud.com",STAT:"https://apijpn.my-imcloud.com"},USA:{DEFAULT0:"wss://*w4u.my-imcloud.com",DEFAULT:"wss://wssusa.im.qcloud.com",IPV6:"wss://wssusav6.im.qcloud.com",BACKUP:"wss://wssusa.my-imcloud.com",STAT:"https://apiusa.my-imcloud.com",ANYCAST:"wss://162.14.10.42"},INDONESIA:{DEFAULT0:"wss://*w4y.my-imcloud.com",DEFAULT:"wss://wssidn.im.qcloud.com",IPV6:"wss://wssidnv6.im.qcloud.com",BACKUP:"wss://wssidn.my-imcloud.com",STAT:"https://apiidn.my-imcloud.com",ANYCAST:"wss://43.129.34.169"}}},N={ANDROID:2,IOS:3,MAC:4,WEB:7,WX_MP:8,QQ_MP:9,TT_MP:10,BAIDU_MP:11,ALI_MP:12,IPAD:13,UNI_NATIVE_APP:15,DONUT_NATIVE_APP:19,NS_NATIVE_APP:20,RN_NATIVE_APP:21},R="1.7.3",L=537048168,A="CHINA",O={HOST:{CURRENT:{DEFAULT:"wss://wss.im.qcloud.com",STAT:"https://events.im.qcloud.com"},setCurrent:function(){this.CURRENT=D.PRODUCTION[0<arguments.length&&void 0!==arguments[0]?arguments[0]:A]}},NAME:{OPEN_IM:"openim",OPEN_IM_MSG_EXT:"openim_msg_ext_http_svc",GRP:"group_open_http_svc",GRP_AV:"group_open_avchatroom_http_svc",GRP_COMMUNITY:"million_group_open_http_svc",GRP_ATTR:"group_open_attr_http_svc",FD:"sns",PROFILE:"profile",RECENT_CONTACT:"recentcontact",BIG_GRP_NO_AUTH:"group_open_http_noauth_svc",BIG_GRP_POLLING:"group_open_long_polling_http_svc",BIG_GRP_POLLING_NO_AUTH:"group_open_long_polling_http_noauth_svc",IM_OPEN_STAT:"imopenstat",IM_COS_SIGN:"im_cos_sign_svr",CUSTOM_UPLOAD:"im_cos_msg",HEARTBEAT:"heartbeat",IM_OPEN_PUSH:"im_open_push",IM_OPEN_STATUS:"im_open_status",IM_LONG_MSG:"im_long_msg",IM_CONFIG_MANAGER:"im_sdk_config_mgr",STAT_SERVICE:"StatSvc",OVERLOAD_PUSH:"OverLoadPush",IM_MSG_AUDIT_MGR:"im_msg_audit_mgr",TUIROOM_SVR:"tui_room_svr",IM_OPEN_TRANSLATE:"im_open_translate",IM_OPEN_SPEECH:"im_open_speech",MSG_SEARCH:"message_search",GRP_SEARCH:"group_search",GRP_MEMBER_SEARCH:"group_member_search",USER_SEARCH:"user_search",FOLLOW:"follow",OFFLINE_PUSH_REPORT:"offline_push_report",IM_MSG_LOGIC:"im_msg_db_logic"}},P={SEARCH_GRP_SNS:new b(0,Math.pow(2,1)).toString(),AV_HISTORY_MSG:new b(0,Math.pow(2,2)).toString(),GRP_COMMUNITY:new b(0,Math.pow(2,3)).toString(),MSG_TO_SPECIFIED_GRP_MBR:new b(0,Math.pow(2,4)).toString(),AV_MBR_LIST:new b(0,Math.pow(2,6)).toString(),USER_STATUS:new b(0,Math.pow(2,7)).toString(),CONV_MARK:new b(0,Math.pow(2,9)).toString(),CONV_GROUP:new b(0,Math.pow(2,10)).toString(),AV_BAN_MBR:new b(0,Math.pow(2,11)).toString(),MSG_EXT:new b(0,Math.pow(2,13)).toString(),GRP_COUNTER:new b(0,Math.pow(2,15)).toString(),PLUGIN_TRANSLATE:new b(Math.pow(2,6)).toString(),PLUGIN_VOICE_TO_TEXT:new b(Math.pow(2,7)).toString(),PLUGIN_CS:new b(Math.pow(2,8)).toString(),PLUGIN_PUSH:new b(Math.pow(2,9)).toString(),PLUGIN_BOT:new b(Math.pow(2,10)).toString(),MSG_REACTION:new b(Math.pow(2,16)).toString(),FOLLOW:new b(Math.pow(2,20)).toString()},U="group_profile",x=["Type","Name","Introduction","Notification","FaceUrl","Owner_Account","CreateTime","InfoSeq","LastInfoTime","LastMsgTime","MemberNum","MaxMemberNum","ApplyJoinOption","NextMsgSeq","ShutUpAllMember","InviteJoinOption"],V=["Role","JoinTime","MsgSeq","MsgFlag"];function B(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0;o(this,B),this.high=e,this.low=t}function G(){o(this,G),this.cache=[],this.options=null}O.HOST.setCurrent(A);for(var F,z="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),H=z&&"function"==typeof wx.createGamePortal,j="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),q="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),K="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),Y="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),$="undefined"!=typeof jd&&"function"==typeof jd.getSystemInfoSync,W="undefined"!=typeof uni&&"undefined"==typeof window&&!0,Z=z&&"object"===n(wx.miniapp),J="undefined"!=typeof uni,X=z||j||q||K||Y||W||$,Q="undefined"==typeof window&&!X&&void 0!==ze&&void 0!==ze.NativeScriptGlobals,ee=void 0!==ze&&(void 0!==ze.nativeModuleProxy||void 0!==ze.ReactNative),te="undefined"!=typeof uni?!X:"undefined"!=typeof window&&!X&&!ee,ne=j?qq:q?tt:K?swan:Y?my:z?wx:W?uni:$?jd:{},oe=te&&window&&window.navigator&&window.navigator.userAgent||"",ae=($="WEB",/(micromessenger|webbrowser)/i.test(oe)?$="WEB":j?$="QQ_MP":q?$="TT_MP":K?$="BAIDU_MP":Y?$="ALI_MP":z?$=Z?"DONUT_NATIVE_APP":"WX_MP":W?$="UNI_NATIVE_APP":Q?$="NS_NATIVE_APP":ee&&($="RN_NATIVE_APP"),N[$]),ie=(Z=/iPad/i.test(oe),Q=/iPhone/i.test(oe)&&!Z,$=/iPod/i.test(oe),Q||Z||$),re=(Q=oe.match(/OS (\d+)_/i))&&Q[1]?Q[1]:null,se=/Android/i.test(oe),le=function(){var e=oe.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!e)return null;var t=e[1]&&parseFloat(e[1]),n=e[2]&&parseFloat(e[2]);return t&&n?parseFloat(e[1]+"."+e[2]):t||null}(),ce=($=!(Z=/Edge/i.test(oe))&&/Chrome/i.test(oe),/MSIE/.test(oe)||-1<oe.indexOf("Trident")&&-1<oe.indexOf("rv:11.0")),ue=Q=!(Q=(Q=/MSIE\s(\d+)\.\d/.exec(oe))&&parseFloat(Q[1]))&&/Trident\/7.0/i.test(oe)&&/rv:11.0/.test(oe)?11:Q,de=/Safari/i.test(oe)&&!$&&!se&&!Z,pe=/Windows/i.test(oe),he=/MAC OS X/i.test(oe),fe=te&&"undefined"!=typeof Worker&&!ce,ge=se||ie,me=te&&void 0!==window.tencent_cloud_im_csig_flutter_for_web_25F_cy,ve=function(){if("undefined"==typeof window||void 0===window.navigator)return!1;var e=window.navigator.standalone;return!(!ie||e||de)}(),_e="undefined"!=typeof console?console:void 0!==ze&&ze.console?ze.console:"undefined"!=typeof window&&window.console?window.console:{},ye=function(){},Ie=["assert","clear","count","debug","dir","dirxml","error","group","groupCollapsed","groupEnd","info","log","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],Ce=Ie.length;Ce--;)F=Ie[Ce],console[F]||(_e[F]=ye);function ke(){var e=new Date;return e.setTime(we()),e}function Ee(){Me=0}function Te(){return Math.floor(we()/1e3)}var Se=_e,Me=0,we=function(){return(new Date).getTime()+Me},be=0;function De(){return jt()?"%c Chat %c":"Chat"}function Ne(){var e=ke();return e.toLocaleTimeString("en-US",{hour12:!1})+"."+function(e){var t;switch(e.toString().length){case 1:t="00"+e;break;case 2:t="0"+e;break;default:t=e}return t}(e.getMilliseconds())}var Re={arguments2String:function(e){var t="";if(1===e.length)t=e[0];else for(var n=0,o=e.length;n<o;n++){if(ht(e[n]))try{t+=ft(e[n])?JSON.stringify(e[n],["message","code"]):JSON.stringify(e[n])}catch(a){t+=a?a.message:"";break}else t+=e[n];t+=" "}return t},_exec:function(e,t){jt()?Se[e](De(),"background:#0abf5b; padding:1px; border-radius:3px; color: #fff","background:transparent",Ne(),t):Se[e]("".concat(De()," ").concat(Ne()," ").concat(t))},d:function(){var e;be<=-1&&(e=this.arguments2String(arguments),this._exec("debug",e))},l:function(){var e;be<=0&&(e=this.arguments2String(arguments),this._exec("log",e))},log:function(){var e;be<=0&&(e=this.arguments2String(arguments),this._exec("log",e))},i:function(){var e;be<=1&&(e=this.arguments2String(arguments),this._exec("info",e))},w:function(){var e;be<=2&&(e=this.arguments2String(arguments),this._exec("warn",e))},e:function(){var e;be<=3&&(e=this.arguments2String(arguments),this._exec("error",e))},setLevel:function(e){e<4&&this._exec("log","set level from "+be+" to "+e),be=e},getLevel:function(){return be}},Le={JPG:1,JPEG:1,GIF:2,PNG:3,BMP:4,UNKNOWN:255},Ae={NICK:"".concat(Q="Tag_Profile_IM_","Nick"),GENDER:"".concat(Q,"Gender"),BIRTHDAY:"".concat(Q,"BirthDay"),LOCATION:"".concat(Q,"Location"),SELFSIGNATURE:"".concat(Q,"SelfSignature"),ALLOWTYPE:"".concat(Q,"AllowType"),LANGUAGE:"".concat(Q,"Language"),AVATAR:"".concat(Q,"Image"),MESSAGESETTINGS:"".concat(Q,"MsgSettings"),ADMINFORBIDTYPE:"".concat(Q,"AdminForbidType"),LEVEL:"".concat(Q,"Level"),ROLE:"".concat(Q,"Role")},Oe={GROUP:"".concat("Tag_SNS_IM_","Group"),REMARK:"".concat("Tag_SNS_IM_","Remark"),ADDSOURCE:"".concat("Tag_SNS_IM_","AddSource"),ADDWORDING:"".concat("Tag_SNS_IM_","Wording"),ADDTIME:"".concat("Tag_SNS_IM_","AddTime")},Pe={UNKNOWN:"".concat($="Gender_Type_","Unknown"),FEMALE:"".concat($,"Female"),MALE:"".concat($,"Male")},Ue={NONE:"".concat("AdminForbid_Type_","None"),SEND_OUT:"".concat("AdminForbid_Type_","SendOut")},xe={NEED_CONFIRM:"".concat("AllowType_Type_","NeedConfirm"),ALLOW_ANY:"".concat("AllowType_Type_","AllowAny"),DENY_ANY:"".concat("AllowType_Type_","DenyAny")},Ve="JoinedSuccess",Be="WaitAdminApproval",Ge="@TOPIC#_",Fe=Object.prototype.hasOwnProperty;function He(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(We(e)){for(var t in e)if(Fe.call(e,t))return!1;return!0}return!!(je(e)||qe(e)||Ke(e))&&0===e.size}function je(e){return"map"===gt(e)}function qe(e){return"set"===gt(e)}function Ke(e){return"file"===gt(e)}function Ye(e){return null!==e&&("number"==typeof e&&!isNaN(+e)||"object"===n(e)&&e.constructor===Number)}function $e(e){return null!==e&&"object"===n(e)}function We(e){if("object"===n(e)&&null!==e){if(null===(e=Object.getPrototypeOf(e)))return 1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return e===t}}function Ze(e){return"function"==typeof Array.isArray?Array.isArray(e):"array"===gt(e)}function Je(e){return Ze(e)&&0<e.length}function Xe(e){return"function"==typeof e}function Qe(e){return"filelist"===gt(e)}function et(e){return"string"==typeof e&&(e=e[0],!/[^a-zA-Z0-9]/.test(e))}function nt(e,t,n,o){if(!ht(e)||!ht(t))return 0;for(var a,i=0,r=Object.keys(t),s=0,l=r.length;s<l;s++)if(a=r[s],!(pt(t[a])||n&&n.includes(a)))if(ht(e[a])&&ht(t[a]))i+=nt(e[a],t[a],n,o);else{if(o&&o.includes(t[a]))continue;e[a]!==t[a]&&(e[a]=t[a],i+=1)}return i}function ot(e,t){var n,o=new Map,a=E(e.entries());try{for(a.s();!(n=a.n()).done;){var i=m(n.value,2),r=i[0],s=i[1];s&&o.set(r,t?JSON.stringify(s):JSON.parse(JSON.stringify(s)))}}catch(l){a.e(l)}finally{a.f()}return o}function at(e){if(0===e.length)return 0;for(var t=0,n=0,o="undefined"!=typeof document&&void 0!==document.characterSet?document.characterSet:"UTF-8";void 0!==e[t];)n+=e[t++].charCodeAt[t]<=255?1:!1===o?3:2;return n}function it(e){return e=e||99999999,Math.round(Math.random()*e)}function rt(){for(var e="",t=32;0<t;--t)e+=mt[Math.floor(Math.random()*vt)];return e}function st(e,t){for(var n in e)if(e[n]===t)return 1}function lt(e){return-1===e.indexOf("http://")||-1===e.indexOf("https://")?"https://"+e:e.replace(/https|http/,"https")}function ct(e){if(0===Object.getOwnPropertyNames(e).length)return Object.create(null);var t,o,a=Array.isArray(e)?[]:Object.create(null);for(o in e)null!==e[o]?void 0!==e[o]?(t=n(e[o]),0<=["string","number","function","boolean"].indexOf(t)?a[o]=e[o]:a[o]=ct(e[o])):a[o]=void 0:a[o]=null;return a}var ut=["url"],dt=function(e){return"string"==typeof e},pt=function(e){return void 0===e},ht=function(e){return Ze(e)||$e(e)},ft=function(e){return e instanceof Error},gt=function(e){return Object.prototype.toString.call(e).match(/^\[object (.*)\]$/)[1].toLowerCase()},mt=(Date.now||(Date.now=function(){return(new Date).getTime()}),"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"),vt=mt.length,_t={};function yt(e,t){if(!Ze(e)||!Ze(t))return!1;var n=!1;return t.forEach((function(t){var o=t.key,a=(t=t.value,e.find((function(e){return e.key===o})));a?a.value!==t&&(a.value=t,n=!0):(e.push({key:o,value:t}),n=!0)})),n}function It(e){return He(e)?[]:e.filter((function(e){return!0===e.isModified}))}function Ct(e){if(We(e)&&We(e.webhookInfo)){var t=[];if(e.webhookInfo.disableCloudMessagePreHook&&t.push("ForbidBeforeSendMsgCallback"),e.webhookInfo.disableCloudMessagePostHook&&t.push("ForbidAfterSendMsgCallback"),0!==t.length)return t}}function kt(e){return He(e)?[]:e.filter((function(e){return!1===e.isModified}))}function Et(e){return e===S.GRP_AVCHATROOM}function Tt(e){var t=e.type;return e=e.groupID,t===S.GRP_COMMUNITY||"".concat(e).startsWith("@TGS#_")&&!"".concat(e).includes(Ge)}function St(e){return"".concat(e).startsWith("@TGS#_")&&"".concat(e).includes(Ge)}function Mt(e){return dt(e)&&e.slice(0,3)===S.CONV_C2C}function wt(e){return dt(e)&&e.slice(0,5)===S.CONV_GROUP}function bt(e){return dt(e)&&e===S.CONV_SYSTEM}function Dt(e,t){var n={};return Object.keys(e).forEach((function(o){n[o]=t(e[o],o)})),n}function Nt(e){return ee?Promise.resolve({width:0,height:0}):X?new Promise((function(t,n){ne.getImageInfo({src:e,success:function(e){t({width:e.width,height:e.height})},fail:function(){t({width:0,height:0})}})})):ce&&9===ue?Promise.resolve({width:0,height:0}):new Promise((function(t,n){var o=new Image;o.onload=function(){t({width:this.width,height:this.height}),o=null},o.onerror=function(){t({width:0,height:0}),o=null},o.src=e}))}function Rt(){function e(){return(65536*(1+Math.random())|0).toString(16).substring(1)}return"".concat(e()+e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e()).concat(e())}function Lt(){var e=se?"android":ie?"ios":pe?"windows":he?"mac":"unknown";if(X)try{var t=ne.getSystemInfoSync().platform;void 0!==t&&(e=t)}catch(n){}return e}function At(e,t){e=e.split("."),t=t.split(".");for(var n=Math.max(e.length,t.length);e.length<n;)e.push("0");for(;t.length<n;)t.push("0");for(var o=0;o<n;o++){var a=parseInt(e[o]),i=parseInt(t[o]);if(i<a)return 1;if(a<i)return-1}return 0}function Ot(e){var t=void 0===(t=e.originUrl)?void 0:t,n=e.originWidth,o=e.originHeight,a=(e=void 0===(e=e.min)?198:e,{url:void 0,width:0,height:0});return((n=parseInt(n))<=(o=parseInt(o))?n:o)<=e?(a.url=t,a.width=n,a.height=o):(o<=n?(a.width=Math.ceil(n*e/o),a.height=e):(a.width=e,a.height=Math.ceil(o*e/n)),o=t&&-1<t.indexOf("?")?"".concat(t,"&"):"".concat(t,"?"),a.url="".concat(o,198===e?"imageView2/3/w/198/h/198":"imageView2/3/w/720/h/720")),pt(t)?(a.url,h(a,ut)):a}function Pt(e){var t=e[2];e[2]=e[1],e[1]=t;for(var n=0;n<e.length;n++)e[n].setType(n)}function Ut(e){return(e=e.servcmd).slice(e.indexOf(".")+1)}function xt(e,t){return Math.round(Number(e)*Math.pow(10,t))/Math.pow(10,t)}function Vt(e,t){return e.includes(t)}function Bt(e,t){return e.includes(t)}function Gt(e){return e.split(Ge)[0]}var Ft=function(e,t,n){if(pt(t))return"";switch(e){case S.MSG_TEXT:return t.text;case S.MSG_IMAGE:return n?"[Image]":"[图片]";case S.MSG_LOCATION:return n?"[Location]":"[位置]";case S.MSG_AUDIO:return n?"[Voice]":"[语音]";case S.MSG_VIDEO:return n?"[Video]":"[视频]";case S.MSG_FILE:return n?"[File]":"[文件]";case S.MSG_CUSTOM:return n?"[Custom Messages]":"[自定义消息]";case S.MSG_GRP_TIP:return n?"[Group Notification]":"[群提示消息]";case S.MSG_GRP_SYS_NOTICE:return n?"[Group System Message]":"[群系统通知]";case S.MSG_FACE:return n?"[Animated Sticker]":"[动画表情]";case S.MSG_MERGER:return n?"[Chat Record]":"[聊天记录]";default:return""}};function zt(e){return e===S.MSG_TEXT||e===S.MSG_CUSTOM||e===S.MSG_LOCATION||e===S.MSG_FACE}function Ht(e){var t=[];if(!dt(e))return t;var n=e.length;if(0===n)return t;for(var o=n-1;0<=o;o--)"1"===e[o]&&t.push(Math.pow(2,n-o-1));return t}function jt(){return!ce&&!X}function qt(e){return"the length of userIDList cannot exceed ".concat(e)}function Kt(e){var t;if(Ze(e)&&0!==e.length)return t=0,e.forEach((function(e){t+=e})),t.toFixed(0)}function Yt(e){var t;if(Ze(e)&&0!==e.length)return t=0,e.forEach((function(e){t+=e})),(t/e.length).toFixed(0)}function $t(e,t,n){t=!(1<arguments.length&&void 0!==t)||t,n=!(2<arguments.length&&void 0!==n)||n;var o=Date.now();return t?n?"".concat(o-e," ms"):"".concat(Math.round((o-e)/1e3)," s"):n?o-e:Math.round((o-e)/1e3)}function Wt(e){return!!(e&&1<e)}function Zt(e,t,n,o){if(void 0===t)return 1;var a,i,r=!0;return t.required&&He(e)&&(Re.e("[".concat(n,'] Missing required params: "').concat(o,'".')),r=!1),He(e)||(a=gt(e))!==(i=t.type.toLowerCase())&&("asyncfunction"===a&&"function"===i||(Re.e("[".concat(n,'] Invalid params: type check failed for "').concat(o,'". Expected ').concat(t.type,".")),r=!1)),t.validator&&!t.validator(e,n,o)&&(Re.e("[".concat(n,'] Invalid params: custom validator check failed for "').concat(o,'".')),r=!1),r}function Jt(e){return!(!e||!(Mt(e)||wt(e)||bt(e))&&((e=Vn("InvalidConversationID",e))&&Re.w(e),1))}function Xt(e){""!==e.desc&&""!==Vn("API_REFER")&&Re.w("[".concat(e.api,"] | ").concat(e.paramName," | ").concat(e.desc,", ").concat(Vn("API_REFER")).concat(e.api))}function Qt(){return Vn("StringRequiredLog")}function en(e){return Vn("NonEmptyStringRequiredLog",e)}function tn(){return Vn("NumberRequiredLog")}function nn(){return Vn("UndefinedNotAllowedLog")}function on(){return Vn("FileRequiredLog")}function an(){return Vn("FunctionRequiredLog")}function rn(){return Vn("ArrayRequiredLog")}function sn(){return Vn("NonEmptyArrayLog")}function ln(){return Vn("CallbackMissingLog")}function cn(){return Vn("PositiveIntegerRequiredLog")}function un(e,t){return Vn("StringNotLongerThanLog",e,t)}function dn(e,t){return Vn("NumberGreaterThanLog",e,t)}function pn(e,t){return Vn("NumberGreaterOrEqualLog",e,t)}function hn(e){return Vn("KeyValueStringRequiredLog",e)}function fn(){return Vn("PlainObjectRequiredLog")}function gn(){return Vn("NonEmptyContentRequiredLog")}function mn(){return Vn("FileNotSelectedLog")}function vn(){return Vn("MessageInstanceRequiredLog")}function _n(){return Vn("NonAnonymousFunctionLog")}function yn(){return Vn("MessageExtensionNotAvailableLog")}function In(){return Vn("MessageReactionRequiredLog")}function Cn(e,t){return Vn("ContainsUnsupportedTypeLog",e,t)}function kn(e,t,n,o){var a=o.allowUndefined,i=o.allowEmpty;return o=o.maxLength,pt(e)?!!a||(Xt({api:t,paramName:n,desc:nn()}),!1):Ze(e)?!(0===e.length&&(Xt({api:t,paramName:n,desc:sn()}),!i)||o&&e.length>o&&(Xt({api:t,paramName:n,desc:Vn("MaximumArrayLengthLog",n,o)}),1)):(Xt({api:t,paramName:n,desc:rn()}),!1)}function En(e,t,n,o){var a=o.allowUndefined,i=o.min;return o=o.max,pt(e)?!!a||(Xt({api:t,paramName:n,desc:nn()}),!1):Ye(e)?Ye(i)&&e<i?(Xt({api:t,paramName:n,desc:0===i?pn(n,i):dn(n,i-1)}),!1):!(Ye(o)&&o<e&&(Xt({api:t,paramName:n,desc:Vn("MaximumNumberLog",n,o)}),1)):(Xt({api:t,paramName:n,desc:tn()}),!1)}function Tn(e){return{code:0,data:e||{}}}function Sn(e){return Promise.resolve(Tn(e))}function Mn(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];if(e instanceof Fn)return t&&null!==Hn&&Hn.emit(T.ERROR,e),Promise.reject(e);if(e instanceof Error)return n=new Fn({code:zn.UNCAUGHT_ERROR}),t&&null!==Hn&&Hn.emit(T.ERROR,n),Promise.reject(n);if(pt(e)||pt(e.code))return Promise.reject(new Fn({code:zn.UNCAUGHT_ERROR}));var n=new Fn(e);return t&&null!==Hn&&Hn.emit(T.ERROR,n),Promise.reject(n)}var wn,bn="unSend",Dn="success",Nn="fail",Rn="notStart",Ln="pending",An="resolved",On="rejected",Pn={type:"Boolean",required:!0},Un={type:"number",required:!0},xn={keywordListForMsg:{type:"Array",required:!1,validator:function(e,t,n){return kn(e,t,n,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},keywordListExceptMsg:{type:"Array",required:!0,validator:function(e,t,n){return kn(e,t,n,{allowUndefined:!1,allowEmpty:!1,maxLength:5})}},keywordListMatchType:{type:"String",required:!1,validator:function(e,t,n){return!e||"or"===e||"and"===e||Xt({api:t,paramName:n,desc:"".concat(e," is invalid match type")})}},cursor:{type:"String",required:!1},count:{type:"Number",required:!1,validator:function(e,t,n){return En(e,t,n,{allowUndefined:!0,min:1,max:100})}},groupTypeList:{type:"Array",required:!1,validator:function(e,t,n){if(!e)return!0;if(!kn(e,t,n,{allowUndefined:!0,allowEmpty:!0}))return!1;var o=[S.GRP_PUBLIC,S.GRP_COMMUNITY,S.GRP_WORK,S.GRP_MEETING];return!(0<e.filter((function(e){return-1===o.indexOf(e)})).length&&(Xt({api:t,paramName:n,desc:Cn(n,"group")}),1))}}},Vn=null,Bn={hookGetAPITips:function(e){Vn=e},login:{userID:Z={type:"String",required:!0},userSig:Z},addToBlacklist:{userIDList:Q={type:"Array",required:!0}},removeFromBlacklist:{userIDList:Q},on:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:en(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:an()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],once:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:en(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:an()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],off:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:en(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:an()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],sendMessage:[t({name:"message"},$={type:"Object",required:!0})],setMessageExtensions:[t(t({name:"message"},$),{},{validator:function(e,t,n){return e.status===Dn&&!0===e.isSupportExtension||(Xt({api:t,paramName:n,desc:yn()}),!1)}}),t({name:"extensions"},Q)],getMessageExtensions:[t(t({name:"message"},$),{},{validator:function(e,t,n){return e.status===Dn&&!0===e.isSupportExtension||(Xt({api:t,paramName:n,desc:yn()}),!1)}})],deleteMessageExtensions:[t(t({name:"message"},$),{},{validator:function(e,t,n){return e.status===Dn&&!0===e.isSupportExtension||(Xt({api:t,paramName:n,desc:yn()}),!1)}})],addMessageReaction:[t(t({name:"message"},$),{},{validator:function(e,t,n){return e.status===Dn||(Xt({api:t,paramName:n,desc:In()}),!1)}}),t({name:"reactionID"},Z)],removeMessageReaction:[t(t({name:"message"},$),{},{validator:function(e,t,n){return e.status===Dn||(Xt({api:t,paramName:n,desc:In()}),!1)}}),t({name:"reactionID"},Z)],getMessageReactions:{messageList:t({},Q)},getAllUserListOfMessageReaction:{message:t(t({},$),{},{validator:function(e,t,n){return e.status===Dn||(Xt({api:t,paramName:n,desc:In()}),!1)}}),reactionID:t({},Z),nextSeq:{type:"Number"},count:{type:"Number"}},getMessageList:{conversationID:t(t({},Z),{},{validator:Jt}),nextReqMessageID:{type:"String"},count:{type:"Number",validator:function(e,t,n){return!(!pt(e)&&!/^[1-9][0-9]*$/.test(e)&&(Xt({api:t,paramName:n,desc:cn()}),1))}}},getMessageListHopping:{conversationID:t(t({},Z),{},{validator:Jt}),sequence:{type:"Number"},time:{type:"Number"},direction:{type:"Number",validator:function(e,t,n){return!(!pt(e)&&0!==e&&1!==e&&(Xt({api:t,paramName:n,desc:Vn("0Or1RequiredLog")}),1))}},count:{type:"Number",validator:function(e,t,n){return!(!pt(e)&&!/^[1-9][0-9]*$/.test(e)&&(Xt({api:t,paramName:n,desc:cn}),1))}}},setMessageRead:{conversationID:t(t({},Z),{},{validator:Jt})},setAllMessageRead:{scope:{type:"String",required:!1,validator:function(e,t,n){return!e||-1!==[S.READ_ALL_C2C_MSG,S.READ_ALL_GROUP_MSG,S.READ_ALL_MSG].indexOf(e)||(Xt({api:t,paramName:n,desc:Vn("ValidScopeRequired")}),!1)}}},getConversationProfile:[t(t({name:"conversationID"},Z),{},{validator:Jt})],clearHistoryMessage:[t(t({name:"conversationID"},Z),{},{validator:Jt})],pinConversation:{conversationID:t(t({},Z),{},{validator:Jt}),isPinned:t({},Pn)},setConversationDraft:{conversationID:t(t({},Z),{},{validator:Jt}),draftText:{type:"String",validator:function(e,t,n){return!!dt(e)||(Xt({api:t,paramName:n,desc:Qt()}),!1)}}},setConversationCustomData:{conversationIDList:t({},Q),customData:{type:"String",validator:function(e,t,n){return dt(e)?!(256<e.length&&(Xt({api:t,paramName:n,desc:un(n,256)}),1)):(Xt({api:t,paramName:n,desc:Qt()}),!1)}}},markConversation:{conversationIDList:t({},Q),markType:{type:"number",validator:function(e,t,n){return Ye(e)?e<=0?(Xt({api:t,paramName:n,desc:dn(n,0)}),!1):!(e>=Math.pow(2,64)&&(Xt({api:t,paramName:n,desc:Vn("NumberLessThanLog",n,"Math.pow(2,64)")}),1)):(Xt({api:t,paramName:n,desc:tn()}),!1)}},enableMark:t({},Pn)},createConversationGroup:{conversationIDList:t({},Q),groupName:t(t({},Z),{},{validator:function(e,t,n){return!(!e||32<e.length&&(Xt({api:t,paramName:n,desc:un(n,32)}),1))}})},deleteConversationGroup:[t({name:"groupName"},Z)],renameConversationGroup:{oldName:t({},Z),newName:t(t({},Z),{},{validator:function(e,t,n){return!(!e||32<e.length&&(Xt({api:t,paramName:n,desc:un(n,32)}),1))}})},addConversationsToGroup:{conversationIDList:t({},Q),groupName:t({},Z)},deleteConversationsFromGroup:{conversationIDList:t({},Q),groupName:t({},Z)},getGroupList:{groupProfileFilter:{type:"Array"}},getGroupProfile:{groupID:Z,groupCustomFieldFilter:{type:"Array"},memberCustomFieldFilter:{type:"Array"}},getGroupProfileAdvance:{groupIDList:Q},createGroup:{name:Z},joinGroup:{groupID:Z,type:{type:"String"},applyMessage:{type:"String"}},quitGroup:[t({name:"groupID"},Z)],handleApplication:{message:$,handleAction:Z,handleMessage:{type:"String"}},changeGroupOwner:{groupID:Z,newOwnerID:Z},updateGroupProfile:{groupID:Z,muteAllMembers:{type:"Boolean"}},dismissGroup:[t({name:"groupID"},Z)],searchGroupByID:[t({name:"groupID"},Z)],getGroupOnlineMemberCount:[t({name:"groupID"},Z)],initGroupAttributes:{groupID:Z,groupAttributes:t(t({},$),{},{validator:function(e,t,n){var o=!0;return Object.keys(e).forEach((function(a){if(!dt(e[a]))return Xt({api:t,paramName:n,desc:hn("value")}),o=!1})),o}})},setGroupAttributes:{groupID:Z,groupAttributes:t(t({},$),{},{validator:function(e,t,n){var o=!0;return Object.keys(e).forEach((function(a){if(!dt(e[a]))return Xt({api:t,paramName:n,desc:hn("value")}),o=!1})),o}})},deleteGroupAttributes:{groupID:Z,keyList:{type:"Array",validator:function(e,t,n){return pt(e)||!Ze(e)?(Xt({api:t,paramName:n,desc:rn()}),!1):!!He(e)||(o=!0,e.forEach((function(e){if(!dt(e))return Xt({api:t,paramName:n,desc:Vn("StringArrayRequiredLog")}),o=!1})),o);var o}}},getGroupAttributes:{groupID:Z,keyList:{type:"Array",validator:function(e,t,n){return pt(e)||!Ze(e)?(Xt({api:t,paramName:n,desc:rn()}),!1):!!He(e)||(o=!0,e.forEach((function(e){if(!dt(e))return Xt({api:t,paramName:n,desc:hn("key")}),o=!1})),o);var o}}},setGroupCounters:{groupID:Z,counters:$},increaseGroupCounter:{groupID:Z,key:Z,value:Un},decreaseGroupCounter:{groupID:Z,key:Z,value:Un},getGroupCounters:{groupID:Z},getGroupMemberList:{groupID:Z,count:{type:"Number"}},getGroupMemberProfile:{groupID:Z,userIDList:Q,memberCustomFieldFilter:{type:"Array"}},addGroupMember:{groupID:Z,userIDList:Q},setGroupMemberRole:{groupID:Z,userID:Z,role:Z},setGroupMemberMuteTime:{groupID:Z,userID:Z,muteTime:{type:"Number",validator:function(e){return 0<=e}}},setGroupMemberNameCard:{groupID:Z,userID:{type:"String"},nameCard:{type:"String",validator:function(e,t,n){return dt(e)?(e.length,!0):(Xt({api:t,paramName:n,desc:Qt()}),!1)}}},setGroupMemberCustomField:{groupID:Z,userID:{type:"String"},memberCustomField:Q},deleteGroupMember:{groupID:Z},markGroupMemberList:{groupID:Z,markType:{type:"number",validator:function(e,t,n){return Ye(e)?!(e<1e3&&(Xt({api:t,paramName:n,desc:pn(n,1e3)}),1)):(Xt({api:t,paramName:n,desc:tn()}),!1)}},userIDList:t({},Q),enableMark:t({},Pn)},createTextMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){return We(e)?dt(e.text)?0!==e.text.length||(Xt({api:t,paramName:"payload.text",desc:gn()}),!1):(Xt({api:t,paramName:"payload.text",desc:Qt()}),!1):(Xt({api:t,paramName:n,desc:fn()}),!1)}})},createTextAtMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){return We(e)?dt(e.text)?0===e.text.length?(Xt({api:t,paramName:"payload.text",desc:gn()}),!1):!(e.atUserList&&!Ze(e.atUserList)&&(Xt({api:t,paramName:"payload.atUserList",desc:rn()}),1)):(Xt({api:t,paramName:"payload.text",desc:Qt()}),!1):(Xt({api:t,paramName:n,desc:fn()}),!1)}})},createCustomMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){return We(e)?e.data&&!dt(e.data)?(Xt({api:t,paramName:"payload.data",desc:Qt()}),!1):e.description&&!dt(e.description)?(Xt({api:t,paramName:"payload.description",desc:Qt()}),!1):!(e.extension&&!dt(e.extension)&&(Xt({api:t,paramName:"payload.extension",desc:Qt()}),1)):(Xt({api:t,paramName:"payload",desc:fn()}),!1)}})},createImageMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){if(!We(e))return Xt({api:t,paramName:n,desc:fn()}),!1;if(pt(e.file))return Xt({api:t,paramName:"payload.file",desc:nn()}),!1;if(te){if(!(e.file instanceof HTMLInputElement||Ke(e.file)))return We(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Xt({api:t,paramName:"payload.file",desc:mn()}),!1):(Xt({api:t,paramName:"payload.file",desc:on()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Xt({api:t,paramName:"payload.file",desc:mn()}),!1}return!0},onProgress:{type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:ln()}),!0}}})},createAudioMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){return!!We(e)||(Xt({api:t,paramName:n,desc:fn()}),!1)}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:ln()}),!0}}},createVideoMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){if(!We(e))return Xt({api:t,paramName:n,desc:fn()}),!1;if(pt(e.file))return Xt({api:t,paramName:"payload.file",desc:nn()}),!1;if(te){if(!(e.file instanceof HTMLInputElement||Ke(e.file)))return We(e.file)&&"undefined"!=typeof uni?!!Ke(e.file.tempFile)||(Xt({api:t,paramName:"payload.file",desc:mn()}),!1):(Xt({api:t,paramName:"payload.file",desc:on()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Xt({api:t,paramName:"payload.file",desc:mn()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:ln()}),!0}}},createFaceMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){return We(e)?Ye(e.index)?!!dt(e.data)||(Xt({api:t,paramName:"payload.data",desc:Qt()}),!1):(Xt({api:t,paramName:"payload.index",desc:tn()}),!1):(Xt({api:t,paramName:n,desc:fn()}),!1)}})},createFileMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){if(!We(e))return Xt({api:t,paramName:n,desc:fn()}),!1;if(pt(e.file))return Xt({api:t,paramName:"payload.file",desc:nn()}),!1;if(te){if(!(e.file instanceof HTMLInputElement||Ke(e.file)))return We(e.file)&&"undefined"!=typeof uni?0!==e.file.tempFilePaths.length&&0!==e.file.tempFiles.length||(Xt({api:t,paramName:"payload.file",desc:mn()}),!1):(Xt({api:t,paramName:"payload.file",desc:on()}),!1);if(e.file instanceof HTMLInputElement&&0===e.file.files.length)return Xt({api:t,paramName:"payload.file",desc:mn()}),!1}return!0}}),onProgress:{type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:ln()}),!0}}},createLocationMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){return We(e)?dt(e.description)?Ye(e.longitude)?!!Ye(e.latitude)||(Xt({api:t,paramName:"payload.latitude",desc:tn()}),!1):(Xt({api:t,paramName:"payload.longitude",desc:tn()}),!1):(Xt({api:t,paramName:"payload.description",desc:Qt()}),!1):(Xt({api:t,paramName:n,desc:fn()}),!1)}})},createMergerMessage:{to:Z,conversationType:Z,payload:t(t({},$),{},{validator:function(e,t,n){if(He(e.messageList))return Xt({api:t,paramName:"payload.messageList",desc:sn()}),!1;if(He(e.compatibleText))return Xt({api:t,paramName:"payload.compatibleText",desc:en("compatibleText")}),!1;var o=!1;return e.messageList.forEach((function(e){e.status===Nn&&(o=!0)})),!o||(Xt({api:t,paramName:"payload.messageList",desc:Vn("MergeFailedMessageLog")}),!1)}})},revokeMessage:[t(t({name:"message"},$),{},{validator:function(e,t,n){return He(e)?(Xt({api:t,paramName:n,desc:vn()}),!1):e.conversationType===S.CONV_SYSTEM?(Xt({api:t,paramName:n,desc:Vn("MessageCanBeRevokedDesc")}),!1):!0!==e.isRevoked||(Xt({api:t,paramName:n,desc:Vn("MessageRevokedLog")}),!1)}})],deleteMessage:[t(t({name:"messageList"},Q),{},{validator:function(e,t,n){return!He(e)||(Xt({api:t,paramName:n,desc:sn()}),!1)}})],translateText:{sourceTextList:Q,sourceLanguage:Z,targetLanguage:Z},convertVoiceToText:{message:t(t({},$),{},{validator:function(e,t,n){return He(e)?(Xt({api:t,paramName:n,desc:vn()}),!1):e.type===S.MSG_AUDIO&&e.status===Dn||(Xt({api:t,paramName:n,desc:Vn("AudioMessageRequiredLog")}),!1)}})},modifyMessage:[t(t({name:"message"},$),{},{validator:function(e,t,n){return He(e)?(Xt({api:t,paramName:n,desc:vn()}),!1):e.conversationType===S.CONV_SYSTEM?(Xt({api:t,paramName:n,desc:Vn("MessageCanBeModifiedLog")}),!1):!0!==e._onlineOnlyFlag||(Xt({api:t,paramName:n,desc:Vn("OnlineMessageNotSupportLog")}),!1)}})],searchCloudMessages:{keywordList:xn.keywordListForMsg,keywordListMatchType:xn.keywordListMatchType,cursor:xn.cursor,senderUserIDList:{type:"Array",required:!1,validator:function(e,t,n){return kn(e,t,n,{allowUndefined:!0,allowEmpty:!0,maxLength:5})}},messageTypeList:{type:"Array",required:!1,validator:function(e,t,n){if(!e)return!0;if(!kn(e,t,n,{allowUndefined:!0,allowEmpty:!0}))return!1;var o=[S.MSG_TEXT,S.MSG_IMAGE,S.MSG_AUDIO,S.MSG_FILE,S.MSG_VIDEO,S.MSG_LOCATION,S.MSG_CUSTOM,S.MSG_MERGER];return!(0<e.filter((function(e){return-1===o.indexOf(e)})).length&&(Xt({api:t,paramName:n,desc:Cn(n,"message")}),1))}},conversationID:{type:"String",required:!1,validator:function(e){return!e||Jt(e)}},timePosition:{type:"number",required:!1,validator:function(e,t,n){return En(e,t,n,{allowUndefined:!0,min:0})}},timePeriod:{type:"number",required:!1,validator:function(e,t,n){return En(e,t,n,{allowUndefined:!0,min:0})}}},searchCloudUsers:{keywordList:xn.keywordListExceptMsg,keywordListMatchType:xn.keywordListMatchType,cursor:xn.cursor,count:xn.count,miniBirthday:{type:"Number",required:!1,validator:function(e,t,n){return En(e,t,n,{allowUndefined:!0,min:0})}},maxBirthday:{type:"Number",required:!1,validator:function(e,t,n){return En(e,t,n,{allowUndefined:!0,min:0})}},gender:{type:"String",required:!1,validator:function(e,t,n){return!e||e===S.GENDER_FEMALE||e===S.GENDER_MALE||Xt({api:t,paramName:n,desc:"".concat(e," is invalid match type")})}}},searchCloudGroups:{keywordList:xn.keywordListExceptMsg,keywordListMatchType:xn.keywordListMatchType,cursor:xn.cursor,count:xn.count,groupTypeList:xn.groupTypeList},searchCloudGroupMembers:{keywordList:xn.keywordListExceptMsg,keywordListMatchType:xn.keywordListMatchType,cursor:xn.cursor,count:xn.count,groupTypeList:xn.groupTypeList,groupIDList:{type:"Array",required:!1,validator:function(e,t,n){return kn(e,t,n,{allowUndefined:!0,allowEmpty:!0})}}},getUserProfile:{userIDList:{type:"Array",validator:function(e,t,n){return Ze(e)?(0===e.length&&Xt({api:t,paramName:n,desc:sn()}),!0):(Xt({api:t,paramName:n,desc:rn()}),!1)}}},updateMyProfile:{profileCustomField:{type:"Array",validator:function(e,t,n){return!!pt(e)||!!Ze(e)||(Xt({api:t,paramName:n,desc:rn()}),!1)}}},setSelfStatus:{customStatus:{type:"String",validator:function(e,t,n){return!!dt(e)||(Xt({api:t,paramName:n,desc:Qt()}),!1)}}},getUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return Ze(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:rn()}),!1)}}},subscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return Ze(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:rn()}),!1)}}},unsubscribeUserStatus:{userIDList:{type:"Array",validator:function(e,t,n){return!e||!!Ze(e)||(Xt({api:t,paramName:n,desc:rn()}),!1)}}},addFriend:{to:Z,source:{type:"String",required:!0,validator:function(e,t,n){return!(!e||(e.startsWith("AddSource_Type_")?8<e.replace("AddSource_Type_","").length&&(Xt({api:t,paramName:n,desc:un("keyword",8)}),1):(Xt({api:t,paramName:n,desc:Vn("SourcePrefixLog")}),1)))}},remark:{type:"String",required:!1,validator:function(e,t,n){return!(dt(e)&&96<e.length&&(Xt({api:t,paramName:n,desc:un(n,96)}),1))}}},deleteFriend:{userIDList:Q},checkFriend:{userIDList:Q},getFriendProfile:{userIDList:Q},updateFriend:{userID:Z,remark:{type:"String",required:!1,validator:function(e,t,n){return!(dt(e)&&96<e.length&&(Xt({api:t,paramName:n,desc:un(n,96)}),1))}},friendCustomField:{type:"Array",required:!1,validator:function(e,t,n){if(e){if(!Ze(e))return Xt({api:t,paramName:n,desc:rn()}),!1;var o=!0;return e.forEach((function(e){return dt(e.key)&&-1!==e.key.indexOf("Tag_SNS_Custom")?dt(e.value)?8<e.key.replace("Tag_SNS_Custom_","").length?(Xt({api:t,paramName:n,desc:un("keyword",8)}),o=!1):void 0:(Xt({api:t,paramName:n,desc:hn("value")}),o=!1):(Xt({api:t,paramName:n,desc:Vn("FriendCustomFieldPrefixLog")}),o=!1)})),o}return!0}}},acceptFriendApplication:{userID:Z},refuseFriendApplication:{userID:Z},deleteFriendApplication:{userID:Z},createFriendGroup:{name:Z},deleteFriendGroup:{name:Z},addToFriendGroup:{name:Z,userIDList:Q},removeFromFriendGroup:{name:Z,userIDList:Q},renameFriendGroup:{oldName:Z,newName:Z},sendMessageReadReceipt:[{name:"messageList",type:"Array",validator:function(e,t,n){return Ze(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:rn()}),!1)}}],getMessageReadReceiptList:[{name:"messageList",type:"Array",validator:function(e,t,n){return Ze(e)?0!==e.length||(Xt({api:t,paramName:n,desc:sn()}),!1):(Xt({api:t,paramName:n,desc:rn()}),!1)}}],createTopicInCommunity:{groupID:Z,topicName:Z},deleteTopicFromCommunity:{groupID:Z,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!Ze(e)||(Xt({api:t,paramName:n,desc:rn()}),!1)}}},updateTopicProfile:{groupID:Z,topicID:Z},getTopicList:{groupID:Z,topicIDList:{type:"Array",validator:function(e,t,n){return!e||!!Ze(e)||(Xt({api:t,paramName:n,desc:rn()}),!1)}}},followUser:[t({name:"userIDList"},Q)],unfollowUser:[t({name:"userIDList"},Q)],getMyFollowingList:[t(t({name:"startIndex"},Z),{},{required:!1})],getMyFollowersList:[t(t({name:"startIndex"},Z),{},{required:!1})],getMutualFollowersList:[t(t({name:"startIndex"},Z),{},{required:!1})],getUserFollowInfo:[t(t({name:"userIDList"},Q),{},{required:!1})],checkFollowType:[t({name:"userIDList"},Q)],addSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:en(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:an()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],removeSignalingListener:[{name:"eventName",type:"String",validator:function(e,t,n){return"string"==typeof e&&0!==e.length||(Xt({api:t,paramName:n,desc:en(n)}),!1)}},{name:"handler",type:"Function",validator:function(e,t,n){return"function"!=typeof e?(Xt({api:t,paramName:n,desc:an()}),!1):(""===e.name&&Xt({api:t,paramName:n,desc:_n()}),!0)}}],invite:{userID:Z},inviteSync:[t(t({},$),{},{validator:function(e,t,n){return We(e)?!!dt(e.userID)||(Xt({api:t,paramName:"options.userID",desc:Qt()}),!1):(Xt({api:t,paramName:"options",desc:fn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:an()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:an()}),!0}}],inviteInGroup:{groupID:Z,inviteeList:Q},inviteInGroupSync:[t(t({},$),{},{validator:function(e,t,n){return We(e)?dt(e.groupID)?!!Ze(e.inviteeList)||(Xt({api:t,paramName:"options.inviteeList",desc:rn()}),!1):(Xt({api:t,paramName:"options.groupID",desc:Qt()}),!1):(Xt({api:t,paramName:"options",desc:fn()}),!1)}}),{name:"successCb",type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:an()}),!0}},{name:"errorCb",type:"Function",required:!1,validator:function(e,t,n){return pt(e)&&Xt({api:t,paramName:n,desc:an()}),!0}}],accept:{inviteID:Z},reject:{inviteID:Z},getSignalingInfo:[t(t({name:"message"},$),{},{validator:function(e,t,n){return!He(e)||(Xt({api:t,paramName:n,desc:vn()}),!1)}})],modifyInvitation:{inviteID:Z,data:Z}},Gn={login:1,logout:1,getLoginUser:1,getServerTime:1,on:1,once:1,off:1,setLogLevel:1,registerPlugin:1,destroy:1,isReady:1,createTextMessage:1,createTextAtMessage:1,createImageMessage:1,createAudioMessage:1,createVideoMessage:1,createCustomMessage:1,createFaceMessage:1,createFileMessage:1,createLocationMessage:1,createMergerMessage:1,downloadMergerMessage:1,createForwardMessage:1,sendMessage:1,resendMessage:1,revokeMessage:1,deleteMessage:1,translateText:1,convertVoiceToText:1,modifyMessage:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageReadReceiptList:1,setMessageExtensions:1,getMessageExtensions:1,deleteMessageExtensions:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1,getMessageList:1,findMessage:1,getMessageListHopping:1,setMessageRead:1,setAllMessageRead:1,getConversationList:1,getConversationProfile:1,deleteConversation:1,setConversationDraft:1,pinConversation:1,getTotalUnreadMessageCount:1,setConversationCustomData:1,markConversation:1,createConversationGroup:1,getConversationGroupList:1,deleteConversationGroup:1,renameConversationGroup:1,addConversationsToGroup:1,deleteConversationsFromGroup:1,clearHistoryMessage:1,setMessageRemindType:1,setAllReceiveMessageOpt:1,getAllReceiveMessageOpt:1,getGroupList:1,getGroupProfile:1,createGroup:1,joinGroup:1,updateGroupProfile:1,quitGroup:1,dismissGroup:1,changeGroupOwner:1,searchGroupByID:1,getGroupApplicationList:1,handleGroupApplication:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getJoinedCommunityList:1,createTopicInCommunity:1,deleteTopicFromCommunity:1,updateTopicProfile:1,getTopicList:1,getGroupMemberProfile:1,getGroupMemberList:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberNameCard:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberCustomField:1,getGroupOnlineMemberCount:1,markGroupMemberList:1,getMyProfile:1,getUserProfile:1,updateMyProfile:1,setSelfStatus:1,getUserStatus:1,subscribeUserStatus:1,unsubscribeUserStatus:1,getBlacklist:1,addToBlacklist:1,removeFromBlacklist:1,searchCloudMessages:1,searchCloudUsers:1,searchCloudGroups:1,searchCloudGroupMembers:1,getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,updateFriend:1,getFriendProfile:1,getFriendApplicationList:1,refuseFriendApplication:1,deleteFriendApplication:1,acceptFriendApplication:1,setFriendApplicationRead:1,getFriendGroupList:1,createFriendGroup:1,renameFriendGroup:1,deleteFriendGroup:1,addToFriendGroup:1,removeFromFriendGroup:1,followUser:1,unfollowUser:1,getMyFollowingList:1,getMyFollowersList:1,getMutualFollowersList:1,getUserFollowInfo:1,checkFollowType:1,callExperimentalAPI:1,addSignalingListener:1,removeSignalingListener:1,invite:1,inviteSync:1,inviteInGroup:1,inviteInGroupSync:1,cancel:1,accept:1,reject:1,getSignalingInfo:1,modifyInvitation:1},Fn=(s(uo,p(Error)),wn=g(uo),i(uo)),zn={NO_SDKAPPID:2e3,NO_ACCOUNT_TYPE:2001,NO_IDENTIFIER:2002,NO_USERSIG:2003,NO_TINYID:2022,NO_A2KEY:2023,USER_NOT_LOGGED_IN:2024,REPEAT_LOGIN:2025,COS_UNDETECTED:2040,COS_GET_SIG_FAIL:2041,MSG_SEND_FAIL:2100,MSG_SEND_FAIL_NOT_IN_AV:2101,MSG_INSTANCE_REQUIRED:2105,MSG_INVALID_CONV_TYPE:2106,MSG_F_IS_EMPTY:2108,MSG_ONPROGRESS_ERR:2109,MSG_REVOKE_FAIL:2110,MSG_DELETE_FAIL:2111,MSG_UNREAD_ALL_FAIL:2112,READ_RECEIPT_MSG_LIST_EMPTY:2114,MSG_SEND_GRP_WITH_TOPIC_FAIL:2115,CANNOT_DELETE_GRP_SYSTEM_NOTICE:2116,TRANSLATE_TEXT_FAIL:2117,VOICE_TO_TEXT_FAIL:2118,UNSUPPORTED_VOICE_FORMAT:2119,MSG_I_SELECT_F_FIRST:2251,MSG_I_TYPES_LIMIT:2252,MSG_I_SIZE_LIMIT:2253,MSG_A_UPLOAD_FAIL:2300,MSG_A_SIZE_LIMIT:2301,MSG_V_UPLOAD_FAIL:2350,MSG_V_SIZE_LIMIT:2351,MSG_V_TYPES_LIMIT:2352,MSG_F_UPLOAD_FAIL:2400,MSG_F_SELECT_F_FIRST:2401,MSG_F_SIZE_LIMIT:2402,MSG_F_URL_IS_EMPTY:2403,MSG_MERGER_TYPE_INVALID:2450,MSG_MERGER_KEY_INVALID:2451,MSG_MERGER_DOWNLOAD_FAIL:2452,MSG_FORWARD_TYPE_INVALID:2453,MSG_FORWARD_INVALID_ELEMENTS:2454,MSG_MODIFY_CONFLICT:2480,MSG_MODIFY_DISABLED_IN_AV:2481,CONV_NOT_FOUND:2500,USER_OR_GRP_NOT_FOUND:2501,CONV_UN_RECORDED_TYPE:2502,INVALID_CONV_ID:2503,ILLEGAL_GRP_TYPE:2600,ILLEGAL_GRP_ID:2602,CANNOT_FIND_GRP:2603,CANNOT_CHANGE_OWNER_IN_AV:2620,CANNOT_CHANGE_OWNER_TO_SELF:2621,MEMBER_NOT_IN_GRP:2623,JOIN_GRP_FAIL:2660,CANNOT_ADD_MEMBER_IN_AV:2661,CANNOT_JOIN_NON_AV_WITHOUT_LOGIN:2662,NOT_OWNER:2681,INVALID_MEMBER_ROLE:2683,CANNOT_SET_SELF_MEMBER_ROLE:2684,CANNOT_MUTE_SELF:2685,BAN_DURATION_INVALID:2686,OPERATION_NOT_SUPPORTED_IN_AV:2687,NOT_MY_FRIEND:2700,ALREADY_MY_FRIEND:2701,FRIEND_GRP_EXISTED:2710,FRIEND_GRP_NOT_EXIST:2711,FRIEND_APPLICATION_NOT_EXIST:2716,UPDATE_PROFILE_INVALID_PARAM:2721,UPDATE_PROFILE_NO_KEY:2722,CANNOT_ADD_SELF_TO_BLACKLIST:2742,NETWORK_ERROR:2800,NETWORK_TIMEOUT:2801,NO_NETWORK:2805,UNCAUGHT_ERROR:2903,INVALID_OPERATION:2905,INVALID_TRTC_CMD:2995,OVER_FREQUENCY_LIMIT:2996,NO_PROTOCOL:2997,NO_MODULE:2998,SDK_IS_NOT_READY:2999,LOGGING_IN:3e3,LOGIN_FAILED:3001,KICKED_OUT_MULT_DEVICE:3002,KICKED_OUT_MULT_ACCOUNT:3003,KICKED_OUT_USERSIG_EXPIRED:3004,LOGGED_OUT:3005,KICKED_OUT_REST_API:3006,ILLEGAL_TOPIC_ID:3021,NO_USE:3122,PROFANITY_FOUND:3123,OPTIONS_IS_EMPTY:3153,MSG_A2KEY_EXPIRED:20002,ACCOUNT_A2KEY_EXPIRED:70001,HELLO_ANSWER_KICKED_OUT:1002,OPEN_SERVICE_OVERLOAD_ERROR:60022,SIGNALING_INVALID_INVITE_ID:8010,SIGNALING_NO_PERMISSION:8011,SIGNALING_ALREADY_EXISTS:8012,INVALID_CANCEL_MESSAGE:8020},Hn=null,jn=(i(co,[{key:"isLoggedIn",value:function(){return this._m.get(12).isLoggedIn()}},{key:"isOversea",value:function(){return this._m.get(12).isOversea()}},{key:"isPrivateNetWork",value:function(){var e=this._m.get(12);return e.isPrivateNetWork()&&!e.getFileDownloadProxy()}},{key:"getFileDownloadProxy",value:function(){return this._m.get(12).getFileDownloadProxy()}},{key:"getDowloadFileAuthKey",value:function(){return this._m.get(12).getDowloadFileAuthKey()}},{key:"getMyUserID",value:function(){return this._m.get(12).getUserID()}},{key:"getMyTinyID",value:function(){return this._m.get(12).getTinyID()}},{key:"getSDKAppID",value:function(){return this._m.get(12).getSDKAppID()}},{key:"isIntl",value:function(){return this._m.get(12).isIntl()}},{key:"isUsingChatCore",value:function(){return this._m.get(12).isUsingChatCore()}},{key:"isDevMode",value:function(){return this._m.get(12).isDevMode()}},{key:"get",value:function(e){return this._m.get(e)}},{key:"getPlatform",value:function(){return ae}},{key:"getCloudConfig",value:function(e){return this._m.get(23).getCloudConfig(e)}},{key:"emitOEvt",value:function(e,t){this._m.getOEmitInst().emit(e,t)}},{key:"emitIEvt",value:function(e,t){this._m.getIEmitInst().emit(e,t)}},{key:"getIEmitInst",value:function(){return this._m.getIEmitInst()}},{key:"req",value:function(e){return this._m.get(20).req(e)}},{key:"canIUse",value:function(e){return this._m.get(27).canIUse(e)}},{key:"getErrMsg",value:function(e,t,n){return this._m.getErrMsg(e,t,n)}},{key:"warn",value:function(e,t,n){(e=this.getErrMsg(e,t,n))&&Re.w(e)}},{key:"noUse",value:function(e){var t=zn.NO_USE;return Mn({code:t,message:this.getErrMsg(t,e)})}}]),Un=co,{LOGIN:"wslogin",LOGOUT:"wslogout",HELLO:"wshello",KICK_OTHER:"KickOther",SYNC_UNREAD_MSG:"getmsg",SEND_C2C_MSG:"sendmsg",SEND_GRP_MSG:"send_group_msg",GET_USER_PROFILE:"portrait_get_all",UPDATE_MY_PROFILE:"portrait_set",GET_BL:"black_list_get",ADD_TO_BL:"black_list_add",RM_FROM_BL:"black_list_delete",GET_FD_LIST:"friend_get",GET_FD_PROFILE:"friend_get_specified",CHECK_FD:"friend_check",DEL_FD:"friend_delete",ADD_FD:"friend_add",UPDATE_FD:"friend_update",RESPOND_FD_APPLICATION:"friend_response",GET_FD_APPLICATION_LIST:"pendency_get",DEL_FD_APPLICATION:"pendency_delete",REFUSE_FD_APPLICATION:"pendency_refuse",REPORT_FD_APPLICATION:"pendency_report",GET_FD_GRP_LIST:"group_get",CREATE_FD_GRP:"group_add",DEL_FD_GRP:"group_delete",UPDATE_FD_GRP:"group_update",REVOKE_C2C_MSG:"msgwithdraw",SET_C2C_MSG_READ:"msgreaded",SET_C2C_PEER_MUTE_NOTIFICATIONS:"set_c2c_peer_mute_notifications",GET_C2C_PEER_MUTE_NOTIFICATIONS:"get_c2c_peer_mute_notifications",GET_C2C_ROAMING_MSG:"getroammsg",GET_C2C_PEER_READ_TIME:"get_peer_read_time",DEL_C2C_MSG:"delete_c2c_msg_ramble",MODIFY_C2C_MSG:"modify_c2c_msg",MODIFY_C2C_MSG_EXT:"set_key_values",GET_C2C_MSG_EXT:"get_key_values",ADD_C2C_MSG_REACTION:"reaction_add",RM_C2C_MSG_REACTION:"reaction_del",GET_C2C_MSG_REACTIONS:"reaction_multi_stat",GET_C2C_MSG_REACTION_USER_LIST:"reaction_iterate",PAGING_GET_CONV_LIST:"page_get",DEL_CONV:"batch_delete",CLEAR_HISTORY_MSG:"clear_msg",PIN_CONV:"top",DEL_GROUP_AT_TIPS:"deletemsg",SET_CONV_CUSTOM_DATA:"set_conv_custom_data",MARK_CONV:"mark_contact",CREATE_CONV_GRP:"create_contact_group",DEL_CONV_GRP:"del_contact_group",RENAME_CONV_GRP:"update_contact_group",ADD_CONV_TO_GRP:"add_conv_to_group",DEL_CONV_FROM_GRP:"del_conv_from_group",GET_CONV_GRP_LIST:"get_contact_group",SEARCH_CONV_GRP_MARK:"search_contact_group",GET_GRP_LIST:"get_joined_group_list",GET_GRP_PROFILE:"get_group_self_member_info",CREATE_GRP:"create_group",DISMISS_GRP:"destroy_group",UPDATE_GRP_PROFILE:"modify_group_base_info",APPLY_JOIN_GRP:"apply_join_group",APPLY_JOIN_GRP_NOAUTH:"apply_join_group_noauth",QUIT_GRP:"quit_group",SEARCH_GRP:"get_group_public_info",CHANGE_GRP_OWNER:"change_group_owner",HANDLE_GRP_APPLICATION:"handle_apply_join_group",HANDLE_INVITE_JOIN_GRP:"handle_invite_join_permission_group",HANDLE_GRP_INVITATION:"handle_invite_join_group",REVOKE_GRP_MSG:"group_msg_recall",SET_GRP_MSG_READ:"msg_read_report",SET_ALL_MSG_READ:"read_all_unread_msg",GET_GRP_ROAMING_MSG:"group_msg_get",GET_READ_RECEIPT:"get_group_msg_receipt",SEND_READ_RECEIPT:"group_msg_receipt",SEND_C2C_READ_RECEIPT:"c2c_msg_read_receipt",GET_READ_RECEIPT_DETAIL:"get_group_msg_receipt_detail",GET_GRP_PENDENCY:"get_pendency",DEL_GRP_SYSTEM_NOTICE:"deletemsg",AV_POLLING:"get_msg",AV_NOAUTH_POLLING:"get_msg_noauth",GET_ONLINE_MBR_NUM:"get_online_member_num",DEL_GRP_MSG:"delete_group_ramble_msg_by_seq",MODIFY_GRP_MSG:"modify_group_msg",SET_GRP_ATTR:"set_group_attr",MODIFY_GRP_ATTR:"modify_group_attr",DEL_GRP_ATTR:"delete_group_attr",CLEAR_GRP_ATTR:"clear_group_attr",GET_GRP_ATTR:"get_group_attr",MODIFY_GRP_MSG_EXT:"group_set_key_values",GET_GRP_MSG_EXT:"group_get_key_values",GET_GRP_NOTIFY:"batch_get_group_notify",UPDATE_GRP_COUNTER:"update_group_counter",GET_GRP_COUNTER:"get_group_counter",ADD_GRP_MSG_REACTION:"group_reaction_add",RM_GRP_MSG_REACTION:"group_reaction_del",GET_GRP_MSG_REACTIONS:"group_reaction_multi_stat",GET_GRP_MSG_REACTION_USER_LIST:"group_reaction_iterate",GET_GRP_MBR_LIST:"get_group_member_info",GET_AV_MBR_LIST:"get_members",GET_GRP_MBR_PROFILE:"get_specified_group_member_info",ADD_GRP_MBR:"add_group_member",DEL_GRP_MBR:"delete_group_member",BAN_AV_MBR:"ban_group_member",MODIFY_GRP_MBR_INFO:"modify_group_member_info",MARK_AV_MBR_INFO:"modify_user_info",COS_SIGN:"cos",COS_PRE_SIG:"pre_sig",SIMPLE_COS_PRE_SIG:"simple_sig",GET_IMAGE_INFO:"get_imageinfo",GET_IP:"get_final_ip",VIDEO_COVER:"video_cover",SSO_STAT:"tim_web_report_v2",PING:"alive",MSG_PUSH:"msg_push",CS:"query",GRP_CS:"query_grp",MBR_CS:"query_grp_member",USER_CS:"query_user",MULTI_MSG_PUSH:"multi_msg_push_ws",MSG_PUSH_ACK:"ws_msg_push_ack",STATUS_FORCE_OFFLINE:"stat_forceoffline",UPLOAD_MERGER_MSG:"save_relay_json_msg",DOWNLOAD_MERGER_MSG:"get_relay_json_msg",FETCH_CLOUD_CTRL_CONFIG:"fetch_config",PUSHED_CLOUD_CTRL_CONFIG:"push_configv2",FETCH_COMMERCIAL_CONFIG:"fetch_imsdk_purchase_bitsv2",PUSHED_COMMERCIAL_CONFIG:"push_imsdk_purchase_bitsv2",OVERLOAD_NOTIFY:"notify2",CREATE_TOPIC:"create_topic",DEL_TOPIC:"destroy_topic",UPDATE_TOPIC_PROFILE:"modify_topic",GET_TOPIC_LIST:"get_topic",SET_SELF_STATUS:"ws_set_custom_status",GET_USER_STATUS:"ws_get_user_status",SUB_USER_STATUS:"ws_status_subscribe",UNSUB_USER_STATUS:"ws_status_unsubscribe",STAT_BACKGROUND:"ws_stat_background",STAT_FOREGROUND:"ws_stat_foreground",SET_TOKEN:"ws_stat_settoken",PUSH_REPORT:"uniapp_sdk_report",GET_PROFANITY_LIST:"get_local_words",TRANSLATE_TEXT:"ws_batch_trans_text",VOICE_TO_TEXT:"ws_sentence_recognition",FOLLOW:"follow_add",UNFOLLOW:"follow_delete",GET_FOLLOW:"follow_get",GET_FOLLOW_INFO:"follow_get_info",CHECK_FOLLOW_TYPE:"follow_check",SET_ALL_RECEIVE_MSG_OPT:"ws_set_do_not_disturb",GET_ALL_RECEIVE_MSG_OPT:"ws_get_do_not_disturb"}),qn="networkRTT",Kn="messageE2EDelay",Yn="sendMessageC2C",$n="sendMessageGroup",Wn="sendMessageGroupAV",Zn="sendMessageRichMedia",Jn="cosUpload",Xn="messageReceivedGroup",Qn="messageReceivedGroupAVPush",eo="messageReceivedGroupAVPull",to=(r(Pn={},qn,2),r(Pn,Kn,3),r(Pn,Yn,4),r(Pn,$n,5),r(Pn,Wn,6),r(Pn,Zn,7),r(Pn,Xn,8),r(Pn,Qn,9),r(Pn,eo,10),r(Pn,Jn,11),Pn),no={info:4,warning:5,error:6},oo={wifi:1,"2g":2,"3g":3,"4g":4,"5g":5,unknown:6,none:7,online:8},ao={login:4,plugin_search:16,plugin_translate:16,plugin_voice_to_text:16,plugin_cs:16,plugin_push:16,plugin_bot:16,plugin_emoji_reaction:16,tui_key_features:16},io=(i(lo,[{key:"updateTimeStamp",value:function(){this.timestamp=we()}},{key:"start",value:function(e){return this._startts=e,this}},{key:"end",value:function(){var e,t=this,n=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this._sentFlag||(this._netMonitorModule&&(e=this._netMonitorModule.getNetworkType(),this.setNetworkType(e)),e=we(),0===this.costTime&&(this.costTime=e-this._startts),this.setMoreMessage("startts:".concat(this._startts," endts:").concat(e)),n?(this._sentFlag=!0,this._eventStatModule&&this._eventStatModule.pushIn(this)):setTimeout((function(){t._sentFlag=!0,t._eventStatModule&&t._eventStatModule.pushIn(t)}),0))}},{key:"setError",value:function(e){if(!(e instanceof Error))return Re.w("".concat(this._n,".setError value not instanceof Error, please check!")),this;if(this._sentFlag)return this;var t=!0;return(t=this._netMonitorModule?this._netMonitorModule.isOnline():t)?(e.code&&this.setCode(e.code),e.message&&this.setMoreMessage(e.message)):this.setCode(zn.NO_NETWORK),this.setLevel("error"),this}},{key:"setCode",value:function(e){return pt(e)||this._sentFlag||("ECONNABORTED"===e&&(this.code=103),Ye(e)?this.code=e:Re.w("".concat(this._n,".setCode value not a number, please check!"),e,n(e))),this}},{key:"setMessage",value:function(e){return pt(e)||this._sentFlag||(Ye(e)&&(this.message=e.toString()),dt(e)&&(this.message=e)),this}},{key:"setCostTime",value:function(e){return this.costTime=e,this}},{key:"setLevel",value:function(e){return pt(e)||this._sentFlag||(this.level=no[e]),this}},{key:"setMoreMessage",value:function(e){return He(this.moreMessage)?this.moreMessage="".concat(e):this.moreMessage+=" ".concat(e),this}},{key:"setNetworkType",value:function(e){return pt(e)?Re.w("".concat(this._n,".setNetworkType value is undefined, please check!")):(e=oo[e.toLowerCase()],pt(e)||(this.networkType=e)),this}},{key:"getStartTs",value:function(){return this._startts}},{key:"setUIPlatform",value:function(e){return this.uiPlatform=e,this}},{key:"setExtension",value:function(e){return this.extension=e,this}},{key:"setEventType",value:function(e){return this.eventType=e,this}}],[{key:"bindEventStatModule",value:function(e){lo.prototype._eventStatModule=e}},{key:"bindNetMonitorModule",value:function(e){lo.prototype._netMonitorModule=e}}]),lo),ro=(i(so,[{key:"setText",value:function(e){this.content.text=e}},{key:"sendable",value:function(){return 0!==this.content.text.length}}]),so);function so(e){o(this,so),this.type=S.MSG_TEXT,this.content={text:e.text||""}}function lo(e){o(this,lo),this._n="SSOLogData",this.eventType=ao[e]||0,this.timestamp=0,this.networkType=8,this.code=0,this.message="",this.moreMessage="",this.extension=e,this.costTime=0,this.duplicate=!1,this.level=4,this.uiPlatform=void 0,this._sentFlag=!1,this._startts=we()}function co(e){o(this,co),this._m=e,this._n=""}function uo(e){o(this,uo),t=wn.call(this);var t,n=e.code,a=e.message;return e=e.data,t.code=n,a?t.message=a:t._getErrMsg&&(t.message=t._getErrMsg(t.code)),t.data=e||{},t}function po(e,t,n,o){var a;if(o=3<arguments.length&&void 0!==o?o:[],e)return a=e,t&&(e.startsWith("http://")?a=e.replace(/^http:\/\/[^/]+/,t):e.startsWith("https://")&&(a=e.replace(/^https:\/\/[^/]+/,t))),n&&-1===a.indexOf("authKey=")&&go(a,o)?(-1<a.indexOf("?")?"".concat(a,"&authKey="):"".concat(a,"?authKey=")).concat(n):a}function ho(e,t,n){return n=2<arguments.length&&void 0!==n?n:[],e===S.MSG_VIDEO?go((t[0].content||t[0].payload).snapshotUrl,n)&&(t[0].content?(t[0].content.snapshotUrl=fo(t[0].content.snapshotUrl),t[0].content.thumbUrl=fo(t[0].content.thumbUrl)):(t[0].payload.snapshotUrl=fo(t[0].payload.snapshotUrl),t[0].payload.thumbUrl=fo(t[0].payload.thumbUrl))):e===S.MSG_FILE?go((t[0].content||t[0].payload).fileUrl,n)&&(t[0].content?t[0].content.fileUrl=fo(t[0].content.fileUrl):t[0].payload.fileUrl=fo(t[0].payload.fileUrl)):e===S.MSG_MERGER&&(e=(n=t[0].content||t[0].payload).downloadKey,n=void 0===(n=n.messageList)?[]:n,He(void 0===e?"":e)&&n.forEach((function(e){ho(e.messageBody[0].type,e.messageBody)}))),t}function fo(e){if(!e)return e;if(-1===e.indexOf("authKey="))return e;for(var t=(e=e.split("?"))[1].split("&"),n=0,o=0;o<t.length;o++)if(-1<t[o].indexOf("authKey=")){n=o;break}return t.splice(n,1),0<t.length?"".concat(e[0],"?").concat(t.join("&")):e[0]}function go(e,t){var n=!1;if(e){var o=(e=e.match(/:\/\/([0-9]?\.)?(.[^/:]+)/))&&e[2]||"";if(o.includes("rich-dev"))return 1;for(var a=0;a<t.length;a++)if(o.endsWith(t[a])){n=!0;break}}return n}i(Ho,[{key:"_initImageInfoModel",value:function(){var e=this;this._ImageInfoModel=function(t){this.instanceID=it(9999999),this.sizeType=t.type||0,this.type=0,this.size=t.size||0,this.width=t.width||0,this.height=t.height||0,this.imageUrl=t.imageUrl||t.url||"",this.url=po(t.url||e._imageMemoryURL,e._fileDownloadProxy,e._authKey,e._fileDNList)},this._ImageInfoModel.prototype={setSizeType:function(e){this.sizeType=e},setType:function(e){this.type=e},setImageUrl:function(e){e&&(this.imageUrl=e)},getImageUrl:function(){return this.imageUrl}}}},{key:"initImageInfoArray",value:function(e){for(var t,n=0,o=null;n<=2;)t=pt(e)||pt(e[n])?{type:0,size:0,width:0,height:0,url:""}:e[n],(o=new this._ImageInfoModel(t)).setSizeType(n+1),o.setType(n),this.addImageInfo(o),n++;this.updateAccessSideImageInfoArray()}},{key:"updateImageInfoArray",value:function(e){for(var t,n=this.content.imageInfoArray.length,o=0;o<n;o++)t=this.content.imageInfoArray[o],e[o].size&&(t.size=e[o].size),e[o].url&&t.setImageUrl(e[o].url),e[o].width&&(t.width=e[o].width),e[o].height&&(t.height=e[o].height)}},{key:"_autoFixUrl",value:function(){for(var e=this.content.imageInfoArray.length,t="",n="",o=["http","https"],a=null,i=0;i<e;i++)this.content.imageInfoArray[i].url&&""!==(a=this.content.imageInfoArray[i]).imageUrl&&(n=a.imageUrl.slice(0,a.imageUrl.indexOf("://")+1),t=a.imageUrl.slice(a.imageUrl.indexOf("://")+1),o.indexOf(n)<0&&(n="https:"),this.content.imageInfoArray[i].setImageUrl([n,t].join("")))}},{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateImageFormat",value:function(e){this.content.imageFormat=Le[e.toUpperCase()]||Le.UNKNOWN}},{key:"createImageDataASURLInWeb",value:function(e){void 0!==e&&0<e.files.length&&(this._imageMemoryURL=window.URL.createObjectURL(e.files[0]))}},{key:"createImageDataASURL",value:function(e){e&&e.url&&(this._imageMemoryURL=e.url)}},{key:"replaceImageInfo",value:function(e,t){this.content.imageInfoArray[t]instanceof this._ImageInfoModel||(this.content.imageInfoArray[t]=e)}},{key:"addImageInfo",value:function(e){3<=this.content.imageInfoArray.length||this.content.imageInfoArray.push(e)}},{key:"updateAccessSideImageInfoArray",value:function(){var e=this.content.imageInfoArray,t=void 0===(t=(n=e[0]).width)?0:t,n=void 0===(n=n.height)?0:n;0!==t&&0!==n&&(Pt(e),Object.assign(e[2],Ot({originWidth:t,originHeight:n,min:720})))}},{key:"sendable",value:function(){return 0!==this.content.imageInfoArray.length&&""!==this.content.imageInfoArray[0].imageUrl&&0!==this.content.imageInfoArray[0].size}}]);var mo=Ho,vo=(i(zo,[{key:"sendable",value:function(){return null!==this.content}}]),zo),_o=(i(Fo,[{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateAudioUrl",value:function(e){this.content.remoteAudioUrl=e}},{key:"sendable",value:function(){return""!==this.content.remoteAudioUrl}}]),Fo),yo={from:!0,groupID:!0,groupName:!0,to:!0},Io=(i(Go,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"remarkInfo":case"memberExtraInfo":case"onlineMemberInfo":break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;case"operatorInfo":t.content.operatorInfo={},t._initOperatorInfo(e[n]);break;case"memberInfoList":case"msgMemberInfo":t._updateMemberList(e[n]);break;case"memberNum":t.content[n]=e[n],t.content.memberCount=e[n];break;case"newGroupProfile":t.content.newGroupProfile={},t._initNewGroupProfile(e[n]);break;default:t.content[n]=e[n]}})),this.content.userIDList||(this.content.userIDList=[this.content.operatorID])}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];yo[o]&&(this.content.groupProfile[o]=e[o])}}},{key:"_initOperatorInfo",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];this.content.operatorInfo[o]=e[o]}}},{key:"_updateMemberList",value:function(e){He(this.content.memberList)?this.content.memberList=e:this.content.memberList.forEach((function(t){e.forEach((function(e){t.userID===e.userID&&Object.assign(t,e)}))}))}},{key:"_initNewGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];this.content.newGroupProfile[o]="muteAllMembers"!==o?e[o]:1===e[o]}}}]),Go),Co={from:!0,groupID:!0,groupName:!0,to:!0,groupType:!0},ko=(i(Bo,[{key:"_initContent",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"memberInfoList":break;case"remarkInfo":t.content.handleMessage=e[n];break;case"groupProfile":t.content.groupProfile={},t._initGroupProfile(e[n]);break;default:t.content[n]=e[n]}}))}},{key:"_initGroupProfile",value:function(e){for(var t=Object.keys(e),n=0;n<t.length;n++){var o=t[n];Co[o]&&("groupName"===o?this.content.groupProfile.name=e[o]:this.content.groupProfile[o]=e[o])}}}]),Bo),Eo=(i(Vo,[{key:"_getFileInfo",value:function(e){return pt(e.fileName)||pt(e.fileSize)?(e=e.file.files[0],W&&(e.path&&-1!==e.path.indexOf(".")&&(t=e.path.slice(e.path.lastIndexOf(".")+1).toLowerCase(),e.type=t,e.name||(e.name="".concat(it(999999),".").concat(t))),e.name||(e.type="",e.name=e.path.slice(e.path.lastIndexOf("/")+1).toLowerCase()),e.suffix&&(e.type=e.suffix),e.url||(e.url=e.path)),{size:e.size,name:e.name}):{size:e.fileSize,name:e.fileName};var t}},{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateFileUrl",value:function(e){this.content.fileUrl=e}},{key:"sendable",value:function(){return""!==this.content.fileUrl&&""!==this.content.fileName&&0!==this.content.fileSize}}]),Vo),To=(i(xo,[{key:"setData",value:function(e){return this.content.data=e,this}},{key:"setDescription",value:function(e){return this.content.description=e,this}},{key:"setExtension",value:function(e){return this.content.extension=e,this}},{key:"sendable",value:function(){return 0!==this.content.data.length||0!==this.content.description.length||0!==this.content.extension.length}}]),xo),So=(i(Uo,[{key:"updatePercent",value:function(e){this._percent=e,1<this._percent&&(this._percent=1)}},{key:"updateVideoUrl",value:function(e){e&&(this.content.remoteVideoUrl=e)}},{key:"updateSnapshotInfo",value:function(e){var t=e.snapshotUrl,n=e.snapshotWidth;e=e.snapshotHeight,He(t)||(this.content.thumbUrl=this.content.snapshotUrl=t),He(n)||(this.content.thumbWidth=this.content.snapshotWidth=Number(n)),He(e)||(this.content.thumbHeight=this.content.snapshotHeight=Number(e))}},{key:"sendable",value:function(){return""!==this.content.remoteVideoUrl}}]),Uo),Mo=(i(Po,[{key:"sendable",value:function(){return!0}}]),Po),wo=(i(Oo,[{key:"_patchRichMediaPayload",value:function(e,t){e===S.MSG_IMAGE?t.imageInfoArray.forEach((function(e){!e.imageUrl&&e.url&&(e.imageUrl=e.url,e.sizeType=e.type,1===e.type?e.type=0:3===e.type&&(e.type=1))})):e===S.MSG_VIDEO?!t.remoteVideoUrl&&t.videoUrl&&(t.remoteVideoUrl=t.videoUrl):e===S.MSG_AUDIO?!t.remoteAudioUrl&&t.url&&(t.remoteAudioUrl=t.url):e===S.MSG_FILE&&!t.fileUrl&&t.url&&(t.fileUrl=t.url,t.url=void 0)}},{key:"_updateRichMediaDownloadUrl",value:function(e,t,n,o,a){(n||o)&&(e===S.MSG_IMAGE?t.imageInfoArray.forEach((function(e){e.url=po(e.url,n,o,a)})):e===S.MSG_VIDEO?(t.videoUrl=po(t.videoUrl,n,o,a),t.snapshotUrl=po(t.thumbUrl,n,o,a),t.snapshotHeight=t.thumbHeight,t.snapshotWidth=t.thumbWidth):e===S.MSG_AUDIO?t.url=po(t.url,n,o,a):e===S.MSG_FILE&&(t.fileUrl=po(t.fileUrl,n,o,a)))}}]),Oo),bo=(i(Ao,[{key:"sendable",value:function(){return!He(this.content.messageList)||!He(this.content.downloadKey)}}]),Ao),Do={1:S.MSG_PRIORITY_HIGH,2:S.MSG_PRIORITY_NORMAL,3:S.MSG_PRIORITY_LOW,4:S.MSG_PRIORITY_LOWEST},No=(i(Lo,[{key:"elements",get:function(){return this._elements}},{key:"getElements",value:function(){return this._elements}},{key:"extractGroupInfo",value:function(e){null!==e&&(dt(e.nick)&&(this.nick=e.nick),dt(e.avatar)&&(this.avatar=e.avatar),We(e=e.messageFromAccountExtraInformation)&&dt(e.nameCard)&&(this.nameCard=e.nameCard))}},{key:"handleGroupAtInfo",value:function(e){var t=this;e.payload&&e.payload.atUserList&&e.payload.atUserList.forEach((function(e){e!==S.MSG_AT_ALL?(t._groupAtInfoList.push({groupAtAllFlag:0,groupAtUserID:e}),t.atUserList.push(e)):(t._groupAtInfoList.push({groupAtAllFlag:1}),t.atUserList.push(S.MSG_AT_ALL))})),Ze(e.groupAtInfo)&&e.groupAtInfo.forEach((function(e){0===e.groupAtAllFlag?t.atUserList.push(e.groupAtUserID):1===e.groupAtAllFlag&&t.atUserList.push(S.MSG_AT_ALL)}))}},{key:"getGroupAtInfoList",value:function(){return this._groupAtInfoList}},{key:"_initProxy",value:function(){this._elements[0]&&(this.payload=this._elements[0].content,this.type=this._elements[0].type)}},{key:"reInitialize",value:function(e){e&&(this.status=this.from?Dn:bn,this.from||(this.from=e)),this._initFlow(e),this._initSequence(e),this._concatConversationID(e),this.generateMessageID()}},{key:"isSendable",value:function(){return 0!==this._elements.length&&(!0===this._relayFlag||"function"==typeof this._elements[0].sendable&&this._elements[0].sendable())}},{key:"_initTo",value:function(e){this.conversationType===S.CONV_GROUP&&(this.to=e.groupID)}},{key:"_initSequence",value:function(e){var t,n,o;0===this.clientSequence&&e&&(this.clientSequence=!!e&&(void 0===_t[e]&&(t="3".concat((o=new Date).getHours()).slice(-2),n="0".concat(o.getMinutes()).slice(-2),o="0".concat(o.getSeconds()).slice(-2),_t[e]=parseInt([t,n,o,"0001"].join("")),o=n=t=null,Re.l("autoIncrementIndex start index:".concat(_t[e]))),_t[e]++)),0===this.sequence&&this.conversationType===S.CONV_C2C&&(this.sequence=this.clientSequence)}},{key:"generateMessageID",value:function(){this.from===S.CONV_SYSTEM&&(this.senderTinyID="144115198244471703"),this.ID="".concat(this.senderTinyID,"-").concat(this.clientTime,"-").concat(this.random)}},{key:"_initFlow",value:function(e){""!==e&&(e===this.from?(this.flow="out",this.isRead=!0):this.flow="in")}},{key:"_concatConversationID",value:function(e){var t=this.to,n=this.conversationType;n!==S.CONV_SYSTEM?(e=n===S.CONV_C2C?e===this.from?t:this.from:this.to,this.conversationID=e?"".concat(n).concat(e):null):this.conversationID=S.CONV_SYSTEM}},{key:"isElement",value:function(e){return e instanceof ro||e instanceof mo||e instanceof vo||e instanceof _o||e instanceof Eo||e instanceof So||e instanceof Io||e instanceof ko||e instanceof To||e instanceof Mo||e instanceof bo}},{key:"setElement",value:function(e,t,n,o){var a=this;if(this.isElement(e))return this._elements=[e],void this._initProxy();function i(e){if(e.type&&e.content)switch(e.type){case S.MSG_TEXT:a.setTextElement(e.content);break;case S.MSG_IMAGE:a.setImageElement(e.content,t,n,o);break;case S.MSG_AUDIO:a.setAudioElement(e.content,t,n,o);break;case S.MSG_FILE:a.setFileElement(e.content,t,n,o);break;case S.MSG_VIDEO:a.setVideoElement(e.content,t,n,o);break;case S.MSG_CUSTOM:a.setCustomElement(e.content);break;case S.MSG_LOCATION:a.setLocationElement(e.content);break;case S.MSG_GRP_TIP:a.setGroupTipElement(e.content);break;case S.MSG_GRP_SYS_NOTICE:a.setGroupSystemNoticeElement(e.content);break;case S.MSG_FACE:a.setFaceElement(e.content);break;case S.MSG_MERGER:a.setMergerElement(e.content,t,n,o)}}if(Ze(e))for(var r=0;r<e.length;r++)i(e[r]);else i(e);this._initProxy()}},{key:"clearElement",value:function(){this._elements.length=0}},{key:"setTextElement",value:function(e){e="string"==typeof e?e:e.text,e=new ro({text:e}),this._elements.push(e)}},{key:"setImageElement",value:function(e,t,n,o){e=new mo(e,t,n,o),this._elements.push(e)}},{key:"setAudioElement",value:function(e,t,n,o){e=new _o(e,t,n,o),this._elements.push(e)}},{key:"setFileElement",value:function(e,t,n,o){e=new Eo(e,t,n,o),this._elements.push(e)}},{key:"setVideoElement",value:function(e,t,n,o){e=new So(e,t,n,o),this._elements.push(e)}},{key:"setLocationElement",value:function(e){e=new Mo(e),this._elements.push(e)}},{key:"setCustomElement",value:function(e){e=new To(e),this._elements.push(e)}},{key:"setGroupTipElement",value:function(e){var t,n={},o=e.operationType;He(e.memberInfoList)?e.operatorInfo&&(n=e.operatorInfo):o!==S.GRP_TIP_MBR_JOIN&&o!==S.GRP_TIP_MBR_KICKED_OUT&&o!==S.GRP_TIP_MBR_SET_ADMIN&&o!==S.GRP_TIP_MBR_CANCELED_ADMIN||(n=e.memberInfoList[0]),He(e.memberExtraInfo)||(t=e.memberExtraInfo.reason,e.msgMemberInfo.forEach((function(e){e.reason=t}))),o=n.nick,n=n.avatar,dt(o)&&(this.nick=o),dt(n)&&(this.avatar=n),o=new Io(e),this._elements.push(o)}},{key:"setGroupSystemNoticeElement",value:function(e){e=new ko(e),this._elements.push(e)}},{key:"setFaceElement",value:function(e){e=new vo(e),this._elements.push(e)}},{key:"setMergerElement",value:function(e,t,n,o){e=new bo(e,t,n,o),this._elements.push(e)}},{key:"setIsRead",value:function(e){this.isRead=e}},{key:"setRelayFlag",value:function(e){this._relayFlag=e}},{key:"_computePriority",value:function(e){return pt(e)?S.MSG_PRIORITY_NORMAL:dt(e)&&-1!==Object.values(Do).indexOf(e)?e:Ye(e)&&(e=""+e,-1!==Object.keys(Do).indexOf(e))?Do[e]:S.MSG_PRIORITY_NORMAL}},{key:"setNickAndAvatar",value:function(e){var t=e.nick;e=e.avatar,dt(t)&&(this.nick=t),dt(e)&&(this.avatar=e)}},{key:"setNameCard",value:function(e){dt(e)&&(this.nameCard=e)}},{key:"initC2CReadReceiptInfo",value:function(e){var t=e.readReceiptSentByPeer;e=void 0===(e=e.timestamp)?0:e,this.conversationType===S.CONV_C2C&&!0===this.needReadReceipt&&(this.readReceiptInfo.isPeerRead=1===(void 0===t?void 0:t),this.readReceiptInfo.timestamp=e)}}]),Lo),Ro=["sound","FCMChannelID"];function Lo(e){o(this,Lo),this.ID="",this.conversationID=e.conversationID||null,this.conversationType=e.conversationType||S.CONV_C2C,this.conversationSubType=e.conversationSubType,this.time=e.time||Math.ceil(Date.now()/1e3),this.sequence=e.sequence||0,this.clientSequence=e.clientSequence||e.sequence||0,this.random=e.random||0===e.random?e.random:it(),this.priority=this._computePriority(e.priority),this.nick=e.nick||"",this.avatar=e.avatar||"",this.isPeerRead=!1,this.nameCard="",this.hasRiskContent=Wt(e.checkResult),this._elements=[],this.isPlaceMessage=e.isPlaceMessage||0,this.isRevoked=2===e.isPlaceMessage||8===e.msgFlagBits,this.from=e.from||null,this.to=e.to||null,this.flow="",this.isSystemMessage=e.isSystemMessage||!1,this.protocol=e.protocol||"JSON",this.isResend=!1,this.isRead=!1,this.status=e.status||Dn,this._onlineOnlyFlag=!1,this._groupAtInfoList=[],this._relayFlag=!1,this.atUserList=[],this.cloudCustomData=e.cloudCustomData||"",this.isDeleted=!1,this.isModified=!!e.messageVersion,this._isExcludedFromUnreadCount=!(!e.messageControlInfo||1!==e.messageControlInfo.excludedFromUnreadCount),this._isExcludedFromLastMessage=!(!e.messageControlInfo||1!==e.messageControlInfo.excludedFromLastMessage),this.clientTime=e.clientTime||Te()||0,this.senderTinyID=e.senderTinyID||e.tinyID||"",this.readReceiptInfo=e.readReceiptInfo||{readCount:void 0,unreadCount:void 0,isPeerRead:void 0,timestamp:0},this.needReadReceipt=!0===e.needReadReceipt||1===e.needReadReceipt,this.version=e.messageVersion||0,this.isBroadcastMessage=e.isBroadcastMessage||!1,this._receiverList=e.receiverList||void 0,this.isSupportExtension=!0===e.isSupportExtension||1===e.isSupportExtension,this._cmConfigID=e.customModerationConfigurationID,this.revoker=e.revokerInfo&&e.revokerInfo.revoker||"",this.revokerInfo=e.revokerInfo||{userID:"",nick:"",avatar:""},this.revokeReason=e.revokeReason||"",this.reInitialize(e.currentUser),this.extractGroupInfo(e.groupProfile||null),this.handleGroupAtInfo(e),this.initC2CReadReceiptInfo(e)}function Ao(e,t,n,a){var i,r,s,l,c,u,d;o(this,Ao),this.type=S.MSG_MERGER,this.content={downloadKey:"",pbDownloadKey:"",messageList:[],title:"",abstractList:[],compatibleText:"",version:0,layersOverLimit:!1},e.downloadKey?(r=e.downloadKey,s=e.pbDownloadKey,l=e.title,c=e.abstractList,u=e.compatibleText,i=e.version,this.content.downloadKey=r,this.content.pbDownloadKey=s,this.content.title=l,this.content.abstractList=c,this.content.compatibleText=u,this.content.version=i||0):He(e.messageList)?1===e.layersOverLimit&&(this.content.layersOverLimit=!0):(r=e.messageList,s=e.title,l=e.abstractList,c=e.compatibleText,u=e.version,d=[],r.forEach((function(e){He(e)||(e=new wo(e,t,n,a),d.push(e))})),this.content.messageList=d,this.content.title=s,this.content.abstractList=l,this.content.compatibleText=c,this.content.version=u||0)}function Oo(e,t,n,a){var i,r;o(this,Oo),this.from=e.from,this.messageSender=e.from,this.time=e.time,this.messageSequence=e.sequence,this.clientSequence=e.clientSequence||e.sequence,this.messageRandom=e.random,this.cloudCustomData=e.cloudCustomData||"",this.clientTime=e.clientTime||void 0,e.ID?(this.ID=e.ID||"",this.nick=e.nick||"",this.avatar=e.avatar||"",e.messageBody?this.messageBody=JSON.parse(JSON.stringify(e.messageBody)):this.messageBody=[{type:e.type,payload:e.payload}],e.conversationType?e.conversationType.startsWith(S.CONV_C2C)?this.receiverUserID=e.to:e.conversationType.startsWith(S.CONV_GROUP)&&(this.receiverGroupID=e.to):e.receiverGroupID?this.receiverGroupID=e.receiverGroupID:e.receiverUserID&&(this.receiverUserID=e.receiverUserID),this.messageReceiver=e.to||e.messageReceiver):(this.nick=e.nick||"",this.avatar=e.avatar||"",this.messageBody=[],i=e.elements[0].type,r=e.elements[0].content,this._patchRichMediaPayload(i,r),this._updateRichMediaDownloadUrl(i,r,t,n,a),i===S.MSG_MERGER?this.messageBody.push({type:i,payload:new bo(r,t,n,a).content}):this.messageBody.push({type:i,payload:r}),e.groupID&&(this.receiverGroupID=e.groupID,this.messageReceiver=e.groupID),e.to&&(this.receiverUserID=e.to,this.messageReceiver=e.to),this.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random))}function Po(e){o(this,Po),this.type=S.MSG_LOCATION;var t=e.description,n=e.longitude;e=e.latitude,this.content={description:t,longitude:n,latitude:e}}function Uo(e,t,n,a){o(this,Uo),this.type=S.MSG_VIDEO,this._percent=0,this.content={remoteVideoUrl:e.remoteVideoUrl||e.videoUrl||"",videoFormat:e.videoFormat,videoSecond:parseInt(e.videoSecond,10),videoSize:e.videoSize,videoUrl:po(e.videoUrl,t,n,a),videoDownloadFlag:2,videoUUID:e.videoUUID,thumbUUID:e.thumbUUID,thumbFormat:e.thumbFormat,thumbWidth:e.thumbWidth,snapshotWidth:e.thumbWidth,thumbHeight:e.thumbHeight,snapshotHeight:e.thumbHeight,thumbSize:e.thumbSize,snapshotSize:e.thumbSize,thumbDownloadFlag:2,thumbUrl:po(e.thumbUrl,t,n,a),snapshotUrl:po(e.thumbUrl,t,n,a)}}function xo(e){o(this,xo),this.type=S.MSG_CUSTOM,this.content={data:e.data||"",description:e.description||"",extension:e.extension||""}}function Vo(e,t,n,a){o(this,Vo),this.type=S.MSG_FILE,this._percent=0;var i=this._getFileInfo(e);this.content={downloadFlag:2,fileUrl:po(e.url||e.fileUrl,t,n,a)||"",uuid:e.uuid,fileName:i.name||"",fileSize:i.size||0}}function Bo(e){o(this,Bo),this.type=S.MSG_GRP_SYS_NOTICE,this.content={},this._initContent(e)}function Go(e){o(this,Go),this.type=S.MSG_GRP_TIP,this.content={},this._initContent(e)}function Fo(e,t,n,a){o(this,Fo),this.type=S.MSG_AUDIO,this._percent=0,this.content={downloadFlag:2,second:e.second,size:e.size,url:po(e.url,t,n,a),remoteAudioUrl:e.url||"",uuid:e.uuid}}function zo(e){o(this,zo),this.type=S.MSG_FACE,this.content=e||null}function Ho(e,t,n,a){o(this,Ho),this._imageMemoryURL="",this._fileDownloadProxy=t,this._authKey=n,this._fileDNList=a,X||ee?this.createImageDataASURL(e.file):this.createImageDataASURLInWeb(e.file),this._initImageInfoModel(),this.type=S.MSG_IMAGE,this._percent=0,this.content={imageFormat:e.imageFormat||Le.UNKNOWN,uuid:e.uuid,imageInfoArray:[]},this.initImageInfoArray(e.imageInfoArray),this._autoFixUrl()}function jo(e){if(We(e))return{pushFlag:!0===e.disablePush?1:0,title:e.title||"",desc:e.description||"",ext:e.extension||"",apnsInfo:(o=void 0===(o=(n=e).apnsInfo)?{}:o,a=n.ignoreIOSBadge,n=n.disableVoipPush,a=!0===o.ignoreIOSBadge||!0===(void 0!==a&&a)?1:0,i=void 0,pt(n)||(i=!1===n?1:0),pt(o.disableVoipPush)||(i=!1===o.disableVoipPush?1:0),t(t({},o),{},{badgeMode:a,isVoipPush:i})),androidInfo:(o=void 0===(o=(n=e).androidInfo)?{}:o,n=n.androidOPPOChannelID,n=o.OPPOChannelID||(void 0===n?"":n),a=void 0===(a=o.sound)?"":a,i=void 0===(i=o.FCMChannelID)?"":i,t(t({},h(o,Ro)),{},{Sound:-1===(a=(o=a).lastIndexOf("."))?o:o.slice(0,a),OPPOChannelID:n,GoogleChannelID:i}))};var n,o,a,i}s(Zo,Un),qo=g(Zo),i(Zo,[{key:"onNewMessage",value:function(e){var t=e.dataList,n=e.isInstantMessage,o=e.C2CRemainingUnreadList,a=e.C2CPairUnreadList,i=(e=e.isSyncingEnded,o=(n||Re.l("".concat(this._n,".onNewMessage C2CPairUnreadList:"),a,"C2CRemainingUnreadList:",o),t=this._assembly({dataList:t,C2CRemainingUnreadList:o,C2CPairUnreadList:a,isInstantMessage:n})).conversationOptionsList,a=t.messageList,t=t.isUnreadC2CMessage,0<(i=It(a)).length&&this.emitOEvt(T.MESSAGE_MODIFIED,i),this.get(11).onNewMessage({conversationOptionsList:o,isInstantMessage:n,isUnreadC2CMessage:t,isSyncingEnded:e}),kt(a));n&&0<i.length&&this.emitOEvt(T.MESSAGE_RECEIVED,i),a.length=0}},{key:"_assembly",value:function(e){for(var t=e.dataList,n=e.C2CRemainingUnreadList,o=e.C2CPairUnreadList,a=e.isInstantMessage,i=null,r=[],s=[],l={},c=this.get(26),u=!1,d=this.get(11),p=this.get(4),h=(e=this.get(17),this.getFileDownloadProxy()),f=this.getDowloadFileAuthKey(),g=e.getFileDNList(),m=0,v=t.length;m<v;m++)if(this._isC2CNotice(t[m]))this._noticeFromUnreadDBList.push(t[m].eventArray[0].c2CNotifyMsgArray[0]);else{var _=t[m],y=(_.currentUser=this.getMyUserID(),_.conversationType=S.CONV_C2C,_.isSystemMessage=!!_.isSystemMessage,(pt(_.nick)||pt(_.avatar))&&(u=!0),(i=new No(_)).setElement(_.elements,h,f,g),i.setNickAndAvatar({nick:_.nick,avatar:_.avatar}),i.conversationID);if(a){if(this._msgFromUnreadDBMap.get(i.ID))continue;var I,C,k=!1,E=(i.from!==this.getMyUserID()?(C=d.getLatestMessageSentByPeer(y))&&(I=C.nick,C=C.avatar,u?i.setNickAndAvatar({nick:I,avatar:C}):I===i.nick&&C===i.avatar||(k=!0)):(I=d.getLatestMessageSentByMe(y))&&(C=I.nick,E=I.avatar,C===i.nick&&E===i.avatar||(d.modifyMessageSentByMe({conversationID:y,latestNick:i.nick,latestAvatar:i.avatar}),p.mockOnNickAvatarModified(i.nick,i.avatar))),1===t[m].isModified);if(d.isMessageSentByCurrentInstance(i)?i.isModified=E:E=!1,0===_.msgLifeTime)i._onlineOnlyFlag=!0,d.isMessageSentByCurrentInstance(i)||s.push(i);else{if(!d.pushIntoMessageList(s,i,E))continue;k&&(d.modifyMessageSentByPeer({conversationID:y,latestNick:i.nick,latestAvatar:i.avatar}),d.updateUserProfileSpecifiedKey({conversationID:y,nick:i.nick,avatar:i.avatar}))}a&&0<i.clientTime&&c.addMessageDelay(i.clientTime)}else this._msgFromUnreadDBMap.set(i.ID,i);if(0!==_.msgLifeTime){if(!1===i._onlineOnlyFlag){if(Ye(k=d.getLastMessageTime(y))&&i.time<k)continue;a&&(pt(l[y])?(_=0,"in"===i.flow&&(i._isExcludedFromUnreadCount||(_=1)),l[y]=r.push({conversationID:y,unreadCount:_,type:i.conversationType,subType:i.conversationSubType,lastMessage:i._isExcludedFromLastMessage?"":i})-1):(_=l[y],r[_].type=i.conversationType,r[_].subType=i.conversationSubType,r[_].lastMessage=i._isExcludedFromLastMessage?"":i,"in"===i.flow&&(i._isExcludedFromUnreadCount||r[_].unreadCount++)))}}else i._onlineOnlyFlag=!0}this._handleNoticeFromUnreadDB();var T=!1;if(Ze(o)&&0<o.length)for(var M=0,w=o.length;M<w;M++)!function(e){if(o[e].from!==S.CONV_SYSTEM){T=!0;var t=r.find((function(t){return t.conversationID==="".concat(S.CONV_C2C).concat(o[e].from)}));t?t.unreadCount=o[e].unreadCount:r.push({conversationID:"".concat(S.CONV_C2C).concat(o[e].from),unreadCount:o[e].unreadCount,type:S.CONV_C2C})}}(M);if(Ze(n))for(var b=0,D=n.length;b<D;b++)!function(e){r.find((function(t){return t.conversationID==="".concat(S.CONV_C2C).concat(n[e].from)}))||r.push({conversationID:"".concat(S.CONV_C2C).concat(n[e].from),type:S.CONV_C2C,lastMsgTime:n[e].lastMsgTime})}(b);return{conversationOptionsList:r,messageList:s,isUnreadC2CMessage:T}}},{key:"getMessageListFromUnreadDB",value:function(){return v(this._msgFromUnreadDBMap.values())}},{key:"_isC2CNotice",value:function(e){return!(!Ze(e=e.eventArray)||10!==e[0].event)}},{key:"_handleNoticeFromUnreadDB",value:function(){var e,t=this._noticeFromUnreadDBList.length;0!==t&&(Re.l("".concat(this._n,"._handleNoticeFromUnreadDB count:").concat(t)),e=[],this._noticeFromUnreadDBList.forEach((function(t){t.hasOwnProperty("c2cMessageRevokedNotify")&&e.push(t)})),this.onMsgRevoked({dataList:e}),this._noticeFromUnreadDBList.length=0,e.length=0)}},{key:"onMsgRevoked",value:function(e,t){var n,o=this,a=this.get(11),i=[];e.dataList.forEach((function(e){e.c2cMessageRevokedNotify&&(e=e.c2cMessageRevokedNotify.revokedInfos,pt(e)||e.forEach((function(e){var t=o.getMyUserID()===e.from?"".concat(S.CONV_C2C).concat(e.to):"".concat(S.CONV_C2C).concat(e.from);n=a.revoke(t,e.sequence,e.random);var r,s=e.revokerInfo&&e.revokerInfo.revoker,l=e.revokerInfo&&e.revokerInfo.reason||"";n?r=n:(r={conversationID:t,sequence:e.sequence},e.tinyID&&e.clientTime&&e.random&&(r.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)),e.time&&(r.time=e.time)),r&&(r.revoker=s,r.revokeReason=l,r.revokerInfo={userID:s,nick:"",avatar:""},i.push(r))})))})),0!==i.length&&(Re.l("".concat(this._n,".onMsgRevoked count:").concat(i.length," updateUnreadCount:").concat(t)),a.onMessageRevoked(i,t),a.updateRevokerInfo(i).then((function(e){o.emitOEvt(T.MESSAGE_REVOKED,e)})))}},{key:"onMsgReadReceipt",value:function(e){var t=this;e.dataList.forEach((function(e){var n;He(e.c2cMessageReadReceipt)||(n=e.c2cMessageReadReceipt.to,e.c2cMessageReadReceipt.uinPairReadArray.forEach((function(e){e=e.peerReadTime;var o=(Re.l("".concat(t._n,".onMsgReadReceipt to:").concat(n," peerReadTime:").concat(e)),"".concat(S.CONV_C2C).concat(n)),a=t.get(11);a.recordPeerReadTime(o,e),a.updateMsgIsPeerReadProp(o,e)})))}))}},{key:"onMsgReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){var n;He(e.c2cMessageReadNotice)||(n=t.get(11),e.c2cMessageReadNotice.uinPairReadArray.forEach((function(e){var o=e.from;e=e.peerReadTime,Re.l("".concat(t._n,".onMsgReadNotice from:").concat(o," lastReadTime:").concat(e)),o="".concat(S.CONV_C2C).concat(o),n.updateIsReadAfterReadReport({conversationID:o,lastMessageTime:e}),n.updateUnreadCount(o)})))}))}},{key:"onMsgModified",value:function(e){Re.l("".concat(this._n,".onMsgModified options:"),e);var n=this.get(11);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:S.CONV_C2C}))}))}},{key:"onReadReceiptList",value:function(e){Re.l("".concat(this._n,".onReadReceiptList options:"),e),this.get(11).updateReadReceiptInfo(e.dataList)}},{key:"sendMessage",value:function(e,t){return e=this._createC2CMessagePack(e,t),this.req(e)}},{key:"_createC2CMessagePack",value:function(e,t){var n=null,o=(t&&(t.offlinePushInfo&&(n=t.offlinePushInfo),!0===t.onlineUserOnly&&(n?n.disablePush=!0:n={disablePush:!0})),""),a=(dt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(o=e.cloudCustomData),[]),i=(We(t)&&We(t.messageControlInfo)&&(i=(s=t.messageControlInfo).excludedFromUnreadCount,r=s.excludedFromLastMessage,s=s.excludedFromContentModeration,!0===i&&a.push("NoUnread"),!0===r&&a.push("NoLastMsg"),!0===s&&a.push("NoMsgCheck")),this.isOnlineMessage(e,t)?0:void 0),r=JSON.parse(JSON.stringify(e.getElements())),s=this.get(17).getFileDNList();return{P:jn.SEND_C2C_MSG,data:{fromAccount:this.getMyUserID(),toAccount:e.to,msgBody:ho(e.type,r,s),cloudCustomData:o,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:i,nick:e.nick,avatar:e.avatar,offlinePushInfo:jo(n),messageControlInfo:0!==i?a:void 0,clientTime:e.clientTime,needReadReceipt:!0===e.needReadReceipt?1:0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0,cmConfigID:e._cmConfigID,forbidCallbackControl:Ct(t)}}}},{key:"isOnlineMessage",value:function(e,t){return!(!t||!0!==t.onlineUserOnly)}},{key:"revokeMessage",value:function(e){return this.req({P:jn.REVOKE_C2C_MSG,data:{msgInfo:{fromAccount:e.from,toAccount:e.to,msgSeq:e.sequence,msgRandom:e.random,msgTimeStamp:e.time}}})}},{key:"deleteMessage",value:function(e){var t=e.to;return e=e.keyList,Re.l("".concat(this._n,".deleteMessage toAccount:").concat(t," count:").concat(e.length)),this.req({P:jn.DEL_C2C_MSG,data:{fromAccount:this.getMyUserID(),to:t,keyList:e}})}},{key:"modifyRemoteMessage",value:function(e){var t=e.from,n=e.to,o=void 0===(o=e.version)?0:o,a=e.sequence,i=e.random,r=e.time,s=e.payload,l=e.type,c=e.cloudCustomData,u=void(e=e._elements);return zt(l)&&(1<e.length&&e.splice(0,1,{type:l,content:s}),u=e),this.req({P:jn.MODIFY_C2C_MSG,data:{from:t,to:n,version:o,sequence:a,random:i,time:r,elements:u,cloudCustomData:c}})}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageTime,a="".concat(this._n,".").concat("setMessageRead"),i=(e="convID:".concat(n," lastMessageTime:").concat(o),Re.l("".concat(a," ").concat(e)),Ye(o)||this.warn("DoNotModifyLastTime"),new io("setMessageRead"));return i.setMessage(e),this.req({P:jn.SET_C2C_MSG_READ,data:{C2CMsgReaded:{cookie:"",C2CMsgReadedItem:[{toAccount:n.replace("C2C",""),lastMessageTime:o,receipt:1}]}}}).then((function(){i.end(),Re.l("".concat(a," ok"));var e=t.get(11);return e.updateIsReadAfterReadReport({conversationID:n,lastMessageTime:o}),e.updateUnreadCount(n),Tn()})).catch((function(e){return i.setError(e).end(),Re.l("".concat(a," failed. error:"),e),Mn(e)}))}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessage"),o=e.peerAccount,a=e.conversationID,i=e.count,r=e.lastMessageTime,s=(e=e.messageKey,"peerAccount:".concat(o," count:").concat(i||15," lastMessageTime:").concat(r||0," messageKey:").concat(e)),l=(Re.l("".concat(n," ").concat(s)),new io("getRoamingMessage"));return this.req({P:jn.GET_C2C_ROAMING_MSG,data:{peerAccount:o,count:i||15,lastMessageTime:r||0,messageKey:e}}).then((function(e){var o=(e=e.data).complete,i=e.messageList,r=e.messageKey,c=(e=e.lastMessageTime,pt(i)?Re.l("".concat(n," ok. complete:").concat(o," but messageList is undefined!")):Re.l("".concat(n," ok. complete:").concat(o," count:").concat(i.length)),l.setMessage("".concat(s," complete:").concat(o," length:").concat(i.length)).end(),t.get(11)),u=((o=1===o)&&c.setCompleted(a),[]);return i=c.onRoamingMessage(i,a,!0,u),c.modifyMessageList(a),c.updateIsRead(a),c.updateRoamingMsgKeyAndTime(a,r,e),r=c.getPeerReadTime(a),Re.l("".concat(n," update isPeerRead property. convID:").concat(a," peerReadTime:").concat(r)),r?c.updateMsgIsPeerReadProp(a,r):(e=a.replace(S.CONV_C2C,""),t.getRemotePeerReadTime([e]).then((function(){c.updateMsgIsPeerReadProp(a,c.getPeerReadTime(a))}))),r="",0<i.length?r=i[0].ID:(e=c.getLocalOldestMessage(a))&&(r=e.ID),Re.l("".concat(n," nextReqID:").concat(r," storedMsgCount:").concat(i.length)),{nextReqID:r,storedMessageList:i,assembledMessageList:u,isPullingCompleted:o}})).catch((function(e){return l.setMessage(s).setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessagesHopping"),o=e.peerAccount,a=void 0===(a=e.time)?0:a,i=e.count,r=e.direction,s="".concat(S.CONV_C2C).concat(o),l="peerAccount:".concat(o," count:").concat(i," time:").concat(a," direction:").concat(r),c=(Re.l("".concat(n," ").concat(l)),new io("getRoamingMessagesHopping"));return this.req({P:jn.GET_C2C_ROAMING_MSG,data:{peerAccount:o,count:i+1,lastMessageTime:a,direction:r}}).then((function(e){var o=(e=e.data).complete,a=void 0===(a=e.messageList)?[]:a,i=(e=e.lastMessageTime,"complete:".concat(o," count:").concat(a.length)),u=(Re.l("".concat(n," ok. ").concat(i)),c.setMessage("".concat(l," ").concat(i)).end(),1!==o&&(1===r?a.pop():a.shift()),t.get(11));return i=u.onRoamingMessage(a,s,!1),t._modifyMessageList(s,i),a=t._computeResult({complete:o,lastMessageTime:e,resultList:i}),u.storeHoppingMessageList(a.messageList),o=u.getPeerReadTime(s),Re.l("".concat(n," update isPeerRead property. convID:").concat(s," peerReadTime:").concat(o)),o?u.updateMsgIsPeerReadProp(s,o):(e=s.replace(S.CONV_C2C,""),t.getRemotePeerReadTime([e]).then((function(){u.updateMsgIsPeerReadProp(s,u.getPeerReadTime(s))}))),Tn(a)})).catch((function(e){return c.setMessage(l).setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"_computeResult",value:function(e){var t=void 0===(t=e.complete)?0:t,n=e.lastMessageTime;return e={messageList:v(void 0===(e=e.resultList)?[]:e),isCompleted:!1,nextMessageTime:""},1===t?e.isCompleted=!0:e.nextMessageTime=n,e}},{key:"_modifyMessageList",value:function(e,t){if(e=this.get(11).getLocalConversation(e))for(var n=e.userProfile.nick,o=e.userProfile.avatar,a=(e=this.get(4).getNickAndAvatarByUserID(this.getMyUserID())).nick,i=e.avatar,r=t.length-1;0<=r;r--){var s=t[r];"in"===s.flow&&(s.nick!==n&&s.setNickAndAvatar({nick:n}),s.avatar!==o&&s.setNickAndAvatar({avatar:o})),"out"===s.flow&&(s.nick!==a&&s.setNickAndAvatar({nick:a}),s.avatar!==i&&s.setNickAndAvatar({avatar:i}))}}},{key:"getRemotePeerReadTime",value:function(e){var t=this,n="".concat(this._n,".").concat("getRemotePeerReadTime");if(He(e))return Promise.resolve();var o=new io("getRemotePeerReadTime");return Re.l("".concat(n," userIDList:").concat(e)),this.req({P:jn.GET_C2C_PEER_READ_TIME,data:{userIDList:e}}).then((function(a){var i=a.data.peerReadTimeList;Re.l("".concat(n," ok. peerReadTimeList:").concat(i));for(var r="",s=t.get(11),l=0;l<e.length;l++)r+="".concat(e[l],"-").concat(i[l]," "),0<i[l]&&s.recordPeerReadTime("".concat(S.CONV_C2C).concat(e[l]),i[l]);o.setMessage(r).end()})).catch((function(e){o.setError(e).end(),Re.w("".concat(n," failed. error:"),e)}))}},{key:"sendReadReceipt",value:function(e){var t=e[0].conversationID.replace(S.CONV_C2C,""),n=new io("sendReadReceipt"),o=(n.setMessage("peerAccount:".concat(t)),this.getMyUserID());if(0===(e=e.filter((function(e){return e.from!==o&&!0===e.needReadReceipt})).map((function(e){return{fromAccount:e.from,toAccount:e.to,sequence:e.sequence,random:e.random,time:e.time,clientTime:e.clientTime}}))).length)return Mn({code:zn.READ_RECEIPT_MSG_LIST_EMPTY});var a="".concat(this._n,".").concat("sendReadReceipt");return Re.l("".concat(a,". peerAccount:").concat(t," length:").concat(e.length)),this.req({P:jn.SEND_C2C_READ_RECEIPT,data:{peerAccount:t,messageInfoList:e}}).then((function(e){return n.end(),Re.l("".concat(a," ok")),Tn()})).catch((function(e){return n.setError(e).end(),Re.w("".concat(a," failed. error:"),e),Mn(e)}))}},{key:"getReadReceiptList",value:function(e){var t=e[0].conversationID.replace(S.CONV_C2C,"");return Re.l("".concat(this._n,".getReadReceiptList peerAccount:").concat(t," msgCount:").concat(e.length)),Sn({messageList:e})}},{key:"getMessageExtensions",value:function(e,t){return Re.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.req({P:jn.GET_C2C_MSG_EXT,data:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return Re.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),this.req({P:jn.MODIFY_C2C_MSG_EXT,data:{from:e.from,to:e.to,messageKey:this.getMessageKey(e),extensionList:t,operateType:n}})}},{key:"getMessageKey",value:function(e){var t=e.clientSequence,n=e.random;return e=e.time,"".concat(t,"_").concat(n,"_").concat(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._msgFromUnreadDBMap.clear(),this._noticeFromUnreadDBList.length=0}}]);var qo,Ko=Zo,Yo={A2KEY_AND_TINYID_UPDATED:"_inner".concat(1),CLOUD_CONFIG:"_inner".concat(2),PROFILE_UPDATED:"_inner".concat(3),CONV_SYNC_COMPLETED:"_inner".concat(4),C2C_UNREAD_HANDLE_COMPLETED:"_inner".concat(5)},$o=(i(Wo,[{key:"_onCloudConfig",value:function(){var e=this._convM.getCloudConfig("topic_msg_limit");pt(e)||(this.TOPIC_MSG_LIMIT=Number(e)),Re.l("".concat(this._n,"._onCloudConfig topicMsgLimit:").concat(this.TOPIC_MSG_LIMIT))}},{key:"onCheckTimer",value:function(e){if(e%20==0&&0<this._map.size){var t,n=E(this._map);try{for(n.s();!(t=n.n()).done;){var o=m(t.value,2),a=o[0],i=o[1];a.includes(Ge)&&i.size>=this.TOPIC_MSG_LIMIT&&this._convM.clearMemMsg(a,!0)}}catch(r){n.e(r)}finally{n.f()}}}},{key:"pushIn",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1],n=e.conversationID,o=!0,a=(this._map.has(n)||this._map.set(n,new Map),this._getUniqueIDOfMsg(e));if(this._map.get(n).has(a)){var i=this._map.get(n).get(a);if(!t||!0===i.isModified)return!1}return this._map.get(n).set(a,e),this._setLatestMsgSentByPeer(n,e),this._setLatestMsgSentByMe(n,e),o}},{key:"unshift",value:function(e,t){var n;if(Ze(e)?0<e.length&&(n=e[0].conversationID,this._unshiftMultipleMsgs(e,t)):(n=e.conversationID,this._unshiftSingleMsg(e,t)),n){var o=Array.from(this._map.get(n).values());if(0!==(e=o.length)){for(var a=e-1;0<=a;a--)if("out"===o[a].flow){this._setLatestMsgSentByMe(n,o[a]);break}if(n.startsWith(S.CONV_C2C))for(var i=e-1;0<=i;i--)if("in"===o[i].flow){this._setLatestMsgSentByPeer(n,o[i]);break}}}}},{key:"_unshiftSingleMsg",value:function(e,t){var n=e.conversationID,o=this._getUniqueIDOfMsg(e);if(!this._map.has(n))return this._map.set(n,new Map),this._map.get(n).set(o,e),void t.push(e);var a=this._map.get(n),i=Array.from(a);a.has(o)||(i.unshift([o,e]),this._map.set(n,new Map(i)),t.push(e))}},{key:"_unshiftMultipleMsgs",value:function(e,t){for(var n=e.length,o=[],a=e[0].conversationID,i=this._map.get(a),r=this._map.has(a)?Array.from(i):[],s=0;s<n;s++){var l=this._getUniqueIDOfMsg(e[s]);i&&i.has(l)||(o.push([l,e[s]]),t.push(e[s]))}this._map.set(a,new Map(o.concat(r)))}},{key:"remove",value:function(e){var t=e.conversationID;e=this._getUniqueIDOfMsg(e),this._map.has(t)&&this._map.get(t).delete(e)}},{key:"revoke",value:function(e,t,n){var o;return this._map.has(e)?(o=this._map.get(e),this._updateMsgIsRevoked(o,t,n)):this._hoppingMsgMap.has(e)?(o=this._hoppingMsgMap.get(e),this._updateMsgIsRevoked(o,t,n)):null}},{key:"_updateMsgIsRevoked",value:function(e,t,n){var o,a=E(e);try{for(a.s();!(o=a.n()).done;){var i=m(o.value,2)[1];if(i.sequence===t&&(pt(n)||i.random===n))return i.isRevoked||(i.isRevoked=!0),i}}catch(r){a.e(r)}finally{a.f()}}},{key:"removeByConvID",value:function(e){var t=this._map.has(e);Re.l("".concat(this._n,".removeByConvID convID:").concat(e," has:").concat(t)),t&&(this._map.delete(e),this._latestMsgSentByPeerMap.delete(e),this._latestMsgSentByMeMap.delete(e))}},{key:"findMessage",value:function(e){var t=null;return(t=this._findMsg(e,this._map))?t:this._findMsg(e,this._hoppingMsgMap)}},{key:"_findMsg",value:function(e,t){var n,o=null,a=E(t);try{for(a.s();!(n=a.n()).done;)for(var i=v(m(n.value,2)[1].values()),r=i.length,s=0;s<r;s++)if(i[s].ID===e){o=i[s];break}}catch(l){a.e(l)}finally{a.f()}return o}},{key:"updateMsgIsPeerReadProp",value:function(e,t){var n,o=[];return this._map.has(e)?(n=this._map.get(e),o=this._updateMsgIsPeerReadProp(n,t)):this._hoppingMsgMap.has(e)&&(n=this._hoppingMsgMap.get(e),o=this._updateMsgIsPeerReadProp(n,t)),Re.l("".concat(this._n,".updateMsgIsPeerReadProp convID:").concat(e," peerReadTime:").concat(t," count:").concat(o.length)),o}},{key:"_updateMsgIsPeerReadProp",value:function(e,t){var n,o=[],a=E(e);try{for(a.s();!(n=a.n()).done;){var i=m(n.value,2)[1];i.time<=t&&!i.isPeerRead&&"out"===i.flow&&(i.isPeerRead=!0,o.push(i))}}catch(r){a.e(r)}finally{a.f()}return o}},{key:"updateMsgIsModifiedProp",value:function(e){var t=e.conversationID;this._map.has(t)&&(e=this._getUniqueIDOfMsg(e),(t=this._map.get(t).get(e))&&(t.isModified=!0))}},{key:"hasLocalMsgList",value:function(e){return this._map.has(e)}},{key:"getLocalMsgList",value:function(e){return this.hasLocalMsgList(e)?v(this._map.get(e).values()):[]}},{key:"getLocalMaxSeq",value:function(e){return this.hasLocalMsgList(e)?(e=v(this._map.get(e).values()).map((function(e){return e.sequence})),Math.max.apply(Math,v(e))):0}},{key:"getLocalMaxTime",value:function(e){return this.hasLocalMsgList(e)?(e=v(this._map.get(e).values()).map((function(e){return e.time})),Math.max.apply(Math,v(e))):0}},{key:"hasLocalMsg",value:function(e,t){for(var n=!1,o=this.getLocalMsgList(e),a=o.length,i=0;i<a;i++)o[i].ID===t&&(n=!0);return n}},{key:"getLocalMsg",value:function(e,t){for(var n=null,o=this.getLocalMsgList(e),a=o.length,i=0;i<a;i++)if(o[i].ID===t){n=o[i];break}return n}},{key:"getLocalLastMsg",value:function(e){return(e=this.getLocalMsgList(e))[e.length-1]}},{key:"getLocalSecondLastMsg",value:function(e){return(e=this.getLocalMsgList(e))[e.length-2]}},{key:"getLocalOldestMsg",value:function(e){return this.getLocalMsgList(e)[0]}},{key:"_setLatestMsgSentByPeer",value:function(e,t){e.startsWith(S.CONV_C2C)&&"in"===t.flow&&this._latestMsgSentByPeerMap.set(e,t)}},{key:"_setLatestMsgSentByMe",value:function(e,t){"out"===t.flow&&this._latestMsgSentByMeMap.set(e,t)}},{key:"getLatestMsgSentByPeer",value:function(e){return this._latestMsgSentByPeerMap.get(e)}},{key:"getLatestMsgSentByMe",value:function(e){return this._latestMsgSentByMeMap.get(e)}},{key:"modifyMsgSentByPeer",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar;if(!He(e=this._map.get(t))){var a=Array.from(e.values());if(0!==(e=a.length)){for(var i=null,r=0,s=!1,l=e-1;0<=l;l--)"in"===a[l].flow&&((i=a[l]).nick!==n&&(i.setNickAndAvatar({nick:n}),s=!0),i.avatar!==o&&(i.setNickAndAvatar({avatar:o}),s=!0),s&&(r+=1));Re.l("".concat(this._n,".modifyMsgSentByPeer convID:").concat(t," count:").concat(r))}}}},{key:"modifyMsgSentByMe",value:function(e){var t=e.conversationID,n=e.latestNick,o=e.latestAvatar;if(!He(e=this._map.get(t))){var a=Array.from(e.values());if(0!==(e=a.length)){for(var i=null,r=0,s=!1,l=e-1;0<=l;l--)"out"===a[l].flow&&((i=a[l]).nick!==n&&(i.setNickAndAvatar({nick:n}),s=!0),i.avatar!==o&&(i.setNickAndAvatar({avatar:o}),s=!0),s&&(r+=1));Re.l("".concat(this._n,".modifyMsgSentByMe convID:").concat(t," count:").concat(r))}}}},{key:"getTopicConvIDList",value:function(e){return v(this._map.keys()).filter((function(t){return t.startsWith("".concat(S.CONV_GROUP).concat(e))}))}},{key:"onMsgModified",value:function(e,t){if(!this._map.has(e)&&!this._hoppingMsgMap.has(e))return{isUpdated:!1,message:null};var n="".concat(this._n,".onMsgModified"),o=this._getUniqueIDOfMsg(t),a=this._getTargetMsg(e,o),i=!!a;return Re.l("".concat(n," convID:").concat(e," uniqueID:").concat(o," has:").concat(i)),i?(e=t.messageVersion,o=t.elements,i=t.cloudCustomData,t=t.checkResult,Re.l("".concat(n," localVersion:").concat(a.version," remoteVersion:").concat(e)),a.version<e?(a.version=e,a._elements=JSON.parse(JSON.stringify(o)),a.payload=a._elements[0].content,a.type=a._elements[0].type,a.cloudCustomData=i,a.isModified=!0,a.hasRiskContent=Wt(t),{isUpdated:!0,message:a}):{isUpdated:!1,message:a}):{isUpdated:!1,message:null}}},{key:"_getUniqueIDOfMsg",value:function(e){var t=e.from,n=e.to,o=e.random,a=e.sequence;return e=e.time,"".concat(t,"-").concat(n,"-").concat(o,"-").concat(a,"-").concat(e)}},{key:"_getTargetMsg",value:function(e,t){if(this._map.has(e))return this._map.get(e).get(t);var n=void 0;if(this._hoppingMsgMap.has(e))for(var o=v(this._hoppingMsgMap.get(e).values()),a=0;a<o.length;a++)if(this._getUniqueIDOfMsg(o[a])===t){n=o[a];break}return n}},{key:"storeHoppingMsgList",value:function(e){if(0!==e.length){var t=e[0].conversationID,n=e.length;this._hoppingMsgMap.has(t)||this._hoppingMsgMap.set(t,new Map);for(var o=this._hoppingMsgMap.get(t),a=0;a<n;a++){var i=e[a];o.has(i.ID)||o.set(i.ID,i)}}}},{key:"getHoppingMsg",value:function(e,t){if(this._hoppingMsgMap.has(e))return this._hoppingMsgMap.get(e).get(t)}},{key:"reset",value:function(){this._map.clear(),this._latestMsgSentByPeerMap.clear(),this._latestMsgSentByMeMap.clear(),this._hoppingMsgMap.clear()}}]),Wo);function Wo(e){o(this,Wo),this._convM=e,this._map=new Map,this._n="MsgListHandler",this._latestMsgSentByPeerMap=new Map,this._latestMsgSentByMeMap=new Map,this._hoppingMsgMap=new Map,this.TOPIC_MSG_LIMIT=1e3,this._convM.getIEmitInst().on(Yo.CLOUD_CONFIG,this._onCloudConfig,this)}function Zo(e){return o(this,Zo),(e=qo.call(this,e))._n="C2CModule",e._msgFromUnreadDBMap=new Map,e._noticeFromUnreadDBList=[],e}function Jo(e){this.mixin(e)}function Xo(e,n,o){return pt(e)?{lastTime:0,lastSequence:0,fromAccount:"",messageForShow:"",payload:null,type:"",isRevoked:!1,cloudCustomData:"",onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:!1,revoker:null}:o&&e.ID||e instanceof No?{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",messageForShow:Ft(e.type,e.payload,n),payload:e.payload||null,type:e.type||null,isRevoked:e.isRevoked||!1,cloudCustomData:e.cloudCustomData||"",onlineOnlyFlag:e._onlineOnlyFlag||!1,nick:e.nick||"",nameCard:e.nameCard||"",version:e.version||0,isPeerRead:e.isPeerRead||!1,revoker:e.revoker||null}:t(t({},e),{},{messageForShow:Ft(e.type,e.payload,n)})}function Qo(e,t){return He(e)?{lastTime:0,lastSequence:0,fromAccount:"",payload:null,type:"",messageForShow:"",nick:"",avatar:"",version:0,cloudCustomData:"",isRevoked:!1,revoker:null}:{lastTime:e.time||0,lastSequence:e.sequence||0,fromAccount:e.from||"",payload:e.payload||null,type:e.type||"",messageForShow:Ft(e.type,e.payload,t),nick:e.nick||"",avatar:e.avatar||"",version:e.version||0,cloudCustomData:e.cloudCustomData||"",isRevoked:e.isRevoked||!1,revoker:e.revoker||null}}function ea(e){var t=String(e).replace(/[=]+$/,""),n="";if(t.length%4==1)return"";for(var o,a,i=0,r=0;a=t.charAt(r++);~a&&(o=i%4?64*o+a:a,i++%4)&&(n+=String.fromCharCode(255&o>>(-2*i&6))))a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".indexOf(a);try{return decodeURIComponent(escape(n))}catch(s){return""}}Jo.mixin=function(e){(e=e.prototype||e)._isReady=!1,e.ready=function(e){if(e)return this._isReady?void(1<arguments.length&&void 0!==arguments[1]&&arguments[1]?e.call(this):setTimeout(e,1)):(this._readyQueue=this._readyQueue||[],void this._readyQueue.push(e))},e.triggerReady=function(){var e=this;this._isReady=!0,setTimeout((function(){var t=e._readyQueue;e._readyQueue=[],t&&0<t.length&&t.forEach((function(e){e.call(this)}),e)}),1)},e.resetReady=function(){this._isReady=!1,this._readyQueue=[]},e.isReady=function(){return this._isReady}};var ta,na,oa,aa,ia,ra=["jpg","jpeg","gif","png","bmp","image","webp"],sa=["mp4","quicktime","mov"],la=(i(di,[{key:"validate",value:function(e){var t,n=!0,o="";if(He(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var a=e.profileCustomField.length,i=null,r=0;r<a;r++){if(i=e.profileCustomField[r],!dt(i.key)||-1===i.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!dt(i.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if("profileCustomField"===t)continue;if(He(e[t])&&!dt(e[t])&&!Ye(e[t])){o="key:"+t+", invalid value:"+e[t],n=!1;continue}switch(t){case"nick":dt(e[t])||(n=!(o="nick must be a string")),500<at(e[t])&&(o="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(at(e[t])," bytes"),n=!1);break;case"gender":st(Pe,e.gender)||(o="key:gender, invalid value:"+e.gender,n=!1);break;case"birthday":Ye(e.birthday)||(n=!(o="birthday must be a number"));break;case"location":dt(e.location)||(n=!(o="location must be a string"));break;case"selfSignature":dt(e.selfSignature)||(n=!(o="selfSignature must be a string"));break;case"allowType":st(xe,e.allowType)||(o="key:allowType, invalid value:"+e.allowType,n=!1);break;case"language":Ye(e.language)||(n=!(o="language must be a number"));break;case"avatar":dt(e.avatar)||(n=!(o="avatar must be a string"));break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n=!(o="messageSettings must be 0 or 1"));break;case"adminForbidType":st(Ue,e.adminForbidType)||(o="key:adminForbidType, invalid value:"+e.adminForbidType,n=!1);break;case"level":Ye(e.level)||(n=!(o="level must be a number"));break;case"role":Ye(e.role)||(n=!(o="role must be a number"));break;default:o="unknown key:"+t+"  "+e[t],n=!1}}return{valid:n,tips:o}}}]),di),ca=(i(ui,[{key:"set",value:function(e){var t;this.map.size>=this.MAX_LENGTH&&(t=this.map.entries().next().value[0],this.map.delete(t)),this.map.set(e,1)}},{key:"has",value:function(e){return this.map.has(e)}},{key:"delete",value:function(e){this.has(e)&&this.map.delete(e)}},{key:"reset",value:function(){this.map.clear()}}]),ui),ua=["groupID","name","avatar","type","introduction","notification","ownerID","selfInfo","createTime","infoSequence","lastInfoTime","lastMessage","nextMessageSeq","memberNum","maxMemberNum","memberList","joinOption","groupCustomField","muteAllMembers","isSupportTopic","inviteOption","_lastRevokedTime"],da=(i(ci,[{key:"memberNum",get:function(){return this.memberCount},set:function(e){}},{key:"maxMemberNum",get:function(){return this.maxMemberCount},set:function(e){}},{key:"_initGroup",value:function(e){for(var t in e)ua.indexOf(t)<0||("selfInfo"!==t?("memberNum"===t&&(this.memberCount=e[t]),"maxMemberNum"===t&&(this.maxMemberCount=e[t]),"isSupportTopic"!==t?this[t]=e[t]:this.isSupportTopic=1===e[t]):this.updateSelfInfo(e[t]))}},{key:"updateGroup",value:function(e){var t=this;(e.appid=void 0,e.grossTopicNextMsgSeq=void 0,e.selfInfo&&(e.selfInfo.grossTopicReadSeq=void 0),e=JSON.parse(JSON.stringify(e))).lastMsgTime&&(this.lastMessage.lastTime=e.lastMsgTime),pt(e.muteAllMembers)||("On"===e.muteAllMembers?e.muteAllMembers=!0:e.muteAllMembers=!1),e.groupCustomField&&yt(this.groupCustomField,e.groupCustomField),pt(e.memberNum)||(this.memberCount=e.memberNum),pt(e.maxMemberNum)||(this.maxMemberCount=e.maxMemberNum),pt(e.isSupportTopic)||(this.isSupportTopic=Ye(e.isSupportTopic)?1===e.isSupportTopic:e.isSupportTopic),nt(this,e,["members","errorCode","lastMsgTime","groupCustomField","memberNum","maxMemberNum","isSupportTopic"]),Ze(e.members)&&0<e.members.length&&e.members.forEach((function(e){e.userID===t.selfInfo.userID&&nt(t.selfInfo,e,["sequence"])}))}},{key:"updateSelfInfo",value:function(e){e={nameCard:e.nameCard,joinTime:e.joinTime,role:e.role,messageRemindType:e.messageRemindType,readedSequence:e.readedSequence,excludedUnreadSequenceList:e.excludedUnreadSequenceList},nt(this.selfInfo,t({},e),[],["",null,void 0,0,NaN])}},{key:"setSelfNameCard",value:function(e){this.selfInfo.nameCard=e}}]),ci),pa=(i(li,[{key:"toAccount",get:function(){return this.conversationID.startsWith(S.CONV_C2C)?this.conversationID.replace(S.CONV_C2C,""):this.conversationID.startsWith(S.CONV_GROUP)?this.conversationID.replace(S.CONV_GROUP,""):""}},{key:"_initProfile",value:function(e){var t=this;Object.keys(e).forEach((function(n){switch(n){case"userProfile":t.userProfile=e.userProfile;break;case"groupProfile":t.groupProfile=e.groupProfile}})),pt(this.userProfile)&&this.type===S.CONV_C2C?this.userProfile=new la({userID:e.conversationID.replace("C2C","")}):pt(this.groupProfile)&&this.type===S.CONV_GROUP&&(this.groupProfile=new da({groupID:e.conversationID.replace("GROUP","")}))}},{key:"updateUnreadCount",value:function(e){var t=e.nextUnreadCount,n=e.isFromGetConversations;e=e.isUnreadC2CMessage,pt(t)||(Et(this.subType)?this.unreadCount=0:n&&this.type===S.CONV_GROUP||n&&this.type===S.CONV_TOPIC||e&&this.type===S.CONV_C2C?this.unreadCount=t:this.unreadCount=this.unreadCount+t)}},{key:"updateLastMessage",value:function(e){this.lastMessage=Xo(e)}},{key:"updateGroupAtInfoList",value:function(e){var t;this._isNeedMergeGroupAtInfo(e)||(-1!==(t=(_(t=e.groupAtType)||y(t)||I(t)||k()).slice(0)).indexOf(S.CONV_AT_ME)&&-1!==t.indexOf(S.CONV_AT_ALL)&&(t=[S.CONV_AT_ALL_AT_ME]),t={from:e.from,groupID:e.groupID,topicID:e.topicID,messageSequence:e.sequence,atTypeArray:t,__random:e.__random,__sequence:e.__sequence},this.groupAtInfoList.push(t))}},{key:"_isNeedMergeGroupAtInfo",value:function(e){var t=e.groupID,n=e.sequence;if(!Tt({groupID:t}))return!1;var o=!1;return this.groupAtInfoList.forEach((function(t){t.messageSequence===n&&(-1<t.atTypeArray.indexOf(S.CONV_AT_ME)&&-1<e.groupAtType.indexOf(S.CONV_AT_ALL)&&(t.atTypeArray=[S.CONV_AT_ALL_AT_ME]),-1<t.atTypeArray.indexOf(S.CONV_AT_ALL)&&-1<e.groupAtType.indexOf(S.CONV_AT_ME)&&(t.atTypeArray=[S.CONV_AT_ALL_AT_ME],t.__random=e.__random,t.__sequence=e.__sequence),o=!0)})),o}},{key:"clearGroupAtInfoList",value:function(){this.groupAtInfoList.length=0}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(e){var t=e.sequence;return e=e.time,this.type===S.CONV_C2C&&t===this.lastMessage.lastSequence&&e===this.lastMessage.lastTime||this.type===S.CONV_GROUP&&t===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}},{key:"setDraftText",value:function(e){this.draftText=e}}]),li),ha=(r(xn={},S.MSG_REMIND_ACPT_AND_NOTE,0),r(xn,S.MSG_REMIND_DISCARD,1),r(xn,S.MSG_REMIND_ACPT_NOT_NOTE,2),xn),fa=(i(si,[{key:"onAllRcvMsgOptNotify",value:function(e){e=this._handleResult(e),this._convM.emitOEvt(T.ALL_RECEIVE_MESSAGE_OPT_UPDATED,e)}},{key:"getC2CMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".getC2CMsgRemindType");return this._convM.req({P:jn.GET_C2C_PEER_MUTE_NOTIFICATIONS,data:{toAccount:this._convM.getMyUserID(),userIDList:e}}).then((function(o){Re.l("".concat(n," ok. userIDList:").concat(e)),o=o.data.muteFlagList,t._convM.onC2CMsgRemindTypeFetched(o)})).catch((function(e){Re.e("".concat(n," failed. error:"),e)}))}},{key:"set",value:function(e){return e.groupID?this._setGroupMsgRemindType(e):Ze(e.userIDList)?this._setC2CMsgRemindType(e):void 0}},{key:"_setGroupMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".").concat("_setGroupMsgRemindType"),o=e.groupID,a=e.messageRemindType,i="groupID:".concat(o," messageRemindType:").concat(a),r=new io("_setGroupMsgRemindType"),s=(r.setMessage(i),this._get(7));return s?s.modifyGroupMemberInfo({groupID:o,messageRemindType:a,userID:this._convM.getMyUserID()}).then((function(){r.end(),Re.l("".concat(n," ok. ").concat(i));var o=t.onGroupMsgRemindTypeUpdated(e);return t._convM.onTotalUnreadCountUpdate(),Tn(o)})).catch((function(e){return r.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)})):Mn({code:zn.NO_MODULE})}},{key:"onGroupMsgRemindTypeUpdated",value:function(e){var t,n,o=e.groupID,a=(e=e.messageRemindType,Re.l("".concat(this._n,".onGroupMsgRemindTypeUpdated groupID:").concat(o," messageRemindType:").concat(e)),this._get(7).getLocalGroupProfile(o));return a&&(a.selfInfo.messageRemindType=e),St(o)?(t=Gt(n=o),(n=this._get(10).getLocalTopic(t,n))&&n.updateSelfInfo({messageRemindType:e})&&this._convM.emitOEvt(T.TOPIC_UPDATED,{groupID:t,topic:n}),{topic:n}):(this._convM.patchMsgRemindType({ID:o,isC2CConversation:!1,messageRemindType:e})&&this._emitConvUpdate(),{group:a})}},{key:"_setC2CMsgRemindType",value:function(e){var t=this,n="".concat(this._n,".").concat("_setC2CMsgRemindType"),o=e.userIDList,a=e.messageRemindType,i=o.slice(0,30),r=(e=ha[a]||0,"userIDList:".concat(i," messageRemindType:").concat(a)),s=new io("_setC2CMsgRemindType");return s.setMessage(r),this._convM.req({P:jn.SET_C2C_PEER_MUTE_NOTIFICATIONS,data:{userIDList:i,muteFlag:e}}).then((function(e){s.end(),e=e.data.errorList;var o=[],l=[],c=(Ze(e)&&e.forEach((function(e){o.push(e.userID),l.push({userID:e.userID,code:e.errorCode})})),e=i.filter((function(e){return-1===o.indexOf(e)})),Re.l("".concat(n," ok. ").concat(r," successUserIDList:").concat(e," failureUserIDList:").concat(JSON.stringify(l))),0);return e.forEach((function(e){t._convM.patchMsgRemindType({ID:e,isC2CConversation:!0,messageRemindType:a})&&(c+=1)})),1<=c&&t._emitConvUpdate(),i.length=o.length=0,t._convM.onTotalUnreadCountUpdate(),Sn({successUserIDList:e.map((function(e){return{userID:e}})),failureUserIDList:l})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"_get",value:function(e){return this._convM.get(e)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"setAllRcvMsgOpt",value:function(e){var t="".concat(this._n,".").concat("setAllRcvMsgOpt"),n=void 0===(n=e.messageRemindType)?S.MSG_REMIND_ACPT_NOT_NOTE:n,o=void 0===(o=e.isRepeated)||o,a=void 0===(a=(i=this._calcStartAndEndTime(e)).startTime)?0:a,i=void 0===(i=i.endTime)?0:i,r=(e=JSON.stringify(e),new io("setAllRcvMsgOpt"));return r.setMessage(e),Re.l("".concat(t," options:").concat(e)),this._convM.req({P:jn.SET_ALL_RECEIVE_MSG_OPT,data:{messageRemindType:ha[n],startTime:a,endTime:i,isRepeated:o?1:0}}).then((function(e){return r.end(),Re.l("".concat(t," ok.")),Tn(e)})).catch((function(e){return r.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"_calcStartAndEndTime",value:function(e){var t=void 0===(t=e.startHour)?0:t,n=void 0===(n=e.startMinute)?0:n,o=void 0===(o=e.startSecond)?0:o,a=void 0===(a=e.duration)?0:a,i=(e=void 0===(e=e.isRepeated)||e,(s=new Date).getFullYear()),r=s.getMonth(),s=s.getDate();return{startTime:i=Math.round(new Date(i,r,s,t,n,o).getTime()/1e3),endTime:e&&86400<=a?i+86400:i+a}}},{key:"getAllRcvMsgOpt",value:function(){var e=this,t="".concat(this._n,".").concat("getAllRcvMsgOpt"),n=new io("getAllRcvMsgOpt");return this._convM.req({P:jn.GET_ALL_RECEIVE_MSG_OPT,data:{toAccount:this._convM.getMyUserID()}}).then((function(o){return o=o.data,n.setMessage(JSON.stringify(o)).end(),Re.l("".concat(t," ok. data:").concat(JSON.stringify(o))),Tn(o=e._handleResult(o))})).catch((function(e){return n.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"_handleResult",value:function(e){var t=e.messageRemindType,n=e.startTime,o=e.endTime,a=(e=e.isRepeated,S.MSG_REMIND_ACPT_AND_NOTE);return 1===t&&(a=S.MSG_REMIND_DISCARD),{messageRemindType:a=2===t?S.MSG_REMIND_ACPT_NOT_NOTE:a,startTime:n,endTime:o,isRepeated:1===e}}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),si),ga=(i(ri,[{key:"setConvCustomData",value:function(e){var t=this,n="".concat(this._n,".").concat("setConvCustomData"),o=e.conversationIDList,a=e.customData,i=(Re.l("".concat(n," options:"),e),new io("setConvCustomData")),r=(i.setMessage(JSON.stringify(e)),{fromAccount:this._getMyUserID(),itemList:[]}),s=[],l=[];return o.forEach((function(e){if(!t._hasLocalConv(e))return t._onConvNotFound(l,e),!0;if(!Mt(e)&&!wt(e))return t._onConvIDInvalid(l,e),!0;var n={operationType:2,contactItem:void 0,customMark:a};Mt(e)?n.contactItem={type:1,toAccount:e.replace(S.CONV_C2C,"")}:wt(e)&&(n.contactItem={type:2,groupID:e.replace(S.CONV_GROUP,"")}),r.itemList.push(n)})),l.length===o.length?Sn({successConversationIDList:s,failureConversationIDList:l}):this._convM.req({P:jn.SET_CONV_CUSTOM_DATA,data:r}).then((function(e){var o,r,c;return i.end(),Re.l("".concat(n," ok")),Ze(e=e.data.resultItem)&&(c=!1,e.forEach((function(e){o=t._concatConvID(e.contactItem),0===e.resultCode?(s.push(o),(r=t._getLocalConv(o))&&r.customData!==a&&(r.customData=a,c=!0)):l.push({conversationID:o,code:e.resultCode,message:e.resultInfo})})),!0===c&&t._emitConvUpdate()),Tn({successConversationIDList:s,failureConversationIDList:l})})).catch((function(e){return i.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"markConv",value:function(e){var t=this;if(!this._convM.canIUse(P.CONV_MARK))return this._convM.noUse("markConv");var n="".concat(this._n,".").concat("markConv"),o=e.conversationIDList,a=e.markType,i=e.enableMark,r=(Re.l("".concat(n," options:"),e),new io("markConv")),s=void r.setMessage(JSON.stringify(e)),l=void 0,c=(e=this._getFlagBit(a),!0===i?l=[e]:s=[e],{fromAccount:this._getMyUserID(),itemList:[]}),u=[],d=[];return o.forEach((function(e){if(!t._hasLocalConv(e))return t._onConvNotFound(d,e),!0;if(!Mt(e)&&!wt(e))return t._onConvIDInvalid(d,e),!0;var n={operationType:1,contactItem:void 0,clearMark:s,setMark:l};Mt(e)?n.contactItem={type:1,toAccount:e.replace(S.CONV_C2C,"")}:wt(e)&&(n.contactItem={type:2,groupID:e.replace(S.CONV_GROUP,"")}),c.itemList.push(n)})),d.length===o.length?Sn({successConversationIDList:u,failureConversationIDList:d}):this._convM.req({P:jn.MARK_CONV,data:c}).then((function(e){var o,s,l;return r.end(),Re.l("".concat(n," ok")),Ze(e=e.data.resultItem)&&(l=!1,e.forEach((function(e){var n;o=t._concatConvID(e.contactItem),0===e.resultCode?(u.push(o),(s=t._getLocalConv(o))&&(n=s.markList.indexOf(a),!0===i?-1===n&&(s.markList.push(a),l=!0):-1!==n&&(s.markList.splice(n,1),l=!0))):d.push({conversationID:o,code:e.resultCode,message:e.resultInfo})})),!0===l&&t._emitConvUpdate()),Tn({successConversationIDList:u,failureConversationIDList:d})})).catch((function(e){return r.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"getLocalConvGroupList",value:function(){var e=this;return Re.l("".concat(this._n,".getLocalConvGroupList pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===On?this.getRemoteConvGroupList().then((function(){return Tn(v(e._convGroupMap.values()))})):Sn(v(this._convGroupMap.values()))}},{key:"searchConvGroupAndMark",value:function(e,t){var n=this,o="".concat(this._n,".searchConvGroupAndMark"),a=[];return e.forEach((function(e){1===t?a.push({type:1,toAccount:e}):2===t&&a.push({type:2,groupID:e})})),Re.l("".concat(o," type:").concat(t," list:"),e),this._convM.req({P:jn.SEARCH_CONV_GRP_MARK,data:{fromAccount:this._getMyUserID(),contactItem:a}}).then((function(e){var t=(e=e.data).contactItem;e=e.groupItem,Re.l("".concat(o," ok. contactItem:"),t,"groupItem:",e),n._fillConvGroupMap(e),n._handleContactItem(t),n._emitConvUpdate()})).catch((function(e){Re.w("".concat(o," failed. error:"),e)}))}},{key:"_fillConvGroupMap",value:function(e){var t=this;Ze(e)&&e.forEach((function(e){var n=e.convGroupID;e=e.groupName,t._convGroupMap.set(n,e)}))}},{key:"_handleContactItem",value:function(e){var t,n=this;Ze(e)&&e.forEach((function(e){var o=[],a=e.standardMark,i=e.customData,r=e.convGroupIDList;Ze(r)&&r.forEach((function(e){n._convGroupMap.has(e)&&o.push(n._convGroupMap.get(e))})),t=n._concatConvID(e),(t=n._getLocalConv(t))&&(t.markList=Ht(a),t.customData=i||"",t.conversationGroupList=[].concat(o))}))}},{key:"getRemoteConvGroupList",value:function(){var e=this,t="".concat(this._n,".getRemoteConvGroupList");return this._pagingStatus=Ln,this._convM.req({P:jn.GET_CONV_GRP_LIST,data:{fromAccount:this._getMyUserID(),startIndex:this._startIndex}}).then((function(n){var o=(n=n.data).completeFlag,a=n.contactItem,i=void 0===(i=n.nextStartIndex)?0:i;if(n=n.groupItem,e._startIndex=i,Re.l("".concat(t," completeFlag:").concat(o," nextStartIndex:").concat(i,", groupItem:"),n,"contactItem:",a),e._fillConvGroupMap(n),e._handleContactItem(a),0===o)return e.getRemoteConvGroupList();1===o&&(e._pagingStatus=An,e._emitConvUpdate(),e._emitConvGroupListUpdate())})).catch((function(n){e._pagingStatus=On,Re.w("".concat(t," failed. error:"),n)}))}},{key:"createConvGroup",value:function(e){var t=this;if(!this._convM.canIUse(P.CONV_GROUP))return this._convM.noUse("createConvGroup");var n="".concat(this._n,".").concat("createConvGroup"),o=(Re.l("".concat(n," options:"),e),new io("createConvGroup")),a=(o.setMessage(JSON.stringify(e)),e.groupName),i=(e=e.conversationIDList,{fromAccount:this._getMyUserID(),itemList:[{groupName:a,contactItem:[]}]}),r=[],s=[];return e.forEach((function(e){return t._hasLocalConv(e)?Mt(e)||wt(e)?void(Mt(e)?i.itemList[0].contactItem.push({type:1,toAccount:e.replace(S.CONV_C2C,"")}):wt(e)&&i.itemList[0].contactItem.push({type:2,groupID:e.replace(S.CONV_GROUP,"")})):(t._onConvIDInvalid(s,e),!0):(t._onConvNotFound(s,e),!0)})),s.length===e.length?Sn({successConversationIDList:r,failureConversationIDList:s}):this._convM.req({P:jn.CREATE_CONV_GRP,data:i}).then((function(e){o.end(),Re.l("".concat(n," ok"));var i,l,c,u=(e=e.data.groupResultItem[0]).groupItem;return e=e.resultItem,We(u)&&(t._convGroupMap.set(u.convGroupID,u.groupName),t._emitConvGroupListUpdate()),Ze(e)&&(c=!1,e.forEach((function(e){i=t._concatConvID(e.contactItem),0===e.resultCode?(r.push(i),(l=t._getLocalConv(i))&&-1===l.conversationGroupList.indexOf(a)&&(l.conversationGroupList.push(a),c=!0)):s.push({conversationID:i,code:e.resultCode,message:e.resultInfo})})),!0===c&&(t._emitConvUpdate(),t._emitConvGroupListUpdate())),Tn({successConversationIDList:r,failureConversationIDList:s})})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"deleteConvGroup",value:function(e){var t=this;if(!this._convM.canIUse(P.CONV_GROUP))return this._convM.noUse("deleteConvGroup");var n="".concat(this._n,".").concat("deleteConvGroup"),o=(Re.l("".concat(n," groupName:").concat(e)),new io("deleteConvGroup"));return o.setMessage(e),this._convM.req({P:jn.DEL_CONV_GRP,data:{fromAccount:this._getMyUserID(),groupName:[e]}}).then((function(a){var i;o.end(),Re.l("".concat(n," ok")),Ze(a=a.data.groupItem)&&(i=!1,a.forEach((function(e){t._convGroupMap.has(e.convGroupID)&&(t._convGroupMap.delete(e.convGroupID),i=!0)})),!0===i&&t._emitConvGroupListUpdate()),t._eraseFromConversationGroupList([e])})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"renameConvGroup",value:function(e){var t=this;if(!this._convM.canIUse(P.CONV_GROUP))return this._convM.noUse("renameConvGroup");var n="".concat(this._n,".").concat("renameConvGroup"),o=(Re.l("".concat(n," options:"),e),new io("renameConvGroup")),a=(o.setMessage(JSON.stringify(e)),e.oldName),i=e.newName;return this._convM.req({P:jn.RENAME_CONV_GRP,data:{fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:1,oldName:a,newName:i}}}).then((function(e){o.end(),Re.l("".concat(n," ok")),e=e.data.updateGroupResult.convGroupID,t._convGroupMap.set(e,i),t._emitConvGroupListUpdate(),e=t._convM.getLocalConvList();var r,s,l=!1;e.forEach((function(e){r=e.conversationGroupList,-1!==(s=r.indexOf(a))&&(r.splice(s,1,i),l=!0)})),!0===l&&t._emitConvUpdate()})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"addConvsToGroup",value:function(e){var t=this;if(!this._convM.canIUse(P.CONV_GROUP))return this._convM.noUse("addConvsToGroup");var n="".concat(this._n,".").concat("addConvsToGroup"),o=(Re.l("".concat(n," options:"),e),new io("addConvsToGroup")),a=(o.setMessage(JSON.stringify(e)),e.conversationIDList),i=e.groupName,r={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:i,updateItem:[]}},s=[],l=[];return a.forEach((function(e){return t._hasLocalConv(e)?Mt(e)||wt(e)?void(Mt(e)?r.updateGroup.updateItem.push({operationType:1,contactItem:{type:1,toAccount:e.replace(S.CONV_C2C,"")}}):wt(e)&&r.updateGroup.updateItem.push({operationType:1,contactItem:{type:2,groupID:e.replace(S.CONV_GROUP,"")}})):(t._onConvIDInvalid(l,e),!0):(t._onConvNotFound(l,e),!0)})),l.length===a.length?Sn({successConversationIDList:s,failureConversationIDList:l}):this._convM.req({P:jn.ADD_CONV_TO_GRP,data:r}).then((function(e){var a,r,c;return o.end(),Re.l("".concat(n," ok")),Ze(e=e.data.updateGroupResult.contactResultItem)&&(c=!1,e.forEach((function(e){a=t._concatConvID(e.contactItem),0===e.resultCode?(r=t._getLocalConv(a))&&-1===r.conversationGroupList.indexOf(i)&&(r.conversationGroupList.push(i),s.push(a),c=!0):l.push({conversationID:a,code:e.resultCode,message:e.resultInfo})})),!0===c&&(t._emitConvUpdate(),t._emitConvInGroupUpdate(i))),Tn({successConversationIDList:s,failureConversationIDList:l})})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"deleteConvsFromGroup",value:function(e){var t=this,n="deleteConvsFromGroup";if(!this._convM.canIUse(P.CONV_GROUP))return this._convM.noUse(n);var o="".concat(this._n,".").concat(n),a=(Re.l("".concat(o," options:"),e),new io(n)),i=(a.setMessage(JSON.stringify(e)),n=e.conversationIDList,e.groupName),r={fromAccount:this._getMyUserID(),updateType:1,updateGroup:{updateGroupType:2,groupName:i,updateItem:[]}},s=[],l=[];return n.forEach((function(e){return t._hasLocalConv(e)?Mt(e)||wt(e)?void(Mt(e)?r.updateGroup.updateItem.push({operationType:2,contactItem:{type:1,toAccount:e.replace(S.CONV_C2C,"")}}):wt(e)&&r.updateGroup.updateItem.push({operationType:2,contactItem:{type:2,groupID:e.replace(S.CONV_GROUP,"")}})):(t._onConvIDInvalid(l,e),!0):(t._onConvNotFound(l,e),!0)})),l.length===n.length?Sn({successConversationIDList:s,failureConversationIDList:l}):this._convM.req({P:jn.DEL_CONV_FROM_GRP,data:r}).then((function(e){var n,r,c;return a.end(),Re.l("".concat(o," ok")),Ze(e=e.data.updateGroupResult.contactResultItem)&&(c=!1,e.forEach((function(e){var o;n=t._concatConvID(e.contactItem),0===e.resultCode?!(r=t._getLocalConv(n))||-1!==(o=r.conversationGroupList.indexOf(i))&&(r.conversationGroupList.splice(o,1),s.push(n),c=!0):l.push({conversationID:n,code:e.resultCode,message:e.resultInfo})})),!0===c&&(t._emitConvUpdate(),t._emitConvInGroupUpdate(i))),Tn({successConversationIDList:s,failureConversationIDList:l})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"onConvMarkUpdated",value:function(e){var t,n,o=this;He(e)||(Re.l("".concat(this._n,".onConvMarkUpdated markItemList:"),e),n=!1,e.forEach((function(e){var a=e.recentContactItem,i=e.optType,r=e.standardMark;e=e.customMark,t=o._concatConvID(a),(t=o._getLocalConv(t))&&(1===i?n=o._diffStandardMark(t,r):2===i?n=o._diffCustomMark(t,e):3===i&&(a=o._diffStandardMark(t,r),i=o._diffCustomMark(t,e),n=a||i))})),!0===n&&this._emitConvUpdate())}},{key:"_diffStandardMark",value:function(e,t){t=Ht(t);var n=!1;return!0!==function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(e.length!==t.length)return!1;for(var n=0,o=e.length;n<o;n++)if(e[n]!==t[n])return!1;return!0}(e.markList,t)&&(e.markList=t,n=!0),n}},{key:"_diffCustomMark",value:function(e,t){var n=!1;return e.customData!==t&&void 0!==t&&(e.customData=t,n=!0),n}},{key:"onConvGroupCreated",value:function(e){var t=this,n=(Re.l("".concat(this._n,".onConvGroupCreated resultList:"),e),!1),o=!1;Ze(e)&&(e.forEach((function(e){var a,i,r=(i=e.msgGroupItem).groupID,s=i.groupName;t._convGroupMap.get(r)!==s&&(t._convGroupMap.set(r,s),o=!0),Ze(i=e.msgRecentContactItem)&&i.forEach((function(e){a=t._concatConvID(e),(a=t._getLocalConv(a))&&-1===a.conversationGroupList.indexOf(s)&&(a.conversationGroupList.push(s),n=!0)}))})),!0===n&&this._emitConvUpdate(),!0===o&&this._emitConvGroupListUpdate())}},{key:"onConvGroupDeleted",value:function(e){var t,n=this,o=(Re.l("".concat(this._n,".onConvGroupDeleted groupItemList:"),e),[]);Ze(e)&&(t=!1,e.forEach((function(e){var a=e.groupID;e=e.groupName,n._convGroupMap.has(a)&&(n._convGroupMap.delete(a),t=!0,o.push(e))})),!0===t&&this._emitConvGroupListUpdate()),this._eraseFromConversationGroupList(o)}},{key:"_eraseFromConversationGroupList",value:function(e){He(e)||(this._convM.getLocalConvList().forEach((function(t){t.conversationGroupList=t.conversationGroupList.filter((function(t){return!e.includes(t)}))})),this._emitConvUpdate())}},{key:"onConvGroupNameUpdated",value:function(e){Re.l("".concat(this._n,".onConvGroupNameUpdated options:"),e);var t,n,o,a=e.groupID,i=e.groupName,r=e.oldGroupName;this._convGroupMap.get(a)!==i&&(this._convGroupMap.set(a,i),this._emitConvGroupListUpdate(),e=this._convM.getLocalConvList(),o=!1,e.forEach((function(e){t=e.conversationGroupList,-1!==(n=t.indexOf(r))&&(t.splice(n,1,i),o=!0)})),!0===o&&this._emitConvUpdate())}},{key:"onConvInGroupUpdated",value:function(e){var t,n,o,a=this,i=(Re.l("".concat(this._n,".onConvInGroupUpdated options:"),e),e.oldGroupName);Ze(e=e.recentContactUpdateGroupItem)&&(o=!1,e.forEach((function(e){var r=e.contactOptType;e=e.recentContactItem,t=a._concatConvID(e),(t=a._getLocalConv(t))&&(n=t.conversationGroupList.indexOf(i),1===r?-1===n&&(t.conversationGroupList.push(i),o=!0):2===r&&-1!==n&&(t.conversationGroupList.splice(n,1),o=!0))})),!0===o&&(this._emitConvUpdate(),this._emitConvInGroupUpdate(i)))}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){var t,n,o=this,a=(Re.l("".concat(this._n,".onConvAddedToOrDeletedFromGroup options:"),e),e.msgRecentContactItem),i=(e=e.msgRecentContactUpdateContactItem,a=this._concatConvID(a),this._getLocalConv(a));i&&Ze(e)&&(n=!1,e.forEach((function(e){var a=e.groupOptType;e=e.recentContactGroupItem.groupName,t=i.conversationGroupList.indexOf(e),1===a?-1===t&&(i.conversationGroupList.push(e),n=!0):2===a&&-1!==t&&(i.conversationGroupList.splice(t,1),n=!0),!0===n&&o._emitConvInGroupUpdate(e)})),!0===n&&this._emitConvUpdate())}},{key:"onConvGroupListSynced",value:function(e){Ze(e)&&0!==e.length&&(Re.l("".concat(this._n,".onConvGroupListSynced groupItem:"),e),this._fillConvGroupMap(e))}},{key:"getConvGroupListByID",value:function(e){var t,n=this;if(!He(e))return t=[],e.forEach((function(e){n._convGroupMap.has(e)&&t.push(n._convGroupMap.get(e))})),t}},{key:"_onConvNotFound",value:function(e,t){e.push({conversationID:t,code:zn.CONV_NOT_FOUND,message:this._convM.getErrMsg(zn.CONV_NOT_FOUND)})}},{key:"_onConvIDInvalid",value:function(e,t){e.push({conversationID:t,code:zn.INVALID_CONV_ID,message:this._convM.getErrMsg(zn.INVALID_CONV_ID)})}},{key:"_getFlagBit",value:function(e){for(var t=e.toString(2),n=t.length,o=n-1;0<=o;o--)if("1"===t[o])return n-o-1}},{key:"_concatConvID",value:function(e){var t,n=e.type,o=e.to,a=e.groupID;return e=e.userID,1===n?pt(e)?pt(o)||(t="".concat(S.CONV_C2C).concat(o)):t="".concat(S.CONV_C2C).concat(e):2===n&&(t="".concat(S.CONV_GROUP).concat(a)),t}},{key:"_getMyUserID",value:function(){return this._convM.getMyUserID()}},{key:"_getLocalConv",value:function(e){return this._convM.getLocalConversation(e)}},{key:"_hasLocalConv",value:function(e){return this._convM.hasLocalConversation(e)}},{key:"_emitConvUpdate",value:function(){this._convM.emitConvUpdate(!0,!1)}},{key:"_emitConvGroupListUpdate",value:function(){this._convM.emitOEvt(T.CONVERSATION_GROUP_LIST_UPDATED,v(this._convGroupMap.values()))}},{key:"_emitConvInGroupUpdate",value:function(e){var t={groupName:e,conversationList:[]},n=this._convM.getLocalConvList();t.conversationList=n.filter((function(t){return t.conversationGroupList.includes(e)})),this._convM.emitOEvt(T.CONVERSATION_IN_GROUP_UPDATED,t)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._convGroupMap.clear(),this._startIndex=0,this._pagingStatus=Rn}}]),ri),ma=(s(ii,Un),ia=g(ii),i(ii,[{key:"_initListeners",value:function(){var e=this.getIEmitInst();e.on(Yo.A2KEY_AND_TINYID_UPDATED,this._init,this),e.on(Yo.PROFILE_UPDATED,this._onProfileUpdated,this),e.on(Yo.CLOUD_CONFIG,this._onCloudConfig,this)}},{key:"_init",value:function(){var e=this,t=(Re.l("".concat(this._n,"._init")),this.get(13).getItem("conversationMap")),n=this.isIntl(),o=this.isUsingChatCore();if(t){for(var a=t.length,i=0;i<a;i++){var r=t[i];if(r){if(this._isNonExistentAccount(r.conversationID))continue;if(r.groupProfile&&Et(r.groupProfile.type))continue}this._convMap.set(r.conversationID,new pa(t[i],n,o))}this.emitConvUpdate(!0,!1)}this.ready((function(){0<e._tmpGroupList.length&&(e.updateConvGroupProfile(e._tmpGroupList),e._tmpGroupList.length=0)})),this.syncConvList()}},{key:"_isNonExistentAccount",value:function(e){var t;return"@TLS#ERROR"===(t=e.startsWith(S.CONV_C2C)?e.replace(S.CONV_C2C,""):t)||"@TLS#NOT_FOUND"===t}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&this._msgListHandler.onCheckTimer(e)}},{key:"onMessageSent",value:function(e){this._onSendOrRcvMsg({conversationOptionsList:e.conversationOptionsList,isInstantMessage:!0})}},{key:"onNewMessage",value:function(e){this._onSendOrRcvMsg(e)}},{key:"_onSendOrRcvMsg",value:function(e){var t=this,n=e.conversationOptionsList,o=void 0===(o=e.isInstantMessage)||o,a=void 0!==(a=e.isUnreadC2CMessage)&&a,i=void 0===(i=e.updateUnreadCount)||i,r=void 0!==(r=e.isSyncingEnded)&&r;this._isReady?0!==n.length?(!0===o&&this._checkNewConv(n),this._updateLocalConvList({conversationOptionsList:n,isInstantMessage:o,isUnreadC2CMessage:a,isFromGetConversations:!1,updateUnreadCount:i}),o||(this._convIDFromUnreadDBMap=new Map([].concat(v(this._convIDFromUnreadDBMap),v(n.map((function(e){return[e.conversationID,1]}))))),this._diffAndDeleteConv(),r&&this.emitIEvt(Yo.C2C_UNREAD_HANDLE_COMPLETED)),0<n.filter((function(e){return!t._isConvNeedShow(e.conversationID)})).length||this.emitConvUpdate()):r&&this.emitIEvt(Yo.C2C_UNREAD_HANDLE_COMPLETED):this.ready((function(){t._onSendOrRcvMsg(e)}))}},{key:"updateConvGroupProfile",value:function(e){var t,n=this;Ze(e)&&0===e.length||(0!==this._convMap.size?(t=!1,e.forEach((function(e){var o="".concat(S.CONV_GROUP).concat(e.groupID);n._convMap.has(o)&&(t=!0,(o=n._convMap.get(o)).groupProfile=JSON.parse(JSON.stringify(e)),o.lastMessage.lastSequence<e.nextMessageSeq&&(o.lastMessage.lastSequence=e.nextMessageSeq-1),o.subType||(o.subType=e.type))})),t&&this.emitConvUpdate(!0,!1)):this._tmpGroupList=e)}},{key:"onMessageRevoked",value:function(e,t){var n,o,a,i=this;0!==e.length&&(n=null,o=!1,a=[],e.forEach((function(e){(n=i._convMap.get(e.conversationID))&&(t&&n.reduceUnreadCount()&&(o=n.type!==S.CONV_TOPIC),n.type===S.CONV_TOPIC?a.push(e):n.isLastMessageRevoked({sequence:e.sequence,time:e.time})&&(n.setLastMessageRevoked(!0),n.setLastMessageRevoker(e.revoker),o=!0))})),this.get(10).onMessageRevoked(a),o&&this.emitConvUpdate(!0,!1))}},{key:"updateRevokerInfo",value:function(e){for(var t=new Set,n=0;n<e.length;n++){var o=e[n].revoker;t.add(o)}var a=v(t),i=this.get(4);return new Promise((function(t){i.getUserProfile({userIDList:a}).then((function(n){if(!Ze(n=n.data)||0===n.length)return t(e);var o,a={},i=E(n);try{for(i.s();!(o=i.n()).done;){var r=o.value,s=r.userID,l=r.nick,c=r.avatar;a[s]={nick:l,avatar:c}}}catch(u){i.e(u)}finally{i.f()}e.forEach((function(e){var t=e.revoker;a[t]&&(e.revokerInfo.nick=a[t].nick||"",e.revokerInfo.avatar=a[t].avatar||"")})),t(e)})).catch((function(){t(e)}))}))}},{key:"isLastMessageRevoked",value:function(e){var t=!1,n=e.conversationID,o=e.sequence,a=e.time,i=this._convMap.get(n);return i&&(t=i.type===S.CONV_TOPIC?this.get(10).isLastMessageRevoked({topicID:n.replace(S.CONV_GROUP,""),sequence:o}):i.isLastMessageRevoked({sequence:o,time:a})),Re.l("".concat(this._n,".isLastMessageRevoked options:"),e,"ret:".concat(t)),t}},{key:"onMessageDeleted",value:function(e){var t=this;if(0!==e.length){var n=null;e.forEach((function(e){(n=t._msgListHandler.getLocalMsg(e.conversationID,e.ID))&&(n.isDeleted=!0),e!==n&&(e.isDeleted=!0)})),e=e[0].conversationID;for(var o=this._msgListHandler.getLocalMsgList(e),a={},i=o.length-1;0<=i;i--)if(!o[i].isDeleted){a=o[i];break}var r,s=this._convMap.get(e);s&&(r=!1,s.lastMessage.lastSequence===a.sequence&&s.lastMessage.lastTime===a.time||(He(a)&&(a=void 0),s.updateLastMessage(a),s.type!==S.CONV_TOPIC&&(r=!0),Re.l("".concat(this._n,".onMessageDeleted. update convID:").concat(e," with lastMessage:"),s.lastMessage)),e.startsWith(S.CONV_C2C)&&this.updateUnreadCount(e),r&&this.emitConvUpdate(!0,!1))}}},{key:"onMessageModified",value:function(e){var t="".concat(this._n,".onMessageModified"),n=e.conversationType,o=e.from,a=e.to,i=e.time,r=e.sequence,s=e.elements,l=e.cloudCustomData,c=e.messageVersion,u=this.getMyUserID(),d="".concat(n).concat(a),p=(n=(a===u&&n===S.CONV_C2C&&(d="".concat(n).concat(o)),u=this._msgListHandler.onMsgModified(d,e)).isUpdated,u=u.message,!0===n&&this.emitOEvt(T.MESSAGE_MODIFIED,[u]),this._isTopicConv(d));return null===u?Re.l("".concat(t," message is null! options:"),e):Re.l("".concat(t," isUpdated:").concat(n," isTopicMessage:").concat(p," from:").concat(o," to:").concat(a," sequence:").concat(u.sequence," time:").concat(u.time)),p?this.get(10).onMessageModified(e):!(n=this._convMap.get(d))||(o=n.lastMessage)&&o.lastTime===i&&o.lastSequence===r&&o.version!==c&&(Re.l("".concat(t," convID:").concat(d," lastMessage updated")),o.type=s[0].type,o.payload=s[0].content,o.messageForShow=Ft(o.type,o.payload,this.isIntl()),o.cloudCustomData=l,o.version=c,this.emitConvUpdate(!0,!1)),u}},{key:"onNewGroupAtTips",value:function(e){var n=this,o=(e=e.dataList,null);e.forEach((function(e){e.groupAtTips?o=e.groupAtTips:e.elements?o=t(t({},e.elements),{},{sync:!0}):e.groupAtType&&(o=t(t({},e),{},{sync:!0})),o.__random=e.random,o.__sequence=e.clientSequence,n._tmpGroupAtTipsList.push(o)})),Re.l("".concat(this._n,".onNewGroupAtTips isReady:").concat(this._isReady),this._tmpGroupAtTipsList),this._isReady&&this._handleGroupAtTipsList()}},{key:"_handleGroupAtTipsList",value:function(){var e,t=this;0!==this._tmpGroupAtTipsList.length&&(e=!1,this._tmpGroupAtTipsList.forEach((function(n){var o=n.groupID,a=n.from,i=void 0===(i=n.topicID)?void 0:i,r=void 0!==(r=n.sync)&&r;a!==t.getMyUserID()&&(pt(i)?(a=t._convMap.get("".concat(S.CONV_GROUP).concat(o)))&&(a.updateGroupAtInfoList(n),e=!0):((o=t._convMap.get("".concat(S.CONV_GROUP).concat(i)))&&(o.updateGroupAtInfoList(n),t.get(10).onAtInfoUpdated({topicID:i,groupAtInfoList:o.groupAtInfoList})),He(o)&&r&&(t.updateTopicConversation([{conversationID:"".concat(S.CONV_GROUP).concat(i),type:S.CONV_TOPIC}]),t._convMap.get("".concat(S.CONV_GROUP).concat(i)).updateGroupAtInfoList(n))))})),e&&this.emitConvUpdate(!0,!1),this._tmpGroupAtTipsList.length=0)}},{key:"_checkNewConv",value:function(e){var t=this,n=[],o=[];e.forEach((function(e){t._convMap.has(e.conversationID)||(e.type===S.CONV_C2C?n.push(e.conversationID.replace(S.CONV_C2C,"")):e.type===S.CONV_GROUP&&o.push(e.conversationID.replace(S.CONV_GROUP,"")))})),0<n.length&&(this._onNewC2CConv(n),n=null),0<o.length&&(this._onNewGroupConv(o),o=null)}},{key:"_onNewC2CConv",value:function(e){var t=this.get(6);return Promise.all([t.getRemotePeerReadTime(e),this._msgRemindHandler.getC2CMsgRemindType(e),this._convGroupHandler.searchConvGroupAndMark(e,1)])}},{key:"_onNewGroupConv",value:function(e){var t=this.get(7);return t?Promise.all([t.getMsgRemindType(e),this._convGroupHandler.searchConvGroupAndMark(e,2)]):Promise.resolve()}},{key:"_setStorageConvList",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=this.getLocalConvList().filter((function(e){return e.type===S.CONV_C2C||e.type===S.CONV_GROUP&&e.lastMessage.type!==S.MSG_GRP_TIP})).slice(0,20).map((function(e){return{conversationID:e.conversationID,type:e.type,subType:e.subType,lastMessage:e.lastMessage,groupProfile:e.groupProfile,userProfile:e.userProfile}}));this.get(13).setItem("conversationMap",t,e)}},{key:"emitConvUpdate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.getLocalConvList();!t||(t=this.get(7))&&t.updateGroupLastMessage(n),e&&(this.get(12).isPartialUpdatedConvs()?(this._diffConvMap(this._convMapForDiff,this._convMap),0<this._partialUpdatedConvMap.size&&(this.emitOEvt(T.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate(),this._convMapForDiff.clear(),this._convMapForDiff=ot(this._convMap,!0)),0===this._convMapForDiff.size&&(this._convMapForDiff=ot(this._convMap,!0))):(this.emitOEvt(T.CONVERSATION_LIST_UPDATED),this.onTotalUnreadCountUpdate()))}},{key:"_diffConvMap",value:function(e,t){var n,o=E(t);try{for(o.s();!(n=o.n()).done;){var a=m(n.value,2),i=a[0],r=a[1];e.has(i)&&JSON.stringify(r)===e.get(i)||this._partialUpdatedConvMap.set(i,r)}}catch(s){o.e(s)}finally{o.f()}}},{key:"getPartialUpdatedConvs",value:function(){var e=v(ot(this._partialUpdatedConvMap,!1).values());return this._partialUpdatedConvMap.clear(),e}},{key:"getLocalConvList",value:function(){var e=this;return v(this._convMap.values()).filter((function(t){return e._isConvNeedShow(t.conversationID)}))}},{key:"getLocalConversation",value:function(e){return this._convMap.get(e)}},{key:"hasLocalConversation",value:function(e){return this._convMap.has(e)}},{key:"getLocalOldestMessage",value:function(e){return this._msgListHandler.getLocalOldestMsg(e)}},{key:"syncConvList",value:function(){var e=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n="syncConvList",o=new io(n);return this._pagingStatus===Rn&&this._convMap.clear(),this._pagingGetConvList(t).then((function(t){var a=Yt(e._pagingGetCostList),i=Kt(e._pagingGetCostList);return e._pagingGetCostList.length=0,e._pagingStatus=An,e._diffAndDeleteConv(),e.emitConvUpdate(!0,!1),e._setStorageConvList(),e._handleC2CPeerReadTime(),e.emitIEvt(Yo.CONV_SYNC_COMPLETED),i="count:".concat(e._convMap.size," sum:").concat(i," avg:").concat(a),Re.l("".concat(e._n,".").concat(n,". ").concat(i)),o.setMessage(i).end(),t})).catch((function(t){return e._pagingStatus=On,o.setMessage(e._pagingTs).setError(t).end(),Mn(t)}))}},{key:"_diffAndDeleteConv",value:function(){var e,t=this;this._isSyncCompleted()&&(e=[],this._convMap.forEach((function(n,o){!t._pagingConvIDMap.has(o)&&t._convIDFromUnreadDBMap.has(o)&&(t._convMap.delete(o),e.push(o))})),Re.l("".concat(this._n,"._diffAndDeleteConv list:").concat(e)),e=null)}},{key:"_pagingGetConvList",value:function(){var e=this,t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],n="".concat(this._n,"._pagingGetConvList"),o=(Re.l("".concat(n," incrementalPullFlag:").concat(t," ts:").concat(this._pagingTs," startIdx:").concat(this._pagingStartIdx)+" pinnedTs:".concat(this._pagingPinnedTs," pinnedStartIdx:").concat(this._pagingPinnedStartIdx)),Date.now());return this._pagingStatus=Ln,this.req({P:jn.PAGING_GET_CONV_LIST,data:{fromAccount:this.getMyUserID(),timeStamp:t?this._pagingTs:0,startIndex:t?this._pagingStartIdx:0,pinnedTimeStamp:t?this._pagingPinnedTs:0,pinnedStartIndex:t?this._pagingPinnedStartIdx:0,orderType:1}}).then((function(t){var a=(t=t.data).completeFlag,i=void 0===(i=t.conversations)?[]:i,r=t.timeStamp,s=t.startIndex,l=t.pinnedTimeStamp,c=t.pinnedStartIndex;if(t=t.groupItem,e._pagingGetCostList.push($t(o,!1)),Re.l("".concat(n," ok. completeFlag:").concat(a," count:").concat(i.length," cost:").concat($t(o))),e._convGroupHandler.onConvGroupListSynced(t),0<i.length&&(t=e._getConvOptions(i),e._pagingConvIDMap=new Map([].concat(v(e._pagingConvIDMap),v(t.map((function(e){return[e.conversationID,1]}))))),e._updateLocalConvList({conversationOptionsList:t,isFromGetConversations:!0,updateUnreadCount:!0}),e.isLoggedIn()&&e.emitConvUpdate()),!e._isReady){if(!e.isLoggedIn())return Sn();e.triggerReady()}return e._pagingTs=r,e._pagingStartIdx=s,e._pagingPinnedTs=l,e._pagingPinnedStartIdx=c,1!==a?e._pagingGetConvList():(e._handleGroupAtTipsList(),e._convGroupHandler.getRemoteConvGroupList(),Sn())})).catch((function(t){throw e.isLoggedIn()&&(e._isReady||(Re.w("".concat(n," failed. error:"),t),e.triggerReady())),t}))}},{key:"_updateLocalConvList",value:function(e){var t=e.isFromGetConversations,n=Date.now();e=this._getTmpConvListMapping(e).newConvList,this._convMap=new Map(this._sortConvList(v(this._convMap))),t||this._updateUserOrGroupProfile(e),Re.l("".concat(this._n,"._updateLocalConvList cost:").concat($t(n)))}},{key:"_getTmpConvListMapping",value:function(e){for(var t=e.conversationOptionsList,n=e.isFromGetConversations,o=e.isInstantMessage,a=e.isUnreadC2CMessage,i=void 0!==a&&a,r=e.updateUnreadCount,s=[],l=[],c=this.get(7),u=this.get(8),d=this.isIntl(),p=this.isUsingChatCore(),h=0,f=t.length;h<f;h++){var g=new pa(t[h],d,p),m=g.conversationID,v=g.type;if(!this._isNonExistentAccount(m)){if(this._convMap.has(m)){var _=this._convMap.get(m);if(n&&v!==S.CONV_TOPIC){this._convMap.set(m,g),v===S.CONV_C2C?g.unreadCount=_.unreadCount:v===S.CONV_GROUP&&(g.groupProfile=JSON.parse(JSON.stringify(_.groupProfile)));continue}var y=["unreadCount","allowType","adminForbidType","payload"],I=(!1===o&&y.push("lastMessage"),"boolean"==typeof o&&y.push("isPinned"),t[h].lastMessage),C=!pt(I);C||t[h].type===S.CONV_TOPIC||this._onLastMsgNotExist(t[h]),pt(o)&&C&&null===_.lastMessage.payload&&(_.lastMessage.payload=I.payload),He(_.lastMessage.revoker)||(_.lastMessage.revoker=null),nt(_,g,y,[null,void 0,"",0,NaN]),!0===r&&_.updateUnreadCount({nextUnreadCount:g.unreadCount,isFromGetConversations:n,isUnreadC2CMessage:i}),o&&C&&(I.payload&&(_.lastMessage.payload=I.payload),_.type===S.CONV_GROUP&&(_.lastMessage.nameCard=I.nameCard,_.lastMessage.nick=I.nick)),C&&_.lastMessage.cloudCustomData!==I.cloudCustomData&&(_.lastMessage.cloudCustomData=I.cloudCustomData||"")}else v===S.CONV_GROUP&&c?(y=g.groupProfile.groupID,(C=c.getLocalGroupProfile(y))&&(g.groupProfile=C,!0===r&&g.updateUnreadCount({nextUnreadCount:0}))):v===S.CONV_C2C&&(_=m.replace(S.CONV_C2C,""),u&&u.isMyFriend(_)&&(g.remark=u.getFriendRemark(_))),s.push(g),this._convMap.set(m,g);this._convMap.get(m).type===S.CONV_TOPIC&&l.push(this._convMap.get(m))}}for(var k=this.get(10),E=0,T=l.length;E<T;E++){var M,w=(M=l[E]).conversationID;He(M=M.groupAtInfoList)||k.onAtInfoUpdated({topicID:w.replace(S.CONV_GROUP,""),groupAtInfoList:M})}return{newConvList:s}}},{key:"_onLastMsgNotExist",value:function(e){new io("lastMsgNotExist").setMessage(JSON.stringify(e)).end()}},{key:"_sortConvList",value:function(e){var t=[],n=[],o=[],a=[];return e.forEach((function(e){(!0===e[1].isPinned?He(e[1].lastMessage.lastTime)?n:t:He(e[1].lastMessage.lastTime)?a:o).push(e)})),t.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})).concat(n).concat(o.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime}))).concat(a)}},{key:"_sortConvListAndEmitEvent",value:function(){this._convMap=new Map(this._sortConvList(v(this._convMap))),this.emitConvUpdate(!0,!1)}},{key:"_updateUserOrGroupProfile",value:function(e){var t,n,o,a,i=this;0!==e.length&&(t=[],n=[],o=this.get(4),a=this.get(7),e.forEach((function(e){var o;e.type===S.CONV_C2C?t.push(e.toAccount):e.type===S.CONV_GROUP&&(o=e.toAccount,a.hasLocalGroup(o)?e.groupProfile=a.getLocalGroupProfile(o):n.push(o))})),Re.l("".concat(this._n,"._updateUserOrGroupProfile userIDList:").concat(t," groupIDList:").concat(n)),0<t.length&&o.getUserProfile({userIDList:t}).then((function(e){Ze(e=e.data)?e.forEach((function(e){i._doUpdateUserProfile("".concat(S.CONV_C2C).concat(e.userID),e)})):i._doUpdateUserProfile("".concat(S.CONV_C2C).concat(e.userID),e)})),0<n.length&&a.getGroupProfileAdvance({groupIDList:n,responseFilter:{groupBaseInfoFilter:["Type","Name","FaceUrl"]}}).then((function(e){e=e.data.successGroupList;var t=!1;e.forEach((function(e){var n="".concat(S.CONV_GROUP).concat(e.groupID);i._convMap.has(n)&&(nt((n=i._convMap.get(n)).groupProfile,e,[],[null,void 0,"",0,NaN]),!n.subType&&e.type&&(n.subType=e.type),t=!0)})),t&&i.emitConvUpdate()})))}},{key:"_doUpdateUserProfile",value:function(e,t){this.hasLocalConversation(e)&&(this.getLocalConversation(e).userProfile=t,this.emitConvUpdate())}},{key:"_getConvOptions",value:function(e){var n=this,o=[],a=(e=e.filter((function(e){var t=e.type;return e=e.userID,1===t&&!n._isNonExistentAccount(e)||2===t})),this.getMyUserID());return e=e.map((function(e){var i;return pt(e.lastMsg)&&(e.lastMsg={elements:[]}),1===e.type?(i={userID:e.userID,nick:e.peerNick,avatar:e.peerAvatar},o.push(i),{conversationID:"".concat(S.CONV_C2C).concat(e.userID),type:S.CONV_C2C,lastMessage:{lastTime:e.time,lastSequence:e.sequence,fromAccount:e.lastC2CMsgFromAccount,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:null,payload:e.lastMsg.elements[0]?n._amendLayersOverLimitProp(e.lastMsg.elements[0].content):null,cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:8===e.lastMessageFlag,onlineOnlyFlag:!1,nick:"",nameCard:"",version:0,isPeerRead:e.lastC2CMsgFromAccount===a&&e.time<=e.c2cPeerReadTime,revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null},unreadCount:0,userProfile:new la(i),peerReadTime:e.c2cPeerReadTime,isPinned:1===e.isPinned,customData:e.customMark||"",markList:Ht(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId),remark:e.friendRemark||"",messageRemindType:n._transMsgRemindType(e.messageRemindType)}):{conversationID:"".concat(S.CONV_GROUP).concat(e.groupID),type:S.CONV_GROUP,lastMessage:t(t({lastTime:e.time,lastSequence:e.sequence,fromAccount:e.msgGroupFromAccount},n._patchTypeAndPayload(e)),{},{cloudCustomData:e.lastMsg.cloudCustomData||"",isRevoked:2===e.lastMessageFlag,onlineOnlyFlag:!1,nick:e.senderNick||"",nameCard:e.senderNameCard||"",revoker:e.lastMsg.revokerInfo?e.lastMsg.revokerInfo.revoker:null}),groupProfile:new da({groupID:e.groupID,name:e.groupNick,avatar:e.groupImage,type:e.groupType,nextMessageSeq:e.nextMessageSeq}),unreadCount:n._computeGroupUnreadCount(e),peerReadTime:0,isPinned:1===e.isPinned,version:0,customData:e.customMark||"",markList:Ht(e.standardMark),conversationGroupList:n._convGroupHandler.getConvGroupListByID(e.contactGroupId),messageRemindType:n._transMsgRemindType(e.messageRemindType)}})),0<o.length&&this.get(4).onConvProfileUpdated(o),e}},{key:"_transMsgRemindType",value:function(e){var t="";return 0===e?t=S.MSG_REMIND_ACPT_AND_NOTE:1===e?t=S.MSG_REMIND_DISCARD:2===e?t=S.MSG_REMIND_ACPT_NOT_NOTE:3===e&&(t=S.NOT_RECEIVE_OFFLINE_PUSH_EXCEPT_AT),t}},{key:"_computeGroupUnreadCount",value:function(e){var t;return 0<(t=(void 0===(t=e.unreadCount)?0:t)-(void 0===(e=e.noUnreadCount)?0:e))?t:0}},{key:"_patchTypeAndPayload",value:function(e){var n=(e=e.lastMsg).event,o=void 0===(o=e.elements)?[]:o;return e=void 0===(e=e.groupTips)?{}:e,pt(void 0===n?void 0:n)||He(e)?{type:o[0]?o[0].type:null,payload:o[0]?this._amendLayersOverLimitProp(o[0].content):null}:((n=new No(e)).setElement({type:S.MSG_GRP_TIP,content:t(t({},e.elements),{},{groupProfile:e.groupProfile})}),o=JSON.parse(JSON.stringify(n.payload)),n=null,{type:S.MSG_GRP_TIP,payload:o})}},{key:"_amendLayersOverLimitProp",value:function(e){var t=e.layersOverLimit;return 0===t?e.layersOverLimit=!1:1===t&&(e.layersOverLimit=!0),e}},{key:"getLocalMessageList",value:function(e){return this._msgListHandler.getLocalMsgList(e)}},{key:"deleteLocalMessage",value:function(e){e instanceof No&&this._msgListHandler.remove(e)}},{key:"onConvDeleted",value:function(e){Ze(e)&&(e=e.map((function(e){var t=e.type,n=e.userID;return e=e.groupID,1===t?"".concat(S.CONV_C2C).concat(n):2===t?"".concat(S.CONV_GROUP).concat(e):void 0})),Re.l("".concat(this._n,".onConvDeleted convIDList:").concat(e)),this.deleteLocalConvList(e))}},{key:"onConvPinnedStatus",value:function(e,t){var n,o=this;Ze(e)&&(n=!1,e.forEach((function(e){var a,i=e.type,r=e.userID;e=e.groupID,1===i?a=o.getLocalConversation("".concat(S.CONV_C2C).concat(r)):2===i&&(a=o.getLocalConversation("".concat(S.CONV_GROUP).concat(e))),a&&(Re.l("".concat(o._n,".onConvPinnedStatus convID:").concat(a.conversationID," localPinned:").concat(a.isPinned," remotePinned:").concat(t)),t?a.isPinned||(a.isPinned=!0,n=!0):a.isPinned&&(a.isPinned=!1,n=!0))})),n&&this._sortConvListAndEmitEvent())}},{key:"getMessageList",value:function(e){var t=this,n=e.conversationID,o=e.nextReqMessageID,a=(e=e.count,"".concat(this._n,".getMessageList")),i="";if((s=this.getLocalConversation(n))&&s.groupProfile&&(i=s.groupProfile.type),Et(i))return Re.l("".concat(a," not available in ").concat(i,". convID:").concat(n)),Sn({messageList:[],nextReqMessageID:"",isCompleted:!0});(pt(e)||15<e)&&(e=15),o||this._isMeInCommunity(n)||this.clearMemMsg(n);var r=this._computeRemainingCount({conversationID:n,nextReqMessageID:o}),s=this._completedMap.has(n);return Re.l("".concat(a," convID:").concat(n," isEverCleared:").concat(this._isEverCleared(n)," nextReqMessageID:").concat(o)+" remainingCount:".concat(r," count:").concat(e," isCompleted:").concat(s)),this._needGetHistory({conversationID:n,remainingCount:r,count:e})?this.getHistoryMessages({conversationID:n,nextReqMessageID:o,count:20}).then((function(e){var o=e.nextReqID,i=e.storedMessageList,s=e.assembledMessageList,l=(e=e.isPullingCompleted,t._completedMap.has(n)),c=i,u=(0<r&&(c=t._msgListHandler.getLocalMsgList(n).slice(0,i.length+r)),{nextReqMessageID:void 0,messageList:void 0,isCompleted:void 0});return t._isEverCleared(n)?(u.nextReqMessageID=o,u.messageList=s,u.isCompleted=e):(u.nextReqMessageID=l?"":o,u.messageList=c,u.isCompleted=l),i=u.messageList.filter((function(e){return e.isRevoked}))||[],s=u.messageList.map((function(e){return e.sequence})),Re.l("".concat(a," ret.nextReqMessageID:").concat(u.nextReqMessageID," ret.isCompleted:").concat(u.isCompleted," sequenceList:"),s),Ze(i)&&0!==i.length?t.updateRevokerInfo(i).then((function(e){return e.forEach((function(e){var t=e.revokerInfo;u.messageList=u.messageList.map((function(n){return n.ID===e.ID&&t&&(n.revokeReason=t.reason||"",n.revokerInfo={userID:t.revoker||n.revoker,nick:t.nick,avatar:t.avatar}),n}))})),Tn(u)})):Tn(u)})):(this.modifyMessageList(n),Sn(i=this._getMsgListFromMem({conversationID:n,nextReqMessageID:o,count:e})))}},{key:"_isEverCleared",value:function(e){return this._everClearedMap.has(e)}},{key:"_getMsgListFromMem",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=(e=e.count,"".concat(this._n,"._getMsgListFromMem")),a=this._msgListHandler.getLocalMsgList(t),i=a.length,r=Mt(t),s=0,l={isCompleted:!1,nextReqMessageID:"",messageList:[]};return n?(s=r?a.findIndex((function(e){return e.ID===n})):a.findIndex((function(e){return e.sequence+""===n})))>e?(l.messageList=a.slice(s-e,s),l.nextReqMessageID=r?a[s-e].ID:a[s-e].sequence+""):(l.messageList=a.slice(0,s),l.isCompleted=!0):e<i?(l.messageList=a.slice(s=i-e,i),l.nextReqMessageID=r?a[s].ID:a[s].sequence+""):(l.messageList=a.slice(0,i),l.isCompleted=!0),e=l.messageList.map((function(e){return e.sequence})),Re.l("".concat(o," convID:").concat(t)+" ret.nextReqMessageID:".concat(l.nextReqMessageID," ret.isCompleted:").concat(l.isCompleted," sequenceList:").concat(e)),l}},{key:"getMessageListHopping",value:function(e){var t,n,o=e.conversationID,a=e.sequence,i=e.time,r=e.count;return e=void 0===(e=e.direction)?0:e,(pt(r)||15<r)&&(r=15),o.startsWith(S.CONV_C2C)?(t=this.get(6),n=o.replace(S.CONV_C2C,""),t.getRoamingMessagesHopping({peerAccount:n,time:i,count:r,direction:e})):o.startsWith(S.CONV_GROUP)?(t=this.get(7),n=o.replace(S.CONV_GROUP,""),t.getRoamingMessagesHopping({groupID:n,sequence:a,count:r,direction:e})):void 0}},{key:"_computeRemainingCount",value:function(e){var t=e.conversationID,n=e.nextReqMessageID,o=(e=this._msgListHandler.getLocalMsgList(t)).length;return Re.l("".concat(this._n,"._computeRemainingCount convID:").concat(t," nextReqMessageID:").concat(n," length:").concat(o)),n?(o=0,Mt(t)?o=e.findIndex((function(e){return e.ID===n})):wt(t)&&(o=-1!==n.indexOf("-")?e.findIndex((function(e){return e.ID===n})):e.findIndex((function(e){return e.sequence+""===n}))),-1===o?0:o):o}},{key:"_needGetHistory",value:function(e){var t=e.conversationID,n=e.remainingCount,o=(e=e.count,this.getLocalConversation(t)),a="";return o&&o.groupProfile&&(a=o.groupProfile.type),!bt(t)&&!Et(a)&&(!!this._isEverCleared(t)||(o=n<=e&&!this._completedMap.has(t),Re.l("".concat(this._n,"._needGetHistory convID:").concat(t," ret:").concat(o)),o))}},{key:"_isTopicConv",value:function(e){return St(e=e.replace(S.CONV_GROUP,""))}},{key:"getHistoryMessages",value:function(e){var t=e.conversationID,n=e.count;if(e=e.nextReqMessageID,t===S.CONV_SYSTEM)return Sn();var o,a,i=15;if(20<n&&(i=20),n=null,Mt(t))return l=0,o="",a=!1,s=this._roamingMsgKeyAndTimeMap.has(t),e&&(a=!0,s?(l=this._roamingMsgKeyAndTimeMap.get(t).lastMessageTime,o=this._roamingMsgKeyAndTimeMap.get(t).messageKey):(r=this._msgListHandler.findMessage(e))&&(l=r.time,Re.l("".concat(this._n,".getHistoryMessages convID:").concat(t," isRelayInfoExisted:").concat(s," lastMessageTime:").concat(l)))),(n=this.get(6)).getRoamingMessage({conversationID:t,peerAccount:t.replace(S.CONV_C2C,""),count:i,lastMessageTime:a?l:0,messageKey:a?o:""});if(wt(t)){if(!(n=this.get(7)))return Mn({code:zn.NO_MODULE});var r=t.replace(S.CONV_GROUP,""),s=null,l=(this._convMap.has(t)&&!St(r)&&(s=this._convMap.get(t).lastMessage),0);return e?l=Number(e):s&&(l=s.lastSequence),n.getRoamingMessage({conversationID:t,groupID:r,count:i,sequence:l})}return Sn()}},{key:"patchConvLastMessage",value:function(e){var t,n,o=1<arguments.length&&void 0!==arguments[1]&&arguments[1],a=this.getLocalConversation(e);a&&(t=(n=a.lastMessage).messageForShow,n=n.payload,!(He(t)||He(n)||o)||0!==(t=this._msgListHandler.getLocalMsgList(e)).length&&(n=t[t.length-1],Re.l("".concat(this._n,".patchConvLastMessage bForceUpdate:").concat(o," convID:").concat(e," payload:"),n.payload),a.updateLastMessage(n)))}},{key:"onRoamingMessage",value:function(){var e,n,o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],a=!(2<arguments.length&&void 0!==arguments[2])||arguments[2],i=3<arguments.length?arguments[3]:void 0,r=(c=1<arguments.length?arguments[1]:void 0).startsWith(S.CONV_C2C)?S.CONV_C2C:S.CONV_GROUP,s=null,l=[],c=[],u=0,d=o.length,p=r===S.CONV_GROUP,h=this.getFileDownloadProxy(),f=this.getDowloadFileAuthKey(),g=Ze(i),m=this.get(17).getFileDNList(),v=function(){p?--u:++u},_=function(){return p?d<=u:u<d};for(u=p?o.length-1:0,d=p?0:o.length;_();v())1!==o[u].isPlaceMessage&&((s=new No(o[u])).to=o[u].to,r!==S.CONV_GROUP||pt(o[u].topicID)||(s.to=o[u].topicID),s.isSystemMessage=!!o[u].isSystemMessage,s.conversationType=r,e=4===o[u].event?{type:S.MSG_GRP_TIP,content:t(t({},o[u].elements),{},{groupProfile:o[u].groupProfile})}:o[u].elements,p||s.setNickAndAvatar({nick:o[u].nick,avatar:o[u].avatar}),He(e)?((n=new io("emptyMessageBody")).setMessage("from:".concat(s.from," to:").concat(s.to," sequence:").concat(s.sequence," event:").concat(o[u].event)),n.setLevel("warning").end()):(s.setElement(e,h,f,m),s.reInitialize(this.getMyUserID()),l.push(s),g&&i.push(s)));return v=_=null,a?(this._msgListHandler.unshift(l,c),l=null,c):(c=null,l)}},{key:"findMessage",value:function(e){return this._msgListHandler.findMessage(e)}},{key:"_isMeInCommunity",value:function(e){var t=!0;return this._isTopicConv(e)&&(e=Gt(e.replace(S.CONV_GROUP,"")),this.get(7).hasLocalGroup(e)||(t=!1,Re.l("".concat(this._n,"._isMeInCommunity groupID:").concat(e," ret:").concat(t)))),t}},{key:"deleteTopicRoamingInfo",value:function(e){var t=this;Tt({groupID:e})&&this._msgListHandler.getTopicConvIDList(e).forEach((function(e){t.clearMemMsg(e)}))}},{key:"deleteGroupRoamingInfo",value:function(e){e="".concat(S.CONV_GROUP).concat(e),0<this._msgListHandler.getLocalMsgList(e).length&&this.clearMemMsg(e)}},{key:"setMessageRead",value:function(e){var t=e.conversationID,n=this.getLocalConversation(t);if(e="".concat(this._n,".setMessageRead"),Re.l("".concat(e," convID:").concat(t," unreadCount:").concat(n?n.unreadCount:0)),!n)return Sn();if(n.type!==S.CONV_GROUP&&n.type!==S.CONV_TOPIC||He(n.groupAtInfoList)||this.deleteGroupAtTips(t),0===n.unreadCount)return Sn();var o=this._msgListHandler.getLocalLastMsg(t),a=n.lastMessage.lastTime,i=(a<(i=this._msgListHandler.getLocalMaxTime(t))&&(Re.l("".concat(e," update lastMessageTime from ").concat(a," to ").concat(i)),a=i),this._msgListHandler.getLocalMaxSeq(t)),r=n.lastMessage.lastSequence,s=(r<i&&(Re.l("".concat(e," update lastMessageSeq from ").concat(r," to ").concat(i)),r=i),n.type===S.CONV_TOPIC&&pt(o)&&(e=this.get(10),o=Gt(i=t.replace(S.CONV_GROUP,"")),(e=e.getLocalTopic(o,i))&&(r=e.nextMessageSeq-1)),null);switch(n.type){case S.CONV_C2C:return(s=this.get(6))?s.setMessageRead({conversationID:t,lastMessageTime:a}):Mn({code:zn.NO_MODULE});case S.CONV_GROUP:case S.CONV_TOPIC:return(s=this.get(7))?s.setMessageRead({conversationID:t,lastMessageSeq:r}):Mn({code:zn.NO_MODULE});case S.CONV_SYSTEM:return n.unreadCount=0,this.emitConvUpdate(!0,!1),Sn();default:return Sn()}}},{key:"setAllMessageRead",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n="setAllMessageRead",o="".concat(this._n,".").concat(n),a=(t.scope||(t.scope=S.READ_ALL_MSG),Re.l("".concat(o," options:"),t),this._createSetAllMessageReadPack(t));if(0===a.readAllC2CMessage&&0===a.groupMessageReadInfoList.length)return Sn();var i=new io(n);return this.req({P:jn.SET_ALL_MSG_READ,data:a}).then((function(n){return n=n.data,n=e._handleAllMsgRead(n),i.setMessage("scope:".concat(t.scope," failureGroups:").concat(JSON.stringify(n))).end(),Sn()})).catch((function(e){return i.setError(e).end(),Re.w("".concat(o," failed. error:"),e),Mn({code:e&&e.code?e.code:zn.MSG_UNREAD_ALL_FAIL,message:e&&e.message?e.message:void 0})}))}},{key:"setConvCustomData",value:function(e){return this._convGroupHandler.setConvCustomData(e)}},{key:"markConv",value:function(e){return this._convGroupHandler.markConv(e)}},{key:"getConvGroupList",value:function(){return this._convGroupHandler.getLocalConvGroupList()}},{key:"createConvGroup",value:function(e){return this._convGroupHandler.createConvGroup(e)}},{key:"deleteConvGroup",value:function(e){return this._convGroupHandler.deleteConvGroup(e)}},{key:"renameConvGroup",value:function(e){return this._convGroupHandler.renameConvGroup(e)}},{key:"addConvsToGroup",value:function(e){return this._convGroupHandler.addConvsToGroup(e)}},{key:"deleteConvsFromGroup",value:function(e){return this._convGroupHandler.deleteConvsFromGroup(e)}},{key:"onConvMarkUpdated",value:function(e){this._convGroupHandler.onConvMarkUpdated(e)}},{key:"onConvGroupCreated",value:function(e){this._convGroupHandler.onConvGroupCreated(e)}},{key:"onConvGroupDeleted",value:function(e){this._convGroupHandler.onConvGroupDeleted(e)}},{key:"onConvGroupNameUpdated",value:function(e){this._convGroupHandler.onConvGroupNameUpdated(e)}},{key:"onConvInGroupUpdated",value:function(e){this._convGroupHandler.onConvInGroupUpdated(e)}},{key:"onConvAddedToOrDeletedFromGroup",value:function(e){this._convGroupHandler.onConvAddedToOrDeletedFromGroup(e)}},{key:"_getConvLastMessageSeq",value:function(e){var t=this._msgListHandler.getLocalLastMsg(e.conversationID);return e=e.lastMessage.lastSequence,t&&e<t.sequence?t.sequence:e}},{key:"_getConvLastMessageTime",value:function(e){var t=this._msgListHandler.getLocalLastMsg(e.conversationID);return e=e.lastMessage.lastTime,t&&e<t.time?t.time:e}},{key:"_createSetAllMessageReadPack",value:function(e){var t,n={readAllC2CMessage:0,groupMessageReadInfoList:[]},o=e.scope,a=E(this._convMap);try{for(a.s();!(t=a.n()).done;){var i,r=m(t.value,2)[1];if(0<r.unreadCount)if(r.type===S.CONV_C2C&&0===n.readAllC2CMessage){if(o===S.READ_ALL_MSG)n.readAllC2CMessage=1;else if(o===S.READ_ALL_C2C_MSG){n.readAllC2CMessage=1;break}}else r.type!==S.CONV_GROUP||o!==S.READ_ALL_GROUP_MSG&&o!==S.READ_ALL_MSG||(i=this._getConvLastMessageSeq(r),n.groupMessageReadInfoList.push({groupID:r.groupProfile.groupID,messageSequence:i}))}}catch(s){a.e(s)}finally{a.f()}return n}},{key:"onPushedAllMessageRead",value:function(e){this._handleAllMsgRead(e)}},{key:"_handleAllMsgRead",value:function(e){var t=e.groupMessageReadInfoList;return e=e.readAllC2CMessage,t=this._parseGroupReadInfo(t),1<=this._updateAllConvUnreadCount({readAllC2CMessage:e})&&this.emitConvUpdate(!0,!1),t}},{key:"_parseGroupReadInfo",value:function(e){var t=[];if(e&&e.length)for(var n=0,o=e.length;n<o;n++){var a=(s=e[n]).groupID,i=s.sequence,r=s.retCode,s=s.lastMessageSeq;pt(r)?this._remoteGroupReadSeqMap.set(a,s):(this._remoteGroupReadSeqMap.set(a,i),0!==r&&t.push("".concat(a,"-").concat(i,"-").concat(r)))}return t}},{key:"_updateAllConvUnreadCount",value:function(e){var t,n=e.readAllC2CMessage,o=0,a=E(this._convMap);try{for(a.s();!(t=a.n()).done;){var i,r,s,l,c=m(t.value,2),u=c[0],d=c[1];1<=d.unreadCount&&(1===n&&d.type===S.CONV_C2C?(i=this._getConvLastMessageTime(d),this.updateIsReadAfterReadReport({conversationID:u,lastMessageTime:i})):d.type===S.CONV_GROUP&&(r=u.replace(S.CONV_GROUP,""),this._remoteGroupReadSeqMap.has(r)&&(s=this._remoteGroupReadSeqMap.get(r),l=this._getConvLastMessageSeq(d),this.updateIsReadAfterReadReport({conversationID:u,remoteReadSequence:s}),s<=l&&this._remoteGroupReadSeqMap.delete(r))),this.updateUnreadCount(u,!1)&&(o+=1))}}catch(p){a.e(p)}finally{a.f()}return o}},{key:"isRemoteRead",value:function(e){var t,n=e.conversationID,o=(e=e.sequence,n.replace(S.CONV_GROUP,"")),a=!1;return this._remoteGroupReadSeqMap.has(o)&&(e<=(t=this._remoteGroupReadSeqMap.get(o))&&(a=!0,Re.l("".concat(this._n,".isRemoteRead convID:").concat(n," msgSeq:").concat(e," remoteReadSeq:").concat(t))),t+10<=e&&this._remoteGroupReadSeqMap.delete(o)),a}},{key:"updateIsReadAfterReadReport",value:function(e){var t=e.conversationID,n=e.lastMessageSeq,o=e.lastMessageTime,a=this._msgListHandler.getLocalMsgList(t);if(0!==a.length)for(var i,r=a.length-1;0<=r;r--)if(i=a[r],!(o&&i.time>o||n&&i.sequence>n)){if("in"===i.flow&&i.isRead)break;i.setIsRead(!0)}}},{key:"updateUnreadCount",value:function(e){var t,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],o=!1,a=this.getLocalConversation(e),i=this._msgListHandler.getLocalMsgList(e);if(a)return(t=a.unreadCount)!==(i=i.filter((function(e){return!e.isRead&&!e._onlineOnlyFlag&&!e.isDeleted})).length)&&(a.unreadCount=i,o=!0,Re.l("".concat(this._n,".updateUnreadCount from ").concat(t," to ").concat(i,", convID:").concat(e)),!0===n&&this.emitConvUpdate(!0,!1)),o&&a.type===S.CONV_TOPIC&&(t=a.unreadCount,i=this.get(10),n=e.replace(S.CONV_GROUP,""),i.onUnreadCountUpdatedFromConv(n,t)),o}},{key:"clearGroupAtInfoList",value:function(e){var t,n=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],o=this.getLocalConversation(e);o&&0<o.groupAtInfoList.length&&(o.clearGroupAtInfoList(),Re.l("".concat(this._n,".clearGroupAtInfoList convID:").concat(e)),o.type===S.CONV_TOPIC&&(o=o.groupAtInfoList,t=this.get(10),e=e.replace(S.CONV_GROUP,""),t.onAtInfoUpdated({topicID:e,groupAtInfoList:o})),!0===n&&this.emitConvUpdate(!0,!1))}},{key:"updateReadReceiptInfo",value:function(e){var t,n,o,a=this,i=void 0===(s=e.userID)?void 0:s,r=void 0===(s=e.groupID)?void 0:s,s=e.readReceiptList,l=void 0===(e=e.timestamp)?0:e;He(s)||(t=[],pt(i)?pt(r)||(n="".concat(S.CONV_GROUP).concat(r),s.forEach((function(e){var o=e.tinyID,i=e.clientTime,s=e.random,l=e.readCount;e=e.unreadCount,o="".concat(o,"-").concat(i,"-").concat(s),i=a._msgListHandler.getLocalMsg(n,o)||a._msgListHandler.getHoppingMsg(n,o),s={groupID:r,messageID:o,readCount:0,unreadCount:0},i&&(Ye(l)&&(i.readReceiptInfo.readCount=l,s.readCount=l),Ye(e)&&(i.readReceiptInfo.unreadCount=e,s.unreadCount=e),t.push(s))}))):(o="".concat(S.CONV_C2C).concat(i),s.forEach((function(e){var n=e.tinyID,r=e.clientTime;e=e.random,n="".concat(n,"-").concat(r,"-").concat(e),(r=a._msgListHandler.getLocalMsg(o,n)||a._msgListHandler.getHoppingMsg(o,n))&&!r.readReceiptInfo.isPeerRead&&(r.readReceiptInfo.isPeerRead=!0,r.readReceiptInfo.timestamp=l,t.push({userID:i,messageID:n,isPeerRead:!0,timestamp:l}))}))),0<t.length&&this.emitOEvt(T.MESSAGE_READ_RECEIPT_RECEIVED,t))}},{key:"updateIsRead",value:function(e){var t=this.getLocalConversation(e),n=this.getLocalMessageList(e);if(t&&0!==n.length&&!bt(t.type)){for(var o=[],a=0,i=n.length;a<i;a++)"in"!==n[a].flow?"out"!==n[a].flow||n[a].isRead||n[a].setIsRead(!0):o.push(n[a]);var r=0;r=t.type===S.CONV_C2C?(e=o.slice(-t.unreadCount).filter((function(e){return e.isRevoked})).length,o.length-t.unreadCount-e):o.length-t.unreadCount;for(var s=0;s<r&&!o[s].isRead;s++)o[s].setIsRead(!0)}}},{key:"deleteGroupAtTips",value:function(e){var t=this,n="".concat(this._n,".deleteGroupAtTips");if(Re.l("".concat(n)),!(a=this._convMap.get(e)))return Promise.resolve();var o=a.groupAtInfoList;if(0===o.length)return Promise.resolve();var a=void 0,i=(e.startsWith(S.CONV_GROUP)&&(a=e.replace(S.CONV_GROUP,"")),v(o));if((Tt({groupID:a})||St(a))&&0===(i=o.filter((function(e){return!e.atTypeArray.includes(S.CONV_AT_ALL)}))).length)return this.clearGroupAtInfoList(e,!1),Promise.resolve();var r=this.getMyUserID();return this.req({P:jn.DEL_GROUP_AT_TIPS,data:{messageListToDelete:i.map((function(e){return{from:e.from,to:r,messageSeq:e.__sequence,messageRandom:e.__random,groupID:pt(e.topicID)?e.groupID:e.topicID}}))}}).then((function(){return Re.l("".concat(n," ok. count:").concat(o.length)),t.clearGroupAtInfoList(e,!1),Promise.resolve()})).catch((function(e){return Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"appendToMessageList",value:function(e){return this._msgListHandler.pushIn(e)}},{key:"setMessageRandom",value:function(e){this._sll.set(e.random)}},{key:"deleteMessageRandom",value:function(e){this._sll.delete(e.random)}},{key:"pushIntoMessageList",value:function(e,t,n){return!(!this._msgListHandler.pushIn(t,n)||this._sll.has(t.random)&&!n||(e.push(t),0))}},{key:"revoke",value:function(e,t,n){return this._msgListHandler.revoke(e,t,n)}},{key:"getPeerReadTime",value:function(e){return this._peerReadTimeMap.get(e)}},{key:"recordPeerReadTime",value:function(e,t){(!this._peerReadTimeMap.has(e)||this._peerReadTimeMap.get(e)<t)&&this._peerReadTimeMap.set(e,t)}},{key:"updateMsgIsPeerReadProp",value:function(e,t){var n;e.startsWith(S.CONV_C2C)&&0<t&&(0<(n=this._msgListHandler.updateMsgIsPeerReadProp(e,t)).length&&this.emitOEvt(T.MESSAGE_READ_BY_PEER,n),this._convMap.has(e)&&(He(n=this._convMap.get(e).lastMessage)||n.fromAccount===this.getMyUserID()&&n.lastTime<=t&&!n.isPeerRead&&(n.isPeerRead=!0,this.emitConvUpdate(!0,!1))))}},{key:"updateMsgIsModifiedProp",value:function(e){this._msgListHandler.updateMsgIsModifiedProp(e)}},{key:"setCompleted",value:function(e){Re.l("".concat(this._n,".setCompleted convID:").concat(e)),this._completedMap.set(e,!0)}},{key:"updateRoamingMsgKeyAndTime",value:function(e,t,n){this._roamingMsgKeyAndTimeMap.set(e,{messageKey:t,lastMessageTime:n})}},{key:"getConvList",value:function(e){var t,n=this,o="".concat(this._n,".").concat("getConvList"),a="pagingStatus:".concat(this._pagingStatus,", local conversation count:").concat(this._convMap.size,", options:").concat(JSON.stringify(e));return Re.l("".concat(o,". ").concat(a)),this._pagingStatus===On?((t=new io("getConvList")).setMessage(a),this.syncConvList().then((function(){return t.end(),Tn({conversationList:n._getConvList(e),isSyncCompleted:n._isSyncCompleted()})})).catch((function(e){return t.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))):(a=this._getConvList(e),Re.l("".concat(o,". returned conversation count:").concat(a.length)),Sn({conversationList:a,isSyncCompleted:this._isSyncCompleted()}))}},{key:"_getConvList",value:function(e){var t,n,o,a,i,r=this;return pt(e)?this.getLocalConvList():Ze(e)?0===e.length?[]:this.getLocalConvList().filter((function(t){return e.includes(t.conversationID)})):We(e)?(t=e.type,n=e.markType,o=e.groupName,a=e.hasUnreadCount,i=e.hasGroupAtInfo,this.getLocalConvList().filter((function(e){return r._filterType(e,t)&&r._filterMarkType(e,n)&&r._filterGroupName(e,o)&&r._filterUnreadCount(e,a)&&r._filterGroupAtInfo(e,i)}))):[]}},{key:"_filterType",value:function(e,t){return t!==S.CONV_C2C&&t!==S.CONV_GROUP||e.type===t}},{key:"_filterGroupName",value:function(e,t){return!dt(t)||(""===t?0===e.conversationGroupList.length:e.conversationGroupList.includes(t))}},{key:"_filterMarkType",value:function(e,t){return!Ye(t)||(0===t?0===e.markList.length:e.markList.includes(t))}},{key:"_filterUnreadCount",value:function(e,t){var n=!0;return!0===t?n=1<=e.unreadCount:!1===t&&(n=0===e.unreadCount),n}},{key:"_filterGroupAtInfo",value:function(e,t){var n=!0;return!0===t?n=1<=e.groupAtInfoList.length:!1===t&&(n=0===e.groupAtInfoList.length),n}},{key:"_handleC2CPeerReadTime",value:function(){var e,t=E(this._convMap);try{for(t.s();!(e=t.n()).done;){var n=m(e.value,2),o=n[0],a=n[1];a.type===S.CONV_C2C&&this.recordPeerReadTime(o,a.peerReadTime)}}catch(i){t.e(i)}finally{t.f()}}},{key:"_isPagingGetGroupListCompleted",value:function(){var e=this.get(7);return!e||e.isPagingGetCompleted()}},{key:"_getLocalGroupCount",value:function(){var e=this.get(7);return e?e.getLocalGroupList().length:0}},{key:"_hasLocalGroup",value:function(e){var t=this.get(7);return!!t&&t.hasLocalGroup(e.replace(S.CONV_GROUP,""))}},{key:"getConversationProfile",value:function(e){var t,n=this,o=!1;if(this._convMap.has(e)?t=this._convMap.get(e):(t=new pa({conversationID:e,type:Mt(e)?S.CONV_C2C:S.CONV_GROUP},this.isIntl(),this.isUsingChatCore()),o=!0),t._isInfoCompleted||t.type===S.CONV_SYSTEM)return Sn({conversation:t});if(wt(e)){if(!this.get(7))return Mn({code:zn.NO_MODULE});if(!this._hasLocalGroup(e))return Sn({conversation:t})}var a="".concat(this._n,".").concat("getConversationProfile"),i=new io("getConversationProfile");return Re.l("".concat(a,". convID:").concat(e," remark:").concat(t.remark," lastMessage:"),t.lastMessage),this._getUserOrGroupProfile(t).then((function(r){i.setMessage("convID:".concat(e," unreadCount:").concat(r.data.conversation.unreadCount)).end();var s,l=n.get(8);if(l&&t.type===S.CONV_C2C&&(s=e.replace(S.CONV_C2C,""),l.isMyFriend(s)&&(l=l.getFriendRemark(s),t.remark!==l&&(t.remark=l,Re.l("".concat(a,". convID:").concat(e," patch remark:").concat(t.remark))))),Re.l("".concat(a," ok. isNewConv:").concat(o," convID:").concat(e)),o){if(t.type===S.CONV_C2C)return n._onNewC2CConv([e.replace(S.CONV_C2C,"")]).then((function(){return Sn({conversation:t})}));if(t.type===S.CONV_GROUP)return n._onNewGroupConv([e.replace(S.CONV_GROUP,"")]).then((function(){return Sn({conversation:t})}))}return r})).catch((function(t){return i.setError(t).setMessage("convID:".concat(e)).end(),Re.e("".concat(a," failed. error:"),t),Mn(t)}))}},{key:"_getUserOrGroupProfile",value:function(e){var t=this;return e.type===S.CONV_C2C?this.get(4).getUserProfile({userIDList:[e.toAccount]}).then((function(n){return 0===(n=n.data).length?Mn({code:zn.USER_OR_GRP_NOT_FOUND}):(e.userProfile=n[0],e._isInfoCompleted=!0,t._insertConvAfterTopmost(e),Sn({conversation:e}))})):this.get(7).getGroupProfile({groupID:e.toAccount}).then((function(n){return e.groupProfile=n.data.group,e._isInfoCompleted=!0,t._insertConvAfterTopmost(e),Sn({conversation:e})}))}},{key:"_insertConvAfterTopmost",value:function(e){var t,n;e instanceof pa&&!this._convMap.has(e.conversationID)&&(n=(t=v(this._convMap)).findIndex((function(e){return!1===e[1].isPinned})),t.splice(n,0,[e.conversationID,e]),this._convMap=new Map(t),this._setStorageConvList(),this.emitConvUpdate(!0,!1))}},{key:"_onProfileUpdated",value:function(e){var t=this;e.data.forEach((function(e){var n=e.userID;n===t.getMyUserID()?t._onMyProfileModified({latestNick:e.nick,latestAvatar:e.avatar}):(n=t._convMap.get("".concat(S.CONV_C2C).concat(n)))&&(n.userProfile=e)}))}},{key:"_onCloudConfig",value:function(e){"0"===this.getCloudConfig("pull_on_invite")&&(this._bPullOnInvite=!1),Re.l("".concat(this._n,"._onCloudConfig bPullOnInvite:").concat(this._bPullOnInvite))}},{key:"disableMsgPullOnInvite",value:function(){this._bPullOnInvite=!1}},{key:"_isSyncCompleted",value:function(){return this._pagingStatus===An}},{key:"_errorLog",value:function(e,t,n,o){var a=new Error("Params validate failed."),i="".concat(this.getErrMsg("API_REFER")).concat(e);throw Re.w("[".concat(e,"] | ").concat(t," | ").concat(this.getErrMsg(n,o),", ").concat(i)),Re.e("[".concat(e,"] Invalid ").concat(t,": type check failed for ").concat(t,".")),a}},{key:"_isValidConvID",value:function(e){return Mt(e)||wt(e)||bt(e)}},{key:"deleteConversation",value:function(e){var t=this,n="deleteConversation";return dt(e)||$e(e)||this._errorLog(n,"options","StringOrObjectRequiredLog"),dt(e)?(this._isValidConvID(e)||this._errorLog(n,"options","InvalidConversationID",e),Re.l("".concat(this._n,".").concat(n," convID:").concat(e)),this.deleteConvList({conversationIDList:[e],flag:1})):(Ze(e.conversationIDList)||this._errorLog(n,"conversationIDList","ArrayRequiredLog"),0===e.conversationIDList.length&&this._errorLog(n,"conversationIDList","NonEmptyArrayLog"),e.conversationIDList.forEach((function(e){t._isValidConvID(e)||t._errorLog(n,"conversationIDList","InvalidConversationID",e)})),"clearHistoryMessage"in e&&"boolean"!=typeof e.clearHistoryMessage&&this._errorLog(n,"clearHistoryMessage","BooleanRequiredLog"),100<e.conversationIDList.length&&(e.conversationIDList=e.conversationIDList.slice(0,100)),this.deleteConvList(e))}},{key:"deleteConvList",value:function(e){var t=void 0===(t=e.conversationIDList)?[]:t,n=void 0===(n=e.clearHistoryMessage)||n,o=void 0===(e=e.flag)?0:e,a="".concat(this._n,".").concat("deleteConvList"),i=(e="convIDList:".concat(t," clearHistoryMessage:").concat(n),Re.l("".concat(a," ").concat(e)),new io("deleteConvList"));return i.setMessage(e),Promise.all([this.rmLocalOnlyConvList(t),this.rmLocalAndRemoteConvList(t,n)]).then((function(e){return i.end(),0===(e=[].concat(v(e[0]),v(e[1]))).length?Mn(new Fn({code:zn.CONV_NOT_FOUND})):(Re.l("".concat(a," ok")),Sn(1===o?{conversationID:e[0]}:{conversationIDList:e}))})).catch((function(e){return i.setError(e).end(),Re.e("".concat(a," failed. error:"),e),Mn(e)}))}},{key:"rmLocalOnlyConvList",value:function(e){var t=this;return e.filter((function(e){if(!t._convMap.has(e))return!1;var n=t.getLocalConversation(e).type;return n!==S.CONV_GROUP||t._hasLocalGroup(e)?n===S.CONV_SYSTEM&&(t.get(7).deleteGroupSystemNotice({messageList:t._msgListHandler.getLocalMsgList(e)}),t.deleteLocalConv(e),!0):(t.deleteLocalConv(e),!0)}))}},{key:"rmLocalAndRemoteConvList",value:function(e,t){var n=this,o={fromAccount:this.getMyUserID(),conversationList:[],clearHistoryMessage:t?1:0};return e.forEach((function(e){var t;n._convMap.has(e)&&((t=n.getLocalConversation(e).type)===S.CONV_C2C?o.conversationList.push({toAccount:e.replace(t,""),type:1}):t===S.CONV_GROUP&&n._hasLocalGroup(e)&&o.conversationList.push({toGroupID:e.replace(t,""),type:2}))})),0===o.conversationList.length?[]:this.req({P:jn.DEL_CONV,data:o}).then((function(e){var t=[];return 0<e.data.resultList.length&&e.data.resultList.map((function(e){0===e.code&&(e=1===e.type?"".concat(S.CONV_C2C).concat(e.to):"".concat(S.CONV_GROUP).concat(e.groupID),t.push(e))})),n.deleteLocalConvList(t),t}))}},{key:"setConvDraft",value:function(e){var t=e.conversationID,n=(e=e.draftText,"".concat(this._n,".").concat("setConvDraft"));return Re.l("".concat(n," convID:").concat(t," draftText:").concat(e)),this._convMap.has(t)?((n=this._convMap.get(t)).setDraftText(e),this.emitConvUpdate(),Sn({code:0,conversation:n})):Mn({code:zn.CONV_NOT_FOUND})}},{key:"clearHistoryMessage",value:function(e){var t=this,n={fromAccount:this.getMyUserID(),toAccount:void 0,type:void 0,toGroupID:void 0};if(!this._convMap.has(e))return Mn({code:zn.CONV_NOT_FOUND});var o=this._convMap.get(e).type;if(o===S.CONV_C2C)n.type=1,n.toAccount=e.replace(S.CONV_C2C,"");else{if(o!==S.CONV_GROUP)return o===S.CONV_SYSTEM?(this.get(7).deleteGroupSystemNotice({messageList:this._msgListHandler.getLocalMsgList(e)}),Sn({conversationID:e})):Mn({code:zn.CONV_UN_RECORDED_TYPE});n.type=2,n.toGroupID=e.replace(S.CONV_GROUP,"")}var a="".concat(this._n,".").concat("clearHistoryMessage"),i=new io("clearHistoryMessage");return i.setMessage("convID:".concat(e)),Re.l("".concat(a,". convID:").concat(e)),this.setMessageRead({conversationID:e}).then((function(){return t.req({P:jn.CLEAR_HISTORY_MSG,data:n})})).then((function(){i.end(),Re.l("".concat(a," ok")),t.clearMemMsg(e);var n=t.getLocalConversation(e);return n&&(n.updateLastMessage(),t._sortConvListAndEmitEvent()),Sn({conversationID:e})})).catch((function(e){return i.setError(e).end(),Re.e("".concat(a," failed. error:"),e),Mn(e)}))}},{key:"pinConversation",value:function(e){var t=this,n=e.conversationID,o=e.isPinned,a=this.getLocalConversation(n);if(a&&a.isPinned===o)return Sn({conversationID:n});if(bt(n))return a&&(a.isPinned=o),this._sortConvListAndEmitEvent(),Sn({conversationID:n});if(e=null,Mt(n)?e={type:1,toAccount:n.replace(S.CONV_C2C,"")}:wt(n)&&(e={type:2,groupID:n.replace(S.CONV_GROUP,"")}),null===e)return Mn({code:zn.INVALID_CONV_ID});var i="".concat(this._n,".").concat("pinConversation"),r="convID:".concat(n," isPinned:").concat(o),s=new io("pinConversation");return s.setMessage(r),Re.l("".concat(i,". ").concat(r)),this.req({P:jn.PIN_CONV,data:{fromAccount:this.getMyUserID(),operationType:!0===o?1:2,itemList:[e]}}).then((function(){return s.end(),Re.l("".concat(i," ok")),a?a.isPinned!==o&&(a.isPinned=o):t._convMap.set(n,new pa({conversationID:n,type:Mt(n)?S.CONV_C2C:S.CONV_GROUP,isPinned:o},t.isIntl(),t.isUsingChatCore())),t._sortConvListAndEmitEvent(),Tn({conversationID:n})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(i," failed. error:"),e),Mn(e)}))}},{key:"setMessageRemindType",value:function(e){return this._msgRemindHandler.set(e)}},{key:"patchMsgRemindType",value:function(e){var t=e.ID,n=e.isC2CConversation,o=e.messageRemindType,a=!1;return(n=this.getLocalConversation("".concat(n?S.CONV_C2C:S.CONV_GROUP).concat(t)))&&n.messageRemindType!==o&&(n.messageRemindType=o,a=!0),Re.l("".concat(this._n,".patchMsgRemindType options:"),e,"ret:".concat(a)),a}},{key:"onC2CMsgRemindTypeFetched",value:function(e){var t,n=this;Ze(e)&&0<e.length&&(t=0,e.forEach((function(e){var o=e.userID;e=e.muteFlag,e=n._transMsgRemindType(e),!0===n.patchMsgRemindType({ID:o,isC2CConversation:!0,messageRemindType:e})&&(t+=1)})),Re.l("".concat(this._n,".onC2CMsgRemindTypeFetched updateCount:").concat(t)),1<=t&&this.emitConvUpdate(!0,!1))}},{key:"onC2CMsgRemindTypeSynced",value:function(e){var t=this,n="".concat(this._n,".onC2CMsgRemindTypeSynced");e.dataList.forEach((function(e){var o;He(e.muteNotificationsSync)||(o=(e=e.muteNotificationsSync).to,e=e.muteFlag,e=t._transMsgRemindType(e),t.patchMsgRemindType({ID:o,isC2CConversation:!(o=0),messageRemindType:e})&&(o+=1),Re.l("".concat(n," updateCount:").concat(o)),1<=o&&t.emitConvUpdate(!0,!1))}))}},{key:"onGroupMsgRemindTypeUpdated",value:function(e){this._msgRemindHandler.onGroupMsgRemindTypeUpdated(e)}},{key:"deleteLocalConv",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this._convMap.has(e);Re.l("".concat(this._n,".deleteLocalConv convID:").concat(e," has:").concat(n)),n&&(this._convMap.delete(e),this._convMapForDiff.delete(e),this.clearMemMsg(e),this._setStorageConvList(!0),t)&&(n=!this._isTopicConv(e),this.emitConvUpdate(n,!1))}},{key:"pullMsgOnInvite",value:function(e){var t,n,o,a,i,r=this.get(7);r&&(t="".concat(this._n,".pullMsgOnInvite"),Re.l("".concat(t," flag:").concat(this._bPullOnInvite)),this._bPullOnInvite&&(i=this.getLocalLastMessage(e),n=this.getLocalSecondLastMessage(e),a=o=1,i&&(o=i.sequence),n&&(a=n.sequence),i=r.getGroupRemoteLastSeq(e.replace(S.CONV_GROUP,"")),Re.l("".concat(t," convID:").concat(e," localLastSeq:").concat(o," localSecondLastSeq:").concat(a," remoteLastSeq:").concat(i)),this.clearMemMsg(e),1<o-a?this._recursiveGetMsgList([],e,!1,o,a):1<i-o&&this._recursiveGetMsgList([],e,!0,i,o)))}},{key:"_recursiveGetMsgList",value:function(e,t,n,o,a,i){var r=this;this.getMessageList({conversationID:t,nextReqMessageID:i}).then((function(i){var s=(i=i.data).messageList,l=i.isCompleted,c=(i=i.nextReqMessageID,s.filter((function(e){return n?e.sequence>a&&e.sequence<=o:e.sequence>a&&e.sequence<o})));e.unshift.apply(e,v(c)),!l&&0<s.length&&s[0].sequence>a&&e.length<60?r._recursiveGetMsgList(e,t,n,o,a,i):r._emitMsgReceived(t,e)}))}},{key:"_emitMsgReceived",value:function(e,t){var n,o,a=this;0<t.length&&(t=t.filter((function(e,t,n){return t===n.findIndex((function(t){return t.sequence===e.sequence}))})),n=this.hasLocalConversation(e),o=t.map((function(e){return e.sequence})),Re.l("".concat(this._n,"._emitMsgReceived convID:").concat(e," has:").concat(n," count:").concat(o.length," sequenceList:"),o),this.emitOEvt(T.MESSAGE_RECEIVED,t),n?this.patchConvLastMessage(e,!0):this.getConversationProfile(e).then((function(){a.patchConvLastMessage(e,!0)})))}},{key:"deleteLocalConvList",value:function(e){var t=this,n=!1;e.forEach((function(e){t._convMap.has(e)&&(t.deleteLocalConv(e,!1),n=!0)})),Re.l("".concat(this._n,".deleteLocalConvList convID:").concat(e," isConvIDExisted:").concat(n)),n&&this.emitConvUpdate(!0,!1)}},{key:"isMessageSentByCurrentInstance",value:function(e){return!(!this._msgListHandler.hasLocalMsg(e.conversationID,e.ID)&&!this._sll.has(e.random))}},{key:"modifyMessageList",value:function(e){var t,n;e.startsWith(S.CONV_C2C)&&this._convMap.has(e)&&(n=this._convMap.get(e),t=Date.now(),this._msgListHandler.modifyMsgSentByPeer({conversationID:e,latestNick:n.userProfile.nick,latestAvatar:n.userProfile.avatar}),n=this.get(4).getNickAndAvatarByUserID(this.getMyUserID()),this._msgListHandler.modifyMsgSentByMe({conversationID:e,latestNick:n.nick,latestAvatar:n.avatar}),Re.l("".concat(this._n,".modifyMessageList convID:").concat(e," cost:").concat($t(t))))}},{key:"updateUserProfileSpecifiedKey",value:function(e){Re.l("".concat(this._n,".updateUserProfileSpecifiedKey options:"),e);var t=e.conversationID,n=e.nick;e=e.avatar,this._convMap.has(t)&&(t=this._convMap.get(t).userProfile,dt(n)&&t.nick!==n&&(t.nick=n),dt(e)&&t.avatar!==e&&(t.avatar=e),this.emitConvUpdate(!0,!1))}},{key:"_onMyProfileModified",value:function(e){var n=this,o=this.getLocalConvList(),a=Date.now();o.forEach((function(o){n.modifyMessageSentByMe(t({conversationID:o.conversationID},e))})),Re.l("".concat(this._n,"._onMyProfileModified. modify all messages sent by me, cost:").concat($t(a)))}},{key:"modifyMessageSentByMe",value:function(e){this._msgListHandler.modifyMsgSentByMe(e)}},{key:"getLatestMessageSentByMe",value:function(e){return this._msgListHandler.getLatestMsgSentByMe(e)}},{key:"modifyMessageSentByPeer",value:function(e){this._msgListHandler.modifyMsgSentByPeer(e)}},{key:"getLatestMessageSentByPeer",value:function(e){return this._msgListHandler.getLatestMsgSentByPeer(e)}},{key:"pushIntoNoticeResult",value:function(e,t){return!(!this._msgListHandler.pushIn(t)||this._sll.has(t.random)||(e.push(t),0))}},{key:"getLocalLastMessage",value:function(e){return this._msgListHandler.getLocalLastMsg(e)}},{key:"getLocalSecondLastMessage",value:function(e){return this._msgListHandler.getLocalSecondLastMsg(e)}},{key:"checkAndPatchRemark",value:function(){var e,t,n=this.get(8);0===this._convMap.size||!n||0!==(e=v(this._convMap.values()).filter((function(e){return e.type===S.CONV_C2C}))).length&&(t=0,e.forEach((function(e){var o=e.conversationID.replace(S.CONV_C2C,"");n.isMyFriend(o)&&(o=n.getFriendRemark(o),e.remark!==o&&(e.remark=o,t+=1))})),Re.l("".concat(this._n,".checkAndPatchRemark. c2cConvCount:").concat(e.length," patchedCount:").concat(t)),0<t&&this.emitConvUpdate(!0,!1))}},{key:"updateTopicConversation",value:function(e){this._updateLocalConvList({conversationOptionsList:e,isFromGetConversations:!0,updateUnreadCount:!0})}},{key:"sendReadReceipt",value:function(e){var t=e[0],n=null;return t.conversationType===S.CONV_C2C?n=this._m.get(6):t.conversationType===S.CONV_GROUP&&(n=this._m.get(7)),n?n.sendReadReceipt(e):Mn({code:zn.NO_MODULE})}},{key:"getReadReceiptList",value:function(e){var t=e[0],n=null;return t.conversationType===S.CONV_C2C?n=this._m.get(6):t.conversationType===S.CONV_GROUP&&(n=this._m.get(7)),n?n.getReadReceiptList(e):Mn({code:zn.NO_MODULE})}},{key:"getLastMessageTime",value:function(e){return(e=this.getLocalConversation(e))?e.lastMessage.lastTime:0}},{key:"getTotalUnreadCount",value:function(){var e=this.getLocalConvList(),t=0;return e.forEach((function(e){e.type!==S.CONV_SYSTEM&&(""!==e.messageRemindType&&e.messageRemindType!==S.MSG_REMIND_ACPT_AND_NOTE||(t+=e.unreadCount))})),t}},{key:"onTotalUnreadCountUpdate",value:function(){var e=this.getTotalUnreadCount();this._convTotalUnreadCount!==e&&(Re.l("".concat(this._n,".onTotalUnreadCountUpdate from ").concat(this._convTotalUnreadCount," to ").concat(e)),this._convTotalUnreadCount=e,this.emitOEvt(T.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED))}},{key:"_isConvNeedShow",value:function(e){if(e=this.getLocalConversation(e),pt(e))return!0;var t=e.type===S.CONV_TOPIC,n=e.type===S.CONV_GROUP&&e.groupProfile.type===S.GRP_ROOM;return e=e.type===S.CONV_GROUP&&e.groupProfile.type===S.GRP_LIVE,!(t||n||e)}},{key:"setAllRcvMsgOpt",value:function(e){return this._msgRemindHandler.setAllRcvMsgOpt(e)}},{key:"getAllRcvMsgOpt",value:function(){return this._msgRemindHandler.getAllRcvMsgOpt()}},{key:"onAllRcvMsgOptNotify",value:function(e){this._msgRemindHandler.onAllRcvMsgOptNotify(e)}},{key:"clearUnreadCount",value:function(e){(e=this.getLocalConversation(e))&&0<e.unreadCount&&(e.unreadCount=0,this.emitConvUpdate(!0,!1))}},{key:"storeHoppingMessageList",value:function(e){this._msgListHandler.storeHoppingMsgList(e)}},{key:"clearMemMsg",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]&&arguments[1];Re.l("".concat(this._n,".clearMemMsg convID:").concat(e," isOverLimit:").concat(t)),this._msgListHandler.removeByConvID(e),this._completedMap.delete(e),this._roamingMsgKeyAndTimeMap.delete(e),this._everClearedMap.set(e,1)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._setStorageConvList(!0),this._pagingStatus=Rn,this._msgListHandler.reset(),this._msgRemindHandler.reset(),this._roamingMsgKeyAndTimeMap.clear(),this._sll.reset(),this._peerReadTimeMap.clear(),this._completedMap.clear(),this._convMap.clear(),this._pagingTs=0,this._pagingStartIdx=0,this._pagingPinnedTs=0,this._pagingPinnedStartIdx=0,this._remoteGroupReadSeqMap.clear(),this._convTotalUnreadCount=0,this._pagingGetCostList.length=0,this._pagingConvIDMap.clear(),this._convIDFromUnreadDBMap.clear(),this._pagingGetCostList.length=0,this._convMapForDiff.clear(),this._partialUpdatedConvMap.clear(),this._everClearedMap.clear(),this._bPullOnInvite=!0,this._convGroupHandler.reset(),this.resetReady()}}]),ii),va=(i(ai,[{key:"onCheckTimer",value:function(e){e%1==0&&0<this._cachedGroupTipsMap.size&&this._check()}},{key:"_check",value:function(){var e=this;this._cachedGroupTipsMap.forEach((function(t,n){var o=e._checkCountMap.get(n),a=e._grpM.hasLocalGroup(n);Re.l("".concat(e._n,"._check groupID:").concat(n," hasLocalGroup:").concat(a," checkCount:").concat(o)),a?(e._notifyCachedGroupTips(n),e._checkCountMap.delete(n),e._grpM.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupTips(n),e._checkCountMap.delete(n)):e._checkCountMap.set(n,++o)}))}},{key:"onNewGroupTips",value:function(e){Re.l("".concat(this._n,".onNewGroupTips options:").concat(JSON.stringify(e.dataList)));var t=(e=this._assembly(e)).eventDataList,n=e.result;0<(e=e.AVChatRoomMessageList).length&&this._grpM.onAVChatRoomMessage(e),0<n.length&&(this._grpM.emitOEvt(T.MESSAGE_RECEIVED,n),this._handleTips(n)),0<t.length&&(this._grpM.updateNextMessageSeq(t),this._grpM.get(11).onNewMessage({conversationOptionsList:t,isInstantMessage:!0}))}},{key:"_assembly",value:function(e){for(var n=e.event,o=e.dataList,a=null,i=[],r=[],s={},l=[],c=0,u=o.length;c<u;c++){var d=ct(o[c]);if(6===n){if(this._grpM.isGroupAttributesUpdatedNotice(d))continue;if(this._grpM.isGroupCountersNotice(d))continue}var p=(m=d.groupProfile).groupID,h=void 0===(h=m.communityType)?0:h,f=void 0===(f=m.topicID)?void 0:f,g=m.invisible,m=void 0===(m=m.groupType)?void 0:m,v=void 0;if((y=this._grpM.isMessageFromTopic(h,f))&&(v=S.CONV_TOPIC,d.to=f),(_=this._grpM.hasLocalGroup(p))||!this._grpM.isUnjoinedAVChatRoom(p))if(_||y)if(this._grpM.isMessageFromOrToAVChatroom(p))d.event=n,l.push(d);else if(d.currentUser=this._grpM.getMyUserID(),d.conversationType=S.CONV_GROUP,(a=new No(d)).setElement({type:S.MSG_GRP_TIP,content:t(t({},d.elements),{},{groupProfile:d.groupProfile})}),a.isSystemMessage=!1,1!==g){var _=this._grpM.get(11),y=(g=(y=a).conversationID,y.sequence);if(6===n)a._onlineOnlyFlag=!0,r.push(a);else if(!_.pushIntoNoticeResult(r,a))continue;this._grpM.isMessageFromCommunityOfTopic(h,f)||6===n&&_.getLocalConversation(g)||(6!==n&&this._qualityStat(a),h=_.isRemoteRead({conversationID:g,sequence:y}),pt(s[g])?(f=0,"in"===a.flow&&(a._isExcludedFromUnreadCount||a._onlineOnlyFlag||h||(f=1)),s[g]=i.push({conversationID:g,unreadCount:f,type:pt(v)?a.conversationType:v,subType:a.conversationSubType,lastMessage:a._isExcludedFromLastMessage?"":a})-1):(i[_=s[g]].type=a.conversationType,i[_].subType=a.conversationSubType,i[_].lastMessage=a._isExcludedFromLastMessage?"":a,"in"===a.flow&&(a._isExcludedFromUnreadCount||a._onlineOnlyFlag||h||i[_].unreadCount++)))}else this._qualityStat(a);else this._cacheAndCompare({groupID:p,event:n,item:d,groupType:m})}return{eventDataList:i,result:r,AVChatRoomMessageList:l}}},{key:"_qualityStat",value:function(e){this._grpM.get(26).addMessageSequence({key:Xn,message:e})}},{key:"_handleTips",value:function(e){var t=this;e.forEach((function(e){switch(e.payload.operationType){case 1:t._onNewMemberComeIn(e);break;case 2:t._onMemberQuit(e);break;case 3:t._onMemberKickedOut(e);break;case 4:t._onMemberSetAdmin(e);break;case 5:t._onMemberCancelledAdmin(e);break;case 6:t._onGroupProfileModified(e);break;case 7:t._onMemberInfoModified(e);break;case 8:t._onTopicProfileUpdated(e);break;default:Re.w("".concat(t._n,"._handleTips unknown operationType:").concat(e.payload.operationType))}}))}},{key:"_onNewMemberComeIn",value:function(e){var t=(e=e.payload).memberNum;e=e.groupProfile.groupID,(e=this._grpM.getLocalGroupProfile(e))&&Ye(t)&&e.memberCount!==t&&(e.memberCount=t,this._updateConvGroupProfile(e))}},{key:"_onMemberQuit",value:function(e){var t=(n=e.payload).memberNum,n=n.groupProfile.groupID,o=this._grpM.getLocalGroupProfile(n);o&&Ye(t)&&o.memberCount!==t&&(o.memberCount=t,this._updateConvGroupProfile(o)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(n,e.payload.userIDList)}},{key:"_onMemberKickedOut",value:function(e){var t=(n=e.payload).memberNum,n=n.groupProfile.groupID,o=this._grpM.getLocalGroupProfile(n);o&&Ye(t)&&o.memberCount!==t&&(o.memberCount=t,this._updateConvGroupProfile(o)),this._grpM.getGroupMemberHandler().deleteLocalGroupMembers(n,e.payload.userIDList)}},{key:"_updateConvGroupProfile",value:function(e){this._grpM.get(11).updateConvGroupProfile([e])}},{key:"_onMemberSetAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=(e=e.payload.userIDList,this._grpM.getGroupMemberHandler());e.forEach((function(e){(e=n.getLocalGroupMemberInfo(t,e))&&e.updateRole(S.GRP_MBR_ROLE_ADMIN)}))}},{key:"_onMemberCancelledAdmin",value:function(e){var t=e.payload.groupProfile.groupID,n=(e=e.payload.userIDList,this._grpM.getGroupMemberHandler());e.forEach((function(e){(e=n.getLocalGroupMemberInfo(t,e))&&e.updateRole(S.GRP_MBR_ROLE_MEMBER)}))}},{key:"_onGroupProfileModified",value:function(e){var t=this,n=(e=e.payload).newGroupProfile,o=e.groupProfile,a=e.operatorInfo,i=(e=o.groupID,this._grpM.getLocalGroupProfile(e));Object.keys(n).forEach((function(e){switch(e){case"ownerID":t._ownerChanged(i,n);break;case"groupName":i.name=n[e];break;default:i[e]=n[e]}})),pt(a)||Object.keys(a).forEach((function(e){var t;"nameCard"===e?i.updateSelfInfo({nameCard:a[e]}):"role"===e&&(t="",400===a[e]?t=S.GRP_MBR_ROLE_OWNER:300===a[e]?t=S.GRP_MBR_ROLE_ADMIN:200===a[e]&&(t=S.GRP_MBR_ROLE_MEMBER),i.updateSelfInfo({role:t}))})),o=!i.isSupportTopic,this._grpM.emitGroupListUpdate(!0,o)}},{key:"_ownerChanged",value:function(e,t){e=e.groupID;var n=this._grpM.getLocalGroupProfile(e),o=this._grpM.getMyUserID();o===t.ownerID&&(n.updateGroup({selfInfo:{role:S.GRP_MBR_ROLE_OWNER}}),n=(t=this._grpM.getGroupMemberHandler()).getLocalGroupMemberInfo(e,o),o=this._grpM.getLocalGroupProfile(e).ownerID,t=t.getLocalGroupMemberInfo(e,o),n&&n.updateRole(S.GRP_MBR_ROLE_OWNER),t&&t.updateRole(S.GRP_MBR_ROLE_MEMBER))}},{key:"_onMemberInfoModified",value:function(e){var t=e.to,n=(o=e.payload).groupProfile,o=o.memberList,a=n.groupID,i=(St(t)&&this._updateTopicMuteTime(e),this._grpM.getGroupMemberHandler());o.forEach((function(e){var t=i.getLocalGroupMemberInfo(a,e.userID);t&&Ye(e.muteTime)&&t.updateMuteUntil(e.muteTime)}))}},{key:"_updateTopicMuteTime",value:function(e){var t=e.to,n=(e=e.payload).groupProfile,o=void 0===(e=e.memberList)?[]:e,a=(e=this._grpM.get(10),n=n.groupID,e.getLocalTopic(n,t));if(a){for(var i=!1,r=0;r<o.length;r++){var s=o[r];if(s.userID===this._grpM.getMyUserID()&&0<=s.muteTime){a.updateSelfInfo({muteTime:s.muteTime}),i=!0;break}}i&&this._grpM.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:a})}}},{key:"_onTopicProfileUpdated",value:function(e){var n=(o=e.payload).groupProfile.groupID,o=o.newTopicInfo;this._grpM.get(10).onTopicProfileUpdated(t({groupID:n,topicID:e.to},o))}},{key:"_cacheGroupTips",value:function(e,t){this._cachedGroupTipsMap.has(e)||this._cachedGroupTipsMap.set(e,[]),this._cachedGroupTipsMap.get(e).push(t)}},{key:"_deleteCachedGroupTips",value:function(e){this._cachedGroupTipsMap.has(e)&&this._cachedGroupTipsMap.delete(e)}},{key:"_notifyCachedGroupTips",value:function(e,t){var n=this,o=this._cachedGroupTipsMap.get(e)||[];Re.l("".concat(this._n,"._notifyCachedGroupTips groupID:").concat(e," groupType:").concat(t," count:").concat(o.length)),o.forEach((function(e){n.onNewGroupTips(e)})),this._deleteCachedGroupTips(e)}},{key:"_cacheAndCompare",value:function(e){var t=e.groupID,n=e.event,o=e.item;e=e.groupType,Re.l("".concat(this._n,"._cacheAndCompare groupID:").concat(t," groupType:").concat(e)),this._cacheGroupTips(t,{event:n,dataList:[o]}),n={groupID:t,type:e},e===S.GRP_AVCHATROOM?this._grpM.hasLocalGroup(t)?this._notifyCachedGroupTips(t,e):this._grpM.setUnjoinedAVChatRoom(t):(this._grpM.updateGroupMap([n]),this._notifyCachedGroupTips(t,e)),this._checkCountMap.has(t)||this._checkCountMap.set(t,0)}},{key:"reset",value:function(){this._cachedGroupTipsMap.clear(),this._checkCountMap.clear()}}]),ai),_a=(i(oi,[{key:"onCheckTimer",value:function(e){e%1==0&&0<this._cachedGroupMessageMap.size&&this._check()}},{key:"_check",value:function(){var e=this;this._cachedGroupMessageMap.forEach((function(t,n){var o=e._checkCountMap.get(n),a=e._grpM.hasLocalGroup(n);Re.l("".concat(e._n,"._check groupID:").concat(n," hasLocalGroup:").concat(a," checkCount:").concat(o)),a?(e._notifyCachedGroupMessage(n),e._checkCountMap.delete(n),e._grpM.deleteUnjoinedAVChatRoom(n)):o>=e.MAX_CHECK_COUNT?(e._deleteCachedGroupMessage(n),e._checkCountMap.delete(n)):e._checkCountMap.set(n,++o)}))}},{key:"updateLastMsg",value:function(e){var n="".concat(this._n,".updateLastMsg");if(0!==this._grpM.getGroupMap().size){for(var o,a,i,r,s=!1,l=e.length,c=0;c<l;c++)(o=e[c]).type===S.CONV_GROUP&&0!==o.lastMessage.lastSequence&&null!==o.lastMessage.payload&&(a=o.conversationID.split(/^GROUP/)[1],(a=this._grpM.getLocalGroupProfile(a))&&(i=a.lastMessage,r=o.lastMessage,JSON.stringify(i)!==JSON.stringify(r)&&(a.lastMessage=t({},o.lastMessage),s=!0)));Re.l("".concat(n," convCount:").concat(l," groupCount:").concat(this._grpM.getLocalGroupList().length," isUpdated:").concat(s)),s&&(this._grpM.sortLocalGroupList(),this._grpM.emitGroupListUpdate(!0,!1))}else this.tempConversationList=e}},{key:"onNewMessage",value:function(e){var t,n=(t=this._assembly(e)).conversationOptionsList,o=t.messageList;0<(0<(0<(t=t.AVChatRoomMessageList).length&&this._grpM.onAVChatRoomMessage(t),t=It(o)).length&&this._grpM.emitOEvt(T.MESSAGE_MODIFIED,t),0<n.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:n,isInstantMessage:!1!==e.isInstantMessage,updateUnreadCount:!1!==e.updateUnreadCount}),this._grpM.updateNextMessageSeq(n)),t=kt(o)).length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t),o.length=0}},{key:"_assembly",value:function(e){var t=e.dataList,n=e.event,o=e.isInstantMessage,a=null,i=[],r=[],s=[],l={},c=this._grpM.getFileDownloadProxy(),u=this._grpM.getDowloadFileAuthKey(),d=this._grpM.get(17).getFileDNList(),p=t.length;1<p&&t.sort((function(e,t){return e.sequence-t.sequence}));for(var h=this._grpM.get(11),f=this._grpM.get(4),g=0;g<p;g++){var m,v=ct(t[g]),_=(k=v.groupProfile).groupID,y=void 0===(y=k.communityType)?0:y,I=void 0===(I=k.topicID)?void 0:I,C=k.invisible,k=void 0===(k=k.groupType)?void 0:k,E=void 0,T=this._grpM.isMessageFromTopic(y,I),M=(T&&(E=S.CONV_TOPIC,v.to=I),this._grpM.hasLocalGroup(_));!M&&this._grpM.isUnjoinedAVChatRoom(_)||(M||T?this._grpM.isMessageFromOrToAVChatroom(_)?(v.event=n,s.push(v)):(v.currentUser=this._grpM.getMyUserID(),v.conversationType=S.CONV_GROUP,v.isSystemMessage=!!v.isSystemMessage,(a=new No(v)).setElement(v.elements,c,u,d),1!==C?(M=1===t[g].isModified,h.isMessageSentByCurrentInstance(a)?a.isModified=M:M=!1,1===v.onlineOnlyFlag?(a._onlineOnlyFlag=!0,h.isMessageSentByCurrentInstance(a)||r.push(a)):this._grpM.isMessageFromCommunityOfTopic(y,I)?r.push(a):(a.from!==this._grpM.getMyUserID()||(T=h.getLatestMessageSentByMe(a.conversationID))&&(C=T.nick,y=T.avatar,C===a.nick&&y===a.avatar||(h.modifyMessageSentByMe({conversationID:m,latestNick:a.nick,latestAvatar:a.avatar}),f.mockOnNickAvatarModified(a.nick,a.avatar))),h.pushIntoMessageList(r,a,M)&&(this._qualityStat(o,a),m=(I=a).conversationID,T=I.sequence,C=h.isRemoteRead({conversationID:m,sequence:T}),pt(l[m])?(y=0,"in"===a.flow&&(a._isExcludedFromUnreadCount||C||(y=1)),l[m]=i.push({conversationID:m,unreadCount:y,type:pt(E)?a.conversationType:E,subType:a.conversationSubType,lastMessage:a._isExcludedFromLastMessage?"":a})-1):(i[M=l[m]].type=pt(E)?a.conversationType:E,i[M].subType=a.conversationSubType,i[M].lastMessage=a._isExcludedFromLastMessage?"":a,"in"===a.flow&&(a._isExcludedFromUnreadCount||C||i[M].unreadCount++))))):this._qualityStat(o,a)):this._cacheAndCompare({groupID:_,event:n,item:v,groupType:k}))}return{conversationOptionsList:i,messageList:r,AVChatRoomMessageList:s}}},{key:"_qualityStat",value:function(e,t){var n=this._grpM.get(26);n.addMessageSequence({key:Xn,message:t}),e&&0<t.clientTime&&n.addMessageDelay(t.clientTime)}},{key:"onMsgRevoked",value:function(e,t){var n=this,o=this._grpM.get(11),a=[],i=[];e.dataList.forEach((function(e){var t=e.elements.revokedInfos,n=e.revokerInfo,r=e.groupProfile,s=!1;r&&(s=Tt({groupID:r.groupID})||!He(r.topicID)),pt(t)||t.forEach((function(e){var t,l=He(e.topicID)?"GROUP".concat(e.groupID):"GROUP".concat(e.topicID),c=o.getLocalConversation(l),u=e.revokerInfo&&e.revokerInfo.revoker||n&&n.revoker,d=n&&n.reason||"";c&&Et(c.type)?t={conversationID:l,sequence:e.sequence,ID:"".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)}:(c=o.revoke(l,e.sequence,e.random))?t=c:(t={conversationID:l,sequence:e.sequence},e.tinyID&&e.clientTime&&e.random&&(t.ID="".concat(e.tinyID,"-").concat(e.clientTime,"-").concat(e.random)),e.time&&(t.time=e.time)),t&&(t.revoker=u,t.revokeReason=d,t.revokerInfo={userID:u,nick:"",avatar:""},s?(t.revokerInfo.nick=r.nick,t.revokerInfo.avatar=r.avatar,a.push(t)):i.push(t))}))})),0===i.length&&0===a.length||(o.onMessageRevoked([].concat(a,i),t),0<a.length&&this._grpM.emitOEvt(T.MESSAGE_REVOKED,a),0<i.length&&o.updateRevokerInfo(i).then((function(e){n._grpM.emitOEvt(T.MESSAGE_REVOKED,e)})))}},{key:"_groupListTreeShaking",value:function(e){for(var t=new Map(v(this._grpM.getGroupMap())),n=0,o=e.length;n<o;n++)t.delete(e[n].groupID);this._grpM.hasJoinedAVChatRoom()&&this._grpM.getJoinedAVChatRoom().forEach((function(e){t.delete(e)})),this._grpM.getGroupMap().forEach((function(e,n){e.isSupportTopic&&t.delete(n)}));for(var a=v(t.keys()),i=0,r=a.length;i<r;i++)this._grpM.deleteGroup(a[i])}},{key:"syncGroupList",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],n=(this._pagingStatus===Rn&&this._grpM.clearGroupMap(),v(x)),o=this.PAGING_GRP_COUNT_LIMIT,a=[];if(!0===t)return this._pagingGetGroupListWithTopic({limit:o,offset:0,groupBaseInfoFilter:n,groupList:a});t="syncGroupList";var i="".concat(this._n,".").concat(t),r=new io(t);return this._pagingGetGroupList({limit:o,offset:0,groupBaseInfoFilter:n,groupList:a}).then((function(){var t=Yt(e._pagingGetCostList),n=Kt(e._pagingGetCostList),o=(e._pagingGetCostList.length=0,e._pagingStatus=An,e._groupListTreeShaking(a),e._grpM.updateGroupMap(a),e._grpM.getLocalGroupList().length);return o="count:".concat(o," sum:").concat(n," avg:").concat(t),Re.l("".concat(i," ok. ").concat(o)),r.setMessage(o).end(),e.tempConversationList&&(e.updateLastMsg(e.tempConversationList),e.tempConversationList=null),e._grpM.emitGroupListUpdate(!0,!0),Tn({groupList:e._grpM.getLocalGroupList()})})).catch((function(t){return e._pagingStatus=On,r.setError(t).end(),Re.e("".concat(i," failed. error:"),t),Mn(t)}))}},{key:"getGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getGroupList");if(Re.l("".concat(t," pagingStatus:").concat(this._pagingStatus)),this._pagingStatus===On||this._pagingStatus===Rn)return this.syncGroupList().then((function(){return Tn({groupList:e._grpM.getLocalGroupList(),isSyncCompleted:e.isPagingGetCompleted()})})).catch((function(e){return Re.e("".concat(t," failed. error:"),e),Mn(e)}));var n=this._grpM.getLocalGroupList();return Re.l("".concat(t,". returned group count:").concat(n.length)),Sn({groupList:n,isSyncCompleted:this.isPagingGetCompleted()})}},{key:"isPagingGetCompleted",value:function(){return this._pagingStatus===An}},{key:"_pagingGetGroupList",value:function(e){var t=this,n="".concat(this._n,".").concat("_pagingGetGroupList"),o=e.isCommunityRelay,a=void 0!==o&&o,i=e.limit,r=e.offset,s=e.groupBaseInfoFilter,l=e.groupList,c=Date.now();return this._grpM.req({P:jn.GET_GRP_LIST,data:{type:a?S.GRP_COMMUNITY:void 0,memberAccount:this._grpM.getMyUserID(),limit:i,offset:r,responseFilter:{groupBaseInfoFilter:s,selfInfoFilter:["Role","JoinTime","MsgFlag","MsgSeq"]}}}).then((function(e){var o=void 0===(o=(e=e.data).groups)?[]:o,u=(e=e.totalCount,l.push.apply(l,v(o)),t._handleGroupAtInfoWithoutTopic(a,o),!((o=r+i)<e));return e="offset:".concat(r," limit:").concat(i," total:").concat(e," isCompleted:").concat(u," ")+"current:".concat(l.length," isCommunityRelay:").concat(a),t._pagingGetCostList.push($t(c,!1)),Re.l("".concat(n," ok. ").concat(e," cost:").concat($t(c))),a||u?!a&&u?(Re.l("".concat(n," start to get community list")),r=0,t._pagingGetGroupList({limit:i,offset:r,groupBaseInfoFilter:s,groupList:l,isCommunityRelay:!0})):a&&!u?(r=o,t._pagingGetGroupList({limit:i,offset:r,groupBaseInfoFilter:s,groupList:l,isCommunityRelay:!0})):Tn({groupList:l}):(r=o,t._pagingGetGroupList({limit:i,offset:r,groupBaseInfoFilter:s,groupList:l}))})).catch((function(e){return 10018===e.code?(Re.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(i)),i=50,t._pagingGetGroupList({limit:i,offset:r,groupBaseInfoFilter:s,groupList:l,isCommunityRelay:a})):a?(11e3===e.code&&Re.l("".concat(n," ok. community unavailable")),Sn({groupList:l})):Mn(e)}))}},{key:"_pagingGetGroupListWithTopic",value:function(e){var t=this,n="".concat(this._n,"._pagingGetGroupListWithTopic"),o=e.limit,a=e.offset,i=e.groupBaseInfoFilter,r=e.groupList,s=Date.now();return this._grpM.req({P:jn.GET_GRP_LIST,data:{type:S.GRP_COMMUNITY,memberAccount:this._grpM.getMyUserID(),limit:o,offset:a,responseFilter:{groupBaseInfoFilter:i,selfInfoFilter:v(V)},isSupportTopic:1,needAppDefineData:1}}).then((function(e){var l=(e=e.data).groups,c=(e=e.totalCount,r.push.apply(r,v(void 0===l?[]:l)),!((l=a+o)<e));return Re.l("".concat(n," ok. offset:").concat(a," limit:").concat(o," totalCount:").concat(e," isCompleted:").concat(c," currentCount:").concat(r.length," cost:").concat($t(s))),c?(t._grpM.updateGroupMap(r),t._grpM.emitGroupListUpdate(!0,!1),Tn({groupList:e=t._grpM.getLocalGroupList().filter((function(e){return!0===e.isSupportTopic}))})):(a=l,t._pagingGetGroupListWithTopic({limit:o,offset:a,groupBaseInfoFilter:i,groupList:r}))})).catch((function(e){return 10018===e.code?(Re.w("".concat(t.logPrefix," response size exceeds the limit, request count:").concat(o)),o=50,t._pagingGetGroupListWithTopic({limit:o,offset:a,groupBaseInfoFilter:i,groupList:r})):Mn(e)}))}},{key:"_cacheGroupMessage",value:function(e,t){this._cachedGroupMessageMap.has(e)||this._cachedGroupMessageMap.set(e,[]),this._cachedGroupMessageMap.get(e).push(t)}},{key:"_deleteCachedGroupMessage",value:function(e){this._cachedGroupMessageMap.has(e)&&this._cachedGroupMessageMap.delete(e)}},{key:"_notifyCachedGroupMessage",value:function(e,t){var n=this,o=this._cachedGroupMessageMap.get(e)||[];Re.l("".concat(this._n,"._notifyCachedGroupMessage groupID:").concat(e," groupType:").concat(t," count:").concat(o.length)),o.forEach((function(e){n.onNewMessage(e)})),this._deleteCachedGroupMessage(e)}},{key:"_cacheAndCompare",value:function(e){var t=e.groupID,n=e.event,o=e.item;e=e.groupType,Re.l("".concat(this._n,"._cacheAndCompare groupID:").concat(t," groupType:").concat(e)),this._cacheGroupMessage(t,{event:n,dataList:[o]}),n={groupID:t,type:e},e===S.GRP_AVCHATROOM?this._grpM.hasLocalGroup(t)?this._notifyCachedGroupMessage(t,e):this._grpM.setUnjoinedAVChatRoom(t):(this._grpM.updateGroupMap([n]),this._notifyCachedGroupMessage(t,e)),this._checkCountMap.has(t)||this._checkCountMap.set(t,0)}},{key:"_handleGroupAtInfoWithoutTopic",value:function(e,n){var o=this;e&&0!==n.length&&n.forEach((function(e){var n=e.groupID,a=(e=e.groupAtInfoList,[]);pt(e)||(e.forEach((function(e){a.push(t(t({},e),{},{groupID:n}))})),o._grpM.get(11).onNewGroupAtTips({dataList:a}))}))}},{key:"setPagingGroupCount",value:function(e){pt(e)||(this.PAGING_GRP_COUNT_LIMIT=parseInt(e,10))}},{key:"reset",value:function(){this.PAGING_GRP_COUNT_LIMIT=200,this._cachedGroupMessageMap.clear(),this._checkCountMap.clear(),this._pagingStatus=Rn,this._pagingGetCostList=[]}}]),oi),ya=(i(ni,[{key:"_onCloudConfig",value:function(){var e=this._grpM.getCloudConfig("grp_attr_cache_time");pt(e)||(this.CACHE_EXPIRE_TIME=Number(e))}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesMap.forEach((function(e){e.localMainSequence=0}))}},{key:"isGroupAttributesUpdatedNotice",value:function(e){var t=e.to,n=(e=e.elements.newGroupProfile,!pt(e)&&!He(e.groupAttributeOption));return n&&this._onGroupAttributesUpdated({groupID:t,groupAttributeOption:e.groupAttributeOption}),n}},{key:"_onGroupAttributesUpdated",value:function(e){var t=this,n=e.groupID,o=(e=e.groupAttributeOption).mainSequence,a=e.isWithChangedAttributeInfo,i=void 0===(i=e.groupAttributeList)?[]:i;if(e=e.operationType,Re.l("".concat(this._n,".onGroupAttributesUpdated. ")+"groupID:".concat(n," isWithChangedAttributeInfo:").concat(a," operationType:").concat(e)),!pt(e)){this._groupAttributesCopy=this._getCachedAttributes({groupID:n});var r=o-this._getLocalGroupAttributes(n).localMainSequence;if(0!=r){if(1===a&&1==r)return this._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:o,groupAttributeList:i,operationType:e}),void this._emitGroupAttributesUpdated(n);this._hasLocalGroupAttributes(n)&&(a=this._getLocalGroupAttributes(n).avChatRoomKey,this._getGroupAttributes({groupID:n,avChatRoomKey:a}).then((function(){t._emitGroupAttributesUpdated(n)})))}}}},{key:"initGroupAttributesCache",value:function(e){var t=e.groupID;e=void 0===(e=e.avChatRoomKey)?void 0:e,this._groupAttributesMap.set(t,{lastUpdateTime:0,localMainSequence:0,remoteMainSequence:0,attributes:new Map,avChatRoomKey:e}),Re.l("".concat(this._n,".initGroupAttributesCache groupID:").concat(t," avChatRoomKey:").concat(e))}},{key:"initGroupAttributes",value:function(e){var t=this,n=e.groupID,o=e.groupAttributes,a=(e=this._getLocalGroupAttributes(n)).remoteMainSequence,i=(e=e.avChatRoomKey,new io("initGroupAttributes"));return i.setMessage("groupID:".concat(n," avChatRoomKey:").concat(e," mainSequence:").concat(a)),this._grpM.req({P:jn.SET_GRP_ATTR,data:{groupID:n,avChatRoomKey:e,mainSequence:a,groupAttributeList:this._transformGroupAttributes(o)}}).then((function(e){Re.l("".concat(t._n,".").concat("initGroupAttributes"," ok. groupID:").concat(n));var a=(e=e.data).mainSequence;return(e=v(e.groupAttributeList)).forEach((function(e){e.value=o[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:a,groupAttributeList:e,operationType:1}),t._emitGroupAttributesUpdated(n),i.end(),Tn({groupAttributes:o})})).catch((function(e){return i.setError(e).end(),Mn(e)}))}},{key:"setGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("setGroupAttributes"),o=e.groupID,a=e.groupAttributes,i=(e=this._getLocalGroupAttributes(o)).remoteMainSequence,r=e.avChatRoomKey,s=e.attributes,l=((e=this._transformGroupAttributes(a)).forEach((function(e){var t=e.key;e.sequence=0,s.has(t)&&(e.sequence=s.get(t).sequence)})),new io("setGroupAttributes"));return l.setMessage("groupID:".concat(o," groupAttributes:").concat(JSON.stringify(a))),Re.l("".concat(n,". groupID:").concat(o," mainSequence:").concat(i)),this._grpM.req({P:jn.MODIFY_GRP_ATTR,data:{groupID:o,avChatRoomKey:r,mainSequence:i,groupAttributeList:e}}).then((function(e){Re.l("".concat(n," ok."));var i=(e=e.data).mainSequence;return(e=v(e.groupAttributeList)).forEach((function(e){e.value=a[e.key]})),t._groupAttributesCopy=t._getCachedAttributes({groupID:o}),t._refreshCachedGroupAttributes({groupID:o,remoteMainSequence:i,groupAttributeList:e,operationType:2}),t._emitGroupAttributesUpdated(o),l.end(),Tn({groupAttributes:a})})).catch((function(e){return l.setError(e).end(),Mn(e)}))}},{key:"deleteGroupAttributes",value:function(e){var t=this,n=e.groupID,o=(e=void 0===(e=e.keyList)?[]:e,(s=this._getLocalGroupAttributes(n)).remoteMainSequence),a=s.avChatRoomKey,i=s.attributes,r=v(i.keys()),s=jn.CLEAR_GRP_ATTR,l=3,c=(a={groupID:n,avChatRoomKey:a,mainSequence:o},[]),u=(0<e.length&&(r=[],s=jn.DEL_GRP_ATTR,l=4,e.forEach((function(e){var t=0;i.has(e)&&(t=i.get(e).sequence,r.push(e)),c.push({key:e,sequence:t})})),a.groupAttributeList=c),new io("deleteGroupAttributes"));return u.setMessage("groupID:".concat(n," mainSequence:").concat(o," keyList:").concat(e," proto:").concat(s)),this._grpM.req({P:s,data:a}).then((function(e){return Re.l("".concat(t._n,".").concat("deleteGroupAttributes"," ok. groupID:").concat(n)),e=e.data.mainSequence,t._groupAttributesCopy=t._getCachedAttributes({groupID:n}),t._refreshCachedGroupAttributes({groupID:n,remoteMainSequence:e,groupAttributeList:c,operationType:l}),t._emitGroupAttributesUpdated(n),u.end(),Tn({keyList:r})})).catch((function(e){return u.setError(e).end(),Mn(e)}))}},{key:"getGroupAttributes",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupAttributes"),o=e.groupID,a=(s=this._getLocalGroupAttributes(o)).avChatRoomKey,i=s.lastUpdateTime,r=s.localMainSequence,s=s.remoteMainSequence,l=new io("getGroupAttributes");return l.setMessage("groupID:".concat(o," localMainSequence:").concat(r," remoteMainSequence:").concat(s," keyList:").concat(e.keyList)),Date.now()-i>=this.CACHE_EXPIRE_TIME||r<s?this._getGroupAttributes({groupID:o,avChatRoomKey:a}).then((function(a){return l.setMoreMessage("get attributes from remote. count:".concat(a.length)).end(),Re.l("".concat(n," from remote. groupID:").concat(o)),Tn({groupAttributes:a=t._getCachedAttributes(e)})})).catch((function(e){return l.setError(e).end(),Mn(e)})):(l.setMoreMessage("get attributes from cache").end(),Re.l("".concat(n," from cache. groupID:").concat(o)),Sn({groupAttributes:i=this._getCachedAttributes(e)}))}},{key:"_getGroupAttributes",value:function(e){var n=this,o=0;return pt(e.avChatRoomKey)||(o=1),this._grpM.req({P:jn.GET_GRP_ATTR,data:t(t({},e),{},{groupType:o})}).then((function(t){Re.l("".concat(n._n,"._getGroupAttributes ok. groupID:").concat(e.groupID));var o=(t=t.data).mainSequence,a=v(t=t.groupAttributeList);return pt(o)||n._refreshCachedGroupAttributes({groupID:e.groupID,remoteMainSequence:o,groupAttributeList:a,operationType:5}),t})).catch((function(e){return Mn(e)}))}},{key:"_refreshCachedGroupAttributes",value:function(e){var t=e.groupID,n=e.remoteMainSequence,o=e.groupAttributeList;if(e=e.operationType,this._hasLocalGroupAttributes(t)){var a=this._getLocalGroupAttributes(t),i=a.localMainSequence;if(5===e||n-i==1)a.remoteMainSequence=n,a.localMainSequence=n,a.lastUpdateTime=Date.now(),this._updateCachedAttributes({groupAttributes:a,groupAttributeList:o,operationType:e});else{if(i===n)return;a.remoteMainSequence=n}this._groupAttributesMap.set(t,a),o="operationType:".concat(e," localMainSequence:").concat(i," remoteMainSequence:").concat(n),Re.l("".concat(this._n,"._refreshCachedGroupAttributes. ").concat(o))}}},{key:"_getCachedAttributes",value:function(e){var t=e.groupID,n=(e=void 0===(e=e.keyList)?[]:e,{});if(this._hasLocalGroupAttributes(t)){var o=this._getLocalGroupAttributes(t).attributes;if(0<e.length)e.forEach((function(e){o.has(e)&&(n[e]=o.get(e).value)}));else{var a,i=E(o.keys());try{for(i.s();!(a=i.n()).done;){var r=a.value;n[r]=o.get(r).value}}catch(s){i.e(s)}finally{i.f()}}}return n}},{key:"_updateCachedAttributes",value:function(e){var t=e.groupAttributes,n=e.groupAttributeList;3!==(e=e.operationType)?4!==e?(1===e&&t.attributes.clear(),n.forEach((function(e){var n=e.key,o=e.value;e=e.sequence,t.attributes.set(n,{value:o,sequence:e})}))):n.forEach((function(e){t.attributes.delete(e.key)})):t.attributes.clear()}},{key:"_hasLocalGroupAttributes",value:function(e){return this._groupAttributesMap.has(e)}},{key:"_getLocalGroupAttributes",value:function(e){return this._hasLocalGroupAttributes(e)||this.initGroupAttributesCache({groupID:e}),this._groupAttributesMap.get(e)}},{key:"_transformGroupAttributes",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_emitGroupAttributesUpdated",value:function(e){var t=this._getCachedAttributes({groupID:e}),n=(o=this._computeAttrChangedInfo(t)).updatedKeyList,o=o.deletedKeyList;Re.l("".concat(this._n,"._emitGroupAttributesUpdated update:").concat(n.length,", delete:").concat(o.length)),0===n.length&&0===o.length||this._grpM.emitOEvt(T.GROUP_ATTRIBUTES_UPDATED,{groupID:e,groupAttributes:t,updatedKeyList:n,deletedKeyList:o})}},{key:"_computeAttrChangedInfo",value:function(e){var t=this,n=[],o=[];return Object.keys(e).forEach((function(o){e[o]!==t._groupAttributesCopy[o]&&n.push(o)})),Object.keys(this._groupAttributesCopy).forEach((function(t){pt(e[t])&&o.push(t)})),this._groupAttributesCopy={},{updatedKeyList:n,deletedKeyList:o}}},{key:"deleteLocalGroupAttributes",value:function(e){this._hasLocalGroupAttributes(e)&&this._groupAttributesMap.delete(e)}},{key:"reset",value:function(){this._groupAttributesMap.clear(),this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4}}]),ni),Ia=(i(ti,[{key:"_onCloudConfig",value:function(){var e=this._grpM.getCloudConfig("grp_counter_expire_time");pt(e)||(this.EXPIRE_TIME=Number(e))}},{key:"isGroupCountersNotice",value:function(e){var t=e.to,n=!1;return He(e=e.elements.groupCounterInfo)||(this._onGroupCountersUpdated({groupID:t,groupCounterInfo:e}),n=!0),n}},{key:"_onGroupCountersUpdated",value:function(e){var t=this,n=e.groupID;e.groupCounterInfo.forEach((function(e){var o=e.type,a=e.groupCounterSeq;e=void 0===(e=e.counterList)?[]:e,0!==o&&2!==o||(t._updateLocalGroupCounters({groupID:n,groupCounterSeq:a,counterList:e}),e.forEach((function(e){t._grpM.emitOEvt(T.GROUP_COUNTER_UPDATED,{groupID:n,key:e.key,value:e.value})}))),1===o&&t._deleteLocalGroupCounters({groupID:n,groupCounterSeq:a,counterList:e})})),Re.l("".concat(this._n,"._onGroupCountersUpdated groupID:").concat(n))}},{key:"initGroupCountersCache",value:function(e){var t=e.groupID;e=e.avChatRoomKey,this._groupCountersMap.set(t,{lastUpdateTime:0,groupCounterSeq:0,counters:new Map,avChatRoomKey:e}),Re.l("".concat(this._n,".initGroupCountersCache groupID:").concat(t," avChatRoomKey:").concat(e))}},{key:"setGroupCounters",value:function(e){if(!this._grpM.canIUse(P.GRP_COUNTER))return this._grpM.noUse("setGroupCounters");var t="".concat(this._n,".").concat("setGroupCounters"),n=e.groupID,o=(e=e.counters,e=this._convertObjectToList(e),this._getLocalGroupCounters(n).avChatRoomKey),a="groupID:".concat(n," count:").concat(e.length),i=new io("setGroupCounters");return i.setMessage("".concat(a)),Re.l("".concat(t,". ").concat(a)),this._updateGroupCounters({groupID:n,counterList:e,avChatRoomKey:o,mode:"Set"}).then((function(e){return i.end(),Re.l("".concat(t," ok.")),Tn({counters:e})})).catch((function(e){return i.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"increaseGroupCounter",value:function(e){var t="increaseGroupCounter";if(!this._grpM.canIUse(P.GRP_COUNTER))return this._grpM.noUse(t);var n="".concat(this._n,".").concat(t),o=e.groupID,a=e.key,i=(e=e.value,this._getLocalGroupCounters(o).avChatRoomKey),r="groupID:".concat(o," key:").concat(a," value:").concat(e),s=new io(t);return s.setMessage("".concat(r)),Re.l("".concat(n,". ").concat(r)),this._updateGroupCounters({groupID:o,counterList:[{key:a,value:e}],avChatRoomKey:i,mode:"Increase"}).then((function(e){return s.end(),Re.l("".concat(n," ok.")),Tn({counters:e})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"decreaseGroupCounter",value:function(e){var t="decreaseGroupCounter";if(!this._grpM.canIUse(P.GRP_COUNTER))return this._grpM.noUse(t);var n="".concat(this._n,".").concat(t),o=e.groupID,a=e.key,i=(e=e.value,this._getLocalGroupCounters(o).avChatRoomKey),r="groupID:".concat(o," key:").concat(a," value:").concat(e),s=new io(t);return s.setMessage("".concat(r)),Re.l("".concat(n,". ").concat(r)),this._updateGroupCounters({groupID:o,counterList:[{key:a,value:e}],avChatRoomKey:i,mode:"Decrease"}).then((function(e){return s.end(),Re.l("".concat(n," ok.")),Tn({counters:e})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"getGroupCounters",value:function(e){var t=this;if(!this._grpM.canIUse(P.GRP_COUNTER))return this._grpM.noUse("getGroupCounters");var n="".concat(this._n,".").concat("getGroupCounters"),o=e.groupID,a=void 0===(e=e.keyList)?[]:e,i=(e=this._getLocalGroupCounters(o)).avChatRoomKey,r=(e=e.lastUpdateTime,new io("getGroupCounters"));return r.setMessage("groupID:".concat(o)),Date.now()-e>=this.EXPIRE_TIME?this._getRemoteGroupCounters({groupID:o,avChatRoomKey:i}).then((function(e){return r.setMoreMessage("from remote. count:".concat(e.length)).end(),Re.l("".concat(n," from remote. groupID:").concat(o)),Tn({counters:e=t._getLocalCounters(o,a)})})).catch((function(e){return r.setError(e).end(),Mn(e)})):(r.setMoreMessage("from cache").end(),Re.l("".concat(n," from cache. groupID:").concat(o)),Sn({counters:e=this._getLocalCounters(o,a)}))}},{key:"_getRemoteGroupCounters",value:function(e){var n=this;return this._grpM.req({P:jn.GET_GRP_COUNTER,data:t({},e)}).then((function(t){var o=void 0===(o=(t=t.data).counterList)?[]:o;return t=t.groupCounterSeq,n._updateLocalGroupCounters({groupID:e.groupID,counterList:o,groupCounterSeq:t}),Re.l("".concat(n._n,"._getRemoteGroupCounters ok. groupID:").concat(e.groupID)),o})).catch((function(e){return Mn(e)}))}},{key:"_convertObjectToList",value:function(e){var t=[];return Object.keys(e).forEach((function(n){t.push({key:n,value:e[n]})})),t}},{key:"_updateGroupCounters",value:function(e){var n="".concat(this._n,"._updateGroupCounters"),o=e.groupID,a=e.avChatRoomKey,i=e.mode;return Re.l("".concat(n,". groupID:").concat(o," avChatRoomKey:").concat(a," mode:").concat(i)),this._grpM.req({P:jn.UPDATE_GRP_COUNTER,data:t({},e)}).then((function(e){Re.l("".concat(n," ok.")),e=e.data.counterList;var t={};return(void 0===e?[]:e).forEach((function(e){var n=e.key;e=e.value,t[n]=e})),t})).catch((function(e){return Mn(e)}))}},{key:"_hasLocalGroupCounters",value:function(e){return this._groupCountersMap.has(e)}},{key:"_getLocalGroupCounters",value:function(e){return this._hasLocalGroupCounters(e)||this.initGroupCountersCache({groupID:e}),this._groupCountersMap.get(e)}},{key:"_updateLocalGroupCounters",value:function(e){var t,n,o,a=e.groupID,i=void 0===(i=e.counterList)?[]:i;e=e.groupCounterSeq,this._hasLocalGroupCounters(a)&&(o=this._getLocalGroupCounters(a),t=o.counters,n=o.avChatRoomKey,o=o.groupCounterSeq,0<e&&e<o||(i.forEach((function(e){var n=e.key;e=e.value,t.set(n,e)})),this._groupCountersMap.set(a,{lastUpdateTime:Date.now(),groupCounterSeq:e,counters:t,avChatRoomKey:n})))}},{key:"_deleteLocalGroupCounters",value:function(e){var t,n,o=e.groupID,a=void 0===(a=e.counterList)?[]:a;e=e.groupCounterSeq,this._hasLocalGroupCounters(o)&&(n=this._getLocalGroupCounters(o),t=n.counters,n=n.avChatRoomKey,a.forEach((function(e){t.delete(e.key)})),this._groupCountersMap.set(o,{lastUpdateTime:Date.now(),groupCounterSeq:e,counters:t,avChatRoomKey:n}))}},{key:"_getLocalCounters",value:function(e,t){var n={};if(!this._hasLocalGroupCounters(e))return n;var o=this._getLocalGroupCounters(e).counters;if(0<t.length)t.forEach((function(e){o.has(e)&&(n[e]=o.get(e))}));else{var a,i=E(o.keys());try{for(i.s();!(a=i.n()).done;){var r=a.value;n[r]=o.get(r)}}catch(s){i.e(s)}finally{i.f()}}return n}},{key:"reset",value:function(){this._groupCountersMap.clear(),this.EXPIRE_TIME=3e4}}]),ti),Ca=(i(ei,[{key:"start",value:function(){var e=this._grpM.isLoggedIn();e||(this._proto=jn.AV_NOAUTH_POLLING),Re.l("".concat(this._n,".start pollingInterval:").concat(this._manager.getPollingInterval()," isLoggedIn:").concat(e)),this._isRunning=!0,this._request()}},{key:"isRunning",value:function(){return this._isRunning}},{key:"_request",value:function(){var e=this,t=this._onInit(this._groupID);this._grpM.req({P:this._proto,data:t}).then((function(t){e._onSuccess(e._groupID,t),e.isRunning()&&(-1<e._timeoutID&&clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.getPollingInterval()))})).catch((function(t){e._onFail(e._groupID,t),e.isRunning()&&(-1<e._timeoutID&&clearTimeout(e._timeoutID),e._timeoutID=setTimeout(e._request.bind(e),e._manager.MAX_POLLING_INTERVAL))}))}},{key:"stop",value:function(){Re.l("".concat(this._n,".stop")),-1<this._timeoutID&&(clearTimeout(this._timeoutID),this._timeoutID=-1),this._isRunning=!1}},{key:"getPollingTimerID",value:function(){return this._timeoutID}}]),ei),ka={3:!0,4:!0,5:!0,6:!0,17:!0,20:!0,21:!0,100:!0},Ea=(i(Qa,[{key:"hasJoinedAVChatRoom",value:function(){var e=[];return 0<(e=0<this._joinedGroupMap.size?v(this._joinedGroupMap.values()).filter((function(e){return e.type===S.GRP_AVCHATROOM})):e).length}},{key:"getJoinedLiveList",value:function(){var e=[];return 0<this._joinedGroupMap.size?v(this._joinedGroupMap.values()).filter((function(e){return e.type===S.GRP_LIVE})):e}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._joinedGroupMap.has(e)}},{key:"getJoinedAVChatRoom",value:function(){return 0<this._joinedGroupMap.size?v(this._joinedGroupMap.keys()):[]}},{key:"_updatedata",value:function(e){var n=this._pollingRequestInfoMap.get(e);return e===v(this._pollingInstanceMap.keys())[0]?t(t({},n),{},{startBroadcastSeq:this._startBroadcastSeq,simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG}):t(t({},n),{},{simplifiedMessage:this.DEFAULT_POLLING_SIMPLIFIED_MSG})}},{key:"_handleSuccess",value:function(e,t){var n,o=(l=t.data).key,a=l.nextSeq,i=l.rspMsgList,r=l.errorCode,s=l.nextBroadcastSeq,l=l.broadcastMessageList;0!==r?(r=this._pollingRequestInfoMap.get(e),n=new io("longPollingAVError"),r=r?"".concat(r.key,"-").concat(r.startSeq):"requestInfo is undefined",n.setMessage("".concat(e,"-").concat(r,"-").concat(t.errorInfo)).setCode(t.errorCode).end(!0)):this.checkJoinedAVChatRoomByID(e)&&(dt(o)&&Ye(a)&&this._pollingRequestInfoMap.set(e,{key:o,startSeq:a}),Ye(s)&&s>this._startBroadcastSeq&&(this._startBroadcastSeq=s),Ze(i)&&0<i.length?(i.forEach((function(e){e.to=e.groupID})),this.onMessage(i,e)):(this._pollingNoMessageCount+=1,this._pollingNoMessageCount===this.DEFAULT_POLLING_NO_MESSAGE_COUNT&&(this._pollingInterval=this.DEFAULT_POLLING_INTERVAL+this.DEFAULT_POLLING_INTERVAL_PLUS)),this._onBroadcastMessage(l))}},{key:"_handleFailure",value:function(e,t){}},{key:"onMessage",value:function(e,t){if(Ze(e)&&0!==e.length){var n="".concat(this._n,".onMessage"),o=(t&&(n+=" groupID:".concat(t)),0!==this._pollingNoMessageCount&&(this._pollingNoMessageCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL),null),a=[],i=this._get(11),r=this._get(26),s=e.length,l=(1<s&&e.sort((function(e,t){return e.sequence-t.sequence})),this._get(12).isUnlimitedAVChatRoom()),c=!1;Re.getLevel()<=0&&(t=e.map((function(e){return e.sequence})),Re.l("".concat(n," count:").concat(t.length," sequenceList:").concat(t)),t.length=0);for(var u=0;u<s;u++){var d=this.restoreMessageFromSimplified(e[u]);if(ka[d.event]){if(6===d.event){if(this._grpM.isGroupAttributesUpdatedNotice(d))continue;if(this._grpM.isGroupCountersNotice(d))continue}if(20!==d.event)if(21!==d.event)if(100!==d.event){o=this.packMessage(d,d.event);var p=1===d.isModified;if(c=1===d.isHistoryMessage,!l){if(this._seqSll.has(o.sequence))continue;this._seqSll.set(o.sequence)}var h=this._IDSll.has(o.ID);h?Re.w("".concat(n," ID:").concat(o.ID," has:").concat(h)):(this._IDSll.set(o.ID),h=!1,!c&&this._isMessageSentByCurrentInstance(o)?p&&(h=!0,o.isModified=p,i.updateMsgIsModifiedProp(o)):h=!0,h&&(o.conversationType===S.CONV_SYSTEM&&5===o.payload.operationType&&this._onGroupDismissed(o.payload.groupProfile.groupID),c||o.conversationType===S.CONV_SYSTEM||(p=o.conversationID.replace(S.CONV_GROUP,""),this._pollingInstanceMap.has(p)?this._grpM.isLoggedIn()&&r.addMessageSequence({key:eo,message:o}):(o.type!==S.MSG_GRP_TIP&&0<o.clientTime&&r.addMessageDelay(o.clientTime),r.addMessageSequence({key:Qn,message:o}))),a.push(o)))}else this.onRoomCustomData(d);else this._get(34).onMessageReactionNotify({event:21,dataList:d.elements.messageReactionNotifyList});else this.handleMessageRevokedNotice(d)}else Re.w("".concat(n,". unknown event:").concat(d.event))}0!==a.length&&(0<(t=It(a)).length&&this._grpM.emitOEvt(T.MESSAGE_MODIFIED,t),c||0<(t=this.packConversationOption(a)).length&&i.onNewMessage({conversationOptionsList:t,isInstantMessage:!0}),this._checkMessageStacked(a),0<(t=kt(a)).length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t),a.length=0)}}},{key:"handleMessageRevokedNotice",value:function(e){var t=this,n=e.groupID,o=e.elements.revokeMsgList,a=e.revokerInfo,i=[];o.forEach((function(e){var t=e.tinyID,o=e.clientTime,r=e.random;e=e.sequence,t={conversationID:"".concat(S.CONV_GROUP).concat(n),ID:"".concat(t,"-").concat(o,"-").concat(r),revoker:a.revoker,revokeReason:a.reason||"",revokerInfo:{userID:a.revoker,nick:"",avatar:""},sequence:e},i.push(t)})),0!==i.length&&this._get(11).updateRevokerInfo(i).then((function(e){t._grpM.emitOEvt(T.MESSAGE_REVOKED,e)}))}},{key:"isBroadcastOrNormal",value:function(e){return 3===e||17===e}},{key:"isGroupTip",value:function(e){return 4===e||6===e}},{key:"isGroupSystemNotice",value:function(e){return 5===e}},{key:"restoreGroupTipElements",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=void 0===(t=e.operatorInfo)?{}:t,n=e.operatorID,o=void 0===(o=e.userIDList)?[]:o,a=e.operationType,i=(Ye(e.groupJoinType)||1!==a&&2!==a||(e.groupJoinType=2===a?0:1),a=t.userID,t.avatar);return t=t.nick,e.operatorInfo={userID:void 0===a?n:a,avatar:void 0===i?"":i,nick:void 0===t?"":t},n=o.map((function(e){return{userID:e}})),e.memberInfoList=e.memberInfoList||n,e}},{key:"restoreMessageFromSimplified",value:function(e){var n,o,a,i=e.event;return this.isBroadcastOrNormal(i)&&(e.cloudCustomData=e.cloudCustomData||"",e.elements=e.elements.map((function(e){var n;return e.type===S.MSG_CUSTOM&&(n=e.content,e.content=t({data:"",description:"",extension:""},void 0===n?{}:n)),e}))),(this.isGroupTip(i)||this.isGroupSystemNotice(i))&&(e.from=e.from||"@TIM#SYSTEM"),this.isGroupTip(i)&&(e.elements=this.restoreGroupTipElements(e.elements),o=(a=void 0===(a=e.elements)?{}:a).operationType,n=a.operatorInfo,1===o&&(o=[{userID:(void 0===n?{}:n).userID}],a.memberInfoList=a.memberInfoList||o)),this.isGroupSystemNotice(i)&&(a=(n=e.elements).memberInfoList,o=n.operatorInfo,e.elements.memberInfoList=t({userID:e.elements.operatorID,avatar:"",nick:""},a=a||(void 0===o?{}:o)),e.elements=t({authentication:"",remarkInfo:"",messageKey:1e3*e.time},e.elements),i=Object.keys(e.elements).filter((function(e){return"operatorInfo"!==e})).reduce((function(n,o){return t(t({},n),{},r({},o,e.elements[o]))}),{}),e.elements=i),e}},{key:"_onGroupDismissed",value:function(e){Re.l("".concat(this._n,"._onGroupDismissed groupID:").concat(e)),this._grpM.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"_checkMessageStacked",value:function(e){var t="MessageStacked";100<=(e=e.length)&&(this._grpM.warn(t,e),this._reportMessageStackedCount<5&&(new io(t).setMessage("count:".concat(e," groupID:").concat(v(this._joinedGroupMap.keys()))).setLevel("warning").end(),this._reportMessageStackedCount+=1))}},{key:"_isMessageSentByCurrentInstance",value:function(e){return!!this._get(11).isMessageSentByCurrentInstance(e)}},{key:"packMessage",value:function(e,t){e.currentUser=this._grpM.getMyUserID(),e.conversationType=5===t?S.CONV_SYSTEM:S.CONV_GROUP,e.isSystemMessage=!!e.isSystemMessage;var n=new No(e),o=(e=this.packElements(e,t),t=this._grpM.getFileDownloadProxy(),this._grpM.getDowloadFileAuthKey()),a=this._get(17).getFileDNList();return n.setElement(e,t,o,a),n}},{key:"packElements",value:function(e,n){return 4===n||6===n?(this._updateMemberCountByGroupTips(e),{type:S.MSG_GRP_TIP,content:t(t({},e.elements),{},{groupProfile:e.groupProfile})}):5===n?{type:S.MSG_GRP_SYS_NOTICE,content:t(t({},e.elements),{},{groupProfile:t(t({},e.groupProfile),{},{groupID:e.groupID})})}:e.elements}},{key:"packConversationOption",value:function(e){for(var t=new Map,n=0;n<e.length;n++){var o,a=e[n],i=a.conversationID;t.has(i)?"in"===((o=t.get(i)).lastMessage=a).flow&&o.unreadCount++:t.set(i,{conversationID:a.conversationID,unreadCount:"out"===a.flow?0:1,type:a.conversationType,subType:a.conversationSubType,lastMessage:a})}return v(t.values())}},{key:"_updateMemberCountByGroupTips",value:function(e){var t,n,o,a=e.groupProfile.groupID;He(e=void 0===(e=e.elements.onlineMemberInfo)?void 0:e)||(t=void 0===(t=e.onlineMemberNum)?0:t,e=void 0===(e=e.expireTime)?this.DEFAULT_EXPIRE_TIME:e,n=this._onlineMemberCountMap.get(a)||{},o=Date.now(),He(n)?Object.assign(n,{lastReqTime:0,lastSyncTime:0,latestUpdateTime:o,memberCount:t,expireTime:e}):(n.latestUpdateTime=o,n.memberCount=t),this._onlineMemberCountMap.set(a,n))}},{key:"_onBroadcastMessage",value:function(e){if(!He(e)){for(var t=[],n=e.length,o=null,a=0;a<n;a++){var i=this.restoreMessageFromSimplified(e[a]);ka[i.event]?((o=this.packMessage(i,i.event)).isBroadcastMessage=!0,this._broadcastMessageIDMap.has(o.ID)||(t.push(o),this._broadcastMessageIDMap.set(o.ID,1))):Re.w("".concat(this._n,"._onBroadcastMessage unknown event:").concat(i.event))}0<t.length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t)}}},{key:"start",value:function(e){var t;this._pollingInstanceMap.has(e)?(t=this._pollingInstanceMap.get(e)).isRunning()||t.start():((t=new Ca({manager:this,groupID:e,onInit:this._updatedata.bind(this),onSuccess:this._handleSuccess.bind(this),onFail:this._handleFailure.bind(this)})).start(),this._pollingInstanceMap.set(e,t),Re.l("".concat(this._n,".start groupID:").concat(e)))}},{key:"handleJoinResult",value:function(e){var t=this;return this._preCheck(e.group).then((function(){var n=e.longPollingKey,o=e.group,a=o.groupID;return t._joinedGroupMap.set(a,o),t._grpM.updateGroupMap([o]),t._grpM.deleteUnjoinedAVChatRoom(a),t._grpM.emitGroupListUpdate(!0,!1),pt(n)?Sn({status:Ve,group:o}):Promise.resolve()}))}},{key:"startRunLoop",value:function(e){var t=this;return this.handleJoinResult(e).then((function(){var n=e.longPollingKey,o=e.group,a=e.startSeq,i=o.groupID;return t._pollingRequestInfoMap.set(i,{key:n,startSeq:void 0===a?0:a}),t.start(i),t._grpM.isLoggedIn()?Sn({status:Ve,group:o}):Sn({status:Ve})}))}},{key:"_preCheck",value:function(e){if(this._get(12).isUnlimitedAVChatRoom())return Promise.resolve();if(!this.hasJoinedAVChatRoom())return Promise.resolve();if(e.type===S.GRP_LIVE)return Promise.resolve();var t=(e=m(this._joinedGroupMap.entries().next().value,2))[0];if(e=e[1],this._grpM.isLoggedIn()){if(e.selfInfo.role!==S.GRP_MBR_ROLE_OWNER&&e.ownerID!==this._grpM.getMyUserID())return this._grpM.quitGroup(t);this._grpM.deleteLocalGroupAndConversation(t)}else this._grpM.deleteLocalGroupAndConversation(t);return this.reset(t),Promise.resolve()}},{key:"joinWithoutAuth",value:function(e){var t=this,n=e.groupID,o="".concat(this._n,".").concat("joinWithoutAuth"),a=new io("joinWithoutAuth");return this._grpM.req({P:jn.APPLY_JOIN_GRP_NOAUTH,data:e}).then((function(e){if(e=e.data.longPollingKey,a.setMessage("groupID:".concat(n," longPollingKey:").concat(e)).end(!0),pt(e))return Mn({code:zn.CANNOT_JOIN_NON_AV_WITHOUT_LOGIN});Re.l("".concat(o," ok. groupID:").concat(n)),t._get(11).setCompleted("".concat(S.CONV_GROUP).concat(n));var i=new da({groupID:n});return t.startRunLoop({group:i,longPollingKey:e}),Tn({status:Ve})})).catch((function(e){return Re.e("".concat(o," failed. groupID:").concat(n," error:"),e),a.setError(e).setMessage("groupID:".concat(n)).end(!0),Mn(e)})).finally((function(){t._grpM.get(14).reportAtOnce()}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._onlineMemberCountMap.get(e)||{},n=Date.now();return He(t)||n-t.lastSyncTime>1e3*t.expireTime&&1e4<n-t.latestUpdateTime&&3e3<n-t.lastReqTime?(t.lastReqTime=n,this._onlineMemberCountMap.set(e,t),this._getGroupOnlineMemberCount(e).then((function(e){return Tn({memberCount:e.memberCount})})).catch((function(e){return Mn(e)}))):Sn({memberCount:t.memberCount})}},{key:"_getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".").concat("_getGroupOnlineMemberCount"),o=new io("_getGroupOnlineMemberCount");return this._grpM.requestOnlineCount(e).then((function(o){var a=t._onlineMemberCountMap.get(e)||{},i=void 0===(i=(o=o.data).memberCount)?0:i,r=(o=void 0===(o=o.expireTime)?t.DEFAULT_EXPIRE_TIME:o,Re.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(i," expireTime:").concat(o)),Date.now());return He(a)&&(a.lastReqTime=r),t._onlineMemberCountMap.set(e,Object.assign(a,{lastSyncTime:r,latestUpdateTime:r,memberCount:i,expireTime:o})),{memberCount:i}})).catch((function(t){return Re.w("".concat(n," failed. error:"),t),o.setCode(t.code).setMessage("groupID:".concat(e," error:").concat(JSON.stringify(t))).end(),Promise.reject(t)}))}},{key:"_get",value:function(e){return this._grpM.get(e)}},{key:"setPollingInterval",value:function(e){pt(e)||(Ye(e)?this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=e:this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=parseInt(e,10))}},{key:"setPollingIntervalPlus",value:function(e){pt(e)||(Ye(e)?this.DEFAULT_POLLING_INTERVAL_PLUS=e:this.DEFAULT_POLLING_INTERVAL_PLUS=parseInt(e,10))}},{key:"setPollingNoMessageCount",value:function(e){pt(e)||(Ye(e)?this.DEFAULT_POLLING_NO_MESSAGE_COUNT=e:this.DEFAULT_POLLING_NO_MESSAGE_COUNT=parseInt(e,10))}},{key:"setPollingSimplifiedMessage",value:function(e){pt(e)||"0"!==e&&"1"!==e||(this.DEFAULT_POLLING_SIMPLIFIED_MSG=parseInt(e,10))}},{key:"getPollingInterval",value:function(){return this._pollingInterval}},{key:"onAVChatRoomMemberBanned",value:function(e){e=e.payload.groupProfile.groupID,Re.l("".concat(this._n,".onAVChatRoomMemberBanned groupID:").concat(e)),this._grpM.deleteLocalGroupAndConversation(e),this.reset(e)}},{key:"restartPolling",value:function(){Re.l("".concat(this._n,".restartPolling count:").concat(this._pollingInstanceMap.size));var e,t=E(this._pollingInstanceMap.values());try{for(t.s();!(e=t.n()).done;){var n=e.value;n.stop(),n.start()}}catch(o){t.e(o)}finally{t.f()}}},{key:"getPollingTimerID",value:function(e){if(!this._pollingInstanceMap.has(e))return-1;var t=this._pollingInstanceMap.get(e).getPollingTimerID();return Re.l("".concat(this._n,".getPollingTimerID groupID:").concat(e," timerID:").concat(t)),t}},{key:"hasPollingInstance",value:function(e){return this._pollingInstanceMap.has(e)}},{key:"onRoomCustomData",value:function(e){var t=e.groupID,n=e.sequence,o=e.time;e=(e=e.elements)&&e.content,this._get(30).onRoomCustomDataReceived(e),Re.l("".concat(this._n,".onRoomCustomData groupID:").concat(t," sequence:").concat(n," time:").concat(o," data:").concat(e))}},{key:"reset",value:function(e){if(e){Re.l("".concat(this._n,".reset groupID:").concat(e));var t=this._pollingInstanceMap.get(e);t&&t.stop(),this._pollingInstanceMap.delete(e),this._joinedGroupMap.delete(e),this._pollingRequestInfoMap.delete(e),this._onlineMemberCountMap.delete(e)}else{Re.l("".concat(this._n,".reset all"));var n,o=E(this._pollingInstanceMap.values());try{for(o.s();!(n=o.n()).done;)n.value.stop()}catch(a){o.e(a)}finally{o.f()}this._pollingInstanceMap.clear(),this._joinedGroupMap.clear(),this._pollingRequestInfoMap.clear(),this._onlineMemberCountMap.clear(),this._broadcastMessageIDMap.clear()}this._seqSll.reset(),this._IDSll.reset(),this._reportMessageStackedCount=0,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL=300,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0}}]),Qa),Ta=(i(Xa,[{key:"updateMember",value:function(e){pt(e.onlineStatus)||(this.isOnline="Online"===e.onlineStatus);var t=[null,void 0,"",0,NaN];e.memberCustomField&&yt(this.memberCustomField,e.memberCustomField),nt(this,e,["memberCustomField","marks","onlineStatus"],t)}},{key:"updateRole",value:function(e){["Owner","Admin","Member"].indexOf(e)<0||(this.role=e)}},{key:"updateMuteUntil",value:function(e){pt(e)||(this.muteUntil=Math.floor((Date.now()+1e3*e)/1e3))}},{key:"updateNameCard",value:function(e){pt(e)||(this.nameCard=e)}},{key:"updateMemberCustomField",value:function(e){e&&yt(this.memberCustomField,e)}}]),Xa),Sa=(i(Ja,[{key:"_onProfileUpdated",value:function(e){for(var t=this,n=e.data,o=0;o<n.length;o++)!function(e){var o=n[e];t.groupMemberListMap.forEach((function(e){e.has(o.userID)&&e.get(o.userID).updateMember({nick:o.nick,avatar:o.avatar})}))}(o)}},{key:"deleteGroupMemberList",value:function(e){this.groupMemberListMap.delete(e)}},{key:"getGroupMemberList",value:function(e){var t,n=this,o=e.groupID,a=void 0===(a=e.role)?void 0:a,i=void 0===(l=e.offset)?0:l,r=void 0===(l=e.count)?15:l,s=(e=void 0===(l=e.filter)?void 0:l,"".concat(this._n,".").concat("getGroupMemberList")),l=this._grpM.hasLocalGroup(o);if(Re.l("".concat(s," groupID:").concat(o," role:").concat(a," offset:").concat(i," count:").concat(r," hasLocalGroup:").concat(l)),!l)return Sn({memberList:[],offset:0});if(this._grpM.getLocalGroupProfile(o).type===S.GRP_AVCHATROOM){if(this._grpM.canIUse(P.AV_MBR_LIST))return this._getAVChatRoomMemberList({groupID:o,offset:i,filter:e});this._grpM.warn("LiveOnlineMember")}a!==S.GRP_MBR_ROLE_ADMIN&&a!==S.GRP_MBR_ROLE_OWNER&&a!==S.GRP_MBR_ROLE_MEMBER||(t=a);var c=new io("getGroupMemberList"),u=0,d=(l={groupID:o,limit:100<r?100:r,memberRoleFilter:t?[t]:void 0,memberInfoFilter:this.DEFAULT_MEMBER_INFO_FILTER},Tt({groupID:o})?l.next="".concat(i):(l.offset=i,u=i+r),[]);return this._grpM.req({P:jn.GET_GRP_MBR_LIST,data:l}).then((function(e){var t=(e=e.data).members,a=e.memberNum;return e=e.next,pt(e=void 0===e?void 0:e)||(u=He(e)?0:e),Ze(t)&&0!==t.length?(n._grpM.hasLocalGroup(o)&&(n._grpM.getLocalGroupProfile(o).memberNum=a),d=n._updateLocalGroupMemberMap(o,t),n._grpM.get(4).getUserProfile({userIDList:t.map((function(e){return e.userID})),tagList:[Ae.NICK,Ae.AVATAR]})):(u=0,Promise.resolve([]))})).then((function(e){return Ze(e=e.data)&&0!==e.length?(e=e.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}})),n._updateLocalGroupMemberMap(o,e),d.length<r&&(u=0),c.setMessage("groupID:".concat(o," offset:").concat(i," count:").concat(r)).end(),Re.l("".concat(s," ok.")),Tn({memberList:d,offset:u})):Sn({memberList:[],offset:u})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(s," failed. error:"),e),Mn(e)}))}},{key:"_getAVChatRoomMemberList",value:function(e){var n=this,o=e.groupID,a=e.offset,i=(e=e.filter,"".concat(this._n,".").concat("_getAVChatRoomMemberList")),r=new io("_getAVChatRoomMemberList");return r.setMessage("groupID:".concat(o," offset:").concat(a," filter:").concat(e)),this._grpM.req({P:jn.GET_AV_MBR_LIST,data:{groupID:o,offset:a,filter:e}}).then((function(e){var a=void 0===(a=(e=e.data).memberList)?[]:a;return e=void 0===(e=e.offset)?0:e,r.end(),Re.l("".concat(i," ok. member count:").concat(a.length,", next request timestamp:").concat(e)),a=a.map((function(e){return t(t({},e),{},{onlineStatus:"Online"})})),Tn({memberList:a=n._updateLocalGroupMemberMap(o,a),offset:e})})).catch((function(e){return r.setError(e).end(),Re.e("".concat(i," failed. error:"),e),Mn(e)}))}},{key:"getGroupMemberProfile",value:function(e){var n=this,o="getGroupMemberProfile",a="".concat(this._n,".").concat(o),i="groupID:".concat(e.groupID),r=(5<e.userIDList.length?i+=" userIDList.length:".concat(e.userIDList.length):i+=" userIDList:".concat(e.userIDList),Re.l("".concat(a," ").concat(i)),50<e.userIDList.length&&(e.userIDList=e.userIDList.slice(0,50)),e.groupID),s=e.userIDList;if((a=this._grpM.getLocalGroupProfile(r))&&Et(a.type))return Mn({code:a=zn.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(a,o)});var l=new io(o);return l.setMessage(i),this._getGroupMemberProfileAdvance(t(t({},e),{},{userIDList:s})).then((function(e){return Ze(e=e.data.members)&&0!==e.length?(n._updateLocalGroupMemberMap(r,e),n._grpM.get(4).getUserProfile({userIDList:e.map((function(e){return e.userID})),tagList:[Ae.NICK,Ae.AVATAR]})):Sn([])})).then((function(e){return e=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}})),n._updateLocalGroupMemberMap(r,e),e=s.filter((function(e){return n.hasLocalGroupMember(r,e)})).map((function(e){return n.getLocalGroupMemberInfo(r,e)})),l.end(),Tn({memberList:e})}))}},{key:"addGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("addGroupMember"),o=e.groupID,a=this._grpM.getLocalGroupProfile(o),i=a.type,r=new io("addGroupMember");return r.setMessage("groupID:".concat(o," groupType:").concat(i)),Et(i)?(i=new Fn({code:zn.CANNOT_ADD_MEMBER_IN_AV}),r.setError(i).end(),Mn(i)):(e.userIDList=e.userIDList.map((function(e){return{userID:e}})),Re.l("".concat(n," groupID:").concat(o)),this._grpM.req({P:jn.ADD_GRP_MBR,data:e}).then((function(o){o=o.data.members;var i=(Re.l("".concat(n," ok")),o.filter((function(e){return 1===e.result})).map((function(e){return e.userID}))),s=o.filter((function(e){return 0===e.result})).map((function(e){return e.userID})),l=o.filter((function(e){return 2===e.result})).map((function(e){return e.userID})),c=(o=o.filter((function(e){return 4===e.result})).map((function(e){return e.userID})),"groupID:".concat(e.groupID,", ")+"successUserIDList:".concat(i,", ")+"failureUserIDList:".concat(s,", ")+"existedUserIDList:".concat(l,", ")+"overLimitUserIDList:".concat(o));return r.setMoreMessage(c).end(),0===i.length?Tn({successUserIDList:i,failureUserIDList:s,existedUserIDList:l,overLimitUserIDList:o}):(t._updateConvGroupProfile(a),Tn({successUserIDList:i,failureUserIDList:s,existedUserIDList:l,overLimitUserIDList:o,group:a}))})).catch((function(e){return r.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)})))}},{key:"deleteGroupMember",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroupMember"),o=e.groupID,a=e.userIDList,i=this._grpM.getLocalGroupProfile(o);if(pt(i))return Mn({code:zn.CANNOT_FIND_GRP});if(Et(i.type))return this._grpM.canIUse(P.AV_BAN_MBR)?this._banAVChatRoomMember(e):this._grpM.noUse("deleteGroupMember");var r="groupID:".concat(o," ").concat(5<a.length?"userIDList.length:".concat(a.length):"userIDList:".concat(a)),s=(Re.l("".concat(n," groupID:").concat(o," userIDList:"),a),new io("deleteGroupMember"));return s.setMessage(r),this._grpM.req({P:jn.DEL_GRP_MBR,data:e}).then((function(){return s.end(),Re.l("".concat(n," ok")),t._updateConvGroupProfile(i),t.deleteLocalGroupMembers(o,a),Tn({group:i,userIDList:a})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"_updateConvGroupProfile",value:function(e){this._grpM.get(11).updateConvGroupProfile([e])}},{key:"_banAVChatRoomMember",value:function(e){var t=this,n="".concat(this._n,".").concat("_banAVChatRoomMember"),o=e.groupID,a=e.userIDList,i="groupID:".concat(o," ").concat(5<a.length?"userIDList.length:".concat(a.length):"userIDList:".concat(a)),r=new io("_banAVChatRoomMember"),s=(r.setMessage(i),Re.l("".concat(n," groupID:").concat(o," userIDList:"),a),this._grpM.getLocalGroupProfile(o));return pt(e.duration)||0===e.duration?Mn({code:zn.BAN_DURATION_INVALID}):this._grpM.req({P:jn.BAN_AV_MBR,data:e}).then((function(){return r.end(),Re.l("".concat(n," ok")),t.deleteLocalGroupMembers(o,a),Tn({group:s,userIDList:a})})).catch((function(e){return r.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"setGroupMemberMuteTime",value:function(e){var t=this,n=e.groupID,o=e.userID,a=(e=e.muteTime,"".concat(this._n,".").concat("setGroupMemberMuteTime"));if(o===this._grpM.getMyUserID())return Mn({code:zn.CANNOT_MUTE_SELF});var i="groupID:".concat(n," userID:").concat(o," muteTime:").concat(e),r=(Re.l("".concat(a," ").concat(i)),new io("setGroupMemberMuteTime"));return r.setMessage(i),this.modifyGroupMemberInfo({groupID:n,userID:o,muteTime:e}).then((function(e){return r.end(),Re.l("".concat(a," ok")),Tn({group:t._grpM.getLocalGroupProfile(n),member:e})})).catch((function(e){return r.setError(e).end(),Re.e("".concat(a," failed. error:"),e),Mn(e)}))}},{key:"setGroupMemberRole",value:function(e){var t="".concat(this._n,".").concat("setGroupMemberRole"),n=e.groupID,o=e.userID,a=(e=e.role,"groupID:".concat(n," userID:").concat(o," role:").concat(e)),i=this._grpM.getLocalGroupProfile(n);if(i&&i.selfInfo.role!==S.GRP_MBR_ROLE_OWNER)return Mn({code:zn.NOT_OWNER});var r=[S.GRP_MBR_ROLE_ADMIN,S.GRP_MBR_ROLE_MEMBER];if(Tt({groupID:n})&&r.push(S.GRP_MBR_ROLE_CUSTOM),r.indexOf(e)<0)return Mn({code:zn.INVALID_MEMBER_ROLE});if(o===this._grpM.getMyUserID())return Mn({code:zn.CANNOT_SET_SELF_MEMBER_ROLE});var s=new io("setGroupMemberRole");return s.setMessage(a),Re.l("".concat(t," ").concat(a)),this.modifyGroupMemberInfo({groupID:n,userID:o,role:e}).then((function(e){return s.end(),Re.l("".concat(t," ok")),Tn({group:i,member:e})})).catch((function(e){return s.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"_filterProfanity",value:function(e,t){if(!(o=this._grpM.get(29)))return!0;var n=(o=o.filterText(t[e],"group_member_profile")).isAllowedToSend,o=o.modifiedText;return!0===n&&(t[e]=o,!0)}},{key:"setGroupMemberNameCard",value:function(e){var t=this,n="setGroupMemberNameCard",o="".concat(this._n,".").concat(n);if(e.nameCard&&!1===this._filterProfanity("nameCard",e))return Mn({code:zn.PROFANITY_FOUND});var a=e.groupID,i=void 0===(s=e.userID)?this._grpM.getMyUserID():s,r=e.nameCard,s="groupID:".concat(a," userID:").concat(i," nameCard:").concat(r);if(Re.l("".concat(o," ").concat(s)),(e=this._grpM.getLocalGroupProfile(a))&&Et(e.type))return Mn({code:e=zn.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(e,n)});var l=new io(n);return l.setMessage(s),this.modifyGroupMemberInfo({groupID:a,userID:i,nameCard:r}).then((function(e){Re.l("".concat(o," ok")),l.end();var n=t._grpM.getLocalGroupProfile(a);return i===t._grpM.getMyUserID()&&n&&n.setSelfNameCard(r),Tn({group:n,member:e})})).catch((function(e){return l.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"setGroupMemberCustomField",value:function(e){var t=this,n="setGroupMemberCustomField",o="".concat(this._n,".").concat(n),a=e.groupID,i=void 0===(i=e.userID)?this._grpM.getMyUserID():i,r=(e=e.memberCustomField,"groupID:".concat(a," userID:").concat(i," memberCustomField:").concat(JSON.stringify(e))),s=(Re.l("".concat(o," ").concat(r)),this._grpM.getLocalGroupProfile(a));if(s&&Et(s.type))return Mn({code:s=zn.OPERATION_NOT_SUPPORTED_IN_AV,message:this._grpM.getErrMsg(s,n)});var l=new io(n);return l.setMessage(r),this.modifyGroupMemberInfo({groupID:a,userID:i,memberCustomField:e}).then((function(e){return l.end(),Re.l("".concat(o," ok")),Tn({group:t._grpM.getLocalGroupProfile(a),member:e})})).catch((function(e){return l.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"modifyGroupMemberInfo",value:function(e){var n=this,o=e.groupID,a=e.userID,i=void 0;return St(o)&&(o=Gt(i=o)),this._grpM.req({P:jn.MODIFY_GRP_MBR_INFO,data:t(t({},e),{},{groupID:o,topicID:i})}).then((function(){if(n.hasLocalGroupMember(o,a))return t=n.getLocalGroupMemberInfo(o,a),pt(e.muteTime)||t.updateMuteUntil(e.muteTime),pt(e.role)||t.updateRole(e.role),pt(e.nameCard)||t.updateNameCard(e.nameCard),pt(e.memberCustomField)||t.updateMemberCustomField(e.memberCustomField),t;var t=n._grpM.getLocalGroupProfile(o);return t&&!Et(t.type)?n.getGroupMemberProfile({groupID:o,userIDList:[a]}).then((function(e){return m(e.data.memberList,1)[0]})):void 0}))}},{key:"markGroupMemberList",value:function(e){var t="".concat(this._n,".").concat("markGroupMemberList"),n=e.groupID,o=e.markType,a=e.enableMark,i=void 0===(e=e.userIDList)?[]:e,r=(e="groupID:".concat(n," markType:").concat(o," enableMark:").concat(a," userIDList count:").concat(i.length),Re.l("".concat(t," ").concat(e)),2),s=[],l=(!0===a&&(r=1),a=v(i),500<i.length&&(a=i.slice(0,500),Re.w("".concat(t," ").concat(qt(500)))),a.forEach((function(e){s.push({userID:e,markType:[o]})})),a=null,new io("markGroupMemberList"));return l.setMessage(e),this._grpM.req({P:jn.MARK_AV_MBR_INFO,data:{groupID:n,operationType:r,memberList:s}}).then((function(e){e=e.data.memberList;var n=[],o=[];return(e=void 0===e?[]:e).length===i.length?n.push.apply(n,v(i)):(e.forEach((function(e){n.push(e.userID)})),i.forEach((function(e){n.includes(e)||o.push(e)}))),e="success count:".concat(n.length," fail count:").concat(o.length),l.setMessage(e).end(),Re.l("".concat(t," ok. ").concat(e)),Tn({successUserIDList:n,failureUserIDList:o})})).catch((function(e){return l.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"_getGroupMemberProfileAdvance",value:function(e){return this._grpM.req({P:jn.GET_GRP_MBR_PROFILE,data:t(t({},e),{},{memberInfoFilter:e.memberInfoFilter||this.DEFAULT_MEMBER_INFO_FILTER})})}},{key:"_updateLocalGroupMemberMap",value:function(e,t){var n=this;return Ze(t)&&0!==t.length?t.map((function(t){return n.hasLocalGroupMember(e,t.userID)?n.getLocalGroupMemberInfo(e,t.userID).updateMember(t):n.setLocalGroupMember(e,new Ta(t)),n.getLocalGroupMemberInfo(e,t.userID)})):[]}},{key:"deleteLocalGroupMembers",value:function(e,t){var n=this.groupMemberListMap.get(e);n&&t.forEach((function(e){n.delete(e)}))}},{key:"getLocalGroupMemberInfo",value:function(e,t){return this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).get(t):null}},{key:"setLocalGroupMember",value:function(e,t){this.groupMemberListMap.has(e)?this.groupMemberListMap.get(e).set(t.userID,t):(t=(new Map).set(t.userID,t),this.groupMemberListMap.set(e,t))}},{key:"getLocalGroupMemberList",value:function(e){return this.groupMemberListMap.get(e)}},{key:"hasLocalGroupMember",value:function(e,t){return this.groupMemberListMap.has(e)&&this.groupMemberListMap.get(e).has(t)}},{key:"hasLocalGroupMemberMap",value:function(e){return this.groupMemberListMap.has(e)}},{key:"reset",value:function(){this.groupMemberListMap.clear()}}]),Ja),Ma=[17,18,20],wa=(i(Za,[{key:"onNewGroupSystemNotice",value:function(e){var t=e.dataList,n=e.isSyncingEnded,o=(e=e.isInstantMessage,(Re.d("".concat(this._n,".onReceiveSystemNotice count:").concat(t.length)),t=this._assembly({notifiesList:t,isInstantMessage:e})).eventDataList);t=t.result,0<o.length&&(this._grpM.get(11).onNewMessage({conversationOptionsList:o,isInstantMessage:e}),this._onReceivedGroupSystemNotice({result:t,isInstantMessage:e})),e?0<t.length&&this._grpM.emitOEvt(T.MESSAGE_RECEIVED,t):!0===n&&this._clearGroupSystemNotice()}},{key:"_assembly",value:function(e){var n=e.notifiesList,o=e.isInstantMessage,a=null,i=n.length,r=0,s=[],l={conversationID:S.CONV_SYSTEM,unreadCount:0,type:S.CONV_SYSTEM,subType:null,lastMessage:null};for(r=0;r<i;r++){var c=n[r],u=(d=c.groupProfile).communityType,d=void 0===(d=d.topicID)?void 0:d,p=void 0===(p=(h=c.elements).topicIDList)?void 0:p,h=h.operationType;if(!(2!==(void 0===u?0:u)||He(d)&&He(p))){if(Ma.includes(h)){this._handleTopicSystemNotice(c);continue}He(d)||(c.to=d)}15!==c.elements.operationType&&(c.currentUser=this._grpM.getMyUserID(),c.conversationType=S.CONV_SYSTEM,c.conversationID=S.CONV_SYSTEM,(a=new No(c)).setElement({type:S.MSG_GRP_SYS_NOTICE,content:t(t({},c.elements),{},{groupProfile:t({},c.groupProfile)})}),a.isSystemMessage=!0,(1===a.sequence&&1===a.random||2===a.sequence&&2===a.random)&&(a.sequence=it(),a.random=it(),a.generateMessageID(),Re.l("".concat(this._n,"._assembly regenerate ID:").concat(a.ID))),this._grpM.get(11).pushIntoNoticeResult(s,a)&&(o?l.unreadCount++:a.setIsRead(!0),l.subType=a.conversationSubType))}return l.lastMessage=s[s.length-1],{eventDataList:0<s.length?[l]:[],result:s}}},{key:"_clearGroupSystemNotice",value:function(){var e=this;this._getPendencyList().then((function(t){t.forEach((function(t){e.pendencyMap.set("".concat(t.from,"_").concat(t.groupID,"_").concat(t.to),t)})),t=e._grpM.get(11).getLocalMessageList(S.CONV_SYSTEM);var n=[];t.forEach((function(t){var o=(i=t.payload).operatorID,a=i.operationType,i=i.groupProfile;1===a&&(a="".concat(o,"_").concat(i.groupID,"_").concat(i.to),(o=e.pendencyMap.get(a))&&Ye(o.handled)&&0!==o.handled&&n.push(t))})),e.deleteGroupSystemNotice({messageList:n})}))}},{key:"deleteGroupSystemNotice",value:function(e){var t=this,n="".concat(this._n,".deleteGroupSystemNotice");return Ze(e.messageList)&&0!==e.messageList.length?(Re.l("".concat(n," ")+e.messageList.map((function(e){return e.ID}))),this._grpM.req({P:jn.DEL_GRP_SYSTEM_NOTICE,data:{messageListToDelete:e.messageList.map((function(e){return{from:S.CONV_SYSTEM,messageSeq:e.clientSequence,messageRandom:e.random}}))}}).then((function(){Re.l("".concat(n," ok"));var o=t._grpM.get(11);return e.messageList.forEach((function(e){o.deleteLocalMessage(e)})),Tn()})).catch((function(e){return Re.e("".concat(n," error:"),e),Mn(e)}))):Sn()}},{key:"_getPendencyList",value:function(){var e=this,t=(o=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).type,n=o.startTime,o=o.limit;return this._grpM.req({P:jn.GET_GRP_PENDENCY,data:{type:void 0===t?void 0:t,startTime:void 0===n?0:n,limit:void 0===o?20:o,handleAccount:this._grpM.getMyUserID()}}).then((function(t){var n=t.data.pendencyList;return 0!==t.data.nextStartTime?e._getPendencyList({startTime:t.data.nextStartTime}).then((function(e){return[].concat(v(n),v(e))})):n}))}},{key:"getGroupApplicationList",value:function(){var e=this;return this._getPendencyList().then((function(t){return e._getPendencyList({type:S.GRP_COMMUNITY}).then((function(n){return t.push.apply(t,v(n)),e._handlePendencyResult(t)})).catch((function(n){return e._handlePendencyResult(t)}))}))}},{key:"_handlePendencyResult",value:function(e){var t=this,n=[];return e.forEach((function(e){t.pendencyMap.set("".concat(e.from,"_").concat(e.groupID,"_").concat(e.to),e),0===e.handled&&n.push({applicant:e.from,applicantNick:e.fromUserNickName,groupName:e.groupName,groupID:e.groupID,authentication:e.authentication,messageKey:e.time,applicationType:e.applicationType,userID:e.userID,note:e.note})})),Sn({applicationList:n})}},{key:"_onReceivedGroupSystemNotice",value:function(e){var t=this,n=e.result;e.isInstantMessage&&n.forEach((function(e){switch(e.payload.operationType){case 1:case 3:case 6:case 11:case 12:case 15:break;case 2:t._onApplyJoinGroup(e);break;case 4:t._onMemberKicked(e);break;case 5:t._onGroupDismissed(e);break;case 7:t._onInviteGroup(e);break;case 8:t._onQuitGroup(e);break;case 9:t._onSetManager(e);break;case 10:t._onDeleteManager(e);break;case 20:t._onMessageRemindTypeSynced(e);break;case 21:t._grpM.onAVChatRoomMemberBanned(e)}}))}},{key:"_onApplyJoinGroup",value:function(e){var t=this,n=(e=e.payload.groupProfile).groupID,o=(e=e.groupType,this._grpM.hasLocalGroup(n));Re.l("".concat(this._n,"._onApplyJoinGroup groupID:").concat(n," groupType:").concat(e," hasGroup:").concat(o)),o||Et(e)||this._grpM.getGroupProfile({groupID:n}).then((function(e){(e=e.data.group)&&(t._grpM.updateGroupMap([e]),e=!e.isSupportTopic,t._grpM.emitGroupListUpdate(!0,e))}))}},{key:"_onMemberKicked",value:function(e){e=e.payload.groupProfile.groupID,this._grpM.hasLocalGroup(e)&&this._grpM.deleteLocalGroupAndConversation(e)}},{key:"_onGroupDismissed",value:function(e){e=e.payload.groupProfile.groupID;var t=(this._grpM.hasLocalGroup(e)&&this._grpM.deleteLocalGroupAndConversation(e),this._grpM._AVChatRoomHandler);t&&t.checkJoinedAVChatRoomByID(e)&&t.reset(e)}},{key:"_onInviteGroup",value:function(e){var t=this,n=e.payload.groupProfile.groupID;e=this._grpM.hasLocalGroup(n),Re.l("".concat(this._n,"._onInviteGroup groupID:").concat(n," hasGroup:").concat(e)),this._grpM.getGroupProfile({groupID:n}).then((function(){t._grpM.emitGroupListUpdate(),t._grpM.get(11).pullMsgOnInvite("".concat(S.CONV_GROUP).concat(n))}))}},{key:"_onQuitGroup",value:function(e){var t=(e=e.payload.groupProfile).groupID,n=(e=e.groupType,this._grpM.hasLocalGroup(t));Re.l("".concat(this._n,"._onQuitGroup groupID:").concat(t," groupType:").concat(e," hasGroup:").concat(n)),n&&this._grpM.deleteLocalGroupAndConversation(t)}},{key:"_onSetManager",value:function(e){var t=(e=e.payload.groupProfile).to;e=e.groupID,(e=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(e,t))&&e.updateRole(S.GRP_MBR_ROLE_ADMIN)}},{key:"_onDeleteManager",value:function(e){var t=(e=e.payload.groupProfile).to;e=e.groupID,(e=this._grpM.getGroupMemberHandler().getLocalGroupMemberInfo(e,t))&&e.updateRole(S.GRP_MBR_ROLE_MEMBER)}},{key:"_onMessageRemindTypeSynced",value:function(e){var t=e.payload.groupProfile.groupID;e=e.payload.messageRemindType,this._grpM.get(11).onGroupMsgRemindTypeUpdated({groupID:t,messageRemindType:e})}},{key:"_handleTopicSystemNotice",value:function(e){var t=(n=e.groupProfile).groupID,n=n.topicID,o=(e=e.elements).operationType,a=e.topicIDList,i=(e=e.messageRemindType,this._grpM.get(10));17===o?i.onTopicCreated({groupID:t,topicID:n}):18===o?i.onTopicDeleted({groupID:t,topicIDList:a}):20===o&&i.onMessageRemindTypeUpdated({groupID:t,topicID:n,messageRemindType:e})}},{key:"reset",value:function(){this.pendencyMap.clear()}}]),Za),ba=["relayFlag"],Da=(s(Wa,Un),aa=g(Wa),i(Wa,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("polling_interval"),t=this.getCloudConfig("polling_interval_plus"),n=this.getCloudConfig("polling_no_msg_count"),o=this.getCloudConfig("polling_simplified_msg"),a=this.getCloudConfig("paging_grp_count");Re.l("".concat(this._n,"._onCloudConfig pollingInterval:").concat(e)+" pollingIntervalPlus:".concat(t," pollingNoMessageCount:").concat(n)+" pollingSimplifiedMessage:".concat(o," pagingGroupCount:").concat(a)),this._AVChatRoomHandler.setPollingInterval(e),this._AVChatRoomHandler.setPollingIntervalPlus(t),this._AVChatRoomHandler.setPollingNoMessageCount(n),this._AVChatRoomHandler.setPollingSimplifiedMessage(o),this._commonGroupHandler.setPagingGroupCount(a)}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&(this._commonGroupHandler.onCheckTimer(e),this._groupTipsHandler.onCheckTimer(e))}},{key:"guardForAVChatRoom",value:function(e){var t,n=this;return e.conversationType===S.CONV_GROUP?(t=St(e.to)?Gt(e.to):e.to,this.hasLocalGroup(t)?Sn():this.getGroupProfile({groupID:t}).then((function(o){return o=o.data.group.type,Re.l("".concat(n._n,".guardForAVChatRoom. groupID:").concat(t," type:").concat(o)),o===S.GRP_AVCHATROOM?Mn(new Fn({code:o=zn.MSG_SEND_FAIL_NOT_IN_AV,message:n.getErrMsg(o,e.from,t),data:{message:e}})):Sn()}))):Sn()}},{key:"checkJoinedAVChatRoomByID",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"onNewMessage",value:function(e){this._commonGroupHandler.onNewMessage(e)}},{key:"updateNextMessageSeq",value:function(e){var t,n=this;Ze(e)&&(t=this.get(10),e.forEach((function(e){var o=e.conversationID.replace(S.CONV_GROUP,"");St(o)&&t.updateUnreadCountAndLastMsg(o,e.lastMessage),n.groupMap.has(o)&&(n.groupMap.get(o).nextMessageSeq=e.lastMessage.sequence+1)})))}},{key:"onNewGroupTips",value:function(e){this._groupTipsHandler.onNewGroupTips(e)}},{key:"onMsgRevoked",value:function(e){this._commonGroupHandler.onMsgRevoked(e,!(1<arguments.length&&void 0!==arguments[1])||arguments[1])}},{key:"onNewGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.onNewGroupSystemNotice(e)}},{key:"onMsgReadNotice",value:function(e){var t=this;e.dataList.forEach((function(e){var n;e=e.elements.groupMessageReadNotice,pt(e)||(n=t.get(11),e.forEach((function(e){var o=e.groupID,a=void 0===(a=e.topicID)?void 0:a,i=(e=e.lastMessageSeq,Re.l("".concat(t._n,".onMsgReadNotice groupID:").concat(o," lastMessageSeq:").concat(e)),o="".concat(S.CONV_GROUP).concat(o),!0);He(a)||(o="".concat(S.CONV_GROUP).concat(a),i=!1),n.updateIsReadAfterReadReport({conversationID:o,lastMessageSeq:e}),n.updateUnreadCount(o,i),n.clearGroupAtInfoList(o,i)})))}))}},{key:"onReadReceiptList",value:function(e){var t=this;Re.l("".concat(this._n,".onReadReceiptList options:"),e),e.dataList.forEach((function(e){var n=e.groupProfile,o=(e=e.elements,n=n.groupID,t.get(11));e=e.readReceiptList,o.updateReadReceiptInfo({groupID:n,readReceiptList:e})}))}},{key:"onMsgModified",value:function(e){Re.l("".concat(this._n,".onMsgModified options:"),e);var n=this.get(11);e.dataList.forEach((function(e){n.onMessageModified(t(t({},e),{},{conversationType:S.CONV_GROUP,to:e.topicID||e.groupID}))}))}},{key:"deleteGroupSystemNotice",value:function(e){this._groupSystemNoticeHandler.deleteGroupSystemNotice(e)}},{key:"initGroupMap",value:function(e){this.groupMap.set(e.groupID,new da(e))}},{key:"clearGroupMap",value:function(){this.groupMap.clear()}},{key:"deleteGroup",value:function(e){this.groupMap.delete(e)}},{key:"updateGroupMap",value:function(e){var t,n=this,o=this.get(11);e.forEach((function(e){t=e.groupID,n.groupMap.has(t)?n.groupMap.get(t).updateGroup(e):(n.groupMap.set(t,new da(e)),o.deleteGroupRoamingInfo(t))}));var a,i=this.getMyUserID(),r=E(this.groupMap);try{for(r.s();!(a=r.n()).done;){var s=m(a.value,2)[1];s.selfInfo.userID=i,"Owner"===s.selfInfo.role&&(s.ownerID=i)}}catch(l){r.e(l)}finally{r.f()}}},{key:"getGroupMap",value:function(){return this.groupMap}},{key:"getLocalGroupList",value:function(){return v(this.groupMap.values()).filter((function(e){return e.type!==S.GRP_ROOM&&e.type!==S.GRP_LIVE}))}},{key:"getLocalGroupProfile",value:function(e){return this.groupMap.get(e)}},{key:"sortLocalGroupList",value:function(){var e=v(this.groupMap).filter((function(e){return(e=m(e,2))[0],!He(e[1].lastMessage)}));e.sort((function(e,t){return t[1].lastMessage.lastTime-e[1].lastMessage.lastTime})),this.groupMap=new Map(v(e))}},{key:"updateGroupLastMessage",value:function(e){this._commonGroupHandler.updateLastMsg(e)}},{key:"emitGroupListUpdate",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n=this.getLocalGroupList();e&&this.emitOEvt(T.GROUP_LIST_UPDATED),t&&(e=JSON.parse(JSON.stringify(n)),this.get(11).updateConvGroupProfile(e))}},{key:"getMyNameCardByGroupID",value:function(e){return(e=this.getLocalGroupProfile(e))?e.selfInfo.nameCard:""}},{key:"isPagingGetCompleted",value:function(){return this._commonGroupHandler.isPagingGetCompleted()}},{key:"getMsgRemindType",value:function(e){var t=this;return Ze(e)&&0!==e.length?0===(e=e.filter((function(e){return!Et(t.getLocalGroupProfile(e).type)}))).length?Promise.resolve():(Re.l("".concat(this._n,".getMsgRemindType groupIDList:").concat(e)),this.getGroupProfileAdvance({groupIDList:e,responseFilter:{memberInfoFilter:["MsgFlag"]}}).then((function(e){e=e.data.successGroupList;var n=t.get(11);e.forEach((function(e){n.onGroupMsgRemindTypeUpdated({groupID:e.groupID,messageRemindType:Ze(e.members)?e.members[0].messageRemindType:""})}))}))):Promise.resolve()}},{key:"getGroupList",value:function(){return this._commonGroupHandler.getGroupList()}},{key:"syncCommunityWithTopic",value:function(){return this._commonGroupHandler.syncGroupList(!0)}},{key:"getGroupProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getGroupProfile"),o=new io("getGroupProfile"),a=e.groupID,i=e.groupCustomFieldFilter;return Re.l("".concat(n," groupID:").concat(a)),i={groupIDList:[a],responseFilter:{groupBaseInfoFilter:v(x),groupCustomFieldFilter:i,memberInfoFilter:[].concat(v(V),["NameCard"])}},this.getGroupProfileAdvance(i).then((function(e){var i=(e=e.data).successGroupList;return e=e.failureGroupList,Re.l("".concat(n," ok")),0<e.length?Mn(e[0]):((e=Et(i[0].type)&&!t.hasLocalGroup(a)?new da(i[0]):(t.updateGroupMap(i),t.getLocalGroupProfile(a))).isSupportTopic||t.get(11).updateConvGroupProfile([e]),o.setMessage("groupID:".concat(a," type:").concat(e.type," muteAllMembers:").concat(e.muteAllMembers," ownerID:").concat(e.ownerID)).end(),Tn({group:e}))})).catch((function(t){return o.setError(t).setMessage("groupID:".concat(e.groupID)).end(),Re.e("".concat(n," failed. error:"),t),Mn(t)}))}},{key:"getGroupProfileAdvance",value:function(e){var n,o="".concat(this._n,".getGroupProfileAdvance"),a=(Ze(r=e.groupIDList)&&50<r.length&&(this.warn("GetGroupProfileLimit"),r.length=50),[]),i=[],r=(r.forEach((function(e){(Tt({groupID:e})?i:a).push(e)})),[]);return 0<a.length&&(n=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:a})),r.push(n)),0<i.length&&(n=this._getGroupProfileAdvance(t(t({},e),{},{groupIDList:i,relayFlag:0<a.length})),r.push(n)),Promise.all(r).then((function(e){var t=[],n=[];return e.forEach((function(e){t.push.apply(t,v(e.successGroupList)),n.push.apply(n,v(e.failureGroupList))})),Tn({successGroupList:t,failureGroupList:n})})).catch((function(e){return Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"_getGroupProfileAdvance",value:function(e){var t=this,n=e.relayFlag,o=void 0!==n&&n,a=h(e,ba);return this.req({P:jn.GET_GRP_PROFILE,data:a}).then((function(e){return Re.l("".concat(t._n,"._getGroupProfileAdvance ok. options:"),a),{successGroupList:(e=e.data.groups).filter((function(e){return pt(e.errorCode)||0===e.errorCode})),failureGroupList:e.filter((function(e){return e.errorCode&&0!==e.errorCode})).map((function(e){return new Fn({code:e.errorCode,message:e.errorInfo,data:{groupID:e.groupID}})}))}})).catch((function(t){return o&&Tt({groupID:e.groupIDList[0]})?{successGroupList:[],failureGroupList:[]}:Mn(t)}))}},{key:"createGroup",value:function(e){var n=this,o=[S.GRP_PUBLIC,S.GRP_WORK,S.GRP_MEETING,S.GRP_AVCHATROOM,S.GRP_COMMUNITY],a="".concat(this._n,".").concat("createGroup"),i=e.type,r=e.groupID;if(e.name&&!1===this._filterProfanity("name",e))return Mn({code:zn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return Mn({code:zn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return Mn({code:zn.PROFANITY_FOUND});if(!o.includes(i))return Mn({code:zn.ILLEGAL_GRP_TYPE});if(!Tt({type:i})){if(!He(r)&&Tt({groupID:r}))return Mn({code:zn.ILLEGAL_GRP_ID});e.isSupportTopic=void 0}if(Et(i)&&!pt(e.memberList)&&0<e.memberList.length&&(e.memberList=void 0),this._canIUseJoinOption(i)||pt(e.joinOption)||(e.joinOption=void 0),Tt({type:i})){if(!He(r)&&!Tt({groupID:r}))return Mn({code:zn.ILLEGAL_GRP_ID});e.isSupportTopic=!0===e.isSupportTopic?1:0}var s=new io("createGroup"),l=(Re.l("".concat(a," options:"),e),null),c=[];return this.req({P:jn.CREATE_GRP,data:t(t({},e),{},{ownerID:this.getMyUserID(),webPushFlag:1})}).then((function(o){var i=(o=o.data).groupID,r=void 0===(o=o.overLimitUserIDList)?[]:o;if(l=i,c=r,o="groupType:".concat(e.type," groupID:").concat(i," overLimitUserIDList:").concat(r),s.setMessage(o).end(),Re.l("".concat(a," ok. ").concat(o)),e.type===S.GRP_AVCHATROOM)return n.getGroupProfile({groupID:i});if(e.type===S.GRP_COMMUNITY&&1===e.isSupportTopic)return n.getGroupProfile({groupID:i});He(e.memberList)||He(r)||(e.memberList=e.memberList.filter((function(e){return-1===r.indexOf(e.userID)}))),n.updateGroupMap([t(t({},e),{},{groupID:i})]),o=n.get(2);var u="",d=0,p=(e.type===S.GRP_COMMUNITY?(u=n.isIntl()?"Create Community":"创建社群",d=1):u=n.isIntl()?"Create Group":"创建群组",n.get(4).getMyNick());return u=o.createCustomMessage({to:i,conversationType:S.CONV_GROUP,payload:{data:JSON.stringify({businessID:"group_create",content:u,cmd:d,opUser:p||n.getMyUserID(),version:4})}}),o.sendMessageInstance(u),n.emitGroupListUpdate(),n.getGroupProfile({groupID:i})})).then((function(e){var t=(n=(e=e.data.group).selfInfo).nameCard,n=n.joinTime;return e.updateSelfInfo({nameCard:t,joinTime:n,messageRemindType:S.MSG_REMIND_ACPT_AND_NOTE,role:S.GRP_MBR_ROLE_OWNER}),Tn({group:e,overLimitUserIDList:c})})).catch((function(o){var i;return s.setMessage("groupType:".concat(e.type)).setError(o).end(),10010===o.code||10007===o.code?(n._silentlyGetGroupProfile(o.code,l),n.updateGroupMap([t(t({},e),{},{groupID:l})]),(i=n.getLocalGroupProfile(l)).selfInfo.role=S.GRP_MBR_ROLE_OWNER,Tn({group:i,overLimitUserIDList:c})):(Re.e("".concat(a," failed. error:"),o),Mn(o))}))}},{key:"dismissGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("dismissGroup"),o="groupID:".concat(e),a=new io("dismissGroup");return a.setMessage(o),Re.l("".concat(n," ").concat(o)),this.req({P:jn.DISMISS_GRP,data:{groupID:e}}).then((function(){return a.end(),Re.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),t.checkJoinedAVChatRoomByID(e)&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),Tn({groupID:e})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"updateGroupProfile",value:function(e){var t,n=this,o="".concat(this._n,".").concat("updateGroupProfile");if(this.hasLocalGroup(e.groupID)&&(t=this.getLocalGroupProfile(e.groupID).type,this._canIUseJoinOption(t)||pt(e.joinOption)||(Re.w("".concat(o," joinOption is unavailable for Work/Meeting/AVChatRoom")),e.joinOption=void 0)),pt(e.muteAllMembers)||(e.muteAllMembers?e.muteAllMembers="On":e.muteAllMembers="Off"),e.name&&!1===this._filterProfanity("name",e))return Mn({code:zn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return Mn({code:zn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return Mn({code:zn.PROFANITY_FOUND});var a=new io("updateGroupProfile");return a.setMessage(JSON.stringify(e)),Re.l("".concat(o," groupID:").concat(e.groupID)),this.req({P:jn.UPDATE_GRP_PROFILE,data:e}).then((function(){return a.end(),Re.l("".concat(o," ok")),n.hasLocalGroup(e.groupID)&&n.groupMap.get(e.groupID).updateGroup(e),Tn({group:n.groupMap.get(e.groupID)})})).catch((function(e){return a.setError(e).end(),Re.l("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"_filterProfanity",value:function(e,t){if(!(o=this.get(29)))return!0;var n=(o=o.filterText(t[e],U)).isAllowedToSend,o=o.modifiedText;return!0===n&&(t[e]=o,!0)}},{key:"joinGroup",value:function(e){var t=this,n=e.groupID,o="".concat(this._n,".joinGroup");if(this.deleteUnjoinedAVChatRoom(n),this.hasLocalGroup(n)){if(!this.isLoggedIn())return Sn({status:S.JOIN_STATUS_ALREADY_IN_GROUP});var a=new io("applyJoinGroup");return this.getGroupProfile({groupID:n}).then((function(){return a.setMessage("groupID:".concat(n," joinedStatus:").concat(S.JOIN_STATUS_ALREADY_IN_GROUP)).end(),Sn({status:S.JOIN_STATUS_ALREADY_IN_GROUP})})).catch((function(i){return a.setMessage("groupID:".concat(n," unjoined")).end(),Re.w("".concat(o," ").concat(n," was unjoined, now join!")),t.groupMap.delete(n),t.applyJoinGroup(e)}))}return Re.l("".concat(o," groupID:").concat(n)),this.isLoggedIn()?this.applyJoinGroup(e):this._AVChatRoomHandler.joinWithoutAuth(e)}},{key:"applyJoinGroup",value:function(e){var n=this,o="".concat(this._n,".").concat("applyJoinGroup"),a=e.groupID;if(!He(e.applyMessage)&&!1===this._filterProfanity("applyMessage",e))return Mn({code:zn.PROFANITY_FOUND});var i=new io("applyJoinGroup"),r=(e=t({},e),this.canIUse(P.AV_HISTORY_MSG));return r&&(e.historyMessageFlag=1),this.get(11).deleteTopicRoamingInfo(a),this.req({P:jn.APPLY_JOIN_GRP,data:e}).then((function(e){var t=(e=e.data).joinedStatus,s=e.longPollingKey,l=e.startSeq,c=e.avChatRoomFlag,u=e.avChatRoomKey,d=e.messageList;switch(e="groupID:".concat(a," joinedStatus:").concat(t," longPollingKey:").concat(s," startSeq:").concat(l)+" avChatRoomFlag:".concat(c," canGetAVChatRoomHistoryMsg:").concat(r,",")+" historyMsgCount:".concat(He(d)?0:d.length),i.setMessage(e).end(),Re.l("".concat(o," ok. ").concat(e)),t){case Be:return Tn({status:Be});case Ve:return n.getGroupProfile({groupID:a}).then((function(e){return e=e.data.group,n._handleJoinResult({group:e,avChatRoomFlag:c,longPollingKey:s,startSeq:l,avChatRoomKey:u,messageList:d})})).catch((function(e){var t;return 10010===e.code||10007===e.code?(n._silentlyGetGroupProfile(e.code,a),t=new da({groupID:a}),n.updateGroupMap([t]),n._handleJoinResult({group:t,avChatRoomFlag:c,longPollingKey:s,startSeq:l,avChatRoomKey:u,messageList:d})):(Re.e("".concat(o," failed. error:"),e),Mn(e))}));default:var p=new Fn({code:zn.JOIN_GRP_FAIL});return Re.e("".concat(o," failed. error:"),p),Mn(p)}})).catch((function(e){return i.setMessage("groupID:".concat(a)).setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"_handleJoinResult",value:function(e){var t=this,n=e.group,o=e.avChatRoomFlag,a=e.longPollingKey,i=e.startSeq,r=e.avChatRoomKey,s=e.messageList,l=n.groupID;return 1===o?(this.get(11).setCompleted("".concat(S.CONV_GROUP).concat(l)),this._groupAttributesHandler.initGroupAttributesCache({groupID:l,avChatRoomKey:r}),this._groupCountersHandler.initGroupCountersCache({groupID:l,avChatRoomKey:r}),(e=pt(a)?this._AVChatRoomHandler.handleJoinResult({group:n}):this._AVChatRoomHandler.startRunLoop({group:n,longPollingKey:a,startSeq:i})).then((function(){t._onAVChatRoomHistoryMessage(s,l)})),e):(this.emitGroupListUpdate(!0,!1),Tn({status:Ve,group:n}))}},{key:"quitGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("quitGroup"),o="groupID:".concat(e),a=(Re.l("".concat(n," ").concat(o)),this.checkJoinedAVChatRoomByID(e));if(!a&&!this.hasLocalGroup(e))return Mn({code:zn.MEMBER_NOT_IN_GRP});if(a&&!this.isLoggedIn())return Re.l("".concat(n," anonymously ok. ").concat(o)),this.deleteLocalGroupAndConversation(e),this._AVChatRoomHandler.reset(e),Sn({groupID:e});var i=new io("quitGroup");return i.setMessage(o),this.req({P:jn.QUIT_GRP,data:{groupID:e}}).then((function(){return i.end(),Re.l("".concat(n," ok")),t.deleteLocalGroupAndConversation(e),a&&t._AVChatRoomHandler.reset(e),t._groupAttributesHandler.deleteLocalGroupAttributes(e),Tn({groupID:e})})).catch((function(e){return i.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"searchGroupByID",value:function(e){var t="".concat(this._n,".").concat("searchGroupByID"),n={groupIDList:[e]},o=new io("searchGroupByID");return o.setMessage("groupID:".concat(e)),Re.l("".concat(t," groupID:").concat(e)),this.req({P:jn.SEARCH_GRP,data:n}).then((function(e){if(0!==(e=e.data.groupProfile)[0].errorCode)throw new Fn({code:e[0].errorCode,message:e[0].errorInfo});return o.end(),Re.l("".concat(t," ok")),Tn({group:new da(e[0])})})).catch((function(e){return o.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"changeGroupOwner",value:function(e){var t=this,n="".concat(this._n,".").concat("changeGroupOwner");if(this.hasLocalGroup(e.groupID)&&this.getLocalGroupProfile(e.groupID).type===S.GRP_AVCHATROOM)return Mn({code:zn.CANNOT_CHANGE_OWNER_IN_AV});if(e.newOwnerID===this.getMyUserID())return Mn({code:zn.CANNOT_CHANGE_OWNER_TO_SELF});var o=new io("changeGroupOwner");return o.setMessage("groupID:".concat(e.groupID," newOwnerID:").concat(e.newOwnerID)),Re.l("".concat(n," groupID:").concat(e.groupID)),this.req({P:jn.CHANGE_GRP_OWNER,data:e}).then((function(){o.end(),Re.l("".concat(n," ok"));var a,i=e.groupID,r=e.newOwnerID,s=(t.groupMap.get(i).ownerID=r,t._groupMemberHandler.getLocalGroupMemberList(i));return s instanceof Map&&(a=s.get(t.getMyUserID()),pt(a)||(a.updateRole("Member"),t.groupMap.get(i).selfInfo.role="Member"),a=s.get(r),pt(a)||a.updateRole("Owner")),t.emitGroupListUpdate(!0,!1),Tn({group:t.groupMap.get(i)})})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"getGroupApplicationList",value:function(){return this._groupSystemNoticeHandler.getGroupApplicationList()}},{key:"handleGroupApplication",value:function(e){var t,n,o,a,i,r=this,s="".concat(this._n,".").concat("handleGroupApplication"),l=e.handleAction,c=e.handleMessage,u=e.message,d=e.application,p=(u?(t=u.payload.operatorID,n=u.payload.groupProfile.groupID,o=u.payload.authentication,a=u.payload.messageKey):d&&(t=d.applicant,n=d.groupID,o=d.authentication,a=d.messageKey),jn.HANDLE_GRP_APPLICATION),h=(d&&2===d.applicationType&&(p=jn.HANDLE_INVITE_JOIN_GRP,i=d.userID),new io("handleGroupApplication"));return h.setMessage("groupID:".concat(n)),Re.l("".concat(s," groupID:").concat(n)),this.req({P:p,data:{handleAction:l,handleMessage:c,applicant:t,invitee:i,groupID:n,authentication:o,messageKey:a}}).then((function(){return h.end(),Re.l("".concat(s," ok")),u&&r._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),Tn({group:r.getLocalGroupProfile(n)})})).catch((function(e){return h.setError(e).end(),Re.e("".concat(s," failed. error"),e),Mn(e)}))}},{key:"handleGroupInvitation",value:function(e){var n=this,o="".concat(this._n,".").concat("handleGroupInvitation"),a=(s=e.message.payload).groupProfile.groupID,i=s.authentication,r=s.messageKey,s=s.operatorID,l=e.handleAction,c=new io("handleGroupInvitation");return c.setMessage("groupID:".concat(a," inviter:").concat(s," handleAction:").concat(l)),Re.l("".concat(o," groupID:").concat(a," inviter:").concat(s," handleAction:").concat(l)),this.req({P:jn.HANDLE_GRP_INVITATION,data:t(t({},e),{},{inviter:s,groupID:a,authentication:i,messageKey:r})}).then((function(){return c.end(),Re.l("".concat(o," ok")),n._groupSystemNoticeHandler.deleteGroupSystemNotice({messageList:[e.message]}),Tn({group:n.getLocalGroupProfile(a)})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(o," failed. error"),e),Mn(e)}))}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this,n="".concat(this._n,".getGroupOnlineMemberCount"),o=this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e),a=this.hasLocalGroup(e);if(Re.l("".concat(n," groupID:").concat(e," isAVChatRoom:").concat(o," has:").concat(a)),o)return this._AVChatRoomHandler.getGroupOnlineMemberCount(e);if(!a)return Sn({memberCount:0});if(o=Date.now(),this._onlineMemberCountMap.has(e)){if(o-(a=this._onlineMemberCountMap.get(e)).lastReqTime<=6e4)return Sn({memberCount:a.memberCount});a.lastReqTime=o}return this.requestOnlineCount(e).then((function(o){return o=void 0===(o=o.data.memberCount)?0:o,t._onlineMemberCountMap.set(e,{lastReqTime:Date.now(),memberCount:o}),Re.l("".concat(n," ok. groupID:").concat(e," memberCount:").concat(o)),Sn({memberCount:o})})).catch((function(e){return Re.w("".concat(n," failed. error:"),e),Promise.reject(e)}))}},{key:"requestOnlineCount",value:function(e){return this.req({P:jn.GET_ONLINE_MBR_NUM,data:{groupID:e}})}},{key:"hasLocalGroup",value:function(e){return this.groupMap.has(e)}},{key:"deleteLocalGroupAndConversation",value:function(e){var t,n=this.checkJoinedAVChatRoomByID(e),o=(Re.l("".concat(this._n,".deleteLocalGroupAndConversation groupID:").concat(e," isJoinedAVChatRoom:").concat(n)),this.get(11)),a="".concat(S.CONV_GROUP).concat(e);n&&(this.stopMessageLongPolling({groupID:e}),o.deleteLocalConv(a)),Tt({groupID:e})&&(t=this.getLocalGroupProfile(e))&&!0===t.isSupportTopic&&this.get(10).deleteTopicListInCommunity(e),o.clearUnreadCount(a),o.setCompleted(a),this._deleteLocalGroup(e),this._onlineMemberCountMap.delete(e),this.emitGroupListUpdate(!0,!1)}},{key:"_deleteLocalGroup",value:function(e){this.groupMap.delete(e),this._groupMemberHandler.deleteGroupMemberList(e)}},{key:"sendMessage",value:function(e,t){return Ze(e._receiverList)&&0<e._receiverList.length&&!this.canIUse(P.MSG_TO_SPECIFIED_GRP_MBR)?this.noUse("Targeted Group Message"):(e=this.createGroupMessagePack(e,t),this.req(e))}},{key:"createGroupMessagePack",value:function(e,t){var n=null,o=(t&&t.offlinePushInfo&&(n=t.offlinePushInfo),""),a=(dt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(o=e.cloudCustomData),[]),i=void(We(t)&&We(t.messageControlInfo)&&(i=(s=t.messageControlInfo).excludedFromUnreadCount,r=s.excludedFromLastMessage,s=s.excludedFromContentModeration,!0===i&&a.push("NoUnread"),!0===r&&a.push("NoLastMsg"),!0===s&&a.push("NoMsgCheck"))),r=(Ze(e._receiverList)&&0<e._receiverList.length&&(i=e._receiverList,50<e._receiverList.length&&(i=e._receiverList.slice(0,50),this.warn("ReceiverListLimit"))),this.isOnlineMessage(e,t)?1:0),s=JSON.parse(JSON.stringify(e.getElements())),l=this.get(17).getFileDNList(),c=e.getGroupAtInfoList();return s={fromAccount:this.getMyUserID(),groupID:e.to,msgBody:ho(e.type,s,l),cloudCustomData:o,random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:e.type!==S.MSG_TEXT||He(c)?void 0:c,onlineOnlyFlag:r,clientTime:e.clientTime,offlinePushInfo:jo(n),messageControlInfo:0==r?a:void 0,needReadReceipt:!0!==e.needReadReceipt||this.isMessageFromOrToAVChatroom(e.to)?0:1,receiverList:i,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0,cmConfigID:e._cmConfigID,forbidCallbackControl:Ct(t)},St(e.to)&&(s.groupID=Gt(e.to),s.topicID=e.to),{P:jn.SEND_GRP_MSG,data:s}}},{key:"revokeMessage",value:function(e){var t={groupID:e.to,msgSeqList:[{msgSeq:e.sequence}]};return St(e.to)&&(t.groupID=Gt(e.to),t.topicID=e.to),this.req({P:jn.REVOKE_GRP_MSG,data:t})}},{key:"deleteMessage",value:function(e){var t=e.to;return e=e.keyList,Re.l("".concat(this._n,".deleteMessage groupID:").concat(t," count:").concat(e.length)),e={groupID:t,deleter:this.getMyUserID(),keyList:e},St(t)&&(e.groupID=Gt(t),e.topicID=t),this.req({P:jn.DEL_GRP_MSG,data:e})}},{key:"modifyRemoteMessage",value:function(e){var t=e.to,n=e.sequence,o=e.payload,a=e.type,i=void 0===(i=e.version)?0:i,r=e.cloudCustomData,s=(e=e._elements,t),l=void 0;return t=void(St(t)&&(s=Gt(t),l=t)),zt(a)&&(1<e.length&&e.splice(0,1,{type:a,content:o}),t=e),this.req({P:jn.MODIFY_GRP_MSG,data:{groupID:s,topicID:l,sequence:n,version:i,elements:t,cloudCustomData:r}})}},{key:"getRoamingMessage",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessage"),o=e.conversationID,a=e.groupID,i=(e=e.sequence,new io("getRoamingMessage")),r=0,s=void 0;return St(a)&&(a=Gt(s=a)),this._computeLastSequence({groupID:a,topicID:s,sequence:e}).then((function(e){return r=e,Re.l("".concat(n," groupID:").concat(a," startSequence:").concat(r)),t.req({P:jn.GET_GRP_ROAMING_MSG,data:{groupID:a,count:21,sequence:r,topicID:s}})})).then((function(e){var l=(u=e.data).messageList,c=u.complete,u=void 0===(u=u.invisibleSequenceList)?[]:u,d=(e=void 0===(e=e.data.nextSequence)?0:e,pt(l)?Re.l("".concat(n," ok. complete:").concat(c," nextSequence:").concat(e," but messageList is undefined!")):Re.l("".concat(n," ok. complete:").concat(c," nextSequence:").concat(e," count:").concat(l.length)),i.setMessage("groupID:".concat(a," topicID:").concat(s," startSequence:").concat(r," complete:").concat(c," nextSequence:").concat(e)).end(),t.get(11)),p=[],h=[];return He(l)||(p=d.onRoamingMessage(l,o,!0,h),d.updateIsRead(o),d.patchConvLastMessage(o)),(l=2===c||e<1)&&(d.setCompleted(o),e=""),Re.l("".concat(n," isPullingCompleted:").concat(l," nextReqID:").concat(e," storedMsgCount:").concat(p.length)+" invisibleSeqCount:".concat(u.length)),{nextReqID:e+"",storedMessageList:p,assembledMessageList:h,isPullingCompleted:l}})).catch((function(e){return i.setError(e).setMessage("groupID:".concat(a," topicID:").concat(s," startSequence:").concat(r)).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"_getGroupIDOfMessage",value:function(e){return e.conversationID.replace(S.CONV_GROUP,"")}},{key:"getReadReceiptList",value:function(e){var t="".concat(this._n,".").concat("getReadReceiptList"),n=this._getGroupIDOfMessage(e[0]),o=this.getMyUserID(),a=e.filter((function(e){return e.from===o&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}));if(Re.l("".concat(t," groupID:").concat(n," sequenceList:").concat(JSON.stringify(a))),0===a.length)return Sn({messageList:e});var i=new io("getReadReceiptList");return i.setMessage("groupID:".concat(n)),this.req({P:jn.GET_READ_RECEIPT,data:{groupID:n,sequenceList:a}}).then((function(n){return i.end(),Re.l("".concat(t," ok")),Ze(n=n.data.readReceiptList)&&n.forEach((function(t){e.forEach((function(e){0===t.code&&t.sequence===e.sequence&&(e.readReceiptInfo.readCount=t.readCount,e.readReceiptInfo.unreadCount=t.unreadCount)}))})),Tn({messageList:e})})).catch((function(e){return i.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"sendReadReceipt",value:function(e){var t="".concat(this._n,".").concat("sendReadReceipt"),n=this._getGroupIDOfMessage(e[0]),o=new io("sendReadReceipt"),a=(o.setMessage("groupID:".concat(n)),this.getMyUserID());return 0===(e=e.filter((function(e){return e.from!==a&&!0===e.needReadReceipt})).map((function(e){return{sequence:e.sequence}}))).length?Mn({code:zn.READ_RECEIPT_MSG_LIST_EMPTY}):(Re.l("".concat(t,". sequenceList:").concat(JSON.stringify(e))),this.req({P:jn.SEND_READ_RECEIPT,data:{groupID:n,sequenceList:e}}).then((function(e){return o.end(),Re.l("".concat(t," ok")),Tn()})).catch((function(e){return o.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)})))}},{key:"getReadReceiptDetail",value:function(e){var t=this,n=e.message,o=e.filter,a=e.cursor,i=(e=e.count,this._getGroupIDOfMessage(n)),r=n.ID,s=(n=n.sequence,"".concat(this._n,".").concat("getReadReceiptDetail")),l=this._receiptDetailCompleteMap.get(r)||!1,c=0!==o&&1!==o?0:o,u=(o=dt(a)?a:"",a=!Ye(e)||e<=0||100<=e?100:e,e="groupID:".concat(i," sequence:").concat(n," cursor:").concat(o," filter:").concat(c," completeFlag:").concat(l),Re.l("".concat(s," ").concat(e)),{cursor:"",isCompleted:!1,messageID:r,unreadUserIDList:[],readUserIDList:[]}),d=new io("getReadReceiptDetail");return d.setMessage(e),this.req({P:jn.GET_READ_RECEIPT_DETAIL,data:{groupID:i,sequence:n,flag:c,cursor:o,count:a}}).then((function(e){d.end();var n=(e=e.data).cursor,o=e.isCompleted,a=e.unreadUserIDList;return e=e.readUserIDList,u.cursor=n,1===o&&(u.isCompleted=!0,t._receiptDetailCompleteMap.set(r,!0)),0===c?u.readUserIDList=e.map((function(e){return e.userID})):1===c&&(u.unreadUserIDList=a.map((function(e){return e.userID}))),Re.l("".concat(s," ok")),Tn(u)})).catch((function(e){return d.setError(e).end(),Re.w("".concat(s," failed. error:"),e),Mn(e)}))}},{key:"getRoamingMessagesHopping",value:function(e){var t=this,n="".concat(this._n,".").concat("getRoamingMessagesHopping"),o=e.groupID,a=e.count,i=e.sequence,r=e.direction,s=void 0;return pt(i)&&1===r?Sn({messageList:[],isCompleted:!0,nextMessageSeq:""}):(St(o)&&(o=Gt(s=o)),this._computeReqSeqHopping({groupID:o,topicID:s,sequence:i}).then((function(l){pt(i)||1!==r||(l=i+a-1);var c="".concat(s?"topicID:".concat(s):"groupID:".concat(o)," sequence:").concat(i," reqSeq:").concat(l," direction:").concat(r),u=(Re.l("".concat(n," ").concat(c)),new io("getRoamingMessagesHopping"));return t.req({P:jn.GET_GRP_ROAMING_MSG,data:{groupID:o,topicID:s,count:a,sequence:l}}).then((function(o){var a=void 0===(a=(o=o.data).messageList)?[]:a,s=o.complete,l=void 0===(l=o.nextSequence)?0:l,d=(o=void 0===(o=o.invisibleSequenceList)?[]:o,"complete:".concat(s," nextSequence:").concat(l," remoteMsgCount:").concat(a.length," invisibleSequenceList:").concat(o)),p=(u.setMessage("".concat(c," ").concat(d)).end(),Re.l("".concat(n," ok. ").concat(d)),d="".concat(S.CONV_GROUP).concat(e.groupID),t.get(11));return d=p.onRoamingMessage(a,d,!1),a=t._computeResult({groupID:e.groupID,direction:r,sequence:i,remoteMessageList:a,processedMessageList:d,complete:s,nextSequence:l,invisibleSequenceList:o}),p.storeHoppingMessageList(a.messageList),Tn(a)})).catch((function(e){return u.setError(e).setMessage("groupID:".concat(o," sequence:").concat(i," count:").concat(a)).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))})))}},{key:"_computeReqSeqHopping",value:function(e){var t=this,n=e.groupID,o=void 0===(o=e.topicID)?void 0:o;return 0<(e=void 0===(e=e.sequence)?void 0:e)?Promise.resolve(e):pt(o)?this.getGroupProfileAdvance({groupIDList:[n],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then((function(e){var o=0;return He(e=e.data.successGroupList)||(o=e[0].nextMessageSeq-1),Re.l("".concat(t._n,"._computeReqSeqHopping groupID:").concat(n," lastSequence:").concat(o," from remote")),o})).catch((function(e){return Mn(e)})):Promise.resolve(0)}},{key:"_computeResult",value:function(e){var t={messageList:[],isCompleted:!1,nextMessageSeq:""},n=e.groupID,o=e.direction,a=e.sequence,i=void 0===(i=e.remoteMessageList)?[]:i,r=void 0===(r=e.processedMessageList)?[]:r,s=e.complete,l=e.nextSequence;if(e=e.invisibleSequenceList,0===o)return t.nextMessageSeq=l,(2===s||l<1)&&(t.isCompleted=!0,t.nextMessageSeq=""),t.messageList=r,t;if(1===o){if(He(i)){if(He(e))return t.isCompleted=!0,t.nextMessageSeq="",t;t.nextMessageSeq=e[0]+1}else s=i[0].sequence,l=e[0]||0,t.nextMessageSeq=l<s?s+1:l+1;return r.forEach((function(e){e.sequence>=a&&t.messageList.push(e)})),(Tt({groupID:n})||St(n))&&0===t.messageList.length&&i[0].sequence<a&&(t.isCompleted=!0,t.nextMessageSeq=""),t}}},{key:"setMessageRead",value:function(e){var t=this,n=e.conversationID,o=e.lastMessageSeq,a="".concat(this._n,".").concat("setMessageRead"),i=(e="convID:".concat(n," lastMessageSeq:").concat(o),Re.l("".concat(a," ").concat(e)),Ye(o)||this.warn("DoNotModifyLastSeq"),new io("setMessageRead")),r=(i.setMessage(e),n.replace(S.CONV_GROUP,"")),s=void 0;return St(r)&&(r=Gt(s=r)),this.req({P:jn.SET_GRP_MSG_READ,data:{groupID:r,topicID:s,messageReadSeq:o}}).then((function(){i.end(),Re.l("".concat(a," ok"));var e,l=t.get(11),c=(l.updateIsReadAfterReadReport({conversationID:n,lastMessageSeq:o}),!0);return pt(s)||(c=!1,(e=t.get(10).getLocalTopic(r,s))&&e.updateSelfInfo({readedSequence:o})),l.updateUnreadCount(n,c),Tn()})).catch((function(e){return i.setError(e).end(),Re.l("".concat(a," failed. error:"),e),Mn(e)}))}},{key:"_computeLastSequence",value:function(e){var t=e.groupID,n=void 0===(n=e.topicID)?void 0:n;return 0<(e=e.sequence)?Promise.resolve(e):pt(n)?this.getGroupLastSequence(t):Promise.resolve(0)}},{key:"getGroupLastSequence",value:function(e){var t="".concat(this._n,".").concat("getGroupLastSequence"),n=new io("getGroupLastSequence"),o=0,a="",i="groupID:".concat(e);if(this.hasLocalGroup(e)){var r=this.getLocalGroupProfile(e),s=r.lastMessage;if(0<s.lastSequence&&!1===s.onlineOnlyFlag)return o=s.lastSequence,a="".concat(i,", ").concat(o," from group.lastMessage.lastSequence"),Re.l("".concat(t," ").concat(a)),n.setMessage(a).end(),Promise.resolve(o);if(1<r.nextMessageSeq)return o=r.nextMessageSeq-1,a="".concat(i,", ").concat(o," from group.nextMessageSeq"),Re.l("".concat(t," ").concat(a)),n.setMessage(a).end(),Promise.resolve(o)}return(s=this.get(11).getLocalConversation("GROUP".concat(e)))&&s.lastMessage.lastSequence&&!1===s.lastMessage.onlineOnlyFlag?(o=s.lastMessage.lastSequence,a="".concat(i,", ").concat(o," from conversation.lastMessage.lastSequence"),Re.l("".concat(t," ").concat(a)),n.setMessage(a).end(),Promise.resolve(o)):this.getGroupProfileAdvance({groupIDList:[e],responseFilter:{groupBaseInfoFilter:["NextMsgSeq"]}}).then((function(e){return He(e=e.data.successGroupList)?Re.w("".concat(t," ").concat(i,", empty successGroupList")):(o=e[0].nextMessageSeq-1,a="".concat(i,", ").concat(o," from remote"),Re.l("".concat(t," ").concat(a))),n.setMessage(a).end(),o})).catch((function(e){return n.setError(e).setMessage(i).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"isMessageFromOrToAVChatroom",value:function(e){return this._AVChatRoomHandler.checkJoinedAVChatRoomByID(e)}},{key:"hasJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.hasJoinedAVChatRoom()}},{key:"getJoinedAVChatRoom",value:function(){return this._AVChatRoomHandler.getJoinedAVChatRoom()}},{key:"getGroupRemoteLastSeq",value:function(e){return(e=this.getLocalGroupProfile(e))?e.nextMessageSeq-1:1}},{key:"isOnlineMessage",value:function(e,t){return!(!this._canIUseOnlineOnlyFlag(e)||!t||!0!==t.onlineUserOnly)}},{key:"_canIUseOnlineOnlyFlag",value:function(e){var t=this.getJoinedAVChatRoom();return!t||!t.includes(e.to)||e.conversationType!==S.CONV_GROUP}},{key:"_onAVChatRoomHistoryMessage",value:function(e,n){var o;He(e)||(Re.l("".concat(this._n,"._onAVChatRoomHistoryMessage groupID:").concat(n," count:").concat(e.length)),o=[],e.forEach((function(e){o.push(t(t({},e),{},{isHistoryMessage:1}))})),this.onAVChatRoomMessage(o,n))}},{key:"onAVChatRoomMessage",value:function(e){this._AVChatRoomHandler.onMessage(e,1<arguments.length&&void 0!==arguments[1]?arguments[1]:"")}},{key:"onAVChatRoomMemberBanned",value:function(e){this._AVChatRoomHandler.onAVChatRoomMemberBanned(e)}},{key:"setUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.set(e,1)}},{key:"deleteUnjoinedAVChatRoom",value:function(e){this._unjoinedAVChatRoomList.has(e)&&this._unjoinedAVChatRoomList.delete(e)}},{key:"isUnjoinedAVChatRoom",value:function(e){return this._unjoinedAVChatRoomList.has(e)}},{key:"isGroupAttributesUpdatedNotice",value:function(e){return this._groupAttributesHandler.isGroupAttributesUpdatedNotice(e)}},{key:"updateLocalMainSequenceOnReconnected",value:function(){this._groupAttributesHandler.updateLocalMainSequenceOnReconnected()}},{key:"initGroupAttributes",value:function(e){return this._groupAttributesHandler.initGroupAttributes(e)}},{key:"setGroupAttributes",value:function(e){return this._groupAttributesHandler.setGroupAttributes(e)}},{key:"deleteGroupAttributes",value:function(e){return this._groupAttributesHandler.deleteGroupAttributes(e)}},{key:"getGroupAttributes",value:function(e){return this._groupAttributesHandler.getGroupAttributes(e)}},{key:"isMessageFromTopic",value:function(e,t){return 2===e&&!He(t)}},{key:"isMessageFromCommunityOfTopic",value:function(e,t){return 2===e&&He(t)}},{key:"getMessageExtensions",value:function(e,t){return Re.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t)),this.req({P:jn.GET_GRP_MSG_EXT,data:{groupID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1;return Re.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),this.req({P:jn.MODIFY_GRP_MSG_EXT,data:{groupID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"_genNotifyReqList",value:function(e){for(var t,n,o,a,i=[],r=0,s=e.length;r<s;r++)t=e[r],a=this.getLocalGroupProfile(t).type,n=this._getGroupLastRevokedTime(t),o=1e3*we(),a={notifyType:1,limit:20,type:Tt({type:a,groupID:t})?S.GRP_COMMUNITY:void 0,groupID:t,beginTime:n,endTime:o},i.push(a);return i}},{key:"getNotice",value:function(e){var t=this,n="".concat(this._n,".getNotice");0!==(e=e.filter((function(e){if(!t.hasLocalGroup(e))return!1;var n=(e=t.getLocalGroupProfile(e)).type;return e=e.isSupportTopic,!Et(n)&&!e}))).length&&(Re.l("".concat(n," list:").concat(e)),this.req({P:jn.GET_GRP_NOTIFY,data:{notifyReqList:this._genNotifyReqList(e)}}).then((function(e){e=e.data.notifyRspList;var o,a,i=[];Ze(e)&&(o={dataList:[]},a="".concat(n," ok."),e.forEach((function(e){var n=e.nextRevokedTime,r=e.groupID,s=e.notifyList;a+=" groupID:".concat(r," nextRevokedTime:").concat(n," count:").concat(s.length,"\n"),o.dataList.push({elements:{revokedInfos:t._genRevokedInfos(e)}}),0!==n?(t._setGroupLastRevokedTime(r,n),i.push(r)):t._setGroupLastRevokedTime(r,1e3*we())})),Re.l(a),t.onMsgRevoked(o,!1)),0<i.length&&t.getNotice(i)})).catch((function(e){Re.e("".concat(n," failed. error:"),e)})))}},{key:"_genRevokedInfos",value:function(e){var n=e.notifyList,o=e.groupID,a=[];return Ze(n)&&n.forEach((function(e){a.push({groupID:o,sequence:e.sequence,random:e.random,revokerInfo:t({},e.revokerInfo)})})),a}},{key:"_getGroupLastRevokedTime",value:function(e){return this.hasLocalGroup(e)?this.getLocalGroupProfile(e)._lastRevokedTime:0}},{key:"_setGroupLastRevokedTime",value:function(e,t){this.hasLocalGroup(e)&&(this.getLocalGroupProfile(e)._lastRevokedTime=t)}},{key:"isGroupCountersNotice",value:function(e){return this._groupCountersHandler.isGroupCountersNotice(e)}},{key:"setGroupCounters",value:function(e){return this._groupCountersHandler.setGroupCounters(e)}},{key:"increaseGroupCounter",value:function(e){return this._groupCountersHandler.increaseGroupCounter(e)}},{key:"decreaseGroupCounter",value:function(e){return this._groupCountersHandler.decreaseGroupCounter(e)}},{key:"getGroupCounters",value:function(e){return this._groupCountersHandler.getGroupCounters(e)}},{key:"getGroupMemberHandler",value:function(){return this._groupMemberHandler}},{key:"getGroupMemberList",value:function(e){return this._groupMemberHandler.getGroupMemberList(e)}},{key:"getGroupMemberProfile",value:function(e){return this._groupMemberHandler.getGroupMemberProfile(e)}},{key:"addGroupMember",value:function(e){return this._groupMemberHandler.addGroupMember(e)}},{key:"deleteGroupMember",value:function(e){return this._groupMemberHandler.deleteGroupMember(e)}},{key:"setGroupMemberMuteTime",value:function(e){return this._groupMemberHandler.setGroupMemberMuteTime(e)}},{key:"setGroupMemberRole",value:function(e){return this._groupMemberHandler.setGroupMemberRole(e)}},{key:"setGroupMemberNameCard",value:function(e){return this._groupMemberHandler.setGroupMemberNameCard(e)}},{key:"setGroupMemberCustomField",value:function(e){return this._groupMemberHandler.setGroupMemberCustomField(e)}},{key:"markGroupMemberList",value:function(e){return this._groupMemberHandler.markGroupMemberList(e)}},{key:"modifyGroupMemberInfo",value:function(e){return this._groupMemberHandler.modifyGroupMemberInfo(e)}},{key:"restartPolling",value:function(){this._AVChatRoomHandler.restartPolling()}},{key:"getPollingTimerID",value:function(e){if(!e)return-1;var t=this.getLocalGroupProfile(e);return t&&Et(t.type)?this._AVChatRoomHandler.getPollingTimerID(e):-1}},{key:"_canIUseJoinOption",value:function(e){return e===S.GRP_PUBLIC||Tt({type:e})}},{key:"_silentlyGetGroupProfile",value:function(e,t){var n=setTimeout(this.getGroupProfile.bind(this,{groupID:t}),3e3);this._timeoutIDs.push(n),Re.l("".concat(this._n,"._silentlyGetGroupProfile errorCode:").concat(e," groupID:").concat(t," timeoutIDs:").concat(this._timeoutIDs))}},{key:"_clearTimeoutIDs",value:function(){this._timeoutIDs.forEach((function(e){e&&clearTimeout(e)})),this._timeoutIDs=[]}},{key:"startMessageLongPolling",value:function(e){var t=e.groupID,n=e.longPollingKey,o=(e=void 0===(e=e.longPollingSequence)?1:e,this.get(12).isUnlimitedAVChatRoom()),a=(this._AVChatRoomHandler.hasPollingInstance(t)&&this.stopMessageLongPolling({groupID:t}),this._AVChatRoomHandler.getJoinedLiveList());return!o&&0<a.length&&this.stopMessageLongPolling({groupID:a[0]}),o=new da({groupID:t,type:S.GRP_LIVE}),Re.l("".concat(this._n,".startMessageLongPolling groupID:").concat(t," longPollingKey:").concat(n," longPollingSequence:").concat(e)),this._AVChatRoomHandler.startRunLoop({group:o,longPollingKey:n,startSeq:e})}},{key:"stopMessageLongPolling",value:function(e){e=e.groupID;var t=this.get(11);return this._AVChatRoomHandler.reset(e),this._deleteLocalGroup(e),t.deleteLocalConv("".concat(S.CONV_GROUP).concat(e)),Re.l("".concat(this._n,".stopMessageLongPolling ok, groupID:").concat(e)),Sn({groupID:e})}},{key:"reset",value:function(){this.groupMap.clear(),this._unjoinedAVChatRoomList.clear(),this._receiptDetailCompleteMap.clear(),this._onlineMemberCountMap.clear(),this._commonGroupHandler.reset(),this._groupSystemNoticeHandler.reset(),this._groupTipsHandler.reset(),this._groupAttributesHandler.reset(),this._groupCountersHandler.reset(),this._AVChatRoomHandler.reset(),this._groupMemberHandler.reset(),this._clearTimeoutIDs()}}]),Wa),Na=["topicID","topicName","avatar","introduction","notification","unreadCount","muteAllMembers","customData","groupAtInfoList","nextMessageSeq","selfInfo"],Ra=(i($a,[{key:"_initTopic",value:function(e){for(var t in e)Na.indexOf(t)<0||("selfInfo"===t?this.updateSelfInfo(e[t]):this[t]="muteAllMembers"===t?1===e[t]:e[t])}},{key:"updateUnreadCount",value:function(){this.unreadCount=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0}},{key:"updateNextMessageSeq",value:function(e){this.nextMessageSeq=e}},{key:"updateLastMessage",value:function(e){this.lastMessage=Qo(e)}},{key:"updateGroupAtInfoList",value:function(e){this.groupAtInfoList=JSON.parse(JSON.stringify(e))}},{key:"updateTopic",value:function(e){pt(e.selfInfo)||this.updateSelfInfo(e.selfInfo),pt(e.muteAllMembers)||(this.muteAllMembers=1===e.muteAllMembers),nt(this,e,["groupID","lastMessageTime","selfInfo","muteAllMembers","lastMsg"])}},{key:"updateSelfInfo",value:function(e){return 0===nt(this.selfInfo,e,[],[""])}},{key:"reduceUnreadCount",value:function(){return 1<=this.unreadCount&&(--this.unreadCount,!0)}},{key:"isLastMessageRevoked",value:function(e){return e.sequence===this.lastMessage.lastSequence}},{key:"setLastMessageRevoked",value:function(e){this.lastMessage.isRevoked=e}},{key:"setLastMessageRevoker",value:function(e){this.lastMessage.revoker=e}}]),$a),La=(s(Ya,Un),oa=g(Ya),i(Ya,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("topic_cache_time"),t=this.getCloudConfig("topic_last_active_time");pt(e)||(this.TOPIC_CACHE_TIME=Number(e)),pt(t)||(this.TOPIC_LAST_ACTIVE_TIME=Number(t))}},{key:"onTopicCreated",value:function(e){var t=e.groupID;this.resetGetTopicTime(t),this.emitOEvt(T.TOPIC_CREATED,e)}},{key:"onTopicDeleted",value:function(e){var t=this,n=e.groupID,o=e.topicIDList;(void 0===o?[]:o).forEach((function(e){t._deleteLocalTopic(n,e)})),this.emitOEvt(T.TOPIC_DELETED,e)}},{key:"onTopicProfileUpdated",value:function(e){var t=e.groupID,n=e.topicID;(n=this.getLocalTopic(t,n))&&(n.updateTopic(e),this.emitOEvt(T.TOPIC_UPDATED,{groupID:t,topic:n}))}},{key:"onTopicLatestMsg",value:function(e){var t,n,o=(e=e||{}).topicLatestMessage;e=e.excludedUnreadSequenceList,He(o)||(t=o.groupProfile.topicID,o.conversationType=S.CONV_GROUP,o.to=t,(n=new No(o)).setElement(o.elements),this.updateUnreadCountAndLastMsg(t,n,e))}},{key:"onMessageRemindTypeUpdated",value:function(e){var t,n=e.groupID,o=e.topicID,a=(e=e.messageRemindType,this.getLocalTopic(n,o));a&&((t=a.updateSelfInfo({messageRemindType:e}))&&this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:a}),Re.l("".concat(this._n,".onMessageRemindTypeUpdated topicID:").concat(o," messageRemindType:").concat(e," isUpdated:").concat(t)))}},{key:"onAtInfoUpdated",value:function(e){var t=e.topicID,n=(e=e.groupAtInfoList,Gt(t));(t=this.getLocalTopic(n,t))&&!pt(e)&&(t.updateGroupAtInfoList(e),this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:t}))}},{key:"onUnreadCountUpdatedFromConv",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:0,n=Gt(e);(e=this.getLocalTopic(n,e))&&e.unreadCount!==t&&(e.updateUnreadCount(t),0===t&&e.updateSelfInfo({readedSequence:e.lastMessage.lastSequence}),this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:e}))}},{key:"onMessageSent",value:function(e){var t,n,o=e.groupID,a=e.topicID;e=e.lastMessage,!(a=this.getLocalTopic(o,a))||(n=(t=void 0===(t=e.sequence)?0:t)+1)>a.nextMessageSeq&&(a.updateNextMessageSeq(n),a.updateLastMessage(e),a.updateSelfInfo({readedSequence:t}),a.updateUnreadCount(0),this.emitOEvt(T.TOPIC_UPDATED,{groupID:o,topic:a}))}},{key:"onMessageModified",value:function(e){var t,n=e.to,o=e.time,a=e.sequence,i=e.elements,r=e.cloudCustomData,s=e.messageVersion,l=Gt(n),c=this.getLocalTopic(l,n);c&&(t=c.lastMessage,Re.d("".concat(this._n,".onMessageModified topicID:").concat(n," lastMessage:"),JSON.stringify(t),"options:",JSON.stringify(e)),t&&(null===t.payload||t.lastTime===o&&t.lastSequence===a&&t.version!==s)&&(t.type=i[0].type,t.payload=i[0].content,t.messageForShow=Ft(t.type,t.payload,this.isIntl()),t.cloudCustomData=r,t.version=s,t.lastSequence=a,t.lastTime=o,this.emitOEvt(T.TOPIC_UPDATED,{groupID:l,topic:c})))}},{key:"onMessageRevoked",value:function(e){var t,n,o,a=this;0!==e.length&&(n=t=null,o=!1,e.forEach((function(e){var i=e.to;n=Gt(i),(t=a.getLocalTopic(n,i))&&(t.reduceUnreadCount()&&(o=!0),t.isLastMessageRevoked(e)&&(t.setLastMessageRevoked(!0),t.setLastMessageRevoker(e.revoker),o=!0),(i=t.selfInfo.excludedUnreadSequenceList||[]).push(e.sequence),t.updateSelfInfo({excludedUnreadSequenceList:i}))})),o&&this.emitOEvt(T.TOPIC_UPDATED,{groupID:n,topic:t}))}},{key:"isLastMessageRevoked",value:function(e){var t=e.topicID,n=(e=e.sequence,Gt(t));return n=this.getLocalTopic(n,t),t=!1,n?n.isLastMessageRevoked({sequence:e}):t}},{key:"updateUnreadCountAndLastMsg",value:function(e,t,n){var o,a=Gt(e),i=this.getLocalTopic(a,e);i&&(o=i.selfInfo.excludedUnreadSequenceList||[],pt(n)||(o=n),t._isExcludedFromUnreadCount&&o.push(t.sequence),i.updateSelfInfo({excludedUnreadSequenceList:o}),Re.l("".concat(this._n,".updateUnreadCountAndLastMsg seq:").concat(t.sequence," lastSeq:").concat(i.lastMessage.lastSequence)),t.sequence>i.lastMessage.lastSequence&&(i.updateLastMessage(t),n=t.sequence+1,i.updateNextMessageSeq(n),o=this._computeUnreadCount(i),i.updateUnreadCount(o),(t=this.get(11).getLocalConversation("".concat(S.CONV_GROUP).concat(e)))&&t.updateUnreadCount({nextUnreadCount:o,isFromGetConversations:!0}),this.emitOEvt(T.TOPIC_UPDATED,{groupID:a,topic:i})))}},{key:"getJoinedCommunityList",value:function(){return this.get(7).syncCommunityWithTopic()}},{key:"createTopicInCommunity",value:function(e){var n=this,o="".concat(this._n,".").concat("createTopicInCommunity"),a=e.topicID;if(!pt(a)&&!St(a))return Mn({code:zn.ILLEGAL_TOPIC_ID});if(e.topicName&&!1===this._filterProfanity("topicName",e))return Mn({code:zn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return Mn({code:zn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return Mn({code:zn.PROFANITY_FOUND});var i=new io("createTopicInCommunity");return this.req({P:jn.CREATE_TOPIC,data:t({},e)}).then((function(a){return a=a.data.topicID,i.setMessage("topicID:".concat(a)).end(),Re.l("".concat(o," ok. topicID:").concat(a)),n._updateTopicMap([t(t({},e),{},{topicID:a})]),Tn({topicID:a})})).catch((function(e){return i.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"deleteTopicFromCommunity",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteTopicFromCommunity"),o=e.groupID,a=(e=void 0===(e=e.topicIDList)?[]:e,new io("deleteTopicFromCommunity"));return a.setMessage("groupID:".concat(o," topicIDList:").concat(e)),this.req({P:jn.DEL_TOPIC,data:{groupID:o,topicIDList:e}}).then((function(e){e=e.data.resultList;var i=[],r=[];return(void 0===e?[]:e).forEach((function(e){var t=e.topicID,n=e.errorCode;e=e.errorInfo,0===n?i.push({topicID:t}):r.push({topicID:t,code:n,message:e})})),e="success count:".concat(i.length,", fail count:").concat(r.length),a.setMoreMessage(e).end(),Re.l("".concat(n," ok. ").concat(e)),i.forEach((function(e){t._deleteLocalTopic(o,e.topicID)})),Tn({successTopicList:i,failureTopicList:r})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"updateTopicProfile",value:function(e){var n=this,o="".concat(this._n,".").concat("updateTopicProfile");if(Re.l("".concat(o," options:"),e),e.topicName&&!1===this._filterProfanity("topicName",e))return Mn({code:zn.PROFANITY_FOUND});if(e.introduction&&!1===this._filterProfanity("introduction",e))return Mn({code:zn.PROFANITY_FOUND});if(e.notification&&!1===this._filterProfanity("notification",e))return Mn({code:zn.PROFANITY_FOUND});var a=new io("updateTopicProfile");return a.setMessage("groupID:".concat(e.groupID," topicID:").concat(e.topicID)),pt(e.muteAllMembers)||(e.muteAllMembers=!0===e.muteAllMembers?"On":"Off"),this.req({P:jn.UPDATE_TOPIC_PROFILE,data:t({},e)}).then((function(){return a.end(),Re.l("".concat(o," ok")),n._updateTopicMap([e]),Tn({topic:n.getLocalTopic(e.groupID,e.topicID)})})).catch((function(e){return a.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"getTopicList",value:function(e){var n=this,o="".concat(this._n,".").concat("getTopicList"),a=e.groupID,i=0===(e=void 0===(e=e.topicIDList)?[]:e).length,r=new io("getTopicList");if(r.setMessage("groupID:".concat(a)),this._getTopicTimeMap.has(a)){var s=(l=this._getTopicTimeMap.get(a)).isGetAll,l=l.time;if((s||!s&&!i)&&Date.now()-l<1e3*this.TOPIC_CACHE_TIME&&(s=this._getLocalTopicList(a,e),i||s.length===e.length))return r.setMoreMessage("from cache, topic count:".concat(s.length)).end(),Re.l("".concat(o," groupID:").concat(a," from cache, topic count:").concat(s.length)),Sn({successTopicList:s,failureTopicList:[]})}return this.req({P:jn.GET_TOPIC_LIST,data:{groupID:a,topicIDList:e}}).then((function(e){e=e.data.topicInfoList;var s=[],l=[],c=[];return(void 0===e?[]:e).forEach((function(e){var n=e.topic,o=e.selfInfo,a=e.errorCode,i=(e=e.errorInfo,n.topicID);0===a?(s.push(t(t({},n),{},{selfInfo:o})),l.push(i)):c.push({topicID:i,code:a,message:e})})),n._updateTopicMap(s),n._handleTopicAtInfo(s),e="success count:".concat(l.length,", fail count:").concat(c.length),r.setMoreMessage(e).end(),Re.l("".concat(o," groupID:").concat(a," from remote, ").concat(e)),e=[],He(l)||(n._getTopicTimeMap.set(a,{time:Date.now(),isGetAll:i}),e=n._getLocalTopicList(a,l)),Tn({successTopicList:e,failureTopicList:c})})).catch((function(e){return r.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"hasLocalTopic",value:function(e,t){return!!this._topicMap.has(e)&&this._topicMap.get(e).has(t)}},{key:"getLocalTopic",value:function(e,t){var n=null;return this._topicMap.has(e)?this._topicMap.get(e).get(t):n}},{key:"_getLocalTopicList",value:function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],n=[];return(e=this._topicMap.get(e))&&(n=v(e.values())),0===t.length?n:n.filter((function(e){return t.includes(e.topicID)}))}},{key:"_deleteLocalTopic",value:function(e,t){this._topicMap.has(e)&&this._topicMap.get(e).has(t)&&(this._topicMap.get(e).delete(t),Re.l("".concat(this._n,"._deleteLocalTopic groupID:").concat(e," topicID:").concat(t)))}},{key:"_updateTopicMap",value:function(e){var t=this,n=[];e.forEach((function(e){var o=e.groupID,a=e.topicID,i=null;t._topicMap.has(o)||t._topicMap.set(o,new Map),t._topicMap.get(o).has(a)?(i=t._topicMap.get(o).get(a)).updateTopic(e):(t._getTopicLastMessage(e),i=new Ra(e,t.isIntl()),t._topicMap.get(o).set(a,i)),e=t._computeUnreadCount(i),i.updateUnreadCount(e),n.push({conversationID:"".concat(S.CONV_GROUP).concat(a),type:S.CONV_TOPIC,unreadCount:e})})),0<n.length&&this.get(11).updateTopicConversation(n)}},{key:"resetGetTopicTime",value:function(e){var t=this;pt(e)?v(this._getTopicTimeMap.keys()).forEach((function(e){t._getTopicTimeMap.set(e,0)})):this._getTopicTimeMap.set(e,0)}},{key:"getTopicListOnReconnected",value:function(){var e=this,t=v(this._topicMap.keys()),n=[],o=this.get(11);t.forEach((function(t){var a=[],i=e._getLocalTopicList(t);o.deleteTopicRoamingInfo(t),i.forEach((function(t){var n=void 0===(n=t.lastMessage.lastTime)?0:n;Date.now()-1e3*n<1e3*e.TOPIC_LAST_ACTIVE_TIME&&a.push(t.topicID)})),0<a.length&&n.push({groupID:t,topicIDList:a})})),Re.l("".concat(this._n,".getTopicListOnReconnected. active community count:").concat(n.length)),this._relayGetTopicList(n)}},{key:"_relayGetTopicList",value:function(e){var t,n,o,a=this;0!==e.length&&(n=5<(t=e.shift()).topicIDList.length?"topicIDList.length:".concat(t.topicIDList.length):"topicIDList:".concat(t.topicIDList),(o=new io("relayGetTopicList")).setMessage(n),Re.l("".concat(this._n,"._relayGetTopicList. ").concat(n)),this.getTopicList(t).then((function(){o.end(),a._relayGetTopicList(e)})).catch((function(t){o.setError(t).end(),a._relayGetTopicList(e)})))}},{key:"_handleTopicAtInfo",value:function(e){var n=this;0!==e.length&&e.forEach((function(e){var o=e.groupID,a=e.topicID,i=(e=e.groupAtInfoList,[]);pt(e)||(e.forEach((function(e){i.push(t(t({},e),{},{groupID:o,topicID:a}))})),n.get(11).onNewGroupAtTips({dataList:i}))}))}},{key:"_getTopicLastMessage",value:function(e){var t;pt(e.lastMsg)||(t={time:e.lastMsg.time,sequence:e.lastMsg.sequence,from:e.lastMsg.from,payload:e.lastMsg.elements[0]?e.lastMsg.elements[0].content:null,type:e.lastMsg.elements[0]?e.lastMsg.elements[0].type:"",nick:e.lastMsg.nick,avatar:e.lastMsg.avatar,version:e.lastMsg.messageVersion,cloudCustomData:e.lastMsg.cloudCustomData,isRevoked:2===e.lastMsg.isPlaceMessage,revoker:He(e.lastMsg.revokerInfo)?null:e.lastMsg.revokerInfo.revoker},e.lastMessage=t)}},{key:"deleteTopicListInCommunity",value:function(e){var t=this,n=this._getLocalTopicList(e),o=this.get(11);n.forEach((function(n){n=n.topicID,t._deleteLocalTopic(e,n),t._getTopicTimeMap.delete(e),o.deleteLocalConv("".concat(S.CONV_GROUP).concat(n))}))}},{key:"_computeUnreadCount",value:function(e){var t,n=(a=e.selfInfo).excludedUnreadSequenceList,o=a.readedSequence,a=e.nextMessageSeq-e.selfInfo.readedSequence-1;return Ze(n)&&(t=0,n.forEach((function(n){o<n&&n<=e.nextMessageSeq-1&&(t+=1)})),1<=t&&(a-=t)),a<0?0:a}},{key:"_filterProfanity",value:function(e,t){if(!(o=this.get(29)))return!0;var n=(o=o.filterText(t[e],U)).isAllowedToSend,o=o.modifiedText;return!0===n&&(t[e]=o,!0)}},{key:"getMessageExtensions",value:function(e,t){Re.l("".concat(this._n,".getMessageExtensions startSequence:").concat(t));var n=Gt(e.to);return this.req({P:jn.GET_GRP_MSG_EXT,data:{groupID:n,topicID:e.to,messageSequence:e.sequence,startSequence:t}})}},{key:"modifyMsgExts",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,o=(Re.l("".concat(this._n,".modifyMsgExts operateType:").concat(n)),Gt(e.to));return this.req({P:jn.MODIFY_GRP_MSG_EXT,data:{groupID:o,topicID:e.to,messageSequence:e.sequence,extensionList:t,operateType:n}})}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._topicMap.clear(),this._getTopicTimeMap.clear(),this.TOPIC_CACHE_TIME=300,this.TOPIC_LAST_ACTIVE_TIME=3600}}]),Ya),Aa=(i(Ka,[{key:"setExpirationTime",value:function(e){this.expirationTime=e}},{key:"getUserProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getUserProfile"),o=e.userIDList;e.fromAccount=this._userM.getMyAccount(),100<o.length&&(Re.w("".concat(n," ").concat(qt(100))),o.length=100);for(var a,i=[],r=[],s=0,l=o.length;s<l;s++)a=o[s],this._userM.isMyFriend(a)&&this._contains(a)?r.push(this._getProfileFromMap(a)):i.push(a);if(0===i.length)return Sn(r);e.toAccount=i;var c=e.bFromGetMyProfile||!1,u=[],d=(e.toAccount.forEach((function(e){u.push({toAccount:e,standardSequence:0,customSequence:0})})),e.userItem=u,new io("getUserProfile"));return d.setMessage(5<o.length?"userIDList.length:".concat(o.length):"userIDList:".concat(o)),this._userM.req({P:jn.GET_USER_PROFILE,data:e}).then((function(e){return d.end(),Re.i("".concat(n," ok")),e=t._handleResponse(e).concat(r),Tn(c?e[0]:e)})).catch((function(e){return d.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"getMyProfile",value:function(){var e,t=this._userM.getMyAccount(),n="".concat(this._n,".getMyProfile");return Re.l("".concat(n," myAccount:").concat(t)),this._fill(),this._contains(t)?(e=this._getProfileFromMap(t),Re.d("".concat(n," from cache, myProfile:").concat(JSON.stringify(e))),Sn(e)):this.getUserProfile({fromAccount:t,userIDList:[t],bFromGetMyProfile:!0})}},{key:"_handleResponse",value:function(e){var t=e.data.userProfileItem;if(!Ze(t))return[];for(var n=[],o=(e=Date.now(),0),a=t.length;o<a;o++){var i=(r=t[o]).to,r=r.profileItem;"@TLS#NOT_FOUND"!==i&&""!==i&&(i=this._update(i,this._getLatestProfileFromResponse(i,r)).latestProfile,n.push(i))}return Re.l("".concat(this._n,"._handleResponse cost:").concat($t(e))),n}},{key:"_getLatestProfileFromResponse",value:function(e,t){var n={userID:e,profileCustomField:[]};if(!He(t))for(var o=0,a=t.length;o<a;o++)if(-1<t[o].tag.indexOf("Tag_Profile_Custom"))n.profileCustomField.push({key:t[o].tag,value:t[o].value});else switch(t[o].tag){case Ae.NICK:n.nick=t[o].value;break;case Ae.GENDER:n.gender=t[o].value;break;case Ae.BIRTHDAY:n.birthday=t[o].value;break;case Ae.LOCATION:n.location=t[o].value;break;case Ae.SELFSIGNATURE:n.selfSignature=t[o].value;break;case Ae.ALLOWTYPE:n.allowType=t[o].value;break;case Ae.LANGUAGE:n.language=t[o].value;break;case Ae.AVATAR:n.avatar=t[o].value;break;case Ae.MESSAGESETTINGS:n.messageSettings=t[o].value;break;case Ae.ADMINFORBIDTYPE:n.adminForbidType=t[o].value;break;case Ae.LEVEL:n.level=t[o].value;break;case Ae.ROLE:n.role=t[o].value;break;default:Re.w("".concat(this._n,"._getLatestProfileFromResponse unknown tag:"),t[o].tag,t[o].value)}return n}},{key:"updateMyProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("updateMyProfile");if(e.nick&&!1===this._userM.filterProfanity("nick",e))return Mn({code:zn.PROFANITY_FOUND});if(e.selfSignature&&!1===this._userM.filterProfanity("selfSignature",e))return Mn({code:zn.PROFANITY_FOUND});var o=new io("updateMyProfile"),a=(o.setMessage(JSON.stringify(e)),(new la).validate(e));if(!a.valid)return o.setCode(zn.UPDATE_PROFILE_INVALID_PARAM).setMoreMessage("info:".concat(a.tips)).end(),Re.e("".concat(n," info:").concat(a.tips)),Mn({code:zn.UPDATE_PROFILE_INVALID_PARAM});var i,r=[];for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&("profileCustomField"===i?e.profileCustomField.forEach((function(e){r.push({tag:e.key,value:e.value})})):r.push({tag:Ae[i.toUpperCase()],value:e[i]}));if(0===r.length)return a=new Fn({code:zn.UPDATE_PROFILE_NO_KEY}),o.setError(a).end(),Re.e("".concat(n," failed. error:"),a),Mn(a);var s=this._userM.getMyAccount();return this._userM.req({P:jn.UPDATE_MY_PROFILE,data:{fromAccount:s,profileItem:r}}).then((function(a){o.end(),Re.i("".concat(n," ok"));var i=(r=t._update(s,e)).isProfileUpdated,r=r.latestProfile;return!0===i&&t._userM.emitOEvt(T.PROFILE_UPDATED,[r]),Sn(r)})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"onProfileModified",value:function(e){var t=e.dataList;if(!He(t)){var n=t.length;Re.d("".concat(this._n,".onProfileModified count:").concat(n," dataList:"),e.dataList);for(var o=[],a=0;a<n;a++){var i=t[a].userID,r=(i=this._update(i,this._getLatestProfileFromResponse(i,t[a].profileList))).isProfileUpdated;i=i.latestProfile,!0===r&&o.push(i)}0<o.length&&(this._userM.emitIEvt(Yo.PROFILE_UPDATED,o),this._userM.emitOEvt(T.PROFILE_UPDATED,o))}}},{key:"_fill",value:function(){if(0===this.accountProfileMap.size){for(var e=this._getCachedProfiles(),t=Date.now(),n=0,o=e.length;n<o;n++)t-e[n].lastUpdatedTime<this.expirationTime&&this.accountProfileMap.set(e[n].userID,e[n]);Re.l("".concat(this._n,"._fill from cache, size:").concat(this.accountProfileMap.size))}}},{key:"_update",value:function(e,t){var n,o=!1,a=Date.now();return this._contains(e)?(n=this._getProfileFromMap(e),t.profileCustomField&&!0===yt(n.profileCustomField,t.profileCustomField)&&(n.lastUpdatedTime=a,o=!0),0<nt(n,t,["profileCustomField"])&&(n.lastUpdatedTime=a,o=!0)):(n=new la(t),!this._userM.isMyFriend(e)&&e!==this._userM.getMyAccount()||(n.lastUpdatedTime=a,o=!0,this.accountProfileMap.set(e,n))),this._flush(e===this._userM.getMyAccount()),!0===o&&Re.l("".concat(this._n,"._update account:").concat(e," isUpdated:").concat(o)),{isProfileUpdated:o,latestProfile:n}}},{key:"_flush",value:function(e){var t=v(this.accountProfileMap.values()),n=this._userM.getStorageModule();Re.d("".concat(this._n,"._flush length:").concat(t.length," flushAtOnce:").concat(e)),n.setItem(this.TAG,t,e)}},{key:"_contains",value:function(e){return this.accountProfileMap.has(e)}},{key:"_getProfileFromMap",value:function(e){return this.accountProfileMap.get(e)}},{key:"_getCachedProfiles",value:function(){var e=this._userM.getStorageModule().getItem(this.TAG);return He(e)?[]:e}},{key:"onConvProfileUpdated",value:function(e){for(var t,n,o=[],a=0,i=e.length;a<i;a++)n=(t=e[a]).userID,this._userM.isMyFriend(n)&&(this._contains(n)?0<nt(this._getProfileFromMap(n),t)&&o.push(n):o.push(t.userID));0!==o.length&&(Re.l("".concat(this._n,".onConvProfileUpdated toAccountList:").concat(o)),this.getUserProfile({userIDList:o}))}},{key:"getNickAndAvatarByUserID",value:function(e){return this._contains(e)?{nick:(e=this._getProfileFromMap(e)).nick,avatar:e.avatar}:{nick:"",avatar:""}}},{key:"getUserNickAndAvatar",value:function(e){var t=this,n=v(new Set(e)),o=(Re.l("".concat(this._n,".getUserNickAndAvatar userIDList.length:").concat(e.length," uniqueUserIDList.length:").concat(n.length)),[]);if(0===e.length)return Promise.resolve(o);e=this._createUserIDListGroup(n);var a=[];return e.forEach((function(e){a.push(t.getUserProfile({userIDList:e}))})),Promise.all(a).then((function(e){return e.forEach((function(e){e=e.data.map((function(e){return{userID:e.userID,nick:e.nick,avatar:e.avatar}})),o.push.apply(o,v(e))})),o}))}},{key:"_createUserIDListGroup",value:function(e){for(var t=[],n=0;n<e.length;)t.push(e.slice(n,n+=100));return t}},{key:"reset",value:function(){this._flush(!0),this.accountProfileMap.clear()}}]),Ka),Oa=i((function e(t){o(this,e)})),Pa=(i(qa,[{key:"getLocalBlacklist",value:function(){return v(this._blacklistMap.keys())}},{key:"getBlacklist",value:function(){var e=this,t="".concat(this._n,".getBlacklist"),n={fromAccount:this._userM.getMyAccount(),maxLimited:100,startIndex:this._startIndex},o=new io("getBlacklist");return this._userM.req({P:jn.GET_BL,data:n}).then((function(n){var a=(n=n.data).blackListItem,i=(n=n.startIndex,He(a)?0:a.length);o.setMessage("count:".concat(i)).end(),Re.i("".concat(t," ok")),e._startIndex=n,e._handleResponse(a,!0),e._userM.emitOEvt(T.BLACKLIST_UPDATED,v(e._blacklistMap.keys())),0!==e._startIndex&&e.getBlacklist()})).catch((function(e){return o.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"addBlacklist",value:function(e){var t,n,o=this,a=new io("addToBlacklist"),i="".concat(this._n,".addBlacklist"),r=this._userM.getMyAccount();return 1===e.userIDList.length&&e.userIDList[0]===r?(n=this._userM.getErrMsg(t=zn.CANNOT_ADD_SELF_TO_BLACKLIST),a.setCode(t).setMessage(n).end(),n=new Fn({code:t}),Re.e("".concat(i," failed. error:"),n),Mn(n)):(e.userIDList.includes(r)&&(e.userIDList=e.userIDList.filter((function(e){return e!==r}))),e.fromAccount=this._userM.getMyAccount(),e.toAccount=e.userIDList,this._userM.req({P:jn.ADD_TO_BL,data:e}).then((function(t){return a.setMessage(5<e.userIDList.length?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Re.i("".concat(i," ok")),o._handleResponse(t.resultItem,!0),Tn(v(o._blacklistMap.keys()))})).catch((function(e){return a.setError(e).end(),Re.e("".concat(i," failed. error:"),e),Mn(e)})))}},{key:"_handleResponse",value:function(e,t){if(!He(e))for(var n,o,a,i=0,r=e.length;i<r;i++)o=e[i].to,a=e[i].resultCode,!pt(a)&&0!==a||(t?((n=this._blacklistMap.has(o)?this._blacklistMap.get(o):new Oa).userID=o,He(e[i].addBlackTimeStamp)||(n.timeStamp=e[i].addBlackTimeStamp),this._blacklistMap.set(o,n)):this._blacklistMap.has(o)&&(n=this._blacklistMap.get(o),this._blacklistMap.delete(o)));Re.l("".concat(this._n,"._handleResponse total:").concat(this._blacklistMap.size," bAdd:").concat(t))}},{key:"deleteBlacklist",value:function(e){var t=this,n="".concat(this._n,".deleteBlacklist"),o=new io("removeFromBlacklist");return e.fromAccount=this._userM.getMyAccount(),e.toAccount=e.userIDList,this._userM.req({P:jn.RM_FROM_BL,data:e}).then((function(a){return o.setMessage(5<e.userIDList.length?"userIDList.length:".concat(e.userIDList.length):"userIDList:".concat(e.userIDList)).end(),Re.i("".concat(n," ok")),t._handleResponse(a.data.resultItem,!1),Tn(v(t._blacklistMap.keys()))})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"onAccountDeleted",value:function(e){for(var t=0,n=e.length;t<n;t++){var o=e[t];this._blacklistMap.has(o)&&this._blacklistMap.delete(o)}var a=e.length;0<a&&(Re.l("".concat(this._n,".onAccountDeleted count:").concat(a," ").concat(a<30?"userIDList:".concat(e):"")),this._userM.emitOEvt(T.BLACKLIST_UPDATED,v(this._blacklistMap.keys())))}},{key:"onAccountAdded",value:function(e){for(var t,n=[],o=0,a=e.length;o<a;o++)t=e[o],this._blacklistMap.has(t)||(this._blacklistMap.set(t,new Oa({userID:t})),n.push(t));0<n.length&&(Re.l("".concat(this._n,".onAccountAdded count:").concat(n.length," userIDList:"),n),this._userM.emitOEvt(T.BLACKLIST_UPDATED,v(this._blacklistMap.keys())))}},{key:"reset",value:function(){this._blacklistMap.clear(),this._startIndex=0}}]),qa),Ua=(i(ja,[{key:"_onCloudConfig",value:function(){var e=this._userM.getCloudConfig("status_query_count"),t=this._userM.getCloudConfig("status_sub_count"),n=this._userM.getCloudConfig("status_unsub_count");Re.l("".concat(this._n,"._onCloudConfig statusQueryCount:").concat(e," statusSubscribeCount:").concat(t)+" statusUnsubscribeCount:".concat(n)),pt(e)||(this.MAX_QUERY_USER_COUNT=parseInt(e,10)),pt(e)||(this.MAX_SUBSCRIBE_USER_COUNT=parseInt(t,10)),pt(e)||(this.MAX_UNSUBSCRIBE_USER_COUNT=parseInt(n,10))}},{key:"onUserStatusUpdated",value:function(e){e=e.dataList;var t=this._userM.getMyUserID(),n=this._userM.get(12);e=e.map((function(e){var o=e.to,a=e.statusType;return e=ea(e=e.customStatus),o===t&&n.setCustomStatus(e),{userID:o,statusType:a,customStatus:e}})),Re.l("".concat(this._n,".onUserStatusUpdated list:").concat(JSON.stringify(e))),this._userM.emitOEvt(T.USER_STATUS_UPDATED,e)}},{key:"setSelfStatus",value:function(e){var t=this,n="".concat(this._n,".setSelfStatus");if(!1===this._userM.filterProfanity("customStatus",e))return Mn({code:zn.PROFANITY_FOUND});var o=new io("setSelfStatus"),a=e.customStatus;return this._userM.req({P:jn.SET_SELF_STATUS,data:{customStatus:a}}).then((function(e){return o.setMessage("customStatus:".concat(a)).end(),Re.l("".concat(n," ok. customStatus:").concat(a)),t._userM.get(12).setCustomStatus(a),Tn({userID:t._userM.getMyUserID(),statusType:1,customStatus:a})})).catch((function(e){return o.setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"getUserStatus",value:function(e){var t="".concat(this._n,".").concat("getUserStatus"),n=void 0===(e=e.userIDList)?[]:e,o=(e=this._userM.getMyUserID(),v(n)),a=void 0,i=o.indexOf(e);if(-1<i&&(o.splice(i,1),a={userID:e,statusType:1,customStatus:this._userM.get(12).getCustomStatus()}),0===o.length)return Sn({successUserList:[a],failureUserList:[]});if(!this._userM.canIUse(P.USER_STATUS))return this._userM.noUse("getUserStatus");o.length>this.MAX_QUERY_USER_COUNT&&(Re.w("".concat(t," ").concat(qt(this.MAX_QUERY_USER_COUNT))),o=n.slice(0,this.MAX_QUERY_USER_COUNT));var r=new io("getUserStatus");return this._userM.req({P:jn.GET_USER_STATUS,data:{userIDList:o}}).then((function(e){var o=void 0===(o=(e=e.data).successUserList)?[]:o,i=(e=void 0===(e=e.failureUserList)?[]:e,o=o.map((function(e){return{userID:e.userID,statusType:e.statusType,customStatus:ea(e=e.customStatus)}})),e=e.map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode;return e=e.errorInfo,{userID:He(n)?t:n,code:o,message:e}})),pt(a)||o.unshift(a),"userID count:".concat(n.length,", success count:").concat(o.length,", fail count:").concat(e.length));return r.setMessage("".concat(i)).end(),Re.l("".concat(t," ok. ").concat(i,".")),Tn({successUserList:o,failureUserList:e})})).catch((function(e){return r.setMessage("userID count:".concat(n.length)).setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"subscribeUserStatus",value:function(e){var t="subscribeUserStatus";if(!this._userM.canIUse(P.USER_STATUS))return this._userM.noUse(t);var n="".concat(this._n,".").concat(t),o=v(e=void 0===(e=e.userIDList)?[]:e),a=(o.length>this.MAX_SUBSCRIBE_USER_COUNT&&(Re.w("".concat(n," ").concat(qt(this.MAX_SUBSCRIBE_USER_COUNT))),o=e.slice(0,this.MAX_SUBSCRIBE_USER_COUNT)),new io(t)),i="userID count:".concat(e.length);return Re.l("".concat(n," ").concat(i)),this._userM.req({P:jn.SUB_USER_STATUS,data:{userIDList:o}}).then((function(e){return e=(void 0===(e=e.data.failureUserList)?[]:e).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode;return e=e.errorInfo,{userID:He(n)?t:n,code:o,message:e}})),a.setMessage("".concat(i," fail count:").concat(e.length)).end(),Re.l("".concat(n," ok. fail count:").concat(e.length,".")),Tn({failureUserList:e})})).catch((function(e){return a.setMessage(i).setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"unsubscribeUserStatus",value:function(e){var t="unsubscribeUserStatus";if(!this._userM.canIUse(P.USER_STATUS))return this._userM.noUse(t);var n="".concat(this._n,".").concat(t),o=v(e=void 0===(e=(e||{}).userIDList)?[]:e),a=(e.length>this.MAX_UNSUBSCRIBE_USER_COUNT&&(Re.w("".concat(n," ").concat(qt(this.MAX_UNSUBSCRIBE_USER_COUNT))),o=e.slice(0,this.MAX_UNSUBSCRIBE_USER_COUNT)),new io(t)),i="userID count:".concat(e.length);return Re.l("".concat(n," ").concat(i)),t={userIDList:o},0===o.length&&(t.userIDList=void 0,t.unsubscribeAll=1),this._userM.req({P:jn.UNSUB_USER_STATUS,data:t}).then((function(e){return e=(void 0===(e=e.data.failureUserList)?[]:e).map((function(e){var t=e.userID,n=e.invalidUserID,o=e.errorCode;return e=e.errorInfo,{userID:He(n)?t:n,code:o,message:e}})),a.setMessage("".concat(i," fail count:").concat(e.length)).end(),Re.l("".concat(n," ok. fail count:").concat(e.length,".")),Tn({failureUserList:e})})).catch((function(e){return a.setMessage("".concat(i)).setError(e).end(),Re.e("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"reset",value:function(){this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100}}]),ja),xa=(s(Ha,Un),na=g(Ha),i(Ha,[{key:"onContextUpdated",value:function(e){this._profileHandler.getMyProfile(),this._blacklistHandler.getBlacklist()}},{key:"mockOnNickAvatarModified",value:function(e,t){Re.l("".concat(this._n,"._mockOnNickAvatarModified nick:").concat(e," avatar:").concat(t)),this.onProfileModified({dataList:[{pushType:1,userID:this.getMyUserID(),profileList:[{tag:Ae.NICK,value:e},{tag:Ae.AVATAR,value:t}]}]})}},{key:"onProfileModified",value:function(e){this._profileHandler.onProfileModified(e)}},{key:"onRelationChainModified",value:function(e){var t,n;He(e=e.dataList)||(t=[],e.forEach((function(e){e.blackListDelAccount&&t.push.apply(t,v(e.blackListDelAccount))})),0<t.length&&this._blacklistHandler.onAccountDeleted(t),n=[],e.forEach((function(e){e.blackListAddAccount&&n.push.apply(n,v(e.blackListAddAccount))})),0<n.length&&this._blacklistHandler.onAccountAdded(n))}},{key:"onConvProfileUpdated",value:function(e){this._profileHandler.onConvProfileUpdated(e)}},{key:"getMyAccount",value:function(){return this.getMyUserID()}},{key:"getMyNick",value:function(){return this._profileHandler.getNickAndAvatarByUserID(this.getMyUserID()).nick}},{key:"getMyProfile",value:function(){return this._profileHandler.getMyProfile()}},{key:"getStorageModule",value:function(){return this.get(13)}},{key:"filterProfanity",value:function(e,t){if(!(o=this.get(29)))return!0;var n=(o=o.filterText(t[e],"user_profile")).isAllowedToSend,o=o.modifiedText;return!0===n&&(t[e]=o,!0)}},{key:"isMyFriend",value:function(e){var t=this.get(8);return!!t&&t.isMyFriend(e)}},{key:"getUserProfile",value:function(e){return this._profileHandler.getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._profileHandler.updateMyProfile(e)}},{key:"getNickAndAvatarByUserID",value:function(e){return this._profileHandler.getNickAndAvatarByUserID(e)}},{key:"getUserNickAndAvatar",value:function(e){return this._profileHandler.getUserNickAndAvatar(e)}},{key:"getLocalBlacklist",value:function(){return Sn(this._blacklistHandler.getLocalBlacklist())}},{key:"addBlacklist",value:function(e){return this._blacklistHandler.addBlacklist(e)}},{key:"deleteBlacklist",value:function(e){return this._blacklistHandler.deleteBlacklist(e)}},{key:"onUserStatusUpdated",value:function(e){this._userStatusHandler.onUserStatusUpdated(e)}},{key:"setSelfStatus",value:function(e){return this._userStatusHandler.setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._userStatusHandler.getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._userStatusHandler.subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._userStatusHandler.unsubscribeUserStatus(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._profileHandler.reset(),this._blacklistHandler.reset(),this._userStatusHandler.reset()}}]),Ha),Va=(i(za,[{key:"isLoggedIn",value:function(){return this._isLoggedIn}},{key:"isOversea",value:function(){return this._oversea}},{key:"isPrivateNetWork",value:function(){return this._proxyServer}},{key:"isDevMode",value:function(){return this._isDevMode}},{key:"isTestEnv",value:function(){return this._isTestEnv}},{key:"isPartialUpdatedConvs",value:function(){return this._isPartialUpdatedConvs}},{key:"isIndependentDomainDisabled",value:function(){return this._isIndependentDomainDisabled}},{key:"isSingaporeSite",value:function(){return 2e7<=this._SDKAppID&&this._SDKAppID<3e7||172e7<=this._SDKAppID&&this._SDKAppID<173e7}},{key:"isKoreaSite",value:function(){return 3e7<=this._SDKAppID&&this._SDKAppID<4e7||173e7<=this._SDKAppID&&this._SDKAppID<174e7}},{key:"isGermanySite",value:function(){return 4e7<=this._SDKAppID&&this._SDKAppID<5e7||174e7<=this._SDKAppID&&this._SDKAppID<175e7}},{key:"isIndiaSite",value:function(){return 5e7<=this._SDKAppID&&this._SDKAppID<6e7||175e7<=this._SDKAppID&&this._SDKAppID<176e7}},{key:"isJapanSite",value:function(){return 6e7<=this._SDKAppID&&this._SDKAppID<7e7||176e7<=this._SDKAppID&&this._SDKAppID<177e7}},{key:"isUSASite",value:function(){return 7e7<=this._SDKAppID&&this._SDKAppID<8e7||177e7<=this._SDKAppID&&this._SDKAppID<178e7}},{key:"isIndonesiaSite",value:function(){return 8e7<=this._SDKAppID&&this._SDKAppID<9e7||178e7<=this._SDKAppID&&this._SDKAppID<179e7}},{key:"isIntl",value:function(){return 0===(e=this._SDKAppID)||2e7<=e&&e<9e7||172e7<=e&&e<179e7;var e}},{key:"isUnlimitedAVChatRoom",value:function(){return this._unlimitedAVChatRoom}},{key:"isUsingChatCore",value:function(){return this._isUsingChatCore}},{key:"setUsingChatCore",value:function(e){this._isUsingChatCore=e}},{key:"getUIPlatform",value:function(){return this._uiPlatform}},{key:"setUIPlatform",value:function(e){this._uiPlatform=e}},{key:"setUserID",value:function(e){this._userID=e}},{key:"getUserID",value:function(){return this._userID}},{key:"setUserSig",value:function(e){this._userSig=e}},{key:"getUserSig",value:function(){return this._userSig}},{key:"getSDKAppID",value:function(){return this._SDKAppID}},{key:"setTinyID",value:function(e){this._tinyID=e,this._isLoggedIn=!0}},{key:"getTinyID",value:function(){return this._tinyID}},{key:"setCustomStatus",value:function(e){this._customStatus=e}},{key:"getCustomStatus",value:function(){return this._customStatus}},{key:"getScene",value:function(){return me?window.tencent_cloud_im_csig_flutter_for_web_25F_cy:this._isTUIKit()?"tuikit":this._scene}},{key:"getInstanceID",value:function(){return this._instanceID}},{key:"getStatusInstanceID",value:function(){return this._statusInstanceID}},{key:"setStatusInstanceID",value:function(e){this._statusInstanceID=e}},{key:"getVersion",value:function(){return this._version}},{key:"getA2Key",value:function(){return this._a2Key}},{key:"setA2Key",value:function(e){this._a2Key=e}},{key:"getContentType",value:function(){return this._contentType}},{key:"getProxyServer",value:function(){return this._proxyServer}},{key:"getFileUploadProxy",value:function(){return this._fileUploadProxy}},{key:"getFileDownloadProxy",value:function(){return this._fileDownloadProxy}},{key:"setApplicationID",value:function(e){this._applicationID=e}},{key:"getApplicationID",value:function(){return this._applicationID}},{key:"setDowloadFileAuthKey",value:function(e){this._authKey=e}},{key:"getDowloadFileAuthKey",value:function(){return this._authKey}},{key:"setCustomLoginInfo",value:function(e){this._customLoginInfo=e}},{key:"getCustomLoginInfo",value:function(){return this._customLoginInfo}},{key:"_isTUIKit",value:function(){var e=!1,t=!1,n=!1,o=!1,a=[];X&&(a=Object.keys(ne));for(var i=0,r=(a=te?J?Object.keys(uni):Object.keys(window):a).length;i<r;i++)if(a[i].toLowerCase().includes("uikit")){e=!0;break}a=null;var s,l=(X&&!Xe(ne.createGamePortal)&&Xe(getApp)&&!pt(getApp())&&We(s=getApp().globalData)&&!0===s.isTUIKit&&(t=!0),!0===this._m.get(13).getStorageSync("TIM_".concat(this._SDKAppID,"_isTUIKit"))&&(n=!0),null);if(z&&!q&&"undefined"==typeof uni&&__wxConfig&&(l=__wxConfig.pages),j&&"undefined"==typeof uni&&__qqConfig&&(l=__qqConfig.pages),Ze(l)&&0<l.length){for(var c=0,u=l.length;c<u;c++)if(l[c].toLowerCase().includes("tui")){o=!0;break}l=null}return e||t||n||o}},{key:"reset",value:function(){this._isLoggedIn=!1,this._userSig="",this._a2Key="",this._tinyID="",this._customStatus="",this._statusInstanceID=0}}]),za),Ba={"k-vue2-pc":1,"k-vue2-h5":2,"k-vue2-h5-uni":3,"k-vue2-app-uni":4,"k-vue2-mp-uni":5,"k-vue2-pc-uni":6,"k-vue3-pc":7,"k-vue3-h5":8,"k-vue3-h5-uni":9,"k-vue3-app-uni":10,"k-vue3-mp-uni":11,"k-vue3-pc-uni":12,"k-rn":13},Ga=(s(Fa,Un),ta=g(Fa),i(Fa,[{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this._helloInterval==0&&this._hello()}},{key:"getPushModule",value:function(){var e=void 0,t=this.get(36),n=this.get(28);return t.canIUseTIMPush()?e=t:n.canIUseOfflinePush()&&(e=n),e}},{key:"login",value:function(e){if(this.isLoggedIn())return t=this.getMyUserID(),(t=this.getErrMsg("RepeatLogin",t))&&Re.w(t),Sn({actionStatus:"OK",errorCode:0,errorInfo:t,repeatLogin:!0});if(Date.now()-this._lastLoginTs<=15e3)return this.warn("LoggingIn",e.userID),Mn({code:zn.REPEAT_LOGIN});if(Re.l("".concat(this._n,".login userID:").concat(e.userID)),0!==(t=this._checkLoginInfo(e)).code)return Mn(t);var t=this.get(12),n=e.userID;return e=e.userSig,t.setUserID(n),t.setUserSig(e),this.get(20).updateProtocolConfig(),this._login()}},{key:"_login",value:function(){var e=this,t=this.get(12),n=t.getScene(),o=0,a=n,i=(n&&n.startsWith("k-")&&(a=Ba[n],n="tuikit"),new io("login")),r=(i.setMessage("".concat(a)).setMoreMessage("identifier:".concat(this.getMyUserID())),"tuikit"===n),s=0,l=(J?s=r?3===a||4===a||5===a||6===a?31:9===a||10===a||11===a||12===a?32:4:3:X?s=H?36:"tuikit"===n?12:11:te?s=me?"flutter_web_uikit"===n?21:20:this._isReactUIKit()?ge?25:24:r?1===a||2===a?29:7===a||8===a?30:ge?17:14:ge?16:13:13===a&&(s=38),i.setUIPlatform(s),t.setUIPlatform(s),(r=this.getPushModule())&&(this._isWebUniapp=r.getUniAppPlatform(),a=this._getStatusInstanceID(),t.setStatusInstanceID(a),this.get(20).updateProtocolConfig(),o=r.getDeviceBrand()),"".concat(this._n,"._login"));return this._lastLoginTs=Date.now(),this.req({P:jn.LOGIN,data:{deviceBrand:o,isWebUniapp:this._isWebUniapp,customInfo:t.getCustomLoginInfo()}}).then((function(o){e._lastLoginTs=0;var a=Date.now(),r=null,s=(g=o.data).a2Key,c=g.tinyID,u=g.helloInterval,d=g.instanceID,p=g.timeStamp,h=void 0===(h=g.customStatus)?"":h,f=g.purchaseBits,g=void 0===(g=g.authKey)?"":g,m=1e3*p,v=a-i.getStartTs();if(v=m+parseInt(v/2)-a,a=i.getStartTs()+v,i.start(a),a=m,Me=v,(m=new Date).setTime(a),Re.i("baseTime from server:".concat(m," offset:").concat(Me)),!c)throw r=new Fn({code:zn.NO_TINYID}),i.setError(r).end(),r;if(!s)throw r=new Fn({code:zn.NO_A2KEY}),i.setError(r).end(),r;return a=e.get(21).getSocketID(),m=ea(h),r="socketID:".concat(a," scene:").concat(n," helloInterval:").concat(u," instanceID:").concat(d," timeStamp:").concat(p)+" offset:".concat(v," customStatus:").concat(m," isWebUniapp:").concat(e._isWebUniapp),Re.l("".concat(l," ok. ").concat(r)),h="",a="",z&&Xe(ne.getAccountInfoSync)&&(p=ne.getAccountInfoSync().miniProgram)&&(h=p.appId,a=p.envVersion),i.setMoreMessage("".concat(r," href:").concat(te?window.location.href:""," mpAppId:").concat(h," envVersion:").concat(a," authKey:").concat(g)).end(),t.setA2Key(s),t.setTinyID(c),t.setStatusInstanceID(d),t.setCustomStatus(m),t.setDowloadFileAuthKey(g),f&&e.get(27).onPushedConfig({errorCode:0,expiredTime:0,purchaseBits:f}),e.get(20).updateProtocolConfig(),e.emitIEvt(Yo.A2KEY_AND_TINYID_UPDATED),e._helloInterval=u,e.triggerReady(),(v=e.getPushModule())&&(uni.setStorageSync("timUniAppInstanceID",d),v.init()),e._fetchCloudControlConfig(),e.get(29).init(),o})).catch((function(t){return i.setError(t).end(!0),e._m.setNotReadyReason(zn.LOGIN_FAILED),Re.e("".concat(l," failed. error:"),t),e._lastLoginTs=0,e._m.onLoginFailed(),Mn(t)}))}},{key:"logout",value:function(){var e=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,n="".concat(this._n,".logout"),o=this.isLoggedIn();return Re.i("".concat(n," type:").concat(t," isLoggedIn:").concat(o," isWebUniapp:").concat(this._isWebUniapp)),o?(new io("logout").setMessage("identifier:".concat(this.getMyUserID())).end(!0),0===t&&this._m.setNotReadyReason(zn.LOGGED_OUT),this.req({P:jn.LOGOUT,data:{type:t,isWebUniapp:this._isWebUniapp}}).then((function(){return e.resetReady(),Sn({})})).catch((function(t){return Re.e("".concat(n," error:"),t),e.resetReady(),Sn({})}))):Mn({code:zn.USER_NOT_LOGGED_IN})}},{key:"getLoginUser",value:function(){return this.isLoggedIn()?this.getMyUserID():""}},{key:"_fetchCloudControlConfig",value:function(){this.get(23).fetchConfig()}},{key:"_getStatusInstanceID",value:function(){return uni.getStorageSync("timUniAppInstanceID")||0}},{key:"_hello",value:function(){var e=this;this._lastWsHelloTs=Date.now(),this.req({P:jn.HELLO,data:{isWebUniapp:this._isWebUniapp}}).catch((function(t){Re.w("".concat(e._n,"._hello error:"),t)}))}},{key:"getLastWsHelloTs",value:function(){return this._lastWsHelloTs}},{key:"_checkLoginInfo",value:function(e){var t=0;return He(this.get(12).getSDKAppID())?t=zn.NO_SDKAPPID:He(e.userID)?t=zn.NO_IDENTIFIER:He(e.userSig)&&(t=zn.NO_USERSIG),{code:t}}},{key:"_isReactUIKit",value:function(){return te&&void 0!==window.tencent_cloud_im_csig_react_uikit_23F_xa}},{key:"onMultipleAccountKickedOut",value:function(e){var t=this;new io("kickedOut").setMessage("type:".concat(S.KICKED_OUT_MULT_ACCOUNT," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Re.w("".concat(this._n,".onMultipleAccountKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOEvt(T.KICKED_OUT,{type:S.KICKED_OUT_MULT_ACCOUNT}),t._m.setNotReadyReason(zn.KICKED_OUT_MULT_ACCOUNT),t._m.reset()}))}},{key:"onMultipleDeviceKickedOut",value:function(e){var t=this;new io("kickedOut").setMessage("type:".concat(S.KICKED_OUT_MULT_DEVICE," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Re.w("".concat(this._n,".onMultipleDeviceKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),this.logout(1).then((function(){t.emitOEvt(T.KICKED_OUT,{type:S.KICKED_OUT_MULT_DEVICE}),t._m.setNotReadyReason(zn.KICKED_OUT_MULT_DEVICE),t._m.reset()}))}},{key:"onUserSigExpired",value:function(){new io("kickedOut").setMessage(S.KICKED_OUT_USERSIG_EXPIRED).end(!0),Re.w("".concat(this._n,".onUserSigExpired userID:").concat(this.getMyUserID())),0!==this.get(12).getStatusInstanceID()&&(this.emitOEvt(T.KICKED_OUT,{type:S.KICKED_OUT_USERSIG_EXPIRED}),this._m.setNotReadyReason(zn.KICKED_OUT_USERSIG_EXPIRED),this._m.reset())}},{key:"onRestApiKickedOut",value:function(e){new io("kickedOut").setMessage("type:".concat(S.KICKED_OUT_REST_API," newInstanceInfo:").concat(JSON.stringify(e))).end(!0),Re.w("".concat(this._n,".onRestApiKickedOut userID:").concat(this.getMyUserID()," newInstanceInfo:"),e),0!==this.get(12).getStatusInstanceID()&&(this.emitOEvt(T.KICKED_OUT,{type:S.KICKED_OUT_REST_API}),this._m.setNotReadyReason(zn.KICKED_OUT_REST_API),this._m.reset(),this.get(21).onRestApiKickedOut())}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this.resetReady(),this._helloInterval=120,this._lastLoginTs=0,this._lastWsHelloTs=0,this._isWebUniapp=0}}]),Fa);function Fa(e){return o(this,Fa),(e=ta.call(this,e))._n="SignModule",e._helloInterval=120,e._lastLoginTs=0,e._lastWsHelloTs=0,e._isWebUniapp=0,Jo.mixin(f(e)),e}function za(e,t){o(this,za),this._m=e,this._isLoggedIn=!1,this._SDKAppID=t.SDKAppID,this._userID=t.userID||"",this._userSig=t.userSig||"",this._version="3.5.2",this._a2Key="",this._tinyID="",this._customStatus="",this._contentType="json",this._unlimitedAVChatRoom=t.unlimitedAVChatRoom,this._scene=t.scene||"",this._oversea=t.oversea,this._instanceID=t.instanceID,this._statusInstanceID=0,this._isDevMode=t.devMode,this._isTestEnv=t.testEnv,this._proxyServer=t.proxyServer,this._fileUploadProxy=t.fileUploadProxy,this._fileDownloadProxy=t.fileDownloadProxy,this._applicationID=0,this._isPartialUpdatedConvs=t.partialUpdatedConversations,this._isIndependentDomainDisabled=t.disableIndependentDomain,this._isUsingChatCore=!1,this._uiPlatform=0,this._authKey="",this._customLoginInfo=""}function Ha(e){return o(this,Ha),(e=na.call(this,e))._n="UserModule",e._profileHandler=new Aa(f(e)),e._blacklistHandler=new Pa(f(e)),e._userStatusHandler=new Ua(f(e)),e.getIEmitInst().on(Yo.A2KEY_AND_TINYID_UPDATED,e.onContextUpdated,f(e)),e}function ja(e){o(this,ja),this._userM=e,this._n="UserStatusHandler",this.MAX_QUERY_USER_COUNT=500,this.MAX_SUBSCRIBE_USER_COUNT=100,this.MAX_UNSUBSCRIBE_USER_COUNT=100,this._userM.getIEmitInst().on(Yo.CLOUD_CONFIG,this._onCloudConfig,this)}function qa(e){o(this,qa),this._userM=e,this._n="BlacklistHandler",this._blacklistMap=new Map,this._startIndex=0}function Ka(e){o(this,Ka),this._userM=e,this._n="ProfileHandler",this.TAG="profile",this.accountProfileMap=new Map,this.expirationTime=864e5}function Ya(e){return o(this,Ya),(e=oa.call(this,e))._n="TopicModule",e._topicMap=new Map,e._getTopicTimeMap=new Map,e.TOPIC_CACHE_TIME=300,e.TOPIC_LAST_ACTIVE_TIME=3600,e.getIEmitInst().on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function $a(e,t){o(this,$a),this.topicID="",this.topicName="",this.avatar="",this.introduction="",this.notification="",this.unreadCount=0,this.muteAllMembers=!1,this.customData="",this.groupAtInfoList=[],this.nextMessageSeq=0,this.lastMessage=Qo(e.lastMessage,t),this.selfInfo={muteTime:0,readedSequence:0,messageRemindType:"",excludedUnreadSequenceList:void 0},this._initTopic(e)}function Wa(e){return o(this,Wa),(e=aa.call(this,e))._n="GroupModule",e._commonGroupHandler=new _a(f(e)),e._groupAttributesHandler=new ya(f(e)),e._groupCountersHandler=new Ia(f(e)),e._AVChatRoomHandler=new Ea(f(e)),e._groupTipsHandler=new va(f(e)),e._groupSystemNoticeHandler=new wa(f(e)),e._groupMemberHandler=new Sa(f(e)),e.groupMap=new Map,e._unjoinedAVChatRoomList=new Map,e._receiptDetailCompleteMap=new Map,e._onlineMemberCountMap=new Map,e._timeoutIDs=[],e.getIEmitInst().on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function Za(e){o(this,Za),this._grpM=e,this._n="GroupSystemNoticeHandler",this.pendencyMap=new Map}function Ja(e){o(this,Ja),this._grpM=e,this._n="GroupMemberHandler",this.groupMemberListMap=new Map,this.DEFAULT_MEMBER_INFO_FILTER=["Role","JoinTime","NameCard","ShutUpUntil","OnlineStatus"],this._grpM.getIEmitInst().on(Yo.PROFILE_UPDATED,this._onProfileUpdated,this)}function Xa(e){o(this,Xa),this.userID="",this.avatar="",this.nick="",this.role="",this.joinTime="",this.lastSendMsgTime="",this.nameCard="",this.muteUntil=0,this.memberCustomField=[],this.isOnline=!1,this.updateMember(e)}function Qa(e){o(this,Qa),this._grpM=e,this._n="AVChatRoomHandler",this._joinedGroupMap=new Map,this._pollingRequestInfoMap=new Map,this._pollingInstanceMap=new Map,this._seqSll=new ca(200),this._IDSll=new ca(100),this._reportMessageStackedCount=0,this._onlineMemberCountMap=new Map,this.DEFAULT_EXPIRE_TIME=60,this.DEFAULT_POLLING_INTERVAL=300,this.MAX_POLLING_INTERVAL=2e3,this._pollingInterval=this.DEFAULT_POLLING_INTERVAL,this.DEFAULT_POLLING_NO_MESSAGE_COUNT=20,this.DEFAULT_POLLING_INTERVAL_PLUS=2e3,this._pollingNoMessageCount=0,this._startBroadcastSeq=1,this._broadcastMessageIDMap=new Map,this.DEFAULT_POLLING_SIMPLIFIED_MSG=0}function ei(e){o(this,ei);var t=e.manager,n=e.groupID,a=e.onInit,i=e.onSuccess;e=e.onFail,this._n="Polling",this._manager=t,this._grpM=t._grpM,this._onInit=a,this._onSuccess=i,this._onFail=e,this._groupID=n,this._timeoutID=-1,this._isRunning=!1,this._proto=jn.AV_POLLING}function ti(e){o(this,ti),this._grpM=e,this._n="GroupCountersHandler",this._groupCountersMap=new Map,this.EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(Yo.CLOUD_CONFIG,this._onCloudConfig,this)}function ni(e){o(this,ni),this._grpM=e,this._n="GroupAttributesHandler",this._groupAttributesMap=new Map,this._groupAttributesCopy={},this.CACHE_EXPIRE_TIME=3e4,this._grpM.getIEmitInst().on(Yo.CLOUD_CONFIG,this._onCloudConfig,this)}function oi(e){o(this,oi),this._grpM=e,this._n="CommonGroupHandler",this.tempConversationList=null,this._cachedGroupMessageMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4,this.PAGING_GRP_COUNT_LIMIT=200,this._pagingStatus=Rn,this._pagingGetCostList=[],e.getIEmitInst().on(Yo.A2KEY_AND_TINYID_UPDATED,this.syncGroupList,this)}function ai(e){o(this,ai),this._grpM=e,this._n="GroupTipsHandler",this._cachedGroupTipsMap=new Map,this._checkCountMap=new Map,this.MAX_CHECK_COUNT=4}function ii(e){return o(this,ii),(e=ia.call(this,e))._n="ConvModule",Jo.mixin(f(e)),e._msgListHandler=new $o(f(e)),e._msgRemindHandler=new fa(f(e)),e._convGroupHandler=new ga(f(e)),e._sll=new ca(100),e._pagingStatus=Rn,e._pagingTs=0,e._pagingStartIdx=0,e._pagingPinnedTs=0,e._pagingPinnedStartIdx=0,e._pagingConvIDMap=new Map,e._convIDFromUnreadDBMap=new Map,e._convMap=new Map,e._tmpGroupList=[],e._tmpGroupAtTipsList=[],e._peerReadTimeMap=new Map,e._completedMap=new Map,e._roamingMsgKeyAndTimeMap=new Map,e._remoteGroupReadSeqMap=new Map,e._convTotalUnreadCount=0,e._pagingGetCostList=[],e._convMapForDiff=new Map,e._partialUpdatedConvMap=new Map,e._everClearedMap=new Map,e._bPullOnInvite=!0,e._initListeners(),e}function ri(e){o(this,ri),this._convM=e,this._n="ConvGroupHandler",this._convGroupMap=new Map,this._startIndex=0,this._pagingStatus=Rn}function si(e){o(this,si),this._convM=e,this._n="MsgRemindHandler"}function li(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];o(this,li),this.conversationID=e.conversationID||"",this.unreadCount=e.unreadCount||0,this.type=e.type||"",this.lastMessage=Xo(e.lastMessage,t,n),e.lastMsgTime&&(this.lastMessage.lastTime=e.lastMsgTime),this._isInfoCompleted=!1,this.peerReadTime=e.peerReadTime||0,this.groupAtInfoList=[],this.remark="",this.isPinned=e.isPinned||!1,this.messageRemindType=e.messageRemindType,this.markList=e.markList||[],this.customData=e.customData||"",this.conversationGroupList=e.conversationGroupList||[],this.draftText=e.draftText||"",this._initProfile(e),this.subType=this.groupProfile?this.groupProfile.type:""}function ci(e){o(this,ci),this.groupID="",this.name="",this.avatar="",this.type="",this.introduction="",this.notification="",this.ownerID="",this.createTime="",this.infoSequence="",this.lastInfoTime="",this.selfInfo={messageRemindType:"",joinTime:"",nameCard:"",role:"",userID:"",memberCustomField:void 0,readedSequence:0,excludedUnreadSequenceList:void 0},this.lastMessage={lastTime:"",lastSequence:"",fromAccount:"",messageForShow:""},this.nextMessageSeq="",this.memberNum="",this.memberCount="",this.maxMemberNum="",this.maxMemberCount="",this.joinOption="",this.inviteOption="",this.groupCustomField=[],this.muteAllMembers=!1,this.isSupportTopic=!1,this._lastRevokedTime=0,this._initGroup(e)}function ui(e){o(this,ui),this.MAX_LENGTH=e,this.map=new Map}function di(e){var t=this;o(this,di),He(e)||(this.userID=e.userID||"",this.nick=e.nick||"",this.gender=e.gender||"",this.birthday=e.birthday||0,this.location=e.location||"",this.selfSignature=e.selfSignature||"",this.allowType=e.allowType||S.ALLOW_TYPE_ALLOW_ANY,this.language=e.language||0,this.avatar=e.avatar||"",this.messageSettings=e.messageSettings||0,this.adminForbidType=e.adminForbidType||S.FORBID_TYPE_NONE,this.level=e.level||0,this.role=e.role||0,this.lastUpdatedTime=0,this.profileCustomField=[],He(e.profileCustomField)||e.profileCustomField.forEach((function(e){t.profileCustomField.push({key:e.key,value:e.value})})))}function pi(){return null}function hi(e){var t=e.get(12);return{SDKType:10,SDKAppID:t.getSDKAppID(),SDKVersion:t.getVersion(),tinyID:Number(t.getTinyID()),userID:t.getUserID(),platform:e.getPlatform(),instanceID:t.getInstanceID(),traceID:we()}}i(Ti,[{key:"_errorTolerantHandle",value:function(){X||"undefined"!=typeof window&&this._canIUseCookies()||(this.getItem=pi,this.setItem=pi,this.removeItem=pi,this.clear=pi)}},{key:"onCheckTimer",value:function(e){e%20==0&&0!==this._storageQueue.size&&this._doFlush()}},{key:"_doFlush",value:function(){try{var e,t=E(this._storageQueue);try{for(t.s();!(e=t.n()).done;){var n=m(e.value,2),o=n[0],a=n[1];this._setStorageSync(this._getKey(o),a)}}catch(i){t.e(i)}finally{t.f()}this._storageQueue.clear()}catch(i){Re.w("".concat(this._n,"._doFlush error:"),i)}}},{key:"_getPrefix",value:function(){var e=this._m.get(12);return"TIM_".concat(e.getSDKAppID(),"_").concat(e.getUserID(),"_")}},{key:"_getKey",value:function(e){return"".concat(this._getPrefix()).concat(e)}},{key:"getItem",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;return this.getStorageSync(n)}catch(o){return Re.w("".concat(this._n,".getItem error:"),o),{}}}},{key:"setItem",value:function(e,t){var n;2<arguments.length&&void 0!==arguments[2]&&arguments[2]?(n=3<arguments.length&&void 0!==arguments[3]&&!arguments[3]?e:this._getKey(e),this._setStorageSync(n,t)):this._storageQueue.set(e,t)}},{key:"clear",value:function(){try{X?ne.clearStorageSync():this._canIUseCookies()&&localStorage.clear()}catch(e){Re.w("".concat(this._n,".clear error:"),e)}}},{key:"removeItem",value:function(e){var t=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];try{var n=t?this._getKey(e):e;this._removeStorageSync(n)}catch(o){Re.w("".concat(this._n,".removeItem error:"),o)}}},{key:"getSize",value:function(e){var t=this,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"b";try{var o={size:0,limitSize:5242880,unit:n};if(Object.defineProperty(o,"leftSize",{enumerable:!0,get:function(){return o.limitSize-o.size}}),X&&(o.limitSize=1024*ne.getStorageInfoSync().limitSize),e)o.size=JSON.stringify(this.getItem(e)).length+this._getKey(e).length;else if(X)ne.getStorageInfoSync().keys.forEach((function(e){o.size+=JSON.stringify(t.getStorageSync(e)).length+t._getKey(e).length}));else if(this._canIUseCookies())for(var a in localStorage)localStorage.hasOwnProperty(a)&&(o.size+=localStorage.getItem(a).length+a.length);return this._convertUnit(o)}catch(i){Re.w("".concat(this._n," error:"),i)}}},{key:"_convertUnit",value:function(e){var t,n={},o=e.unit;for(t in n.unit=o,e)"number"==typeof e[t]&&("kb"===o.toLowerCase()?n[t]=Math.round(e[t]/1024):"mb"===o.toLowerCase()?n[t]=Math.round(e[t]/1024/1024):n[t]=e[t]);return n}},{key:"_setStorageSync",value:function(e,t){X?Y?my.setStorageSync({key:e,data:t}):ne.setStorageSync(e,t):this._canIUseCookies()&&localStorage.setItem(e,JSON.stringify(t))}},{key:"getStorageSync",value:function(e){return X?Y?my.getStorageSync({key:e}).data:ne.getStorageSync(e):this._canIUseCookies()?JSON.parse(localStorage.getItem(e)):{}}},{key:"_removeStorageSync",value:function(e){X?Y?my.removeStorageSync({key:e}):ne.removeStorageSync(e):this._canIUseCookies()&&localStorage.removeItem(e)}},{key:"_canIUseCookies",value:function(){return"undefined"!=typeof window&&navigator&&navigator.cookieEnabled&&localStorage}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._doFlush()}}]);var fi,gi=Ti,mi=(i(Ei,[{key:"pushIn",value:function(e){Re.d("".concat(this._n,".pushIn"),this._report.length,e),this._report.push(e)}},{key:"backfill",value:function(e){var t;Ze(e)&&0!==e.length&&(Re.d("".concat(this._n,".backfill"),this._report.length,e.length),(t=this._report).unshift.apply(t,v(e)))}},{key:"getLogsNumInMemory",value:function(){return this._report.length}},{key:"isEmpty",value:function(){return 0===this._report.length}},{key:"_reset",value:function(){this._report.length=0,this._report=[]}},{key:"getLogsInMemory",value:function(){var e=this._report.slice();return this._reset(),e}}]),Ei),vi=(s(ki,Un),fi=g(ki),i(ki,[{key:"reportAtOnce",value:function(){this._report()}},{key:"_onLoginSuccess",value:function(){var e=this,t=this.get(13),n=t.getItem(this.TAG,!1);!He(n)&&Xe(n.forEach)&&(Re.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach((function(t){e._reportBody.pushIn(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("evt_rpt_threshold"),t=this.getCloudConfig("evt_rpt_waiting"),n=this.getCloudConfig("evt_rpt_level"),o=this.getCloudConfig("evt_rpt_sdkappid_bl"),a=this.getCloudConfig("evt_rpt_tinyid_wl");pt(e)||(this.MIN_THRESHOLD=Number(e)),pt(t)||(this.WAITING_TIME=Number(t)),pt(n)||(this.REPORT_LEVEL=n.split(",").map((function(e){return Number(e)}))),pt(o)||(this.REPORT_SDKAPPID_BLACKLIST=o.split(",").map((function(e){return Number(e)}))),pt(a)||(this.REPORT_TINYID_WHITELIST=a.split(","))}},{key:"pushIn",value:function(e){e instanceof io&&(e.updateTimeStamp(),this._reportBody.pushIn(e),this._reportBody.getLogsNumInMemory()>=this.MIN_THRESHOLD&&this._report())}},{key:"onCheckTimer",value:function(){Date.now()<this._lastReportTime+this.WAITING_TIME||this._reportBody.isEmpty()||this._report()}},{key:"_filterLogs",value:function(e){var t=this,n=(o=this.get(12)).getSDKAppID(),o=o.getTinyID();return Vt(this.REPORT_SDKAPPID_BLACKLIST,n)&&!Bt(this.REPORT_TINYID_WHITELIST,o)?[]:e.filter((function(e){return t.REPORT_LEVEL.includes(e.level)}))}},{key:"_report",value:function(){var e,n,o=this;this._reportBody.isEmpty()||(e=this._reportBody.getLogsInMemory(),0!==(n=this._filterLogs(e)).length?(n={header:hi(this),event:n},this.req({P:jn.SSO_STAT,data:t({},n)}).then((function(){o._lastReportTime=Date.now()})).catch((function(t){Re.w("".concat(o._n,"._report failed. error:"),t),o._lastReportTime=Date.now(),o._reportBody.backfill(e),o._reportBody.getLogsNumInMemory()>o.MAX_THRESHOLD&&o._flushAtOnce()}))):this._lastReportTime=Date.now())}},{key:"_flushAtOnce",value:function(){var e=this.get(13),t=e.getItem(this.TAG,!1),n=this._reportBody.getLogsInMemory(),o="".concat(this._n,"._flushAtOnce");He(t)?(Re.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)):((n=n.concat(t)).length>this.MAX_THRESHOLD&&(n=n.slice(0,this.MAX_THRESHOLD)),Re.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._lastReportTime=0,this._report(),this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[]}}]),ki),_i="none",yi="online",Ii=(i(Ci,[{key:"_startRN",value:function(){var e,t=this;!ee||(e=this._m.get(18).getPlugin("chat-network-monitor"))&&(this._removeListener=e.addEventListener((function(e){var n=e.isConnected;e=e.type,t._networkType!==e&&t._onNetworkStatusChange({isConnected:void 0!==n&&n,networkType:e})})))}},{key:"start",value:function(){var e=this,t="".concat(this._n,".start");X?(ne.getNetworkType({success:function(n){e._networkType=n.networkType||n.subtype||"",n.networkType===_i?Re.w("".concat(t," no network, please check!")):Re.i("".concat(t," networkType:").concat(n.networkType))}}),this._mpNetworkStatusCallback=this._onNetworkStatusChange.bind(this),ne.onNetworkStatusChange(this._mpNetworkStatusCallback)):te&&(this._networkType=yi,this._webOnlineCallback=this._onWebOnline.bind(this),this._webOfflineCallback=this._onWebOffline.bind(this),window.addEventListener("online",this._webOnlineCallback),window.addEventListener("offline",this._webOfflineCallback))}},{key:"_onWebOnline",value:function(){this._onNetworkStatusChange({isConnected:!0,networkType:yi})}},{key:"_onWebOffline",value:function(){this._onNetworkStatusChange({isConnected:!1,networkType:_i})}},{key:"_onNetworkStatusChange",value:function(e){var t=e.isConnected,n=(e=e.networkType,"".concat(this._n,"._onNetworkStatusChange")),o=!1,a="previous:".concat(this._networkType," current:").concat(e);t?(Re.i("".concat(n," ").concat(a)),this._networkType!==e&&(o=!0,this._networkType=e,this._m.get(21).reConnect(!0))):this._networkType!==e&&(o=!0,this._networkType=e,Re.w("".concat(n," no network, please check!")),this._m.get(21).offline()),o&&new io("networkChange").setMessage("isConnected:".concat(t," ").concat(a)).end()}},{key:"isOnline",value:function(){return this._networkType!==_i}},{key:"getNetworkType",value:function(){return this._networkType}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),X?null!==this._mpNetworkStatusCallback&&(ne.offNetworkStatusChange&&ne.offNetworkStatusChange(this._mpNetworkStatusCallback),this._mpNetworkStatusCallback=null):te?(null!==this._webOnlineCallback&&(window.removeEventListener("online",this._webOnlineCallback),this._webOnlineCallback=null),null!==this._onWebOffline&&(window.removeEventListener("offline",this._webOfflineCallback),this._webOfflineCallback=null)):ee&&this._removeListener&&(this._removeListener(),this._removeListener=null)}}]),Ci);function Ci(e){o(this,Ci),this._m=e,this._networkType=yi,this._n="NetMonitorModule",this._mpNetworkStatusCallback=null,this._webOnlineCallback=null,this._webOfflineCallback=null,this._removeListener=null,this._m.getIEmitInst().on(Yo.A2KEY_AND_TINYID_UPDATED,this._startRN,this)}function ki(e){o(this,ki),(e=fi.call(this,e))._n="EventStatModule",e.TAG="im-ssolog-event",e._reportBody=new mi,e.MIN_THRESHOLD=20,e.MAX_THRESHOLD=100,e.WAITING_TIME=6e4,e.REPORT_LEVEL=[4,5,6],e.REPORT_SDKAPPID_BLACKLIST=[],e.REPORT_TINYID_WHITELIST=[],e._lastReportTime=Date.now();var t=e.getIEmitInst();return t.on(Yo.A2KEY_AND_TINYID_UPDATED,e._onLoginSuccess,f(e)),t.on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function Ei(e){o(this,Ei),this._n="SSOLogBody",this._report=[]}function Ti(e){o(this,Ti),this._m=e,this._n="StorageModule",this._storageQueue=new Map,this._errorTolerantHandle()}function Si(e,t){return e(t={exports:{}},t.exports),t.exports}var Mi,wi=Si((function(e){var t=Object.prototype.hasOwnProperty,n="~";function o(){}function a(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function i(e,t,o,i,r){if("function"!=typeof o)throw new TypeError("The listener must be a function");return o=new a(o,i||e,r),i=n?n+t:t,e._events[i]?e._events[i].fn?e._events[i]=[e._events[i],o]:e._events[i].push(o):(e._events[i]=o,e._eventsCount++),e}function r(e,t){0==--e._eventsCount?e._events=new o:delete e._events[t]}function s(){this._events=new o,this._eventsCount=0}Object.create&&(o.prototype=Object.create(null),(new o).__proto__||(n=!1)),s.prototype.eventNames=function(){var e,o,a=[];if(0===this._eventsCount)return a;for(o in e=this._events)t.call(e,o)&&a.push(n?o.slice(1):o);return Object.getOwnPropertySymbols?a.concat(Object.getOwnPropertySymbols(e)):a},s.prototype.listeners=function(e){e=n?n+e:e;var t=this._events[e];if(!t)return[];if(t.fn)return[t.fn];for(var o=0,a=t.length,i=new Array(a);o<a;o++)i[o]=t[o].fn;return i},s.prototype.listenerCount=function(e){return e=n?n+e:e,(e=this._events[e])?e.fn?1:e.length:0},s.prototype.emit=function(e,t,o,a,i,r){var s=n?n+e:e;if(!this._events[s])return!1;var l,c=this._events[s],u=arguments.length;if(c.fn){switch(c.once&&this.removeListener(e,c.fn,void 0,!0),u){case 1:return c.fn.call(c.context),!0;case 2:return c.fn.call(c.context,t),!0;case 3:return c.fn.call(c.context,t,o),!0;case 4:return c.fn.call(c.context,t,o,a),!0;case 5:return c.fn.call(c.context,t,o,a,i),!0;case 6:return c.fn.call(c.context,t,o,a,i,r),!0}for(h=1,l=new Array(u-1);h<u;h++)l[h-1]=arguments[h];c.fn.apply(c.context,l)}else for(var d,p=c.length,h=0;h<p;h++)switch(c[h].once&&this.removeListener(e,c[h].fn,void 0,!0),u){case 1:c[h].fn.call(c[h].context);break;case 2:c[h].fn.call(c[h].context,t);break;case 3:c[h].fn.call(c[h].context,t,o);break;case 4:c[h].fn.call(c[h].context,t,o,a);break;default:if(!l)for(d=1,l=new Array(u-1);d<u;d++)l[d-1]=arguments[d];c[h].fn.apply(c[h].context,l)}return!0},s.prototype.on=function(e,t,n){return i(this,e,t,n,!1)},s.prototype.once=function(e,t,n){return i(this,e,t,n,!0)},s.prototype.removeListener=function(e,t,o,a){if(e=n?n+e:e,!this._events[e])return this;if(!t)return r(this,e),this;var i=this._events[e];if(i.fn)i.fn!==t||a&&!i.once||o&&i.context!==o||r(this,e);else{for(var s=0,l=[],c=i.length;s<c;s++)(i[s].fn!==t||a&&!i[s].once||o&&i[s].context!==o)&&l.push(i[s]);l.length?this._events[e]=1===l.length?l[0]:l:r(this,e)}return this},s.prototype.removeAllListeners=function(e){return e?(e=n?n+e:e,this._events[e]&&r(this,e)):(this._events=new o,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=n,e.exports=s.EventEmitter=s})),bi=["rich.my-imcloud.com","imrich.qcloud.com"],Di=["requestSnapshotUrl"],Ni=(s(Ui,Un),Mi=g(Ui),i(Ui,[{key:"_init",value:function(){this._fileDownloadProxy=this.getFileDownloadProxy(),this._authKey=this.getDowloadFileAuthKey();var e=this.get(18);this.TIMUploadPlugin=e.getPlugin("tim-upload-plugin"),this.TIMUploadPlugin?this._initUploaderMethod():(this.COSSDK=e.getPlugin(e=X?"cos-wx-sdk":"cos-js-sdk"),this.COSSDK?(this._getAuthorizationKey(),this.warn("CosReplacement",e)):this.warn("PluginUndetected"))}},{key:"_onCloudConfig",value:function(){var e=this,t="".concat(this._n,"._onCloudConfig"),n=this.getCloudConfig("upload_size_limit"),o=this.getCloudConfig("simple_cos"),a=this.getCloudConfig("file_dn_list");if(Re.l("".concat(t," uploadSizeLimit:").concat(n," simpleCos:").concat(o)),!pt(n))try{var i=JSON.parse(n);this.UPLOAD_SIZE_LIMIT={A:i.a?1048576*parseInt(i.a):this.UPLOAD_SIZE_LIMIT.A,F:i.f?1048576*parseInt(i.f):this.UPLOAD_SIZE_LIMIT.F,I:i.i?1048576*parseInt(i.i):this.UPLOAD_SIZE_LIMIT.I,V:i.v?1048576*parseInt(i.v):this.UPLOAD_SIZE_LIMIT.V}}catch(r){}if(pt(o)||(this.isSimpleCos="1"===o),!pt(a))try{JSON.parse(a).forEach((function(t){e._fileDNList.includes(t)||e._fileDNList.push(t)}))}catch(r){}}},{key:"_getAuthorizationKey",value:function(){var e=this,t="".concat(this._n,".").concat("_getAuthorizationKey"),n=new io("_getAuthorizationKey"),o=Math.ceil(Date.now()/1e3);this.req({P:jn.COS_SIGN,data:{duration:this.expiredTimeLimit}}).then((function(a){a=a.data;var i=(Re.l("".concat(t," ok. data:"),a),a.expiredTime-o);n.setMessage("requestId:".concat(a.requestId," requestTime:").concat(o," expiredTime:").concat(a.expiredTime," diff:").concat(i,"s")).end(),!X&&a.region&&(e.region=a.region),e.appid=a.appid,e.bucketName=a.bucketName,e.ciUrl=a.ciUrl,e.directory=a.directory,e.downloadUrl=a.downloadUrl,e.uploadUrl=a.uploadUrl,e.cosOptions={secretId:a.secretId,secretKey:a.secretKey,sessionToken:a.sessionToken,expiredTime:a.expiredTime},Re.l("".concat(t," ok. region:").concat(e.region," bucketName:").concat(e.bucketName)),e._initUploaderMethod()})).catch((function(e){n.setError(e).end(),Re.w("".concat(t," failed. error:"),e)}))}},{key:"_getCosPreSigUrl",value:function(e){var t=this,n="".concat(this._n,".").concat("_getCosPreSigUrl"),o=Math.ceil(Date.now()/1e3),a=new io("_getCosPreSigUrl"),i={uploadMethod:e.uploadMethod,platform:this.getPlatform(),SDKAppID:this.getSDKAppID(),userID:e.userID,conversationType:e.conversationType,uploadConfig:[{fileID:1,fileType:e.fileType,fileName:e.fileName}]},r=jn.SIMPLE_COS_PRE_SIG;return this.isSimpleCos||(i={fileType:e.fileType,fileName:e.fileName,uploadMethod:e.uploadMethod,duration:e.duration},r=jn.COS_PRE_SIG),this.req({P:r,data:i}).then((function(e){t.tryCount=0,e=e.data||{};var i,r,s=(Re.l("".concat(n," ok. isSimpleCos:").concat(t.isSimpleCos," data:"),e),"");return s=t.isSimpleCos?(i=(r=e.preSig[0]).uploadUrl,r=r.fileKey,"uploadIP:".concat(e.uploadIP," uploadUrl:").concat(i," fileKey:").concat(r," cost:").concat($t(o))):"requestId:".concat(e.requestId," expiredTime:").concat(e.expiredTime," diff:").concat(e.expiredTime-o,"s"),a.setMessage(s).end(),e})).catch((function(o){return-1===o.code&&(o.code=zn.COS_GET_SIG_FAIL),a.setError(o).end(),Re.w("".concat(n," failed. error:"),o),t.tryCount<1?(t.tryCount++,t._getCosPreSigUrl(e)):(t.tryCount=0,Mn({code:zn.COS_GET_SIG_FAIL}))}))}},{key:"_initUploaderMethod",value:function(){var e=this;if(this.TIMUploadPlugin)return this.timUploadPlugin=new this.TIMUploadPlugin,void(this._cosUploadMethod=function(t,n){e.timUploadPlugin.uploadFile(t,n)});this.appid&&(this.cos=X?new this.COSSDK({ForcePathStyle:!0,getAuthorization:this._getAuthorization.bind(this)}):new this.COSSDK({getAuthorization:this._getAuthorization.bind(this)}),this._cosUploadMethod=X?function(t,n){e.cos.postObject(t,n)}:function(t,n){e.cos.uploadFiles(t,n)})}},{key:"onCheckTimer",value:function(e){this.COSSDK&&(this.TIMUploadPlugin||this.isLoggedIn()&&e%60==0&&Math.ceil(Date.now()/1e3)>=this.cosOptions.expiredTime-120&&this._getAuthorizationKey())}},{key:"getFileDNList",value:function(){return this._fileDNList}},{key:"_getAuthorization",value:function(e,t){t({TmpSecretId:this.cosOptions.secretId,TmpSecretKey:this.cosOptions.secretKey,XCosSecurityToken:this.cosOptions.sessionToken,ExpiredTime:this.cosOptions.expiredTime})}},{key:"upload",value:function(e){if(!0===e._relayFlag)return Promise.resolve();var t=this.get(26);switch(e.type){case S.MSG_IMAGE:return t.addTotalCount(Jn),this._uploadImage(e);case S.MSG_FILE:return t.addTotalCount(Jn),this._uploadFile(e);case S.MSG_AUDIO:return t.addTotalCount(Jn),this._uploadAudio(e);case S.MSG_VIDEO:return t.addTotalCount(Jn),this._uploadVideo(e);default:return Promise.resolve()}}},{key:"_uploadImage",value:function(e){var n=this,o=this.get(2),a=e.getElements()[0],i=o.getMessageOption(e.clientSequence);return this.doUploadImage({file:i.payload.file,to:i.to,message:e,onProgress:function(e){if(a.updatePercent(e),Xe(i.onProgress))try{i.onProgress(e)}catch(t){return Mn({code:zn.MSG_ONPROGRESS_ERR})}}}).then((function(o){var i=o.location,r=o.fileType,s=o.fileSize,l=o.width,c=o.height,u=o.smallImageUrl,d=o.smallImageWidth,p=o.smallImageHeight,h=o.largeImageUrl,f=o.largeImageWidth,g=o.largeImageHeight,m=o.imageInfoArray;o=n.isPrivateNetWork()?i:lt(i),a.updateImageFormat(r);var v,_,y={size:s,url:o,width:l,height:c};if(m&&0<m.length)for(var I=0;I<m.length;I++){var C=m[I];1===C.type?v=C:2===C.type?_=C:y=t(t({},y),C)}else _=u&&h?(v={url:u,width:d,height:p},{url:h,width:f,height:g}):(v=Ot({originUrl:o,originWidth:l,originHeight:c,min:198}),Ot({originUrl:o,originWidth:l,originHeight:c,min:720}));return a.updateImageInfoArray([t({},y),t({},_),t({},v)]),e}))}},{key:"_uploadFile",value:function(e){var t=this,n=this.get(2),o=e.getElements()[0],a=n.getMessageOption(e.clientSequence);return this.doUploadFile({file:a.payload.file,to:a.to,message:e,onProgress:function(e){if(o.updatePercent(e),Xe(a.onProgress))try{a.onProgress(e)}catch(t){return Mn({code:zn.MSG_ONPROGRESS_ERR})}}}).then((function(n){var a=n=n.location;return t.isPrivateNetWork()||(a=po(a=lt(n),t._fileDownloadProxy,t._authKey,t._fileDNList)),o.updateFileUrl(a),e}))}},{key:"_uploadAudio",value:function(e){var t=this,n=this.get(2),o=e.getElements()[0],a=n.getMessageOption(e.clientSequence);return this.doUploadAudio({file:a.payload.file,to:a.to,message:e,onProgress:function(e){if(o.updatePercent(e),Xe(a.onProgress))try{a.onProgress(e)}catch(t){return Mn({code:zn.MSG_ONPROGRESS_ERR})}}}).then((function(n){return n=n.location,n=t.isPrivateNetWork()?n:lt(n),o.updateAudioUrl(n),e}))}},{key:"_uploadVideo",value:function(e){var t=this,n=this.get(2),o=e.getElements()[0],a=n.getMessageOption(e.clientSequence);return this.doUploadVideo({file:a.payload.file,to:a.to,message:e,onProgress:function(e){if(o.updatePercent(e),Xe(a.onProgress))try{a.onProgress(e)}catch(t){return Mn({code:zn.MSG_ONPROGRESS_ERR})}}}).then((function(n){var a=n.location;return n=n.snapshotInfo,a=t.isPrivateNetWork()?a:lt(a),o.updateVideoUrl(a),He(n)||o.updateSnapshotInfo(n),e}))}},{key:"_checkSizeError",value:function(e){var t="";return"A"===e?t="audio":"I"===e?t="image":"V"===e?t="video":"F"===e&&(t="file"),Mn({code:zn["MSG_".concat(e,"_SIZE_LIMIT")],message:this.getErrMsg("UploadSizeLimit",t,"".concat(this.UPLOAD_SIZE_LIMIT[e]/1048576,"MB"))})}},{key:"doUploadImage",value:function(e){var t=this;if(!e.file||this._isEmptyFileList(e.file.files))return Mn({code:zn.MSG_I_SELECT_F_FIRST});var n=this._checkImageType(e.file);if(!0!==n)return n;if(!0!==(n=this._checkImageSize(e.file)))return n;var o=null;return this._setUploadFileType(1),this.uploadByCOS(e).then((function(n){if(o=n,t.isPrivateNetWork())return Nt(i);if(Ze(o.imageInfoArray)){var a=o.imageInfoArray.find((function(e){return 3===e.type}));if(a)return a}if(ee)return{width:e.file.width,height:e.file.height};var i=lt(n.location);return t.COSSDK?Nt(i):Nt(i=po(i,t._fileDownloadProxy,t._authKey,t._fileDNList))})).then((function(e){return o.width=e.width,o.height=e.height,Promise.resolve(o)}))}},{key:"_checkImageType",value:function(e){var t="";return t=X?e.url.slice(e.url.lastIndexOf(".")+1):ee?e.type.split("/")[1]:e.files[0].name.slice(e.files[0].name.lastIndexOf(".")+1),0<=ra.indexOf(t.toLowerCase())||Mn({code:zn.MSG_I_TYPES_LIMIT})}},{key:"_checkImageSize",value:function(e){return 0===(e=(X||ee?e:e.files[0]).size)?Mn({code:zn.MSG_F_IS_EMPTY}):e<this.UPLOAD_SIZE_LIMIT.I||this._checkSizeError("I")}},{key:"doUploadFile",value:function(e){return!e.file||this._isEmptyFileList(e.file.files)?Mn({code:zn.MSG_F_SELECT_F_FIRST}):e.file.files[0].size>this.UPLOAD_SIZE_LIMIT.F?this._checkSizeError("F"):0===e.file.files[0].size?Mn({code:zn.MSG_F_IS_EMPTY}):(this._setUploadFileType(255),this.uploadByCOS(e))}},{key:"doUploadVideo",value:function(e){return e.file.videoFile.size>this.UPLOAD_SIZE_LIMIT.V?this._checkSizeError("V"):0===e.file.videoFile.size?Mn({code:zn.MSG_F_IS_EMPTY}):-1===sa.indexOf(e.file.videoFile.type)?Mn({code:zn.MSG_V_TYPES_LIMIT}):(this._setUploadFileType(2),X||ee?this.handleVideoUpload(t(t({},e),{},{file:e.file.videoFile})):te?this.handleVideoUpload(e):void 0)}},{key:"handleVideoUpload",value:function(e){var t=this;return new Promise((function(n,o){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){t.uploadByCOS(e).then((function(e){n(e)})).catch((function(){o(new Fn({code:zn.MSG_V_UPLOAD_FAIL}))}))}))}))}},{key:"doUploadAudio",value:function(e){return e.file?e.file.size>this.UPLOAD_SIZE_LIMIT.A?this._checkSizeError("A"):0===e.file.size?Mn({code:zn.MSG_F_IS_EMPTY}):(this._setUploadFileType(3),this.uploadByCOS(e)):Mn({code:zn.MSG_A_UPLOAD_FAIL})}},{key:"uploadByCOS",value:function(e){var t=this;if(!Xe(this._cosUploadMethod))return this.warn("PluginUndetected"),Mn({code:zn.COS_UNDETECTED});if(this.timUploadPlugin)return this._uploadWithPreSigUrl(e);var n=new io("upload"),o="".concat(this._n,".uploadByCOS"),a=Date.now(),i=this._getFile(e);return new Promise((function(r,s){var l=X?t._createCosOptionsWXMiniApp(e):t._createCosOptionsWeb(e),c=t;t._cosUploadMethod(l,(function(e,l){var u=Object.create(null);if(l){if(e||Ze(l.files)&&l.files[0].error)return d=new Fn({code:zn.MSG_F_UPLOAD_FAIL}),n.setError(d).end(),Re.l("".concat(o," failed. error:"),l.files[0].error),403===l.files[0].error.statusCode&&t._getAuthorizationKey(),void s(d);u.fileName=i.name,u.fileSize=i.size,u.fileType=i.type.slice(i.type.indexOf("/")+1).toLowerCase(),u.location=(X?l:l.files[0].data).Location;var d=Date.now()-a,p=(l=c._formatFileSize(i.size),c._formatSpeed(1e3*i.size/d));return l="size:".concat(l," time:").concat(d,"ms speed:").concat(p),(Re.l("".concat(o," success. name:").concat(i.name," ").concat(l)),r(u),p=t.get(26)).addCost(Jn,d),p.addFileSize(Jn,i.size),void n.setMessage(l).end()}u=new Fn({code:zn.MSG_F_UPLOAD_FAIL}),n.setError(u).end(),Re.w("".concat(o," failed. error:"),e),403===e.statusCode&&t._getAuthorizationKey(),s(u)}))}))}},{key:"_uploadWithPreSigUrl",value:function(e){var t=this,n="".concat(this._n,"._uploadWithPreSigUrl"),o=this._getFile(e);return this._createCosOptionsPreSigUrl(e).then((function(e){return new Promise((function(a,i){var r=new io("upload"),s=e.requestSnapshotUrl,l=void 0===s?void 0:s,c=h(e,Di),u=Date.now();t._cosUploadMethod(c,(function(s,d){var p,h,f;return s||403===d.statusCode?(r.setError(new Fn(s)).end(),h={HttpStatusCode:9999,CostTime:$t(u,!1),error:s,url:e.url},d.data&&d.data.uploadIP&&(h.uploadIP=d.data.uploadIP),t._uploadSSOLog(h),Re.l("".concat(n," failed, error:"),s),void i(new Fn({code:zn.MSG_F_UPLOAD_FAIL}))):(p=Object.create(null),h=d.data.location||"",t.isPrivateNetWork()||0!==h.indexOf("https://")&&0!==h.indexOf("http://")||(h=h.split("//")[1]),p.fileName=o.name,p.fileSize=o.size,p.fileType=o.type.slice(o.type.indexOf("/")+1).toLowerCase(),p.location=h,s=$t(u,!1),h=t._formatFileSize(o.size),f=t._formatSpeed(1e3*o.size/s),h="size:".concat(h," time:").concat(s,"ms speed:").concat(f," res:").concat(JSON.stringify(d.data)),Re.l("".concat(n," ok. name:").concat(o.name," ").concat(h)),r.setMessage(h).end(),f={HttpStatusCode:d.statusCode,FileSize:o.size,CostTime:s,url:e.url},d.data&&d.data.uploadIP&&(f.uploadIP=d.data.uploadIP),t._uploadSSOLog(f),(h=t.get(26)).addCost(Jn,s),h.addFileSize(Jn,o.size),f=[],c.thumbUrl&&c.largeUrl&&f.push.apply(f,[t._getSmallImageInfoByUrl(c.thumbUrl,p),t._getLargeImageInfoByUrl(c.largeUrl,p)]),1===t.uploadFileType&&t.isSimpleCos&&!t.isPrivateNetWork()&&(f.push(t._getImageInfoArray(c.downloadUrl,p)),d.data.uploadIP&&f.push(t._getDownloadIP(c.downloadUrl.split("//")[1].split("/")[0],p))),l&&f.push(t._getSnapshotInfoByUrl(l,p)),0<f.length?Promise.all(f).then((function(){a(p)})):void a(p))}))}))}))}},{key:"_getDownloadIP",value:function(e,t){var n="".concat(this._n,"._getDownloadIP"),o=Date.now();return this.req({P:jn.GET_IP,data:{domainName:e}}).then((function(e){var a;e.data&&e.data.ip&&(Re.l("".concat(n," ok. downloadIP:").concat(e.data.ip," cost:").concat($t(o))),(a=t.location.split("/"))[0]=e.data.ip,t.location=a.join("/"))})).catch((function(e){}))}},{key:"_getImageInfoArray",value:function(e,t){var n=this,o="".concat(this._n,"._getImageInfoArray"),a=Date.now();return this.req({P:jn.GET_IMAGE_INFO,data:{imageUrl:e}}).then((function(e){return e=e.data||{},Re.l("".concat(o," ok. data: ").concat(JSON.stringify(e)," cost:").concat($t(a))),t.imageInfoArray=e.imageInfoArray,e})).catch((function(o){t.imageInfoArray=void 0,n._uploadSSOLog({HttpStatusCode:1e4,CostTime:$t(a,!1),url:e})}))}},{key:"_uploadSSOLog",value:function(e){var t,n;this.isSimpleCos&&((t=new io).setEventType(18),e.error&&t.setError(new Fn(e.error)),n="HttpStatusCode:".concat(e.HttpStatusCode,"|CosRequestId:").concat(e.CosRequestId||"","|")+"FileAlreadyExist:".concat(e.FileAlreadyExist||0,"|FileSize:").concat(e.FileSize||0,"|CostTime:").concat(e.CostTime),e.uploadIP&&(n+="|FinalIP:".concat(e.uploadIP)),t.setMessage("OK").setMoreMessage(e.url).setExtension(n).end())}},{key:"_getRawOrUploadProxyUrl",value:function(e){var t=this.get(12).getFileUploadProxy(),n=e;return t?e.replace(/^https:\/\/[^/]+/,t):n}},{key:"_getFile",value:function(e){return Ze(e.file.files)||Qe(e.file.files)?e.file.files[0]:e.file}},{key:"_formatFileSize",value:function(e){return e<1024?e+"B":e<1048576?Math.floor(e/1024)+"KB":Math.floor(e/1048576)+"MB"}},{key:"_formatSpeed",value:function(e){return e<=1048576?xt(e/1024,1)+"KB/s":xt(e/1048576,1)+"MB/s"}},{key:"_createCosOptionsWeb",value:function(e){var t=this._getFile(e),n=(n=t.name).slice(n.lastIndexOf("."));return n=this._genFileName("".concat(it(999999)).concat(n)),{files:[{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),Body:t}],SliceSize:1048576,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Re.w("onProgress callback error:",n)}},onFileFinish:function(e,t,n){}}}},{key:"_createCosOptionsWXMiniApp",value:function(e){var t=this._getFile(e),n=this._genFileName(t.name);return t=t.url,{Bucket:"".concat(this.bucketName,"-").concat(this.appid),Region:this.region,Key:"".concat(this.directory,"/").concat(n),FilePath:t,onProgress:function(t){if(Re.l(JSON.stringify(t)),"function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Re.w("onProgress callback error:",n)}}}}},{key:"_createCosOptionsPreSigUrl",value:function(e){var t,n=this,o="",a="",i=0,r=this._getFile(e);return i=X||ee?(o=e.message.type===S.MSG_FILE?(t=(t=r.name).slice(t.lastIndexOf(".")),this._genFileName("".concat(it(999999)).concat(t))):this._genFileName(r.name),a=r.url,1):(t=(t=r.name).slice(t.lastIndexOf(".")),o=this._genFileName("".concat(it(999999)).concat(t)),a=r,0),this._getCosPreSigUrl({fileType:this.uploadFileType,fileName:o,uploadMethod:i,duration:this.duration,userID:e.message.from,conversationType:Mt(e.message.conversationID)?1:2}).then((function(t){var i=(u=n.isSimpleCos?t.preSig[0]:t).uploadUrl,r=u.downloadUrl,s=void 0===(s=u.requestSnapshotUrl)?void 0:s,l=u.thumbUrl,c=u.largeUrl,u=u.fileKey;return t=void 0===(t=t.uploadIP)?"":t,{url:n._getRawOrUploadProxyUrl(i),fileType:n.uploadFileType,fileName:o,resources:a,downloadUrl:r,requestSnapshotUrl:s,thumbUrl:l,largeUrl:c,fileKey:u,uploadIP:!n.isPrivateNetWork()&&t,onProgress:function(t){if("function"==typeof e.onProgress)try{e.onProgress(t.percent)}catch(n){Re.w("onProgress callback error:",n),Re.e(n)}}}}))}},{key:"_genFileName",value:function(e){return"".concat(Rt(),"-").concat(e)}},{key:"_setUploadFileType",value:function(e){this.uploadFileType=e}},{key:"_getSnapshotInfoByUrl",value:function(e,t){var n=this,o="_getSnapshotInfoByUrl",a=new io(o);return this.req({P:jn.VIDEO_COVER,data:{platform:this.getPlatform(),coverName:this._genFileName(it(99999)),requestSnapshotUrl:e}}).then((function(e){if(e=(e.data||{}).snapshotUrl,Re.l("".concat(n._n,".").concat(o," ok. snapshotUrl:").concat(e)),a.setMessage("snapshotUrl:".concat(e)).end(),He(e))return{};var i=po(e,n._fileDownloadProxy,n._authKey,n._fileDNList);return Nt(i).then((function(e){t.snapshotInfo={snapshotUrl:i,snapshotWidth:e.width,snapshotHeight:e.height}}))})).catch((function(e){return Re.w("".concat(n._n,".").concat(o," failed. error:"),e),a.setCode(e.errorCode).setMessage(e.errorInfo).end(),{}}))}},{key:"_getSmallImageInfoByUrl",value:function(e,t){return Nt(po(e,this._fileDownloadProxy,this._authKey,this._fileDNList)).then((function(n){t.smallImageUrl=e,t.smallImageWidth=n.width,t.smallImageHeight=n.height}))}},{key:"_getLargeImageInfoByUrl",value:function(e,t){return Nt(po(e,this._fileDownloadProxy,this._authKey,this._fileDNList)).then((function(n){t.largeImageUrl=e,t.largeImageWidth=n.width,t.largeImageHeight=n.height}))}},{key:"_isEmptyFileList",value:function(e){return!(!Qe(e)||0!==e.length)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),Ui),Ri=["downloadKey","pbDownloadKey","messageList"],Li=(i(Pi,[{key:"uploadMergerMessage",value:function(e,t){var n="".concat(this._n,".").concat("uploadMergerMessage"),o=(Re.d("".concat(n," message:"),e,"messageBytes:".concat(t)),e=JSON.parse(JSON.stringify(e.payload)).messageList).length,a=this._msgM.get(17).getFileDNList(),i=new io("uploadMergerMessage");return e.forEach((function(e){ho(e.messageBody[0].type,e.messageBody,a)})),this._msgM.req({P:jn.UPLOAD_MERGER_MSG,data:{messageList:e}}).then((function(e){Re.d("".concat(n," ok. response:"),e.data);var a={pbDownloadKey:a=(e=e.data).pbDownloadKey,downloadKey:e=e.downloadKey,messageNumber:o};return i.setMessage("".concat(o,"-").concat(t,"-").concat(e)).end(),a})).catch((function(e){throw Re.w("".concat(n," failed. error:"),e),i.setError(e).end(),e}))}},{key:"downloadMergerMessage",value:function(e){var n=this,o="".concat(this._n,".").concat("downloadMergerMessage"),a=(Re.d("".concat(o," message:"),e),e.payload.downloadKey),i=this._msgM.getFileDownloadProxy(),r=this._msgM.getDowloadFileAuthKey(),s=new io("downloadMergerMessage");return s.setMessage("downloadKey:".concat(a)),this._msgM.req({P:jn.DOWNLOAD_MERGER_MSG,data:{downloadKey:a}}).then((function(a){Re.d("".concat(o," ok. response:"),a.data);var l,c,u=n._msgM.get(17).getFileDNList();return Xe(e.clearElement)?((l=e.payload).downloadKey,l.pbDownloadKey,l.messageList,l=h(l,Ri),e.clearElement(),e.setElement({type:e.type,content:t({messageList:a.data.messageList},l)},i,r,u)):(c=[],a.data.messageList.forEach((function(e){He(e)||(e=new wo(e,i,r,u),c.push(e))})),e.payload.messageList=c,e.payload.downloadKey="",e.payload.pbDownloadKey=""),s.end(),e})).catch((function(e){throw Re.w("".concat(o," failed. key:").concat(a," error:"),e),s.setError(e).end(),e}))}},{key:"createMergerMessagePack",value:function(e,t,n){return e.conversationType===S.CONV_C2C?this._createC2CMergerMessagePack(e,t,n):this._createGroupMergerMessagePack(e,t,n)}},{key:"_createC2CMergerMessagePack",value:function(e,t,n){var o=null,a=(t&&(t.offlinePushInfo&&(o=t.offlinePushInfo),!0===t.onlineUserOnly&&(o?o.disablePush=!0:o={disablePush:!0})),[]),i=(We(t)&&We(t.messageControlInfo)&&(i=(s=t.messageControlInfo).excludedFromUnreadCount,r=s.excludedFromLastMessage,s=s.excludedFromContentModeration,!0===i&&a.push("NoUnread"),!0===r&&a.push("NoLastMsg"),!0===s&&a.push("NoMsgCheck")),""),r=(dt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(i=e.cloudCustomData),n.pbDownloadKey),s=n.downloadKey,l=(n=n.messageNumber,(u=e.payload).title),c=u.abstractList,u=u.compatibleText,d=(d=this._msgM.get(6))&&d.isOnlineMessage(e,t)?0:void 0;return{P:jn.SEND_C2C_MSG,data:{fromAccount:this._msgM.getMyUserID(),toAccount:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:r,downloadKey:s,title:l,abstractList:c,compatibleText:u,messageNumber:n}}],cloudCustomData:i,clientTime:e.clientTime,msgSeq:e.sequence,msgRandom:e.random,msgLifeTime:d,offlinePushInfo:jo(o),messageControlInfo:0!==d?a:void 0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0}}}},{key:"_createGroupMergerMessagePack",value:function(e,t,n){var o=null,a=(t&&t.offlinePushInfo&&(o=t.offlinePushInfo),[]),i=(We(t)&&We(t.messageControlInfo)&&(i=(s=t.messageControlInfo).excludedFromUnreadCount,r=s.excludedFromLastMessage,s=s.excludedFromContentModeration,!0===i&&a.push("NoUnread"),!0===r&&a.push("NoLastMsg"),!0===s&&a.push("NoMsgCheck")),""),r=(dt(e.cloudCustomData)&&0<e.cloudCustomData.length&&(i=e.cloudCustomData),n.pbDownloadKey),s=n.downloadKey,l=(n=n.messageNumber,(u=e.payload).title),c=u.abstractList,u=u.compatibleText,d=this._msgM.get(7);return t=d&&d.isOnlineMessage(e,t)?1:0,{P:jn.SEND_GRP_MSG,data:{fromAccount:this._msgM.getMyUserID(),groupID:e.to,msgBody:[{msgType:e.type,msgContent:{pbDownloadKey:r,downloadKey:s,title:l,abstractList:c,compatibleText:u,messageNumber:n}}],random:e.random,priority:e.priority,clientSequence:e.clientSequence,groupAtInfo:void 0,cloudCustomData:i,onlineOnlyFlag:t,offlinePushInfo:jo(o),clientTime:e.clientTime,needReadReceipt:!0!==e.needReadReceipt||d.isMessageFromOrToAVChatroom(e.to)?0:1,messageControlInfo:0==t?a:void 0,isSupportExtension:!0===e.isSupportExtension?1:0,isRelayMessage:!0===e._relayFlag?1:0}}}}]),Pi),Ai={ERR_SVR_COMM_SENSITIVE_TEXT:80001,ERR_SVR_COMM_BODY_SIZE_LIMIT:80002,OPEN_SERVICE_OVERLOAD_ERROR:60022,ERR_SVR_MSG_PKG_PARSE_FAILED:20001,ERR_SVR_MSG_INTERNAL_AUTH_FAILED:20002,ERR_SVR_MSG_INVALID_ID:20003,ERR_SVR_MSG_PUSH_DENY:20006,ERR_SVR_MSG_IN_PEER_BLACKLIST:20007,ERR_SVR_MSG_BOTH_NOT_FRIEND:20009,ERR_SVR_MSG_NOT_PEER_FRIEND:20010,ERR_SVR_MSG_NOT_SELF_FRIEND:20011,ERR_SVR_MSG_SHUTUP_DENY:20012,ERR_SVR_GROUP_INVALID_PARAMETERS:10004,ERR_SVR_GROUP_PERMISSION_DENY:10007,ERR_SVR_GROUP_NOT_FOUND:10010,ERR_SVR_GROUP_INVALID_GROUPID:10015,ERR_SVR_GROUP_REJECT_FROM_THIRDPARTY:10016,ERR_SVR_GROUP_SHUTUP_DENY:10017,MSG_SEND_FAIL:2100,OVER_FREQUENCY_LIMIT:2996},Oi=[zn.MSG_ONPROGRESS_ERR,zn.MSG_I_SELECT_F_FIRST,zn.MSG_I_TYPES_LIMIT,zn.MSG_F_IS_EMPTY,zn.MSG_I_SIZE_LIMIT,zn.MSG_F_SELECT_F_FIRST,zn.MSG_F_SIZE_LIMIT,zn.MSG_V_SIZE_LIMIT,zn.MSG_V_TYPES_LIMIT,zn.MSG_A_UPLOAD_FAIL,zn.MSG_A_SIZE_LIMIT,zn.COS_UNDETECTED];function Pi(e){o(this,Pi),this._n="MergerMessageHandler",this._msgM=e}function Ui(e){o(this,Ui),(e=Mi.call(this,e))._n="UploadModule",e.TIMUploadPlugin=null,e.timUploadPlugin=null,e.COSSDK=null,e._cosUploadMethod=null,e.expiredTimeLimit=600,e.appid=0,e.bucketName="",e.ciUrl="",e.directory="",e.downloadUrl="",e.uploadUrl="",e.region="ap-shanghai",e.cos=null,e.cosOptions={secretId:"",secretKey:"",sessionToken:"",expiredTime:0},e.uploadFileType="",e.duration=900,e.tryCount=0,e.UPLOAD_SIZE_LIMIT={A:20971520,F:104857600,I:20971520,V:104857600},e.isSimpleCos=!1,e._fileDownloadProxy="",e._authKey="",e._fileDNList=bi;var t=e.getIEmitInst();return t.on(Yo.A2KEY_AND_TINYID_UPDATED,e._init,f(e)),t.on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function xi(e){var t=!1;return Object.values(Ai).includes(e)&&(t=!0),120001<=e&&e<=13e4||10100<=e&&e<=10200||t}s(nr,Un),Hi=g(nr),i(nr,[{key:"createTextMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new No(e));return e=dt(e.payload)?e.payload:e.payload.text,e=new ro({text:e}),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createImageMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new No(e));if(X){if(Ke(a=e.payload.file))return void this.warn("FileUnsupportedInMP","createImageMessage");var o=a.tempFiles[0].path||a.tempFiles[0].tempFilePath,a={url:o,name:o.slice(o.lastIndexOf("/")+1),size:a.tempFiles&&a.tempFiles[0].size||1,type:o.slice(o.lastIndexOf(".")+1).toLowerCase()};e.payload.file=a}else ee?(a={url:(o=e.payload.file).uri,name:o.fileName,size:o.fileSize||1,type:o.type,width:o.width,height:o.height},e.payload.file=a):te&&(Ke(e.payload.file)?(o=e.payload.file,e.payload.file={files:[o]}):We(e.payload.file)&&"undefined"!=typeof uni&&(a=e.payload.file.tempFiles[0],e.payload.file={files:[a]}));return o=new mo({imageFormat:Le.UNKNOWN,uuid:this._generateUUID(e.payload.file),file:e.payload.file}),a=this._getNickAndAvatarByUserID(t),n.setElement(o),n.setNickAndAvatar(a),n.setNameCard(this._getNameCardByGroupID(n)),this._messageOptionsMap.set(n.clientSequence,e),n}},{key:"createAudioMessage",value:function(e){var t=e.payload.file,n=(X&&(n={url:t.tempFilePath,name:t.tempFilePath.slice(t.tempFilePath.lastIndexOf("/")+1),size:t.fileSize,second:parseInt(t.duration)/1e3,type:t.tempFilePath.slice(t.tempFilePath.lastIndexOf(".")+1).toLowerCase()},e.payload.file=n),ee&&(n={url:t.uri,name:t.uri.slice(t.uri.lastIndexOf("/")+1),size:t.fileSize||1,second:Math.floor(t.duration/1e3),type:t.uri.slice(t.uri.lastIndexOf(".")+1).toLowerCase()},e.payload.file=n,He(t.uri)&&this.warn("VoiceFileInRN")),this.getMyUserID()),o=(e.currentUser=n,e.senderTinyID=this.getMyTinyID(),new No(e));return t=new _o({second:Math.floor(t.duration/1e3),size:t.fileSize||t.size||1,url:t.tempFilePath||t.uri,uuid:this._generateUUID(e.payload.file)}),n=this._getNickAndAvatarByUserID(n),o.setElement(t),o.setNickAndAvatar(n),o.setNameCard(this._getNameCardByGroupID(o)),this._messageOptionsMap.set(o.clientSequence,e),o}},{key:"createVideoMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),e.payload.file.thumbUrl="",e.payload.file.thumbSize=0,{});if(X){if(Y)return void this.warn("VideoUnsupportedInAlipay");if(Ke(e.payload.file))return void this.warn("FileUnsupportedInMP","createVideoMessage");var o=e.payload.file;Ze(o.tempFiles)&&(o=o.tempFiles[0]),n.url=o.tempFilePath,n.name=o.tempFilePath.slice(o.tempFilePath.lastIndexOf("/")+1),n.size=o.size||1,n.second=o.duration||0,n.type=o.tempFilePath.slice(o.tempFilePath.lastIndexOf(".")+1).toLowerCase()}else ee?(o=e.payload.file,n.url=o.uri,n.name=o.fileName,n.size=o.fileSize||1,n.second=o.duration||0,n.type=o.type.split("/")[1]):te&&(Ke(e.payload.file)?(o=e.payload.file,e.payload.file.files=[o]):We(e.payload.file)&&"undefined"!=typeof uni&&(o=e.payload.file.tempFile,e.payload.file.files=[o]),o=e.payload.file,n.url=window.URL.createObjectURL(o.files[0]),n.name=o.files[0].name,n.size=o.files[0].size||1,n.second=o.files[0].duration||0,n.type=o.files[0].type.split("/")[1]);return e.payload.file.videoFile=n,o=new No(e),n=new So({videoFormat:n.type,videoSecond:xt(n.second,0),videoSize:n.size,remoteVideoUrl:"",videoUrl:n.url,videoUUID:this._generateUUID(e.payload.file.videoFile),thumbUUID:this._generateUUID(e.payload.file.videoFile),thumbWidth:e.payload.file.width||200,thumbHeight:e.payload.file.height||200,thumbUrl:e.payload.file.thumbUrl,thumbSize:e.payload.file.thumbSize,thumbFormat:e.payload.file.thumbUrl.slice(e.payload.file.thumbUrl.lastIndexOf(".")+1).toLowerCase()}),t=this._getNickAndAvatarByUserID(t),o.setElement(n),o.setNickAndAvatar(t),o.setNameCard(this._getNameCardByGroupID(o)),this._messageOptionsMap.set(o.clientSequence,e),o}},{key:"createCustomMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new No(e));return e=new To({data:e.payload.data,description:e.payload.description,extension:e.payload.extension}),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createFaceMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new No(e));return e=new vo(e.payload),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"createMergerMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),t=this._getNickAndAvatarByUserID(t),new No(e));return e=new bo(e.payload),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n.setRelayFlag(!0),n}},{key:"createForwardMessage",value:function(e){var t=e.to,n=e.conversationType,o=e.priority,a=e.payload,i=e.needReadReceipt,r=e.receiverList;if(!Ze(a._elements))return Mn({code:zn.MSG_FORWARD_INVALID_ELEMENTS});var s=this.getMyUserID(),l=this._getNickAndAvatarByUserID(s);return a.type===S.MSG_GRP_TIP?Mn({code:zn.MSG_FORWARD_TYPE_INVALID}):(n={to:t,conversationType:n,conversationID:"".concat(n).concat(t),priority:o,isPlaceMessage:0,status:bn,currentUser:s,senderTinyID:this.getMyTinyID(),cloudCustomData:e.cloudCustomData||a.cloudCustomData||"",needReadReceipt:i,receiverList:r,isSupportExtension:e.isSupportExtension||!1},(t=new No(n)).setElement(a._elements[0]),t.setNickAndAvatar(l),t.setNameCard(this._getNameCardByGroupID(a)),t.setRelayFlag(!0),t)}},{key:"downloadMergerMessage",value:function(e){return this._mergerMessageHandler.downloadMergerMessage(e)}},{key:"createFileMessage",value:function(e){if(X){if(!z&&!j&&!W)return;var n=ne.getSystemInfoSync().SDKVersion;if(z&&At(n,"2.5.0")<0)return void this.warn("WXChooseMessageFile");if(j&&At(n,"1.18.0")<0)return void this.warn("QQChooseMessageFile")}te||W?Ke(e.payload.file)?(n=e.payload.file,e.payload.file={files:[n]}):We(e.payload.file)&&"undefined"!=typeof uni&&(a=(n=e.payload.file).tempFiles,n=n.files,o=null,Ze(a)?o=a[0]:Ze(n)&&(o=n[0]),e.payload.file={files:[o]}):z||j?(n=t(t({},(a=e.payload.file.tempFiles)[0]),{},{url:a[0].path}),e.payload.file={files:[n]}):ee&&(a=t(t({},o=e.payload.file),{},{url:o.uri}),e.payload.file={files:[a]}),n=this.getMyUserID();var o=(e.currentUser=n,e.senderTinyID=this.getMyTinyID(),new No(e)),a=new Eo({uuid:this._generateUUID(e.payload.file),file:e.payload.file});return n=this._getNickAndAvatarByUserID(n),o.setElement(a),o.setNickAndAvatar(n),o.setNameCard(this._getNameCardByGroupID(o)),this._messageOptionsMap.set(o.clientSequence,e),o}},{key:"createLocationMessage",value:function(e){var t=this.getMyUserID(),n=(e.currentUser=t,e.senderTinyID=this.getMyTinyID(),new No(e));return e=new Mo(e.payload),t=this._getNickAndAvatarByUserID(t),n.setElement(e),n.setNickAndAvatar(t),n.setNameCard(this._getNameCardByGroupID(n)),n}},{key:"_onNoModule",value:function(){return Mn({code:zn.NO_MODULE})}},{key:"sendMessageInstance",value:function(e,t){var n=this;if(!1===this.get(29).filterMessage(e,t))return e.hasRiskContent=!0,this._onSendMessageFailed(e,new Fn({code:zn.PROFANITY_FOUND}));var o=null;if(e.conversationType===S.CONV_C2C)o=this.get(6);else{if(e.conversationType!==S.CONV_GROUP)return Mn({code:zn.MSG_INVALID_CONV_TYPE});o=this.get(7)}if(!o)return this._onNoModule();var a,i="".concat(this._n,".sendMessageInstance"),r=this.get(11),s=o.isOnlineMessage(e,t);return this.get(17).upload(e).then((function(){return n._getSendMessageSpecifiedKey(e)===Zn&&n.get(26).addSuccessCount(Jn),n._guardForGroup(e).then((function(){if(!e.isSendable())return Mn({code:zn.MSG_F_URL_IS_EMPTY});n._addSendMessageTotalCount(e),a=Date.now();var i=function(e){var t="utf-8";te&&document&&(t=document.charset.toLowerCase());var n,o=0,a=e.length;if("utf-8"===t||"utf8"===t)for(var i=0;i<a;i++)(n=e.codePointAt(i))<=127?o+=1:n<=2047?o+=2:n<=65535?o+=3:(o+=4,i++);else if("utf-16"===t||"utf16"===t)for(var r=0;r<a;r++)(n=e.codePointAt(r))<=65535?o+=2:(o+=4,r++);else o=e.replace(/[^\x00-\xff]/g,"aa").length;return o}(JSON.stringify(e));return e.type===S.MSG_MERGER&&11264<i?n._mergerMessageHandler.uploadMergerMessage(e,i).then((function(o){return o=n._mergerMessageHandler.createMergerMessagePack(e,t,o),n.req(o)})):(r.setMessageRandom(e),o.sendMessage(e,t))})).then((function(o){var l,c=(o=o.data).time,u=o.sequence,d=o.readReceiptCode;return o=o.messageDropReason,Ye(d)&&0!==d&&(new io("sendMessageWithReceipt").setMessage("from:".concat(e.from," to:").concat(e.to," sequence:").concat(u," readReceiptCode:").concat(d)).end(),Re.w("".concat(i," readReceiptCode:").concat(d," message:").concat(n.getErrMsg(d)))),o&&(d=new io("messageDropReason"),o="from:".concat(e.from," to:").concat(e.to," sequence:").concat(u," messageDropReason:").concat(o),d.setMessage(o).end(),Re.w("".concat(i," ").concat(o))),n._addSendMessageSuccessCount(e,a),n._messageOptionsMap.delete(e.clientSequence),!0===e.isResend&&(l=r.findMessage(e.ID))&&(Re.l("".concat(i," resend ok. ID:").concat(l.ID)),r.deleteLocalMessage(l)),e.status=Dn,e.time=c,d=!1,e.conversationType===S.CONV_GROUP?e.sequence=u:e.conversationType!==S.CONV_C2C||(o=r.getLatestMessageSentByMe(e.conversationID))&&(l=o.nick,c=o.avatar,l===e.nick&&c===e.avatar||(d=!0)),d&&r.modifyMessageSentByMe({conversationID:e.conversationID,latestNick:e.nick,latestAvatar:e.avatar}),!0===s?e._onlineOnlyFlag=!0:(r.appendToMessageList(e),u=e,We(t)&&We(t.messageControlInfo)&&(!0===t.messageControlInfo.excludedFromLastMessage&&(e._isExcludedFromLastMessage=!0,u=""),!0===t.messageControlInfo.excludedFromUnreadCount&&(e._isExcludedFromUnreadCount=!0)),o=e.conversationType,St(e.to)&&(o=S.CONV_TOPIC,n.get(10).onMessageSent({groupID:Gt(e.to),topicID:e.to,lastMessage:u})),r.onMessageSent({conversationOptionsList:[{conversationID:e.conversationID,unreadCount:0,type:o,subType:e.conversationSubType,lastMessage:u}]})),e._relayFlag||"TIMImageElem"!==e.type||Pt(e.payload.imageInfoArray),Tn({message:e})}))})).catch((function(t){return n._onSendMessageFailed(e,t,s)}))}},{key:"_guardForGroup",value:function(e){if(e.conversationType!==S.CONV_GROUP)return Promise.resolve();var t=this.get(7);if(!t)return this._onNoModule();if(Tt({groupID:e.to})){var n=t.getLocalGroupProfile(e.to);if(n&&n.isSupportTopic)return Mn({code:zn.MSG_SEND_GRP_WITH_TOPIC_FAIL})}return t.guardForAVChatRoom(e)}},{key:"_onSendMessageFailed",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2],o="".concat(this._n,"._onSendMessageFailed"),a=(e.status=Nn,80001!==t.code&&80004!==t.code||(e.hasRiskContent=!0),this.get(11)),i=(a.deleteMessageRandom(e),10100<=t.code&&t.code<=10200||120001<=t.code&&t.code<=13e4);return n||i||!0===a.appendToMessageList(e)&&Re.l("".concat(o," message stored, ID:").concat(e.ID)),this._addSendMessageFailCountOnUser(e,t),n=new io("sendMessage"),i="head.seq:".concat(t.data.headSeq," type:").concat(e.type," from:").concat(e.from," to:").concat(e.to),te&&("connection"in navigator&&(a=navigator.connection,i+=" downlink:".concat(a.downlink," effectiveType:").concat(a.effectiveType," rtt:").concat(a.rtt)),"memory"in window.performance&&(a=window.performance.memory,i+=" usedJSHeapSize:".concat(a.usedJSHeapSize," totalJSHeapSize:").concat(a.totalJSHeapSize," jsHeapSizeLimit:").concat(a.jsHeapSizeLimit))),n.setMessage(i).setError(t).end(),Re.e("".concat(o," ").concat(i," error:"),t),Mn(new Fn({code:t&&t.code?t.code:zn.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){if([S.MSG_IMAGE,S.MSG_AUDIO,S.MSG_VIDEO,S.MSG_FILE].includes(e.type))return Zn;if(e.conversationType===S.CONV_C2C)return Yn;if(e.conversationType===S.CONV_GROUP){var t=this.get(7);if(t&&(t=t.getLocalGroupProfile(e.to)))return Et(e=t.type)?Wn:$n}}},{key:"_addSendMessageTotalCount",value:function(e){(e=this._getSendMessageSpecifiedKey(e))&&this.get(26).addTotalCount(e)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n;(e=this._getSendMessageSpecifiedKey(e))&&((n=this.get(26)).addSuccessCount(e),n.addCost(e,$t(t,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){t=void 0===(t=t.code)?-1:t;var n,o=this.get(26);(e=this._getSendMessageSpecifiedKey(e))===Zn&&(n=!1,n=!!Oi.includes(t)||n)?o.addFailedCountOfUserSide(Jn):xi(t)&&e&&o.addFailedCountOfUserSide(e)}},{key:"resendMessage",value:function(e,t){return e.isResend=!0,e.status=bn,this.sendMessageInstance(e,t)}},{key:"revokeMessage",value:function(e){var t=this,n=null;if(e.conversationType===S.CONV_C2C?n=this.get(6):e.conversationType===S.CONV_GROUP&&(n=this.get(7)),!n)return this._onNoModule();var o=new io("revokeMessage"),a=(o.setMessage("type:".concat(e.type," from:").concat(e.from," to:").concat(e.to)),"".concat(this._n,".").concat("revokeMessage"));return n.revokeMessage(e).then((function(n){return He(n=n.data.recallRetList)||0===n[0].retCode?(Re.i("".concat(a," ok. ID:").concat(e.ID)),e.isRevoked=!0,o.end(),t.get(11).onMessageRevoked([e]),Tn({message:e})):(n=new Fn({code:n[0].retCode,data:{message:e}}),o.setCode(n.code).setMoreMessage(n.message).end(),Mn(n))})).catch((function(t){o.setError(t).end();var n=new Fn({code:t&&t.code?t.code:zn.MSG_REVOKE_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}});return Re.w("".concat(a," failed. error:"),t),Mn(n)}))}},{key:"deleteMessage",value:function(e){var t=this,n=null,o=e[0],a=o.conversationID,i="",r=[],s=[];if(o.conversationType===S.CONV_C2C)n=this.get(6),i=a.replace(S.CONV_C2C,""),e.forEach((function(e){e&&e.status===Dn&&e.conversationID===a&&(e._onlineOnlyFlag||r.push("".concat(e.sequence,"_").concat(e.random,"_").concat(e.time)),s.push(e))}));else if(o.conversationType===S.CONV_GROUP)n=this.get(7),i=a.replace(S.CONV_GROUP,""),e.forEach((function(e){e&&e.status===Dn&&e.conversationID===a&&(e._onlineOnlyFlag||r.push("".concat(e.sequence)),s.push(e))}));else if(o.conversationType===S.CONV_SYSTEM)return Mn({code:zn.CANNOT_DELETE_GRP_SYSTEM_NOTICE});if(!n)return this._onNoModule();if(0===r.length)return this._onMessageDeleted(s);30<r.length&&(r=r.slice(0,30),s=s.slice(0,30));var l=new io("deleteMessage"),c=(l.setMessage("to:".concat(i," count:").concat(r.length)),"".concat(this._n,".").concat("deleteMessage"));return n.deleteMessage({to:i,keyList:r}).then((function(e){return l.end(),Re.i("".concat(c," ok")),t._onMessageDeleted(s)})).catch((function(e){return l.setError(e).end(),Re.w("".concat(c," failed. error:"),e),Mn(e=new Fn({code:e&&e.code?e.code:zn.MSG_DELETE_FAIL,message:e&&e.message?e.message:void 0}))}))}},{key:"_onMessageDeleted",value:function(e){return this.get(11).onMessageDeleted(e),Sn({messageList:e})}},{key:"translateText",value:function(e){var n="".concat(this._n,".").concat("translateText"),o=e.sourceTextList,a=e.sourceLanguage,i=(e=e.targetLanguage,new io("translateText"));return i.setMessage("sourceLanguage:".concat(a," targetLanguage:").concat(e)),this.req({P:jn.TRANSLATE_TEXT,data:{sourceTextList:o,source:a||"auto",target:e,from:this.getMyTinyID(),SDKAppID:this.getSDKAppID()}}).then((function(e){var o=(e=e.data).error,a=e.requestID;if(e=e.translatedTextList,0===o.code)return i.end(),Re.i("".concat(n," ok. requestID:").concat(a)),Tn({translatedTextList:e});throw t(t({},o),{},{requestID:a})})).catch((function(e){return i.setCode(e.code).setMoreMessage(e.requestID).end(),Re.w("".concat(n," failed. error:"),e),Mn({code:zn.TRANSLATE_TEXT_FAIL})}))}},{key:"convertVoiceToText",value:function(e){var n=e.message,o=(e=e.language,n.payload.url);if(!(n.from===this.getMyUserID()&&"out"===n.flow&&(o=n.payload.remoteAudioUrl),n=/\.(wav|pcm|ogg-opus|speex|silk|mp3|m4a|aac|amr)/).test(o))return Mn({code:zn.UNSUPPORTED_VOICE_FORMAT});n=n.exec(o)[1]||"mp3";var a="16k_zh-PY",i=(e?"zh (cmn-Hans-CN)"===e?a="16k_zh":"en-US"===e?a="16k_en":"yue-Hant-HK"===e?a="16k_yue":"ja-JP"===e&&(a="16k_ja"):a="16k_zh-PY",e="serviceType:".concat(a," url:").concat(o),"".concat(this._n,".").concat("convertVoiceToText")),r=(Re.i("".concat(i," ").concat(e)),new io("convertVoiceToText"));return r.setMessage(e),this.req({P:jn.VOICE_TO_TEXT,data:{url:o,language:a,SDKAppID:this.getSDKAppID(),format:n}}).then((function(e){var n=(e=e.data).error,o=e.requestID;if(e=e.result,0===n.code)return r.end(),Re.i("".concat(i," ok. requestID:").concat(o)),Tn({result:e});throw t(t({},n),{},{requestID:o})})).catch((function(e){return r.setCode(e.code).setMoreMessage(e.requestID||"").end(),Re.w("".concat(i," failed. error:"),e),Mn({code:zn.VOICE_TO_TEXT_FAIL})}))}},{key:"modifyRemoteMessage",value:function(e){var t=this;if(!1===this.get(29).filterMessage(e))return e.hasRiskContent=!0,Mn({code:zn.PROFANITY_FOUND,data:{message:e}});var n=null,o=e.conversationType,a=e.to;if(o===S.CONV_C2C)n=this.get(6);else if(o===S.CONV_GROUP){if(!(n=this.get(7)))return this._onNoModule();if(n.isMessageFromOrToAVChatroom(a))return Mn({code:zn.MSG_MODIFY_DISABLED_IN_AV,data:{message:e}})}var i=new io("modifyMessage"),r=(i.setMessage("to:".concat(a)),"".concat(this._n,".modifyRemoteMessage"));return n.modifyRemoteMessage(e).then((function(n){return i.end(),Re.i("".concat(r," ok")),Tn({message:n=t._onModifyRemoteMessageResp(e,n.data)})})).catch((function(n){var o;return i.setCode(n.code).setMoreMessage(n.message).end(),Re.w("".concat(r," failed. error:"),n),20027===n.code?(o=t._onModifyRemoteMessageResp(e,n.data),Mn({code:zn.MSG_MODIFY_CONFLICT,data:{message:o}})):Mn({code:n.code,message:n.message,data:{message:e}})}))}},{key:"_onModifyRemoteMessageResp",value:function(e,t){Re.d("".concat(this._n,"._onModifyRemoteMessageResp options:"),t);var n=e.conversationType,o=e.from,a=e.to,i=e.random,r=e.sequence,s=(e=e.time,t.elements),l=t.messageVersion;return t=void 0===(t=t.cloudCustomData)?"":t,this.get(11).onMessageModified({conversationType:n,from:o,to:a,time:e,random:i,sequence:r,elements:s,cloudCustomData:t,messageVersion:l})}},{key:"_generateUUID",value:function(e){var t=this.get(12);return t="".concat(t.getSDKAppID(),"-").concat(t.getUserID(),"-").concat(rt()),(e=(e=e.name||e.value||e.url||e.tempFilePath)&&e.slice(e.lastIndexOf(".")+1))?"".concat(t,".").concat(e):t}},{key:"getMessageOption",value:function(e){return this._messageOptionsMap.get(e)}},{key:"_getNickAndAvatarByUserID",value:function(e){return this.get(4).getNickAndAvatarByUserID(e)}},{key:"_getNameCardByGroupID",value:function(e){if(e.conversationType===S.CONV_GROUP){var t=this.get(7);if(t)return t.getMyNameCardByGroupID(e.to)}return""}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._messageOptionsMap.clear()}}]);var Vi,Bi,Gi,Fi,zi,Hi,ji=nr,qi=(s(tr,Un),zi=g(tr),i(tr,[{key:"onMsgExtNotify",value:function(e){var t=this,n=(e=e.dataList).messageInfo,o=e.operateType,a=e.operateResultList,i=e.tinyID,r=(e=e.globalSequence,n.clientTime),s=(n=n.random,"".concat(i,"-").concat(r,"-").concat(n)),l=[],c=[],u=(Re.l("".concat(this._n,".onMsgExtNotify messageID:").concat(s," operateType:").concat(o," globalSequence:").concat(e)),this._updateGlobalSeq(s,e),!1),d=!1;a.forEach((function(e){var n=void 0===(n=e.extensions)?[]:n,a=e.clearSequence;1===o?(u=!0,n.forEach((function(e){l.push({key:e.key,value:e.value})})),t._updateLocalExt(s,n)):2===o?(d=!0,n.forEach((function(e){c.push(e.key)})),t._updateLocalExt(s,n)):3===o&&(d=!0,t._hasLocalExt(s)&&t._getLocalExt(s).forEach((function(e,t){e.seq<=a&&!He(e.value)&&c.push(t)})),t._clearLocalExt(s,a))})),u&&this.emitOEvt(T.MESSAGE_EXTENSIONS_UPDATED,{messageID:s,extensions:l}),d&&this.emitOEvt(T.MESSAGE_EXTENSIONS_DELETED,{messageID:s,keyList:c})}},{key:"setMessageExtensions",value:function(e,t){var n="setMessageExtensions";if(!this.canIUse(P.MSG_EXT))return this.noUse(n);var o="".concat(this._n,".").concat(n),a=e.ID,i=e.conversationID,r=e.sequence,s=e.time,l=v(t),c=(20<t.length&&(l=t.slice(0,20),Re.w("".concat(o,". the length of extensions cannot exceed 20."))),t="convID:".concat(i," messageID:").concat(a," sequence:").concat(r," time:").concat(s," count:").concat(l.length),new io(n));return c.setMessage(t),Re.l("".concat(o," ").concat(t)),this._modifyMsgExts(e,l).then((function(e){var t=e.resultList,n=e.successCount;return e=e.failureCount,n="successCount:".concat(n," failCount:").concat(e),c.setMoreMessage(n).end(),Re.l("".concat(o," ok. ").concat(n)),Tn({extensions:t})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"getMessageExtensions",value:function(e){var t=this,n="getMessageExtensions";if(!this.canIUse(P.MSG_EXT))return this.noUse(n);var o="".concat(this._n,".").concat(n),a=e.ID,i=e.conversationID,r=e.sequence,s=e.time,l=(i="convID:".concat(i," messageID:").concat(a," sequence:").concat(r," time:").concat(s),new io(n)),c=(l.setMessage(i),void Re.l("".concat(o," ").concat(i)));return this.getMsgExtsMap.has(a)&&(c=this._getGlobalSeq(a)),this._getMsgExts(e,c).then((function(e){return l.end(),Re.l("".concat(o," ok. extCount:").concat(e.length)),pt(c)&&0<e.length&&t.getMsgExtsMap.set(a,1),Tn({extensions:e})})).catch((function(e){return l.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"deleteMessageExtensions",value:function(e,t){var n="deleteMessageExtensions";if(!this.canIUse(P.MSG_EXT))return this.noUse(n);var o="".concat(this._n,".").concat(n),a=[],i=3,r=(He(t)||(i=2,t.forEach((function(e){a.push({key:e,value:"",seq:0})}))),t=e.ID,e.conversationID),s=e.sequence,l=e.time,c=(r="convID:".concat(r," messageID:").concat(t," sequence:").concat(s," time:").concat(l," operateType:").concat(i),new io(n));return c.setMessage(r),Re.l("".concat(o," ").concat(r)),this._modifyMsgExts(e,a,i).then((function(e){var t=e.resultList,n=e.successCount,a=(e=e.failureCount,"");return 2===i&&(a="success count:".concat(n," fail count:").concat(e)),c.setMoreMessage("".concat(a)).end(),Re.l("".concat(o," ok. ").concat(a)),Tn({extensions:t})})).catch((function(e){return c.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"_modifyMsgExts",value:function(e,t){var n=this,o=2<arguments.length&&void 0!==arguments[2]?arguments[2]:1,a=St(e.to)?S.CONV_TOPIC:e.conversationType,i=void 0,r=(3!==o&&(i=this._getReqExts(e,t)),null);switch(a){case S.CONV_C2C:r=this.get(6);break;case S.CONV_GROUP:r=this.get(7);break;case S.CONV_TOPIC:r=this.get(10);break;default:return Mn({code:zn.NO_MODULE})}return r.modifyMsgExts(e,i,o).then((function(t){var o=(t=t.data).extensions,a=(t=t.seq,[]),i=0,r=0,s=[];return(o=He(o)?[]:o).forEach((function(e){var t=e.errorCode,n=(e=e.extension).key,o=e.value;e=e.seq,a.push({code:t,key:n,value:o}),0===t?i++:r++,s.push({key:n,value:o,seq:e})})),n._updateGlobalSeq(e.ID,t),0<s.length&&(n._updateLocalExt(e.ID,s),s=null),{resultList:a,successCount:i,failureCount:r}})).catch((function(e){return Mn(e)}))}},{key:"_getReqExts",value:function(e,t){var n,o=[];return this._hasLocalExt(e.ID)?(n=this._getLocalExt(e.ID),t.forEach((function(e){var t=e.key,a=(e=e.value,0);n.has(t)&&(a=n.get(t).seq),o.push({key:t,value:e,seq:a})}))):t.forEach((function(e){var t=e.key;e=e.value,o.push({key:t,value:e,seq:0})})),o}},{key:"_getMsgExts",value:function(e,t){var n=this,o="".concat(this._n,"._getMsgExts"),a=e.ID,i=null;switch(St(e.to)?S.CONV_TOPIC:e.conversationType){case S.CONV_C2C:i=this.get(6);break;case S.CONV_GROUP:i=this.get(7);break;case S.CONV_TOPIC:i=this.get(10);break;default:return Mn({code:zn.NO_MODULE})}return i.getMessageExtensions(e,t).then((function(t){var i=(t=t.data).extensions,r=t.completeFlag,s=t.globalSequence;return t=t.clearSequence,i=He(i)?[]:i,Re.l("".concat(o," ok. completeFlag:").concat(r," globalSequence:").concat(s," clearSequence:").concat(t," count:").concat(i.length)),n._updateLocalExt(a,i),n._clearLocalExt(a,t),n._updateGlobalSeq(a,s),1!==r?(t=i.slice(-1)[0].seq+1,n._getMsgExts(e,t)):n._getLocalExtList(a)})).catch((function(e){return Mn(e)}))}},{key:"_hasLocalExt",value:function(e){return this.msgExtMap.has(e)}},{key:"_getLocalExt",value:function(e){return this.msgExtMap.get(e)}},{key:"_updateLocalExt",value:function(e,t){this._hasLocalExt(e)||this.msgExtMap.set(e,new Map);var n=this._getLocalExt(e);t.forEach((function(e){var t=e.key,o=e.value;e=e.seq,n.set(t,{value:void 0===o?"":o,seq:e})}))}},{key:"_clearLocalExt",value:function(e,t){var n;t<=0||!this._hasLocalExt(e)||(n=this._getLocalExt(e)).forEach((function(e,o){e.seq<=t&&n.delete(o)}))}},{key:"_getLocalExtList",value:function(e){var t=[];return this._hasLocalExt(e)&&this._getLocalExt(e).forEach((function(e,n){He(e=e.value)||t.push({key:n,value:e})})),t}},{key:"_getGlobalSeq",value:function(e){return this.globalSeqMap.get(e)}},{key:"_updateGlobalSeq",value:function(e,t){this.globalSeqMap.set(e,t)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this.msgExtMap.clear(),this.globalSeqMap.clear(),this.getMsgExtsMap.clear()}}]),tr),Ki=(s(er,Un),Fi=g(er),i(er,[{key:"onReactionNotifyList",value:function(e){var n=this;(void 0===(e=(e||{}).dataList)?[]:e).forEach((function(e){var o=e.C2CMessageInfo,a=void 0===(a=e.groupMessageInfo)?{}:a,i=(e=void 0===(e=e.reactionList)?[]:e,a=(o=t(t({},void 0===o?{}:o),a)).tinyID,o.clientTime),r=(o=o.random,a="".concat(a,"-").concat(i,"-").concat(o),[]);e.forEach((function(e){pt(e.userIDList)&&(e.userIDList=[],e.count=0),r.push.apply(r,v(e.userIDList))})),Re.l("".concat(n._n,".onReactionNotifyList messageID:").concat(a," reactionList:").concat(e.length)),n._handleReactionSummary([{messageID:a,reactionList:e}],r).then((function(e){n.emitOEvt(T.MESSAGE_REACTIONS_UPDATED,t({},e[0]))}))}))}},{key:"onReactionNotify",value:function(e){var n=(e=e.dataList||{}).C2CMessageInfo,o=void 0===(o=e.groupMessageInfo)?{}:o,a=e.reactionID,i=(e=e.operateType,o=(n=t(t({},void 0===n?{}:n),o)).tinyID,n.clientTime);n=n.random,o="".concat(o,"-").concat(i,"-").concat(n),Re.l("".concat(this._n,".onReactionNotify messageID:").concat(o," reactionID:").concat(a," operateType:").concat(e)),1===e?this._addReactedByMyselfMap(o,a):this._removeReactedByMyselfMap(o,a),i="".concat(o,"-").concat(a),this._reactionInfoMap.has(i)&&((n=this._reactionInfoMap.get(i)).reactedByMyself=1===e,this.emitOEvt(T.MESSAGE_REACTIONS_UPDATED,{messageID:o,reactionList:[n]}))}},{key:"addMessageReaction",value:function(e,t){var n=this,o="addMessageReaction";if(!this.canIUse(P.MSG_REACTION))return this.noUse(o);var a="".concat(this._n,".").concat(o),i=e.ID,r=e.conversationID,s=(r="convID:".concat(r," messageID:").concat(i," reactionID:").concat(t),new io(o));return s.setMessage(r),Re.l("".concat(a," ").concat(r)),i=this._createReactionOperationPack(e,t,1),this._addReactedByMyselfMap(e.ID,t),this.req(i).then((function(){return s.end(),Re.l("".concat(a," ok.")),Tn()})).catch((function(o){return n._removeReactedByMyselfMap(e.ID,t),s.setError(o).end(),Re.e("".concat(a," failed. error:"),o),Mn(o)}))}},{key:"removeMessageReaction",value:function(e,t){var n="removeMessageReaction";if(!this.canIUse(P.MSG_REACTION))return this.noUse(n);var o="".concat(this._n,".").concat(n),a=e.ID,i=e.conversationID,r=(i="convID:".concat(i," messageID:").concat(a," reactionID:").concat(t),new io(n));return r.setMessage(i),Re.l("".concat(o," ").concat(i)),a=this._createReactionOperationPack(e,t,2),this._removeReactedByMyselfMap(e.ID,t),this.req(a).then((function(){return r.end(),Re.l("".concat(o," ok.")),Tn()})).catch((function(e){return r.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"getMessageReactions",value:function(e){var n=this,o="getMessageReactions";if(!this.canIUse(P.MSG_REACTION))return this.noUse(o);var a="".concat(this._n,".").concat(o),i=e.messageList,r=e.maxUserCountPerReaction,s=i[0].conversationID,l=(s="convID:".concat(s," maxUserCountPerReaction:").concat(r," msgCount:").concat(i.length),new io(o)),c=(l.setMessage(s),Re.l("".concat(a," ").concat(s)),new Map);return r=this._createReactionSummaryPack(t(t({},e),{},{messageIDMap:c})),this.req(r).then((function(e){e=e.data.resultList;var t=[],o=[];return(void 0===e?[]:e).forEach((function(e){var n=void 0===(n=e.messageKey)?void 0:n,a=void 0===(a=e.messageSequence)?void 0:a;e=void 0===(e=e.reactionList)?[]:e,a=pt(n)?c.get(a):c.get(n),t.push({messageID:a,reactionList:e}),e.forEach((function(e){o.push.apply(o,v(e.userIDList))}))})),n._handleReactionSummary(t,o)})).then((function(e){return l.end(),Re.l("".concat(a," ok.")),c.clear(),Tn({resultList:e})})).catch((function(e){return l.setError(e).end(),Re.e("".concat(a," failed. error:"),e),Mn(e)}))}},{key:"getAllUserListOfMessageReaction",value:function(e){var t=this,n="getAllUserListOfMessageReaction";if(!this.canIUse(P.MSG_REACTION))return this.noUse(n);var o="".concat(this._n,".").concat(n),a=e.message,i=e.reactionID,r=e.nextSeq,s=e.count,l=a.ID,c=(a=a.conversationID,a="convID:".concat(a," messageID:").concat(l," reactionID:").concat(i," nextSeq:").concat(r," count:").concat(s),new io(n)),u=(c.setMessage(a),Re.l("".concat(o," ").concat(a)),{userList:[],nextSeq:0,isCompleted:!1});return l=this._createReactionUserListPack(e),this.req(l).then((function(e){var n=void 0===(n=(e=e.data).userIDList)?[]:n;return e=void 0===(e=e.nextSeq)?0:e,u.nextSeq=e,u.isCompleted=0===e,t.get(4).getUserNickAndAvatar(n)})).then((function(e){return u.userList=e,c.end(),Re.l("".concat(o," ok.")),Tn(u)})).catch((function(e){return c.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"_createReactionOperationPack",value:function(e,t,n){var o,a,i=void 0;return t={reactionID:t,userIDList:[this.getMyUserID()]},e.conversationType===S.CONV_C2C&&(o=this.get(6),i=1===n?jn.ADD_C2C_MSG_REACTION:jn.RM_C2C_MSG_REACTION,t.from=e.from,t.to=e.to,t.messageKey=o.getMessageKey(e)),e.conversationType===S.CONV_GROUP&&(o=void 0,a=e.to,St(e.to)&&(a=Gt(o=e.to)),i=1===n?jn.ADD_GRP_MSG_REACTION:jn.RM_GRP_MSG_REACTION,t.groupID=a,t.topicID=o,t.messageSequence=e.sequence),{P:i,data:t}}},{key:"_createReactionSummaryPack",value:function(e){var t,n,o,a=e.messageList,i=void 0===(i=e.maxUserCountPerReaction)?10:i,r=e.messageIDMap,s=void 0,l=void 0;return(e=a[0]).conversationType===S.CONV_C2C&&(t=this.get(6),n=a.map((function(e){var n=t.getMessageKey(e);return r.set(n,e.ID),n})),s=jn.GET_C2C_MSG_REACTIONS,l={from:e.from,to:e.to,messageKeyList:n,count:i}),e.conversationType===S.CONV_GROUP&&(n=void 0,o=e.to,St(e.to)&&(o=Gt(n=e.to)),e=a.map((function(e){return r.set(e.sequence,e.ID),e.sequence})),s=jn.GET_GRP_MSG_REACTIONS,l={groupID:o,topicID:n,messageSequenceList:e,count:i}),{P:s,data:l}}},{key:"_createReactionUserListPack",value:function(e){var t=e.message,n=e.reactionID,o=e.nextSeq,a=void 0;return n={reactionID:n,nextSeq:void 0===o?0:o,count:100<(e=void 0===(e=e.count)?100:e)?100:e},t.conversationType===S.CONV_C2C&&(o=this.get(6),a=jn.GET_C2C_MSG_REACTION_USER_LIST,n.from=t.from,n.to=t.to,n.messageKey=o.getMessageKey(t)),t.conversationType===S.CONV_GROUP&&(e=void 0,o=t.to,St(t.to)&&(o=Gt(e=t.to)),a=jn.GET_GRP_MSG_REACTION_USER_LIST,n.groupID=o,n.topicID=e,n.messageSequence=t.sequence),{P:a,data:n}}},{key:"_handleReactionSummary",value:function(e,t){var n=this;return this.get(4).getUserNickAndAvatar(t).then((function(t){var o=[];return e.forEach((function(e){var a=[];e.reactionList.forEach((function(o){var i=o.reactionID,r=o.count,s=o.userIDList,l=(o=void 0===(o=o.reactedByMyself)?void 0:o,[]);s.forEach((function(e){t.forEach((function(t){e===t.userID&&l.push(t)}))})),s={reactionID:i,totalUserCount:r,partialUserList:l,reactedByMyself:n._computeReactedByMyself({reactedByMyself:o,messageID:e.messageID,reactionID:i})},a.push(s),pt(o)&&!n._reactedByMyselfMap.has(e.messageID)&&(r="".concat(e.messageID,"-").concat(i),n._reactionInfoMap.set(r,s))})),o.push({messageID:e.messageID,reactionList:a})})),o}))}},{key:"_addReactedByMyselfMap",value:function(e,t){this._reactedByMyselfMap.has(e)||this._reactedByMyselfMap.set(e,[]),-1===(e=this._reactedByMyselfMap.get(e)).indexOf(t)&&e.push(t)}},{key:"_removeReactedByMyselfMap",value:function(e,t){!this._reactedByMyselfMap.has(e)||-1<(t=(e=this._reactedByMyselfMap.get(e)).indexOf(t))&&e.splice(t,1)}},{key:"_computeReactedByMyself",value:function(e){var t=e.reactedByMyself,n=e.messageID;return e=e.reactionID,pt(t)?!!this._reactedByMyselfMap.has(n)&&this._reactedByMyselfMap.get(n).includes(e):1===t}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._reactedByMyselfMap.clear(),this._reactionInfoMap.clear()}}]),er),Yi=(s(Qi,Un),Gi=g(Qi),i(Qi,[{key:"sendMessage",value:function(e){var t=this,n=this._createMsg(e);if(null===n)return Mn({code:zn.MSG_SEND_FAIL});this._addSendMessageTotalCount(n);var o=Date.now();return this.get(11).setMessageRandom(n),this._sendComboMessage(n,e).then((function(e){var a=(e=e.data).time,i=e.sequence;return Ye(e=e.readReceiptCode)&&0!==e&&(new io("sendMessageWithReceipt").setMessage("from:".concat(n.from," to:").concat(n.to," sequence:").concat(i," readReceiptCode:").concat(e)).end(),Re.w("".concat(t._n,".sendMessage readReceiptCode:").concat(e," message:").concat(t.getErrMsg(e)))),t._addSendMessageSuccessCount(n,o),e=t.get(11),n.status=Dn,n.time=a,n.conversationType===S.CONV_GROUP&&(n.sequence=i),e.appendToMessageList(n),a=n,!0===n._isExcludedFromLastMessage&&(a=""),e.onMessageSent({conversationOptionsList:[{conversationID:n.conversationID,unreadCount:0,type:n.conversationType,subType:n.conversationSubType,lastMessage:a}]}),Tn({message:n})})).catch((function(e){return t._onSendMessageFailed(n,e)}))}},{key:"_sendComboMessage",value:function(e,t){var n=this._m.get(20),o="";return e.conversationType===S.CONV_C2C&&(o="".concat(O.NAME.OPEN_IM,".").concat(jn.SEND_C2C_MSG)),e.conversationType===S.CONV_GROUP&&(o="".concat(O.NAME.GRP,".").concat(jn.SEND_GRP_MSG)),n.sendComboMessage({servcmd:o,data:t})}},{key:"_createMsg",value:function(e){var t="".concat(this._n,"._createMsg"),n=null;try{var o,a=this.getMyUserID(),i={};i.senderTinyID=this.getMyTinyID(),i.currentUser=a,i.from=e.From_Account||a,e.GroupId?(i.conversationID="".concat(S.CONV_GROUP).concat(e.GroupId),i.conversationType=S.CONV_GROUP,i.to=e.GroupId):e.To_Account&&(i.conversationID="".concat(S.CONV_C2C).concat(e.To_Account),i.conversationType=S.CONV_C2C,i.to=e.To_Account),i.time=e.MsgTimeStamp||0,i.random=e.Random||e.MsgRandom||0,i.priority=e.MsgPriority,dt(e.CloudCustomData)&&0<e.CloudCustomData.length&&(i.cloudCustomData=e.CloudCustomData),Ze(e.SendMsgControl)&&(i.messageControlInfo={},e.SendMsgControl.includes("NoUnread")&&(i.messageControlInfo.excludedFromUnreadCount=1),e.SendMsgControl.includes("NoLastMsg")&&(i.messageControlInfo.excludedFromLastMessage=1)),i.conversationType===S.CONV_GROUP&&Ze(e.To_Account)&&0<e.To_Account.length&&(o=e.To_Account,50<e.To_Account.length&&(o=e.To_Account.slice(0,50),Re.w("".concat(t," To_Account must be less than or equal to 50."))),i.receiverList=v(o),e.To_Account=v(o)),1!==e.IsNeedReadReceipt&&1!==e.NeedReadReceipt||(i.needReadReceipt=!0),1===e.SupportMessageExtension&&(i.isSupportExtension=!0),(n=new No(i)).status=bn,e.MsgClientTime=n.clientTime,n.conversationType===S.CONV_C2C&&(e.MsgSeq=n.sequence);for(var r,s=e.MsgBody.length,l=0;l<s;l++)"TIMTextElem"===(r=e.MsgBody[l]).MsgType?n.setTextElement(r.MsgContent.Text):"TIMCustomElem"===r.MsgType?n.setCustomElement({data:r.MsgContent.Data||"",description:r.MsgContent.Desc||"",extension:r.MsgContent.Ext||""}):"TIMFaceElem"===r.MsgType&&n.setFaceElement({index:r.MsgContent.Index,data:r.MsgContent.Data});var c=n.getElements();n.payload=c[0].content,n.type=c[0].type}catch(u){n=null,Re.e("".concat(t," failed. error:"),u)}return n}},{key:"_onSendMessageFailed",value:function(e,t){e.status=Nn,this.get(11).deleteMessageRandom(e),this._addSendMessageFailCountOnUser(e,t);var n=new io("sendMessage"),o="head.seq:".concat(t.data.headSeq,"  type:").concat(e.type," from:").concat(e.from," to:").concat(e.to);return n.setMessage(o).setError(t).end(),Re.e("".concat(this._n,"._onSendMessageFailed ").concat(o," error:"),t),Mn(new Fn({code:t&&t.code?t.code:zn.MSG_SEND_FAIL,message:t&&t.message?t.message:void 0,data:{message:e}}))}},{key:"_getSendMessageSpecifiedKey",value:function(e){return e.conversationType===S.CONV_C2C?Yn:e.conversationType===S.CONV_GROUP&&(e=this.get(7).getLocalGroupProfile(e.to))?Et(e=e.type)?Wn:$n:void 0}},{key:"_addSendMessageTotalCount",value:function(e){(e=this._getSendMessageSpecifiedKey(e))&&this.get(26).addTotalCount(e)}},{key:"_addSendMessageSuccessCount",value:function(e,t){var n;(e=this._getSendMessageSpecifiedKey(e))&&((n=this.get(26)).addSuccessCount(e),n.addCost(e,$t(t,!1)))}},{key:"_addSendMessageFailCountOnUser",value:function(e,t){t=void 0===(t=t.code)?-1:t;var n=this.get(26);e=this._getSendMessageSpecifiedKey(e),xi(t)&&e&&n.addFailedCountOfUserSide(e)}}]),Qi),$i=(s(Xi,Un),Bi=g(Xi),i(Xi,[{key:"registerPlugin",value:function(e){var t=this,n="0";Object.keys(e).forEach((function(o){t.plugins[o]=e[o],"tim-upload-plugin"===o&&"function"==typeof e[o].getVersion&&(n=e[o].getVersion())})),new io("registerPlugin").setMessage("".concat(Object.keys(e))).setMoreMessage("version:".concat(n)).end()}},{key:"getPlugin",value:function(e){return this.plugins[e]}},{key:"reset",value:function(){}}]),Xi),Wi=(s(Ji,Un),Vi=g(Ji),i(Ji,[{key:"_init",value:function(){this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"_startSync",value:function(e){var n=this,o=e.cookie,a=e.syncFlag,i=e.isOnlineSync,r="".concat(this._n,"._startSync"),s=(Re.l("".concat(r," options:"),e),new io("syncUnread"));s.setMessage(JSON.stringify(e)),this.req({P:jn.SYNC_UNREAD_MSG,data:{cookie:o,syncFlag:a,isOnlineSync:i}}).then((function(e){var o=(a=e.data).cookie,a=a.syncFlag,i="$cookie:".concat(o," syncFlag:").concat(a);Re.l("".concat(r," ok. ").concat(i)),n._cookie=o,s.setMoreMessage(i).end(),He(o)||(0===a||1===a?(n._dispatch(t(t({},e.data),{},{isSyncingEnded:!1})),n._startSync({cookie:o,syncFlag:a,isOnlineSync:0})):2===a&&n._dispatch(t(t({},e.data),{},{isSyncingEnded:!0})))})).catch((function(e){s.setError(e).end(),Re.e("".concat(r," failed. error:"),e)}))}},{key:"_dispatch",value:function(e){e.eventArray&&this.get(20).onMessage({head:{},body:{eventArray:e.eventArray,isInstantMessage:this._onlineSyncFlag,isSyncingEnded:e.isSyncingEnded}}),this.get(6).onNewMessage({dataList:e.messageList,isInstantMessage:!!e.isSyncingEnded&&this._onlineSyncFlag,C2CRemainingUnreadList:e.C2CRemainingUnreadList,C2CPairUnreadList:e.C2CPairUnreadList,isSyncingEnded:e.isSyncingEnded})}},{key:"syncOnNeed",value:function(){Re.l("".concat(this._n,".syncOnNeed cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:1})}},{key:"syncOnReconnected",value:function(){Re.l("".concat(this._n,".syncOnReconnected cookie:").concat(this._cookie)),this._onlineSyncFlag=!0,this._startSync({cookie:this._cookie,syncFlag:0,isOnlineSync:0})}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._onlineSyncFlag=!1,this._cookie=""}}]),Ji),Zi={req:{toAccount:"To_Account",fromAccount:"From_Account",to:"To_Account",from:"From_Account",groupID:"GroupId",groupAtUserID:"GroupAt_Account",extension:"Ext",data:"Data",description:"Desc",elements:"MsgBody",sizeType:"Type",downloadFlag:"Download_Flag",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",videoUrl:"",imageUrl:"URL",fileUrl:"Url",uuid:"UUID",priority:"MsgPriority",receiverUserID:"To_Account",receiverGroupID:"GroupId",messageSender:"SenderId",messageReceiver:"ReceiverId",nick:"From_AccountNick",avatar:"From_AccountHeadurl",messageNumber:"MsgNum",pbDownloadKey:"PbMsgKey",downloadKey:"JsonMsgKey",applicationType:"PendencyType",userIDList:"To_Account",groupNameList:"GroupName",userID:"To_Account",groupAttributeList:"GroupAttr",mainSequence:"AttrMainSeq",avChatRoomKey:"BytesKey",attributeControl:"AttrControl",sequence:"seq",messageControlInfo:"SendMsgControl",updateSequence:"UpdateSeq",clientTime:"MsgClientTime",sequenceList:"MsgSeqList",topicID:"TopicId",customData:"CustomString",isSupportTopic:"SupportTopic",isWebUniapp:"is_web_uniapp",isSupportExtension:"SupportMessageExtension",messageSequence:"MsgSeq",messageKey:"MsgKey",startSequence:"startSeq",simplifiedMessage:"DownsizeFlag",isRelayMessage:"IsRelayMsg",reactionID:"Reaction",messageSequenceList:"MsgSeqList",messageKeyList:"MsgKeyList",cmConfigID:"CustomModerationConfigID"},res:{MsgPriority:"priority",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",Download_Flag:"downloadFlag",GroupId:"groupID",Member_Account:"userID",MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",MsgSeq:"sequence",MsgRandom:"random",MsgTime:"time",MsgTimeStamp:"time",MsgContent:"content",MsgBody:"elements",From_AccountNick:"nick",From_AccountHeadurl:"avatar",GroupWithdrawInfoArray:"revokedInfos",GroupReadInfoArray:"groupMessageReadNotice",LastReadMsgSeq:"lastMessageSeq",WithdrawC2cMsgNotify:"c2cMessageRevokedNotify",C2cWithdrawInfoArray:"revokedInfos",C2cReadedReceipt:"c2cMessageReadReceipt",ReadC2cMsgNotify:"c2cMessageReadNotice",LastReadTime:"peerReadTime",MsgRand:"random",MsgType:"type",MsgShow:"messageShow",NextMsgSeq:"nextMessageSeq",FaceUrl:"avatar",ProfileDataMod:"profileModify",Profile_Account:"userID",ValueBytes:"value",ValueNum:"value",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgFrom_AccountExtraInfo:"messageFromAccountExtraInformation",Operator_Account:"operatorID",OpType:"operationType",ReportType:"operationType",UserId:"userID",User_Account:"userID",List_Account:"userIDList",MsgOperatorMemberExtraInfo:"operatorInfo",MsgMemberExtraInfo:"memberInfoList",ImageUrl:"avatar",NickName:"nick",MsgGroupNewInfo:"newGroupProfile",MsgAppDefinedData:"groupCustomField",Owner_Account:"ownerID",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupNotification:"notification",GroupApplyJoinOption:"joinOption",MsgKey:"messageKey",GroupInfo:"groupProfile",ShutupTime:"muteTime",Desc:"description",Ext:"extension",GroupAt_Account:"groupAtUserID",MsgNum:"messageNumber",PbMsgKey:"pbDownloadKey",JsonMsgKey:"downloadKey",MsgModifiedFlag:"isModified",PendencyItem:"applicationItem",PendencyType:"applicationType",AddTime:"time",AddSource:"source",AddWording:"wording",ProfileImImage:"avatar",PendencyAdd:"friendApplicationAdded",FrienPencydDel_Account:"friendApplicationDeletedUserIDList",Peer_Account:"userID",GroupAttr:"groupAttributeList",GroupAttrAry:"groupAttributeList",AttrMainSeq:"mainSequence",seq:"sequence",GroupAttrOption:"groupAttributeOption",BytesChangedKeys:"changedKeyList",GroupAttrInfo:"groupAttributeList",GroupAttrSeq:"mainSequence",PushChangedAttrValFlag:"isWithChangedAttributeInfo",SubKeySeq:"sequence",Val:"value",MsgGroupFromCardName:"senderNameCard",MsgGroupFromNickName:"senderNick",C2cNick:"peerNick",C2cImage:"peerAvatar",SendMsgControl:"messageControlInfo",NoLastMsg:"excludedFromLastMessage",NoUnread:"excludedFromUnreadCount",UpdateSeq:"updateSequence",MuteNotifications:"muteFlag",MsgClientTime:"clientTime",TinyId:"tinyID",GroupMsgReceiptList:"readReceiptList",ReadNum:"readCount",UnreadNum:"unreadCount",TopicId:"topicID",MillionGroupFlag:"communityType",SupportTopic:"isSupportTopic",MsgTopicNewInfo:"newTopicInfo",ShutupAll:"muteAllMembers",CustomString:"customData",TopicFaceUrl:"avatar",TopicIntroduction:"introduction",TopicNotification:"notification",TopicIdArray:"topicIDList",MsgVersion:"messageVersion",C2cMsgModNotifys:"c2cMessageModified",GroupMsgModNotifys:"groupMessageModified",ApplyJoinOption:"joinOption",MsgFlag:"messageRemindType",AtInfoList:"groupAtInfoList",AtFlagList:"groupAtType",AtMsgSeq:"sequence",BanDuration:"duration",BanDescription:"reason",NotVisible:"invisible",BytesTag:"tag",BytesValue:"value",RptBytesValue:"value",LatestSeq:"globalSequence",ClearSeq:"clearSequence",SupportMessageExtension:"isSupportExtension",ExtensionList:"extensions",GroupCounter:"counterList",Revoker_Account:"revoker",MsgExtensionNotify:"messageExtensionNotify",ExtensionC2cMsgInfo:"messageInfo",ExtensionGroupMsgInfo:"messageInfo",MsgOptType:"operateType",SetKVInfo:"operateResultList",DeleteKVInfo:"operateResultList",ClearKVInfo:"operateResultList",MsgKeyValue:"extensions",ClearMsgSeq:"clearSequence",MsgLastSeq:"globalSequence",InviteJoinOption:"inviteOption",MemberList_Account:"inviteeList",MsgMemberExtraInfoList:"inviteeInfoList",E:"event",GInf:"groupProfile",MCT:"clientTime",MR:"random",MP:"priority",MTS:"time",GId:"groupID",MS:"sequence",CCD:"cloudCustomData",F_Account:"from",F_Hd:"avatar",F_NN:"nick",GN:"groupName",GT:"groupType",IsSys:"isSystemMessage",OpInf:"operatorInfo",Img:"avatar",NN:"nick",OnlineInf:"onlineMemberInfo",ET:"expireTime",Num:"onlineMemberNum",Opt:"operationType",O_Account:"operatorID",RT:"operationType",UDF:"userDefinedField",L_Account:"userIDList",IsPlaceMsg:"isPlaceMessage",MsgCheckResult:"checkResult",Results:"resultList",Reaction:"reactionID",Reaction_Account:"userIDList",MsgReactionNotifyList:"messageReactionNotifyList",MsgReactionNotify:"messageReactionNotify",MsgReactionSummary:"reactionList",C2CMsgInfo:"C2CMessageInfo",GroupMsgInfo:"groupMessageInfo",int32_err_code:"errorCode",str_err_msg:"errorMsg",MsgDropReason:"messageDropReason",ReactedByMe:"reactedByMyself",Level:"messageRemindType",PeerReadTime:"timestamp",NoUnreadSeqList:"excludedUnreadSequenceList",NewMsg:"topicLatestMessage"},ignoreKeyWord:["C2C","ID","USP"]};function Ji(e){return o(this,Ji),(e=Vi.call(this,e))._n="SyncUnreadMsgModule",e._cookie="",e._onlineSyncFlag=!1,e.getIEmitInst().on(Yo.A2KEY_AND_TINYID_UPDATED,e._init,f(e)),e}function Xi(e){return o(this,Xi),(e=Bi.call(this,e))._n="PluginModule",e.plugins={},e}function Qi(e){return o(this,Qi),(e=Gi.call(this,e))._n="ComboMsgModule",e}function er(e){return o(this,er),(e=Fi.call(this,e))._n="MsgReactionModule",e._reactedByMyselfMap=new Map,e._reactionInfoMap=new Map,e}function tr(e){return o(this,tr),(e=zi.call(this,e))._n="MsgExtModule",e.msgExtMap=new Map,e.globalSeqMap=new Map,e.getMsgExtsMap=new Map,e}function nr(e){return o(this,nr),(e=Hi.call(this,e))._n="MessageModule",e._messageOptionsMap=new Map,e._mergerMessageHandler=new Li(f(e)),e}function or(e,t){if("string"!=typeof e&&!Array.isArray(e))throw new TypeError("Expected the input to be `string | string[]`");return t=Object.assign({pascalCase:!1},t),0===(e=Array.isArray(e)?e.map((function(e){return e.trim()})).filter((function(e){return e.length})).join("-"):e.trim()).length?"":1===e.length?t.pascalCase?e.toUpperCase():e.toLowerCase():(e=e=(e=e!==e.toLowerCase()?ar(e):e).replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(function(e,t){return t.toUpperCase()})).replace(/\d+(\w|$)/g,(function(e){return e.toUpperCase()})),t.pascalCase?e.charAt(0).toUpperCase()+e.slice(1):e)}var ar=function(e){for(var t=!1,n=!1,o=!1,a=0;a<e.length;a++){var i=e[a];t&&/[a-zA-Z]/.test(i)&&i.toUpperCase()===i?(e=e.slice(0,a)+"-"+e.slice(a),o=n,n=!(t=!1),a++):n&&o&&/[a-zA-Z]/.test(i)&&i.toLowerCase()===i?(e=e.slice(0,a-1)+"-"+e.slice(a-1),o=n,t=!(n=!1)):(t=i.toLowerCase()===i&&i.toUpperCase()!==i,o=n,n=i.toUpperCase()===i&&i.toLowerCase()!==i)}return e};function ir(e,t){var n=0;return function e(t,o){return 100<++n?(n--,t):Ze(t)?(a=t.map((function(t){return $e(t)?e(t,o):t})),n--,a):$e(t)?(i=t,r=function(e,t){if(!et(t))return!1;if(t!==or(t))for(var n=0;n<Zi.ignoreKeyWord.length&&!t.includes(Zi.ignoreKeyWord[n]);n++);var a;return pt(o[t])?(a=t)[0].toUpperCase()+or(a).slice(1):o[t]},s=Object.create(null),Object.keys(i).forEach((function(e){var t=r(i[e],e);t&&(s[t]=i[e])})),a=Dt(a=s,(function(t,n){return Ze(t)||$e(t)?e(t,o):t})),n--,a):void 0;var a,i,r,s}(e,t)}for(var rr,sr=String.fromCharCode,lr=function(e){var t=0|e.charCodeAt(0);if(55296<=t)if(t<56320)if(56320<=(e=0|e.charCodeAt(1))&&e<=57343){if(65535<(t=(t<<10)+e-56613888|0))return sr(240|t>>>18,128|t>>>12&63,128|t>>>6&63,128|63&t)}else t=65533;else t<=57343&&(t=65533);return t<=2047?sr(192|t>>>6,128|63&t):sr(224|t>>>12,128|t>>>6&63,128|63&t)},cr=function(e){for(var t=void 0===e?"":(""+e).replace(/[\x80-\uD7ff\uDC00-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]?/g,lr),n=0|t.length,o=new Uint8Array(n),a=0;a<n;a=a+1|0)o[a]=0|t.charCodeAt(a);return o},ur=(i(Ar,[{key:"getID",value:function(){return this._id}},{key:"_onOpen",value:function(e){this._handler.onOpen({id:this._id,res:JSON.stringify(e)})}},{key:"_onClose",value:function(e){this._handler.onClose({id:this._id,e:e})}},{key:"_onMessage",value:function(e){e=this._canIUseBinaryFrame?this._isAppCompressedData(e.data)?this._handler.inflate(e.data):function(e){for(var t=new Uint8Array(e),n="",o=0,a=t.length;o<a;){var i=t[o],r=0,s=0;if(i<=127?(r=0,s=255&i):i<=223?(r=1,s=31&i):i<=239?(r=2,s=15&i):i<=244&&(r=3,s=7&i),0<a-o-r)for(var l=0;l<r;)s=s<<6|63&(i=t[o+l+1]),l+=1;else s=65533,r=a-o;n+=String.fromCodePoint(s),o+=r+1}return n}(e.data):e.data,this._handler.onMessage({data:e})}},{key:"_isAppCompressedData",value:function(e){return 67===(e=new Uint8Array(e))[0]&&79===e[1]&&77===e[2]&&80===e[3]}},{key:"_onError",value:function(e){this._handler.onError({id:this._id,e:e})}},{key:"setIsWorkerEnabled",value:function(e){this._isWorkerEnabled=!0}},{key:"close",value:function(e){if(this._workerSocket&&(this._workerSocket.postMessage({cmd:"stop",code:e}),this._workerSocket.terminate(),this._workerSocket=null),Y)return ne.offSocketClose(),ne.offSocketMessage(),ne.offSocketOpen(),ne.offSocketError(),void ne.closeSocket();this._socket&&(X?(this._socket.onClose((function(){})),this._socket.onOpen((function(){})),this._socket.onMessage((function(){})),this._socket.onError((function(){}))):(this._socket.onopen=null,this._socket.onmessage=null,this._socket.onclose=null,this._socket.onerror=null),K?this._socket.close({code:e}):this._socket.close(e),this._socket=null)}},{key:"send",value:function(e){this._workerSocket?this._workerSocket.postMessage({cmd:"sendMessage",data:this._canIUseBinaryFrame?cr(e.data).buffer:e.data}):Y?ne.sendSocketMessage({data:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):this._socket&&(X?this._socket.send({data:this._canIUseBinaryFrame?cr(e.data).buffer:e.data,fail:function(){e.fail&&e.requestID&&e.fail(e.requestID)}}):this._socket.send(this._canIUseBinaryFrame?cr(e.data):e.data))}}]),Ar),dr=["keyMap"],pr=["keyMap"],hr="connected",fr="connecting",gr="disconnected",mr=(i(Lr,[{key:"_setWebsocketHost",value:function(){var e=this._chM.get(12);this._currentSite=A,this._chM.isOversea()&&(this._currentSite="OVERSEA"),e.isSingaporeSite()?this._currentSite="SINGAPORE":e.isKoreaSite()?this._currentSite="KOREA":e.isGermanySite()?this._currentSite="GERMANY":e.isIndiaSite()?this._currentSite="IND":e.isJapanSite()?this._currentSite="JPN":e.isUSASite()?this._currentSite="USA":e.isIndonesiaSite()&&(this._currentSite="INDONESIA"),O.HOST.setCurrent(this._currentSite)}},{key:"_initConnection",value:function(){var e=this._chM.get(12).getSDKAppID()+"",t=this._chM.get(12).isIndependentDomainDisabled();He(e=(pt(O.HOST.CURRENT.BACKUP)?this._url=O.HOST.CURRENT.DEFAULT:""===this._url?this._url=t?O.HOST.CURRENT.DEFAULT:O.HOST.CURRENT.DEFAULT0.replace("*",e):-1<this._url.indexOf(e)?this._url=O.HOST.CURRENT.DEFAULT:this._url===O.HOST.CURRENT.DEFAULT?this._url=O.HOST.CURRENT.IPV6||O.HOST.CURRENT.BACKUP:this._url===O.HOST.CURRENT.IPV6?this._url=O.HOST.CURRENT.BACKUP:this._url===O.HOST.CURRENT.BACKUP?this._url=this._canIUseAnyCast()?O.HOST.CURRENT.ANYCAST:O.HOST.CURRENT.DEFAULT:this._url===O.HOST.CURRENT.ANYCAST&&(O.HOST.CURRENT.ANYCAST="",this._url=O.HOST.CURRENT.DEFAULT),t=this._chM.get(12)).getProxyServer())||(this._url=e),t.isTestEnv()&&(this._url=D.TEST[this._currentSite].DEFAULT),this._connect(),this._nextPingTs=0}},{key:"_canIUseAnyCast",value:function(){return te&&O.HOST.CURRENT.ANYCAST}},{key:"onCheckTimer",value:function(e){e%1==0&&(this._checkPromiseMap(),this._checkNativeAppWS())}},{key:"_checkPromiseMap",value:function(){var e=this;0!==this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var o=t.reject,a=t.timestamp,i=(t=t.headSeq,15e3);-1!==n.indexOf(jn.LOGIN)?i=9e4:-1!==n.indexOf(jn.PING)&&(i=3e3),Date.now()-a>=i&&(Re.l("".concat(e._n,"._checkPromiseMap request timeout, delete requestID:").concat(n)),e._promiseMap.delete(n),o(new Fn({code:zn.NETWORK_TIMEOUT,data:{headSeq:t}})),e._chM.onRequestTimeout())}))}},{key:"_checkNativeAppWS",value:function(){W&&!this.isConnected()&&this._reConnect()}},{key:"onOpen",value:function(e){var t,n;this._readyState!==gr&&(this._onOpenTs=Date.now(),n=e.id,e=e.res,this._socketID=n,t=$t(this._startTs,!1),n="socketID:".concat(n," res:").concat(e),Re.l("".concat(this._n,"._onOpen cost:").concat(t," ms. ").concat(n)),new io("wsOnOpen").setMessage(t).setCostTime(t).setMoreMessage(n).end(),this._readyState=hr,this._reConnectCount=0,this._resend(),!0===this._reConnectFlag&&(this._chM.onReconnected(),this._reConnectFlag=!1),this._chM.onOpen())}},{key:"onClose",value:function(e){var t=new io("wsOnClose"),n=e.id,o=(e=e.e,"sourceSocketID:".concat(n," currentSocketID:").concat(this._socketID," code:").concat(e.code," reason:").concat(e.reason)),a=0;0!==this._onOpenTs&&(a=Date.now()-this._onOpenTs),t.setMessage(a).setCostTime(a).setMoreMessage(o).setCode(e.code).end(!0),Re.l("".concat(this._n,"._onClose ").concat(o," onlineTime:").concat(a)),n===this._socketID&&(this._readyState=gr,a<1e3?this._chM.onReconnectFailed():this._chM.onClose())}},{key:"onError",value:function(e){var t=e.id,n=(e=e.e,"sourceSocketID:".concat(t," currentSocketID:").concat(this._socketID));new io("wsOnError").setMessage(e.errMsg||JSON.stringify(e,["message","code"])).setMoreMessage(n).setLevel("error").end(!0),Re.w("".concat(this._n,"._onError"),e,n),t===this._socketID&&(this._readyState=gr,this._chM.onError())}},{key:"onMessage",value:function(e){var t;try{t=JSON.parse(e.data)}catch(s){new io("jsonParseError").setMessage(e.data).end()}if(t&&t.head){e=this._getRequestIDFromHead(t.head);var n,o,a,i,r=t.body;if(this._chM.get(30).isTRTCCommand(e)||(i=Ut(t.head),r=function e(t,n){return Ze(t)?t.map((function(t){return $e(t)?e(t,n):t})):$e(t)?(o=t,a=function(e,t){return pt(n[t])?or(t):n[t]},i={},Object.keys(o).forEach((function(e){i[a(o[e],e)]=o[e]})),Dt(i,(function(t){return Ze(t)||$e(t)?e(t,n):t}))):void 0;var o,a,i}(t.body,this._getResKeyMap(i))),Re.d("".concat(this._n,".onMessage ret:").concat(JSON.stringify(r)," requestID:").concat(e," has:").concat(this._promiseMap.has(e))),this._setNextPingTs(),this._promiseMap.has(e))return n=(i=this._promiseMap.get(e)).resolve,o=i.reject,a=i.timestamp,i=i.headSeq,this._promiseMap.delete(e),this._calcRTT(a),void(r.errorCode&&0!==r.errorCode?(this._chM.onErrorCodeNotZero(r),o(new Fn({code:r.errorCode,message:r.errorInfo||"",data:e.includes(jn.MODIFY_C2C_MSG)||e.includes(jn.MODIFY_GRP_MSG)?{elements:r.elements,messageVersion:r.messageVersion,cloudCustomData:r.cloudCustomData,headSeq:i}:{headSeq:i}}))):n(Tn(r)));this._chM.onMessage({head:t.head,body:r})}}},{key:"_calcRTT",value:function(e){e=Date.now()-e,this._chM.get(26).addRTT(e)}},{key:"_connect",value:function(){this._readyState!==fr&&this._readyState!==hr&&(this._startTs=Date.now(),this._onOpenTs=0,this._readyState=fr,this._socket=new ur(this),this._socketID=this._socket.getID(),Re.l("".concat(this._n,"._connect isWorkerEnabled:").concat(this.getIsWorkerEnabled()," socketID:").concat(this._socketID," url:").concat(this.getURL())),new io("wsConnect").setMessage("socketID:".concat(this._socketID," url:").concat(this.getURL())).end())}},{key:"getURL",value:function(){this._chM.isDevMode()&&(this._canIUseBinaryFrame=!1);var e=Lt(),t=((Y||z&&"windows"===e||W)&&(this._canIUseBinaryFrame=!1),-1),n=("ios"===e?t=re||-1:"android"===e&&(t=le||-1),this._chM.get(12)),o=this._chM.getPlatform(),a=n.getSDKAppID();return n=n.getInstanceID(),a="sdkappid=".concat(a,"&instanceid=").concat(n,"&random=").concat(this._getRandom(),"&platform=").concat(o,"&host=").concat(e)+"&version=".concat(t,"&sdkversion=").concat("3.5.2"),H&&(a+="&isminigame=1"),this._chM.canIUseInflate()&&(a+="&compress=gzip"),(this._canIUseBinaryFrame?"".concat(this._url,"/binfo?"):"".concat(this._url,"/info?")).concat(a)}},{key:"_closeConnection",value:function(e){Re.l("".concat(this._n,"._closeConnection socketID:").concat(this._socketID)),this._socket&&(this._socket.close(e),this._socketID=-1,this._socket=null,this._readyState=gr)}},{key:"_resend",value:function(){var e=this;if(Re.l("".concat(this._n,"._resend reConnectFlag:").concat(this._reConnectFlag),"promiseMap.size:".concat(this._promiseMap.size," simpleRequestMap.size:").concat(this._simpleRequestMap.size)),0<this._promiseMap.size&&this._promiseMap.forEach((function(t,n){var o=t.uplinkData,a=t.resolve;t=t.reject,-1!==n.indexOf(jn.AV_POLLING)?e._promiseMap.delete(n):(e._promiseMap.set(n,{resolve:a,reject:t,timestamp:Date.now(),uplinkData:o}),e._execute(n,o))})),0<this._simpleRequestMap.size){var t,n=E(this._simpleRequestMap);try{for(n.s();!(t=n.n()).done;){var o=m(t.value,2),a=o[0],i=o[1];this._execute(a,i)}}catch(r){n.e(r)}finally{n.f()}this._simpleRequestMap.clear()}}},{key:"send",value:function(e){var t=this,n=(e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.head.cs=this._calcCheckSum(e.head.servcmd,e.body),e.keyMap,h(e,dr)),o=this._getRequestIDFromHead(e.head),a=JSON.stringify(n);return new Promise((function(i,r){t._promiseMap.set(o,{resolve:i,reject:r,timestamp:Date.now(),uplinkData:a,headSeq:e.head.seq}),Re.d("".concat(t._n,".send uplinkData:").concat(JSON.stringify(n)," requestID:").concat(o," readyState:").concat(t._readyState)),t._readyState!==hr?t._reConnect():(t._execute(o,a),t._chM.get(26).addRequestCount())}))}},{key:"simplySend",value:function(e){e.head.seq=this._getSequence(),e.head.reqtime=Math.floor(Date.now()/1e3),e.keyMap;var t=h(e,pr);e=this._getRequestIDFromHead(e.head),t=JSON.stringify(t),this._readyState!==hr?(this._simpleRequestMap.size<this.MAX_SIZE?this._simpleRequestMap.set(e,t):Re.l("".concat(this._n,".simplySend. simpleRequestMap is full, drop request!")),this._reConnect()):this._execute(e,t)}},{key:"_execute",value:function(e,t){this._socket.send({data:t,fail:X?this._onSendFail.bind(this):void 0,requestID:e})}},{key:"_onSendFail",value:function(e){Re.l("".concat(this._n,"._onSendFail requestID:").concat(e)),this._chM.onSendFail()}},{key:"_getSequence",value:function(){var e;if(this._startSequence<2415919103)return e=this._startSequence,this._startSequence+=1,2415919103===this._startSequence&&(this._startSequence=it()),e}},{key:"_getRequestIDFromHead",value:function(e){return e.servcmd+e.seq}},{key:"_getResKeyMap",value:function(e){return e=this._chM.getKeyMap(e),t(t({},Zi.res),e.res)}},{key:"_reConnect",value:function(){this._readyState!==hr&&this._readyState!==fr&&this.forcedReconnect()}},{key:"forcedReconnect",value:function(){var e="".concat(this._n,".forcedReconnect");Re.l("".concat(e," count:").concat(this._reConnectCount," readyState:").concat(this._readyState)),this._reConnectFlag=!0,this._resetRandom(),this._reConnectCount<this.MAX_RECONNECT_COUNT?(this._reConnectCount+=1,this._closeConnection(4001),this._initConnection()):(this._reConnectCount=0,this._chM.get(15).isOnline()?(Re.w("".concat(e," disconnected from wsserver but network is ok, continue...")),this._closeConnection(4001),this._initConnection()):this._chM.onReconnectFailed())}},{key:"getReconnectFlag",value:function(){return this._reConnectFlag}},{key:"_setNextPingTs",value:function(){this._nextPingTs=W?Date.now()+5e3:Date.now()+1e4}},{key:"getNextPingTs",value:function(){return this._nextPingTs}},{key:"isConnected",value:function(){return this._readyState===hr}},{key:"canIUseBinaryFrame",value:function(){return this._canIUseBinaryFrame}},{key:"getSocketID",value:function(){return this._socketID}},{key:"inflate",value:function(e){if(this._chM.canIUseInflate())return this._chM.get(37).inflate(e)}},{key:"setIsWorkerEnabled",value:function(e){Re.l("".concat(this._n,".setIsWorkerEnabled flag:").concat(e)),this._isWorkerEnabled=e}},{key:"getIsWorkerEnabled",value:function(){return this._isWorkerEnabled&&fe}},{key:"_getRandom",value:function(){return 0===this._random&&(this._random=Math.random()),this._random}},{key:"_resetRandom",value:function(){this._random=0}},{key:"_calcCheckSum",value:function(e,t){if(-1!==e.indexOf(jn.PING)||-1!==e.indexOf(jn.LOGIN)||-1!==e.indexOf(jn.LOGOUT)||-1!==e.indexOf(jn.AV_POLLING)||-1!==e.indexOf(jn.AV_NOAUTH_POLLING))return 0;for(var n=cr(JSON.stringify(t)),o=4294967295,a=0,i=n.length;a<i;a++){o^=n[a];for(var r=0;r<8;r++)1&~o?o>>>=1:o=o>>>1^3988292384}return(4294967295^o)>>>0}},{key:"close",value:function(){Re.l("".concat(this._n,".close")),this._closeConnection(4e3),this._promiseMap.clear(),this._startSequence=it(),this._readyState=gr,this._simpleRequestMap.clear(),this._reConnectFlag=!1,this._reConnectCount=0,this._onOpenTs=0,this._url="",this._random=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0}}]),Lr),vr=function(e,t,n){return new Promise((function(o,a){var i,r,s="application/x-www-form-urlencoded;charset=UTF-8";X?ne.request({url:t,data:n,method:e,timeout:3e3,header:{"content-type":s},success:function(e){e&&e.data&&e.data.NetCheckInfo&&Re.l("".concat("getconninfo ok in"," miniapp. ret:"),e.data),o()},fail:function(){a(new Fn({code:zn.NETWORK_ERROR}))}}):(i=new XMLHttpRequest,r=setTimeout((function(){i.abort(),a(new Fn({code:zn.NETWORK_TIMEOUT}))}),3e3),i.onreadystatechange=function(){4===i.readyState&&(r&&clearTimeout(r),200===i.status||304===i.status?(i.responseText&&-1<i.responseText.indexOf("NetCheckInfo")&&Re.l("".concat("getconninfo ok in"," web. ret:"),JSON.parse(i.responseText)),o()):a(new Fn({code:zn.NETWORK_ERROR})))},i.open(e,t,!0),i.setRequestHeader("Content-type",s),n?i.send(n):i.send())}))},_r=(s(Rr,Un),rr=g(Rr),i(Rr,[{key:"onCheckTimer",value:function(e){this._socketHandler&&(this.isLoggedIn()?(0<this._timerForNotLoggedIn&&(clearInterval(this._timerForNotLoggedIn),this._timerForNotLoggedIn=-1),this._socketHandler.onCheckTimer(e)):this._socketHandler.onCheckTimer(1),this._checkNextPing())}},{key:"onErrorCodeNotZero",value:function(e){this.get(20).onErrorCodeNotZero(e)}},{key:"onMessage",value:function(e){this.get(20).onMessage(e)}},{key:"send",value:function(e){return this._socketHandler?this._previousState!==S.NET_STATE_CONNECTED&&e.head.servcmd.includes(jn.SSO_STAT)?(this.reConnect(),this.isPrivateNetWork()?Promise.resolve():this._sendLogViaHTTP(e)):this._socketHandler.send(e):Promise.reject()}},{key:"_sendLogViaHTTP",value:function(e){var t=O.HOST.CURRENT.STAT;return t="".concat(t,"/v4/imopenstat/tim_web_report_v2?sdkappid=").concat(e.head.sdkappid,"&reqtime=").concat(Date.now()),e=JSON.stringify(e.body),vr("POST",t,e)}},{key:"simplySend",value:function(e){return this._socketHandler?this._socketHandler.simplySend(e):Promise.reject()}},{key:"onOpen",value:function(){this._ping()}},{key:"onClose",value:function(){this._socketHandler&&this._socketHandler.getReconnectFlag()&&this._emitNetStateChangeEvent(S.NET_STATE_DISCONNECTED),this.reConnect()}},{key:"onError",value:function(){X&&!W&&this.warn("DomainNameInMP"),this._emitNetStateChangeEvent(S.NET_STATE_DISCONNECTED)}},{key:"getKeyMap",value:function(e){return this.get(20).getKeyMap(e)}},{key:"onRequestTimeout",value:function(){3e4<=Date.now()-this._lastDiagnoseTS&&this.diagnose()}},{key:"onSendFail",value:function(){this._emitNetStateChangeEvent(S.NET_STATE_DISCONNECTED)}},{key:"onReconnected",value:function(){Re.l("".concat(this._n,".onReconnected cost:").concat($t(this._disconnectedTS,!0,!0))),this._m.restartTimer(),this.get(20).onReconnected($t(this._disconnectedTS,!1,!1)),this._disconnectedTS=0,this._emitNetStateChangeEvent(S.NET_STATE_CONNECTED)}},{key:"onReconnectFailed",value:function(){Re.l("".concat(this._n,".onReconnectFailed")),this._emitNetStateChangeEvent(S.NET_STATE_DISCONNECTED)}},{key:"setIsWorkerEnabled",value:function(e){this._socketHandler&&this._socketHandler.setIsWorkerEnabled(!1)}},{key:"offline",value:function(){this._emitNetStateChangeEvent(S.NET_STATE_DISCONNECTED)}},{key:"reConnect",value:function(){var e=0<arguments.length&&void 0!==arguments[0]&&arguments[0],t=!1,n=(this._socketHandler&&(t=this._socketHandler.getReconnectFlag()),"forcedFlag:".concat(e," fatalErrorFlag:").concat(this._fatalErrorFlag," previousState:").concat(this._previousState," reconnectFlag:").concat(t));if(Re.l("".concat(this._n,".reConnect ").concat(n)),!this._fatalErrorFlag&&this._socketHandler){if(!0===e)this._socketHandler.forcedReconnect();else{if(this._previousState===S.NET_STATE_CONNECTING&&t)return;this._socketHandler.forcedReconnect()}this._emitNetStateChangeEvent(S.NET_STATE_CONNECTING)}}},{key:"_emitNetStateChangeEvent",value:function(e){this._previousState!==e&&(Re.l("".concat(this._n,"._emitNetStateChangeEvent from ").concat(this._previousState," to ").concat(e)),e===S.NET_STATE_DISCONNECTED&&0===this._disconnectedTS&&(this._disconnectedTS=Date.now(),this.diagnose()),this._previousState=e,this.emitOEvt(T.NET_STATE_CHANGE,{state:e}))}},{key:"_ping",value:function(){var e,t=this;!0!==this._probing&&(this._probing=!0,e=this.get(20).getProtocolData({P:jn.PING}),this.send(e).then((function(){t._probing=!1})).catch((function(e){t._probing=!1;var n=t.get(15).isOnline();if(Re.w("".concat(t._n,"._ping failed. bOnline:").concat(n," error:"),e),e&&60002===e.code)return new io("error").setMessage("code:".concat(e.code," message:").concat(e.message)).end(),t._fatalErrorFlag=!0,void t._emitNetStateChangeEvent(S.NET_STATE_DISCONNECTED);n?t.reConnect():t._emitNetStateChangeEvent(S.NET_STATE_DISCONNECTED)})))}},{key:"_checkNextPing",value:function(){this._socketHandler&&this._socketHandler.isConnected()&&Date.now()>=this._socketHandler.getNextPingTs()&&this._ping()}},{key:"dealloc",value:function(){this._socketHandler&&(this._socketHandler.close(),this._socketHandler=null),-1<this._timerForNotLoggedIn&&clearInterval(this._timerForNotLoggedIn)}},{key:"onRestApiKickedOut",value:function(){this._socketHandler&&(this._socketHandler.close(),this.reConnect(!0))}},{key:"canIUseInflate",value:function(){return this._m.canIUseInflate()}},{key:"getSocketID",value:function(){if(this._socketHandler)return this._socketHandler.getSocketID()}},{key:"diagnose",value:function(){this.isPrivateNetWork()||(this._lastDiagnoseTS=Date.now(),this._diagnoseBySSO(),this._diagnoseByCDN())}},{key:"_diagnoseBySSO",value:function(){var e=this,t=this._socketHandler.getURL(),n=t.split("/")[2];n.startsWith("ws")&&(t=t.slice(t.indexOf("info?")+5),n="https://".concat(n,"/v3/netcheck/getconninfo?").concat(t,"&reqtime=").concat(Date.now()),vr("GET",n).catch((function(t){Re.w("".concat(e._n,"._diagnoseBySSO failed. error:"),t)})))}},{key:"_diagnoseByCDN",value:function(){var e=this,t=(t=this._socketHandler.getURL()).slice(t.indexOf("info?")+5);t="https://boce-cdn.my-imcloud.com/v3/netcheck/getconninfo?".concat(t,"&reqtime=").concat(Date.now()),vr("GET",t).catch((function(t){Re.w("".concat(e._n,"._diagnoseByCDN failed. error:"),t)}))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._previousState=S.NET_STATE_CONNECTED,this._probing=!1,this._fatalErrorFlag=!1,this._timerForNotLoggedIn=setInterval(this.onCheckTimer.bind(this),1e3),this._disconnectedTS=0,this._lastDiagnoseTS=0}}]),Rr),yr=["a2","tinyid"],Ir=["a2","tinyid"],Cr=(i(Nr,[{key:"_fillMap",value:function(){this._map.clear();var e=this._sessionM.genCommonHead(),n=this._sessionM.genCosSpecifiedHead(),o=this._sessionM.genSSOReportHead();this._map.set(jn.LOGIN,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.LOGIN)}),body:{state:"Online",isWebUniapp:0,deviceBrand:0,customInfo:""},keyMap:{req:{deviceBrand:"InstType"},res:{InstId:"instanceID",HelloInterval:"helloInterval",RichMsgAuthKey:"authKey"}}}),this._map.set(jn.LOGOUT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.LOGOUT)}),body:{type:0,isWebUniapp:0},keyMap:{req:{type:"wslogout_type"}}}),this._map.set(jn.HELLO,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.HELLO)}),body:{isWebUniapp:0},keyMap:{res:{NewInstInfo:"newInstanceInfo"}}}),this._map.set(jn.KICK_OTHER,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.STAT_SERVICE,".").concat(jn.KICK_OTHER)}),body:{}}),this._map.set(jn.COS_SIGN,{head:t(t({},n),{},{servcmd:"".concat(O.NAME.IM_COS_SIGN,".").concat(jn.COS_SIGN)}),body:{cmd:"open_im_cos_svc",subCmd:"get_cos_token",duration:300,version:2},keyMap:{req:{userSig:"usersig",subCmd:"sub_cmd",cmd:"cmd",duration:"duration",version:"version"},res:{expired_time:"expiredTime",bucket_name:"bucketName",session_token:"sessionToken",tmp_secret_id:"secretId",tmp_secret_key:"secretKey"}}}),this._map.set(jn.COS_PRE_SIG,{head:t(t({},n),{},{servcmd:"".concat(O.NAME.CUSTOM_UPLOAD,".").concat(jn.COS_PRE_SIG)}),body:{fileType:void 0,fileName:void 0,uploadMethod:0,duration:900},keyMap:{req:{userSig:"usersig",fileType:"file_type",fileName:"file_name",uploadMethod:"upload_method"},res:{expired_time:"expiredTime",request_id:"requestId",head_url:"headUrl",upload_url:"uploadUrl",download_url:"downloadUrl",ci_url:"ciUrl",snapshot_url:"requestSnapshotUrl"}}}),this._map.set(jn.SIMPLE_COS_PRE_SIG,{head:t(t({},n),{},{servcmd:"".concat(O.NAME.CUSTOM_UPLOAD,".").concat(jn.SIMPLE_COS_PRE_SIG)}),body:{uploadMethod:0,platform:2,SDKAppID:0,userID:"",conversationType:1,uploadConfig:[{fileID:1,fileType:1,fileName:""}]},keyMap:{req:{platform:"uint32_platform",SDKAppID:"uint32_sdkappid",userID:"str_user_id",uploadMethod:"uint32_upload_method",conversationType:"uint32_scene",uploadConfig:"rpt_upload_object",fileID:"uint32_file_id",fileType:"uint32_file_type",fileName:"str_file_name"},res:{str_final_ip:"uploadIP",rpt_pre_sig:"preSig",uint32_file_id:"fileID",uint32_exist_flag:"existFlag",str_download_url:"downloadUrl",str_upload_url:"uploadUrl",str_snapshot_url:"requestSnapshotUrl",str_file_key:"fileKey"}}}),this._map.set(jn.GET_IMAGE_INFO,{head:t(t({},n),{},{servcmd:"".concat(O.NAME.CUSTOM_UPLOAD,".").concat(jn.GET_IMAGE_INFO)}),body:{imageUrl:""},keyMap:{req:{imageUrl:"str_image_url"},res:{rpt_msg_image_info:"imageInfoArray",uint32_image_type:"type",str_url:"url",uint32_width:"width",uint32_height:"height",str_image_format:"imageFormat"}}}),this._map.set(jn.GET_IP,{head:t(t({},n),{},{servcmd:"".concat(O.NAME.CUSTOM_UPLOAD,".").concat(jn.GET_IP)}),body:{domainName:""},keyMap:{req:{domainName:"str_domain"},res:{str_final_ip:"ip"}}}),this._map.set(jn.VIDEO_COVER,{head:t(t({},n),{},{servcmd:"".concat(O.NAME.CUSTOM_UPLOAD,".").concat(jn.VIDEO_COVER)}),body:{version:1,platform:void 0,coverName:void 0,requestSnapshotUrl:void 0},keyMap:{req:{version:"version",platform:"platform",coverName:"cover_name",requestSnapshotUrl:"snapshot_url"},res:{error_code:"errorCode",error_msg:"errorInfo",download_url:"snapshotUrl"}}}),this._map.set(jn.FETCH_COMMERCIAL_CONFIG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_CONFIG_MANAGER,".").concat(jn.FETCH_COMMERCIAL_CONFIG)}),body:{SDKAppID:0},keyMap:{req:{SDKAppID:"uint32_sdkappid"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(jn.PUSHED_COMMERCIAL_CONFIG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_CONFIG_MANAGER,".").concat(jn.PUSHED_COMMERCIAL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_purchase_bits:"purchaseBits",uint32_expired_time:"expiredTime"}}}),this._map.set(jn.FETCH_CLOUD_CTRL_CONFIG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_CONFIG_MANAGER,".").concat(jn.FETCH_CLOUD_CTRL_CONFIG)}),body:{SDKAppID:0,version:0},keyMap:{req:{SDKAppID:"uint32_sdkappid",version:"uint64_version"},res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(jn.PUSHED_CLOUD_CTRL_CONFIG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_CONFIG_MANAGER,".").concat(jn.PUSHED_CLOUD_CTRL_CONFIG)}),body:{},keyMap:{res:{int32_error_code:"errorCode",str_error_message:"errorMessage",str_json_config:"cloudControlConfig",uint32_expired_time:"expiredTime",uint32_sdkappid:"SDKAppID",uint64_version:"version"}}}),this._map.set(jn.OVERLOAD_NOTIFY,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OVERLOAD_PUSH,".").concat(jn.OVERLOAD_NOTIFY)}),body:{},keyMap:{res:{OverLoadServCmd:"overloadCommand",DelaySecs:"waitingTime"}}}),this._map.set(jn.SYNC_UNREAD_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.SYNC_UNREAD_MSG)}),body:{cookie:"",syncFlag:0,needAbstract:1,isOnlineSync:0,needSignaling:1,needCachedMsg:1},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",from:"From_Account",to:"To_Account",time:"MsgTimeStamp",sequence:"MsgSeq",random:"MsgRandom",elements:"MsgBody"},res:{MsgList:"messageList",SyncFlag:"syncFlag",To_Account:"to",From_Account:"from",ClientSeq:"clientSequence",MsgSeq:"sequence",NoticeSeq:"noticeSequence",NotifySeq:"notifySequence",MsgRandom:"random",MsgTimeStamp:"time",MsgContent:"content",ToGroupId:"to",MsgKey:"messageKey",GroupTips:"groupTips",MsgBody:"elements",MsgType:"type",C2CRemainingUnreadCount:"C2CRemainingUnreadList",C2CPairUnreadCount:"C2CPairUnreadList"}}}),this._map.set(jn.GET_PROFANITY_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_MSG_AUDIT_MGR,".").concat(jn.GET_PROFANITY_LIST)}),body:{version:0,deviceID:"",startIndex:void 0},keyMap:{req:{version:"uint64_version",deviceID:"str_device_id",startIndex:"uint64_start_index"},res:{msg_cmd_error_code:"errorInfo",str_err_msg:"errorMessage",uint32_code:"errorCode",msg_scene_ctl_config:"filterConfig",uint64_c2c_custom_msg_flag:"c2c_custom_message",uint64_c2c_text_msg_flag:"c2c_text_message",uint64_group_custom_msg_flag:"group_custom_message",uint64_group_text_msg_flag:"group_text_message",uint64_group_info_flag:"group_profile",uint64_group_member_info_flag:"group_member_profile",uint64_relation_chain_flag:"sns",uint64_user_info_flag:"user_profile",rpt_msg_dirty_word:"lexicon",str_dirty_word:"profanity",str_replaced_content:"replacement",uint64_filter_type:"filterType",uint64_id:"id",uint64_word_type:"profanityType",uint64_complete_flag:"completeFlag",uint64_next_start_index:"nextStartIndex",uint64_version:"version",uint64_expired_time:"expiredTime"}}}),this._map.set(jn.SEND_C2C_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.SEND_C2C_MSG)}),body:{fromAccount:"",toAccount:"",msgSeq:0,msgRandom:0,msgBody:[],cloudCustomData:void 0,nick:"",avatar:"",msgLifeTime:void 0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:""},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:""}},messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",count:"MaxCnt",lastMessageTime:"LastMsgTime",messageKey:"MsgKey",peerAccount:"Peer_Account",data:"Data",description:"Desc",extension:"Ext",type:"MsgType",content:"MsgContent",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",nick:"From_AccountNick",avatar:"From_AccountHeadurl",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"IsNeedReadReceipt",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance"}}}),this._map.set(jn.SEND_GRP_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.SEND_GRP_MSG)}),body:{fromAccount:"",groupID:"",random:0,clientSequence:0,priority:"",msgBody:[],cloudCustomData:void 0,onlineOnlyFlag:0,offlinePushInfo:{pushFlag:0,title:"",desc:"",ext:"",apnsInfo:{sound:"",badgeMode:0,isVoipPush:void 0,image:""},androidInfo:{sound:"",XiaoMiChannelID:"",OPPOChannelID:"",GoogleChannelID:"",VIVOClassification:1,VIVOCategory:"",HuaWeiCategory:"",OPPOCategory:"",HuaWeiImage:"",HonorImage:"",GoogleImage:"",HonorImportance:""}},groupAtInfo:[],messageControlInfo:void 0,clientTime:void 0,needReadReceipt:0,topicID:void 0,receiverList:void 0,isSupportExtension:0,isRelayMessage:0,cmConfigID:void 0,forbidCallbackControl:void 0},keyMap:{req:{to:"GroupId",extension:"Ext",data:"Data",description:"Desc",random:"Random",sequence:"ReqMsgSeq",count:"ReqMsgNumber",type:"MsgType",priority:"MsgPriority",content:"MsgContent",elements:"MsgBody",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",clientSequence:"ClientSeq",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody",needReadReceipt:"NeedReadReceipt",receiverList:"To_Account",GoogleChannelID:"GoogleChannelID",XiaoMiChannelID:"XiaoMiChannelID",OPPOChannelID:"OPPOChannelID",OPPOCategory:"OPPOCategory",VIVOClassification:"VIVOClassification",VIVOCategory:"VIVOCategory",HonorImportance:"HonorImportance"},res:{MsgTime:"time",MsgSeq:"sequence"}}}),this._map.set(jn.REVOKE_C2C_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.REVOKE_C2C_MSG)}),body:{msgInfo:{fromAccount:"",toAccount:"",msgTimeStamp:0,msgSeq:0,msgRandom:0}},keyMap:{req:{msgInfo:"MsgInfo",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom"}}}),this._map.set(jn.REVOKE_GRP_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.REVOKE_GRP_MSG)}),body:{groupID:"",msgSeqList:void 0,topicID:""},keyMap:{req:{msgSeqList:"MsgSeqList",msgSeq:"MsgSeq"}}}),this._map.set(jn.GET_C2C_ROAMING_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.GET_C2C_ROAMING_MSG)}),body:{peerAccount:"",count:15,lastMessageTime:0,messageKey:"",withRecalledMessage:1,direction:0},keyMap:{req:{messageKey:"MsgKey",peerAccount:"Peer_Account",count:"MaxCnt",lastMessageTime:"LastMsgTime",withRecalledMessage:"WithRecalledMsg",direction:"GetDirection"},res:{LastMsgTime:"lastMessageTime",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer"}}}),this._map.set(jn.MODIFY_C2C_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.MODIFY_C2C_MSG)}),body:{from:"",to:"",sequence:0,random:0,time:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(jn.GET_GRP_ROAMING_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_ROAMING_MSG)}),body:{withRecalledMsg:1,groupID:"",count:15,sequence:"",topicID:void 0},keyMap:{req:{sequence:"ReqMsgSeq",count:"ReqMsgNumber",withRecalledMessage:"WithRecalledMsg"},res:{Random:"random",MsgTime:"time",MsgSeq:"sequence",ReqMsgSeq:"sequence",RspMsgList:"messageList",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgPriority:"priority",MsgBody:"elements",MsgType:"type",MsgContent:"content",IsFinished:"complete",Download_Flag:"downloadFlag",ClientSeq:"clientSequence",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",NextReqMsgSeq:"nextSequence"}}}),this._map.set(jn.SET_C2C_MSG_READ,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.SET_C2C_MSG_READ)}),body:{C2CMsgReaded:void 0},keyMap:{req:{lastMessageTime:"LastedMsgTime"}}}),this._map.set(jn.SET_C2C_PEER_MUTE_NOTIFICATIONS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.SET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{userIDList:void 0,muteFlag:0},keyMap:{req:{userIDList:"Peer_Account",muteFlag:"Mute_Notifications"}}}),this._map.set(jn.GET_C2C_PEER_MUTE_NOTIFICATIONS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.GET_C2C_PEER_MUTE_NOTIFICATIONS)}),body:{toAccount:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Peer_Account"},res:{MuteNotificationsList:"muteFlagList"}}}),this._map.set(jn.SET_GRP_MSG_READ,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.SET_GRP_MSG_READ)}),body:{groupID:void 0,messageReadSeq:void 0,topicID:void 0},keyMap:{req:{messageReadSeq:"MsgReadedSeq"}}}),this._map.set(jn.SET_ALL_MSG_READ,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.SET_ALL_MSG_READ)}),body:{readAllC2CMessage:0,groupMessageReadInfoList:[]},keyMap:{req:{readAllC2CMessage:"C2CReadAllMsg",groupMessageReadInfoList:"GroupReadInfo",messageSequence:"MsgSeq"},res:{C2CReadAllMsg:"readAllC2CMessage",GroupReadInfoArray:"groupMessageReadInfoList"}}}),this._map.set(jn.DEL_C2C_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.DEL_C2C_MSG)}),body:{fromAccount:"",to:"",keyList:void 0},keyMap:{req:{keyList:"MsgKeyList"}}}),this._map.set(jn.DEL_GRP_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.DEL_GRP_MSG)}),body:{groupID:"",deleter:"",keyList:void 0,topicID:void 0},keyMap:{req:{deleter:"Deleter_Account",keyList:"Seqs"}}}),this._map.set(jn.TRANSLATE_TEXT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_TRANSLATE,".").concat(jn.TRANSLATE_TEXT)}),body:{sourceTextList:void 0,SDKAppID:0,from:0,source:"",target:""},keyMap:{req:{sourceTextList:"SourceText",SDKAppID:"SdkAppId",from:"FromAccount"},res:{TargetText:"translatedTextList",RequestId:"requestID",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(jn.VOICE_TO_TEXT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_SPEECH,".").concat(jn.VOICE_TO_TEXT)}),body:{url:"",SDKAppID:0,format:"",sourceType:0,language:""},keyMap:{req:{url:"BytesUrl",SDKAppID:"Uint32Sdkappid",format:"BytesVoiceFormat",sourceType:"Uint64SourceType",language:"BytesEngServiceType"},res:{BytesRequestid:"requestID",BytesResult:"result",CmdErrorCode:"error",ErrorCode:"code",ErrorInfo:"message"}}}),this._map.set(jn.MODIFY_GRP_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.MODIFY_GRP_MSG)}),body:{groupID:"",topicID:void 0,sequence:0,version:0,elements:void 0,cloudCustomData:void 0},keyMap:{req:{sequence:"MsgSeq",version:"MsgVersion",type:"MsgType",content:"MsgContent"}}}),this._map.set(jn.GET_READ_RECEIPT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequence:"MsgSeq"}}}),this._map.set(jn.SEND_C2C_READ_RECEIPT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.SEND_C2C_READ_RECEIPT)}),body:{peerAccount:"",messageInfoList:void 0},keyMap:{req:{peerAccount:"Peer_Account",messageInfoList:"C2CMsgInfo",fromAccount:"From_Account",toAccount:"To_Account",sequence:"MsgSeq",random:"MsgRandom",time:"MsgTime",clientTime:"MsgClientTime"}}}),this._map.set(jn.SEND_READ_RECEIPT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.SEND_READ_RECEIPT)}),body:{groupID:"",sequenceList:void 0},keyMap:{req:{sequenceList:"MsgSeqList",sequence:"MsgSeq"}}}),this._map.set(jn.GET_READ_RECEIPT_DETAIL,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_READ_RECEIPT_DETAIL)}),body:{groupID:"",sequence:void 0,flag:0,cursor:0,count:0},keyMap:{req:{sequence:"MsgSeq",count:"Num"},res:{ReadList:"readUserIDList",Read_Account:"userID",UnreadList:"unreadUserIDList",Unread_Account:"userID",IsFinish:"isCompleted"}}}),this._map.set(jn.MODIFY_C2C_MSG_EXT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.MODIFY_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(jn.GET_C2C_MSG_EXT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_C2C_MSG_EXT)}),body:{from:void 0,to:void 0,messageKey:void 0,startSequence:void 0}}),this._map.set(jn.MODIFY_GRP_MSG_EXT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.MODIFY_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,operateType:void 0,extensionList:void 0}}),this._map.set(jn.GET_GRP_MSG_EXT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_GRP_MSG_EXT)}),body:{groupID:void 0,topicID:void 0,messageSequence:void 0,startSequence:void 0}}),this._map.set(jn.ADD_C2C_MSG_REACTION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.ADD_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(jn.RM_C2C_MSG_REACTION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.RM_C2C_MSG_REACTION)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(jn.GET_C2C_MSG_REACTIONS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_C2C_MSG_REACTIONS)}),body:{from:void 0,to:void 0,messageKeyList:void 0,count:void 0}}),this._map.set(jn.GET_C2C_MSG_REACTION_USER_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_C2C_MSG_REACTION_USER_LIST)}),body:{from:void 0,to:void 0,reactionID:void 0,messageKey:void 0,count:void 0}}),this._map.set(jn.ADD_GRP_MSG_REACTION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.ADD_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Add_Account"}}}),this._map.set(jn.RM_GRP_MSG_REACTION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.RM_GRP_MSG_REACTION)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,userIDList:void 0},keyMap:{req:{userIDList:"Del_Account"}}}),this._map.set(jn.GET_GRP_MSG_REACTIONS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_GRP_MSG_REACTIONS)}),body:{groupID:void 0,topicID:void 0,messageSequenceList:void 0,count:void 0},keyMap:{res:{MsgSeq:"messageSequence"}}}),this._map.set(jn.GET_GRP_MSG_REACTION_USER_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM_MSG_EXT,".").concat(jn.GET_GRP_MSG_REACTION_USER_LIST)}),body:{groupID:void 0,topicID:void 0,reactionID:void 0,messageSequence:void 0,nextSeq:void 0,count:void 0}}),this._map.set(jn.GET_C2C_PEER_READ_TIME,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.GET_C2C_PEER_READ_TIME)}),body:{userIDList:void 0},keyMap:{req:{userIDList:"To_Account"},res:{ReadTime:"peerReadTimeList"}}}),this._map.set(jn.PAGING_GET_CONV_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.PAGING_GET_CONV_LIST)}),body:{fromAccount:void 0,timeStamp:void 0,startIndex:void 0,pinnedTimeStamp:void 0,pinnedStartIndex:void 0,orderType:void 0,messageAssistFlag:15,assistFlag:31},keyMap:{req:{messageAssistFlag:"MsgAssistFlags",assistFlag:"AssistFlags",pinnedTimeStamp:"TopTimeStamp",pinnedStartIndex:"TopStartIndex"},res:{SessionItem:"conversations",ToAccount:"groupID",To_Account:"userID",UnreadMsgCount:"unreadCount",MsgGroupReadedSeq:"messageReadSeq",C2cPeerReadTime:"c2cPeerReadTime",LastMsgFlags:"lastMessageFlag",TopFlags:"isPinned",TopTimeStamp:"pinnedTimeStamp",TopStartIndex:"pinnedStartIndex",GroupId:"convGroupID",C2cRemark:"friendRemark",MsgRecvOption:"messageRemindType",GroupIgnoredUnreadSeqCount:"noUnreadCount",GroupNextMsgSeq:"nextMessageSeq"}}}),this._map.set(jn.DEL_CONV,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.DEL_CONV)}),body:{fromAccount:"",conversationList:void 0,clearHistoryMessage:void 0},keyMap:{req:{toGroupID:"ToGroupid",clearHistoryMessage:"ClearRamble",conversationList:"ContactItem"},res:{ResultItem:"resultList",ToGroupid:"groupID",ResultCode:"code",ResultInfo:"info"}}}),this._map.set(jn.CLEAR_HISTORY_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.CLEAR_HISTORY_MSG)}),body:{fromAccount:"",toAccount:void 0,type:1,toGroupID:void 0},keyMap:{req:{toGroupID:"ToGroupid"}}}),this._map.set(jn.PIN_CONV,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.PIN_CONV)}),body:{fromAccount:"",operationType:1,itemList:void 0},keyMap:{req:{itemList:"RecentContactItem"}}}),this._map.set(jn.DEL_GROUP_AT_TIPS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.DEL_GROUP_AT_TIPS)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(jn.SET_CONV_CUSTOM_DATA,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(jn.MARK_CONV,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.MARK_CONV)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"MarkItem",operationType:"OptType",groupID:"ToGroupId"},res:{ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(jn.CREATE_CONV_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.CREATE_CONV_GRP)}),body:{fromAccount:"",itemList:void 0},keyMap:{req:{itemList:"GroupContactItem",groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType"}}}),this._map.set(jn.DEL_CONV_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.DEL_CONV_GRP)}),body:{fromAccount:"",groupName:void 0},keyMap:{res:{GroupId:"convGroupID"}}}),this._map.set(jn.RENAME_CONV_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0},keyMap:{req:{oldName:"OldGroupName",newName:"NewGroupName",groupID:"ToGroupId",operationType:"ContactOptType",groupName:"OldGroupName",updateItem:"ContactUpdateItem"},res:{ContactOptType:"operationType",ToGroupId:"groupID",GroupId:"convGroupID"}}}),this._map.set(jn.ADD_CONV_TO_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:{groupName:void 0,updateGroupType:void 0,updateItem:void 0}}}),this._map.set(jn.DEL_CONV_FROM_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.RENAME_CONV_GRP)}),body:{fromAccount:"",updateType:void 0,updateGroup:void 0}}),this._map.set(jn.GET_CONV_GRP_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.GET_CONV_GRP_LIST)}),body:{fromAccount:"",startIndex:void 0},keyMap:{res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList"}}}),this._map.set(jn.SEARCH_CONV_GRP_MARK,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.RECENT_CONTACT,".").concat(jn.SEARCH_CONV_GRP_MARK)}),body:{fromAccount:"",contactItem:void 0},keyMap:{req:{groupID:"ToGroupId"},res:{GroupId:"convGroupID",ToGroupId:"groupID",OptType:"operationType",CustomMark:"customData",ContactGroupId:"convGroupIDList",ContactResultItem:"contactItem"}}}),this._map.set(jn.GET_USER_PROFILE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.PROFILE,".").concat(jn.GET_USER_PROFILE)}),body:{fromAccount:"",userItem:[]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(jn.UPDATE_MY_PROFILE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.PROFILE,".").concat(jn.UPDATE_MY_PROFILE)}),body:{fromAccount:"",profileItem:[{tag:Ae.NICK,value:""},{tag:Ae.GENDER,value:""},{tag:Ae.ALLOWTYPE,value:""},{tag:Ae.AVATAR,value:""}]},keyMap:{req:{toAccount:"To_Account",standardSequence:"StandardSequence",customSequence:"CustomSequence"}}}),this._map.set(jn.GET_BL,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.GET_BL)}),body:{fromAccount:"",startIndex:0,maxLimited:30}}),this._map.set(jn.ADD_TO_BL,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.ADD_TO_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(jn.RM_FROM_BL,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.RM_FROM_BL)}),body:{fromAccount:"",toAccount:[]}}),this._map.set(jn.SET_SELF_STATUS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.SET_SELF_STATUS)}),body:{customStatus:""}}),this._map.set(jn.GET_USER_STATUS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.GET_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{UserStatusList:"successUserList",ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID",Status:"statusType"}}}),this._map.set(jn.SUB_USER_STATUS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.SUB_USER_STATUS)}),body:{userIDList:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(jn.UNSUB_USER_STATUS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.UNSUB_USER_STATUS)}),body:{userIDList:void 0,unsubscribeAll:void 0},keyMap:{res:{ErrorList:"failureUserList",To_Account:"userID",Invalid_Account:"invalidUserID"}}}),this._map.set(jn.GET_FD_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.GET_FD_LIST)}),body:{fromAccount:"",startIndex:0,standardSequence:0,customSequence:0},keyMap:{res:{FriendNum:"friendCount",UserDataItem:"resultList",ValueItem:"tagValueList"}}}),this._map.set(jn.ADD_FD,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.ADD_FD)}),body:{fromAccount:"",addFriendItem:[],type:""},keyMap:{req:{source:"AddSource",wording:"AddWording",type:"AddType"},res:{ResultItem:"resultList"}}}),this._map.set(jn.UPDATE_FD,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.UPDATE_FD)}),body:{fromAccount:"",updateItem:void 0},keyMap:{req:{snsItem:"SnsItem"},res:{ResultItem:"resultList"}}}),this._map.set(jn.DEL_FD,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.DEL_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"DeleteType"},res:{ResultItem:"resultList"}}}),this._map.set(jn.GET_FD_PROFILE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.GET_FD_PROFILE)}),body:{fromAccount:"",userIDList:void 0},keyMap:{res:{InfoItem:"resultList",SnsProfileItem:"tagValueList"}}}),this._map.set(jn.CHECK_FD,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.CHECK_FD)}),body:{fromAccount:"",userIDList:[],type:""},keyMap:{req:{type:"CheckType"},res:{InfoItem:"resultList"}}}),this._map.set(jn.GET_FD_APPLICATION_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.GET_FD_APPLICATION_LIST)}),body:{fromAccount:"",applicationType:"",startTime:0,maxLimited:0,lastSequence:0},keyMap:{res:{PendencyItem:"resultList",AddSource:"source",AddTime:"time",AddWording:"wording",Image:"avatar",UnreadPendencyCount:"unreadCount",To_Account:"userID",PendencyType:"type"}}}),this._map.set(jn.RESPOND_FD_APPLICATION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.RESPOND_FD_APPLICATION)}),body:{fromAccount:"",responseFriendItem:[]},keyMap:{req:{tag:"TagName",action:"ResponseAction"},res:{ResultItem:"resultList"}}}),this._map.set(jn.DEL_FD_APPLICATION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.DEL_FD_APPLICATION)}),body:{fromAccount:"",type:"",userIDList:void 0},keyMap:{req:{type:"PendencyType",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(jn.REPORT_FD_APPLICATION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.REPORT_FD_APPLICATION)}),body:{fromAccount:"",latestTimeStamp:""},keyMap:{req:{latestTimeStamp:"LatestPendencyTimeStamp"}}}),this._map.set(jn.CREATE_FD_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.CREATE_FD_GRP)}),body:{fromAccount:"",groupName:void 0,userIDList:void 0},keyMap:{req:{groupName:"GroupName",userIDList:"To_Account"},res:{ResultItem:"resultList"}}}),this._map.set(jn.DEL_FD_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.DEL_FD_GRP)}),body:{fromAccount:"",nameList:void 0},keyMap:{req:{nameList:"GroupName"}}}),this._map.set(jn.GET_FD_GRP_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.GET_FD_GRP_LIST)}),body:{fromAccount:"",lastSequence:0,needFriend:"Need_Friend_Type_Yes"},keyMap:{res:{ResultItem:"resultList",GroupName:"name",FriendNumber:"friendCount",To_Account:"userIDList"}}}),this._map.set(jn.UPDATE_FD_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FD,".").concat(jn.UPDATE_FD_GRP)}),body:{fromAccount:"",oldName:"",newName:void 0,updateGroupItem:void 0},keyMap:{req:{oldName:"GroupOldName",newName:"GroupNewName"},res:{UpdateType:"type",ResultItem:"resultList"}}}),this._map.set(jn.GET_GRP_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_LIST)}),body:{memberAccount:"",limit:void 0,offset:void 0,groupType:void 0,responseFilter:{groupBaseInfoFilter:void 0,selfInfoFilter:void 0},isSupportTopic:0,needAppDefineData:1},keyMap:{req:{memberAccount:"Member_Account"},res:{GroupIdList:"groups",MsgSeq:"readedSequence",LastRecallTime:"_lastRevokedTime",AppDefinedData:"groupCustomField"}}}),this._map.set(jn.GET_GRP_PROFILE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_PROFILE)}),body:{groupIDList:void 0,responseFilter:{groupBaseInfoFilter:void 0,groupCustomFieldFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0}},keyMap:{req:{groupIDList:"GroupIdList",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",groupCustomFieldFilter:"AppDefinedDataFilter_Group",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{GroupIdList:"groups",AppDefinedData:"groupCustomField",AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_Group:"groupCustomFieldFilter",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",InfoSeq:"infoSequence",MemberList:"members",GroupInfo:"groups",ShutUpUntil:"muteUntil",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(jn.CREATE_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.CREATE_GRP)}),body:{type:void 0,name:void 0,groupID:void 0,ownerID:void 0,introduction:void 0,notification:void 0,maxMemberNum:void 0,joinOption:void 0,memberList:void 0,groupCustomField:void 0,memberCustomField:void 0,webPushFlag:1,avatar:"",isSupportTopic:void 0,inviteOption:void 0},keyMap:{req:{ownerID:"Owner_Account",userID:"Member_Account",avatar:"FaceUrl",maxMemberNum:"MaxMemberCount",joinOption:"ApplyJoinOption",groupCustomField:"AppDefinedData",memberCustomField:"AppMemberDefinedData",inviteOption:"InviteJoinOption"},res:{HugeGroupFlag:"avChatRoomFlag",OverJoinedGroupLimit_Account:"overLimitUserIDList"}}}),this._map.set(jn.DISMISS_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.DISMISS_GRP)}),body:{groupID:void 0}}),this._map.set(jn.UPDATE_GRP_PROFILE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.UPDATE_GRP_PROFILE)}),body:{groupID:void 0,name:void 0,introduction:void 0,notification:void 0,avatar:void 0,joinOption:void 0,groupCustomField:void 0,muteAllMembers:void 0,inviteOption:void 0},keyMap:{req:{groupCustomField:"AppDefinedData",muteAllMembers:"ShutUpAllMember",joinOption:"ApplyJoinOption",avatar:"FaceUrl",inviteOption:"InviteJoinOption"},res:{AppDefinedData:"groupCustomField",ShutUpAllMember:"muteAllMembers"}}}),this._map.set(jn.APPLY_JOIN_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1,historyMessageFlag:void 0},keyMap:{req:{applyMessage:"ApplyMsg",historyMessageFlag:"HugeGroupHistoryMsgFlag"},res:{HugeGroupFlag:"avChatRoomFlag",AVChatRoomKey:"avChatRoomKey",RspMsgList:"messageList",ToGroupId:"to"}}}),this._map.set(jn.APPLY_JOIN_GRP_NOAUTH,(e.a2,e.tinyid,{head:t(t({},h(e,yr)),{},{servcmd:"".concat(O.NAME.BIG_GRP_NO_AUTH,".").concat(jn.APPLY_JOIN_GRP)}),body:{groupID:void 0,applyMessage:void 0,userDefinedField:void 0,webPushFlag:1},keyMap:{req:{applyMessage:"ApplyMsg"},res:{HugeGroupFlag:"avChatRoomFlag"}}})),this._map.set(jn.QUIT_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.QUIT_GRP)}),body:{groupID:void 0}}),this._map.set(jn.SEARCH_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.SEARCH_GRP)}),body:{groupIDList:void 0,responseFilter:{groupBasePublicInfoFilter:["Type","Name","Introduction","Notification","FaceUrl","CreateTime","Owner_Account","LastInfoTime","LastMsgTime","NextMsgSeq","MemberNum","MaxMemberNum","ApplyJoinOption","InviteJoinOption"]}}}),this._map.set(jn.CHANGE_GRP_OWNER,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.CHANGE_GRP_OWNER)}),body:{groupID:void 0,newOwnerID:void 0},keyMap:{req:{newOwnerID:"NewOwner_Account"}}}),this._map.set(jn.HANDLE_GRP_APPLICATION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.HANDLE_GRP_APPLICATION)}),body:{groupID:void 0,applicant:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(jn.HANDLE_INVITE_JOIN_GRP,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.HANDLE_INVITE_JOIN_GRP)}),body:{groupID:void 0,applicant:void 0,invitee:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,userDefinedField:void 0},keyMap:{req:{applicant:"Applicant_Account",invitee:"Invited_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg"}}}),this._map.set(jn.HANDLE_GRP_INVITATION,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.HANDLE_GRP_INVITATION)}),body:{groupID:void 0,inviter:void 0,handleAction:void 0,handleMessage:void 0,authentication:void 0,messageKey:void 0,userDefinedField:void 0},keyMap:{req:{inviter:"Inviter_Account",handleAction:"HandleMsg",handleMessage:"ApprovalMsg",messageKey:"MsgKey"}}}),this._map.set(jn.GET_GRP_PENDENCY,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_PENDENCY)}),body:{startTime:void 0,limit:void 0,handleAccount:void 0},keyMap:{req:{handleAccount:"Handle_Account"},res:{To_Account:"userID",ApplyInviteMsg:"note"}}}),this._map.set(jn.DEL_GRP_SYSTEM_NOTICE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.DEL_GRP_SYSTEM_NOTICE)}),body:{messageListToDelete:void 0},keyMap:{req:{messageListToDelete:"DelMsgList",messageSeq:"MsgSeq",messageRandom:"MsgRandom"}}}),this._map.set(jn.AV_POLLING,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.BIG_GRP_POLLING,".").concat(jn.AV_POLLING)}),body:{USP:1,startSeq:1,startBroadcastSeq:void 0,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}}),this._map.set(jn.AV_NOAUTH_POLLING,(e.a2,e.tinyid,{head:t(t({},h(e,Ir)),{},{servcmd:"".concat(O.NAME.BIG_GRP_POLLING_NO_AUTH,".").concat(jn.AV_POLLING)}),body:{USP:1,startSeq:1,holdTime:90,key:void 0,simplifiedMessage:void 0},keyMap:{req:{USP:"USP"},res:{ToGroupId:"groupID",RspBroadcastMsgList:"broadcastMessageList",IsSystemMsg:"isSystemMessage"}}})),this._map.set(jn.GET_ONLINE_MBR_NUM,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_ONLINE_MBR_NUM)}),body:{groupID:void 0},keyMap:{res:{OnlineMemberNum:"memberCount"}}}),this._map.set(jn.SET_GRP_ATTR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.SET_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(jn.MODIFY_GRP_ATTR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.MODIFY_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key",value:"value"}}}),this._map.set(jn.DEL_GRP_ATTR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.DEL_GRP_ATTR)}),body:{groupID:void 0,groupAttributeList:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]},keyMap:{req:{key:"key"}}}),this._map.set(jn.CLEAR_GRP_ATTR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.CLEAR_GRP_ATTR)}),body:{groupID:void 0,mainSequence:void 0,avChatRoomKey:void 0,attributeControl:["RaceConflict"]}}),this._map.set(jn.GET_GRP_ATTR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_ATTR,".").concat(jn.GET_GRP_ATTR)}),body:{groupID:void 0,avChatRoomKey:void 0,groupType:1},keyMap:{req:{avChatRoomKey:"Key",groupType:"GroupType"}}}),this._map.set(jn.GET_GRP_NOTIFY,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_NOTIFY)}),body:{notifyReqList:[]},keyMap:{req:{notifyReqList:"NotifyReqList"},res:{NextMsgTime:"nextRevokedTime",NotifyMsgList:"notifyList",NotifyRspList:"notifyRspList"}}}),this._map.set(jn.UPDATE_GRP_COUNTER,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.UPDATE_GRP_COUNTER)}),body:{groupID:void 0,counterList:void 0,avChatRoomKey:void 0,mode:void 0},keyMap:{req:{counterList:"GroupCounter"}}}),this._map.set(jn.GET_GRP_COUNTER,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_COUNTER)}),body:{groupID:void 0,keyList:[],avChatRoomKey:void 0},keyMap:{req:{keyList:"GroupCounterKeys"}}}),this._map.set(jn.CREATE_TOPIC,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_COMMUNITY,".").concat(jn.CREATE_TOPIC)}),body:{groupID:void 0,topicName:void 0,avatar:void 0,customData:void 0,topicID:void 0,notification:void 0,introduction:void 0},keyMap:{req:{avatar:"FaceUrl"}}}),this._map.set(jn.DEL_TOPIC,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_COMMUNITY,".").concat(jn.DEL_TOPIC)}),body:{groupID:void 0,topicIDList:void 0},keyMap:{req:{topicIDList:"TopicIdList"},res:{DestroyResultItem:"resultList"}}}),this._map.set(jn.UPDATE_TOPIC_PROFILE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_COMMUNITY,".").concat(jn.UPDATE_TOPIC_PROFILE)}),body:{groupID:void 0,topicID:void 0,avatar:void 0,customData:void 0,notification:void 0,introduction:void 0,muteAllMembers:void 0,topicName:void 0},keyMap:{req:{avatar:"FaceUrl",muteAllMembers:"ShutUpAllMember"}}}),this._map.set(jn.GET_TOPIC_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_COMMUNITY,".").concat(jn.GET_TOPIC_LIST)}),body:{groupID:void 0,topicIDList:void 0,MemberInfoFilter:["NoUnreadSeqList"]},keyMap:{req:{topicIDList:"TopicIdList"},res:{TopicAndSelfInfo:"topicInfoList",TopicInfo:"topic",GroupID:"groupID",ShutUpTime:"muteTime",ShutUpAllFlag:"muteAllMembers",LastMsgTime:"lastMessageTime",MsgSeq:"readedSequence",LastMsgSeq:"sequence"}}}),this._map.set(jn.GET_GRP_MBR_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_MBR_LIST)}),body:{groupID:void 0,limit:0,offset:void 0,next:void 0,memberRoleFilter:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{AppMemberDefinedData:"memberCustomField",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",MemberList:"members",ShutUpUntil:"muteUntil"}}}),this._map.set(jn.GET_AV_MBR_LIST,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_AV,".").concat(jn.GET_AV_MBR_LIST)}),body:{groupID:void 0,offset:void 0,filter:void 0},keyMap:{req:{offset:"Timestamp",filter:"Mark"},res:{NextTimestamp:"offset"}}}),this._map.set(jn.GET_GRP_MBR_PROFILE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.GET_GRP_MBR_PROFILE)}),body:{groupID:void 0,userIDList:void 0,memberInfoFilter:void 0,memberCustomFieldFilter:void 0},keyMap:{req:{userIDList:"Member_List_Account",memberCustomFieldFilter:"AppDefinedDataFilter_GroupMember"},res:{MemberList:"members",ShutUpUntil:"muteUntil",AppDefinedDataFilter_GroupMember:"memberCustomFieldFilter",AppMemberDefinedData:"memberCustomField"}}}),this._map.set(jn.ADD_GRP_MBR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.ADD_GRP_MBR)}),body:{groupID:void 0,silence:void 0,userIDList:void 0},keyMap:{req:{userID:"Member_Account",userIDList:"MemberList"},res:{MemberList:"members"}}}),this._map.set(jn.DEL_GRP_MBR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.DEL_GRP_MBR)}),body:{groupID:void 0,userIDList:void 0,reason:void 0},keyMap:{req:{userIDList:"MemberToDel_Account"}}}),this._map.set(jn.BAN_AV_MBR,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.BAN_AV_MBR)}),body:{groupID:void 0,userIDList:void 0,duration:void 0,reason:""},keyMap:{req:{userIDList:"Members_Account",duration:"Duration",reason:"Description"}}}),this._map.set(jn.MODIFY_GRP_MBR_INFO,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP,".").concat(jn.MODIFY_GRP_MBR_INFO)}),body:{groupID:void 0,topicID:void 0,userID:void 0,messageRemindType:void 0,nameCard:void 0,role:void 0,memberCustomField:void 0,muteTime:void 0},keyMap:{req:{userID:"Member_Account",memberCustomField:"AppMemberDefinedData",muteTime:"ShutUpTime",messageRemindType:"MsgFlag"}}}),this._map.set(jn.MARK_AV_MBR_INFO,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_AV,".").concat(jn.MARK_AV_MBR_INFO)}),body:{groupID:void 0,operationType:1,memberList:[]},keyMap:{req:{operationType:"CommandType",memberList:"MemberList",markType:"Marks",userID:"Member_Account"},res:{CommandType:"operationType",Marks:"markType",Member_Account:"userID"}}}),this._map.set(jn.CS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.MSG_SEARCH,".").concat(jn.CS)}),body:{keywordList:void 0,keywordListMatchType:"or",account:void 0,groupID:void 0,count:100,cursor:void 0,messageTypeList:void 0,senderUserIDList:void 0,startTime:void 0,endTime:void 0},keyMap:{req:{keywordListMatchType:"MatchType",account:"PeerAccount",groupID:"GroupID",messageTypeList:"MsgTypeList",senderUserIDList:"SendUserIDList",keywords:"Keywords",keywordMatchType:"KeywordMatchType",count:"Count",miniBirthday:"UserBirthStart",maxBirthday:"UserBirthEnd",gender:"UserGenderType",groupTypeList:"GroupType",groupIDList:"GroupIdList"},res:{GroupID:"groupID",UserID:"userID",ErrorCode:"code",ErrorInfo:"message",TotalCount:"totalCount",Count:"messageCount",LastMsgTime:"lastMessageTime",ConversationMsgs:"searchResult",IsNeedReadReceipt:"needReadReceipt",IsPeerRead:"readReceiptSentByPeer",MsgSeq:"sequence",ReqMsgSeq:"sequence",IsSystemMsg:"isSystemMessage",ToGroupId:"to",EnumFrom_AccountType:"fromAccountType",EnumTo_AccountType:"toAccountType",GroupCode:"groupCode",MsgContent:"content",ClientSeq:"clientSequence",ToTopicId:"topicID",InvisibleMsgSeq:"invisibleSequenceList",Users:"userList",ProfileItems:"profileItems",StrValue:"value",IntValue:"value",Groups:"groupList",GroupFaceUrl:"avatar",GroupIntroduction:"introduction",GroupOwnerUserID:"ownerID",GroupOwnerUserName:"ownerNick",GroupOwnerTinyID:"ownerTinyID",GroupMemberNum:"memberNum",GroupName:"name",GroupType:"type",GroupMembers:"groupMemberList",GroupMemberUserID:"userID",GroupMemberTinyID:"userTinyID",GroupMemberUserName:"nick",GroupMemberNameCard:"nameCard"}}}),this._map.set(jn.USER_CS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.USER_SEARCH,".").concat(jn.CS)}),body:{keywords:void 0,keywordMatchType:0,miniBirthday:void 0,maxBirthday:void 0,gender:void 0,count:20,cursor:void 0}}),this._map.set(jn.GRP_CS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_SEARCH,".").concat(jn.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,count:20,cursor:void 0}}),this._map.set(jn.MBR_CS,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.GRP_MEMBER_SEARCH,".").concat(jn.CS)}),body:{keywords:void 0,keywordMatchType:0,groupType:void 0,groupIDList:void 0,count:20,cursor:void 0}}),this._map.set(jn.SSO_STAT,{head:t(t({},o),{},{servcmd:"".concat(O.NAME.IM_OPEN_STAT,".").concat(jn.SSO_STAT)}),body:{header:{},event:[],quality:[]},keyMap:{req:{SDKType:"sdk_type",SDKVersion:"sdk_version",deviceType:"device_type",platform:"platform",instanceID:"instance_id",traceID:"trace_id",SDKAppID:"sdk_app_id",userID:"user_id",tinyID:"tiny_id",extension:"extension",timestamp:"timestamp",networkType:"network_type",eventType:"event_type",code:"error_code",message:"error_message",moreMessage:"more_message",duplicate:"duplicate",costTime:"cost_time",level:"level",qualityType:"quality_type",reportIndex:"report_index",wholePeriod:"whole_period",totalCount:"total_count",rttCount:"success_count_business",successRateOfRequest:"percent_business",countLessThan1Second:"success_count_business",percentOfCountLessThan1Second:"percent_business",countLessThan3Second:"success_count_platform",percentOfCountLessThan3Second:"percent_platform",successCountOfBusiness:"success_count_business",successRateOfBusiness:"percent_business",successCountOfPlatform:"success_count_platform",successRateOfPlatform:"percent_platform",successCountOfMessageReceived:"success_count_business",successRateOfMessageReceived:"percent_business",avgRTT:"average_value",avgDelay:"average_value",avgValue:"average_value",uiPlatform:"ui_platform"}}}),this._map.set(jn.PING,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.HEARTBEAT,".").concat(jn.PING)}),body:{}}),this._map.set(jn.MSG_PUSH,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_PUSH,".").concat(jn.MSG_PUSH)}),body:{},keyMap:{res:{C2cMsgArray:"C2CMessageArray",GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",C2cNotifyMsgArray:"C2CNotifyMessageArray",C2cMsgInfo:"C2CReadReceiptArray",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyAdd_Account:"userID",ProfileImNick:"nick",PendencyType:"applicationType",C2CReadAllMsg:"readAllC2CMessage",IsNeedReadReceipt:"needReadReceipt",Status:"statusType"}}}),this._map.set(jn.MULTI_MSG_PUSH,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_PUSH,".").concat(jn.MULTI_MSG_PUSH)}),body:{},keyMap:{res:{GroupMsgArray:"groupMessageArray",GroupTips:"groupTips",ClientSeq:"clientSequence",MsgPriority:"priority",NoticeSeq:"noticeSequence",MsgContent:"content",MsgType:"type",MsgBody:"elements",ToGroupId:"to",Desc:"description",Ext:"extension",IsSyncMsg:"isSyncMessage",Flag:"needSync",NeedAck:"needAck",PendencyType:"applicationType"}}}),this._map.set(jn.MSG_PUSH_ACK,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OPEN_IM,".").concat(jn.MSG_PUSH_ACK)}),body:{sessionData:void 0},keyMap:{req:{sessionData:"SessionData"}}}),this._map.set(jn.STATUS_FORCE_OFFLINE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.STATUS_FORCE_OFFLINE)}),body:{},keyMap:{res:{C2cNotifyMsgArray:"C2CNotifyMessageArray",NoticeSeq:"noticeSequence",KickoutMsgNotify:"kickoutMsgNotify",NewInstInfo:"newInstanceInfo"}}}),this._map.set(jn.DOWNLOAD_MERGER_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_LONG_MSG,".").concat(jn.DOWNLOAD_MERGER_MSG)}),body:{downloadKey:""},keyMap:{res:{Data:"data",Desc:"description",Ext:"extension",Download_Flag:"downloadFlag",ThumbUUID:"thumbUUID",VideoUUID:"videoUUID"}}}),this._map.set(jn.UPLOAD_MERGER_MSG,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_LONG_MSG,".").concat(jn.UPLOAD_MERGER_MSG)}),body:{messageList:[]},keyMap:{req:{fromAccount:"From_Account",toAccount:"To_Account",msgTimeStamp:"MsgTimeStamp",msgSeq:"MsgSeq",msgRandom:"MsgRandom",msgBody:"MsgBody",type:"MsgType",content:"MsgContent",data:"Data",description:"Desc",extension:"Ext",sizeType:"Type",uuid:"UUID",url:"",imageUrl:"URL",fileUrl:"Url",remoteAudioUrl:"Url",remoteVideoUrl:"VideoUrl",thumbUUID:"ThumbUUID",videoUUID:"VideoUUID",videoUrl:"",downloadFlag:"Download_Flag",from:"From_Account",time:"MsgTimeStamp",messageRandom:"MsgRandom",messageSequence:"MsgSeq",elements:"MsgBody",clientSequence:"ClientSeq",payload:"MsgContent",messageList:"MsgList",messageNumber:"MsgNum",abstractList:"AbstractList",messageBody:"MsgBody"}}}),this._map.set(jn.FOLLOW,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FOLLOW,".").concat(jn.FOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"FollowItem"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(jn.UNFOLLOW,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FOLLOW,".").concat(jn.UNFOLLOW)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(jn.GET_FOLLOW_INFO,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FOLLOW,".").concat(jn.GET_FOLLOW_INFO)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{FollowInfo:"followInfoList",To_Account:"userID",FollowerCount:"followersCount",FollowingCount:"followingCount",MutualFollowingCount:"mutualFollowersCount"}}}),this._map.set(jn.GET_FOLLOW,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FOLLOW,".").concat(jn.GET_FOLLOW)}),body:{fromAccount:"",type:1,nextCursor:"",count:500},keyMap:{req:{type:"FollowType",nextCursor:"StartCursor",count:"WantNum"},res:{FollowItem:"resultList",To_Account:"userID",ProfileItem:"profileList"}}}),this._map.set(jn.CHECK_FOLLOW_TYPE,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.FOLLOW,".").concat(jn.CHECK_FOLLOW_TYPE)}),body:{fromAccount:"",userIDList:[]},keyMap:{req:{userIDList:"To_Account"},res:{ResultItem:"resultList",To_Account:"userID"}}}),this._map.set(jn.SET_TOKEN,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.SET_TOKEN)}),body:{tokenID:"",pushMsg:0,sdkAppID:0,businessID:"",deviceBrand:"",deviceToken:"",isTpns:0,isWebUniapp:0,notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:""},keyMap:{req:{tokenID:"TokenID",pushMsg:"PushMsg",sdkAppID:"EnterVersion",businessID:"BusiID",deviceBrand:"InstType",deviceToken:"VarToken",isTpns:"IsTpns",notificationStatus:"NotificationStatus",deviceModel:"DeviceModel",systemVersion:"SystemVersion",pushVersion:"PushPluginVersion"}}}),this._map.set(jn.STAT_FOREGROUND,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.STAT_FOREGROUND)}),body:{isWebUniapp:0}}),this._map.set(jn.STAT_BACKGROUND,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_OPEN_STATUS,".").concat(jn.STAT_BACKGROUND)}),body:{C2CUnread:0,GroupUnread:0,isWebUniapp:0},keyMap:{req:{c2cUnreadCount:"C2cUnread",groupUnreadCount:"GrpUnread"}}}),this._map.set(jn.PUSH_REPORT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.OFFLINE_PUSH_REPORT,".").concat(jn.PUSH_REPORT)}),body:{eventList:[]},keyMap:{req:{eventList:"UinappPushEvents",type:"EventType",time:"EventTime",pushId:"ClickExt"}}}),this._map.set(jn.SET_ALL_RECEIVE_MSG_OPT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_MSG_LOGIC,".").concat(jn.SET_ALL_RECEIVE_MSG_OPT)}),body:{startTime:0,endTime:0,isRepeated:0,messageRemindType:0},keyMap:{req:{messageRemindType:"Level"}}}),this._map.set(jn.GET_ALL_RECEIVE_MSG_OPT,{head:t(t({},e),{},{servcmd:"".concat(O.NAME.IM_MSG_LOGIC,".").concat(jn.GET_ALL_RECEIVE_MSG_OPT)}),body:{toAccount:void 0}})}},{key:"has",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"update",value:function(){this._fillMap()}},{key:"getKeyMap",value:function(e){return this.has(e)?this.get(e).keyMap||{}:(Re.w("".concat(this._n,".getKeyMap unknown P:").concat(e)),{})}},{key:"getProtocolData",value:function(e){var t=e.P,n=e.data;if(e=this.get(t),t=null,n){var o,a=this._simpleDeepCopy(e),i=(a=this._updateService(n,a)).body,r=Object.create(null);for(o in i)if(Object.prototype.hasOwnProperty.call(i,o)){if(r[o]=i[o],void 0===n[o])continue;r[o]=n[o]}a.body=r,t=this._getUplinkData(a)}else t=this._getUplinkData(e);return t}},{key:"_getUplinkData",value:function(e){var t=Ut((e=this._dataCleaner(e)).head);return t=ir(e.body,this._getReqKeyMap(t)),e.body=t,e}},{key:"_updateService",value:function(e,t){var n,o,a=Ut(t.head);return this._isFromGroupRequest(t)&&(n=e.type,o=e.groupID,e=void 0===(e=e.groupIDList)?[]:e,pt(o=void 0===o?void 0:o)&&(o=e[0]||""),Tt({type:n,groupID:o})&&(t.head.servcmd="".concat(O.NAME.GRP_COMMUNITY,".").concat(a))),t}},{key:"_isFromGroupRequest",value:function(e){return e.head.servcmd.includes(O.NAME.GRP)||e.head.servcmd.includes(O.NAME.GRP_ATTR)}},{key:"_getReqKeyMap",value:function(e){return e=this.getKeyMap(e),t(t({},Zi.req),e.req)}},{key:"_dataCleaner",value:function(e){var t,o=Array.isArray(e)?[]:Object.create(null);for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&et(t)&&null!==e[t]&&void 0!==e[t]&&("object"!==n(e[t])?o[t]=e[t]:o[t]=this._dataCleaner.bind(this)(e[t]));return o}},{key:"_simpleDeepCopy",value:function(e){for(var t,n=Object.keys(e),o={},a=0,i=n.length;a<i;a++)Ze(e[t=n[a]])?o[t]=Array.from(e[t]):$e(e[t])?o[t]=this._simpleDeepCopy(e[t]):o[t]=e[t];return o}}]),Nr),kr=[jn.MSG_PUSH_ACK],Er=(i(Dr,[{key:"_onC2CMsgArray",value:function(e){var t=this._sessionM.get(6);e.dataList.forEach((function(e){var t;1===e.isSyncMessage&&(t=e.from,e.from=e.to,e.to=t)})),1===e.needSync&&this._sessionM.get(19).syncOnNeed(),t.onNewMessage({dataList:e.dataList,isInstantMessage:!0})}},{key:"_onC2CMsgModified",value:function(e){this._sessionM.get(6).onMsgModified(e)}},{key:"_onGroupMsgArray",value:function(e){var t=this._sessionM.get(7);t&&t.onNewMessage({event:e.event,dataList:e.dataList,isInstantMessage:!0})}},{key:"_onGroupMsgModified",value:function(e){var t=this._sessionM.get(7);t&&t.onMsgModified(e)}},{key:"_onGroupTips",value:function(e){var t=this._sessionM.get(7);if(t){var n=e.event,o=e.dataList,a=e.isInstantMessage,i=void 0===a||a,r=e.isSyncingEnded;switch(n){case 4:case 6:t.onNewGroupTips({event:n,dataList:o});break;case 5:for(var s=0;s<o.length;s++)if(Ze(o[s].elements.revokedInfos))t.onMsgRevoked({dataList:o});else if(Ze(o[s].elements.groupMessageReadNotice))t.onMsgReadNotice({dataList:o});else{if(!Ze(o[s].elements.readReceiptList)){t.onNewGroupSystemNotice({dataList:o,isInstantMessage:i,isSyncingEnded:r});break}t.onReadReceiptList({dataList:o})}break;case 12:this._sessionM.get(11).onNewGroupAtTips({dataList:o});break;default:Re.l("".concat(this._n,"._onGroupTips unknown event:").concat(n," dataList:"),o)}}}},{key:"_onC2CNotifyMsgArray",value:function(e){var t,n=this,o=e.dataList;Ze(o)&&(t=this._sessionM.get(6),o.forEach((function(e){var a,i;We(e)&&(e.hasOwnProperty("kickoutMsgNotify")?(a=(i=e.kickoutMsgNotify).kickType,i=void 0===(i=i.newInstanceInfo)?{}:i,1===a?n._sessionM.onMultipleAccountKickedOut(i):2===a?n._sessionM.onMultipleDeviceKickedOut(i):3===a&&n._sessionM.onRestApiKickedOut(i)):e.hasOwnProperty("c2cMessageRevokedNotify")?t&&t.onMsgRevoked({dataList:o},!0):e.hasOwnProperty("c2cMessageReadReceipt")?t&&t.onMsgReadReceipt({dataList:o}):e.hasOwnProperty("c2cMessageReadNotice")?t&&t.onMsgReadNotice({dataList:o}):e.hasOwnProperty("muteNotificationsSync")&&n._sessionM.get(11).onC2CMsgRemindTypeSynced({dataList:o}))})))}},{key:"_onC2CReadReceiptArray",value:function(e){this._sessionM.get(6).onReadReceiptList(e)}},{key:"_onProfileModified",value:function(e){this._sessionM.get(4).onProfileModified({dataList:e.dataList});var t=this._sessionM.get(8);t&&t.onFriendProfileModified({dataList:e.dataList})}},{key:"_onRelationChainModified",value:function(e){this._sessionM.get(4).onRelationChainModified({dataList:e.dataList});var t=this._sessionM.get(8);t&&t.onRelationChainModified({dataList:e.dataList})}},{key:"_onRecentContact",value:function(e){var t;!Ze(e=e.dataList)||(t=this._sessionM.get(11))&&e.forEach((function(e){var n,o,a=e.pushType;1===a?(n=e.recentContactDeleteItem,t.onConvDeleted(n.recentContactList)):2===a?(n=e.recentContactTopItem,t.onConvPinnedStatus(n.recentContactList,!0)):3===a?(n=e.recentContactTopItem,t.onConvPinnedStatus(n.recentContactList,!1)):4===a?(n=e.recentContactMarkContact,t.onConvMarkUpdated(n.recentContactMarkContactItem)):5===a?(n=e.recentContactCreateContactGroup,t.onConvGroupCreated(n.msgContactGroupContactItem)):6===a?(n=e.recentContactDelContactGroup,t.onConvGroupDeleted(n.msgGroupItem)):7===a&&(a=(n=e.recentContactUpdateContactGroup).updateType,e=n.msgUpdateGroup,n=n.msgUpdateContact,1===a?1===(o=e.updateGroupType)?t.onConvGroupNameUpdated(e):2===o&&t.onConvInGroupUpdated(e):2===a&&t.onConvAddedToOrDeletedFromGroup(n))}))}},{key:"_onAllMsgRead",value:function(e){e=e.dataList;var t=this._sessionM.get(11);t&&t.onPushedAllMessageRead(e)}},{key:"_onUserStatusList",value:function(e){this._sessionM.get(4).onUserStatusUpdated(e)}},{key:"_onMsgExtNotify",value:function(e){this._sessionM.get(3).onMsgExtNotify(e)}},{key:"_onMsgReactionNotifyList",value:function(e){this._sessionM.get(34).onReactionNotifyList(e)}},{key:"_onMsgReactionNotify",value:function(e){this._sessionM.get(34).onReactionNotify(e)}},{key:"_onFollowNotify",value:function(e){this._sessionM.get(35).onFollowNotify(e)}},{key:"_onTopicLatestMsg",value:function(e){this._sessionM.get(10).onTopicLatestMsg(e)}},{key:"onMessage",value:function(e){var t=this,n=e.body;if(this._filterMsgFromIMOpenPush(e)){var o,a=n.eventArray,i=n.isInstantMessage,r=n.isSyncingEnded,s=n.needSync;if(Ze(a))for(var l,c,u,d=0,p=a.length;d<p;d++)100!==(u=(l=a[d]).event)?24!==u?26!==u?(o=Object.keys(l).find((function(e){return-1!==t._keys.indexOf(e)})))?(c=14===u?{readAllC2CMessage:l[o],groupMessageReadInfoList:l.groupMessageReadNotice||[]}:16===u?{userID:l.userID,timestamp:l.timestamp,readReceiptList:l[o]}:l[o],this._eventHandlerMap.get(o)({event:u,dataList:c,isInstantMessage:i,isSyncingEnded:r,needSync:s})):Re.l("".concat(this._n,".onMessage unknown eventItem:"),l):this._onTopicLatestMsg(l):this._onAllRcvMsgOptNotify(l):this._onRoomCustomData(l.content)}}},{key:"_onRoomCustomData",value:function(e){this._sessionM.get(30).onRoomCustomDataReceived(e),Re.l("".concat(this._n,"._onRoomCustomData data:").concat(e))}},{key:"_onAllRcvMsgOptNotify",value:function(e){this._sessionM.get(11).onAllRcvMsgOptNotify(e)}},{key:"_filterMsgFromIMOpenPush",value:function(e){var t=e.head,n=(e=e.body,t=t.servcmd,!1);return!(n=pt(t)?n:t.includes(O.NAME.IM_CONFIG_MANAGER)||t.includes(O.NAME.OVERLOAD_PUSH)||t.includes(O.NAME.STAT_SERVICE))||(t.includes(jn.PUSHED_CLOUD_CTRL_CONFIG)?this._sessionM.get(23).onPushedConfig(e):t.includes(jn.PUSHED_COMMERCIAL_CONFIG)?this._sessionM.get(27).onPushedConfig(e):t.includes(jn.OVERLOAD_NOTIFY)?this._sessionM.onPushedServerOverload(e):t.includes(jn.KICK_OTHER)&&(n=Date.now(),this._sessionM.reLoginOnKickOther(),e=new io("kickOther"),n-=t=this._sessionM.get(1).getLastWsHelloTs(),e.setMessage("last wshello time:".concat(t," diff:").concat(n,"ms")).end()),!1)}}]),Dr),Tr=[{cmd:jn.GET_GRP_PROFILE,interval:1,count:8},{cmd:jn.UPDATE_GRP_PROFILE,interval:1,count:8},{cmd:jn.GET_AV_MBR_LIST,interval:3,count:1},{cmd:jn.GET_GRP_PENDENCY,interval:1,count:15},{cmd:jn.GET_TOPIC_LIST,interval:1,count:10},{cmd:jn.SET_GRP_ATTR,interval:5,count:10},{cmd:jn.MODIFY_GRP_ATTR,interval:5,count:10},{cmd:jn.DEL_GRP_ATTR,interval:5,count:10},{cmd:jn.CLEAR_GRP_ATTR,interval:5,count:10},{cmd:jn.GET_GRP_ATTR,interval:5,count:20},{cmd:jn.UPDATE_GRP_COUNTER,interval:5,count:20},{cmd:jn.GET_GRP_COUNTER,interval:5,count:20},{cmd:jn.SET_ALL_MSG_READ,interval:1,count:1},{cmd:jn.GET_USER_STATUS,interval:5,count:20},{cmd:jn.SUB_USER_STATUS,interval:5,count:20},{cmd:jn.UNSUB_USER_STATUS,interval:5,count:20},{cmd:jn.CS,interval:5,count:20},{cmd:jn.GRP_CS,interval:5,count:20},{cmd:jn.MBR_CS,interval:5,count:20},{cmd:jn.USER_CS,interval:5,count:20},{cmd:jn.CHECK_FOLLOW_TYPE,interval:5,count:20},{cmd:jn.GET_GRP_ROAMING_MSG,interval:1,count:20},{cmd:jn.GET_C2C_ROAMING_MSG,interval:1,count:20}],Sr=new Map,Mr=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F"],wr=0,br=Mr.length;wr<br;wr++)Sr.set(wr,Mr[wr]);function Dr(e){o(this,Dr),this._sessionM=e,this._n="MsgDispatcher",this._eventHandlerMap=new Map,this._eventHandlerMap.set("C2CMessageArray",this._onC2CMsgArray.bind(this)),this._eventHandlerMap.set("groupMessageArray",this._onGroupMsgArray.bind(this)),this._eventHandlerMap.set("groupTips",this._onGroupTips.bind(this)),this._eventHandlerMap.set("C2CNotifyMessageArray",this._onC2CNotifyMsgArray.bind(this)),this._eventHandlerMap.set("C2CReadReceiptArray",this._onC2CReadReceiptArray.bind(this)),this._eventHandlerMap.set("profileModify",this._onProfileModified.bind(this)),this._eventHandlerMap.set("friendListMod",this._onRelationChainModified.bind(this)),this._eventHandlerMap.set("recentContactMod",this._onRecentContact.bind(this)),this._eventHandlerMap.set("readAllC2CMessage",this._onAllMsgRead.bind(this)),this._eventHandlerMap.set("c2cMessageModified",this._onC2CMsgModified.bind(this)),this._eventHandlerMap.set("groupMessageModified",this._onGroupMsgModified.bind(this)),this._eventHandlerMap.set("userStatusList",this._onUserStatusList.bind(this)),this._eventHandlerMap.set("messageExtensionNotify",this._onMsgExtNotify.bind(this)),this._eventHandlerMap.set("messageReactionNotifyList",this._onMsgReactionNotifyList.bind(this)),this._eventHandlerMap.set("messageReactionNotify",this._onMsgReactionNotify.bind(this)),this._eventHandlerMap.set("followChangeList",this._onFollowNotify.bind(this)),this._keys=v(this._eventHandlerMap.keys())}function Nr(e){o(this,Nr),this._n="PHandler",this._sessionM=e,this._map=new Map,this._fillMap()}function Rr(e){return o(this,Rr),(e=rr.call(this,e))._n="ChannelModule",e._socketHandler=new mr(f(e)),e._probing=!1,e._isAppShowing=!0,e._previousState=S.NET_STATE_CONNECTED,e._timerForNotLoggedIn=-1,e._timerForNotLoggedIn=setInterval(e.onCheckTimer.bind(f(e)),1e3),e._fatalErrorFlag=!1,e._disconnectedTS=0,e._lastDiagnoseTS=0,e}function Lr(e){o(this,Lr),this._chM=e,this._n="SocketHandler",this._promiseMap=new Map,this._readyState=gr,this._simpleRequestMap=new Map,this.MAX_SIZE=100,this._startSequence=it(),this._startTs=0,this._reConnectFlag=!1,this._nextPingTs=0,this._reConnectCount=0,this.MAX_RECONNECT_COUNT=3,this._socketID=-1,this._random=0,this._socket=null,this._url="",this._onOpenTs=0,this._canIUseBinaryFrame=!0,this._isWorkerEnabled=!0,this._currentSite=A,this._setWebsocketHost(),this._initConnection()}function Ar(e){o(this,Ar);var t,n,a=(this._handler=e).getURL();this._socket=null,this._workerSocket=null,this._id=it(),this._handler.getIsWorkerEnabled()?(t=URL.createObjectURL(new Blob([';let _socket = null;onmessage = function(event) {  if (event.data.cmd === "start") {    const url = event.data.url;    _socket = new WebSocket(url);    _socket.binaryType = "arraybuffer";    _socket.onopen = function() {      postMessage({ callback: "onOpen", extensions: _socket.extensions });    };    _socket.onclose = function(e) {      postMessage({ callback: "onOpen", e: { code: e.code, reason: e.reason } });    };    _socket.onmessage = function(e) {      postMessage({ callback: "onMessage", data: e.data });    };    _socket.onerror = function(e) {      postMessage({ callback: "onError", e: { isTrusted: "true" } });    };  } else if (event.data.cmd === "sendMessage") {    if (_socket !== null) {      _socket.send(event.data.data);    }  } else if (event.data.cmd === "stop") {    if (_socket !== null) {      _socket.close(event.data.code);      _socket = null;    }  }};'],{type:"application/javascript; charset=utf-8"})),this._workerSocket=new Worker(t),(n=this)._workerSocket.onmessage=function(e){var t=(a=e.data).callback,o=a.e,a=a.extensions;"onOpen"===t?n._onOpen(a):"onClose"===t?n._onClose(o):"onError"===t?n._onError(o):"onMessage"===t&&n._onMessage(e.data)},this._workerSocket.postMessage({cmd:"start",id:this._id,url:a})):X?Y?(ne.connectSocket({url:a,header:{"content-type":"application/json"}}),ne.onSocketClose(this._onClose.bind(this)),ne.onSocketOpen(this._onOpen.bind(this)),ne.onSocketMessage(this._onMessage.bind(this)),ne.onSocketError(this._onError.bind(this))):(this._socket=ne.connectSocket({url:a,header:{"content-type":"application/json"},complete:function(){}}),this._socket.onClose(this._onClose.bind(this)),this._socket.onOpen(this._onOpen.bind(this)),this._socket.onMessage(this._onMessage.bind(this)),this._socket.onError(this._onError.bind(this))):(this._socket=new WebSocket(a),this._socket.binaryType="arraybuffer",this._socket.onopen=this._onOpen.bind(this,this._socket.extensions),this._socket.onmessage=this._onMessage.bind(this),this._socket.onclose=this._onClose.bind(this),this._socket.onerror=this._onError.bind(this)),this._canIUseBinaryFrame=e.canIUseBinaryFrame()}function Or(e){for(var t,n,o=e,a="",i=0,r=(o=e.length%8!=0?"0".repeat(8-e.length%8)+e:o).length;i<r;i+=8)t=parseInt(o.slice(i,i+4),2),n=parseInt(o.slice(i+4,i+8),2),a+=Sr.get(t)+Sr.get(n);return a}function Pr(e){if(e<0||53<e)return NaN;var t=0|1073741824*Math.random();return 30<e?t+1073741824*(0|Math.random()*(1<<e-30)):t>>>30-e}function Ur(e,t){for(var n=e.toString(16),o=t-n.length,a="0";0<o;o>>>=1,a+=a)1&o&&(n=a+n);return n}s(tl,Un),Yr=g(tl),i(tl,[{key:"_init",value:function(){this._updateCmdFreqLimitMap(Tr)}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("cmd_frequency_limit");pt(e)||(e=JSON.parse(e),this._updateCmdFreqLimitMap(e))}},{key:"_updateCmdFreqLimitMap",value:function(e){var t=this;e.forEach((function(e){t._cmdFreqLimitMap.set(e.cmd,{interval:e.interval,count:e.count})}))}},{key:"updateProtocolConfig",value:function(){this._pHandler.update()}},{key:"req",value:function(e){Re.d("".concat(this._n,".req options:"),e);var t=e.P;if(!this._pHandler.has(t))return Re.w("".concat(this._n,".req unknown P:").concat(t)),Mn({code:zn.NO_PROTOCOL});var n=(e=this.getProtocolData(e)).head.servcmd;if(this._isFreqOverLimit(n))return Mn({code:o=zn.OVER_FREQUENCY_LIMIT,message:this.getErrMsg(o,this._getCmd(n))});if(this._isServerOverload(n))return Mn({code:o=zn.OPEN_SERVICE_OVERLOAD_ERROR,message:this.getErrMsg(o,this._getCmd(n))});var o=this.get(21);return kr.includes(t)?o.simplySend(e):o.send(e)}},{key:"getKeyMap",value:function(e){return this._pHandler.getKeyMap(e)}},{key:"genCommonHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:L,websdkversion:R,a2:e.getA2Key()||void 0,tinyid:e.getTinyID()||void 0,status_instid:e.getStatusInstanceID(),sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getA2Key()?void 0:e.getUserID(),usersig:e.getA2Key()?void 0:e.getUserSig(),sdkability:12775283,sdkability_ext:Or(""),cappid:e.getApplicationID(),cs:0}}},{key:"genCosSpecifiedHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:L,websdkversion:R,sdkappid:e.getSDKAppID(),contenttype:e.getContentType(),reqtime:0,identifier:e.getUserID(),usersig:e.getUserSig(),status_instid:e.getStatusInstanceID(),sdkability:12775283,sdkability_ext:Or(""),cappid:e.getApplicationID(),cs:0}}},{key:"genSSOReportHead",value:function(){var e=this.get(12);return{ver:"v4",platform:this._platform,websdkappid:L,websdkversion:R,sdkappid:e.getSDKAppID(),contenttype:"",reqtime:0,identifier:"",usersig:"",status_instid:e.getStatusInstanceID(),sdkability:12775283,sdkability_ext:Or(""),cappid:e.getApplicationID(),cs:0}}},{key:"getProtocolData",value:function(e){return this._pHandler.getProtocolData(e)}},{key:"trans",value:function(e){var n=e.servcmd;return e=e.data,n={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:e},this.get(21).send(n)}},{key:"sendComboMessage",value:function(e){var n=e.servcmd;return e=e.data,n={head:t(t({},this.genCommonHead()),{},{servcmd:n}),body:e},this.get(21).send(n)}},{key:"onErrorCodeNotZero",value:function(e){var t,n=e.errorCode;n===zn.HELLO_ANSWER_KICKED_OUT&&(t=e.kickType,e=void 0===(e=e.newInstanceInfo)?{}:e,1===t?this.onMultipleAccountKickedOut(e):2===t?this.onMultipleDeviceKickedOut(e):3===t&&this.onRestApiKickedOut(e)),n!==zn.MSG_A2KEY_EXPIRED&&n!==zn.ACCOUNT_A2KEY_EXPIRED||(this._onUserSigExpired(),this.get(21).reConnect())}},{key:"onMessage",value:function(e){var t=(n=e.body).needAck,n=n.sessionData;1===(void 0===t?0:t)&&this._sendACK(n),this._msgDispatcher.onMessage(e)}},{key:"onReconnected",value:function(e){this._incrementalPullContactFlag=e<=300,this._reLoginOnReconnected()}},{key:"reLoginOnKickOther",value:function(){Re.l("".concat(this._n,".reLoginOnKickOther")),this._reLogin()}},{key:"_reLoginOnReconnected",value:function(){Re.l("".concat(this._n,"._reLoginOnReconnected")),this._reLogin()}},{key:"_reLogin",value:function(){var e,t,n,o=this,a="".concat(this._n,"._reLogin");this.isLoggedIn()&&(e=0,(t=this.get(1).getPushModule())&&(e=t.getUniAppPlatform()),n=new io("reLogin"),this.req({P:jn.LOGIN,data:{isWebUniapp:e,customInfo:this.get(12).getCustomLoginInfo()}}).then((function(e){var t=(e=e.data).instanceID,i=(e=e.customStatus,o.get(12)),r=ea(e),s=(i.setStatusInstanceID(t),o.get(21)),l=s.getSocketID();l="socketID:".concat(l," instanceID:").concat(t," customStatus:").concat(r),n.setMessage(l).end(!0),Re.l("".concat(a," ok. ").concat(l)),i.getCustomStatus()!==r&&o.get(4).onUserStatusUpdated({dataList:[{to:o.getMyUserID(),statusType:S.USER_STATUS_ONLINE,customStatus:e}]}),s.diagnose(),o.get(11).syncConvList(o._incrementalPullContactFlag).then((function(){Re.l("".concat(a,", sync conv list ok.")),o.get(25).start()})),((t=o.get(7))&&t.updateLocalMainSequenceOnReconnected(),l=o.get(10)).resetGetTopicTime(),l.getTopicListOnReconnected(),(i=o.get(35))&&i.clearCacheOnReconnected()})))}},{key:"onMultipleAccountKickedOut",value:function(e){this.get(1).onMultipleAccountKickedOut(e)}},{key:"onMultipleDeviceKickedOut",value:function(e){this.get(1).onMultipleDeviceKickedOut(e)}},{key:"_onUserSigExpired",value:function(){this.get(1).onUserSigExpired()}},{key:"onRestApiKickedOut",value:function(e){this.get(1).onRestApiKickedOut(e)}},{key:"_sendACK",value:function(e){this.req({P:jn.MSG_PUSH_ACK,data:{sessionData:e}})}},{key:"_isFreqOverLimit",value:function(e){if(e=e.split(".")[1],!this._cmdFreqLimitMap.has(e))return!1;if(!this._cmdReqInfoMap.has(e))return this._cmdReqInfoMap.set(e,{startTime:Date.now(),requestCount:1}),!1;var t=(n=this._cmdFreqLimitMap.get(e)).count,n=n.interval,o=(a=this._cmdReqInfoMap.get(e)).startTime,a=a.requestCount;return Date.now()-o>1e3*n?(this._cmdReqInfoMap.set(e,{startTime:Date.now(),requestCount:1}),!1):(this._cmdReqInfoMap.set(e,{startTime:o,requestCount:a+=1}),t<a)}},{key:"_isServerOverload",value:function(e){if(!this._serverOverloadInfoMap.has(e))return!1;var t=(n=this._serverOverloadInfoMap.get(e)).overloadTime,n=n.waitingTime;return Date.now()-t<=1e3*n||(this._serverOverloadInfoMap.delete(e),!1)}},{key:"_getCmd",value:function(e){var t="";if(!e.includes("."))return t;var n,o=e.split(".")[1];for(n in jn)if(jn[n]===o){t=n;break}return t}},{key:"onPushedServerOverload",value:function(e){var t=e.overloadCommand;e=e.waitingTime,this._serverOverloadInfoMap.set(t,{overloadTime:Date.now(),waitingTime:e}),Re.w("".concat(this._n,".onPushedServerOverload waitingTime:").concat(e,"s cmd:").concat(this._getCmd(t)))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._updateCmdFreqLimitMap(Tr),this._cmdReqInfoMap.clear(),this._serverOverloadInfoMap.clear(),this._incrementalPullContactFlag=!0}}]);var xr,Vr,Br,Gr,Fr,zr,Hr,jr,qr,Kr,Yr,$r=tl,Wr=(s(el,Un),Kr=g(el),i(el,[{key:"getCloudConfig",value:function(e){return pt(e)?this._cloudConfig:this._cloudConfig.has(e)?this._cloudConfig.get(e):void 0}},{key:"getServerConfig",value:function(e){var t={code:0,data:""};return!pt(e)&&this._cloudConfig.has(e)&&(t.data=this._cloudConfig.get(e)),Promise.resolve(t)}},{key:"_canFetch",value:function(){return this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime}},{key:"fetchConfig",value:function(){var e,t=this,n="".concat(this._n,".fetchConfig"),o=this._canFetch();Re.l("".concat(n," canFetch:").concat(o)),o&&(e=new io("fetchCloudCtrlConfig"),o=this.get(12).getSDKAppID(),this._isFetching=!0,this.req({P:jn.FETCH_CLOUD_CTRL_CONFIG,data:{SDKAppID:o,version:this._version}}).then((function(o){t._isFetching=!1;var a=(i=o.data).version,i=i.cloudControlConfig;e.setMessage("version:".concat(t._version," newVersion:").concat(a," config:").concat(i)).end(),Re.l("".concat(n," ok")),t._parse(o.data)})).catch((function(o){t._isFetching=!1,e.setError(o).end(),Re.l("".concat(n," failed. error:"),o),t._setExpiredTime(12e4)})))}},{key:"onPushedConfig",value:function(e){Re.l("".concat(this._n,".onPushedConfig config:"),e),new io("pushedCloudCtrlConfig").setMessage("newVersion:".concat(e.version," config:").concat(e.cloudControlConfig)).end(),this._parse(e)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"_parse",value:function(e){var t=this,n="".concat(this._n,"._parse"),o=e.errorCode,a=e.errorMessage,i=e.cloudControlConfig,r=e.version,s=e.expiredTime;if(0===o){if(this._version!==r){var l=null;try{l=JSON.parse(i)}catch(c){this.isPrivateNetWork()||Re.e("".concat(n," failed. config:"),i)}l&&(this._cloudConfig.clear(),Object.keys(l).forEach((function(e){t._cloudConfig.set(e,l[e])})),this._version=r,this.emitIEvt(Yo.CLOUD_CONFIG))}this._setExpiredTime(1e3*s)}else pt(o)?(Re.l("".concat(n," failed. Invalid message format:"),e),this._setExpiredTime(36e5)):(Re.e("".concat(n," errorCode:").concat(o," errorMessage:").concat(a)),this._setExpiredTime(12e4))}},{key:"_setExpiredTime",value:function(e){this._expiredTime=Date.now()+e}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._cloudConfig.clear(),this._expiredTime=0,this._version=0,this._isFetching=!1}}]),el),Zr=(s(Qs,Un),qr=g(Qs),i(Qs,[{key:"start",value:function(){this._recoverGroupChat(),this._recoverC2CChat()}},{key:"_recoverGroupChat",value:function(){var e,t,n,o,a=this,i=this._getLocalConvList().filter((function(e){return e.type===S.CONV_GROUP&&e.groupProfile.type!==S.GRP_AVCHATROOM})),r=this.get(11),s=[];i.forEach((function(i){var l=i.conversationID;i=i.lastMessage,e=l.replace(S.CONV_GROUP,""),t=r.getLocalLastMessage(l),i&&0!==i.lastSequence&&t?(n=i.lastSequence,t=t.sequence,o=n-t,0<t&&1<=o&&o<300?a._recoverGroupMsg({groupID:e,localLastMessageSequence:t,remoteLastMessageSequence:n}):s.push(e)):s.push(e)})),this._getGroupNotice(s)}},{key:"_recoverC2CChat",value:function(){var e,t,n,o=this,a=this._getLocalConvList().filter((function(e){return e.type===S.CONV_C2C})),i=this.get(11),r=[Promise.resolve()];a.forEach((function(a){var s=a.conversationID;a=a.lastMessage,e=i.getLocalLastMessage(s),a&&0!==a.lastTime&&e&&(t=a.lastTime,e=e.time,n=t-e,0<e&&1<=n&&n<=600&&r.push(o._recoverC2CMsg({conversationID:s,localLastMessageTime:e,remoteLastMessageTime:t})))})),Promise.all(r).then((function(){Re.l("".concat(o._n,"._recoverC2CChat all done")),o.get(19).syncOnReconnected()}))}},{key:"_getLocalConvList",value:function(){return this.get(11).getLocalConvList()}},{key:"_recoverGroupMsg",value:function(e){var t=this,n="".concat(this._n,".").concat("_recoverGroupMsg"),o=(Re.l("".concat(n," options:"),e),e.groupID),a=e.localLastMessageSequence,i=e.remoteLastMessageSequence,r=JSON.stringify(e),s=new io("_recoverGroupMsg");s.setMessage(r),this._getGroupRoamingMsg({groupID:o,sequence:a}).then((function(e){var l=(e=e.data).complete,c=e.messageList;if(!pt(c)){e=c[0].sequence;var u=c.map((function(e){return e.sequence})),d=(u="".concat(r," complete:").concat(l," sequenceList:").concat(u),Re.l("".concat(n," ").concat(u)),e!==a&&e<i&&2!==l&&t._recoverGroupMsg({groupID:o,localLastMessageSequence:e,remoteLastMessageSequence:i}),s.setMessage(u).end(),t.get(7));1<c.length&&c.sort((function(e,t){return e.sequence-t.sequence}));for(var p=!1,h=0,f=c.length;h<f;h++)if(c[h].from===S.CONV_SYSTEM){p=!0;break}if(p)for(var g=0,m=c.length;g<m;g++){var v=c[g];v.from!==S.CONV_SYSTEM?d.onNewMessage({dataList:[v],isInstantMessage:!1,updateUnreadCount:!1}):d.onNewGroupTips({event:v.event,dataList:[v]})}else d.onNewMessage({dataList:c,isInstantMessage:!1,updateUnreadCount:!1})}})).catch((function(e){s.setError(e).end(),Re.w("".concat(n," failed. error:"),e)}))}},{key:"_getGroupNotice",value:function(e){var t=e.length;if(Re.l("".concat(this._n,"._getGroupNotice length:").concat(t)),0!==t){var n=this.get(7);if(t<=10)n.getNotice(e);else{var o=Math.floor(t/10);5<=o&&(o=5);for(var a=0;a<=o;a++)n.getNotice(e.slice(10*a,10*(a+1)))}}}},{key:"_getGroupRoamingMsg",value:function(e){var t=e.groupID;return e=e.sequence,this.req({P:jn.GET_GRP_ROAMING_MSG,data:{groupID:t,count:this.PULL_LIMIT_COUNT,sequence:e+this.PULL_LIMIT_COUNT-1}})}},{key:"_recoverC2CMsg",value:function(e){var t=this,n="".concat(this._n,".").concat("_recoverC2CMsg"),o=(Re.l("".concat(n," options:"),e),e.conversationID),a=e.localLastMessageTime,i=e.remoteLastMessageTime,r=JSON.stringify(e),s=new io("_recoverC2CMsg");return s.setMessage(r),this._getC2CRoamingMsg({conversationID:o,time:a}).then((function(e){var a=(e=e.data).complete;if(e=e.messageList,!pt(e)){var l=e.length;if(t.get(6).onNewMessage({dataList:e,isInstantMessage:!0}),l=e[l-1].time,e=e.map((function(e){return e.random})),e="".concat(r," complete:").concat(a," randomList:").concat(e),Re.l("".concat(n," ").concat(e)),s.setMessage(e).end(),l<i&&1!==a)return t._recoverC2CMsg({conversationID:o,localLastMessageTime:l,remoteLastMessageTime:i})}})).catch((function(e){s.setError(e).end(),Re.w("".concat(n," failed. error:"),e)}))}},{key:"_getC2CRoamingMsg",value:function(e){var t=e.conversationID;return e=e.time,this.req({P:jn.GET_C2C_ROAMING_MSG,data:{peerAccount:t.replace(S.CONV_C2C,""),count:this.PULL_LIMIT_COUNT+1,lastMessageTime:e,direction:1}})}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),Qs),Jr=(i(Xs,[{key:"addMessageDelay",value:function(e){0<=(e=Te()-e)&&this._e2eDelayArray.push(e)}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),xt(n/t,1)}},{key:"_calcCountWithLimit",value:function(e){var t=e.e2eDelayArray,n=e.min,o=e.max;return t.filter((function(e){return n<=e&&e<o})).length}},{key:"_calcPercent",value:function(e,t){return 100<(e=xt(e/t*100,2))?100:e}},{key:"_checkE2EDelayException",value:function(e,t){var n,o,a,i=e.filter((function(e){return t<e}));0<i.length&&(n=i.length,o=Math.min.apply(Math,v(i)),a=Math.max.apply(Math,v(i)),i=this._calcAvg(i,n),50<(e=xt(n/e.length*100,2))&&new io("messageE2EDelayException").setMessage("count:".concat(n," min:").concat(o," max:").concat(a," avg:").concat(i," percent:").concat(e)).setLevel("warning").end())}},{key:"getStatResult",value:function(){var e=this._e2eDelayArray.length;if(0===e)return null;var t=v(this._e2eDelayArray),n=this._calcCountWithLimit({e2eDelayArray:t,min:0,max:1}),o=this._calcCountWithLimit({e2eDelayArray:t,min:1,max:3}),a=this._calcPercent(n,e),i=this._calcPercent(o,e),r=this._calcAvg(t,e);return this._checkE2EDelayException(t,3),t.length=0,this.reset(),{totalCount:e,countLessThan1Second:n,percentOfCountLessThan1Second:a,countLessThan3Second:o,percentOfCountLessThan3Second:i,avgDelay:r}}},{key:"reset",value:function(){this._e2eDelayArray.length=0}}]),Xs),Xr=(i(Js,[{key:"addRequestCount",value:function(){this._requestCount+=1}},{key:"addRTT",value:function(e){this._rttArray.push(e)}},{key:"_calcTotalCount",value:function(){return this._requestCount}},{key:"_calcRTTCount",value:function(e){return e.length}},{key:"_calcSuccessRateOfRequest",value:function(e,t){return 0===t?0:100<(e=xt(e/t*100,2))?100:e}},{key:"_calcAvg",value:function(e,t){if(0===t)return 0;var n=0;return e.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcMax",value:function(){return Math.max.apply(Math,v(this._rttArray))}},{key:"_calcMin",value:function(){return Math.min.apply(Math,v(this._rttArray))}},{key:"getStatResult",value:function(){var e=this._calcTotalCount(),t=v(this._rttArray);if(0===e)return null;var n=this._calcRTTCount(t),o=this._calcSuccessRateOfRequest(n,e);return t=this._calcAvg(t,n),Re.l("".concat(this._n,".getStatResult max:").concat(this._calcMax()," min:").concat(this._calcMin()," avg:").concat(t)),this.reset(),{totalCount:e,rttCount:n,successRateOfRequest:o,avgRTT:t}}},{key:"reset",value:function(){this._requestCount=0,this._rttArray.length=0}}]),Js),Qr=(i(Zs,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}))}},{key:"addTotalCount",value:function(e){return!(pt(e)||!this._map.has(e)||(this._map.get(e).totalCount+=1,0))}},{key:"addSuccessCount",value:function(e){return!(pt(e)||!this._map.has(e)||(this._map.get(e).successCount+=1,0))}},{key:"addFailedCountOfUserSide",value:function(e){return!(pt(e)||!this._map.has(e)||(this._map.get(e).failedCountOfUserSide+=1,0))}},{key:"addCost",value:function(e,t){return!(pt(e)||!this._map.has(e)||(this._map.get(e).costArray.push(t),0))}},{key:"addFileSize",value:function(e,t){return!(pt(e)||!this._map.has(e)||(this._map.get(e).fileSizeArray.push(t),0))}},{key:"_calcSuccessRateOfBusiness",value:function(e){return pt(e)||!this._map.has(e)?-1:100<(e=xt((e=this._map.get(e)).successCount/e.totalCount*100,2))?100:e}},{key:"_calcSuccessRateOfPlatform",value:function(e){if(pt(e)||!this._map.has(e))return-1;var t=this._map.get(e);return 100<(e=xt(e=this._calcSuccessCountOfPlatform(e)/t.totalCount*100,2))?100:e}},{key:"_calcTotalCount",value:function(e){return pt(e)||!this._map.has(e)?-1:this._map.get(e).totalCount}},{key:"_calcSuccessCountOfBusiness",value:function(e){return pt(e)||!this._map.has(e)?-1:this._map.get(e).successCount}},{key:"_calcSuccessCountOfPlatform",value:function(e){return pt(e)||!this._map.has(e)?-1:(e=this._map.get(e)).successCount+e.failedCountOfUserSide}},{key:"_calcAvg",value:function(e){return pt(e)||!this._map.has(e)?-1:e===Jn?this._calcAvgSpeed(e):this._calcAvgCost(e)}},{key:"_calcAvgCost",value:function(e){var t=this._map.get(e).costArray.length;if(0===t)return 0;var n=0;return this._map.get(e).costArray.forEach((function(e){n+=e})),parseInt(n/t)}},{key:"_calcAvgSpeed",value:function(e){var t=0,n=0;return this._map.get(e).costArray.forEach((function(e){t+=e})),this._map.get(e).fileSizeArray.forEach((function(e){n+=e})),parseInt(1e3*n/t)}},{key:"getStatResult",value:function(e){var t=this._calcTotalCount(e);if(0===t)return null;var n=this._calcSuccessCountOfBusiness(e),o=this._calcSuccessRateOfBusiness(e),a=this._calcSuccessCountOfPlatform(e),i=this._calcSuccessRateOfPlatform(e),r=this._calcAvg(e);return this.reset(e),{totalCount:t,successCountOfBusiness:n,successRateOfBusiness:o,successCountOfPlatform:a,successRateOfPlatform:i,avgValue:r}}},{key:"reset",value:function(e){pt(e)?this._map.clear():this._map.set(e,{totalCount:0,successCount:0,failedCountOfUserSide:0,costArray:[],fileSizeArray:[]})}}]),Zs),es=(i(Ws,[{key:"initMap",value:function(e){var t=this;e.forEach((function(e){t._lastMap.set(e,new Map),t._currentMap.set(e,new Map)}))}},{key:"addMessageSequence",value:function(e){var t=e.key,n=e.message;if(pt(t)||!this._lastMap.has(t)||!this._currentMap.has(t))return!1;var o,a,i=n.conversationID;return n=n.sequence,i=i.replace(S.CONV_GROUP,""),0!==this._lastMap.get(t).size&&this._lastMap.get(t).has(i)?(a=(o=this._lastMap.get(t).get(i)).length-1,n>o[0]&&n<o[a]?(o.push(n),o.sort(),this._lastMap.get(t).set(i,o)):this._addCurrentMap(e)):this._addCurrentMap(e),!0}},{key:"_addCurrentMap",value:function(e){var t=e.key,n=(e=e.message).conversationID;e=e.sequence,n=n.replace(S.CONV_GROUP,""),this._currentMap.get(t).has(n)||this._currentMap.get(t).set(n,[]),this._currentMap.get(t).get(n).push(e)}},{key:"_copyData",value:function(e){if(!pt(e)){this._lastMap.set(e,new Map);var t,n=this._lastMap.get(e),o=E(this._currentMap.get(e));try{for(o.s();!(t=o.n()).done;){var a=m(t.value,2),i=a[0],r=a[1];n.set(i,r)}}catch(s){o.e(s)}finally{o.f()}n=null,this._currentMap.set(e,new Map)}}},{key:"getStatResult",value:function(e){if(pt(this._currentMap.get(e))||pt(this._lastMap.get(e)))return null;if(0===this._lastMap.get(e).size)return this._copyData(e),null;var t=0,n=0;if(this._lastMap.get(e).forEach((function(e,o){var a=(e=v(e.values())).length;e=e[a-1]-e[0]+1,t+=e,n+=a})),0===t)return null;var o=xt(n/t*100,2);return 100<o&&(o=100),this._copyData(e),{totalCount:t,successCountOfMessageReceived:n,successRateOfMessageReceived:o}}},{key:"reset",value:function(){this._currentMap.clear(),this._lastMap.clear()}}]),Ws),ts=(s($s,Un),jr=g($s),i($s,[{key:"_onLoginSuccess",value:function(){var e=this,t=(this._rateMessageSent.initMap(this._messageSentItems),this._rateMessageReceived.initMap(this._messageReceivedItems),this.get(13)),n=t.getItem(this.TAG,!1);!He(n)&&Xe(n.forEach)&&(Re.l("".concat(this._n,"._onLoginSuccess. logs count:").concat(n.length)),n.forEach((function(t){e._statInfoArr.push(t)})),t.removeItem(this.TAG,!1))}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("q_rpt_interval"),t=this.getCloudConfig("q_rpt_sdkappid_bl"),n=this.getCloudConfig("q_rpt_tinyid_wl");pt(e)||(this.REPORT_INTERVAL=Number(e)),pt(t)||(this.REPORT_SDKAPPID_BLACKLIST=t.split(",").map((function(e){return Number(e)}))),pt(n)||(this.REPORT_TINYID_WHITELIST=n.split(","))}},{key:"onCheckTimer",value:function(e){this.isLoggedIn()&&e%this.REPORT_INTERVAL==0&&(this.wholePeriod=!0,this._report())}},{key:"addRequestCount",value:function(){this._avgRTT.addRequestCount()}},{key:"addRTT",value:function(e){this._avgRTT.addRTT(e)}},{key:"addMessageDelay",value:function(e){this._avgE2EDelay.addMessageDelay(e)}},{key:"addTotalCount",value:function(e){this._rateMessageSent.addTotalCount(e)||Re.w("".concat(this._n,".addTotalCount invalid key:"),e)}},{key:"addSuccessCount",value:function(e){this._rateMessageSent.addSuccessCount(e)||Re.w("".concat(this._n,".addSuccessCount invalid key:"),e)}},{key:"addFailedCountOfUserSide",value:function(e){this._rateMessageSent.addFailedCountOfUserSide(e)||Re.w("".concat(this._n,".addFailedCountOfUserSide invalid key:"),e)}},{key:"addCost",value:function(e,t){this._rateMessageSent.addCost(e,t)||Re.w("".concat(this._n,".addCost invalid key or cost:"),e,t)}},{key:"addFileSize",value:function(e,t){this._rateMessageSent.addFileSize(e,t)||Re.w("".concat(this._n,".addFileSize invalid key or size:"),e,t)}},{key:"addMessageSequence",value:function(e){this._rateMessageReceived.addMessageSequence(e)||Re.w("".concat(this._n,".addMessageSequence invalid key:"),e.key)}},{key:"_getQualityItem",value:function(e){var n={},o=oo[this.get(15).getNetworkType()];switch(pt(o)&&(o=8),o={qualityType:to[e],timestamp:we(),networkType:o,extension:""},e){case qn:n=this._avgRTT.getStatResult();break;case Kn:n=this._avgE2EDelay.getStatResult();break;case Yn:case $n:case Wn:case Zn:case Jn:n=this._rateMessageSent.getStatResult(e);break;case Xn:case Qn:case eo:n=this._rateMessageReceived.getStatResult(e)}return null===n?null:t(t({},o),n)}},{key:"_report",value:function(e){var t=this,n=[],o=null,a=(pt(e)?this._qualityItems.forEach((function(e){null!==(o=t._getQualityItem(e))&&(o.reportIndex=t.reportIndex,o.wholePeriod=t.wholePeriod,n.push(o))})):null!==(o=this._getQualityItem(e))&&(o.reportIndex=this.reportIndex,o.wholePeriod=this.wholePeriod,n.push(o)),Re.d("".concat(this._n,"._report"),n),0<this._statInfoArr.length&&(n=n.concat(this._statInfoArr),this._statInfoArr=[]),e=this.get(12)).getSDKAppID();e=e.getTinyID(),0<(n=Vt(this.REPORT_SDKAPPID_BLACKLIST,a)&&!Bt(this.REPORT_TINYID_WHITELIST,e)?[]:n).length&&this._doReport(n)}},{key:"_doReport",value:function(e){var n=this,o={header:hi(this),quality:e};this.req({P:jn.SSO_STAT,data:t({},o)}).then((function(){n.reportIndex++,n.wholePeriod=!1})).catch((function(t){Re.w("".concat(n._n,"._doReport failed. error:"),t),n._statInfoArr=n._statInfoArr.concat(e),n._flushAtOnce()}))}},{key:"_flushAtOnce",value:function(){var e=this.get(13),t=e.getItem(this.TAG,!1),n=this._statInfoArr,o="".concat(this._n,"._flushAtOnce");He(t)?(Re.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)):(10<(n=n.concat(t)).length&&(n=n.slice(0,10)),Re.l("".concat(o," count:").concat(n.length)),e.setItem(this.TAG,n,!0,!1)),this._statInfoArr=[]}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._report(),this.reportIndex=0,this.wholePeriod=!1,this.REPORT_SDKAPPID_BLACKLIST=[],this.REPORT_TINYID_WHITELIST=[],this._avgRTT.reset(),this._avgE2EDelay.reset(),this._rateMessageSent.reset(),this._rateMessageReceived.reset()}}]),$s),ns=i((function e(t){o(this,e),He(t)||(this.userID=t.userID||"",this.nick=t.nick||"",this.avatar=t.avatar||"",this.time=t.time||0,this.source=t.source||"",this.wording=t.wording||"",this.type=t.type||"")})),os=(i(Ys,[{key:"getLocalApplicationList",value:function(){return{friendApplicationList:v(this._map.values()),unreadCount:this._unreadCount}}},{key:"_onApplicationListUpdated",value:function(){this._snsM.emitOEvt(T.FRIEND_APPLICATION_LIST_UPDATED,{friendApplicationList:v(this._map.values()),unreadCount:this._unreadCount})}},{key:"onApplicationRead",value:function(){this._unreadCount=0,this._onApplicationListUpdated()}},{key:"onApplicationAdded",value:function(e,n){var o,a,i=this;He(e)||(o="",o=n===this._snsM.getMyUserID()?S.SNS_APPLICATION_SENT_BY_ME:S.SNS_APPLICATION_SENT_TO_ME,a=!1,e.forEach((function(e){var n="".concat(e.userID,"_").concat(o);o!==S.SNS_APPLICATION_SENT_TO_ME||i._map.has(n)||(i._unreadCount+=1),i._map.set(n,new ns(t(t({},e),{},{type:o}))),a=!0})),a&&this._onApplicationListUpdated())}},{key:"onApplicationDeleted",value:function(e){He(e)||(this._startTime=0,this._currentSeq=0,this.getApplicationList())}},{key:"getApplicationList",value:function(){var e=this,t="".concat(this._n,".").concat("getApplicationList"),n=new io("getApplicationList");return this._snsM.req({P:jn.GET_FD_APPLICATION_LIST,data:{applicationType:S.SNS_APPLICATION_TYPE_BOTH,fromAccount:this._snsM.getMyUserID(),maxLimited:this._maxLimited,startTime:this._startTime,lastSequence:this._currentSeq}}).then((function(o){var a=(o=o.data).resultList,i=o.unreadCount,r=o.startTime,s=(o=o.currentSequence,e._startTime=r,e._currentSeq=o,e._unreadCount=i,Ze(a)?a.length:0);s="applicationCount:".concat(s," unreadCount:").concat(i," startTime:").concat(r," currentSequence:").concat(o),n.setMessage(s).end(),Re.i("".concat(t," ok. ").concat(s)),e._map.clear(),Ze(a)&&a.forEach((function(t){var n=t.userID,o=t.type;t=new ns(t),e._map.set("".concat(n,"_").concat(o),t)})),e._onApplicationListUpdated()})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"deleteApplication",value:function(e){var t="".concat(this._n,".").concat("deleteApplication"),n=e.userID,o=e.type;if(o&&(o===S.SNS_APPLICATION_SENT_BY_ME||o===S.SNS_APPLICATION_SENT_TO_ME)||(o=S.SNS_APPLICATION_SENT_TO_ME),!this._map.has("".concat(n,"_").concat(o)))return Mn({code:zn.FRIEND_APPLICATION_NOT_EXIST});var a=new io("deleteApplication");return a.setMessage("userID:".concat(n," type:").concat(o)),this._snsM.req({P:jn.DEL_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),userIDList:[n],type:o}}).then((function(e){var i=(s=(e=e.data.resultList)[0]).to,r=s.resultCode,s=s.resultInfo;return a.setMoreMessage("resultList:".concat(JSON.stringify(e))).end(),Re.i("".concat(t," ok. userID:").concat(n," type:").concat(o)),0===r?Tn():Mn({userID:i,code:r,message:s})})).catch((function(e){return a.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"acceptApplication",value:function(e){var t="".concat(this._n,".").concat("acceptApplication"),n=e.userID,o=e.remark,a=e.tag,i=e.type,r=(i&&(i===S.SNS_APPLICATION_AGREE||i===S.SNS_APPLICATION_AGREE_AND_ADD)||(i=S.SNS_APPLICATION_AGREE_AND_ADD),new io("acceptApplication"));return r.setMessage("userID:".concat(n," type:").concat(i)),this._snsM.req({P:jn.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:n,remark:o,tag:a,action:i}]}}).then((function(e){r.end();var o=(e=e.data.resultList[0]).resultCode;if(e=e.resultInfo,0!==o)return Mn({code:o,message:e});Re.i("".concat(t," ok. userID:").concat(n," type:").concat(i))})).catch((function(e){return r.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"refuseApplication",value:function(e){var t="".concat(this._n,".").concat("refuseApplication"),n=e.userID,o=new io("refuseApplication");return o.setMessage("userID:".concat(n)),this._snsM.req({P:jn.RESPOND_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),responseFriendItem:[{userID:n,action:"Response_Action_Reject"}]}}).then((function(e){o.end();var a=(e=e.data.resultList[0]).resultCode;if(e=e.resultInfo,0!==a)return Mn({code:a,message:e});Re.i("".concat(t," ok. userID:").concat(n))})).catch((function(e){return o.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"setApplicationRead",value:function(){var e=this,t="".concat(this._n,".").concat("setApplicationRead"),n=new io("setApplicationRead");return this._snsM.req({P:jn.REPORT_FD_APPLICATION,data:{fromAccount:this._snsM.getMyUserID(),latestTimeStamp:xt(we()/1e3,0)}}).then((function(o){n.end(),Re.i("".concat(t," ok")),e._unreadCount=0})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"reset",value:function(){this._maxLimited=100,this._currentSeq=0,this._unreadCount=0,this._map.clear()}}]),Ys),as=(i(Ks,[{key:"validate",value:function(e){var t,n=!0,o="";if(He(e))return{valid:!1,tips:"empty options"};if(e.profileCustomField)for(var a=e.profileCustomField.length,i=null,r=0;r<a;r++){if(i=e.profileCustomField[r],!dt(i.key)||-1===i.key.indexOf("Tag_Profile_Custom"))return{valid:!1,tips:"The prefix of keys of the custom profile key-value pairs (which is profileCustomField) must be Tag_Profile_Custom"};if(!dt(i.value))return{valid:!1,tips:"The type of values of the custom profile key-value pairs (which is profileCustomField) must be String"}}for(t in e)if(Object.prototype.hasOwnProperty.call(e,t)){if("profileCustomField"===t)continue;if(He(e[t])&&!dt(e[t])&&!Ye(e[t])){o="key:"+t+", invalid value:"+e[t],n=!1;continue}switch(t){case"nick":dt(e[t])||(n=!(o="nick must be a string")),500<at(e[t])&&(o="nick name limited: must less than or equal to ".concat(500," bytes, current size: ").concat(at(e[t])," bytes"),n=!1);break;case"gender":st(Pe,e.gender)||(o="key:gender, invalid value:"+e.gender,n=!1);break;case"birthday":Ye(e.birthday)||(n=!(o="birthday must be a number"));break;case"location":dt(e.location)||(n=!(o="location must be a string"));break;case"selfSignature":dt(e.selfSignature)||(n=!(o="selfSignature must be a string"));break;case"allowType":st(xe,e.allowType)||(o="key:allowType, invalid value:"+e.allowType,n=!1);break;case"language":Ye(e.language)||(n=!(o="language must be a number"));break;case"avatar":dt(e.avatar)||(n=!(o="avatar must be a string"));break;case"messageSettings":0!==e.messageSettings&&1!==e.messageSettings&&(n=!(o="messageSettings must be 0 or 1"));break;case"adminForbidType":st(Ue,e.adminForbidType)||(o="key:adminForbidType, invalid value:"+e.adminForbidType,n=!1);break;case"level":Ye(e.level)||(n=!(o="level must be a number"));break;case"role":Ye(e.role)||(n=!(o="role must be a number"));break;default:o="unknown key:"+t+"  "+e[t],n=!1}}return{valid:n,tips:o}}},{key:"update",value:function(e){var t,n="",o=[];this.friendCustomField.forEach((function(e){o.push(e.key)}));for(var a=0,i=e.length;a<i;a++)if(n=e[a].tag,t=e[a].value,-1<n.indexOf("Tag_SNS_Custom"))-1<o.indexOf(n)?this.friendCustomField.forEach((function(e){e.key===n&&(e.value=t)})):this.friendCustomField.push({key:n,value:t});else if(-1<n.indexOf("Tag_Profile_Custom")){var r=!1;this.profile.profileCustomField.forEach((function(e){e.key===n&&(e.value=t,r=!0)})),r||this.profile.profileCustomField.push({key:n,value:t})}else switch(n){case Ae.NICK:this.profile.nick=t;break;case Ae.GENDER:this.profile.gender=t;break;case Ae.BIRTHDAY:this.profile.birthday=t;break;case Ae.LOCATION:this.profile.location=t;break;case Ae.SELFSIGNATURE:this.profile.selfSignature=t;break;case Ae.ALLOWTYPE:this.profile.allowType=t;break;case Ae.LANGUAGE:this.profile.language=t;break;case Ae.AVATAR:this.profile.avatar=t;break;case Ae.MESSAGESETTINGS:this.profile.messageSettings=t;break;case Ae.ADMINFORBIDTYPE:this.profile.adminForbidType=t;break;case Ae.LEVEL:this.profile.level=t;break;case Ae.ROLE:this.profile.role=t;break;case Oe.REMARK:this.remark=t;break;case Oe.ADDTIME:this.addTime=t;break;case Oe.GROUP:this.groupList=JSON.parse(JSON.stringify(t));break;case Oe.ADDSOURCE:this.source=t;break;case Oe.ADDWORDING:break;default:Re.d("snsProfileItem unkown tag->",e[a].tag)}this.timestamp=Date.now(),o.length=0}},{key:"updateProfile",value:function(e){this.profile=JSON.parse(JSON.stringify(e)),this.timestamp=Date.now()}},{key:"addToGroupList",value:function(e){-1===this.groupList.indexOf(e)&&(this.groupList.push(e),this.count=this.groupList.length)}},{key:"removeFromGroupList",value:function(e){-1<(e=this.groupList.indexOf(e))&&(this.groupList.splice(e,1),this.count=this.groupList.length)}}]),Ks),is=(i(qs,[{key:"getLocalFriendList",value:function(){return v(this._map.values())}},{key:"getFriendRemark",value:function(e){return this._map.has(e)?this._map.get(e).remark:""}},{key:"onFriendProfileModified",value:function(e){var t,n=this;He(e=e.dataList)||(t=this._snsM.get(11),e.forEach((function(e){var o,a=e.userID;e=e.profileList,n.isMyFriend(a)&&(Re.l("".concat(n._n,".onFriendProfileModified. friend account:").concat(a,", profileList:").concat(JSON.stringify(e))),(o=n._map.get(a)).update(e),t.modifyMessageSentByPeer({conversationID:"".concat(S.CONV_C2C).concat(a),latestNick:o.profile.nick,latestAvatar:o.profile.avatar}))})),this._onFriendListUpdated())}},{key:"onFriendAdded",value:function(e){var t=this;0!==e.length&&(Re.l("".concat(this._n,".onFriendAdded userIDList:").concat(e)),e.forEach((function(e){t._map.set(e,new as(e))})),this.getFriendProfile({userIDList:e}).then((function(n){e.forEach((function(e){var n=t._map.get(e);0<n.groupList.length&&t._snsM.updateWhenFriendAdded({nameList:n.groupList,userID:e})})),t._onFriendListUpdated()})))}},{key:"onFriendDeleted",value:function(e){var t=this;0!==e.length&&(Re.l("".concat(this._n,".onFriendDeleted userIDList:").concat(e)),e.forEach((function(e){var n=t._map.get(e);0<n.groupList.length&&t._snsM.updateWhenFriendDeleted({nameList:n.groupList,userID:e}),t._map.delete(e)})),this._onFriendListUpdated())}},{key:"_onFriendListUpdated",value:function(){this._snsM.emitOEvt(T.FRIEND_LIST_UPDATED),this._snsM.get(11).checkAndPatchRemark()}},{key:"getFriendProfile",value:function(e){var t=this,n="".concat(this._n,".").concat("getFriendProfile"),o=(e=e.userIDList,[]),a=[],i=[];if(e.forEach((function(e){var n;t._map.has(e)?(n=t._map.get(e),Date.now()-n.timestamp<t._expirationTime?a.push(n):i.push(e)):o.push({userID:e,code:zn.NOT_MY_FRIEND,message:t._snsM.getErrMsg(zn.NOT_MY_FRIEND)})})),0===i.length)return Re.i("".concat(n," newUserIDList is empty")),Sn({friendList:a,failureUserIDList:o});var r=new io("getFriendProfile");return r.setMessage("userIDList:".concat(i)),Re.i("".concat(n," userIDList:").concat(i)),this._snsM.req({P:jn.GET_FD_PROFILE,data:{fromAccount:this._snsM.getMyUserID(),userIDList:i}}).then((function(e){return r.end(),Re.i("".concat(n," ok")),e.data.resultList.forEach((function(e){var n,i=e.to,r=e.resultCode,s=e.resultInfo;e=e.tagValueList,pt(r)||0===r?(t._map.has(i)?(n=t._map.get(i)).update(e):(n=new as(i,e),t._map.set(i,n)),a.push(n)):o.push({userID:i,code:r,message:s})})),Tn({friendList:a,failureUserIDList:o})})).catch((function(e){return r.setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"isMyFriend",value:function(e){return this._map.has(e)}},{key:"pagingGetFriendList",value:function(){var e=this,t="".concat(this._n,".").concat("getFriendList"),n=new io("getFriendList"),o=Date.now();this._snsM.req({P:jn.GET_FD_LIST,data:{fromAccount:this._snsM.getMyUserID(),startIndex:this._startIdx,standardSequence:this._standardSeq,customSequence:this._customSeq}}).then((function(a){var i=(a=a.data).friendCount,r=a.resultList,s=a.nextStartIndex,l=a.standardSequence,c=a.customSequence;a=a.completeFlag,e._startIdx=s,e._standardSeq=l,e._customSeq=c,i="friendCount:".concat(i," nextStartIndex:").concat(s," standardSequence:").concat(l," ")+"customSequence:".concat(c," completeFlag:").concat(a," cost:").concat($t(o)),n.setMessage(i).end(),Re.i("".concat(t," ok."),i),He(r)||r.forEach((function(t){var n=t.to;t=t.tagValueList,e._map.set(n,new as(n,t))})),0===a?e.pagingGetFriendList():(e._snsM.emitOEvt(T.FRIEND_LIST_UPDATED),e._pagingGetFriendProfile())})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"_pagingGetFriendProfile",value:function(){var e=this,t=v(this._map.keys()),n=this._snsM.get(4),o=t.length,a=o<=100?1:Math.ceil(o/100);Re.l("".concat(this._n,"._pagingGetFriendProfile friendCount:").concat(o," pageCount:").concat(a));for(var i=0;i<a;i++)n.getUserProfile({userIDList:t.slice(100*i,100*(i+1))}).then((function(t){t.data.forEach((function(t){var n=e._map.get(t.userID);n&&n.updateProfile(t)})),e._onFriendListUpdated()}))}},{key:"addFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("addFriend");if(this._map.has(e.to))return Mn({code:zn.ALREADY_MY_FRIEND});if(e.wording&&!1===this._snsM.filterProfanity("wording",e))return Mn({code:zn.PROFANITY_FOUND});var o=e.to,a=e.source,i=e.type,r=e.wording,s=e.remark,l=(e=e.groupName,i),c=(l&&(l===S.SNS_ADD_TYPE_SINGLE||l===S.SNS_ADD_TYPE_BOTH)||(l=S.SNS_ADD_TYPE_BOTH),new io("addFriend"));return c.setMessage("to:".concat(o," source:").concat(a," type:").concat(l)),this._snsM.req({P:jn.ADD_FD,data:{fromAccount:this._snsM.getMyUserID(),addFriendItem:[{to:o,source:a,wording:r,remark:s,groupName:e}],type:l}}).then((function(e){e=e.data.resultList;var o=(c.setMoreMessage("resultList:".concat(JSON.stringify(e))).end(),e=e[0]).to,a=e.resultCode;return e=e.resultInfo,Re.i("".concat(n," ok. to:").concat(o," type:").concat(l," code:").concat(a)),pt(a)||0===a?Tn({userID:o,code:0}):30539===a?Tn({userID:o,code:a,message:t._snsM.getErrMsg(a)}):Mn({userID:o,code:a,message:t._snsM.getErrMsg(a)||e})})).catch((function(e){return c.setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"deleteFriend",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteFriend"),o=e.userIDList,a=(e=e.type,1e3<o.length&&(Re.w("".concat(n," ").concat(qt(1e3))),o.length=1e3),[]),i=[],r=[];if(o.forEach((function(e){t._map.has(e)?r.push(e):a.push({userID:e,code:zn.NOT_MY_FRIEND,message:t._snsM.getErrMsg(zn.NOT_MY_FRIEND)})})),0===r.length)return Sn({successUserIDList:i,failureUserIDList:a});var s=((o=e)&&(o===S.SNS_DELETE_TYPE_SINGLE||o===S.SNS_DELETE_TYPE_BOTH)||(o=S.SNS_DELETE_TYPE_BOTH),new io("deleteFriend"));return s.setMessage("userIDList:".concat(r," type:").concat(o)),this._snsM.req({P:jn.DEL_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:r,type:o}}).then((function(e){return s.end(),Re.i("".concat(n," ok")),He(e=e.data.resultList)||e.forEach((function(e){var t=e.to,n=e.resultCode;e=e.resultInfo,pt(n)||0===n?i.push({userID:t}):a.push({userID:t,code:n,message:e})})),Tn({successUserIDList:i,failureUserIDList:a})})).catch((function(e){return s.setError(e).end(),Re.w("".concat(n," error:"),e),Mn(e)}))}},{key:"updateFriend",value:function(e){var t=this,n=e.userID,o=e.remark,a=e.friendCustomField;if(!this._map.has(n))return Mn({code:zn.NOT_MY_FRIEND});var i="".concat(this._n,".").concat("updateFriend"),r=new io("updateFriend"),s=(r.setMessage("userID:".concat(n," remark:").concat(o," friendCustomField:").concat(a)),[]);return pt(o)||s.push({tag:Oe.REMARK,value:o}),Ze(a)&&0<a.length&&a.forEach((function(e){s.push({tag:e.key,value:e.value})})),this._snsM.req({P:jn.UPDATE_FD,data:{fromAccount:this._snsM.getMyUserID(),updateItem:[{to:n,snsItem:s}]}}).then((function(e){r.end(),Re.i("".concat(i," ok"));var n=(e=e.data.resultList[0]).to,s=e.resultCode;return e=e.resultInfo,pt(s)||0===s?((n=t._map.get(n))&&(pt(o)||(n.remark=o),Ze(a)&&0<a.length&&yt(n.friendCustomField,a),t._onFriendListUpdated()),Tn(n)):Mn({code:s,message:e})})).catch((function(e){return r.setError(e).end(),Re.w("".concat(i," failed. error:"),e),Mn(e)}))}},{key:"checkFriend",value:function(e){var t="".concat(this._n,".").concat("checkFriend"),n=e.userIDList,o=e.type,a=(o&&(o===S.SNS_CHECK_TYPE_SINGLE||o===S.SNS_CHECK_TYPE_BOTH)||(o=S.SNS_CHECK_TYPE_BOTH),new io("checkFriend"));return a.setMessage("userIDList:".concat(n," type:").concat(o)),this._snsM.req({P:jn.CHECK_FD,data:{fromAccount:this._snsM.getMyUserID(),userIDList:n,type:o}}).then((function(e){a.end(),Re.i("".concat(t," ok. userIDList:").concat(n," type:").concat(o));var i=[],r=[];return Ze(e=e.data.resultList)&&e.forEach((function(e){var t=e.to,n=e.relation,o=e.resultCode;e=e.resultInfo,pt(o)||0===o?i.push({userID:t,code:0,relation:n}):r.push({userID:t,code:o,message:e})})),Tn({successUserIDList:i,failureUserIDList:r})})).catch((function(e){return a.setError(e).end(),Re.w("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"onAddedToFriendGroup",value:function(e){var t=this,n=e.name;e=e.userIDList,Re.l("".concat(this._n,".onAddedToFriendGroup groupName:").concat(n," userIDList:").concat(e)),n&&!He(e)&&e.forEach((function(e){t._map.has(e)&&t._map.get(e).addToGroupList(n)}))}},{key:"onRemovedFromFriendGroup",value:function(e){var t=this,n=e.name;e=e.userIDList,Re.l("".concat(this._n,".onRemovedFromFriendGroup groupName:").concat(n," userIDList:").concat(e)),n&&!He(e)&&e.forEach((function(e){t._map.has(e)&&t._map.get(e).removeFromGroupList(n)}))}},{key:"reset",value:function(){this._map.clear(),this._startIdx=0,this._standardSeq=0,this._customSeq=0}}]),qs),rs=(i(js,[{key:"addToUserIDList",value:function(e){-1===this.userIDList.indexOf(e)&&(this.userIDList.push(e),this.count=this.userIDList.length)}},{key:"removeFromUserIDList",value:function(e){-1<(e=this.userIDList.indexOf(e))&&(this.userIDList.splice(e,1),this.count=this.userIDList.length)}}]),js),ss=(i(Hs,[{key:"getLocalGroupList",value:function(){return v(this._map.values())}},{key:"_onGroupListUpdated",value:function(){var e=v(this._map.values());this._snsM.emitOEvt(T.FRIEND_GROUP_LIST_UPDATED,e)}},{key:"getGroupList",value:function(){var e=this,t="".concat(this._n,".").concat("getGroupList"),n=new io("getGroupList");return this._snsM.req({P:jn.GET_FD_GRP_LIST,data:{fromAccount:this._snsM.getMyUserID()}}).then((function(o){n.end(),He(o=o.data.resultList)?Re.i("".concat(t," ok. count:0")):(Re.i("".concat(t," ok. count:").concat(o.length)),e._map.clear(),o.forEach((function(t){var n=new rs(t);e._map.set(t.name,n)})),e._onGroupListUpdated())})).catch((function(e){return n.setError(e).end(),Re.w("".concat(t," error:"),e),Mn(e)}))}},{key:"createGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("createGroup"),o=e.name;if(e=e.userIDList,this._map.has(o))return Mn({code:zn.FRIEND_GRP_EXISTED});var a="name:".concat(o," userIDList:").concat(e),i=new io("createGroup");return i.setMessage(a),this._snsM.req({P:jn.CREATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),groupName:[o],userIDList:Ze(e)?e:void 0}}).then((function(e){i.end(),Re.l("".concat(n," ok. ").concat(a)),e=e.data.resultList;var r=[],s=[];return e&&e.forEach((function(e){var t=e.to,n=e.resultCode,o=e.resultInfo;pt(n)||0===n?r.push(t):(t={userID:e.to,code:n,message:o},s.push(t))})),e=new rs({name:o,userIDList:r}),t._map.set(o,e),t._snsM.onAddedToFriendGroup({name:o,userIDList:r}),t._onGroupListUpdated(),Tn({friendGroup:e,failureUserIDList:s})})).catch((function(e){return i.setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"deleteGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("deleteGroup"),o=e.name;if(!this._map.has(o))return this._onGroupNotExist();var a="name:".concat(o),i=new io("deleteGroup");return i.setMessage(a),this._snsM.req({P:jn.DEL_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),nameList:[o]}}).then((function(e){i.end(),Re.l("".concat(n," ok. ").concat(a));var r=t._map.get(o);return r&&(t._snsM.onRemovedFromFriendGroup({name:o,userIDList:r.userIDList}),t._map.delete(o),r.userIDList.length=0),t._onGroupListUpdated(),Tn(r)})).catch((function(e){return i.setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"renameGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("renameGroup"),o=e.oldName,a=e.newName;if(!this._map.has(o))return this._onGroupNotExist();var i="oldName:".concat(o," newName:").concat(a),r=new io("renameGroup");return r.setMessage(i),this._snsM.req({P:jn.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:o,newName:a}}).then((function(){var e;return r.end(),Re.l("".concat(n," ok. ").concat(i)),t._map.has(o)?((e=t._map.get(o)).name=a,t._map.delete(o),t._map.set(a,e),t._snsM.onRemovedFromFriendGroup({name:o,userIDList:e.userIDList}),t._snsM.onAddedToFriendGroup({name:a,userIDList:e.userIDList}),t._onGroupListUpdated(),Tn(e)):Tn()})).catch((function(e){return r.setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"addToGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("addToGroup"),o=e.name;if(e=e.userIDList,!this._map.has(o))return this._onGroupNotExist();var a="name:".concat(o," userIDList:").concat(e),i=new io("addToGroup");return i.setMessage(a),this._snsM.req({P:jn.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:o,updateGroupItem:e.filter((function(e){return t._snsM.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Add"}}))}}).then((function(e){return i.end(),Re.l("".concat(n," ok. ").concat(a)),t._onGroupUpdated(o,e)})).catch((function(e){return i.setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"removeFromGroup",value:function(e){var t=this,n="".concat(this._n,".").concat("removeFromGroup"),o=e.name;if(e=e.userIDList,!this._map.has(o))return this._onGroupNotExist();var a="name:".concat(o," userIDList:").concat(e),i=new io("removeFromGroup");return i.setMessage(a),this._snsM.req({P:jn.UPDATE_FD_GRP,data:{fromAccount:this._snsM.getMyUserID(),oldName:o,updateGroupItem:e.filter((function(e){return t._snsM.isMyFriend(e)})).map((function(e){return{to:e,updateType:"Update_Type_Delete"}}))}}).then((function(e){return i.end(),Re.l("".concat(n," ok. ").concat(a)),t._onGroupUpdated(o,e)})).catch((function(e){return i.setError(e).end(),Re.w("".concat(n," failed. error:"),e),Mn(e)}))}},{key:"_onGroupUpdated",value:function(e,t){t=t.data.resultList;var n=this._map.get(e),o=[],a=[],i=[];return Ze(t)&&t.forEach((function(e){var t=e.to,r=e.resultCode,s=e.resultInfo,l=e.type;0===r?"Update_Type_Add"===l?n&&(n.addToUserIDList(t),a.push(t)):"Update_Type_Delete"===l&&n&&(n.removeFromUserIDList(t),i.push(t)):o.push({to:e.to,code:r,message:s})})),Re.l("".concat(this._n,"._onGroupUpdated name:").concat(e," userIDList:").concat(n.userIDList)),0<a.length&&this._snsM.onAddedToFriendGroup({name:e,userIDList:a}),0<i.length&&this._snsM.onRemovedFromFriendGroup({name:e,userIDList:i}),Tn({friendGroup:n,failureUserIDList:o})}},{key:"updateWhenFriendAdded",value:function(e){var t=this,n=e.nameList,o=e.userID;Re.l("".concat(this._n,".updateWhenFriendAdded userID:").concat(o," nameList:").concat(n)),He(n)||n.forEach((function(e){t._map.has(e)&&t._map.get(e).addToUserIDList(o)}))}},{key:"updateWhenFriendDeleted",value:function(e){var t=this,n=e.nameList,o=e.userID;Re.l("".concat(this._n,".updateWhenFriendDeleted userID:").concat(o," nameList:").concat(n)),He(n)||n.forEach((function(e){t._map.has(e)&&t._map.get(e).removeFromUserIDList(o)}))}},{key:"_onGroupNotExist",value:function(e){return Mn({code:zn.FRIEND_GRP_NOT_EXIST})}},{key:"reset",value:function(){this._map.clear()}}]),Hs),ls=(s(zs,Un),Hr=g(zs),i(zs,[{key:"onContextUpdated",value:function(e){this._friendHandler.pagingGetFriendList(),this._friendGroupHandler.getGroupList(),this._friendApplicationHandler.getApplicationList()}},{key:"onRelationChainModified",value:function(e){var t,n,o,a,i,r,s=this;He(e=e.dataList)||(t=[],n=[],o=[],i=!(a=[]),r="",e.forEach((function(e){var l;3!==e.pushType&&4!==e.pushType||!e.from||(r=e.from),e.friendAddAccount&&(t.push.apply(t,v(e.friendAddAccount)),a.push.apply(a,v(e.friendAddAccount))),e.friendDelAccount&&n.push.apply(n,v(e.friendDelAccount)),e.friendApplicationAdded&&o.push.apply(o,v(e.friendApplicationAdded)),e.friendApplicationDeletedUserIDList&&a.push.apply(a,v(e.friendApplicationDeletedUserIDList)),e.reportTime&&7===e.pushType&&(i=!0),e.friendUpInfo&&(l={dataList:[]},e.friendUpInfo.forEach((function(e){l.dataList.push({userID:e.friendAccount,profileList:v(e.sns)})})),s.onFriendProfileModified(l))})),i&&this._friendApplicationHandler.onApplicationRead(),this._friendApplicationHandler.onApplicationAdded(o,r),this._friendApplicationHandler.onApplicationDeleted(a),this._friendHandler.onFriendAdded(t),this._friendHandler.onFriendDeleted(n))}},{key:"isMyFriend",value:function(e){return this._friendHandler.isMyFriend(e)}},{key:"filterProfanity",value:function(e,t){if(!(o=this.get(29)))return!0;var n=(o=o.filterText(t[e],"sns")).isAllowedToSend,o=o.modifiedText;return!0===n&&(t[e]=o,!0)}},{key:"onFriendProfileModified",value:function(e){this._friendHandler.onFriendProfileModified(e)}},{key:"getLocalFriendList",value:function(){var e=!(0<arguments.length&&void 0!==arguments[0])||arguments[0],t=this._friendHandler.getLocalFriendList();return e?Sn(t):t}},{key:"getFriendRemark",value:function(e){return this._friendHandler.getFriendRemark(e)}},{key:"getFriendList",value:function(){return this._friendHandler.pagingGetFriendList()}},{key:"addFriend",value:function(e){return this._friendHandler.addFriend(e)}},{key:"deleteFriend",value:function(e){return this._friendHandler.deleteFriend(e)}},{key:"checkFriend",value:function(e){return this._friendHandler.checkFriend(e)}},{key:"getFriendProfile",value:function(e){return this._friendHandler.getFriendProfile(e)}},{key:"updateFriend",value:function(e){return this._friendHandler.updateFriend(e)}},{key:"onAddedToFriendGroup",value:function(e){this._friendHandler.onAddedToFriendGroup(e)}},{key:"onRemovedFromFriendGroup",value:function(e){this._friendHandler.onRemovedFromFriendGroup(e)}},{key:"getLocalFriendApplicationList",value:function(){return Sn(this._friendApplicationHandler.getLocalApplicationList())}},{key:"deleteFriendApplication",value:function(e){return this._friendApplicationHandler.deleteApplication(e)}},{key:"refuseFriendApplication",value:function(e){return this._friendApplicationHandler.refuseApplication(e)}},{key:"acceptFriendApplication",value:function(e){return this._friendApplicationHandler.acceptApplication(e)}},{key:"setFriendApplicationRead",value:function(e){return this._friendApplicationHandler.setApplicationRead(e)}},{key:"getLocalFriendGroupList",value:function(){return Sn(this._friendGroupHandler.getLocalGroupList())}},{key:"createFriendGroup",value:function(e){return this._friendGroupHandler.createGroup(e)}},{key:"deleteFriendGroup",value:function(e){return this._friendGroupHandler.deleteGroup(e)}},{key:"addToFriendGroup",value:function(e){return this._friendGroupHandler.addToGroup(e)}},{key:"removeFromFriendGroup",value:function(e){return this._friendGroupHandler.removeFromGroup(e)}},{key:"renameFriendGroup",value:function(e){return this._friendGroupHandler.renameGroup(e)}},{key:"updateWhenFriendAdded",value:function(e){this._friendGroupHandler.updateWhenFriendAdded(e)}},{key:"updateWhenFriendDeleted",value:function(e){this._friendGroupHandler.updateWhenFriendDeleted(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._friendHandler.reset(),this._friendGroupHandler.reset(),this._friendApplicationHandler.reset()}}]),zs),cs=(s(Fs,Un),zr=g(Fs),i(Fs,[{key:"isWorkerEnabled",value:function(){return this._isWorkerEnabled&&fe}},{key:"startWorkerTimer",value:function(){Re.l("".concat(this._n,".startWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("start")}},{key:"stopWorkerTimer",value:function(){Re.l("".concat(this._n,".stopWorkerTimer")),this._workerTimer&&this._workerTimer.postMessage("stop")}},{key:"_init",value:function(){var e,t;fe&&(e=URL.createObjectURL(new Blob(['let interval = -1;onmessage = function(event) {  if (event.data === "start") {    if (interval > 0) {      clearInterval(interval);    }    interval = setInterval(() => {      postMessage("");    }, 1000);    postMessage(interval);  } else if (event.data === "stop") {    clearInterval(interval);    interval = -1;  }};'],{type:"application/javascript; charset=utf-8"})),this._workerTimer=new Worker(e),(t=this)._workerTimer.onmessage=function(e){e.data?(t._timerID=e.data,Re.l("".concat(t._n,"._init seed:").concat(t._timerID))):t._m.onCheckTimer()})}},{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("enable_worker");Re.l("".concat(this._n,"._onCloudConfig enableWorker:").concat(e)),pt(e)||"1"===e?!this._isWorkerEnabled&&fe&&(this._isWorkerEnabled=!0,this.startWorkerTimer(),this._m.onWorkerTimerEnabled()):this._isWorkerEnabled&&fe&&(this._isWorkerEnabled=!1,this.stopWorkerTimer(),this._m.onWorkerTimerDisabled())}},{key:"terminate",value:function(){Re.l("".concat(this._n,".terminate")),this._workerTimer&&(this._workerTimer.terminate(),this._workerTimer=null,this._timerID=-1)}},{key:"getTimerID",value:function(){return this._timerID}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),Fs),us=(i(Gs,[{key:"isValidPurchaseBits",value:function(e){return e&&"string"==typeof e&&1<=e.length&&e.length<=64&&/[01]{1,64}/.test(e)}},{key:"parsePurchaseBits",value:function(e){if(this.isValidPurchaseBits(e)){this._featureMap.clear();for(var t,n=e.length-1,o=0;0<=n;n--,o++)t=(o<32?new b(0,Math.pow(2,o)):new b(Math.pow(2,o-32),0)).toString(),"1"===e[n]?this._featureMap.set(t,!0):this._featureMap.set(t,!1)}else Re.w("".concat(this._n,".parsePurchaseBits invalid purchasebits:").concat(e))}},{key:"hasPurchasedFeature",value:function(e){return!!this._featureMap.get(e)}},{key:"isFeatureEnabled",value:function(e){for(var t=parseInt(e).toString(2),n=void 0,o=!0,a=t.length-1,i=0;0<=a;a--,i++)if("1"===t.charAt(a)&&(n=(i<32?new b(0,Math.pow(2,i)):new b(Math.pow(2,i-32),0)).toString(),!this._featureMap.get(n))){o=!1;break}return Re.l("".concat(this._n,".isFeatureEnabled decimalNumber:").concat(e," key:").concat(n," ret:").concat(o)),Sn({enabled:o})}},{key:"isFeatureEnabledForStat",value:function(e){for(var t=parseInt(e).toString(2),n=t.length-1,o=0;0<=n;n--,o++)if("1"===t.charAt(n)){if(a=(o<32?new b(0,Math.pow(2,o)):new b(Math.pow(2,o-32),0)).toString(),!this._featureMap.get(a))break;var a,i="",r=0;a===P.PLUGIN_TRANSLATE?(i="plugin_translate",r=16):a===P.PLUGIN_VOICE_TO_TEXT?(i="plugin_voice_to_text",r=17):a===P.PLUGIN_CS?(i="plugin_cs",r=14):a===P.PLUGIN_PUSH?(i="plugin_push",r=13):a===P.PLUGIN_BOT?(i="plugin_bot",r=15):a===P.MSG_REACTION&&(i="plugin_emoji_reaction",r=18),""!==i&&(a=this._commercialConfigM.get(12).getUIPlatform(),new io(i).setCode(r).setUIPlatform(a).end(),Re.l("".concat(this._n,".isFeatureEnabledForStat ").concat(i," code:").concat(r," uiPlatform:").concat(a)))}}},{key:"isCSPluginEnabled",value:function(){var e;this._isCSPluginReported||(e=this._commercialConfigM.get(12).getUIPlatform(),new io("plugin_search").setCode(6).setUIPlatform(e).end(),this._isCSPluginReported=!0)}},{key:"clear",value:function(){this._featureMap.clear(),this._isCSPluginReported=!1}}]),Gs),ds=(i(Bs,[{key:"_canFetch",value:function(){return this.get(12).isLoggedIn()?!this._isFetching&&Date.now()>=this._expiredTime:(this._expiredTime=Date.now()+2e3,!1)}},{key:"onCheckTimer",value:function(e){this._canFetch()&&this.fetchConfig()}},{key:"fetchConfig",value:function(){var e,t,n=this,o=this._canFetch(),a="".concat(this._n,".fetchConfig");Re.l("".concat(a," canFetch:").concat(o)),o&&(e=new io("fetchCommercialConfig"),o=this.get(12).getSDKAppID(),t=this.get(20),this._isFetching=!0,t.req({P:jn.FETCH_COMMERCIAL_CONFIG,data:{SDKAppID:o}}).then((function(t){e.setMessage("purchaseBits:".concat(t.data.purchaseBits)).end(),Re.l("".concat(a," ok.")),n._parseConfig(t.data),n._isFetching=!1})).catch((function(t){e.setError(t).end(),n._isFetching=!1})))}},{key:"onPushedConfig",value:function(e){var t="".concat(this._n,".onPushedConfig data:").concat(JSON.stringify(e));Re.l("".concat(t)),new io("pushedCommercialConfig").setMessage("purchaseBits:".concat(e.purchaseBits)).end(),this._parseConfig(e)}},{key:"_parseConfig",value:function(e){var t="".concat(this._n,"._parseConfig"),n=e.errorCode,o=e.errorMessage,a=e.purchaseBits,i=e.expiredTime;0===n?(this._purchasedFeatureHandler.parsePurchaseBits(a),this._expiredTime=Date.now()+1e3*i):pt(n)?(Re.l("".concat(t," failed. Invalid message format:"),e),this._setExpiredTimeOnResponseError(36e5)):(Re.e("".concat(t," errorCode:").concat(n," errorMessage:").concat(o)),this._setExpiredTimeOnResponseError(12e4))}},{key:"_setExpiredTimeOnResponseError",value:function(e){this._expiredTime=Date.now()+e}},{key:"canIUse",value:function(e){return this._purchasedFeatureHandler.hasPurchasedFeature(e)}},{key:"isFeatureEnabled",value:function(e){return this._purchasedFeatureHandler.isFeatureEnabled(e)}},{key:"isFeatureEnabledForStat",value:function(e){this._purchasedFeatureHandler.isFeatureEnabledForStat(e)}},{key:"isCSPluginEnabled",value:function(){this._purchasedFeatureHandler.isCSPluginEnabled()}},{key:"get",value:function(e){return this._m.get(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler.clear()}}]),Bs),ps=(s(Vs,Un),Fr=g(Vs),i(Vs,[{key:"registerPlugin",value:function(e){var t,n,o,a,i,r,s,l,c,u,d,p,h;W?(this._offlinePushPlugin=e["tim-offline-push-plugin"],t=(h=e.offlinePushConfig||{}).huaweiBusinessID,n=h.xiaomiBusinessID,o=h.xiaomiAppID,a=h.xiaomiAppKey,i=h.meizuBusinessID,r=h.meizuAppID,s=h.meizuAppKey,l=h.vivoBusinessID,c=h.oppoBusinessID,u=h.oppoAppKey,d=h.oppoAppSecret,p=h.honorBusinessID,h=h.iosBusinessID,this._androidPushConfig.huaweiPushBussinessId=t,this._androidPushConfig.xiaomiPushBussinessId=n,this._androidPushConfig.xiaomiPushAppId=o,this._androidPushConfig.xiaomiPushAppKey=a,this._androidPushConfig.meizuPushBussinessId=i,this._androidPushConfig.meizuPushAppId=r,this._androidPushConfig.meizuPushAppKey=s,this._androidPushConfig.vivoPushBussinessId=l,this._androidPushConfig.oppoPushBussinessId=c,this._androidPushConfig.oppoPushAppKey=u,this._androidPushConfig.oppoPushAppSecret=d,this._androidPushConfig.honorPushBussinessId=p,new io("registerPlugin").setMessage("tim-offline-push-plugin").setMoreMessage("isExist:".concat(!pt(this._offlinePushPlugin))).end(!0),Re.l("".concat(this._n,".").concat("registerPlugin"," ok. offlinePushConfig:").concat(JSON.stringify(e.offlinePushConfig))),this._iosBusinessID=h,this._setAppShowListener()):this.warn("OfflinePushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._getDeviceToken()}},{key:"_getDeviceToken",value:function(){var e,t=this,n="".concat(this._n,".").concat("_getDeviceToken");Xe(this._offlinePushPlugin.getDeviceToken)?(e="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig),", iosBusinessID:").concat(this._iosBusinessID),Re.l("".concat(n," start. ").concat(e)),new io("_getDeviceToken").setMessage("".concat(e)).end(!0),this._offlinePushPlugin.getDeviceToken(this._androidPushConfig,(function(o){var a,i,r,s,l=new io("getDeviceTokenRes"),c=o.code,u=o.msg;0===c?(a=(s=o.data).deviceToken,i=s.deviceBrand,r=s.deviceType,s=s.bussinessId,t._deviceToken=a,t._businessID=s||t._iosBusinessID,e="deviceToken:".concat(a,", deviceBrand:").concat(i||r,", businessID:").concat(t._businessID),Re.l("".concat(n," ok. ").concat(e)),l.setMessage(e).end(!0),t._setToken()):(l.setMessage("code:".concat(c,", msg:").concat(u)).end(!0),Re.e("".concat(n," failed. error:"),o))}))):Re.e("".concat(n," getDeviceToken is not a function"))}},{key:"canIUseOfflinePush",value:function(){return W&&!pt(this._offlinePushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");pt(this._offlinePushPlugin)?Re.e("".concat(t," offlinePushPlugin is undefined")):Xe(this._offlinePushPlugin.setAppShowListener)?(new io("_setAppShowListener").end(!0),Re.l("".concat(t," start")),this._offlinePushPlugin.setAppShowListener((function(n){n=(n||{}).appShow,new io("setAppShowListenerRes").setMessage("appShow:".concat(n)).end(!0),Re.l("".concat(t," ok. appShow:").concat(n)),e._m.isReady()&&(0===n?(e._getConvUnreadCount(),e._onBackground()):1===n&&e._onForeground())}))):Re.e("".concat(t," setAppShowListener is not a function"))}},{key:"getDeviceBrand",value:function(){var e;if(!pt(this._offlinePushPlugin)&&Xe(this._offlinePushPlugin.getDeviceType))return e=(this._offlinePushPlugin.getDeviceType()||{}).deviceType,Re.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}},{key:"_setToken",value:function(){var e="".concat(this._n,"._setToken"),t=this.get(12),n=1,o="",a="",i=(He(this._deviceToken)&&(n=0),this.getUniAppPlatform()),r=this.getDeviceBrand(),s=(i===N.IOS||i===N.IPAD||i===N.MAC?a=this._deviceToken:i===N.ANDROID&&(o=this._deviceToken),new io("offlinePushSetToken"));return i="deviceToken:".concat(a||o,", businessID:").concat(this._businessID,", ")+"deviceBrand:".concat(r,", isWebUniapp:").concat(this._isWebUniapp,", pushMsg:").concat(n,", platform:").concat(i),s.setMessage("".concat(i)),Re.l("".concat(e," ").concat(i)),this.req({P:jn.SET_TOKEN,data:{tokenID:o,pushMsg:n,sdkAppID:t.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:r,deviceToken:a,isWebUniapp:this._isWebUniapp}}).then((function(t){return s.end(),Re.l("".concat(e," ok")),t})).catch((function(t){return s.setError(t).end(),Re.e("".concat(e," failed. error:"),t),Mn(t)}))}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach((function(t){t.type===S.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===S.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new io("_onBackground");this.req({P:jn.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(o){return n.setMessage("c2cUnreadCount: ".concat(e._c2cUnreadCount,", groupUnreadCount: ").concat(e._groupUnreadCount)).end(),Re.l("".concat(t," ok")),o})).catch((function(e){n.setError(e).end(),Re.e("".concat(t," failed. error:"),e)}))}},{key:"_onForeground",value:function(){var e="".concat(this._n,".").concat("_onForeground"),t=new io("_onForeground");this.req({P:jn.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then((function(n){return t.end(),Re.l("".concat(e," ok")),n})).catch((function(n){t.setError(n).end(),Re.e("".concat(e," failed. error:"),n)}))}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return"ios"===e?N.IOS:"android"===e?N.ANDROID:1002===t?N.IPAD:1001===t?N.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Re.l("".concat(this._n,".reset"))}}]),Vs),hs=(s(xs,Un),Gr=g(xs),i(xs,[{key:"registerPlugin",value:function(e){var t,n,o;W?(t="".concat(this._n,".").concat("registerPlugin"),this._pushPlugin=e["tim-push"],this._getDeviceInfo(),n=(o=e.pushConfig||{}).androidConfig,o=o.iOSConfig,$e(n)&&(this._androidPushConfig=n[this._deviceInfo.packageName]),n=(o||{}).iOSBusinessID,this._iOSBusinessID=n,o=!pt(this._pushPlugin),new io("registerPlugin").setMessage(this._pluginName).setMoreMessage("isExisted:".concat(o)).end(!0),Re.l("".concat(t," ok. pushConfig:").concat(JSON.stringify(e.pushConfig))),o?(this._setAppShowListener(),this._setPushEventReportListener()):Re.e("".concat(t," ").concat(this._pluginName," is undefined"))):this.warn("TIMPushInUniapp")}},{key:"init",value:function(){this._isWebUniapp=this.getUniAppPlatform(),this._reportEventCacheList(),this._getDeviceToken(),this.get(27).isFeatureEnabledForStat(Math.pow(2,41))}},{key:"_reportEventCacheList",value:function(){var e=this,n="".concat(this._n,".").concat("_reportEventCacheList");Xe(this._pushPlugin.getPushEventCacheList)?(new io("_reportEventCacheList").end(!0),this._pushPlugin.getPushEventCacheList((function(o){var a=o.code,i=o.data.eventList,r=new io("getPushEventCacheListRes");if(r.setCode(a),0!==a)r.setMessage("res:".concat(JSON.stringify(o))).end(!0),Re.e("".concat(n," failed. error:").concat(JSON.stringify(o)));else{a=i.length<10?"eventList:".concat(JSON.stringify(i)):"eventList.length:".concat(i.length),Re.l("".concat(n," ok. ").concat(a)),r.setMessage(a).end(!0);for(var s=t(t({},o.data),{},{eventList:[]});0<i.length;)s.eventList=i.splice(0,40),e._pushReport(s)}}))):Re.e("".concat(this._pluginName,".getPushEventCacheList is not a function"))}},{key:"_getDeviceToken",value:function(){var e,t=this,n="".concat(this._n,".").concat("_getDeviceToken");Xe(this._pushPlugin.getDeviceToken)?(e="androidPushConfig:".concat(JSON.stringify(this._androidPushConfig)," iOSBusinessID:").concat(this._iOSBusinessID),Re.l("".concat(n," start. ").concat(e)),new io("_getDeviceToken").setMessage("".concat(e)).end(!0),this._pushPlugin.getDeviceToken(this._androidPushConfig,(function(o){var a,i,r,s=o.code,l=o.msg,c=new io("getDeviceTokenRes");if(c.setCode(s),0===s)return a=(s=o.data).deviceToken,i=s.deviceBrand,r=s.deviceType,s=s.bussinessId,t._deviceToken=a,t._businessID=s||t._iOSBusinessID,e="deviceToken:".concat(a," deviceBrand:").concat(i||r," businessID:").concat(t._businessID),Re.l("".concat(n," ok. ").concat(e)),c.setMessage(e).end(!0),void t._setToken();c.setMessage(l).end(!0),Re.e("".concat(n," failed. error:").concat(JSON.stringify(o)))}))):Re.e("".concat(this._pluginName,".getDeviceToken is not a function"))}},{key:"_getDeviceInfo",value:function(){var e="".concat(this._n,".").concat("_getDeviceInfo");if(Xe(this._pushPlugin.getDeviceInfo)){var n=this._pushPlugin.getDeviceInfo(),o=n.code,a=n.data,i=new io("_getDeviceInfo");if(i.setCode(o),0===o)return this._deviceInfo=t(t({},this._deviceInfo),a),this._deviceInfo.pushVersion||(this._deviceInfo.pushVersion="1.0.1"),o="deviceInfo:".concat(JSON.stringify(this._deviceInfo)),Re.l("".concat(e," ok. ").concat(o)),void i.setMessage(o).end(!0);i.setMessage("deviceInfoRes:".concat(JSON.stringify(n))).end(!0),Re.e("".concat(e," failed. error:").concat(JSON.stringify(n)))}else Re.e("".concat(this._pluginName,".getDeviceInfo is not a function"))}},{key:"canIUseTIMPush",value:function(){return W&&!pt(this._pushPlugin)}},{key:"_setAppShowListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setAppShowListener");Xe(this._pushPlugin.setAppShowListener)?(new io("_setAppShowListener").end(!0),Re.l("".concat(t," start")),this._pushPlugin.setAppShowListener((function(n){n=(n||{}).appShow,new io("setAppShowListenerRes").setMessage("appShow:".concat(n)).end(!0),Re.l("".concat(t," ok. appShow:").concat(n)),e._m.isReady()&&(0===n?(e._getConvUnreadCount(),e._onBackground()):1===n&&e._onForeground())}))):Re.e("".concat(this._pluginName,".setAppShowListener is not a function"))}},{key:"_setPushEventReportListener",value:function(){var e=this,t="".concat(this._n,".").concat("_setPushEventReportListener");Xe(this._pushPlugin.setPushEventReportListener)?(new io("_setPushEventReportListener").end(!0),this._pushPlugin.setPushEventReportListener((function(n){var o=n.code,a=n.data,i=a.eventList,r=new io("setPushEventReportListenerRes");if(r.setCode(o),0===o)return o="eventList:".concat(JSON.stringify(i)),Re.l("".concat(t," ok. ").concat(o)),r.setMessage(o).end(!0),void(e._m.isReady()&&Ze(i)&&0<i.length&&e._pushReport(a));r.setMessage("res:".concat(JSON.stringify(n))).end(!0),Re.e("".concat(t," failed. error:").concat(JSON.stringify(n)))}))):Re.e("".concat(this._pluginName,".setPushEventReportListener is not a function"))}},{key:"getDeviceBrand",value:function(){var e;if(!pt(this._pushPlugin)&&Xe(this._pushPlugin.getDeviceType))return e=(this._pushPlugin.getDeviceType()||{}).deviceType,Re.l("".concat(this._n,".getDeviceBrand ok. deviceType:").concat(e)),e}},{key:"_setToken",value:function(){var e="".concat(this._n,".").concat("_setToken"),n=this.get(12),o=1,a="",i="",r=(He(this._deviceToken)&&(o=0),this.getUniAppPlatform()),s=this.getDeviceBrand(),l=(r===N.IOS||r===N.IPAD||r===N.MAC?i=this._deviceToken:r===N.ANDROID&&(a=this._deviceToken),r=t({tokenID:a,pushMsg:o,sdkAppID:n.getSDKAppID(),businessID:parseInt(this._businessID),deviceBrand:s,deviceToken:i,isWebUniapp:this._isWebUniapp},this._deviceInfo),new io("_setToken"));a="data:".concat(JSON.stringify(r)),l.setMessage("".concat(a)),Re.l("".concat(e," ").concat(a)),this.req({P:jn.SET_TOKEN,data:r}).then((function(){l.end(),Re.w("".concat(e," ok"))})).catch((function(t){l.setError(t).end(),Re.e("".concat(e," failed. error:"),t),Mn(t)}))}},{key:"_getConvUnreadCount",value:function(){var e=this;this._c2cUnreadCount=0,this._groupUnreadCount=0,this.get(11).getLocalConvList().forEach((function(t){t.type===S.CONV_C2C&&(e._c2cUnreadCount+=t.unreadCount),t.type===S.CONV_GROUP&&(e._groupUnreadCount+=t.unreadCount)}))}},{key:"_onBackground",value:function(){var e=this,t="".concat(this._n,".").concat("_onBackground"),n=new io("_onBackground");this.req({P:jn.STAT_BACKGROUND,data:{c2cUnreadCount:this._c2cUnreadCount,groupUnreadCount:this._groupUnreadCount,isWebUniapp:this._isWebUniapp}}).then((function(){n.setMessage("c2cUnreadCount:".concat(e._c2cUnreadCount," groupUnreadCount:").concat(e._groupUnreadCount)).end(),Re.l("".concat(t," ok"))})).catch((function(e){n.setError(e).end(),Re.e("".concat(t," failed. error:"),e)}))}},{key:"_onForeground",value:function(){var e="".concat(this._n,".").concat("_onForeground"),t=new io("_onForeground");this.req({P:jn.STAT_FOREGROUND,data:{isWebUniapp:this._isWebUniapp}}).then((function(){t.end(),Re.l("".concat(e," ok"))})).catch((function(n){t.setError(n).end(),Re.e("".concat(e," failed. error:"),n)}))}},{key:"_pushReport",value:function(e){var t=this,n="".concat(this._n,".").concat("_pushReport"),o=new io("_pushReport");this.req({P:jn.PUSH_REPORT,data:{eventList:e.eventList}}).then((function(){o.end(),t._notifyReportSuccess(e)})).catch((function(e){o.setError(e).end(),Re.e("".concat(n," failed. error:"),e)}))}},{key:"_notifyReportSuccess",value:function(e){!pt(this._pushPlugin)&&Xe(this._pushPlugin.notifyReportSuccess)&&(this._pushPlugin.notifyReportSuccess(e),Re.l("".concat(this._n,"._notifyReportSuccess ok")))}},{key:"getUniAppPlatform",value:function(){var e=uni.getSystemInfoSync().platform,t=this.getDeviceBrand();return"ios"===e?N.IOS:"android"===e?N.ANDROID:1002===t?N.IPAD:1001===t?N.MAC:void 0}},{key:"reset",value:function(){this._deviceToken="",this._businessID=0,this._c2cUnreadCount=0,this._groupUnreadCount=0,this._isWebUniapp=0,Re.l("".concat(this._n,".reset"))}}]),xs),fs=(s(Us,Un),Br=g(Us),i(Us,[{key:"init",value:function(){var e=this.get(18).getPlugin("tim-profanity-filter-plugin");e&&(this._plugin=new e({logger:Re,isArray:Ze,isMap:je,isDevMode:this.isDevMode()}),this._getLexicon())}},{key:"onCheckTimer",value:function(){this._plugin&&this._canIUseLexicon&&this.isLoggedIn()&&!this._isFetching&&Date.now()>=this._expiredTime&&this._getLexicon()}},{key:"filterMessage",value:function(e,t){var n=!0;if(!this._plugin||!this._canIUseLexicon)return n;if(t&&t.messageControlInfo&&!0===t.messageControlInfo.excludedFromContentModeration)return n;t=e.type;var o=e.conversationType;if(t!==S.MSG_TEXT&&t!==S.MSG_CUSTOM)return n;var a,i="".concat(this._n,".filterMessage");if(Re.l("".concat(i)),t===S.MSG_TEXT){if(o===S.CONV_C2C?a="c2c_text_message":o===S.CONV_GROUP&&(a="group_text_message"),!this._isConfigOn(a))return n;var r=(s=this._plugin.filter(e.payload.text)).type,s=s.modifiedText;1===r?n=!1:2===r&&(e.payload.text=s)}else if(t===S.MSG_CUSTOM){if(o===S.CONV_C2C?a="c2c_custom_message":o===S.CONV_GROUP&&(a="group_custom_message"),!this._isConfigOn(a))return n;r=this._plugin.filter(e.payload.data),s=this._plugin.filter(e.payload.description),t=this._plugin.filter(e.payload.extension),1===r.type||1===s.type||1===t.type?n=!1:(2===r.type&&(e.payload.data=r.modifiedText),2===s.type&&(e.payload.description=s.modifiedText),2===t.type&&(e.payload.extension=t.modifiedText))}return Re.l("".concat(i," done. isAllowedToSend:").concat(n)),n}},{key:"filterText",value:function(e,t){var n="".concat(this._n,".filterText"),o={isAllowedToSend:!0,modifiedText:e};return this._plugin&&this._canIUseLexicon&&this._isConfigOn(t)?(Re.l("".concat(n)),e=(t=this._plugin.filter(e)).type,t=t.modifiedText,1===e?o.isAllowedToSend=!1:2===e&&(o.modifiedText=t),Re.l("".concat(n," done. ret:"),o),o):o}},{key:"_getLexicon",value:function(){var e=this,t=new io("profanityFilter"),n="".concat(this._n,"._getLexicon");this._isFetching=!0,this.req({P:jn.GET_PROFANITY_LIST,data:{startIndex:this._startIndex,version:this._version}}).then((function(o){var a=(o=o.data).errorInfo,i=o.filterConfig,r=o.lexicon,s=o.strToken,l=o.completeFlag,c=o.nextStartIndex,u=o.version,d=(o=o.expiredTime,a.errorCode),p=a.errorMessage;return 0!==d?(e._isFetching=!1,Re.w("".concat(n," failed. error:"),a),void t.setCode(d).setMessage(p).end()):(e._onFilterConfig(i),e._getToken(s),1===l?(Re.l("".concat(n," done. version:").concat(u," expiredTime:").concat(o)),e._version=u,e._canIUseLexicon=!0,e._isFetching=!1,e._expiredTime=Date.now()+1e3*o,void e._plugin.onLexiconCompleted(r)):(e._startIndex=c,e._plugin.onLexiconSliced(r),void e._getLexicon()))})).catch((function(o){t.setError(o).end(),e._isFetching=!1,Re.l("".concat(n," failed. error:"),o)}))}},{key:"_onFilterConfig",value:function(e){var t=this;He(e)||(this._filterConfigMap.clear(),Object.keys(e).forEach((function(n){t._filterConfigMap.set(n,e[n])})),Re.l("".concat(this._n,"._onFilterConfig. keys:").concat(Array.from(this._filterConfigMap.keys())," values:").concat(Array.from(this._filterConfigMap.values()))))}},{key:"_isConfigOn",value:function(e){return 1===this._filterConfigMap.get(e)}},{key:"_getToken",value:function(e){if(dt(e)){var t=e.length,n="";if(t%2==0)for(var o=0;o<=t-1;o+=2)n=(n+=e[o+1])+e[o];else{for(var a=0;a<t-1;a+=2)n=(n+=e[a+1])+e[a];n+=e[t-1]}this._plugin.onToken(n)}}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._plugin&&(this._plugin.reset(),this._plugin=null),this._filterConfigMap.clear(),this._startIndex=0,this._version=0,this._canIUseLexicon=!1,this._isFetching=!1,this._expiredTime=0}}]),Us),gs=(i(Ps,[{key:"_onCloudConfig",value:function(){var e=this,t=this._m.get(23).getCloudConfig("rtc_cmd");pt(t)||((t=JSON.parse(t)).forEach((function(t){e._TRTCCommandList.includes(t)||e._TRTCCommandList.push(t)})),this._setTRTCCommandMap())}},{key:"_setTRTCCommandMap",value:function(){for(var e,t=0,n=this._TRTCCommandList.length;t<n;t++)e=this._TRTCCommandList[t].split(".")[0],this._TRTCCommandMap.set(e,1)}},{key:"onRoomCustomDataReceived",value:function(e){this._m.getOEmitInst().emit(T.ROOM_CUSTOM_DATA_RECEIVED,e)}},{key:"sendTRTCCustomData",value:function(e){var t=e.serviceCommand,n=(e=e.data,"".concat(O.NAME.TUIROOM_SVR,".*"));return pt(t)||(n=t),this._isValidServiceCommand(n)?this._trans({servcmd:n,data:e}):Mn({code:zn.INVALID_TRTC_CMD})}},{key:"_trans",value:function(e){Re.d("".concat(this._n,"._trans. options:").concat(JSON.stringify(e)));var t=e.servcmd;return e=e.data,this._m.get(20).trans({servcmd:t,data:dt(e)?JSON.parse(e):e})}},{key:"_isValidServiceCommand",value:function(e){return e.endsWith(".*")?this._TRTCCommandList.includes(e):(e=e.split(".")[0],this._TRTCCommandMap.has(e))}},{key:"isTRTCCommand",value:function(e){return e=e.split(".")[0],this._TRTCCommandMap.has(e)}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),Ps),ms=(i(Os,[{key:"_init",value:function(){var e,t=this._getStorageModule().getItem(this.TIM_ERROR_ASSISTANCE,!1);if(t){try{e=JSON.parse(t)}catch(n){this._getStorageModule().removeItem(this.TIM_ERROR_ASSISTANCE,!1),Re.w("".concat(this._n,"._init error:"),n)}e&&(this._needToUpdate(e)?this._fetch():this._fillMap(e.message))}else this._fetch()}},{key:"_needToUpdate",value:function(e){var t=e.localSavedTime;return e=e.localSavedVersion,t=t&&(new Date).getTime()-t>=this.STORAGE_EXPIRES_TIME,e=!e||"3.5.2"!==e,Re.l("".concat(this._n,"._needToUpdate isTimeout:").concat(t," isDifferentVersion:").concat(e)),t||e}},{key:"_fetch",value:function(){var e,t,n,o,a,i;this._m.get(12).isPrivateNetWork()||(e="https://web.sdk.qcloud.com/im/download/error-message/v3/0.0.7/tim-error-message.txt",t="application/x-www-form-urlencoded;charset=UTF-8",n="".concat(this._n,"._fetch ok in"),o=this,X?ne.request({url:e,method:"GET",timeout:3e3,header:{"content-type":t},dataType:"text",success:function(e){o._fillAndSave(e.data),Re.l("".concat(n," mini program"))},fail:function(){}}):(a=new XMLHttpRequest,i=setTimeout((function(){a.abort()}),3e3),a.onreadystatechange=function(){4===a.readyState&&(i&&clearTimeout(i),200!==a.status&&304!==a.status||(Re.l("".concat(n," browser")),o._fillAndSave(a.responseText)))},a.open("GET",e,!0),a.setRequestHeader("Content-type",t),a.send()))}},{key:"_fillAndSave",value:function(e){this._fillMap(e),this._getStorageModule().setItem(this.TIM_ERROR_ASSISTANCE,JSON.stringify({message:e,localSavedTime:(new Date).getTime(),localSavedVersion:"3.5.2"}),!0,!1)}},{key:"_getStorageModule",value:function(){return this._m.get(13)}},{key:"_fillMap",value:function(e){this._map.clear();for(var t,n,o=e.split(";\n"),a=o.length,i=new RegExp(/'/g),r=0;r<a;r++)if(n=o[r].indexOf(":"),t=o[r].slice(0,n),n=o[r].slice(n+1,o[r].length),!t.startsWith("//")){if(pt(n))continue;this._map.set(t,n.replace(i,""))}}},{key:"get",value:function(e){var t=e.isIntl,n=e.key,o=e.replacement1;return e=e.replacement2,t="".concat(n,t?"_en":"_cn"),!this._map.has(t)&&this._map.has(n)&&(t=n),n="",this._map.has(t)&&(n=this._map.get(t),pt(o)||(n=n.replace("$replacement1",o)),pt(e)||(n=n.replace("$replacement2",e))),n}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset"))}}]),Os),vs=(i(As,[{key:"onNewMessageList",value:function(e){var t=this;e.forEach((function(e){var n=t.getPayloadData(e);n&&t._handleActionType(n,e)}))}},{key:"onMessageModified",value:function(e){var t=this;e.forEach((function(e){var n=t.getPayloadData(e);n&&t._onInvitationModified(n,e)}))}},{key:"getPayloadData",value:function(e){var t="".concat(this._n,".getPayloadData");e=e.payload.data;try{return JSON.parse(e)}catch(n){return Re.e("".concat(t," JSON parse error. signalingData:").concat(e)),null}}},{key:"_handleActionType",value:function(e,t){switch(e.actionType){case M.ACTION_TYPE_INVITE:this._onNewInvitationReceived(e,t);break;case M.ACTION_TYPE_REJECT_INVITE:this._onInviteeRejected(e);break;case M.ACTION_TYPE_ACCEPT_INVITE:this._onInviteeAccepted(e);break;case M.ACTION_TYPE_CANCEL_INVITE:this._onInvitationCancelled(e);break;case M.ACTION_TYPE_INVITE_TIMEOUT:this._onInvitationTimeout(e)}}},{key:"_genBaseEmitData",value:function(e){return{inviteID:e.inviteID,inviter:e.inviter,groupID:e.groupID,data:e.data||""}}},{key:"_onNewInvitationReceived",value:function(e,n){var o="".concat(this._n,"._onNewInvitationReceived"),a=e.inviteID,i=e.inviteeList,r=e.groupID,s=e.inviter,l=this._sigM.getMyUserID(),c=i.includes(l),u=e.timeout,d=(ke().getTime()-1e3*n.time)/1e3;0<u&&0<d&&d<u&&(u-=d),o="".concat(o," myselfIncluded:").concat(c," groupID:").concat(r," signalObj:").concat(JSON.stringify(e)),Re.l("".concat(o," timeout:").concat(u,"s delta:").concat(d,"s")),(r&&c||!r)&&((o=this._sigM.getInviteInfo(a))&&o===e||(o||this._sigM.setInviteInfo(a,t(t({},e),{},{message:n})),this._sigM.emitEvent(M.NEW_INVITATION_RECEIVED,t(t({},this._genBaseEmitData(e)),{},{inviteeList:i})),s!==l&&this._sigM.startTimer(t(t({},e),{},{timeout:u}))))}},{key:"_onInviteeRejected",value:function(e){var n="".concat(this._n,"._onInviteeRejected"),o=e.inviteID,a=e.inviter,i=e.groupID,r=this._sigM.hasInviteInfo(o);Re.l("".concat(n," inviteID:").concat(o," hasInviteID:").concat(r," inviter:").concat(a," groupID:").concat(i)),r&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(M.INVITEE_REJECTED,t(t({},this._genBaseEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInviteeAccepted",value:function(e){var n="".concat(this._n,"._onInviteeAccepted"),o=e.inviteID,a=e.inviter,i=e.groupID,r=this._sigM.hasInviteInfo(o);Re.l("".concat(n," inviteID:").concat(o," hasInviteID:").concat(r," inviter:").concat(a," groupID:").concat(i)),r&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(M.INVITEE_ACCEPTED,t(t({},this._genBaseEmitData(e)),{},{invitee:e.inviteeList[0]})))}},{key:"_onInvitationCancelled",value:function(e){var t="".concat(this._n,"._onInvitationCancelled"),n=e.inviteID,o=e.inviter,a=e.groupID,i=this._sigM.hasInviteInfo(n);Re.l("".concat(t," inviteID:").concat(n," hasInviteID:").concat(i," inviter:").concat(o," groupID:").concat(a)),i&&(this._sigM.deleteInviteInfo(n),this._sigM.emitEvent(M.INVITATION_CANCELLED,this._genBaseEmitData(e)))}},{key:"_onInvitationTimeout",value:function(e){var n="".concat(this._n,"._onInvitationTimeout"),o=e.inviteID,a=e.inviter,i=e.groupID,r=e.inviteeList,s=this._sigM.hasInviteInfo(o);Re.l("".concat(n," inviteID:").concat(o," hasInviteID:").concat(s," inviter:").concat(a," groupID:").concat(i,"  data:").concat(e.data)),s&&(this._sigM.updateInviteInfo(e),this._sigM.emitEvent(M.INVITATION_TIMEOUT,t(t({},this._genBaseEmitData(e)),{},{inviteeList:r,isSelfTimeout:!1})))}},{key:"_onInvitationModified",value:function(e,n){var o="".concat(this._n,"._onInvitationModified"),a=e.inviteID,i=e.data,r=this._sigM.hasInviteInfo(a);Re.l("".concat(o," inviteID:").concat(a," hasInviteID:").concat(r," data:").concat(i)),r&&(this._sigM.setInviteInfo(a,t(t({},e),{},{message:n})),this._sigM.emitEvent(M.INVITATION_MODIFIED,{inviteID:a,data:i}))}}]),As),_s=(i(Ls,[{key:"generateInviteID",value:function(){var e,t=(t=Ur)((e=Pr)(32),8)+"-"+t(e(16),4)+"-"+t(16384|e(12),4)+"-"+t(32768|e(14),4)+"-"+t(e(48),12);return Re.l("".concat(this._n,".generateInviteID inviteID:").concat(t)),t}},{key:"createInviteInfo",value:function(e){var n=this.generateInviteID(),o=(e=this.createInviteCustomData(t(t({},e),{},{inviteID:n}))).groupID,a=e.inviteeList;return o=o||a[0],{customData:e,message:this._sigM.createSignaling(e,o),inviteID:n}}},{key:"_genBaseCustomData",value:function(e){var t=e.data,n=e.inviteID;return{businessID:1,timeout:0,data:void 0===t?"":t,inviteID:void 0===n?"":n,groupID:void 0===(e=e.groupID)?"":e}}},{key:"createInviteCustomData",value:function(e){var n=e.userID,o=void 0===(o=e.timeout)?0:o,a=void 0===(a=e.groupID)?"":a,i=this._sigM.getMyUserID();return i=t(t({},this._genBaseCustomData(e)),{},{actionType:M.ACTION_TYPE_INVITE,inviter:i,inviteeList:a?e.inviteeList:[n],timeout:o}),Re.l("".concat(this._n,".createInviteCustomData customData:"),i),i}},{key:"createCancelCustomData",value:function(e){var n,o="".concat(this._n,".createCancelCustomData"),a=e.inviteID,i=this._sigM.getMyUserID(),r=(a=this._sigM.getInviteInfo(a)).inviteeList,s=a.groupID;return(a=a.inviter)===i?n=t(t({},this._genBaseCustomData(e)),{},{actionType:M.ACTION_TYPE_CANCEL_INVITE,groupID:s,inviter:i,inviteeList:r}):Re.e("".concat(o," unmatched inviter:").concat(a," and my userID:").concat(i)),Re.l("".concat(o," customData:"),n),n}},{key:"createAcceptCustomData",value:function(e){var n,o="".concat(this._n,".createAcceptCustomData"),a=e.inviteID,i=this._sigM.getMyUserID(),r=this._sigM.getInviteInfo(a),s=r.inviter,l=r.groupID;return r.inviteeList.includes(i)?n=t(t({},this._genBaseCustomData(e)),{},{actionType:M.ACTION_TYPE_ACCEPT_INVITE,groupID:l,inviter:s,inviteeList:[i]}):Re.e("".concat(o," userID:").concat(i," not in inviteeList. inviteID:").concat(a," groupID:").concat(l)),Re.l("".concat(o," customData:"),n),n}},{key:"createRejectCustomData",value:function(e){var n,o="".concat(this._n,".createRejectCustomData"),a=e.inviteID,i=this._sigM.getMyUserID(),r=this._sigM.getInviteInfo(a),s=r.inviter,l=r.groupID;return r.inviteeList.includes(i)?n=t(t({},this._genBaseCustomData(e)),{},{actionType:M.ACTION_TYPE_REJECT_INVITE,groupID:l,inviter:s,inviteeList:[i]}):Re.e("".concat(o," userID:").concat(i," not in inviteeList. inviteID:").concat(a," groupID:").concat(l)),Re.l("".concat(o," customData:"),n),n}},{key:"createTimeoutCustomData",value:function(e){var n="".concat(this._n,".createTimeoutCustomData"),o=e.inviteeList,a=e.inviter,i=void 0!==(i=e.isInviter)&&i,r=this._sigM.getMyUserID();return e=t(t({},this._genBaseCustomData(e)),{},{actionType:M.ACTION_TYPE_INVITE_TIMEOUT,inviter:a,inviteeList:i?o:[r]}),Re.l("".concat(n," customData:"),e),e}}]),Ls),ys=(i(Rs,[{key:"setCloudConfig",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:20,t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:300;this.COUNT=e,this.EXPIRED_TIME=t,Re.l("".concat(this._n,".setCloudConfig count:").concat(e,", time:").concat(t))}},{key:"getHistorySignaling",value:function(){var e=this,t=this._sigM.get(11).getLocalConvList();He(t)||(this._getC2CSignalingList(),t=this._getValidGroupConvList(t),this._getGroupSignalingList(t).then((function(t){e._handleSignalingList(t)})))}},{key:"_getC2CSignalingList",value:function(){var e=this._sigM.get(6).getMessageListFromUnreadDB();e=this._sigM.filterMessageList(e),this._getRelatedToMeMap(e)}},{key:"_getGroupSignalingList",value:function(e){var t=this;return 0===(e=this._createPromiseList(e)).length?Promise.resolve(this._sortSignaling(this._relatedToMeMap)):this._concurrentGetMessageList(e).then((function(e){var n=new Map;return e.forEach((function(e){e=e.list,e=t._getRelatedToMeMap(e),n=new Map([].concat(v(n),v(e)))})),t._sortSignaling(n)}))}},{key:"_handleSignalingList",value:function(e){He(e)||this._sigM.onNewMessageList(e)}},{key:"_getValidGroupConvList",value:function(e){for(var t=[],n=0,o=e.length;n<o;n++){var a=(r=e[n]).type,i=r.unreadCount,r=r.lastMessage;a=a===S.CONV_GROUP,r=this._isNotExpired(r),a&&i&&r&&t.push(e[n])}return t}},{key:"_isNotExpired",value:function(e){return!(!e||!e.lastTime)&&e.lastTime>Te()-this.EXPIRED_TIME}},{key:"_createPromiseList",value:function(e){for(var t=[],n=0;n<e.length;n++){var o=(a=e[n]).conversationID,a=(a=a.unreadCount)<this.COUNT?a:this.COUNT;this._map.set(o,{msgCount:a,list:[]}),a=this._sigM.get(11).getMessageList({conversationID:o}),t.push(a)}return t}},{key:"_concurrentGetMessageList",value:function(e){var t=this,n=[];return Promise.all(e).then((function(e){for(var o=0;o<e.length;o++){var a=(i=e[o]).code,i=i.data;0===a&&0!==i.messageList.length&&(t._handleMessageList(i.messageList),(a=t._relayGetMessageList(i))&&n.push(a))}return 0<n.length?t._concurrentGetMessageList(n):t._map}))}},{key:"_relayGetMessageList",value:function(e){var t=e.messageList,n=e.nextReqMessageID;if(e=e.isCompleted,0===t.length)return null;t=t[0].conversationID;var o=this._map.get(t).msgCount;return 0===o||e?null:this._sigM.get(11).getMessageList({conversationID:t,nextReqMessageID:n,count:o})}},{key:"_handleMessageList",value:function(e){var t=e.length,n=e[0].conversationID,o=(a=this._map.get(n)).msgCount,a=a.list;this._map.set(n,{msgCount:0<o-t?o-t:0,list:a.concat(this._sigM.filterMessageList(e))})}},{key:"_getRelatedToMeMap",value:function(e){for(var t=0;t<e.length;t++){var n=e[t];this._saveRelatedToMe(n)}return this._relatedToMeMap}},{key:"_saveRelatedToMe",value:function(e){var t,n=(t=this._sigM.getPayloadData(e)||{}).actionType,o=void 0===(t=t.inviteID)?"":t;switch(void 0===n?"":n){case M.ACTION_TYPE_INVITE:this._setHistoryInvite(e);break;case M.ACTION_TYPE_REJECT_INVITE:case M.ACTION_TYPE_ACCEPT_INVITE:this._updateHistoryInvite(e);break;case M.ACTION_TYPE_CANCEL_INVITE:this._delHistoryInvite(o);break;case M.ACTION_TYPE_INVITE_TIMEOUT:this._updateHistoryInvite(e)}}},{key:"_setHistoryInvite",value:function(e){var n=this._sigM.getPayloadData(e)||{},o=void 0===(o=n.inviteID)?"":o,a=void 0===(a=n.inviteeList)?[]:a,i=void 0===(i=n.timeout)?0:i,r=this._sigM.getMyUserID();a.includes(r)&&(a=Te()-e.time,0<i&&i<a&&0!==i||this._relatedToMeMap.set(o,t(t({},n),{},{messageList:[e]})))}},{key:"_delHistoryInvite",value:function(e){this._relatedToMeMap.has(e)&&this._relatedToMeMap.delete(e)}},{key:"_updateHistoryInvite",value:function(e){var t=void 0===(t=(a=this._sigM.getPayloadData(e)||{}).inviteID)?"":t,n=void 0===(a=a.inviteeList)?[]:a;if(this._relatedToMeMap.has(t)){for(var o=(a=this._relatedToMeMap.get(t)).inviteeList,a=a.messageList,i=0;i<n.length;i++){var r=n[i];o.includes(r)&&o.splice(o.indexOf(r),1)}0===o.length?this._delHistoryInvite(t):a.push(e)}else this._delHistoryInvite(t)}},{key:"_sortSignaling",value:function(e){var t=[];return e.forEach((function(e){t=[].concat(v(t),v(e.messageList))})),t.sort((function(e,t){return e.time-t.time}))}},{key:"reset",value:function(){this._map.clear(),this._relatedToMeMap.clear()}}]),Rs),Is=i((function e(t,n){o(this,e),this.businessID=t.businessID||1,this.inviteID=t.inviteID,this.groupID=t.groupID||"",this.inviter=t.inviter||"",this.inviteeList=t.inviteeList||[],this.data=t.data||"",this.actionType=t.actionType||M.ACTION_TYPE_INVITE,this.timeout=t.timeout||0})),Cs=["message"],ks=["message"],Es=(s(Ns,Un),Vr=g(Ns),i(Ns,[{key:"onC2CUnreadHandleCompleted",value:function(){this._isC2CUnreadHandleCompleted=!0,this._isCloudConfigCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onConvSyncCompleted",value:function(){this._isConvSyncCompleted=!0,this._isC2CUnreadHandleCompleted&&this._isCloudConfigCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"onCloudConfig",value:function(){this._isCloudConfigCompleted=!0;var e=this.getCloudConfig("history_s_count"),t=this.getCloudConfig("history_s_time");pt(e)||(e=Number(e)),pt(t)||(t=Number(t)),this._historySignalingHandler.setCloudConfig(e,t),this._isC2CUnreadHandleCompleted&&this._isConvSyncCompleted&&!this._isSyncCompleted&&this.onReady()}},{key:"_isListenerExisted",value:function(){return-1<this._m.getOEmitInst().eventNames().indexOf(M.NEW_INVITATION_RECEIVED)}},{key:"onReady",value:function(){this._isSyncCompleted=!0;var e=this._isListenerExisted();Re.l("".concat(this._n,".onReady. isListenerExisted: ").concat(e)),e&&this._historySignalingHandler.getHistorySignaling()}},{key:"onNewMessageList",value:function(e){if(0<(e=this.filterMessageList(e)).length)return this._remoteSignalingHandler.onNewMessageList(e)}},{key:"onMessageModified",value:function(e){if(0<(e=this.filterMessageList(e)).length)return this._remoteSignalingHandler.onMessageModified(e)}},{key:"hasInviteInfo",value:function(e){return this._inviteInfoMap.has(e)}},{key:"getInviteInfo",value:function(e){return this._inviteInfoMap.get(e)}},{key:"setInviteInfo",value:function(e,n){var o=n.message;n=h(n,Cs),Re.l("".concat(this._n,".setInviteInfo inviteID:").concat(e," data:"),n),this._inviteInfoMap.set(e,t(t({},n),{},{message:o}))}},{key:"deleteInviteInfo",value:function(e){this.hasInviteInfo(e)&&(Re.l("".concat(this._n,".deleteInviteInfo inviteID:").concat(e,".")),this._inviteInfoMap.delete(e))}},{key:"updateInviteInfo",value:function(e){var t="".concat(this._n,".updateInviteInfo"),n=e.inviteID,o=e.inviter,a=e.inviteeList;e=e.groupID,Re.l("".concat(t," inviteID:").concat(n," inviter:").concat(o," groupID:").concat(e)),e&&this.hasInviteInfo(n)?(o=a[0],(e=this.getInviteInfo(n).inviteeList).includes(o)&&(e.splice(e.indexOf(o),1),Re.l("".concat(t," remove ").concat(o,". localInviteeList.length:").concat(e.length))),0===e.length&&this.deleteInviteInfo(n)):this.deleteInviteInfo(n)}},{key:"canIUseSignaling",value:function(){return this._canIUseSignaling}},{key:"emitEvent",value:function(e,t){this.emitOEvt(e,t)}},{key:"addSignalingListener",value:function(e,t,n){this._canIUseSignaling||(this._canIUseSignaling=!0),this._m.getOEmitInst().on(e,t,n)}},{key:"removeSignalingListener",value:function(e,t,n){this._m.getOEmitInst().off(e,t,n),this._isListenerExisted()||(this._canIUseSignaling=!1)}},{key:"invite",value:function(e){var n=this,o="".concat(this._n,".").concat("invite"),a=this._localSignalingHandler.createInviteInfo(e),i=a.message,r=a.customData,s=a.inviteID;return Re.l("".concat(o," options:").concat(JSON.stringify(e)," inviteID:").concat(s)),this.sendSignaling(i,e).then((function(e){return e&&0===e.code?(n.setInviteInfo(s,t(t({},r),{},{message:i})),n.startTimer(t(t({},r),{},{inviteID:s})),t(t({},e),{},{inviteID:s})):e})).catch((function(e){return Mn(e)}))}},{key:"inviteSync",value:function(e,n,o){var a=this,i="".concat(this._n,".").concat("inviteSync"),r=this._localSignalingHandler.createInviteInfo(e),s=r.message,l=r.customData,c=r.inviteID;return Re.l("".concat(i," options:").concat(JSON.stringify(e)," inviteID:").concat(c)),this.sendSignaling(s,e).then((function(e){if(e&&0===e.code)return a.setInviteInfo(c,t(t({},l),{},{message:s})),a.startTimer(t(t({},l),{},{inviteID:c})),n&&n({inviteID:c}),{inviteID:c};o&&o(0===e.code,e.message||"")})).catch((function(e){return o&&o(e.code,e.message),Mn(e)})),c}},{key:"_handleImResponse",value:function(e,t,n){t&&0===t.code&&(this._isHandling=!1,n?this.deleteInviteInfo(e.inviteID):this.updateInviteInfo(e))}},{key:"cancel",value:function(e){var n=this,o="".concat(this._n,".").concat("cancel");if(Re.l("".concat(o," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return Mn({code:zn.INVALID_CANCEL_MESSAGE});this._isHandling=!0;var a=this._localSignalingHandler.createCancelCustomData(e);if(!a)return this._isHandling=!1,Mn({code:zn.SIGNALING_NO_PERMISSION});o=a.groupID;var i=a.inviteeList;return o=o||i[0],i=this.createSignaling(a,o),this.sendSignaling(i,e).then((function(o){return n._handleImResponse(a,o,!0),0===o.code?t(t({},o),{},{inviteID:e.inviteID}):o})).catch((function(e){return Mn(e)}))}},{key:"accept",value:function(e){var n=this,o="".concat(this._n,".").concat("accept");if(Re.l("".concat(o," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return Mn({code:zn.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var a=this._localSignalingHandler.createAcceptCustomData(e);return a?(o=this.createSignaling(a),this.sendSignaling(o,e).then((function(o){return n._handleImResponse(a,o),0===o.code?t(t({},o),{},{inviteID:e.inviteID}):o})).catch((function(e){return Mn(e)}))):(this._isHandling=!1,Mn({code:zn.SIGNALING_NO_PERMISSION}))}},{key:"reject",value:function(e){var n=this,o="".concat(this._n,".").concat("reject");if(Re.l("".concat(o," options:").concat(JSON.stringify(e))),!this.hasInviteInfo(e.inviteID)||this._isHandling)return Mn({code:zn.SIGNALING_INVALID_INVITE_ID});this._isHandling=!0;var a=this._localSignalingHandler.createRejectCustomData(e);return a?(o=this.createSignaling(a),this.sendSignaling(o,e).then((function(o){return n._handleImResponse(a,o,!0),0===o.code?t(t({},o),{},{inviteID:e.inviteID}):o})).catch((function(e){return Mn(e)}))):(this._isHandling=!1,Mn({code:zn.SIGNALING_NO_PERMISSION}))}},{key:"getSignalingInfo",value:function(e){var t="".concat(this._n,".getSignalingInfo"),n=e.ID,o=e.from,a=e.to,i=this._filterSignaling(e),r=null;return i&&(e=this.getPayloadData(e),r=new Is(e)),e=i?"actionType:".concat(r.actionType):"",Re.l("".concat(t," messageID:").concat(n," from:").concat(o," to:").concat(a," ")+"".concat(e," isSignaling:").concat(i)),r}},{key:"modifyInvitation",value:function(e){var n=this,o=e.inviteID;if(e=e.data,!this.hasInviteInfo(o))return Mn({code:zn.SIGNALING_INVALID_INVITE_ID});var a=this.getInviteInfo(o),i=a.message,r=h(a,ks),s=i.payload.data;return r.data=e,i.payload.data=JSON.stringify(r),this.get(2).modifyRemoteMessage(i).then((function(e){return n.hasInviteInfo(o)&&n.setInviteInfo(o,t(t({},r),{},{message:i})),e})).catch((function(e){return i.payload.data=s,Mn(e)}))}},{key:"_genMsgCtrlInfo",value:function(){var e=void 0===(e=(a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).data)?"":e,t=a.onlineUserOnly,n=void 0===(n=a.inviteID)?"":n,o=a.offlinePushInfo,a=a.actionType,i={_onlineOnlyFlag:!1};return n={onlineUserOnly:(i=n&&this.getInviteInfo(n)?this.getInviteInfo(n).message:i)._onlineOnlyFlag||t||!1,offlinePushInfo:o,messageControlInfo:{excludedFromContentModeration:!0,excludedFromUnreadCount:!1,excludedFromLastMessage:!1}},a===M.ACTION_TYPE_INVITE_TIMEOUT?(i=!!e.match(/excludeTimeoutSignalingFromHistoryMessage/),n.messageControlInfo.excludedFromUnreadCount=i,n.messageControlInfo.excludedFromLastMessage=i,n):(t=!!e.match(/excludeFromHistoryMessage/),o=!!e.match(/excludeOriginalSignalingFromHistoryMessage/),n.messageControlInfo.excludedFromUnreadCount=t||o,n.messageControlInfo.excludedFromLastMessage=t||o,n)}},{key:"sendSignaling",value:function(e,t){var n=this;return this.get(2).sendMessageInstance(e,this._genMsgCtrlInfo(t)).catch((function(e){return n._isHandling=!1,Mn(e)}))}},{key:"filterMessageList",value:function(e){var t=this;return e.filter((function(e){return t._filterSignaling(e)}))}},{key:"getPayloadData",value:function(e){return this._remoteSignalingHandler.getPayloadData(e)}},{key:"createSignaling",value:function(e,t){var n=e.groupID,o=e.inviter;return t={to:t||n||o,conversationType:n?S.CONV_GROUP:S.CONV_C2C,priority:S.MSG_PRIORITY_HIGH,payload:{data:JSON.stringify(e)}},o=this.get(2).createCustomMessage(t),Re.l("".concat(this._n,".createSignaling. message:"),o),o}},{key:"_filterSignaling",value:function(e){var t,n,o=!1;return e.type&&e.type===S.MSG_CUSTOM&&(t=e.cloudCustomData,e=void 0===(e=e.payload.data)?"":e,t=(void 0===t?"":t).match(/"type":"tsignaling"/),n=e.match(/inviteID/),e=e.match(/actionType/),o=t||n&&e),!!o}},{key:"startTimer",value:function(e){var t,n,o,a=this,i="".concat(this._n,".startTimer"),r=e.timeout,s=e.inviteID,l=e.inviter,c=e.groupID,u=l===this.getMyUserID();Re.l("".concat(i," timeout:").concat(r," isInviter:").concat(u," groupID:").concat(c)),r<=0||(t=u?r+5:r,n=1,o=setInterval((function(){var r=a._hasLocalInviteInfo(e,u);n<t&&r?++n:(r&&a._sendTimeoutNotice(s,u),Re.l("".concat(i," end.")),clearInterval(o))}),1e3))}},{key:"_hasLocalInviteInfo",value:function(e,t){var n=e.inviteID;if(e=e.groupID,!this.hasInviteInfo(n))return!1;var o="".concat(this._n,"._hasLocalInviteInfo"),a=this.getInviteInfo(n).inviteeList;return Re.l("".concat(o," inviteID:").concat(n," inviteeList:").concat(a," groupID:").concat(e)),!e||(t?0<a.length:0<a.length&&a.includes(this.getMyUserID()))}},{key:"_getReceiver",value:function(e,t){var n=t.groupID,o=t.inviteeList;return t=t.inviter,e?n||o[0]:n||t}},{key:"_sendTimeoutNotice",value:function(e,n){var o=this,a=this.getInviteInfo(e),i=this._getReceiver(n,a),r=(Re.l("".concat(this._n,"._sendTimeoutNotice inviteID:").concat(e," to:").concat(i," isInviter:").concat(n)),this._localSignalingHandler.createTimeoutCustomData(t(t({},a),{},{isInviter:n}))),s=this.createSignaling(r,i);return this.sendSignaling(s,r).then((function(t){var a,i,l;t&&0===t.code&&(t=r.data,a=r.groupID,i=r.inviteeList,l=r.inviter,o.emitEvent(M.INVITATION_TIMEOUT,{data:t,groupID:a,inviteID:e,inviteeList:i,inviter:l,isSelfTimeout:!0,message:s}),n?o.deleteInviteInfo(e):o.updateInviteInfo(r))}))}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._inviteInfoMap.clear(),this._canIUseSignaling=!1,this._isHandling=!1,this._historySignalingHandler.reset(),this._isC2CUnreadHandleCompleted=!1,this._isConvSyncCompleted=!1,this._isSyncCompleted=!1,this._isCloudConfigCompleted=!1}}]),Ns),Ts=["followDiffList"],Ss=["from"],Ms={NONE:0,FOLLOWERS:1,FOLLOWING:2,MUTUAL:3},ws=(s(Ds,Un),xr=g(Ds),i(Ds,[{key:"_onCloudConfig",value:function(){var e=this.getCloudConfig("follow_req_count");pt(e)||(e=Number(e),this.DEFAULT_COUNT=e>this.MAX_COUNT?this.MAX_COUNT:e,this._clearFollowList())}},{key:"clearCacheOnReconnected",value:function(){this._clearFollowList()}},{key:"onFollowNotify",value:function(e){var t=this;e=e.dataList||[],Re.l("".concat(this._n,".onFollowNotify followChangeList:").concat(e.length)),e.forEach((function(e){var n=void 0===(n=e.followDiffList)?[]:n,o=(e=h(e,Ts)).from,a=h(e,Ss);n.forEach((function(e){var n=e.isAdd,i=(e=void 0===(e=e.followType)?0:e,t._initFollowInfo());1===n?(a.userID=o,i[e].userInfoList.push(a),i[e].isAdd=!0):(i[e].userInfoList.push(o),i[e].isAdd=!1),t._emitEvent(i)}))}))}},{key:"_initFollowInfo",value:function(){var e={};return Object.values(Ms).forEach((function(t){t!==Ms.NONE&&(e[t]={userInfoList:[],isAdd:!1})})),e}},{key:"_emitEvent",value:function(e){var t=this;Object.keys(e).forEach((function(n){n=Number(n);var o=e[n];0<o.userInfoList.length&&(n===Ms.FOLLOWERS&&(t._clearFollowList(Ms.FOLLOWERS),t.emitOEvt(T.MY_FOLLOWERS_LIST_UPDATED,o)),n===Ms.FOLLOWING&&(t._clearFollowList(Ms.FOLLOWING),t.emitOEvt(T.MY_FOLLOWING_LIST_UPDATED,o)),n===Ms.MUTUAL&&(t._clearFollowList(Ms.MUTUAL),t.emitOEvt(T.MUTUAL_FOLLOWERS_LIST_UPDATED,o)))}))}},{key:"followUser",value:function(e){if(!this.canIUse(P.FOLLOW))return this.noUse("followUser");var t="".concat(this._n,".").concat("followUser"),n="userIDList:".concat(e.length),o=new io("followUser");return o.setMessage(n),Re.l("".concat(t," ").concat(n)),this.req({P:jn.FOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:e.map((function(e){return{userID:e}}))}}).then((function(e){return o.end(),Re.l("".concat(t," ok.")),Tn(e.data.resultList)})).catch((function(e){return o.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"unfollowUser",value:function(e){if(!this.canIUse(P.FOLLOW))return this.noUse("unfollowUser");var t="".concat(this._n,".").concat("unfollowUser"),n="userIDList:".concat(e.length),o=new io("unfollowUser");return o.setMessage(n),Re.l("".concat(t," ").concat(n)),this.req({P:jn.UNFOLLOW,data:{fromAccount:this.getMyUserID(),userIDList:e}}).then((function(e){return o.end(),Re.l("".concat(t," ok.")),Tn(e.data.resultList)})).catch((function(e){return o.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"getMyFollowersList",value:function(){var e=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",o="getMyFollowersList";if(!this.canIUse(P.FOLLOW))return this.noUse(o);var a=n||this.FIRST_PAGE_INDEX;if(this._myFollowersList.has(a)){var i=(s=this._myFollowersList.get(a)).resultList,r=s.nextCursor,s=s.lastUpdateTime;if(Date.now()-s<this.MAX_CATCH_TIME&&0<i.length)return Re.l("".concat(this._n,".").concat(o," nextCursor:").concat(n," from local.")),Sn({resultList:i,nextCursor:r})}return this._getFollowList(n,Ms.FOLLOWERS).then((function(i){return e._myFollowersList.set(a,t(t({},i),{},{lastUpdateTime:Date.now()})),Re.l("".concat(e._n,".").concat(o," nextCursor:").concat(n," from remote.")),Tn(i)}))}},{key:"getMyFollowingList",value:function(){var e=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",o="getMyFollowingList";if(!this.canIUse(P.FOLLOW))return this.noUse(o);var a=n||this.FIRST_PAGE_INDEX;if(this._myFollowingList.has(a)){var i=(s=this._myFollowingList.get(a)).resultList,r=s.nextCursor,s=s.lastUpdateTime;if(Date.now()-s<this.MAX_CATCH_TIME&&0<i.length)return Re.l("".concat(this._n,".").concat(o," nextCursor:").concat(n," from local.")),Sn({resultList:i,nextCursor:r})}return this._getFollowList(n,Ms.FOLLOWING).then((function(i){return e._myFollowingList.set(a,t(t({},i),{},{lastUpdateTime:Date.now()})),Re.l("".concat(e._n,".").concat(o," nextCursor:").concat(n," from remote.")),Tn(i)}))}},{key:"getMutualFollowersList",value:function(){var e=this,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",o="getMutualFollowersList";if(!this.canIUse(P.FOLLOW))return this.noUse(o);var a=n||this.FIRST_PAGE_INDEX;if(this._myMutualFollowersList.has(a)){var i=(s=this._myMutualFollowersList.get(a)).resultList,r=s.nextCursor,s=s.lastUpdateTime;if(Date.now()-s<this.MAX_CATCH_TIME&&0<i.length)return Re.l("".concat(this._n,".").concat(o," nextCursor:").concat(n," from local.")),Sn({resultList:i,nextCursor:r})}return this._getFollowList(n,Ms.MUTUAL).then((function(i){return e._myMutualFollowersList.set(a,t(t({},i),{},{lastUpdateTime:Date.now()})),Re.l("".concat(e._n,".").concat(o," nextCursor:").concat(n," from remote.")),Tn(i)}))}},{key:"_getFollowList",value:function(e,n){var o=this,a=new io("_getFollowList");return a.setMessage("nextCursor:".concat(e," type:").concat(n)),this.req({P:jn.GET_FOLLOW,data:{fromAccount:this.getMyUserID(),count:this.DEFAULT_COUNT,nextCursor:e,type:n}}).then((function(e){a.end();var n=void 0===(n=(e=e.data).resultList)?[]:n,i=(e=void 0===(e=e.nextCursor)?"":e,[]);return n.forEach((function(e){var n=e.userID,a=e.followTime;e=e.profileList,i.push(t({userID:n,followTime:a},o._handleProfileItem(void 0===e?[]:e)))})),{resultList:i,nextCursor:e}})).catch((function(e){return a.setError(e).end(),Re.e("".concat(o._n,"._getFollowList failed. error:"),e),Mn(e)}))}},{key:"_handleProfileItem",value:function(e){var t={};return e.forEach((function(e){switch(e.tag){case Ae.NICK:t.nick=e.value;break;case Ae.GENDER:t.gender=e.value;break;case Ae.BIRTHDAY:t.birthday=e.value;break;case Ae.LOCATION:t.location=e.value;break;case Ae.SELFSIGNATURE:t.selfSignature=e.value;break;case Ae.ALLOWTYPE:t.allowType=e.value;break;case Ae.LANGUAGE:t.language=e.value;break;case Ae.AVATAR:t.avatar=e.value;break;case Ae.MESSAGESETTINGS:t.messageSettings=e.value;break;case Ae.ADMINFORBIDTYPE:t.adminForbidType=e.value;break;case Ae.LEVEL:t.level=e.value;break;case Ae.ROLE:t.role=e.value;break;default:t[e.tag]=e.value}})),t}},{key:"getUserFollowInfo",value:function(e){if(!this.canIUse(P.FOLLOW))return this.noUse("getUserFollowInfo");var t=e,n=!1,o=(pt(e)&&(t=[this.getMyUserID()],n=!0),"".concat(this._n,".").concat("getUserFollowInfo")),a=(e="userIDList:".concat(t.length," isGetMyFollowInfo:").concat(n),new io("getUserFollowInfo"));return a.setMessage(e),Re.l("".concat(o," ").concat(e)),this.req({P:jn.GET_FOLLOW_INFO,data:{fromAccount:this.getMyUserID(),userIDList:t}}).then((function(e){a.end(),Re.l("".concat(o," ok.")),e=e.data.followInfoList;var t=[];return(void 0===e?[]:e).forEach((function(e){var n=e.followersCount,o=e.followingCount;e=e.mutualFollowersCount,t.push({followersCount:n,followingCount:o,mutualFollowersCount:e})})),Tn(t)})).catch((function(e){return a.setError(e).end(),Re.e("".concat(o," failed. error:"),e),Mn(e)}))}},{key:"checkFollowType",value:function(e){if(!this.canIUse(P.FOLLOW))return this.noUse("checkFollowType");100<e.length&&(e=e.slice(0,100),Re.w("".concat(t," ").concat(qt(100))));var t="".concat(this._n,".").concat("checkFollowType"),n="userIDList length:".concat(e.length," "),o=new io("checkFollowType");return o.setMessage(n),Re.l("".concat(t," ").concat(n)),this.req({P:jn.CHECK_FOLLOW_TYPE,data:{fromAccount:this.getMyUserID(),userIDList:e}}).then((function(e){o.end(),Re.l("".concat(t," ok.")),e=e.data.resultList;var n=[];return(void 0===e?[]:e).forEach((function(e){var t=e.userID;e=e.followType,n.push({userID:t,followType:e})})),Tn(n)})).catch((function(e){return o.setError(e).end(),Re.e("".concat(t," failed. error:"),e),Mn(e)}))}},{key:"_clearFollowList",value:function(e){if(pt(e))return this._myFollowersList.clear(),this._myFollowingList.clear(),void this._myMutualFollowersList.clear();e!==Ms.FOLLOWERS?e!==Ms.FOLLOWING?e!==Ms.MUTUAL||this._myMutualFollowersList.clear():this._myFollowingList.clear():this._myFollowersList.clear()}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._clearFollowList()}}]),Ds),bs=Si((function(e,t){var o="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t,o,a=Array.prototype.slice.call(arguments,1);a.length;){var i=a.shift();if(i){if("object"!==n(i))throw new TypeError(i+"must be non-object");for(var r in i)t=i,o=r,Object.prototype.hasOwnProperty.call(t,o)&&(e[r]=i[r])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var a={arraySet:function(e,t,n,o,a){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+o),a);else for(var i=0;i<o;i++)e[a+i]=t[n+i]},flattenChunks:function(e){for(var t,n,o,a=0,i=0,r=e.length;i<r;i++)a+=e[i].length;for(o=new Uint8Array(a),i=t=0,r=e.length;i<r;i++)n=e[i],o.set(n,t),t+=n.length;return o}},i={arraySet:function(e,t,n,o,a){for(var i=0;i<o;i++)e[a+i]=t[n+i]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,a)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,i))},t.setTyped(o)}));function Ds(e){return o(this,Ds),(e=xr.call(this,e))._n="FollowModule",e._myFollowersList=new Map,e._myFollowingList=new Map,e._myMutualFollowersList=new Map,e.MAX_CATCH_TIME=6e5,e.FIRST_PAGE_INDEX=rt(),e.DEFAULT_COUNT=500,e.MAX_COUNT=1e3,e.getIEmitInst().on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function Ns(e){o(this,Ns),(e=Vr.call(this,e))._n="SignalingModule",e._inviteInfoMap=new Map,e._canIUseSignaling=!1,e._isHandling=!1,e._remoteSignalingHandler=new vs(f(e)),e._localSignalingHandler=new _s(f(e)),e._historySignalingHandler=new ys(f(e)),e._isC2CUnreadHandleCompleted=!1,e._isConvSyncCompleted=!1,e._isSyncCompleted=!1,e._isCloudConfigCompleted=!1;var t=e.getIEmitInst();return t.on(Yo.C2C_UNREAD_HANDLE_COMPLETED,e.onC2CUnreadHandleCompleted,f(e)),t.on(Yo.CONV_SYNC_COMPLETED,e.onConvSyncCompleted,f(e)),t.on(Yo.CLOUD_CONFIG,e.onCloudConfig,f(e)),e}function Rs(e){o(this,Rs),this._n="HistorySignalingHandler",this._sigM=e,this.COUNT=20,this.EXPIRED_TIME=300,this._map=new Map,this._relatedToMeMap=new Map}function Ls(e){o(this,Ls),this._n="LocalSignalingHandler",this._sigM=e}function As(e){o(this,As),this._n="RemoteSignalingHandler",this._sigM=e}function Os(e){o(this,Os),this._m=e,this._n="ErrMsgModule",this.TIM_ERROR_ASSISTANCE="tim_error_assistance",this.STORAGE_EXPIRES_TIME=6048e5,this._map=new Map,this._init()}function Ps(e){o(this,Ps),this._m=e,this._n="TransCmdModule",this._TRTCCommandList=["tui_room_svr.*","callkit_records_svr.*","room_engine_srv.*","room_engine_http_srv.*","room_engine_mic.*","live_engine_srv.*","live_engine_http_srv.*","live_engine_pk.*","trtc_ai_service.*","call_engine_srv.*"],this._TRTCCommandMap=new Map,this._setTRTCCommandMap(),this._m.getIEmitInst().on(Yo.CLOUD_CONFIG,this._onCloudConfig,this)}function Us(e){return o(this,Us),(e=Br.call(this,e))._n="ProfanityFilterModule",e._plugin=null,e._filterConfigMap=new Map,e._startIndex=0,e._version=0,e._canIUseLexicon=!1,e._isFetching=!1,e._expiredTime=0,e}function xs(e){var t;return o(this,xs),(t=Gr.call(this,e))._m=e,t._n="TIMPushModule",t._pluginName="TIMPush",t._pushPlugin=void 0,t._androidPushConfig={},t._deviceToken="",t._businessID=0,t._iOSBusinessID=0,t._c2cUnreadCount=0,t._groupUnreadCount=0,t._isWebUniapp=0,t._deviceInfo={notificationStatus:0,deviceModel:"",systemVersion:"",pushVersion:"1.0.1",packageName:""},t}function Vs(e){var t;return o(this,Vs),(t=Fr.call(this,e))._m=e,t._n="OfflinePushModule",t._offlinePushPlugin=void 0,t._androidPushConfig={huaweiPushBussinessId:"",xiaomiPushBussinessId:"",xiaomiPushAppId:"",xiaomiPushAppKey:"",meizuPushBussinessId:"",meizuPushAppId:"",meizuPushAppKey:"",vivoPushBussinessId:"",fcmPushBussinessId:"",oppoPushBussinessId:"",oppoPushAppKey:"",oppoPushAppSecret:"",honorPushBussinessId:""},t._deviceToken="",t._businessID=0,t._iosBusinessID=0,t._c2cUnreadCount=0,t._groupUnreadCount=0,t._isWebUniapp=0,t}function Bs(e){o(this,Bs),this._m=e,this._n="CommercialConfigModule",this._expiredTime=0,this._isFetching=!1,this._purchasedFeatureHandler=new us(this)}function Gs(e){o(this,Gs),this._commercialConfigM=e,this._n="PurchasedFeatureHandler",this._isCSPluginReported=!1,this._featureMap=new Map}function Fs(e){return o(this,Fs),(e=zr.call(this,e))._n="WorkerTimerModule",e._isWorkerEnabled=!0,e._workerTimer=null,e._timerID=-1,e._init(),e.getIEmitInst().on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function zs(e){return o(this,zs),(e=Hr.call(this,e))._n="SnsModule",e._friendHandler=new is(f(e)),e._friendApplicationHandler=new os(f(e)),e._friendGroupHandler=new ss(f(e)),e.getIEmitInst().on(Yo.A2KEY_AND_TINYID_UPDATED,e.onContextUpdated,f(e)),e}function Hs(e){o(this,Hs),this._snsM=e,this._n="FriendGroupHandler",this._map=new Map}function js(e){o(this,js),He(e)||(this.name=e.name||"",this.userIDList=e.userIDList||[],this.count=this.userIDList.length||0)}function qs(e){o(this,qs),this._snsM=e,this._n="FriendHandler",this._map=new Map,this._startIdx=0,this._standardSeq=0,this._customSeq=0,this._expirationTime=18e4}function Ks(e,n){o(this,Ks),this.userID=e,this.remark="",this.groupList=[],this.source="",this.addTime=0,this.friendCustomField=[],this.timestamp=0;var a={},i=[];if(a.userID=e,!He(n))for(var r,s="",l=0,c=n.length;l<c;l++)if(s=n[l].tag,r=n[l].value,-1<s.indexOf("Tag_SNS_Custom"))this.friendCustomField.push({key:s,value:r});else if(-1<s.indexOf("Tag_Profile_Custom"))i.push({key:s,value:r});else switch(s){case Ae.NICK:a.nick=r;break;case Ae.GENDER:a.gender=r;break;case Ae.BIRTHDAY:a.birthday=r;break;case Ae.LOCATION:a.location=r;break;case Ae.SELFSIGNATURE:a.selfSignature=r;break;case Ae.ALLOWTYPE:a.allowType=r;break;case Ae.LANGUAGE:a.language=r;break;case Ae.AVATAR:a.avatar=r;break;case Ae.MESSAGESETTINGS:a.messageSettings=r;break;case Ae.ADMINFORBIDTYPE:a.adminForbidType=r;break;case Ae.LEVEL:a.level=r;break;case Ae.ROLE:a.role=r;break;case Oe.REMARK:this.remark=r;break;case Oe.ADDTIME:this.addTime=r;break;case Oe.GROUP:this.groupList=JSON.parse(JSON.stringify(r));break;case Oe.ADDSOURCE:this.source=r;break;case Oe.ADDWORDING:break;default:Re.l("snsProfileItem unknown tag->",n[l].tag)}this.profile=new la(t(t({},a),{},{profileCustomField:i}))}function Ys(e){o(this,Ys),this._snsM=e,this._n="FriendApplicationHandler",this._startTime=0,this._maxLimited=100,this._currentSeq=0,this._map=new Map,this._unreadCount=0}function $s(e){o(this,$s),(e=jr.call(this,e))._n="QualityStatModule",e.TAG="im-ssolog-quality-stat",e.reportIndex=0,e.wholePeriod=!1,e._qualityItems=[qn,Kn,Yn,$n,Wn,Zn,Jn,Xn,Qn,eo],e._messageSentItems=[Yn,$n,Wn,Zn,Jn],e._messageReceivedItems=[Xn,Qn,eo],e.REPORT_INTERVAL=120,e.REPORT_SDKAPPID_BLACKLIST=[],e.REPORT_TINYID_WHITELIST=[],e._statInfoArr=[],e._avgRTT=new Xr,e._avgE2EDelay=new Jr,e._rateMessageSent=new Qr,e._rateMessageReceived=new es;var t=e.getIEmitInst();return t.on(Yo.A2KEY_AND_TINYID_UPDATED,e._onLoginSuccess,f(e)),t.on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function Ws(){o(this,Ws),this._lastMap=new Map,this._currentMap=new Map}function Zs(){o(this,Zs),this._map=new Map}function Js(){o(this,Js),this._n="AvgRTT",this._requestCount=0,this._rttArray=[]}function Xs(){o(this,Xs),this._n="AvgE2EDelay",this._e2eDelayArray=[]}function Qs(e){return o(this,Qs),(e=qr.call(this,e))._n="RecoverMsgModule",e.PULL_LIMIT_COUNT=15,e}function el(e){return o(this,el),(e=Kr.call(this,e))._n="CloudControlModule",e._cloudConfig=new Map,e._expiredTime=0,e._version=0,e._isFetching=!1,e}function tl(e){return o(this,tl),(e=Yr.call(this,e))._n="SessionModule",e._platform=e.getPlatform(),e._pHandler=new Cr(f(e)),e._msgDispatcher=new Er(f(e)),e._cmdFreqLimitMap=new Map,e._cmdReqInfoMap=new Map,e._serverOverloadInfoMap=new Map,e._incrementalPullContactFlag=!0,e._init(),e.getIEmitInst().on(Yo.CLOUD_CONFIG,e._onCloudConfig,f(e)),e}function nl(e,t,n,o){for(var a=65535&e,i=e>>>16&65535,r=0;0!==n;){for(n-=r=2e3<n?2e3:n;i=i+(a=a+t[o++]|0)|0,--r;);a%=65521,i%=65521}return a|i<<16}function ol(e,t,n,o){var a=il,i=o+n;e^=-1;for(var r=o;r<i;r++)e=e>>>8^a[255&(e^t[r])];return~e}function al(e,t,n,o,a,i,r,s){var l,c,u,d,p,h,f,g,m,v=s.bits,_=0,y=0,I=0,C=0,k=0,E=0,T=0,S=0,M=0,w=0,b=null,D=0,N=new bs.Buf16(16),R=new bs.Buf16(16),L=null,A=0;for(_=0;_<=15;_++)N[_]=0;for(y=0;y<o;y++)N[t[n+y]]++;for(k=v,C=15;1<=C&&0===N[C];C--);if(C<k&&(k=C),0===C)return a[i++]=20971520,a[i++]=20971520,s.bits=1,0;for(I=1;I<C&&0===N[I];I++);for(k<I&&(k=I),_=S=1;_<=15;_++)if((S=(S<<1)-N[_])<0)return-1;if(0<S&&(0===e||1!==C))return-1;for(R[1]=0,_=1;_<15;_++)R[_+1]=R[_]+N[_];for(y=0;y<o;y++)0!==t[n+y]&&(r[R[t[n+y]]++]=y);if(h=0===e?(b=L=r,19):1===e?(b=rl,D-=257,L=sl,A-=257,256):(b=ll,L=cl,-1),_=I,p=i,T=y=w=0,u=-1,d=(M=1<<(E=k))-1,1===e&&852<M||2===e&&592<M)return 1;for(;;){for(m=r[y]<h?(g=0,r[y]):r[y]>h?(g=L[A+r[y]],b[D+r[y]]):(g=96,0),l=1<<(f=_-T),I=c=1<<E;a[p+(w>>T)+(c-=l)]=f<<24|g<<16|m,0!==c;);for(l=1<<_-1;w&l;)l>>=1;if(w=0!==l?(w&l-1)+l:0,y++,0==--N[_]){if(_===C)break;_=t[n+r[y]]}if(k<_&&(w&d)!==u){for(p+=I,S=1<<(E=_-(T=0===T?k:T));E+T<C&&!((S-=N[E+T])<=0);)E++,S<<=1;if(M+=1<<E,1===e&&852<M||2===e&&592<M)return 1;a[u=w&d]=k<<24|E<<16|p-i}}return 0!==w&&(a[p+w]=_-T<<24|64<<16),s.bits=k,0}bs.assign,bs.shrinkBuf,bs.setTyped,bs.Buf8,bs.Buf16,bs.Buf32;var il=function(){for(var e=[],t=0;t<256;t++){for(var n=t,o=0;o<8;o++)n=1&n?3988292384^n>>>1:n>>>1;e[t]=n}return e}(),rl=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],sl=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],ll=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],cl=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function ul(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function dl(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new bs.Buf16(320),this.work=new bs.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function pl(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=1,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new bs.Buf32(852),t.distcode=t.distdyn=new bs.Buf32(592),t.sane=1,t.back=-1,0):-2}function hl(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,pl(e)):-2}function fl(e,t){var n,o;return e&&e.state?(o=e.state,t<0?(n=0,t=-t):(n=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?-2:(null!==o.window&&o.wbits!==t&&(o.window=null),o.wrap=n,o.wbits=t,hl(e))):-2}function gl(e,t){var n;return e?(n=new dl,(e.state=n).window=null,0!==(n=fl(e,t))&&(e.state=null),n):-2}var ml,vl,_l=!0;function yl(e,t,n,o){var a;return null===(e=e.state).window&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new bs.Buf8(e.wsize)),o>=e.wsize?(bs.arraySet(e.window,t,n-e.wsize,e.wsize,0),e.wnext=0,e.whave=e.wsize):((a=e.wsize-e.wnext)>o&&(a=o),bs.arraySet(e.window,t,n-o,a,e.wnext),(o-=a)?(bs.arraySet(e.window,t,n-o,o,0),e.wnext=o,e.whave=e.wsize):(e.wnext+=a,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=a))),0}var Il={inflateReset:hl,inflateReset2:fl,inflateResetKeep:pl,inflateInit:function(e){return gl(e,15)},inflateInit2:gl,inflate:function(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f,g,m,v,_,y,I,C,k,E,T,S,M=0,w=new bs.Buf8(4),b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return-2;12===(n=e.state).mode&&(n.mode=13),r=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,u=n.bits,d=s,p=l,E=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(2&n.wrap&&35615===c){w[n.check=0]=255&c,w[1]=c>>>8&255,n.check=ol(n.check,w,2,0),u=c=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=30;break}if(8!=(15&c)){e.msg="unknown compression method",n.mode=30;break}if(u-=4,k=8+(15&(c>>>=4)),0===n.wbits)n.wbits=k;else if(k>n.wbits){e.msg="invalid window size",n.mode=30;break}n.dmax=1<<k,e.adler=n.check=1,n.mode=512&c?10:12,u=c=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(n.flags=c,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=30;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=30;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(w[0]=255&c,w[1]=c>>>8&255,n.check=ol(n.check,w,2,0)),u=c=0,n.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&(w[0]=255&c,w[1]=c>>>8&255,w[2]=c>>>16&255,w[3]=c>>>24&255,n.check=ol(n.check,w,4,0)),u=c=0,n.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(w[0]=255&c,w[1]=c>>>8&255,n.check=ol(n.check,w,2,0)),u=c=0,n.mode=5;case 5:if(1024&n.flags){for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(w[0]=255&c,w[1]=c>>>8&255,n.check=ol(n.check,w,2,0)),u=c=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((h=(h=n.length)>s?s:h)&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),bs.arraySet(n.head.extra,o,i,h,k)),512&n.flags&&(n.check=ol(n.check,o,h,i)),s-=h,i+=h,n.length-=h),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break e;for(h=0;k=o[i+h++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k)),k&&h<s;);if(512&n.flags&&(n.check=ol(n.check,o,h,i)),s-=h,i+=h,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break e;for(h=0;k=o[i+h++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k)),k&&h<s;);if(512&n.flags&&(n.check=ol(n.check,o,h,i)),s-=h,i+=h,k)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=30;break}u=c=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=12;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}e.adler=n.check=ul(c),u=c=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,2;e.adler=n.check=1,n.mode=12;case 12:if(5===t||6===t)break e;case 13:if(n.last){c>>>=7&u,u-=7&u,n.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}switch(n.last=1&c,--u,3&(c>>>=1)){case 0:n.mode=14;break;case 1:D=N=void 0;var D,N=n;if(_l){for(ml=new bs.Buf32(512),vl=new bs.Buf32(32),D=0;D<144;)N.lens[D++]=8;for(;D<256;)N.lens[D++]=9;for(;D<280;)N.lens[D++]=7;for(;D<288;)N.lens[D++]=8;for(al(1,N.lens,0,288,ml,0,N.work,{bits:9}),D=0;D<32;)N.lens[D++]=5;al(2,N.lens,0,32,vl,0,N.work,{bits:5}),_l=!1}if(N.lencode=ml,N.lenbits=9,N.distcode=vl,N.distbits=5,n.mode=20,6!==t)break;c>>>=2,u-=2;break e;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=30}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=30;break}if(n.length=65535&c,u=c=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(h=n.length){if(0===(h=l<(h=s<h?s:h)?l:h))break e;bs.arraySet(a,o,i,h,r),s-=h,i+=h,l-=h,r+=h,n.length-=h;break}n.mode=12;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,286<n.nlen||30<n.ndist){e.msg="too many length or distance symbols",n.mode=30;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.lens[b[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[b[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},E=al(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid code lengths set",n.mode=30;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;v=(M=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&M,!((m=M>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(_<16)c>>>=m,u-=m,n.lens[n.have++]=_;else{if(16===_){for(S=m+2;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c>>>=m,u-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=30;break}k=n.lens[n.have-1],h=3+(3&c),c>>>=2,u-=2}else if(17===_){for(S=m+3;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}k=0,h=3+(7&(c>>>=m)),c>>>=3,u=u-m-3}else{for(S=m+7;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}k=0,h=11+(127&(c>>>=m)),c>>>=7,u=u-m-7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=30;break}for(;h--;)n.lens[n.have++]=k}}if(30===n.mode)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=30;break}if(n.lenbits=9,T={bits:n.lenbits},E=al(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid literal/lengths set",n.mode=30;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},E=al(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,E){e.msg="invalid distances set",n.mode=30;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(6<=s&&258<=l){e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,j=F=U=P=O=A=L=R=oe=ne=te=ee=Q=X=J=Z=W=$=Y=K=q=H=z=G=B=void 0;var R,L,A,O,P,U,x=e,V=p,B=x.state,G=x.next_in,F=x.input,z=G+(x.avail_in-5),H=x.next_out,j=x.output,q=H-(V-x.avail_out),K=H+(x.avail_out-257),Y=B.dmax,$=B.wsize,W=B.whave,Z=B.wnext,J=B.window,X=B.hold,Q=B.bits,ee=B.lencode,te=B.distcode,ne=(1<<B.lenbits)-1,oe=(1<<B.distbits)-1;t:do{for(Q<15&&(X+=F[G++]<<Q,Q+=8,X+=F[G++]<<Q,Q+=8),R=ee[X&ne];;){if(X>>>=L=R>>>24,Q-=L,0==(L=R>>>16&255))j[H++]=65535&R;else{if(!(16&L)){if(!(64&L)){R=ee[(65535&R)+(X&(1<<L)-1)];continue}if(32&L){B.mode=12;break t}x.msg="invalid literal/length code",B.mode=30;break t}for(A=65535&R,(L&=15)&&(Q<L&&(X+=F[G++]<<Q,Q+=8),A+=X&(1<<L)-1,X>>>=L,Q-=L),Q<15&&(X+=F[G++]<<Q,Q+=8,X+=F[G++]<<Q,Q+=8),R=te[X&oe];;){if(X>>>=L=R>>>24,Q-=L,!(16&(L=R>>>16&255))){if(!(64&L)){R=te[(65535&R)+(X&(1<<L)-1)];continue}x.msg="invalid distance code",B.mode=30;break t}if(O=65535&R,Q<(L&=15)&&(X+=F[G++]<<Q,(Q+=8)<L&&(X+=F[G++]<<Q,Q+=8)),(O+=X&(1<<L)-1)>Y){x.msg="invalid distance too far back",B.mode=30;break t}if(X>>>=L,Q-=L,O>(L=H-q)){if((L=O-L)>W&&B.sane){x.msg="invalid distance too far back",B.mode=30;break t}if(U=J,(P=0)===Z){if(P+=$-L,L<A){for(A-=L;j[H++]=J[P++],--L;);P=H-O,U=j}}else if(Z<L){if(P+=$+Z-L,(L-=Z)<A){for(A-=L;j[H++]=J[P++],--L;);if(P=0,Z<A){for(A-=L=Z;j[H++]=J[P++],--L;);P=H-O,U=j}}}else if(P+=Z-L,L<A){for(A-=L;j[H++]=J[P++],--L;);P=H-O,U=j}for(;2<A;)j[H++]=U[P++],j[H++]=U[P++],j[H++]=U[P++],A-=3;A&&(j[H++]=U[P++],1<A&&(j[H++]=U[P++]))}else{for(P=H-O;j[H++]=j[P++],j[H++]=j[P++],j[H++]=j[P++],2<(A-=3););A&&(j[H++]=j[P++],1<A&&(j[H++]=j[P++]))}break}}break}}while(G<z&&H<K);G-=A=Q>>3,X&=(1<<(Q-=A<<3))-1,x.next_in=G,x.next_out=H,x.avail_in=G<z?z-G+5:5-(G-z),x.avail_out=H<K?K-H+257:257-(H-K),B.hold=X,B.bits=Q,r=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,u=n.bits,12===n.mode&&(n.back=-1);break}for(n.back=0;v=(M=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&M,!((m=M>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(v&&!(240&v)){for(y=m,I=v,C=_;v=(M=n.lencode[C+((c&(1<<y+I)-1)>>y)])>>>16&255,_=65535&M,!(y+(m=M>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}c>>>=y,u-=y,n.back+=y}if(c>>>=m,u-=m,n.back+=m,n.length=_,0===v){n.mode=26;break}if(32&v){n.back=-1,n.mode=12;break}if(64&v){e.msg="invalid literal/length code",n.mode=30;break}n.extra=15&v,n.mode=22;case 22:if(n.extra){for(S=n.extra;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;v=(M=n.distcode[c&(1<<n.distbits)-1])>>>16&255,_=65535&M,!((m=M>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(!(240&v)){for(y=m,I=v,C=_;v=(M=n.distcode[C+((c&(1<<y+I)-1)>>y)])>>>16&255,_=65535&M,!(y+(m=M>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}c>>>=y,u-=y,n.back+=y}if(c>>>=m,u-=m,n.back+=m,64&v){e.msg="invalid distance code",n.mode=30;break}n.offset=_,n.extra=15&v,n.mode=24;case 24:if(n.extra){for(S=n.extra;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=30;break}n.mode=25;case 25:if(0===l)break e;if(n.offset>(h=p-l)){if((h=n.offset-h)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=30;break}f=h>n.wnext?(h-=n.wnext,n.wsize-h):n.wnext-h,h>n.length&&(h=n.length),g=n.window}else g=a,f=r-n.offset,h=n.length;for(l-=h=l<h?l:h,n.length-=h;a[r++]=g[f++],--h;);0===n.length&&(n.mode=21);break;case 26:if(0===l)break e;a[r++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;u<32;){if(0===s)break e;s--,c|=o[i++]<<u,u+=8}if(p-=l,e.total_out+=p,n.total+=p,p&&(e.adler=n.check=(n.flags?ol:nl)(n.check,a,p,r-p)),p=l,(n.flags?c:ul(c))!==n.check){e.msg="incorrect data check",n.mode=30;break}u=c=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=30;break}u=c=0}n.mode=29;case 29:E=1;break e;case 30:E=-3;break e;case 31:return-4;default:return-2}return e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<30&&(n.mode<27||4!==t))&&yl(e,e.output,e.next_out,p-e.avail_out),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,n.wrap&&p&&(e.adler=n.check=(n.flags?ol:nl)(n.check,a,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(12===n.mode?128:0)+(20===n.mode||15===n.mode?256:0),(0==d&&0===p||4===t)&&0===E?-5:E},inflateEnd:function(e){if(!e||!e.state)return-2;var t=e.state;return t.window&&(t.window=null),e.state=null,0},inflateGetHeader:function(e,t){var n;return e&&e.state&&2&(n=e.state).wrap?((n.head=t).done=!1,0):-2},inflateSetDictionary:function(e,t){var n,o=t.length;return!e||!e.state||0!==(n=e.state).wrap&&11!==n.mode?-2:11===n.mode&&nl(1,t,o,0)!==n.check?-3:yl(e,t,o,o)?(n.mode=31,-4):(n.havedict=1,0)},inflateInfo:"pako inflate (from Nodeca project)"},Cl=!0,kl=!0;try{String.fromCharCode.apply(null,[0])}catch(tc){Cl=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(tc){kl=!1}for(var El=new bs.Buf8(256),Tl=0;Tl<256;Tl++)El[Tl]=252<=Tl?6:248<=Tl?5:240<=Tl?4:224<=Tl?3:192<=Tl?2:1;function Sl(e,t){for(var n,o,a=t||e.length,i=new Array(2*a),r=0,s=0;s<a;)if((n=e[s++])<128)i[r++]=n;else if(4<(o=El[n]))i[r++]=65533,s+=o-1;else{for(n&=2===o?31:3===o?15:7;1<o&&s<a;)n=n<<6|63&e[s++],o--;1<o?i[r++]=65533:n<65536?i[r++]=n:(n-=65536,i[r++]=55296|n>>10&1023,i[r++]=56320|1023&n)}var l=i,c=r;if(c<65534&&(l.subarray&&kl||!l.subarray&&Cl))return String.fromCharCode.apply(null,bs.shrinkBuf(l,c));for(var u="",d=0;d<c;d++)u+=String.fromCharCode(l[d]);return u}function Ml(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function wl(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}El[254]=El[254]=1;var bl={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8},Dl={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Nl=Object.prototype.toString;function Rl(e){if(!(this instanceof Rl))return new Rl(e);this.options=bs.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;if(t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Ml,this.strm.avail_out=0,(e=Il.inflateInit2(this.strm,t.windowBits))!==bl.Z_OK)throw new Error(Dl[e]);if(this.header=new wl,Il.inflateGetHeader(this.strm,this.header),t.dictionary&&("string"==typeof t.dictionary?t.dictionary=function(e){for(var t,n,o,a,i=e.length,r=0,s=0;s<i;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<i&&56320==(64512&(o=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(o-56320),s++),r+=n<128?1:n<2048?2:n<65536?3:4;for(t=new bs.Buf8(r),s=a=0;a<r;s++)55296==(64512&(n=e.charCodeAt(s)))&&s+1<i&&56320==(64512&(o=e.charCodeAt(s+1)))&&(n=65536+(n-55296<<10)+(o-56320),s++),n<128?t[a++]=n:(n<2048?t[a++]=192|n>>>6:(n<65536?t[a++]=224|n>>>12:(t[a++]=240|n>>>18,t[a++]=128|n>>>12&63),t[a++]=128|n>>>6&63),t[a++]=128|63&n);return t}(t.dictionary):"[object ArrayBuffer]"===Nl.call(t.dictionary)&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=Il.inflateSetDictionary(this.strm,t.dictionary))!==bl.Z_OK))throw new Error(Dl[e])}function Ll(e,t){if((t=new Rl(t)).push(e,!0),t.err)throw t.msg||Dl[t.err];return t.result}Rl.prototype.push=function(e,t){var n,o,a,i,r,s=this.strm,l=this.options.chunkSize,c=this.options.dictionary,u=!1;if(this.ended)return!1;o=t===~~t?t:!0===t?bl.Z_FINISH:bl.Z_NO_FLUSH,"string"==typeof e?s.input=function(e){for(var t=new bs.Buf8(e.length),n=0,o=t.length;n<o;n++)t[n]=e.charCodeAt(n);return t}(e):"[object ArrayBuffer]"===Nl.call(e)?s.input=new Uint8Array(e):s.input=e,s.next_in=0,s.avail_in=s.input.length;do{if(0===s.avail_out&&(s.output=new bs.Buf8(l),s.next_out=0,s.avail_out=l),(n=(n=Il.inflate(s,bl.Z_NO_FLUSH))===bl.Z_NEED_DICT&&c?Il.inflateSetDictionary(this.strm,c):n)===bl.Z_BUF_ERROR&&!0===u&&(n=bl.Z_OK,u=!1),n!==bl.Z_STREAM_END&&n!==bl.Z_OK)return this.onEnd(n),!(this.ended=!0);s.next_out&&(0!==s.avail_out&&n!==bl.Z_STREAM_END&&(0!==s.avail_in||o!==bl.Z_FINISH&&o!==bl.Z_SYNC_FLUSH)||("string"===this.options.to?(a=function(e,t){for(var n=(t=(t=t||e.length)>e.length?e.length:t)-1;0<=n&&128==(192&e[n]);)n--;return!(n<0||0===n)&&n+El[e[n]]>t?n:t}(s.output,s.next_out),i=s.next_out-a,r=Sl(s.output,a),s.next_out=i,s.avail_out=l-i,i&&bs.arraySet(s.output,s.output,a,i,0),this.onData(r)):this.onData(bs.shrinkBuf(s.output,s.next_out)))),0===s.avail_in&&0===s.avail_out&&(u=!0)}while((0<s.avail_in||0===s.avail_out)&&n!==bl.Z_STREAM_END);return(o=n===bl.Z_STREAM_END?bl.Z_FINISH:o)===bl.Z_FINISH?(n=Il.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===bl.Z_OK):o!==bl.Z_SYNC_FLUSH||(this.onEnd(bl.Z_OK),!(s.avail_out=0))},Rl.prototype.onData=function(e){this.chunks.push(e)},Rl.prototype.onEnd=function(e){e===bl.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=bs.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},Q={},(0,bs.assign)(Q,{Inflate:Rl,inflate:Ll,inflateRaw:function(e,t){return(t=t||{}).raw=!0,Ll(e,t)},ungzip:Ll},bl);var Al,Ol=Q,Pl=(i(Ql,[{key:"inflate",value:function(e){e=new Uint8Array(e).slice(4);var t,n=Date.now();try{t=Ol.inflate(e,{to:"string"}),this._bLogForInflateOK||(this._bLogForInflateOK=!0,new io("inflateOK").end())}catch(a){return this._bLogForInflateError?void 0:(this._bLogForInflateError=!0,void new io("inflateError").setMessage(a).end())}e=e.length+4;var o=t.length;return Re.d("inflate ok. zipped:".concat(e," unzipped:").concat(o)+" compression ratio:".concat(Math.round(100*(o-e)/o),"% cost:").concat(Date.now()-n)),t}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._bLogForInflateOK=!1,this._bLogForInflateError=!1}}]),Ql),Ul="Message",xl="User",Vl="Group",Bl="GroupMember",Gl=["count"],Fl=["conversationID","timePosition","timePeriod"],zl=["miniBirthday","maxBirthday"],Hl=(r($={},Ul,jn.CS),r($,xl,jn.USER_CS),r($,Vl,jn.GRP_CS),r($,Bl,jn.MBR_CS),$),jl=(s(Xl,Un),Al=g(Xl),i(Xl,[{key:"searchCloudMessages",value:function(e){return this.search(Ul,e)}},{key:"searchCloudUsers",value:function(e){return this.search(xl,e)}},{key:"searchCloudGroups",value:function(e){return this.search(Vl,e)}},{key:"searchCloudGroupMembers",value:function(e){return this.search(Bl,e)}},{key:"search",value:function(e,t){var n=this,o="searchCloud".concat(e,"s"),a="".concat(this._n,".").concat(o);if(!t)return Mn({code:zn.OPTIONS_IS_EMPTY,message:this.getErrMsg(zn.OPTIONS_IS_EMPTY,o)});var i=t.keywordList,r=Je(i),s=t.count;if(t.count&&(s=parseInt(s)),e===Ul&&!r&&!Je(t.senderUserIDList)&&!Je(t.messageTypeList)||e!==Ul&&!r)throw Re.e("[".concat(o,'] Missing required params: "keywordList".')),new Error("Params validate failed.");var l=Date.now(),c=new io(o),u="keywordList:".concat(i," keywordListMatchType:").concat(t.keywordListMatchType," cursor:").concat(t.cursor," count:").concat(s);return Re.l("".concat(a," ").concat(u)),this.req({P:Hl[e],data:this._genParams(e,t)}).then((function(o){var i=(r=o.data).code,r=r.message;if(0!==i)return 60020===(s=i)?s="SearchUnable":e!==Ul&&27003===i?s="SearchParamsError":e!==Ul&&60018===i&&(s="SearchOverLimit"),s=n.getErrMsg(s)||r,r=new Fn({code:i,message:s}),c.setMessage(u).setError(r).end(),Mn(r);n.get(27).isCSPluginEnabled(),r=void 0===(s=(i=o.data).cursor)?"":s;var s=i.totalCount;return i="totalCount:".concat(s," cost:").concat($t(l)),Tn({searchResultList:(Re.l("".concat(a," ok. cursor:").concat(r," ").concat(i)),c.setMessage("".concat(u," ").concat(i)).end(),i=n._genRes(e,t,o.data)),cursor:r,totalCount:s})})).catch((function(e){return c.setMessage(u).setError(e).end(),Mn(e)}))}},{key:"_genParams",value:function(e,t){var n=t.count,o=h(t,Gl);return n&&(o.count=parseInt(n)),e===Ul?this._genMsgParams(o):(n=t.keywordList,t=t.keywordListMatchType,o.keywords=n,o.keywordMatchType="and"===t?1:0,e===xl?this._genUserParams(o):o)}},{key:"_genMsgParams",value:function(e){var t=e.conversationID,n=e.timePosition,o=e.timePeriod;return e=h(e,Fl),pt(t)||(Mt(t)&&(e.account=t.replace(S.CONV_C2C,"")),wt(t)&&(e.groupID=t.replace(S.CONV_GROUP,""))),Ye(o)&&0<o&&(Ye(n)&&0<n?e.startTime=n-o:e.startTime=Te()-o),e.startTime&&e.startTime<0&&(e.startTime=void 0),Ye(n)&&0<n&&(e.endTime=n),e}},{key:"_genUserParams",value:function(e){var t=e.miniBirthday,n=e.maxBirthday;return e=h(e,zl),Ye(t)&&(e.miniBirthday=parseInt(t),Ye(n)||(e.maxBirthday=4294967295)),Ye(n)&&(e.maxBirthday=parseInt(n)),e}},{key:"_genRes",value:function(e,t,n){switch(e){case Ul:return this._genMsgRes(n.searchResult,!t.conversationID);case xl:return this._genUserRes(n.userList);case Vl:return this._genGrpRes(n.groupList);case Bl:return this._genMemberRes(n.groupMemberList);default:return[]}}},{key:"_genMsgRes",value:function(e,t){var n=this.get(11);return Ze(e)&&0!==e.length?e.map((function(e){var o=e.groupID,a=e.userID,i=e.messageCount,r=(e=void 0===(e=e.messageList)?[]:e,{conversationID:a=o?"".concat(S.CONV_GROUP).concat(o):"".concat(S.CONV_C2C).concat(a),messageCount:i,messageList:[]});return t&&1<i||0<(i=e.filter((function(e){return!!e}))).length&&(e=n.onRoamingMessage(i,a,!1),o&&e.reverse(),r.messageList=e,r.messageCount=e.length),r})):[]}},{key:"_genUserRes",value:function(e){var t=this.get(4)._profileHandler;if(!Ze(e))return[];for(var n=[],o=0,a=e.length;o<a;o++){var i=(r=e[o]).userID,r=r.profileItems;"@TLS#NOT_FOUND"!==i&&""!==i&&(i=t._update(i,t._getLatestProfileFromResponse(i,r)).latestProfile,n.push(i))}return n}},{key:"_genGrpRes",value:function(e){if(!Ze(e))return[];for(var t=[],n=0,o=e.length;n<o;n++)e[n]&&e[n].groupID&&t.push(new da(e[n]));return t}},{key:"_genMemberRes",value:function(e){if(!Ze(e))return[];for(var t,n,o,a,i,r,s=new Map,l=0,c=e.length;l<c;l++)e[l]&&e[l].userID&&e[l].groupID&&(n=(t=e[l]).groupID,a=t.name,i=t.type,r=t.avatar,o=t.nick,a={groupID:n,name:a,type:i,avatar:r},i={userID:t.userID,nick:o,nameCard:t.nameCard},s.has(n)?((r=s.get(n)).memberList.push(i),s.set(n,r)):s.set(n,{groupInfo:a,memberList:[i]}));return v(s.values())}}]),Xl),ql=(i(Jl,[{key:"_startTimer",value:function(){var e=this._map.get(24),t=e.isWorkerEnabled();Re.l("".concat(this._n,".startTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.startWorkerTimer():this._startMainThreadTimer()}},{key:"_startMainThreadTimer",value:function(){this._checkTimer<0&&(this._checkTimer=setInterval(this.onCheckTimer.bind(this),1e3)),Re.l("".concat(this._n,"._startMainThreadTimer seed:").concat(this._checkTimer))}},{key:"stopTimer",value:function(){var e=this._map.get(24),t=e.isWorkerEnabled();Re.l("".concat(this._n,".stopTimer isWorkerEnabled:").concat(t," seed:").concat(this._checkTimer)),t?e.stopWorkerTimer():this._stopMainThreadTimer()}},{key:"_stopMainThreadTimer",value:function(){Re.l("".concat(this._n,"._stopMainThreadTimer")),0<this._checkTimer&&(clearInterval(this._checkTimer),this._checkTimer=-1,this._checkCount=0)}},{key:"_stopMainThreadSocket",value:function(){Re.l("".concat(this._n,"._stopMainThreadSocket"));var e=this._map.get(21);e.setIsWorkerEnabled(!0),e.reConnect()}},{key:"_startMainThreadSocket",value:function(){Re.l("".concat(this._n,"._startMainThreadSocket"));var e=this._map.get(21);e.setIsWorkerEnabled(!1),e.reConnect()}},{key:"onWorkerTimerEnabled",value:function(){Re.l("".concat(this._n,".onWorkerTimerEnabled, disable main thread timer and socket")),this._stopMainThreadTimer(),this._stopMainThreadSocket()}},{key:"onWorkerTimerDisabled",value:function(){Re.l("".concat(this._n,".onWorkerTimerDisabled, enable main thread timer and socket")),this._startMainThreadTimer(),this._startMainThreadSocket()}},{key:"onCheckTimer",value:function(){this._checkCount+=1;var e,t=E(this._map);try{for(t.s();!(e=t.n()).done;){var n=m(e.value,2)[1];n.onCheckTimer&&n.onCheckTimer(this._checkCount)}}catch(o){t.e(o)}finally{t.f()}}},{key:"_initReadyList",value:function(){var e=this;this._readyList=[this._map.get(1)],this._readyList.forEach((function(t){t.ready((function(){return e._onModuleReady()}))}))}},{key:"_onModuleReady",value:function(){var e,t,n=!0;this._readyList.forEach((function(e){e.isReady()||(n=!1)})),n&&!this._isReady&&(this._isReady=!0,this._oEmitter.emit(T.SDK_READY),e=Date.now()-this._startLoginTs,Re.w("SDK is ready. cost ".concat(e," ms")),this._startLoginTs=Date.now(),t=this._ssoLogForReady.getStartTs()+Me,this._ssoLogForReady.setMessage(e).start(t).end())}},{key:"login",value:function(){0===this._startLoginTs&&(Ee(),this._startLoginTs=Date.now(),this._startTimer(),this._map.get(15).start(),this._ssoLogForReady=new io("sdkReady"),this._reason=zn.LOGGING_IN)}},{key:"onLoginFailed",value:function(){this._startLoginTs=0}},{key:"getOEmitInst",value:function(){return null===this._oEmitter&&(this._oEmitter=new wi,e=this._oEmitter,Hn=e,this._oEmitter._emit=this._oEmitter.emit,this._oEmitter.emit=function(e,t){var n,o,a=this;this._canIUseSignaling()&&(e===T.MESSAGE_RECEIVED&&this.get(33).onNewMessageList(t),e===T.MESSAGE_MODIFIED&&this.get(33).onMessageModified(t)),e===T.CONVERSATION_LIST_UPDATED||e===T.FRIEND_LIST_UPDATED||e===T.GROUP_LIST_UPDATED||e===T.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?!1!==this._eventThrottling?this._eventThrottleMap.has(e)?(n=Date.now())-(o=this._eventThrottleMap.get(e)).last<=1e3?(-1<o.timeoutID&&clearTimeout(o.timeoutID),o.timeoutID=setTimeout((function(){o.last=Date.now(),a._oEmitter._emit.apply(a._oEmitter,[e,{name:e,data:a._getEventData(e)}])}),1e3)):(o.last=n,this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:this._getEventData(e)}])):(this._eventThrottleMap.set(e,{last:Date.now(),timeoutID:-1}),this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:this._getEventData(e)}])):this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:this._getEventData(e)}]):this._oEmitter._emit.apply(this._oEmitter,[e,{name:e,data:t}])}.bind(this)),this._oEmitter;var e}},{key:"_canIUseSignaling",value:function(){var e=this.get(33);return!!e&&e.canIUseSignaling()}},{key:"_getEventData",value:function(e){return e===T.CONVERSATION_LIST_UPDATED?this._map.get(12).isPartialUpdatedConvs()?this._map.get(11).getPartialUpdatedConvs():this._map.get(11).getLocalConvList():e===T.FRIEND_LIST_UPDATED?this._map.get(8).getLocalFriendList(!1):e===T.GROUP_LIST_UPDATED?this._map.get(7).getLocalGroupList():e===T.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED?this._map.get(11).getTotalUnreadCount():e===T.CONVERSATION_ID_LIST_UPDATED?this._map.get(11).getUpdatedConvIDList():void 0}},{key:"getIEmitInst",value:function(){return null===this._iEmitter&&(this._iEmitter=new wi,this._iEmitter._emit=this._iEmitter.emit,this._iEmitter.emit=function(e,t){e=We(t)&&t.data?[e,{name:e,data:t.data}]:[e,{name:e,data:t}],this._iEmitter._emit.apply(this._iEmitter,e)}.bind(this)),this._iEmitter}},{key:"hasModule",value:function(e){return this._map.has(e)}},{key:"get",value:function(e){return this._map.get(e)}},{key:"canIUseModule",value:function(e){return!this._map.get(12).isUsingChatCore()||this._optionalModuleMap.has(e)}},{key:"canIUseInflate",value:function(){return!!this._map.get(37)}},{key:"isReady",value:function(){return this._isReady}},{key:"isIntl",value:function(){return this.get(12).isIntl()}},{key:"getNotReadyReason",value:function(){return this._reason}},{key:"setNotReadyReason",value:function(e){this._reason=e}},{key:"getErrMsg",value:function(e,t,n){return this._map.get(32).get({key:e,replacement1:t,replacement2:n,isIntl:this.isIntl()})}},{key:"warn",value:function(e,t,n){(e=this.getErrMsg(e,t,n))&&Re.w(e)}},{key:"onError",value:function(e){var t="code:".concat(e.code," message:").concat(e.message);Re.w("Oops! ".concat(t)),new io("error").setMessage(t).setLevel("error").end(),this.getOEmitInst().emit(T.ERROR,e)}},{key:"restartTimer",value:function(){Re.l("".concat(this._n,".restartTimer")),this.stopTimer(),this._startTimer();var e=this.get(7);e&&e.restartPolling()}},{key:"getTimerID",value:function(){var e=this._map.get(24);return e.isWorkerEnabled()?e.getTimerID():this._checkTimer}},{key:"getPollingTimerID",value:function(e){return this._map.get(7).getPollingTimerID(e)}},{key:"statTUIKeyFeatures",value:function(e){var t=e.code,n=t+(e=void 0===(e=e.msg)?"":e);this._codeMsgForTUIMap.has(n)||(this._codeMsgForTUIMap.set(n,1),n=this.get(12).getUIPlatform(),new io("tui_key_features").setCode(t).setMessage(e).setUIPlatform(n).end())}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),Ee();var e,t=E(this._map);try{for(t.s();!(e=t.n()).done;){var n=m(e.value,2)[1];n.reset&&n.reset()}}catch(r){t.e(r)}finally{t.f()}this._startLoginTs=0,this._initReadyList(),this._isReady=!1,this.stopTimer(),this._oEmitter.emit(T.SDK_NOT_READY);var o,a=E(this._eventThrottleMap);try{for(a.s();!(o=a.n()).done;){var i=m(o.value,2)[1];-1<i.timeoutID&&clearTimeout(i.timeoutID)}}catch(r){a.e(r)}finally{a.f()}this._eventThrottleMap.clear(),this._codeMsgForTUIMap.clear()}}]),Jl),Kl=(i(Zl,[{key:"defense",value:function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0;if("string"!=typeof e)return null;if(0===e.length)return null;if("function"!=typeof t)return null;if(this._funcMap.has(e)&&this._funcMap.get(e).has(t))return this._funcMap.get(e).get(t);this._funcMap.has(e)||this._funcMap.set(e,new Map);var o=null;return this._funcMap.get(e).has(t)?o=this._funcMap.get(e).get(t):(o=this._pack(e,t,n),this._funcMap.get(e).set(t,o)),o}},{key:"defenseOnce",value:function(e,t){return"function"!=typeof t?null:this._pack(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:void 0)}},{key:"find",value:function(e,t){return"string"!=typeof e||0===e.length||"function"!=typeof t?null:this._funcMap.has(e)&&this._funcMap.get(e).has(t)?this._funcMap.get(e).get(t):(this._m.warn("ListenerFnNotFound",e),null)}},{key:"delete",value:function(e,t){return"function"==typeof t&&!!this._funcMap.has(e)&&!!this._funcMap.get(e).has(t)&&(this._funcMap.get(e).delete(t),0===this._funcMap.get(e).size&&this._funcMap.delete(e),!0)}},{key:"_pack",value:function(e,t,n){var o=this;return function(){try{t.apply(n,Array.from(arguments))}catch(r){var a=Object.values(T).indexOf(e),i="CallbackError";-1!==a&&(a=Object.keys(T)[a],o._m.warn(i,a,r)),o._reportCount<5&&(new io(i).setMessage("eventName:".concat(e)).setMoreMessage(r.message).end(),o._reportCount+=1)}}}},{key:"destroy",value:function(){this._funcMap.clear()}},{key:"reset",value:function(){Re.l("".concat(this._n,".reset")),this._reportCount=0}}]),Zl),Yl=(i(Wl,[{key:"onError",value:function(e){this._m.onError(e)}},{key:"login",value:function(e){return this._m.login(),this._get(1).login(e)}},{key:"logout",value:function(){var e=this;return this._get(1).logout().then((function(t){return e._safetyCallbackFactory.reset(),e._m.reset(),t}))}},{key:"getLoginUser",value:function(){return this._get(1).getLoginUser()}},{key:"getServerTime",value:function(){return we()}},{key:"isReady",value:function(){return this._m.isReady()}},{key:"isIntl",value:function(){return this._m.isIntl()}},{key:"getNotReadyReason",value:function(){return this._m.getNotReadyReason()}},{key:"getErrMsg",value:function(e,t,n){return this._m.getErrMsg(e,t,n)}},{key:"_get",value:function(e){return this._m.get(e)}},{key:"destroy",value:function(){var e=this,t=this._get(12),n=t.getSDKAppID();return Re.w("destroy ".concat(n," ").concat(t.getInstanceID())),this.logout().finally((function(){e._safetyCallbackFactory.destroy(),e._m.stopTimer(),e._get(24).terminate(),e._get(21).dealloc(),e._m.getOEmitInst().emit(T.SDK_DESTROY,{SDKAppID:n})}))}},{key:"on",value:function(e,t,n){Re.d("on","eventName:".concat(e)),this._m.getOEmitInst().on(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"once",value:function(e,t,n){Re.d("once","eventName:".concat(e)),this._m.getOEmitInst().once(e,this._safetyCallbackFactory.defenseOnce(e,t,n),n||this)}},{key:"off",value:function(e,t,n,o){Re.d("off","eventName:".concat(e));var a=this._safetyCallbackFactory.find(e,t);null!==a&&(this._m.getOEmitInst().off(e,a,n,o),this._safetyCallbackFactory.delete(e,t))}},{key:"registerPlugin",value:function(e){(pt(e["tim-push"])?pt(e["tim-offline-push-plugin"])?this._get(18):this._get(28):this._get(36)).registerPlugin(e)}},{key:"setLogLevel",value:function(e){e<=0&&(this.getErrMsg("TIM_ASCII_ART"),this.getErrMsg("API_REFER")&&jt(),this.getErrMsg("DOCS_GUIDE"),this.getErrMsg("IOS_WEBVIEW_WARNING")),Re.setLevel(e)}},{key:"createTextMessage",value:function(e){return this._get(2).createTextMessage(e)}},{key:"createTextAtMessage",value:function(e){return this._get(2).createTextMessage(e)}},{key:"createImageMessage",value:function(e){return this._get(2).createImageMessage(e)}},{key:"createAudioMessage",value:function(e){return this._get(2).createAudioMessage(e)}},{key:"createVideoMessage",value:function(e){return this._get(2).createVideoMessage(e)}},{key:"createCustomMessage",value:function(e){return this._get(2).createCustomMessage(e)}},{key:"createFaceMessage",value:function(e){return this._get(2).createFaceMessage(e)}},{key:"createFileMessage",value:function(e){return this._get(2).createFileMessage(e)}},{key:"createLocationMessage",value:function(e){return this._get(2).createLocationMessage(e)}},{key:"createMergerMessage",value:function(e){return this._get(2).createMergerMessage(e)}},{key:"downloadMergerMessage",value:function(e){return e.type!==S.MSG_MERGER?Mn({code:zn.MSG_MERGER_TYPE_INVALID}):He(e.payload.downloadKey)?Mn({code:zn.MSG_MERGER_KEY_INVALID}):this._get(2).downloadMergerMessage(e).catch((function(e){return Mn({code:zn.MSG_MERGER_DOWNLOAD_FAIL})}))}},{key:"createForwardMessage",value:function(e){return this._get(2).createForwardMessage(e)}},{key:"sendMessage",value:function(e,t){return e instanceof No?this._get(2).sendMessageInstance(e,t):Mn({code:zn.MSG_INSTANCE_REQUIRED})}},{key:"callExperimentalAPI",value:function(e,t){return"sendComboMessage"===e?this._get(31).sendMessage(t):"handleGroupInvitation"===e?this._get(7).handleGroupInvitation(t):"isCommercialAbilityEnabled"===e?this._get(27).isFeatureEnabled(t):"isFeatureEnabledForStat"===e?this._get(27).isFeatureEnabledForStat(t):"isIntl"===e?this.isIntl():"sendTRTCCustomData"===e||"sendRoomCustomData"===e?this._get(30).sendTRTCCustomData(t):"getTimerID"===e?this._m.getTimerID():"getPollingTimerID"===e?this._m.getPollingTimerID(t):"setApplicationID"===e?(this._get(12).setApplicationID(t),void this._get(20).updateProtocolConfig()):"getServerConfig"===e?this._get(23).getServerConfig(t):"canIUseModule"===e?this._m.canIUseModule(t):"startMessageLongPolling"===e?this._get(7).startMessageLongPolling(t):"stopMessageLongPolling"===e?this._get(7).stopMessageLongPolling(t):"disableMessagePullOnInvite"===e?this._get(11).disableMsgPullOnInvite(t):"clearLocalMessage"===e?this._get(11).clearMemMsg(t,!1):"setCustomLoginInfo"===e?this._get(12).setCustomLoginInfo(t):"statTUIKeyFeatures"===e?this._m.statTUIKeyFeatures(t):Mn({code:zn.INVALID_OPERATION})}},{key:"revokeMessage",value:function(e){return this._get(2).revokeMessage(e)}},{key:"resendMessage",value:function(e,t){return e instanceof No?this._get(2).resendMessage(e,t):Mn({code:zn.MSG_INSTANCE_REQUIRED})}},{key:"deleteMessage",value:function(e){return this._get(2).deleteMessage(e)}},{key:"translateText",value:function(e){return this._get(2).translateText(e)}},{key:"convertVoiceToText",value:function(e){return this._get(2).convertVoiceToText(e)}},{key:"setMessageExtensions",value:function(e,t){return this._get(3).setMessageExtensions(e,t)}},{key:"getMessageExtensions",value:function(e){return this._get(3).getMessageExtensions(e)}},{key:"deleteMessageExtensions",value:function(e,t){return this._get(3).deleteMessageExtensions(e,t)}},{key:"addMessageReaction",value:function(e,t){return this._get(34).addMessageReaction(e,t)}},{key:"removeMessageReaction",value:function(e,t){return this._get(34).removeMessageReaction(e,t)}},{key:"getMessageReactions",value:function(e){return this._get(34).getMessageReactions(e)}},{key:"getAllUserListOfMessageReaction",value:function(e){return this._get(34).getAllUserListOfMessageReaction(e)}},{key:"modifyMessage",value:function(e){return this._get(2).modifyRemoteMessage(e)}},{key:"getMessageList",value:function(e){return this._get(11).getMessageList(e)}},{key:"getMessageListHopping",value:function(e){return this._get(11).getMessageListHopping(e)}},{key:"sendMessageReadReceipt",value:function(e){return this._get(11).sendReadReceipt(e)}},{key:"getMessageReadReceiptList",value:function(e){return this._get(11).getReadReceiptList(e)}},{key:"getGroupMessageReadMemberList",value:function(e){var t=this._get(7);return t?t.getReadReceiptDetail(e):Mn({code:zn.NO_MODULE})}},{key:"findMessage",value:function(e){return this._get(11).findMessage(e)}},{key:"setMessageRead",value:function(e){return this._get(11).setMessageRead(e)}},{key:"getConversationList",value:function(e){return this._get(11).getConvList(e)}},{key:"getConversationProfile",value:function(e){return this._get(11).getConversationProfile(e)}},{key:"deleteConversation",value:function(e){return this._get(11).deleteConversation(e)}},{key:"setConversationDraft",value:function(e){return this._get(11).setConvDraft(e)}},{key:"clearHistoryMessage",value:function(e){return this._get(11).clearHistoryMessage(e)}},{key:"pinConversation",value:function(e){return this._get(11).pinConversation(e)}},{key:"setAllMessageRead",value:function(e){return this._get(11).setAllMessageRead(e)}},{key:"setMessageRemindType",value:function(e){return this._get(11).setMessageRemindType(e)}},{key:"setAllReceiveMessageOpt",value:function(e){return this._get(11).setAllRcvMsgOpt(e)}},{key:"getAllReceiveMessageOpt",value:function(){return this._get(11).getAllRcvMsgOpt()}},{key:"getTotalUnreadMessageCount",value:function(){return this._get(11).getTotalUnreadCount()}},{key:"setConversationCustomData",value:function(e){return this._get(11).setConvCustomData(e)}},{key:"markConversation",value:function(e){return this._get(11).markConv(e)}},{key:"getConversationGroupList",value:function(){return this._get(11).getConvGroupList()}},{key:"createConversationGroup",value:function(e){return this._get(11).createConvGroup(e)}},{key:"deleteConversationGroup",value:function(e){return this._get(11).deleteConvGroup(e)}},{key:"renameConversationGroup",value:function(e){return this._get(11).renameConvGroup(e)}},{key:"addConversationsToGroup",value:function(e){return this._get(11).addConvsToGroup(e)}},{key:"deleteConversationsFromGroup",value:function(e){return this._get(11).deleteConvsFromGroup(e)}},{key:"searchCloudMessages",value:function(e){var t=this._get(38);return t?t.searchCloudMessages(e):Mn({code:zn.NO_MODULE})}},{key:"searchCloudUsers",value:function(e){var t=this._get(38);return t?t.searchCloudUsers(e):Mn({code:zn.NO_MODULE})}},{key:"searchCloudGroups",value:function(e){var t=this._get(38);return t?t.searchCloudGroups(e):Mn({code:zn.NO_MODULE})}},{key:"searchCloudGroupMembers",value:function(e){var t=this._get(38);return t?t.searchCloudGroupMembers(e):Mn({code:zn.NO_MODULE})}},{key:"getMyProfile",value:function(){return this._get(4).getMyProfile()}},{key:"getUserProfile",value:function(e){return this._get(4).getUserProfile(e)}},{key:"updateMyProfile",value:function(e){return this._get(4).updateMyProfile(e)}},{key:"getBlacklist",value:function(){return this._get(4).getLocalBlacklist()}},{key:"addToBlacklist",value:function(e){return this._get(4).addBlacklist(e)}},{key:"removeFromBlacklist",value:function(e){return this._get(4).deleteBlacklist(e)}},{key:"setSelfStatus",value:function(e){return this._get(4).setSelfStatus(e)}},{key:"getUserStatus",value:function(e){return this._get(4).getUserStatus(e)}},{key:"subscribeUserStatus",value:function(e){return this._get(4).subscribeUserStatus(e)}},{key:"unsubscribeUserStatus",value:function(e){return this._get(4).unsubscribeUserStatus(e)}},{key:"getFriendList",value:function(){var e=this._get(8);return e?e.getLocalFriendList():Mn({code:zn.NO_MODULE})}},{key:"addFriend",value:function(e){var t=this._get(8);return t?t.addFriend(e):Mn({code:zn.NO_MODULE})}},{key:"deleteFriend",value:function(e){var t=this._get(8);return t?t.deleteFriend(e):Mn({code:zn.NO_MODULE})}},{key:"checkFriend",value:function(e){var t=this._get(8);return t?t.checkFriend(e):Mn({code:zn.NO_MODULE})}},{key:"getFriendProfile",value:function(e){var t=this._get(8);return t?t.getFriendProfile(e):Mn({code:zn.NO_MODULE})}},{key:"updateFriend",value:function(e){var t=this._get(8);return t?t.updateFriend(e):Mn({code:zn.NO_MODULE})}},{key:"getFriendApplicationList",value:function(){var e=this._get(8);return e?e.getLocalFriendApplicationList():Mn({code:zn.NO_MODULE})}},{key:"acceptFriendApplication",value:function(e){var t=this._get(8);return t?t.acceptFriendApplication(e):Mn({code:zn.NO_MODULE})}},{key:"refuseFriendApplication",value:function(e){var t=this._get(8);return t?t.refuseFriendApplication(e):Mn({code:zn.NO_MODULE})}},{key:"deleteFriendApplication",value:function(e){var t=this._get(8);return t?t.deleteFriendApplication(e):Mn({code:zn.NO_MODULE})}},{key:"setFriendApplicationRead",value:function(){var e=this._get(8);return e?e.setFriendApplicationRead():Mn({code:zn.NO_MODULE})}},{key:"getFriendGroupList",value:function(){var e=this._get(8);return e?e.getLocalFriendGroupList():Mn({code:zn.NO_MODULE})}},{key:"createFriendGroup",value:function(e){var t=this._get(8);return t?t.createFriendGroup(e):Mn({code:zn.NO_MODULE})}},{key:"deleteFriendGroup",value:function(e){var t=this._get(8);return t?t.deleteFriendGroup(e):Mn({code:zn.NO_MODULE})}},{key:"addToFriendGroup",value:function(e){var t=this._get(8);return t?t.addToFriendGroup(e):Mn({code:zn.NO_MODULE})}},{key:"removeFromFriendGroup",value:function(e){var t=this._get(8);return t?t.removeFromFriendGroup(e):Mn({code:zn.NO_MODULE})}},{key:"renameFriendGroup",value:function(e){var t=this._get(8);return t?t.renameFriendGroup(e):Mn({code:zn.NO_MODULE})}},{key:"followUser",value:function(e){var t=this._get(35);return t?t.followUser(e):Mn({code:zn.NO_MODULE})}},{key:"unfollowUser",value:function(e){var t=this._get(35);return t?t.unfollowUser(e):Mn({code:zn.NO_MODULE})}},{key:"getMyFollowersList",value:function(e){var t=this._get(35);return t?t.getMyFollowersList(e):Mn({code:zn.NO_MODULE})}},{key:"getMyFollowingList",value:function(e){var t=this._get(35);return t?t.getMyFollowingList(e):Mn({code:zn.NO_MODULE})}},{key:"getMutualFollowersList",value:function(e){var t=this._get(35);return t?t.getMutualFollowersList(e):Mn({code:zn.NO_MODULE})}},{key:"getUserFollowInfo",value:function(e){var t=this._get(35);return t?t.getUserFollowInfo(e):Mn({code:zn.NO_MODULE})}},{key:"checkFollowType",value:function(e){var t=this._get(35);return t?t.checkFollowType(e):Mn({code:zn.NO_MODULE})}},{key:"getGroupList",value:function(){var e=this._get(7);return e?e.getGroupList():Mn({code:zn.NO_MODULE})}},{key:"getGroupProfile",value:function(e){var t=this._get(7);return t?t.getGroupProfile(e):Mn({code:zn.NO_MODULE})}},{key:"createGroup",value:function(e){var t=this._get(7);return t?t.createGroup(e):Mn({code:zn.NO_MODULE})}},{key:"dismissGroup",value:function(e){var t=this._get(7);return t?t.dismissGroup(e):Mn({code:zn.NO_MODULE})}},{key:"updateGroupProfile",value:function(e){var t=this._get(7);return t?t.updateGroupProfile(e):Mn({code:zn.NO_MODULE})}},{key:"joinGroup",value:function(e){var t=this._get(7);return t?t.joinGroup(e):Mn({code:zn.NO_MODULE})}},{key:"quitGroup",value:function(e){var t=this._get(7);return t?t.quitGroup(e):Mn({code:zn.NO_MODULE})}},{key:"searchGroupByID",value:function(e){var t=this._get(7);return t?t.searchGroupByID(e):Mn({code:zn.NO_MODULE})}},{key:"getGroupOnlineMemberCount",value:function(e){var t=this._get(7);return t?t.getGroupOnlineMemberCount(e):Mn({code:zn.NO_MODULE})}},{key:"changeGroupOwner",value:function(e){var t=this._get(7);return t?t.changeGroupOwner(e):Mn({code:zn.NO_MODULE})}},{key:"getGroupApplicationList",value:function(){var e=this._get(7);return e?e.getGroupApplicationList():Mn({code:zn.NO_MODULE})}},{key:"handleGroupApplication",value:function(e){var t=this._get(7);return t?t.handleGroupApplication(e):Mn({code:zn.NO_MODULE})}},{key:"initGroupAttributes",value:function(e){var t=this._get(7);return t?t.initGroupAttributes(e):Mn({code:zn.NO_MODULE})}},{key:"setGroupAttributes",value:function(e){var t=this._get(7);return t?t.setGroupAttributes(e):Mn({code:zn.NO_MODULE})}},{key:"deleteGroupAttributes",value:function(e){var t=this._get(7);return t?t.deleteGroupAttributes(e):Mn({code:zn.NO_MODULE})}},{key:"getGroupAttributes",value:function(e){var t=this._get(7);return t?t.getGroupAttributes(e):Mn({code:zn.NO_MODULE})}},{key:"setGroupCounters",value:function(e){var t=this._get(7);return t?t.setGroupCounters(e):Mn({code:zn.NO_MODULE})}},{key:"increaseGroupCounter",value:function(e){var t=this._get(7);return t?t.increaseGroupCounter(e):Mn({code:zn.NO_MODULE})}},{key:"decreaseGroupCounter",value:function(e){var t=this._get(7);return t?t.decreaseGroupCounter(e):Mn({code:zn.NO_MODULE})}},{key:"getGroupCounters",value:function(e){var t=this._get(7);return t?t.getGroupCounters(e):Mn({code:zn.NO_MODULE})}},{key:"getGroupMemberList",value:function(e){var t=this._get(7);return t?t.getGroupMemberList(e):Mn({code:zn.NO_MODULE})}},{key:"getGroupMemberProfile",value:function(e){var t=this._get(7);return t?t.getGroupMemberProfile(e):Mn({code:zn.NO_MODULE})}},{key:"addGroupMember",value:function(e){var t=this._get(7);return t?t.addGroupMember(e):Mn({code:zn.NO_MODULE})}},{key:"deleteGroupMember",value:function(e){var t=this._get(7);return t?t.deleteGroupMember(e):Mn({code:zn.NO_MODULE})}},{key:"setGroupMemberMuteTime",value:function(e){var t=this._get(7);return t?t.setGroupMemberMuteTime(e):Mn({code:zn.NO_MODULE})}},{key:"setGroupMemberRole",value:function(e){var t=this._get(7);return t?t.setGroupMemberRole(e):Mn({code:zn.NO_MODULE})}},{key:"setGroupMemberNameCard",value:function(e){var t=this._get(7);return t?t.setGroupMemberNameCard(e):Mn({code:zn.NO_MODULE})}},{key:"setGroupMemberCustomField",value:function(e){var t=this._get(7);return t?t.setGroupMemberCustomField(e):Mn({code:zn.NO_MODULE})}},{key:"markGroupMemberList",value:function(e){var t=this._get(7);return t?t.markGroupMemberList(e):Mn({code:zn.NO_MODULE})}},{key:"getJoinedCommunityList",value:function(){return this._get(10).getJoinedCommunityList()}},{key:"createTopicInCommunity",value:function(e){return this._get(10).createTopicInCommunity(e)}},{key:"deleteTopicFromCommunity",value:function(e){return this._get(10).deleteTopicFromCommunity(e)}},{key:"updateTopicProfile",value:function(e){return this._get(10).updateTopicProfile(e)}},{key:"getTopicList",value:function(e){return this._get(10).getTopicList(e)}},{key:"addSignalingListener",value:function(e,t,n){var o=this._get(33);o&&o.addSignalingListener(e,this._safetyCallbackFactory.defense(e,t,n),n)}},{key:"removeSignalingListener",value:function(e,t,n){var o,a=this._safetyCallbackFactory.find(e,t);null===a||(o=this._get(33))&&(o.removeSignalingListener(e,a,n),this._safetyCallbackFactory.delete(e,t))}},{key:"invite",value:function(e){var t=this._get(33);return t?t.invite(e):Mn({code:zn.NO_MODULE})}},{key:"inviteSync",value:function(e,t,n){var o=this._get(33);return o?o.inviteSync(e,t,n):""}},{key:"inviteInGroup",value:function(e){var t=this._get(33);return t?t.invite(e):Mn({code:zn.NO_MODULE})}},{key:"inviteInGroupSync",value:function(e,t,n){var o=this._get(33);return o?o.inviteSync(e,t,n):""}},{key:"cancel",value:function(e){var t=this._get(33);return t?t.cancel(e):Mn({code:zn.NO_MODULE})}},{key:"accept",value:function(e){var t=this._get(33);return t?t.accept(e):Mn({code:zn.NO_MODULE})}},{key:"reject",value:function(e){var t=this._get(33);return t?t.reject(e):Mn({code:zn.NO_MODULE})}},{key:"getSignalingInfo",value:function(e){var t=this._get(33);return t?t.getSignalingInfo(e):null}},{key:"modifyInvitation",value:function(e){var t=this._get(33);return t?t.modifyInvitation(e):Mn({code:zn.NO_MODULE})}}]),Wl),$l={login:1,logout:1,getLoginUser:1,destroy:1,on:1,off:1,ready:1,setLogLevel:1,joinGroup:1,quitGroup:1,registerPlugin:1,getGroupOnlineMemberCount:1,isReady:1,addSignalingListener:1,removeSignalingListener:1,callExperimentalAPI:1};function Wl(e){o(this,Wl),e={SDKAppID:e.SDKAppID,unlimitedAVChatRoom:e.unlimitedAVChatRoom||!1,scene:e.scene||"",oversea:e.oversea||!1,instanceID:Rt(),devMode:e.devMode||!1,testEnv:e.testEnv||!1,proxyServer:e.proxyServer||void 0,fileUploadProxy:e.fileUploadProxy||void 0,fileDownloadProxy:e.fileDownloadProxy||e.fileUploadProxy||void 0,eventThrottling:!1!==e.eventThrottling,partialUpdatedConversations:!0===e.partialUpdatedConversations,disableIndependentDomain:!0===e.disableIndependentDomain,modules:e.modules||void 0},this._m=new ql(e),this._safetyCallbackFactory=new Kl(this._m)}function Zl(e){o(this,Zl),this._funcMap=new Map,this._m=e,this._n="SafetyCallback",this._reportCount=0}function Jl(e){var t=this;o(this,Jl);var n,a=new io("sdkConstruct"),i=(this._n="ModuleManager",this._isReady=!1,this._reason=zn.USER_NOT_LOGGED_IN,this._startLoginTs=0,this._map=new Map,this._optionalModuleMap=new Map,this._codeMsgForTUIMap=new Map,this._iEmitter=null,this._oEmitter=null,this._checkCount=0,this._checkTimer=-1,this._map.set(12,new Va(this,e)),this._map.set(37,new Pl(this)),this._map.set(15,new Ii(this)),this._map.set(27,new ds(this)),this._map.set(23,new Wr(this)),this._map.set(24,new cs(this)),this._map.set(26,new ts(this)),this._map.set(21,new _r(this)),this._map.set(20,new $r(this)),this._map.set(1,new Ga(this)),this._map.set(2,new ji(this)),this._map.set(3,new qi(this)),this._map.set(34,new Ki(this)),this._map.set(31,new Yi(this)),this._map.set(4,new xa(this)),this._map.set(6,new Ko(this)),this._map.set(11,new ma(this)),this._map.set(7,new Da(this)),this._map.set(10,new La(this)),this._map.set(13,new gi(this)),this._map.set(32,new ms(this)),this._map.set(14,new vi(this)),this._map.set(17,new Ni(this)),this._map.set(18,new $i(this)),this._map.set(19,new Wi(this)),this._map.set(25,new Zr(this)),this._map.set(8,new ls(this)),this._map.set(28,new ps(this)),this._map.set(36,new hs(this)),this._map.set(29,new fs(this)),this._map.set(30,new gs(this)),this._map.set(33,new Es(this)),this._map.set(35,new ws(this)),this._map.set(38,new jl(this)),this._eventThrottleMap=new Map,this._eventThrottling=e.eventThrottling,this._map.get(12).isPartialUpdatedConvs()&&(this._eventThrottling=!1),We(e.modules)?(Object.keys(e.modules).forEach((function(o){n=e.modules[o],"group-module"===o?t._map.set(7,new n(t)):"relationship-module"===o?t._map.set(8,new n(t)):"signaling-module"===o?t._map.set(33,new n(t)):"follow-module"===o?t._map.set(35,new n(t)):"cloud-search-module"===o&&t._map.set(38,new n(t)),t._optionalModuleMap.set(o,1)})),this._map.get(12).setUsingChatCore(!0)):this._map.has(7)||this._map.get(12).setUsingChatCore(!0),e.instanceID),r=e.SDKAppID,s=this._map.get(12).isIntl(),l=this._map.get(12).isUsingChatCore();i="instanceID:".concat(i," SDKAppID:").concat(r," isIntl:").concat(s," isUsingChatCore:").concat(l," host:").concat(Lt())+" isIOSWebView:".concat(ve," platform:").concat(ae," canIUseInflate:").concat(this.canIUseInflate())+" workerAvailable:".concat(fe," eventThrottling:").concat(this._eventThrottling," UserAgent:").concat(oe),io.bindEventStatModule(this._map.get(14)),io.bindNetMonitorModule(this._map.get(15)),a.setMessage("".concat(i," ").concat(function(){var e="";if(X)try{var t=ne.getSystemInfoSync(),n=t.model,o=t.version,a=t.system,i=t.platform,r=t.SDKVersion;e="model:".concat(n," version:").concat(o," system:").concat(a," platform:").concat(i," SDKVersion:").concat(r)}catch(s){e=""}return e}())).end(),Re.i("SDK ".concat(i)),Fn.prototype._getErrMsg=this.getErrMsg.bind(this),this._readyList=void 0,this._ssoLogForReady=null,this._initReadyList()}function Xl(e){return o(this,Xl),(e=Al.call(this,e))._n="CSModule",e}function Ql(e){o(this,Ql),this._m=e,this._n="InflateModule",this._bLogForInflateOK=!1,this._bLogForInflateError=!1}var ec={};return(Z={}).create=function(e){var n,o,a,i="TencentCloudChat.create",r=0;if(Ye(a=e.SDKAppID))r=a;else if(r=parseInt(a),isNaN(a))return Re.e("".concat(i," failed. Failed to parse the SDKAppID, please check the arguments")),null;return r&&ec[r]?ec[r]:(Re.l("".concat(i)),(a=new Yl(t(t({},e),{},{SDKAppID:r}))).on(T.SDK_DESTROY,(function(e){ec[e.data.SDKAppID]=null,delete ec[e.data.SDKAppID]})),n=a,o=Object.create(null),Object.keys(Gn).forEach((function(e){var t;n[e]&&(t=new w,o[e]=function(){var o=Array.from(arguments);return t.use((function(t,o){var a=function(e,t){if(e.isReady()||1===$l[t])return!0;var n={code:n=e.getNotReadyReason(),message:"".concat(e.getErrMsg(n)," | ").concat(t," | ").concat(e.getErrMsg(zn.SDK_IS_NOT_READY))};return e.onError(n),n}(n,e);return!0===a?o():Mn(a)})).use((function(t,n){if(!0===function(e,t,n){if(void 0===t)return!0;var o=!0;if(We(t))Object.keys(t).forEach((function(a){var i=1===e.length?e[0][a]:void 0;o=!!Zt(i,t[a],n,a)&&o}));else if(Ze(t))for(var a=0;a<t.length;a++)o=!!Zt(e[a],t[a],n,t[a].name)&&o;if(o)return o;throw new Error("Params validate failed.")}(t,Bn[e],e))return n()})).use((function(t,o){return n[e].apply(n,t)})),t.run(o)})})),e=o,ec[r]=e,Bn.hookGetAPITips(a.getErrMsg.bind(a)),Re.l("".concat(i," ok")),e)},Z.TYPES=S,Z.EVENT=T,Z.TSignaling=M,Z.VERSION="3.5.2",Re.l("TencentCloudChat.VERSION:".concat(Z.VERSION)),Z}();const qe=He(je.exports);var Ke={exports:{}};!function(e){e.exports=function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function t(t){for(var n=1;n<arguments.length;n++){var o=null!=arguments[n]?arguments[n]:{};n%2?e(Object(o),!0).forEach((function(e){r(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function i(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if(null==e)return{};var n,o,a=function(e,t){if(null==e)return{};var n,o,a={},i=Object.keys(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)n=i[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var l=void 0!==ze?ze:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},c="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),u="undefined"!=typeof qq&&"function"==typeof qq.getSystemInfoSync&&Boolean(qq.getSystemInfoSync().fontSizeSetting),d="undefined"!=typeof tt&&"function"==typeof tt.getSystemInfoSync&&Boolean(tt.getSystemInfoSync().fontSizeSetting),p="undefined"!=typeof swan&&"function"==typeof swan.getSystemInfoSync&&Boolean(swan.getSystemInfoSync().fontSizeSetting),h="undefined"!=typeof my&&"function"==typeof my.getSystemInfoSync&&Boolean(my.getSystemInfoSync().fontSizeSetting),f="undefined"!=typeof uni&&"undefined"==typeof window&&!0,g=f&&"ios"===uni.getDeviceInfo().platform.toLocaleLowerCase(),m=(f&&uni.getDeviceInfo().platform.toLocaleLowerCase(),c||u||d||p||h||f),v=void 0!==l&&(void 0!==l.nativeModuleProxy||void 0!==l.ReactNative),_=u?qq:d?tt:p?swan:h?my:c?wx:f?uni:{},y=function(e){if("object"!==n(e)||null===e)return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var o=t;null!==Object.getPrototypeOf(o);)o=Object.getPrototypeOf(o);return t===o};function I(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(y(e)){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1}var C=function(){function e(){o(this,e),this._n="WebRequest"}return i(e,[{key:"request",value:function(e,n){var o=this,a=("".concat(this._n,".request"),e.downloadUrl||""),i=(e.method||"PUT").toUpperCase(),r=e.url;if(e.qs){var s=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"&",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"=";return I(e)?"":y(e)?Object.keys(e).map((function(o){var a=encodeURIComponent(o)+n;return Array.isArray(e[o])?e[o].map((function(e){return a+encodeURIComponent(e)})).join(t):a+encodeURIComponent(e[o])})).filter(Boolean).join(t):void 0}(e.qs);s&&(r+="".concat(-1===r.indexOf("?")?"?":"&").concat(s))}var l=new XMLHttpRequest;l.open(i,r,!0),l.responseType=e.dataType||"text";var c=e.headers||{};if(e.uploadByIP&&(c=t(t({},c),{},{host:e.uploadIP})),!I(c))for(var u in c)c.hasOwnProperty(u)&&"content-length"!==u.toLowerCase()&&"user-agent"!==u.toLowerCase()&&"origin"!==u.toLowerCase()&&"host"!==u.toLowerCase()&&l.setRequestHeader(u,c[u]);return l.onload=function(){if(200===l.status)n(null,o._xhrRes(l,o._xhrBody(l,a,e.uploadByIP&&e.uploadIP),c));else{if(e.uploadIP&&-1===e.url.indexOf(e.uploadIP))return e.url=(i=e.url,r=e.uploadIP,i.replace(/^http(s)?:\/\/(.*?)\//,"https://".concat(r,"/"))),e.uploadByIP=!0,o.request(e,n);var t={code:l.status,message:JSON.stringify(l.responseText)};n(t,o._xhrRes(l,o._xhrBody(l,a,e.uploadByIP&&e.uploadIP),c))}var i,r},l.onerror=function(t){var i=o._xhrBody(l,a,e.uploadByIP&&e.uploadIP),r={code:l.status,message:JSON.stringify(l.responseText)};i||l.statusText||0!==l.status||(t.message="CORS blocked or network error"),n(r,o._xhrRes(l,i)),r=null},e.onProgress&&l.upload&&(l.upload.onprogress=function(t){var n=t.total,o=t.loaded,a=Math.floor(100*o/n);e.onProgress({total:n,loaded:o,percent:(a>=100?100:a)/100})}),l.send(e.resources),l}},{key:"_xhrRes",value:function(e,t){var n={};return e.getAllResponseHeaders().trim().split("\n").forEach((function(e){if(e){var t=e.indexOf(":"),o=e.substr(0,t).trim().toLowerCase(),a=e.substr(t+1).trim();n[o]=a}})),{statusCode:e.status,statusMessage:e.statusText,headers:n,data:t}}},{key:"_xhrBody",value:function(e,t,n){return 200===e.status&&t?{location:t,uploadIP:n}:{response:e.responseText,uploadIP:n}}}]),e}(),k=["unknown","image","video","audio","log"],E=["name"],T=function(){function e(){o(this,e)}return i(e,[{key:"request",value:function(e,n){var o=this,a=e.resources,i=void 0===a?"":a,r=e.headers,l=void 0===r?{}:r,c=e.url,u=e.downloadUrl,d=void 0===u?"":u,p=c,f=null,m=d.match(/^(https?:\/\/[^/]+\/)([^/]*\/?)(.*)$/),v=decodeURIComponent(m[3]),y=v.indexOf("?")>-1?v.split("?")[0]:v,I={key:e.fileKey?e.fileKey:y,success_action_status:200,"Content-Type":""},C={};if(g){var T=c.split("?sign=");if(T.length>1){var S=T[1];p="".concat(T[0],"?sign=").concat(encodeURIComponent("".concat(S))),C.sign=decodeURIComponent(S),C.signature=decodeURIComponent(S)}}var M={url:p,header:l,name:"file",filePath:i,formData:t(t({},I),C),timeout:e.timeout||3e5};if(h){var w=M;w.name,M=t(t({},s(w,E)),{},{fileName:"file",fileType:k[e.fileType]})}return(f=_.uploadFile(t(t({},M),{},{success:function(e){o._handleResponse({response:e,downloadUrl:d,callback:n})},fail:function(e){o._handleResponse({response:e,downloadUrl:d,callback:n})}}))).onProgressUpdate&&f.onProgressUpdate((function(t){e.onProgress&&e.onProgress({total:t.totalBytesExpectedToSend,loaded:t.totalBytesSent,percent:Math.floor(t.progress)/100})})),f}},{key:"_handleResponse",value:function(e){var n=e.downloadUrl,o=e.response,a=e.callback,i=o.header,r={};if(i)for(var s in i)i.hasOwnProperty(s)&&(r[s.toLowerCase()]=i[s]);var l=+o.statusCode;200===l?a(null,{statusCode:l,headers:r,data:t(t({},o.data),{},{location:n})}):a({code:l,message:JSON.stringify(o.data)},{statusCode:l,headers:r,data:void 0})}}]),e}(),S=function(){function e(){o(this,e)}return i(e,[{key:"request",value:function(e,t){var n=this,o=e.resources,a=void 0===o?"":o,i=e.fileKey,r=void 0===i?"":i,s=e.url,l=e.downloadUrl,c=void 0===l?"":l,u=new FormData;u.append("key",r),u.append("success_action_status",200),u.append("file",{uri:a,type:"application/octet-stream",name:"uploaded_file"}),fetch(s,{method:"POST",headers:{"Content-Type":"multipart/form-data"},body:u}).then((function(e){n._handleResponse({response:e,downloadUrl:c,callback:t})})).catch((function(e){n._handleResponse({response:e,downloadUrl:c,callback:t})}))}},{key:"_handleResponse",value:function(e){var t=e.downloadUrl,n=e.response,o=e.callback,a=n.headers,i=n.status,r=a&&a.map||{};200===i?o(null,{statusCode:200,headers:r,data:{location:t}}):o({code:i,message:JSON.stringify(n)},{statusCode:i,headers:r,data:void 0})}}]),e}();return function(){function e(){o(this,e),this.retry=1,this.tryCount=0,this.systemClockOffset=0,this.httpRequest=m?new T:v?new S:new C}return i(e,[{key:"uploadFile",value:function(e,t){var n=this;return this.httpRequest.request(e,(function(o,a){o&&n.tryCount<n.retry&&n.allowRetry(o)?(n.tryCount++,n.uploadFile(e,t)):(n.tryCount=0,t(o,a))}))}},{key:"allowRetry",value:function(e){var t=!1,n=!1;if(e){var o=e.headers&&(e.headers.date||e.headers.Date)||e.error&&e.error.ServerTime;try{var a=e.error&&e.error.Code,i=e.error&&e.error.Message;("RequestTimeTooSkewed"===a||"AccessDenied"===a&&"Request has expired"===i)&&(n=!0)}catch(l){}if(n&&o){var r=Date.now(),s=Date.parse(o);Math.abs(r+this.systemClockOffset-s)>=3e4&&(this.systemClockOffset=s-r,t=!0)}else 5===Math.floor(e.statusCode/100)&&(t=!0)}return t}}],[{key:"getVersion",value:function(){return"1.4.2"}}]),e}()}()}(Ke);const Ye=He(Ke.exports);var $e=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,62,0,62,0,63,52,53,54,55,56,57,58,59,60,61,0,0,0,0,0,0,0,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,0,0,0,0,63,0,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51];const We={getRandomValues(e){if(!(e instanceof Int8Array||e instanceof Uint8Array||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Uint8ClampedArray))throw new Error("Expected an integer array");if(e.byteLength>65536)throw new Error("Can only request a maximum of 65536 bytes");return function(e,t){for(var n,o=e.length,a="="===e[o-2]?2:"="===e[o-1]?1:0,i=0,r=o-a&4294967292,s=0;s<r;s+=4)n=$e[e.charCodeAt(s)]<<18|$e[e.charCodeAt(s+1)]<<12|$e[e.charCodeAt(s+2)]<<6|$e[e.charCodeAt(s+3)],t[i++]=n>>16&255,t[i++]=n>>8&255,t[i++]=255&n;1===a&&(n=$e[e.charCodeAt(s)]<<10|$e[e.charCodeAt(s+1)]<<4|$e[e.charCodeAt(s+2)]>>2,t[i++]=n>>8&255,t[i++]=255&n),2===a&&(n=$e[e.charCodeAt(s)]<<2|$e[e.charCodeAt(s+1)]>>4,t[i++]=255&n)}(ne("DCloud-Crypto").getRandomValues(e.byteLength),new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e}};var Ze={exports:{}};!function(e){e.exports=function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,(a=void 0,"symbol"==typeof(a=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!=typeof o)return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(o.key,"string"))?a:String(a)),o)}var a}function n(e,n,o){return n&&t(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var o,a,i,r,s=[],l=!0,c=!1;try{if(i=(n=n.call(e)).next,0===t);else for(;!(l=(o=i.call(n)).done)&&(s.push(o.value),s.length!==t);l=!0);}catch(u){c=!0,a=u}finally{try{if(!l&&null!=n.return&&(r=n.return(),Object(r)!==r))return}finally{if(c)throw a}}return s}}(e,t)||i(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e){return function(e){if(Array.isArray(e))return r(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||i(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function s(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=i(e))||t){n&&(e=n);var o=0,a=function(){};return{s:a,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,s=!0,l=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return s=e.done,e},e:function(e){l=!0,r=e},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw r}}}}var l,c,u=function(){for(var e=" \t\r\n~!@#$%^&*()_+-=【】、{}|;':\"，。、《》？αβγδεζηθικλμνξοπρστυφχψωΑΒΓΔΕΖΗΘΙΚΛΜΝΞΟΠΡΣΤΥΦΧΨΩ。，、；：？！…—·ˉ¨‘’“”々～‖∶＂＇｀｜〃〔〕〈〉《》「」『』．〖〗【】（）［］｛｝ⅠⅡⅢⅣⅤⅥⅦⅧⅨⅩⅪⅫ⒈⒉⒊⒋⒌⒍⒎⒏⒐⒑⒒⒓⒔⒕⒖⒗⒘⒙⒚⒛㈠㈡㈢㈣㈤㈥㈦㈧㈨㈩①②③④⑤⑥⑦⑧⑨⑩⑴⑵⑶⑷⑸⑹⑺⑻⑼⑽⑾⑿⒀⒁⒂⒃⒄⒅⒆⒇≈≡≠＝≤≥＜＞≮≯∷±＋－×÷／∫∮∝∞∧∨∑∏∪∩∈∵∴⊥∥∠⌒⊙≌∽√§№☆★○●◎◇◆□℃‰€■△▲※→←↑↓〓¤°＃＆＠＼︿＿￣―♂♀┌┍┎┐┑┒┓─┄┈├┝┞┟┠┡┢┣│┆┊┬┭┮┯┰┱┲┳┼┽┾┿╀╁╂╃└┕┖┗┘┙┚┛━┅┉┤┥┦┧┨┩┪┫┃┇┋┴┵┶┷┸┹┺┻╋╊╉╈╇╆╅╄",t=new Map,n=0,o=e.length;n<o;n++)t.set(e.charCodeAt(0),!0);return t}(),d=function(){function t(n){e(this,t);var o,i=n.input,r=n.isArray,s=n.isMap;this._trieTree={},r(i)?o=i:s(i)&&(o=a(i.keys()),this._map=i);for(var l=0,c=o.length;l<c;l++)if(o[l]){for(var u=this._trieTree,d=o[l],p=0,h=d.length;p<h;p++)u[d[p]]||(u[d[p]]={}),u=u[d[p]];u.isEnd=!0}}return n(t,[{key:"filter",value:function(e){var t=e.text,n=e.replacingEnabled;if(0===Object.keys(this._trieTree).length)return{isMatched:!1,modifiedText:t};for(var o=this._trieTree,a=t.toLowerCase(),i="",r=!1,s=a.length,l=0;l<s;l++)if(!0!==u.get(a.charCodeAt(l))){for(var c=0,d="",p=!1,h=l;h<s;h++){if(!o[a[h]]){o=this._trieTree;break}if(d+=a[h],o[a[h]].isEnd){p=!0,c=h-l,o=this._trieTree;break}o=o[a[h]]}if(c>1&&(l+=c),p){if(r=!0,!n)break;var f=this._map.get(d)||"*";i=t.replace(new RegExp(d,"gi"),f)}}return{isMatched:r,modifiedText:i}}},{key:"reset",value:function(){this._trieTree={},this._map=null}}]),t}(),p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==ze?ze:"undefined"!=typeof self?self:{},h={},f=(l=function(e,t){var n,o,a,i,r,s,l,c,u,d,f,g,m;e.exports=(s=s||function(e){var t;if("undefined"!=typeof window&&We&&(t=We),!t&&"undefined"!=typeof window&&window.msCrypto&&(t=window.msCrypto),!t&&void 0!==p&&p.crypto&&(t=p.crypto),!t)try{t=h}catch(m){}var n=function(){if(t){if("function"==typeof t.getRandomValues)try{return t.getRandomValues(new Uint32Array(1))[0]}catch(m){}if("function"==typeof t.randomBytes)try{return t.randomBytes(4).readInt32LE()}catch(m){}}throw new Error("Native crypto module could not be used to get secure random number.")},o=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),a={},i=a.lib={},r=i.Base={extend:function(e){var t=o(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},s=i.WordArray=r.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||c).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes,a=e.sigBytes;if(this.clamp(),o%4)for(var i=0;i<a;i++){var r=n[i>>>2]>>>24-i%4*8&255;t[o+i>>>2]|=r<<24-(o+i)%4*8}else for(i=0;i<a;i+=4)t[o+i>>>2]=n[i>>>2];return this.sigBytes+=a,this},clamp:function(){var t=this.words,n=this.sigBytes;t[n>>>2]&=4294967295<<32-n%4*8,t.length=e.ceil(n/4)},clone:function(){var e=r.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t=[],o=0;o<e;o+=4)t.push(n());return new s.init(t,e)}}),l=a.enc={},c=l.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;o.push((i>>>4).toString(16)),o.push((15&i).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new s.init(n,t/2)}},u=l.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;return new s.init(n,t)}},d=l.Utf8={stringify:function(e){try{return decodeURIComponent(escape(u.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return u.parse(unescape(encodeURIComponent(e)))}},f=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new s.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=d.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(t){var n,o=this._data,a=o.words,i=o.sigBytes,r=this.blockSize,l=i/(4*r),c=(l=t?e.ceil(l):e.max((0|l)-this._minBufferSize,0))*r,u=e.min(4*c,i);if(c){for(var d=0;d<c;d+=r)this._doProcessBlock(a,d);n=a.splice(0,c),o.sigBytes-=u}return new s.init(n,u)},clone:function(){var e=r.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),g=(i.Hasher=f.extend({cfg:r.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){f.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new g.HMAC.init(e,n).finalize(t)}}}),a.algo={});return a}(Math),r=(i=s).lib.WordArray,i.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,o=this._map;e.clamp();for(var a=[],i=0;i<n;i+=3)for(var r=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)a.push(o.charAt(r>>>6*(3-s)&63));var l=o.charAt(64);if(l)for(;a.length%4;)a.push(l);return a.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var a=0;a<n.length;a++)o[n.charCodeAt(a)]=a}var i=n.charAt(64);if(i){var s=e.indexOf(i);-1!==s&&(t=s)}return function(e,t,n){for(var o=[],a=0,i=0;i<t;i++)if(i%4){var s=n[e.charCodeAt(i-1)]<<i%4*2|n[e.charCodeAt(i)]>>>6-i%4*2;o[a>>>2]|=s<<24-a%4*8,a++}return r.create(o,a)}(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},function(e){var t=s,n=t.lib,o=n.WordArray,a=n.Hasher,i=t.algo,r=[];!function(){for(var t=0;t<64;t++)r[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=i.MD5=a.extend({_doReset:function(){this._hash=new o.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,a=e[o];e[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var i=this._hash.words,s=e[t+0],l=e[t+1],h=e[t+2],f=e[t+3],g=e[t+4],m=e[t+5],v=e[t+6],_=e[t+7],y=e[t+8],I=e[t+9],C=e[t+10],k=e[t+11],E=e[t+12],T=e[t+13],S=e[t+14],M=e[t+15],w=i[0],b=i[1],D=i[2],N=i[3];w=c(w,b,D,N,s,7,r[0]),N=c(N,w,b,D,l,12,r[1]),D=c(D,N,w,b,h,17,r[2]),b=c(b,D,N,w,f,22,r[3]),w=c(w,b,D,N,g,7,r[4]),N=c(N,w,b,D,m,12,r[5]),D=c(D,N,w,b,v,17,r[6]),b=c(b,D,N,w,_,22,r[7]),w=c(w,b,D,N,y,7,r[8]),N=c(N,w,b,D,I,12,r[9]),D=c(D,N,w,b,C,17,r[10]),b=c(b,D,N,w,k,22,r[11]),w=c(w,b,D,N,E,7,r[12]),N=c(N,w,b,D,T,12,r[13]),D=c(D,N,w,b,S,17,r[14]),w=u(w,b=c(b,D,N,w,M,22,r[15]),D,N,l,5,r[16]),N=u(N,w,b,D,v,9,r[17]),D=u(D,N,w,b,k,14,r[18]),b=u(b,D,N,w,s,20,r[19]),w=u(w,b,D,N,m,5,r[20]),N=u(N,w,b,D,C,9,r[21]),D=u(D,N,w,b,M,14,r[22]),b=u(b,D,N,w,g,20,r[23]),w=u(w,b,D,N,I,5,r[24]),N=u(N,w,b,D,S,9,r[25]),D=u(D,N,w,b,f,14,r[26]),b=u(b,D,N,w,y,20,r[27]),w=u(w,b,D,N,T,5,r[28]),N=u(N,w,b,D,h,9,r[29]),D=u(D,N,w,b,_,14,r[30]),w=d(w,b=u(b,D,N,w,E,20,r[31]),D,N,m,4,r[32]),N=d(N,w,b,D,y,11,r[33]),D=d(D,N,w,b,k,16,r[34]),b=d(b,D,N,w,S,23,r[35]),w=d(w,b,D,N,l,4,r[36]),N=d(N,w,b,D,g,11,r[37]),D=d(D,N,w,b,_,16,r[38]),b=d(b,D,N,w,C,23,r[39]),w=d(w,b,D,N,T,4,r[40]),N=d(N,w,b,D,s,11,r[41]),D=d(D,N,w,b,f,16,r[42]),b=d(b,D,N,w,v,23,r[43]),w=d(w,b,D,N,I,4,r[44]),N=d(N,w,b,D,E,11,r[45]),D=d(D,N,w,b,M,16,r[46]),w=p(w,b=d(b,D,N,w,h,23,r[47]),D,N,s,6,r[48]),N=p(N,w,b,D,_,10,r[49]),D=p(D,N,w,b,S,15,r[50]),b=p(b,D,N,w,m,21,r[51]),w=p(w,b,D,N,E,6,r[52]),N=p(N,w,b,D,f,10,r[53]),D=p(D,N,w,b,C,15,r[54]),b=p(b,D,N,w,l,21,r[55]),w=p(w,b,D,N,y,6,r[56]),N=p(N,w,b,D,M,10,r[57]),D=p(D,N,w,b,v,15,r[58]),b=p(b,D,N,w,T,21,r[59]),w=p(w,b,D,N,g,6,r[60]),N=p(N,w,b,D,k,10,r[61]),D=p(D,N,w,b,h,15,r[62]),b=p(b,D,N,w,I,21,r[63]),i[0]=i[0]+w|0,i[1]=i[1]+b|0,i[2]=i[2]+D|0,i[3]=i[3]+N|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,a=8*t.sigBytes;n[a>>>5]|=128<<24-a%32;var i=e.floor(o/4294967296),r=o;n[15+(a+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,l=s.words,c=0;c<4;c++){var u=l[c];l[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return s},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,o,a,i,r){var s=e+(t&n|~t&o)+a+r;return(s<<i|s>>>32-i)+t}function u(e,t,n,o,a,i,r){var s=e+(t&o|n&~o)+a+r;return(s<<i|s>>>32-i)+t}function d(e,t,n,o,a,i,r){var s=e+(t^n^o)+a+r;return(s<<i|s>>>32-i)+t}function p(e,t,n,o,a,i,r){var s=e+(n^(t|~o))+a+r;return(s<<i|s>>>32-i)+t}t.MD5=a._createHelper(l),t.HmacMD5=a._createHmacHelper(l)}(Math),c=(l=s).lib,u=c.WordArray,d=c.Hasher,f=l.algo,g=[],m=f.SHA1=d.extend({_doReset:function(){this._hash=new u.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],l=0;l<80;l++){if(l<16)g[l]=0|e[t+l];else{var c=g[l-3]^g[l-8]^g[l-14]^g[l-16];g[l]=c<<1|c>>>31}var u=(o<<5|o>>>27)+s+g[l];u+=l<20?1518500249+(a&i|~a&r):l<40?1859775393+(a^i^r):l<60?(a&i|a&r|i&r)-1894007588:(a^i^r)-899497514,s=r,r=i,i=a<<30|a>>>2,a=o,o=u}n[0]=n[0]+o|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+r|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(o+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=d.clone.call(this);return e._hash=this._hash.clone(),e}}),l.SHA1=d._createHelper(m),l.HmacSHA1=d._createHmacHelper(m),function(e){var t=s,n=t.lib,o=n.WordArray,a=n.Hasher,i=t.algo,r=[],l=[];!function(){function t(t){for(var n=e.sqrt(t),o=2;o<=n;o++)if(!(t%o))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var o=2,a=0;a<64;)t(o)&&(a<8&&(r[a]=n(e.pow(o,.5))),l[a]=n(e.pow(o,1/3)),a++),o++}();var c=[],u=i.SHA256=a.extend({_doReset:function(){this._hash=new o.init(r.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=0;h<64;h++){if(h<16)c[h]=0|e[t+h];else{var f=c[h-15],g=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,m=c[h-2],v=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[h]=g+c[h-7]+v+c[h-16]}var _=o&a^o&i^a&i,y=(o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22),I=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&d)+l[h]+c[h];p=d,d=u,u=s,s=r+I|0,r=i,i=a,a=o,o=I+(y+_)|0}n[0]=n[0]+o|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+r|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(o/4294967296),n[15+(a+64>>>9<<4)]=o,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=a._createHelper(u),t.HmacSHA256=a._createHmacHelper(u)}(Math),function(){var e=s,t=e.lib.WordArray,n=e.enc;function o(e){return e<<8&4278255360|e>>>8&16711935}n.Utf16=n.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a+=2){var i=t[a>>>2]>>>16-a%4*8&65535;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var n=e.length,o=[],a=0;a<n;a++)o[a>>>1]|=e.charCodeAt(a)<<16-a%2*16;return t.create(o,2*n)}},n.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,a=[],i=0;i<n;i+=2){var r=o(t[i>>>2]>>>16-i%4*8&65535);a.push(String.fromCharCode(r))}return a.join("")},parse:function(e){for(var n=e.length,a=[],i=0;i<n;i++)a[i>>>1]|=o(e.charCodeAt(i)<<16-i%2*16);return t.create(a,2*n)}}}(),function(){if("function"==typeof ArrayBuffer){var e=s.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,o=[],a=0;a<n;a++)o[a>>>2]|=e[a]<<24-a%4*8;t.call(this,o,n)}else t.apply(this,arguments)}).prototype=e}}(),
/** @preserve
              (c) 2012 by C��dric Mesnil. All rights reserved.
               Redistribution and use in source and binary forms, with or without modification, are permitted provided that the following conditions are met:
                   - Redistributions of source code must retain the above copyright notice, this list of conditions and the following disclaimer.
                  - Redistributions in binary form must reproduce the above copyright notice, this list of conditions and the following disclaimer in the documentation and/or other materials provided with the distribution.
               THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
              */
function(){var e=s,t=e.lib,n=t.WordArray,o=t.Hasher,a=e.algo,i=n.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),r=n.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=n.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=n.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=n.create([0,1518500249,1859775393,2400959708,2840853838]),d=n.create([1352829926,1548603684,1836072691,2053994217,0]),p=a.RIPEMD160=o.extend({_doReset:function(){this._hash=n.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,a=e[o];e[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var s,p,y,I,C,k,E,T,S,M,w,b=this._hash.words,D=u.words,N=d.words,R=i.words,L=r.words,A=l.words,O=c.words;for(k=s=b[0],E=p=b[1],T=y=b[2],S=I=b[3],M=C=b[4],n=0;n<80;n+=1)w=s+e[t+R[n]]|0,w+=n<16?h(p,y,I)+D[0]:n<32?f(p,y,I)+D[1]:n<48?g(p,y,I)+D[2]:n<64?m(p,y,I)+D[3]:v(p,y,I)+D[4],w=(w=_(w|=0,A[n]))+C|0,s=C,C=I,I=_(y,10),y=p,p=w,w=k+e[t+L[n]]|0,w+=n<16?v(E,T,S)+N[0]:n<32?m(E,T,S)+N[1]:n<48?g(E,T,S)+N[2]:n<64?f(E,T,S)+N[3]:h(E,T,S)+N[4],w=(w=_(w|=0,O[n]))+M|0,k=M,M=S,S=_(T,10),T=E,E=w;w=b[1]+y+S|0,b[1]=b[2]+I+M|0,b[2]=b[3]+C+k|0,b[3]=b[4]+s+E|0,b[4]=b[0]+p+T|0,b[0]=w},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,i=a.words,r=0;r<5;r++){var s=i[r];i[r]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return a},clone:function(){var e=o.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function f(e,t,n){return e&t|~e&n}function g(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function _(e,t){return e<<t|e>>>32-t}e.RIPEMD160=o._createHelper(p),e.HmacRIPEMD160=o._createHmacHelper(p)}(),function(){var e=s,t=e.lib.Base,n=e.enc.Utf8;e.algo.HMAC=t.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=n.parse(t));var o=e.blockSize,a=4*o;t.sigBytes>a&&(t=e.finalize(t)),t.clamp();for(var i=this._oKey=t.clone(),r=this._iKey=t.clone(),s=i.words,l=r.words,c=0;c<o;c++)s[c]^=1549556828,l[c]^=909522486;i.sigBytes=r.sigBytes=a,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})}(),function(){var e=s,t=e.lib,n=t.Base,o=t.WordArray,a=e.algo,i=a.SHA1,r=a.HMAC,l=a.PBKDF2=n.extend({cfg:n.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,a=r.create(n.hasher,e),i=o.create(),s=o.create([1]),l=i.words,c=s.words,u=n.keySize,d=n.iterations;l.length<u;){var p=a.update(t).finalize(s);a.reset();for(var h=p.words,f=h.length,g=p,m=1;m<d;m++){g=a.finalize(g),a.reset();for(var v=g.words,_=0;_<f;_++)h[_]^=v[_]}i.concat(p),c[0]++}return i.sigBytes=4*u,i}});e.PBKDF2=function(e,t,n){return l.create(n).compute(e,t)}}(),function(){var e=s,t=e.lib,n=t.Base,o=t.WordArray,a=e.algo,i=a.MD5,r=a.EvpKDF=n.extend({cfg:n.extend({keySize:4,hasher:i,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n,a=this.cfg,i=a.hasher.create(),r=o.create(),s=r.words,l=a.keySize,c=a.iterations;s.length<l;){n&&i.update(n),n=i.update(e).finalize(t),i.reset();for(var u=1;u<c;u++)n=i.finalize(n),i.reset();r.concat(n)}return r.sigBytes=4*l,r}});e.EvpKDF=function(e,t,n){return r.create(n).compute(e,t)}}(),function(){var e=s,t=e.lib.WordArray,n=e.algo,o=n.SHA256,a=n.SHA224=o.extend({_doReset:function(){this._hash=new t.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=o._doFinalize.call(this);return e.sigBytes-=4,e}});e.SHA224=o._createHelper(a),e.HmacSHA224=o._createHmacHelper(a)}(),function(){var e=s,t=e.lib,n=t.Base,o=t.WordArray,a=e.x64={};a.Word=n.extend({init:function(e,t){this.high=e,this.low=t}}),a.WordArray=n.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],a=0;a<t;a++){var i=e[a];n.push(i.high),n.push(i.low)}return o.create(n,this.sigBytes)},clone:function(){for(var e=n.clone.call(this),t=e.words=this.words.slice(0),o=t.length,a=0;a<o;a++)t[a]=t[a].clone();return e}})}(),function(e){var t=s,n=t.lib,o=n.WordArray,a=n.Hasher,i=t.x64.Word,r=t.algo,l=[],c=[],u=[];!function(){for(var e=1,t=0,n=0;n<24;n++){l[e+5*t]=(n+1)*(n+2)/2%64;var o=(2*e+3*t)%5;e=t%5,t=o}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var a=1,r=0;r<24;r++){for(var s=0,d=0,p=0;p<7;p++){if(1&a){var h=(1<<p)-1;h<32?d^=1<<h:s^=1<<h-32}128&a?a=a<<1^113:a<<=1}u[r]=i.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=i.create()}();var p=r.SHA3=a.extend({cfg:a.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new i.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,o=this.blockSize/2,a=0;a<o;a++){var i=e[t+2*a],r=e[t+2*a+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),(b=n[a]).high^=r,b.low^=i}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var h=0,f=0,g=0;g<5;g++)h^=(b=n[p+5*g]).high,f^=b.low;var m=d[p];m.high=h,m.low=f}for(p=0;p<5;p++){var v=d[(p+4)%5],_=d[(p+1)%5],y=_.high,I=_.low;for(h=v.high^(y<<1|I>>>31),f=v.low^(I<<1|y>>>31),g=0;g<5;g++)(b=n[p+5*g]).high^=h,b.low^=f}for(var C=1;C<25;C++){var k=(b=n[C]).high,E=b.low,T=l[C];T<32?(h=k<<T|E>>>32-T,f=E<<T|k>>>32-T):(h=E<<T-32|k>>>64-T,f=k<<T-32|E>>>64-T);var S=d[c[C]];S.high=h,S.low=f}var M=d[0],w=n[0];for(M.high=w.high,M.low=w.low,p=0;p<5;p++)for(g=0;g<5;g++){var b=n[C=p+5*g],D=d[C],N=d[(p+1)%5+5*g],R=d[(p+2)%5+5*g];b.high=D.high^~N.high&R.high,b.low=D.low^~N.low&R.low}b=n[0];var L=u[s];b.high^=L.high,b.low^=L.low}},_doFinalize:function(){var t=this._data,n=t.words,a=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;n[a>>>5]|=1<<24-a%32,n[(e.ceil((a+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var r=this._state,s=this.cfg.outputLength/8,l=s/8,c=[],u=0;u<l;u++){var d=r[u],p=d.high,h=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),c.push(h),c.push(p)}return new o.init(c,s)},clone:function(){for(var e=a.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=a._createHelper(p),t.HmacSHA3=a._createHmacHelper(p)}(Math),function(){var e=s,t=e.lib.Hasher,n=e.x64,o=n.Word,a=n.WordArray,i=e.algo;function r(){return o.create.apply(o,arguments)}var l=[r(1116352408,3609767458),r(1899447441,602891725),r(3049323471,3964484399),r(3921009573,2173295548),r(961987163,4081628472),r(1508970993,3053834265),r(2453635748,2937671579),r(2870763221,3664609560),r(3624381080,2734883394),r(310598401,1164996542),r(607225278,1323610764),r(1426881987,3590304994),r(1925078388,4068182383),r(2162078206,991336113),r(2614888103,633803317),r(3248222580,3479774868),r(3835390401,2666613458),r(4022224774,944711139),r(264347078,2341262773),r(604807628,2007800933),r(770255983,1495990901),r(1249150122,1856431235),r(1555081692,3175218132),r(1996064986,2198950837),r(2554220882,3999719339),r(2821834349,766784016),r(2952996808,2566594879),r(3210313671,3203337956),r(3336571891,1034457026),r(3584528711,2466948901),r(113926993,3758326383),r(338241895,168717936),r(666307205,1188179964),r(773529912,1546045734),r(1294757372,1522805485),r(1396182291,2643833823),r(1695183700,2343527390),r(1986661051,1014477480),r(2177026350,1206759142),r(2456956037,344077627),r(2730485921,1290863460),r(2820302411,3158454273),r(3259730800,3505952657),r(3345764771,106217008),r(3516065817,3606008344),r(3600352804,1432725776),r(4094571909,1467031594),r(275423344,851169720),r(430227734,3100823752),r(506948616,1363258195),r(659060556,3750685593),r(883997877,3785050280),r(958139571,3318307427),r(1322822218,3812723403),r(1537002063,2003034995),r(1747873779,3602036899),r(1955562222,1575990012),r(2024104815,1125592928),r(2227730452,2716904306),r(2361852424,442776044),r(2428436474,593698344),r(2756734187,3733110249),r(3204031479,2999351573),r(3329325298,3815920427),r(3391569614,3928383900),r(3515267271,566280711),r(3940187606,3454069534),r(4118630271,4000239992),r(116418474,1914138554),r(174292421,2731055270),r(289380356,3203993006),r(460393269,320620315),r(685471733,587496836),r(852142971,1086792851),r(1017036298,365543100),r(1126000580,2618297676),r(1288033470,3409855158),r(1501505948,4234509866),r(1607167915,987167468),r(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=r()}();var u=i.SHA512=t.extend({_doReset:function(){this._hash=new a.init([new o.init(1779033703,4089235720),new o.init(3144134277,2227873595),new o.init(1013904242,4271175723),new o.init(2773480762,1595750129),new o.init(1359893119,2917565137),new o.init(2600822924,725511199),new o.init(528734635,4215389547),new o.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=o.high,f=o.low,g=a.high,m=a.low,v=i.high,_=i.low,y=r.high,I=r.low,C=s.high,k=s.low,E=u.high,T=u.low,S=d.high,M=d.low,w=p.high,b=p.low,D=h,N=f,R=g,L=m,A=v,O=_,P=y,U=I,x=C,V=k,B=E,G=T,F=S,z=M,H=w,j=b,q=0;q<80;q++){var K,Y,$=c[q];if(q<16)Y=$.high=0|e[t+2*q],K=$.low=0|e[t+2*q+1];else{var W=c[q-15],Z=W.high,J=W.low,X=(Z>>>1|J<<31)^(Z>>>8|J<<24)^Z>>>7,Q=(J>>>1|Z<<31)^(J>>>8|Z<<24)^(J>>>7|Z<<25),ee=c[q-2],te=ee.high,ne=ee.low,oe=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ae=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=c[q-7],re=ie.high,se=ie.low,le=c[q-16],ce=le.high,ue=le.low;Y=(Y=(Y=X+re+((K=Q+se)>>>0<Q>>>0?1:0))+oe+((K+=ae)>>>0<ae>>>0?1:0))+ce+((K+=ue)>>>0<ue>>>0?1:0),$.high=Y,$.low=K}var de,pe=x&B^~x&F,he=V&G^~V&z,fe=D&R^D&A^R&A,ge=N&L^N&O^L&O,me=(D>>>28|N<<4)^(D<<30|N>>>2)^(D<<25|N>>>7),ve=(N>>>28|D<<4)^(N<<30|D>>>2)^(N<<25|D>>>7),_e=(x>>>14|V<<18)^(x>>>18|V<<14)^(x<<23|V>>>9),ye=(V>>>14|x<<18)^(V>>>18|x<<14)^(V<<23|x>>>9),Ie=l[q],Ce=Ie.high,ke=Ie.low,Ee=H+_e+((de=j+ye)>>>0<j>>>0?1:0),Te=ve+ge;H=F,j=z,F=B,z=G,B=x,G=V,x=P+(Ee=(Ee=(Ee=Ee+pe+((de+=he)>>>0<he>>>0?1:0))+Ce+((de+=ke)>>>0<ke>>>0?1:0))+Y+((de+=K)>>>0<K>>>0?1:0))+((V=U+de|0)>>>0<U>>>0?1:0)|0,P=A,U=O,A=R,O=L,R=D,L=N,D=Ee+(me+fe+(Te>>>0<ve>>>0?1:0))+((N=de+Te|0)>>>0<de>>>0?1:0)|0}f=o.low=f+N,o.high=h+D+(f>>>0<N>>>0?1:0),m=a.low=m+L,a.high=g+R+(m>>>0<L>>>0?1:0),_=i.low=_+O,i.high=v+A+(_>>>0<O>>>0?1:0),I=r.low=I+U,r.high=y+P+(I>>>0<U>>>0?1:0),k=s.low=k+V,s.high=C+x+(k>>>0<V>>>0?1:0),T=u.low=T+G,u.high=E+B+(T>>>0<G>>>0?1:0),M=d.low=M+z,d.high=S+F+(M>>>0<z>>>0?1:0),b=p.low=b+j,p.high=w+H+(b>>>0<j>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[30+(o+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(o+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(u),e.HmacSHA512=t._createHmacHelper(u)}(),function(){var e=s,t=e.x64,n=t.Word,o=t.WordArray,a=e.algo,i=a.SHA512,r=a.SHA384=i.extend({_doReset:function(){this._hash=new o.init([new n.init(3418070365,3238371032),new n.init(1654270250,914150663),new n.init(2438529370,812702999),new n.init(355462360,4144912697),new n.init(1731405415,4290775857),new n.init(2394180231,1750603025),new n.init(3675008525,1694076839),new n.init(1203062813,3204075428)])},_doFinalize:function(){var e=i._doFinalize.call(this);return e.sigBytes-=16,e}});e.SHA384=i._createHelper(r),e.HmacSHA384=i._createHmacHelper(r)}(),s.lib.Cipher||function(){var e=s,t=e.lib,n=t.Base,o=t.WordArray,a=t.BufferedBlockAlgorithm,i=e.enc,r=(i.Utf8,i.Base64),l=e.algo.EvpKDF,c=t.Cipher=a.extend({cfg:n.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){a.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?_:m}return function(t){return{encrypt:function(n,o,a){return e(o).encrypt(t,n,o,a)},decrypt:function(n,o,a){return e(o).decrypt(t,n,o,a)}}}}()}),u=(t.StreamCipher=c.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),e.mode={}),d=t.BlockCipherMode=n.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),p=u.CBC=function(){var e=d.extend();function t(e,t,n){var o,a=this._iv;a?(o=a,this._iv=void 0):o=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=o[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize;t.call(this,e,n,a),o.encryptBlock(e,n),this._prevBlock=e.slice(n,n+a)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize,i=e.slice(n,n+a);o.decryptBlock(e,n),t.call(this,e,n,a),this._prevBlock=i}}),e}(),h=(e.pad={}).Pkcs7={pad:function(e,t){for(var n=4*t,a=n-e.sigBytes%n,i=a<<24|a<<16|a<<8|a,r=[],s=0;s<a;s+=4)r.push(i);var l=o.create(r,a);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},f=(t.BlockCipher=c.extend({cfg:c.cfg.extend({mode:p,padding:h}),reset:function(){var e;c.reset.call(this);var t=this.cfg,n=t.iv,o=t.mode;this._xformMode==this._ENC_XFORM_MODE?e=o.createEncryptor:(e=o.createDecryptor,this._minBufferSize=1),this._mode&&this._mode.__creator==e?this._mode.init(this,n&&n.words):(this._mode=e.call(o,this,n&&n.words),this._mode.__creator=e)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e,t=this.cfg.padding;return this._xformMode==this._ENC_XFORM_MODE?(t.pad(this._data,this.blockSize),e=this._process(!0)):(e=this._process(!0),t.unpad(e)),e},blockSize:4}),t.CipherParams=n.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}})),g=(e.format={}).OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;return(n?o.create([1398893684,1701076831]).concat(n).concat(t):t).toString(r)},parse:function(e){var t,n=r.parse(e),a=n.words;return 1398893684==a[0]&&1701076831==a[1]&&(t=o.create(a.slice(2,4)),a.splice(0,4),n.sigBytes-=16),f.create({ciphertext:n,salt:t})}},m=t.SerializableCipher=n.extend({cfg:n.extend({format:g}),encrypt:function(e,t,n,o){o=this.cfg.extend(o);var a=e.createEncryptor(n,o),i=a.finalize(t),r=a.cfg;return f.create({ciphertext:i,key:n,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:o.format})},decrypt:function(e,t,n,o){return o=this.cfg.extend(o),t=this._parse(t,o.format),e.createDecryptor(n,o).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),v=(e.kdf={}).OpenSSL={execute:function(e,t,n,a){a||(a=o.random(8));var i=l.create({keySize:t+n}).compute(e,a),r=o.create(i.words.slice(t),4*n);return i.sigBytes=4*t,f.create({key:i,iv:r,salt:a})}},_=t.PasswordBasedCipher=m.extend({cfg:m.cfg.extend({kdf:v}),encrypt:function(e,t,n,o){var a=(o=this.cfg.extend(o)).kdf.execute(n,e.keySize,e.ivSize);o.iv=a.iv;var i=m.encrypt.call(this,e,t,a.key,o);return i.mixIn(a),i},decrypt:function(e,t,n,o){o=this.cfg.extend(o),t=this._parse(t,o.format);var a=o.kdf.execute(n,e.keySize,e.ivSize,t.salt);return o.iv=a.iv,m.decrypt.call(this,e,t,a.key,o)}})}(),s.mode.CFB=function(){var e=s.lib.BlockCipherMode.extend();function t(e,t,n,o){var a,i=this._iv;i?(a=i.slice(0),this._iv=void 0):a=this._prevBlock,o.encryptBlock(a,0);for(var r=0;r<n;r++)e[t+r]^=a[r]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize;t.call(this,e,n,a,o),this._prevBlock=e.slice(n,n+a)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize,i=e.slice(n,n+a);t.call(this,e,n,a,o),this._prevBlock=i}}),e}(),s.mode.ECB=((a=s.lib.BlockCipherMode.extend()).Encryptor=a.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),a.Decryptor=a.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),a),s.pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,o=4*t,a=o-n%o,i=n+a-1;e.clamp(),e.words[i>>>2]|=a<<24-i%4*8,e.sigBytes+=a},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},s.pad.Iso10126={pad:function(e,t){var n=4*t,o=n-e.sigBytes%n;e.concat(s.lib.WordArray.random(o-1)).concat(s.lib.WordArray.create([o<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},s.pad.Iso97971={pad:function(e,t){e.concat(s.lib.WordArray.create([2147483648],1)),s.pad.ZeroPadding.pad(e,t)},unpad:function(e){s.pad.ZeroPadding.unpad(e),e.sigBytes--}},s.mode.OFB=(o=(n=s.lib.BlockCipherMode.extend()).Encryptor=n.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,a=this._iv,i=this._keystream;a&&(i=this._keystream=a.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var r=0;r<o;r++)e[t+r]^=i[r]}}),n.Decryptor=o,n),s.pad.NoPadding={pad:function(){},unpad:function(){}},function(){var e=s,t=e.lib.CipherParams,n=e.enc.Hex;e.format.Hex={stringify:function(e){return e.ciphertext.toString(n)},parse:function(e){var o=n.parse(e);return t.create({ciphertext:o})}}}(),function(){var e=s,t=e.lib.BlockCipher,n=e.algo,o=[],a=[],i=[],r=[],l=[],c=[],u=[],d=[],p=[],h=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,s=0;for(t=0;t<256;t++){var f=s^s<<1^s<<2^s<<3^s<<4;f=f>>>8^255&f^99,o[n]=f,a[f]=n;var g=e[n],m=e[g],v=e[m],_=257*e[f]^16843008*f;i[n]=_<<24|_>>>8,r[n]=_<<16|_>>>16,l[n]=_<<8|_>>>24,c[n]=_,_=16843009*v^65537*m^257*g^16843008*n,u[f]=_<<24|_>>>8,d[f]=_<<16|_>>>16,p[f]=_<<8|_>>>24,h[f]=_,n?(n=g^e[e[e[v^g]]],s^=e[e[s]]):n=s=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],g=n.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,a=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],r=0;r<a;r++)r<n?i[r]=t[r]:(c=i[r-1],r%n?n>6&&r%n==4&&(c=o[c>>>24]<<24|o[c>>>16&255]<<16|o[c>>>8&255]<<8|o[255&c]):(c=o[(c=c<<8|c>>>24)>>>24]<<24|o[c>>>16&255]<<16|o[c>>>8&255]<<8|o[255&c],c^=f[r/n|0]<<24),i[r]=i[r-n]^c);for(var s=this._invKeySchedule=[],l=0;l<a;l++){if(r=a-l,l%4)var c=i[r];else c=i[r-4];s[l]=l<4||r<=4?c:u[o[c>>>24]]^d[o[c>>>16&255]]^p[o[c>>>8&255]]^h[o[255&c]]}}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,i,r,l,c,o)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,d,p,h,a),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,o,a,i,r,s){for(var l=this._nRounds,c=e[t]^n[0],u=e[t+1]^n[1],d=e[t+2]^n[2],p=e[t+3]^n[3],h=4,f=1;f<l;f++){var g=o[c>>>24]^a[u>>>16&255]^i[d>>>8&255]^r[255&p]^n[h++],m=o[u>>>24]^a[d>>>16&255]^i[p>>>8&255]^r[255&c]^n[h++],v=o[d>>>24]^a[p>>>16&255]^i[c>>>8&255]^r[255&u]^n[h++],_=o[p>>>24]^a[c>>>16&255]^i[u>>>8&255]^r[255&d]^n[h++];c=g,u=m,d=v,p=_}g=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^n[h++],m=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^n[h++],v=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^n[h++],_=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^n[h++],e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=_},keySize:8});e.AES=t._createHelper(g)}(),function(){var e=s,t=e.lib,n=t.WordArray,o=t.BlockCipher,a=e.algo,i=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],r=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=a.DES=o.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var o=i[n]-1;t[n]=e[o>>>5]>>>31-o%32&1}for(var a=this._subKeys=[],s=0;s<16;s++){var c=a[s]=[],u=l[s];for(n=0;n<24;n++)c[n/6|0]|=t[(r[n]-1+u)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(r[n+24]-1+u)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=a[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),p.call(this,1,1431655765);for(var o=0;o<16;o++){for(var a=n[o],i=this._lBlock,r=this._rBlock,s=0,l=0;l<8;l++)s|=c[l][((r^a[l])&u[l])>>>0];this._lBlock=r,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function h(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=o._createHelper(d);var f=a.TripleDES=o.extend({_doReset:function(){var e=this._key.words;if(2!==e.length&&4!==e.length&&e.length<6)throw new Error("Invalid key length - 3DES requires the key length to be 64, 128, 192 or >192.");var t=e.slice(0,2),o=e.length<4?e.slice(0,2):e.slice(2,4),a=e.length<6?e.slice(0,2):e.slice(4,6);this._des1=d.createEncryptor(n.create(t)),this._des2=d.createEncryptor(n.create(o)),this._des3=d.createEncryptor(n.create(a))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=o._createHelper(f)}(),function(){var e=s,t=e.lib.StreamCipher,n=e.algo,o=n.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,o=this._S=[],a=0;a<256;a++)o[a]=a;a=0;for(var i=0;a<256;a++){var r=a%n,s=t[r>>>2]>>>24-r%4*8&255;i=(i+o[a]+s)%256;var l=o[a];o[a]=o[i],o[i]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=a.call(this)},keySize:8,ivSize:0});function a(){for(var e=this._S,t=this._i,n=this._j,o=0,a=0;a<4;a++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,o|=e[(e[t]+e[n])%256]<<24-8*a}return this._i=t,this._j=n,o}e.RC4=t._createHelper(o);var i=n.RC4Drop=o.extend({cfg:o.cfg.extend({drop:192}),_doReset:function(){o._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)a.call(this)}});e.RC4Drop=t._createHelper(i)}(),
/** @preserve
               * Counter block mode compatible with  Dr Brian Gladman fileenc.c
               * derived from CryptoJS.mode.CTR
               * Jan Hruby jhruby.web@gmail.com
               */
s.mode.CTRGladman=function(){var e=s.lib.BlockCipherMode.extend();function t(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,o=255&e;255===t?(t=0,255===n?(n=0,255===o?o=0:++o):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=o}return e}var n=e.Encryptor=e.extend({processBlock:function(e,n){var o,a=this._cipher,i=a.blockSize,r=this._iv,s=this._counter;r&&(s=this._counter=r.slice(0),this._iv=void 0),0===((o=s)[0]=t(o[0]))&&(o[1]=t(o[1]));var l=s.slice(0);a.encryptBlock(l,0);for(var c=0;c<i;c++)e[n+c]^=l[c]}});return e.Decryptor=n,e}(),function(){var e=s,t=e.lib.StreamCipher,n=e.algo,o=[],a=[],i=[],r=n.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var o=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)a[n]^=o[n+4&7];if(t){var i=t.words,r=i[0],s=i[1],c=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(a[0]^=c,a[1]^=d,a[2]^=u,a[3]^=p,a[4]^=c,a[5]^=d,a[6]^=u,a[7]^=p,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var a=0;a<4;a++)o[a]=16711935&(o[a]<<8|o[a]>>>24)|4278255360&(o[a]<<24|o[a]>>>8),e[t+a]^=o[a]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)a[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],r=65535&o,s=o>>>16,l=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);i[n]=l^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.Rabbit=t._createHelper(r)}(),s.mode.CTR=function(){var e=s.lib.BlockCipherMode.extend(),t=e.Encryptor=e.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,a=this._iv,i=this._counter;a&&(i=this._counter=a.slice(0),this._iv=void 0);var r=i.slice(0);n.encryptBlock(r,0),i[o-1]=i[o-1]+1|0;for(var s=0;s<o;s++)e[t+s]^=r[s]}});return e.Decryptor=t,e}(),function(){var e=s,t=e.lib.StreamCipher,n=e.algo,o=[],a=[],i=[],r=n.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var a=0;a<4;a++)l.call(this);for(a=0;a<8;a++)o[a]^=n[a+4&7];if(t){var i=t.words,r=i[0],s=i[1],c=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(o[0]^=c,o[1]^=d,o[2]^=u,o[3]^=p,o[4]^=c,o[5]^=d,o[6]^=u,o[7]^=p,a=0;a<4;a++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),o[0]=n[0]^n[5]>>>16^n[3]<<16,o[1]=n[2]^n[7]>>>16^n[5]<<16,o[2]=n[4]^n[1]>>>16^n[7]<<16,o[3]=n[6]^n[3]>>>16^n[1]<<16;for(var a=0;a<4;a++)o[a]=16711935&(o[a]<<8|o[a]>>>24)|4278255360&(o[a]<<24|o[a]>>>8),e[t+a]^=o[a]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)a[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<a[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<a[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<a[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<a[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<a[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<a[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<a[6]>>>0?1:0)|0,this._b=t[7]>>>0<a[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],r=65535&o,s=o>>>16,l=((r*r>>>17)+r*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);i[n]=l^c}e[0]=i[0]+(i[7]<<16|i[7]>>>16)+(i[6]<<16|i[6]>>>16)|0,e[1]=i[1]+(i[0]<<8|i[0]>>>24)+i[7]|0,e[2]=i[2]+(i[1]<<16|i[1]>>>16)+(i[0]<<16|i[0]>>>16)|0,e[3]=i[3]+(i[2]<<8|i[2]>>>24)+i[1]|0,e[4]=i[4]+(i[3]<<16|i[3]>>>16)+(i[2]<<16|i[2]>>>16)|0,e[5]=i[5]+(i[4]<<8|i[4]>>>24)+i[3]|0,e[6]=i[6]+(i[5]<<16|i[5]>>>16)+(i[4]<<16|i[4]>>>16)|0,e[7]=i[7]+(i[6]<<8|i[6]>>>24)+i[5]|0}e.RabbitLegacy=t._createHelper(r)}(),s.pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){var t=e.words,n=e.sigBytes-1;for(n=e.sigBytes-1;n>=0;n--)if(t[n>>>2]>>>24-n%4*8&255){e.sigBytes=n+1;break}}},s)},l(c={exports:{}},c.exports),c.exports);return function(){function t(n){e(this,t);var o=n.isArray,a=n.isMap,i=n.isDevMode;this._isArray=o,this._isMap=a,this._isDevMode=i,this._interceptProfanityList=[],this._interceptFilter=null,this._interceptRegExpList=[],this._replacingProfanityMap=new Map,this._replacingFilter=null,this._replacingRegExpMap=new Map,this._key="",this._iv="",this._decryptOptions=void 0,this._n="TIMProfanityFilterPlugin"}return n(t,[{key:"onToken",value:function(e){this._key=f.enc.Utf8.parse(e.slice(0,32)),this._iv=this._key,this._decryptOptions={iv:this._iv,mode:f.mode.CBC,padding:f.pad.Pkcs7}}},{key:"onLexiconSliced",value:function(e){if(this._isArray(e)&&0!==e.length){var t,n,o,a=s(e);try{for(a.s();!(o=a.n()).done;){var i=o.value,r=i.filterType,l=i.profanityType,c=i.profanity,u=i.replacement;t=this._getDecryptedString(c),n=this._getDecryptedString(u),1===r?1===l?this._interceptProfanityList.push(t):2===l&&this._interceptRegExpList.push(t):2===r&&(1===l?this._replacingProfanityMap.set(t,n):2===l&&this._replacingRegExpMap.set(t,n))}}catch(d){a.e(d)}finally{a.f()}}}},{key:"_getDecryptedString",value:function(e){var t=f.AES.decrypt(e,this._key,this._decryptOptions);return f.enc.Utf8.stringify(t).toLowerCase()}},{key:"onLexiconCompleted",value:function(e){this.onLexiconSliced(e),this._interceptFilter=new d({input:this._interceptProfanityList,isArray:this._isArray,isMap:this._isMap}),this._replacingFilter=new d({input:this._replacingProfanityMap,isArray:this._isArray,isMap:this._isMap}),this._isDevMode}},{key:"filter",value:function(e){var t={type:0,modifiedText:e};if("string"!=typeof e)return this._isDevMode,t;if(!0===this._interceptFilter.filter({text:e,replacingEnabled:!1}).isMatched)return t.type=1,t;for(var n=!1,a=0,i=this._interceptRegExpList.length;a<i;a++)if(new RegExp(this._interceptRegExpList[a],"gi").test(e.toLowerCase())){n=!0;break}if(n)return t.type=1,t;var r=this._replacingFilter.filter({text:e,replacingEnabled:!0});!0===r.isMatched&&(t.type=2,t.modifiedText=r.modifiedText);var l,c=t.modifiedText,u=null,d=s(this._replacingRegExpMap);try{for(d.s();!(l=d.n()).done;){var p=o(l.value,2),h=p[0],f=p[1];u=new RegExp(h,"gi"),c=c.replace(u,f)}}catch(g){d.e(g)}finally{d.f()}return c!==e&&(t.type=2,t.modifiedText=c),t}},{key:"reset",value:function(){this._isArray=null,this._isMap=null,this._interceptProfanityList.length=0,this._interceptRegExpList.length=0,this._replacingProfanityMap.clear(),this._replacingRegExpMap.clear(),this._key="",this._iv="",this._decryptOptions={},this._interceptFilter&&this._interceptFilter.reset(),this._replacingFilter&&this._replacingFilter.reset()}}]),t}()}()}(Ze);const Je=He(Ze.exports);let Xe=class{constructor(){this.serviceMap=new Map}registerService(e,t){this.serviceMap.has(e)||this.serviceMap.set(e,t)}unregisterService(e){this.serviceMap.has(e)&&this.serviceMap.delete(e)}getService(e){return this.serviceMap.get(e)}callService(e){const{serviceName:t,method:n,params:o,callback:a}=e,i=this.getService(t);if(i)return i.onCall(n,o,a)}},Qe=class{constructor(){this.extensionMap=new Map}registerExtension(e,t){if(!this.extensionMap.has(e)){const t=[];this.extensionMap.set(e,t)}const n=this.extensionMap.get(e);-1===n.indexOf(t)&&n.push(t)}unregisterExtension(e,t){if(this.extensionMap.has(e)){const n=this.extensionMap.get(e),o=n.indexOf(t);o>-1&&n.splice(o,1)}}getExtensionList(e,t){t&&JSON.stringify(t);let n=[],o=[];if(this.extensionMap.has(e)){n=this.extensionMap.get(e);for(let a=0;a<n.length;a++){const i=n[a].onGetExtension(e,t);o=o.concat(i)}}return o}};const et=["vue2","vue3","rn"],nt={TUILogin:{EVENT:{LOGIN_STATE_CHANGED:"loginStateChanged"},EVENT_SUB_KEY:{USER_LOGIN_SUCCESS:"userLoginSuccess",USER_LOGOUT_SUCCESS:"userLogoutSuccess",USER_KICKED_OFFLINE:"userKickedOffline",USER_SIG_EXPIRED:"userSigExpired"}},TUIConversation:{SERVICE:{NAME:"TUIConversationService",METHOD:{CREATE_CONVERSATION:"createConversation",HIDE_CONVERSATION_HEADER:"hideConversationHeader"}},EXTENSION:{CONV_POP_MENU:{EXT_ID:"conversationPopMenu"},CONV_GROUP:{EXT_ID:"conversationGroup"}}},TUIChat:{SERVICE:{NAME:"TUIChatService",METHOD:{UPDATE_MESSAGE_LIST:"updateMessageList",CLOSE_MESSAGE_POP_MENU:"closeMessagePopMenu",SEND_CUSTOM_MESSAGE:"sendCustomMessage",SEND_TEXT_MESSAGE:"sendTextMessage",SET_CHAT_TYPE:"setChatType",UPDATE_MESSAGE_INFO:"updateMessageInfo"}},EXTENSION:{INPUT_MORE:{EXT_ID:"inputToolBarMore"},MSG_POP_MENU:{EXT_ID:"messagePopMenu"},CHAT_HEADER:{EXT_ID:"chatHeader"}},TYPE:{C2C:"C2C",GROUP:"GROUP",CUSTOMER_SERVICE:"customerService",ROOM:"room"},EVENT:{CHAT_STATE_CHANGED:"chatStateChanged",CHAT_TYPE_CHANGED:"chatTypeChanged"},EVENT_SUB_KEY:{CHAT_OPENED:"chatOpened",CHANGE_SUCCESS:"changeSuccess"},FEATURE:{DownloadFile:"DownloadFile",CopyMessage:"CopyMessage",DeleteMessage:"DeleteMessage",RevokeMessage:"RevokeMessage",QuoteMessage:"QuoteMessage",ForwardMessage:"ForwardMessage",TranslateMessage:"TranslateMessage",VoiceToText:"VoiceToText",MultiSelection:"MultiSelection",EmojiReaction:"EmojiReaction",InputEmoji:"InputEmoji",InputStickers:"InputStickers",InputImage:"InputImage",InputVoice:"InputVoice",InputVideo:"InputVideo",InputFile:"InputFile",InputEvaluation:"InputEvaluation",InputQuickReplies:"InputQuickReplies",InputMention:"InputMention",MessageSearch:"MessageSearch",ReadStatus:"ReadStatus"}},TUIGroup:{SERVICE:{NAME:"TUIGroupService",METHOD:{CREATE_GROUP:"createGroup",OPEN_GROUP_MANAGEMENT:"openGroupManagement",SELECT_GROUP_MEMBER:"selectGroupMember"}}},TUIContact:{SERVICE:{NAME:"TUIContactService",METHOD:{SELECT_FRIEND:"selectFriend"}},EXTENSION:{CONTACT_LIST:{EXT_ID:"contactList"}}},TUISearch:{SERVICE:{NAME:"TUISearchService",METHOD:{SEARCH_GROUP:"searchGroup",SEARCH_USER:"searchUser",SEARCH_FRIEND:"searchFriend",SEARCH_GROUP_MEMBER:"searchGroupMember"}},EXTENSION:{SEARCH_MORE:{EXT_ID:"searchMore"}}},TUICalling:{SERVICE:{NAME:"TUICallingService",METHOD:{START_CALL:"startCall"}}},TUIRoom:{SERVICE:{NAME:"TUIRoomService"}},TUIEmojiPlugin:{SERVICE:{NAME:"TUIEmojiPluginService",METHOD:{CLOSE_EMOJI_DETAIL:"closeEmojiDetail"}}},TUITranslate:{EVENT:{LANGUAGE_CHANGED:"languageChanged"},EVENT_SUB_KEY:{CHANGE_SUCCESS:"changeSuccess"}},TUITranslatePlugin:{SERVICE:{NAME:"TUITranslatePluginService"}},TUIVoiceToTextPlugin:{SERVICE:{NAME:"TUIVoiceToTextPluginService"}},TUICustomerServicePlugin:{SERVICE:{NAME:"TUICustomerServicePlugin",METHOD:{ACTIVE_CONVERSATION:"activeConversation",FILTER_MESSAGE:"filterMessage"}},EXTENSION:{}},TUIPushPlugin:{SERVICE:{NAME:"TUIPushPluginService"}},TUIChatbotPlugin:{SERVICE:{NAME:"TUIChatbotPluginService"}},TUITheme:{EVENT:{THEME_CHANGED:"themeChanged"},EVENT_SUB_KEY:{CHANGE_SUCCESS:"changeSuccess"}}},ot="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),at="undefined"!=typeof uni&&"undefined"==typeof window,it="undefined"!=typeof uni,rt=("undefined"!=typeof uni||"undefined"!=typeof window)&&!(ot||at);ot?wx:it?uni:window;const st=rt&&window&&window.navigator&&window.navigator.userAgent||"",lt=/Android/i.test(st),ct=/(?:Windows Phone)/.test(st),ut=/(?:SymbianOS)/.test(st),dt=/iPad/i.test(st)||/iPhone/i.test(st)||/iPod/i.test(st),pt=lt||ct||ut||dt,ht=rt&&!pt,ft=at&&!ot,gt={[nt.TUITranslatePlugin.SERVICE.NAME]:Math.pow(2,38),[nt.TUIVoiceToTextPlugin.SERVICE.NAME]:Math.pow(2,39),[nt.TUICustomerServicePlugin.SERVICE.NAME]:Math.pow(2,40),[nt.TUIPushPlugin.SERVICE.NAME]:Math.pow(2,41),[nt.TUIChatbotPlugin.SERVICE.NAME]:Math.pow(2,42),[nt.TUIEmojiPlugin.SERVICE.NAME]:Math.pow(2,48)};let mt=class e{constructor(e){this.loginStatusPromise=new Map,this.SDKAppID=0,this.userID="",this.userSig="",this.TUICore=e,this.isOnChatEvent=!1}static getInstance(t){return!e.instance&&t&&(e.instance=new e(t)),e.instance}login(e){const{SDKAppID:t,userID:n,userSig:o,framework:a}=e;return this.chat=qe.create(Object.assign(Object.assign({},e),{scene:this.getStatScene(a)})),this.EVENT=qe.EVENT,this.TYPES=qe.TYPES,this.SDKAppID=t,this.userID=n,this.userSig=o,this.offChatEvent(),this.onChatEvent(),this.registerPlugin(e),this.loginChat(e)}logout(){return this.chat.logout().then((e=>(this.userID="",this.userSig="",this.TUICore.notifyEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_LOGOUT_SUCCESS),Promise.resolve(e))))}destroy(){return this.chat.destroy().then((e=>(this.userID="",this.userSig="",this.TUICore.notifyEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_LOGOUT_SUCCESS),Promise.resolve(e))))}setLogLevel(e){return this.chat.setLogLevel(e)}getContext(){return{chat:this.chat,SDKAppID:this.SDKAppID,userID:this.userID,userSig:this.userSig}}reportPlugin(){var e;for(const t in gt)this.TUICore.getService(t)&&(null===(e=this.chat.callExperimentalAPI("isFeatureEnabledForStat",gt[t]))||void 0===e||e.catch((e=>{})))}loginChat(e){const{userID:t,userSig:n}=e;return new Promise(((e,o)=>{this.chat.login({userID:t,userSig:n}).then((t=>{t.data.repeatLogin&&this.chat.isReady()&&e(t),this.reportPlugin(),this.loginStatusPromise.set("login",{resolve:e,reject:o,imResponse:t})})).catch((e=>{o(e)}))}))}onChatEvent(){this.chat.on(this.EVENT.SDK_READY,this.onSDKReady,this),this.chat.on(this.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.chat.on(this.EVENT.KICKED_OUT,this.onUserKicked,this),this.isOnChatEvent=!0}offChatEvent(){this.isOnChatEvent&&(this.chat.off(this.EVENT.SDK_READY,this.onSDKReady,this),this.chat.off(this.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.chat.off(this.EVENT.KICKED_OUT,this.onUserKicked,this),this.isOnChatEvent=!1)}onSDKReady(){if(this.loginStatusPromise.has("login")){this.TUICore.notifyEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS);const e=setTimeout((()=>{const t=this.loginStatusPromise.get("login");t.resolve(t.imResponse),clearTimeout(e),this.loginStatusPromise.delete("login")}),500)}}onSDKNotReady(){this.loginStatusPromise.has("login")&&this.loginStatusPromise.get("login").reject(new Error("sdk not ready")),this.loginStatusPromise.delete("login")}onUserKicked(e){e.data.type!==this.TYPES.KICKED_OUT_USERSIG_EXPIRED?this.TUICore.notifyEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_KICKED_OFFLINE):this.TUICore.notifyEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_SIG_EXPIRED)}registerPlugin(e){const{useUploadPlugin:t=!1,useProfanityFilterPlugin:n=!1,TUIOfflinePush:o,offlinePushConfig:a,TIMPush:i,pushConfig:r}=e;!0===t&&this.chat.registerPlugin({"tim-upload-plugin":Ye}),!0===n&&this.chat.registerPlugin({"tim-profanity-filter-plugin":Je}),ft&&i&&r&&this.chat.registerPlugin({"tim-push":i,pushConfig:r}),ft&&o&&a&&this.chat.registerPlugin({"tim-offline-push-plugin":o,offlinePushConfig:a})}getStatScene(e){let t;return e&&et.indexOf(e)>-1&&(t=this.genStatScene(e)),t}genStatScene(e){if("rn"===e)return"k-rn";let t="";return it?(ht&&(t=`k-${e}-pc-uni`),pt&&(t=`k-${e}-h5-uni`),ft&&(t=`k-${e}-app-uni`),ot&&(t=`k-${e}-mp-uni`),t):(ht&&(t=`k-${e}-pc`),pt&&(t=`k-${e}-h5`),t)}},vt=class{constructor(){this.eventMap=new Map}registerEvent(e,t,n){const o=this.getKey(e,t);if(!this.eventMap.has(o)){const e=[];this.eventMap.set(o,e)}const a=this.eventMap.get(o);-1===a.indexOf(n)&&(a.push(n),this.renotify(e,t,n))}unregisterEvent(e,t,n){const o=this.getKey(e,t);if(this.eventMap.has(o)){const e=this.eventMap.get(o),t=e.indexOf(n);t>-1&&e.splice(t,1)}}notifyEvent(e,t,n){const o=this.getKey(e,t);n&&JSON.stringify(n);this.eventMap.has(o)&&this.eventMap.get(o).forEach((o=>{o.onNotifyEvent(e,t,n)}))}getKey(e,t){let n=e;return t&&(n=`${e}-${n}`),n}renotify(e,t,n){if(e===nt.TUILogin.EVENT.LOGIN_STATE_CHANGED&&t===nt.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS){const{chat:e}=mt.getInstance().getContext();e&&e.isReady()&&n.onNotifyEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS)}}};const _t=class e{constructor(){this.serviceManager=new Xe,this.extensionManager=new Qe,this.eventManager=new vt}static getInstance(){return e.instance||(e.instance=new e),e.instance}registerService(e,t){return this.serviceManager.registerService(e,t)}unregisterService(e){return this.serviceManager.unregisterService(e)}getService(e){return this.serviceManager.getService(e)}callService(e){return this.serviceManager.callService(e)}registerExtension(e,t){return this.extensionManager.registerExtension(e,t)}unregisterExtension(e,t){return this.extensionManager.unregisterExtension(e,t)}getExtensionList(e,t){return this.extensionManager.getExtensionList(e,t)}registerEvent(e,t,n){return this.eventManager.registerEvent(e,t,n)}unregisterEvent(e,t,n){return this.eventManager.unregisterEvent(e,t,n)}notifyEvent(e,t,n){return this.eventManager.notifyEvent(e,t,n)}}.getInstance(),yt=mt.getInstance(_t),It=Ve("user",(()=>{const t=e.ref(""),n=e.ref({}),o=e.computed((()=>!!t.value));return{token:t,setToken:e=>{t.value=e},userInfo:n,setUserInfo:e=>{n.value=e},getUserInfo:()=>n.value,logout:()=>{yt.logout().then((()=>{t.value="",n.value={},uni.reLaunch({url:"/pages/asplash/index"})})).catch((()=>{t.value="",n.value={},uni.reLaunch({url:"/pages/asplash/index"})}))},isLogined:o}}),{persist:!0}),Ct=Ve("common",(()=>{const t=e.ref({});return{dataMap:t,setDataMap:e=>{t.value=e},getDeviceStatusBarheight:()=>(oe("log","at store/common.ts:9",uni.getSystemInfoSync()),uni.getSystemInfoSync().statusBarHeight)}}),{persist:!0}),kt=function(){const t=e.effectScope(!0),n=t.run((()=>e.ref({})));let o=[],a=[];const i=e.markRaw({install(e){Me(i),i._a=e,e.provide(we,i),e.config.globalProperties.$pinia=i,a.forEach((e=>o.push(e))),a=[]},use(e){return this._a?o.push(e):a.push(e),this},_p:o,_a:null,_e:t,_s:new Map,state:n});return i}();kt.use(function(e={}){return t=>{const{auto:n=!1}=e,{options:{persist:o=n},store:a,pinia:i}=t;if(!o)return;if(!(a.$id in i.state.value)){const e=i._s.get(a.$id.replace("__hot:",""));return void(e&&Promise.resolve().then((()=>e.$persist())))}const r=(Array.isArray(o)?o.map((t=>Be(t,e))):[Be(o,e)]).map(function(e,t){return n=>{var o;try{const{storage:a=localStorage,beforeRestore:i,afterRestore:r,serializer:s={serialize:JSON.stringify,deserialize:JSON.parse},key:l=t.$id,paths:c=null,debug:u=!1}=n;return{storage:a,beforeRestore:i,afterRestore:r,serializer:s,key:(null!=(o=e.key)?o:e=>e)("string"==typeof l?l:l(t.$id)),paths:c,debug:u}}catch(vs){return n.debug,null}}}(e,a)).filter(Boolean);a.$persist=()=>{r.forEach((e=>{Fe(a.$state,e)}))},a.$hydrate=({runHooks:e=!0}={})=>{r.forEach((n=>{const{beforeRestore:o,afterRestore:i}=n;e&&(null==o||o(t)),Ge(a,n),e&&(null==i||i(t))}))},r.forEach((e=>{const{beforeRestore:n,afterRestore:o}=e;null==n||n(t),Ge(a,e),null==o||o(t),a.$subscribe(((t,n)=>{Fe(n,e)}),{detached:!0})}))}}({storage:{getItem:uni.getStorageSync,setItem:uni.setStorageSync}}));const Et=(t=0,n=0,o=0,a=0)=>{const i=e.ref("");return e.onMounted((()=>{const e=uni.getSystemInfoSync(),{top:r,right:s,left:l,bottom:c}=e.safeAreaInsets;i.value=`${r+t}px ${s+n}px ${c+o}px ${l+a}px`})),{pagePadding:i}},Tt=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(20,15,20,15),{isLogined:o}=It(),a=e.ref(""),i=()=>{"relogin"===a.value?uni.navigateTo({url:"/pages/login/index"}):o?uni.switchTab({url:"/pages/connect/index"}):uni.navigateTo({url:"/pages/login/index"})},r=()=>{"ios"===uni.getSystemInfoSync().platform?uni.showToast({title:"请点击确认按钮进入APP",icon:"none"}):plus.runtime.quit()},s=e=>{uni.navigateTo({url:`/pages/policy/index?code=${e}`})};return ce((e=>{a.value=e.type,o&&uni.reLaunch({url:"/pages/connect/index"})})),(t,a)=>{const l=ae(e.resolveDynamicComponent("wd-img"),te),c=ae(e.resolveDynamicComponent("wd-text"),me),u=ae(e.resolveDynamicComponent("wd-button"),Te);return e.withDirectives((e.openBlock(),e.createElementBlock("view",{class:"asplash_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"content"},[e.createVNode(l,{class:"w-48px h-48px mb-10px",src:"/static/images/bell.png"}),e.createElementVNode("view",{class:"title"},"温馨提示"),e.createElementVNode("view",{class:"desc"},[e.createElementVNode("view",{class:"line"},"欢迎您使用梦缘婚恋的服务!"),e.createTextVNode(" 在您使用梦缘婚恋APP前，请您认真阅读并充分理解 "),e.createVNode(c,{text:"《会员协议》",color:"#000000",onClick:a[0]||(a[0]=e=>s("MEMBERSHIP_AGREEMENT"))}),e.createTextVNode(" 、 "),e.createVNode(c,{text:"《隐私政策》",color:"#000000",onClick:a[1]||(a[1]=e=>s("PRIVACY_POLICY"))}),e.createTextVNode(" 、 "),e.createVNode(c,{text:"《权限获取清单》",color:"#000000",onClick:a[2]||(a[2]=e=>s("PERMISSION_LIST"))}),e.createTextVNode(" 、 "),e.createVNode(c,{text:"《三方SDK清单》",color:"#000000",onClick:a[3]||(a[3]=e=>s("THIRD_PARTY_SDK_LIST"))}),e.createTextVNode(" 、 "),e.createVNode(c,{text:"《信息共享清单》",color:"#000000",onClick:a[4]||(a[4]=e=>s("INFORMATION_SHARING_LIST"))}),e.createTextVNode(" 和 "),e.createVNode(c,{text:"《注册承诺函》",color:"#000000",onClick:a[5]||(a[5]=e=>s("REGISTRATION_COMMITMENT"))}),e.createTextVNode(" ，点击“同意”即表示您已阅读并同意全部条款；如您点击“不同意”，将可能导致您无法继续使用梦缘婚恋的产品或服务。 "),e.createElementVNode("view",{class:"line"},"梦缘婚恋非常重视您的个人信息保护。特向您说明如下："),e.createElementVNode("view",{class:"line"}," 1、为了保障平台网络安全和运营安全，梦缘婚恋需获取的必要权限为存储权限和设备权限(收集设备信息)。 "),e.createElementVNode("view",{class:"line"}," 2、为了给您推荐身边优质异性，提高交友竟争力，助您早日找到对象，还需您在注册时填写公开展示的所在地、学历、收入区间和身高。 "),e.createElementVNode("view",{class:"line"}," 3、地理位置、摄像头、麦克风、相册杈限均不会默认开启，只有经过您的明示授权才会在为实现特定功能或服务时使用，您也可以改变或撤回授权。 ")]),e.createElementVNode("view",{class:"btn"},[e.createVNode(u,{class:"btnColor w-100%",size:"large",onClick:i},{default:e.withCtx((()=>[e.createTextVNode("同意")])),_:1}),e.createElementVNode("view",{class:"cancelBtn",onClick:r},"不同意")])])],4)),[[e.vShow,!e.unref(o)]])}}}),[["__scopeId","data-v-e255c514"]]),St=__spreadProps(__spreadValues({},X),{modelValue:{type:[Boolean,String,Number],required:!0,default:!1},disabled:$(!1),activeValue:{type:[Boolean,String,Number],default:!0},inactiveValue:{type:[Boolean,String,Number],default:!1},activeColor:String,inactiveColor:String,size:{type:q},beforeChange:Function}),Mt=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-switch",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:St,emits:["change","update:modelValue"],setup(t,{emit:n}){const o=t,a=n,i=e.computed((()=>`wd-switch ${o.customClass} ${o.disabled?"is-disabled":""} ${o.modelValue===o.activeValue?"is-checked":""}`)),r=e.computed((()=>{const e={background:o.modelValue===o.activeValue?o.activeColor:o.inactiveColor,"border-color":o.modelValue===o.activeValue?o.activeColor:o.inactiveColor};return o.size&&(e["font-size"]=v(o.size)),`${P(e)};${o.customStyle}`})),s=e.computed((()=>o.modelValue===o.activeValue&&o.activeColor||o.modelValue!==o.activeValue&&o.inactiveColor?"box-shadow: none;":""));function l(){if(o.disabled)return;const e=o.modelValue===o.activeValue?o.inactiveValue:o.activeValue;o.beforeChange&&R(o.beforeChange)?o.beforeChange({value:e,resolve:t=>{t&&(a("update:modelValue",e),a("change",{value:e}))}}):(a("update:modelValue",e),a("change",{value:e}))}return e.onBeforeMount((()=>{-1===[o.activeValue,o.inactiveValue].indexOf(o.modelValue)&&(a("update:modelValue",o.inactiveValue),a("change",{value:o.inactiveValue}))})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(i.value),style:e.normalizeStyle(r.value),onClick:l},[e.createElementVNode("view",{class:"wd-switch__circle",style:e.normalizeStyle(s.value)},null,4)],6))}})),[["__scopeId","data-v-af546640"]]);function wt(t){const n=e.inject(t,null);if(n){const t=e.getCurrentInstance(),{link:o,unlink:a,internalChildren:i}=n;o(t),e.onUnmounted((()=>a(t)));return{parent:n,index:e.computed((()=>i.indexOf(t)))}}return{parent:null,index:e.ref(-1)}}const bt=Symbol("wd-cell-group");function Dt(){const{parent:t,index:n}=wt(bt);return{border:e.computed((()=>t&&t.props.border&&n.value))}}__spreadValues({},X);const Nt=Symbol("wd-form"),Rt=__spreadProps(__spreadValues({},X),{model:K(Object),rules:{type:Object,default:()=>({})},resetOnChange:$(!0),errorType:{type:String,default:"message"}}),Lt=e.ref("zh-CN"),At=e.reactive({"zh-CN":{calendar:{placeholder:"请选择",title:"选择日期",day:"日",week:"周",month:"月",confirm:"确定",startTime:"开始时间",endTime:"结束时间",to:"至",timeFormat:"YY年MM月DD日 HH:mm:ss",dateFormat:"YYYY年MM月DD日",weekFormat:(e,t)=>`${e} 第 ${t} 周`,startWeek:"开始周",endWeek:"结束周",startMonth:"开始月",endMonth:"结束月",monthFormat:"YYYY年MM月"},calendarView:{startTime:"开始",endTime:"结束",weeks:{sun:"日",mon:"一",tue:"二",wed:"三",thu:"四",fri:"五",sat:"六"},rangePrompt:e=>`选择天数不能超过${e}天`,rangePromptWeek:e=>`选择周数不能超过${e}周`,rangePromptMonth:e=>`选择月份不能超过${e}个月`,monthTitle:"YYYY年M月",yearTitle:"YYYY年",month:"M月",hour:e=>`${e}时`,minute:e=>`${e}分`,second:e=>`${e}秒`},collapse:{expand:"展开",retract:"收起"},colPicker:{title:"请选择",placeholder:"请选择",select:"请选择"},datetimePicker:{start:"开始时间",end:"结束时间",to:"至",placeholder:"请选择",confirm:"完成",cancel:"取消"},loadmore:{loading:"正在努力加载中...",finished:"已加载完毕",error:"加载失败",retry:"点击重试"},messageBox:{inputPlaceholder:"请输入",confirm:"确定",cancel:"取消",inputNoValidate:"输入的数据不合法"},numberKeyboard:{confirm:"完成"},pagination:{prev:"上一页",next:"下一页",page:e=>`当前页：${e}`,total:e=>`当前数据：${e}条`,size:e=>`分页大小：${e}`},picker:{cancel:"取消",done:"完成",placeholder:"请选择"},imgCropper:{confirm:"完成",cancel:"取消"},search:{search:"搜索",cancel:"取消"},steps:{wait:"未开始",finished:"已完成",process:"进行中",failed:"失败"},tabs:{all:"全部"},upload:{error:"上传失败"},input:{placeholder:"请输入..."},selectPicker:{title:"请选择",placeholder:"请选择",select:"请选择",confirm:"确认",filterPlaceholder:"搜索"},tag:{placeholder:"请输入",add:"新增标签"},textarea:{placeholder:"请输入..."},tableCol:{indexLabel:"序号"},signature:{confirmText:"确认",clearText:"清空"}}}),Ot={messages:()=>At[Lt.value],use(e,t){Lt.value=e,t&&this.add({[e]:t})},add(e={}){B(At,e)}},Pt=e=>{const t=e?e.replace(/-(\w)/g,((e,t)=>t.toUpperCase()))+".":"";return{translate:(e,...n)=>{const o=Ot.messages(),a=F(o,t+e);return R(a)?a(...n):a}}},Ut=__spreadProps(__spreadValues({},X),{customTextareaContainerClass:J(""),customTextareaClass:J(""),customLabelClass:J(""),modelValue:Z(""),placeholder:String,placeholderStyle:String,placeholderClass:J(""),disabled:$(!1),maxlength:W(-1),autoFocus:$(!1),focus:$(!1),autoHeight:$(!1),fixed:$(!1),cursorSpacing:W(0),cursor:W(-1),confirmType:String,confirmHold:$(!1),showConfirmBar:$(!0),selectionStart:W(-1),selectionEnd:W(-1),adjustPosition:$(!0),disableDefaultPadding:$(!1),holdKeyboard:$(!1),showPassword:$(!1),clearable:$(!1),readonly:$(!1),prefixIcon:String,showWordLimit:$(!1),label:String,labelWidth:J(""),size:String,error:$(!1),center:$(!1),noBorder:$(!1),required:$(!1),prop:J(""),rules:Y(),clearTrigger:J("always"),focusWhenClear:$(!0),ignoreCompositionEvent:$(!0),inputmode:J("text")}),xt=e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-textarea",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Ut,emits:["update:modelValue","clear","blur","focus","input","keyboardheightchange","confirm","linechange","clickprefixicon","click"],setup(t,{emit:n}){const{translate:o}=Pt("textarea"),a=t,i=n,r=e.useSlots(),s=e.computed((()=>C(a.placeholder)?a.placeholder:o("placeholder"))),l=e.ref(!1),c=e.ref(!1),u=e.ref(!1),d=e.ref(""),p=Dt();e.watch((()=>a.focus),(e=>{c.value=e}),{immediate:!0,deep:!0}),e.watch((()=>a.modelValue),(e=>{d.value=C(e)?String(e):""}),{immediate:!0,deep:!0});const{parent:h}=wt(Nt),f=e.computed((()=>{const{disabled:e,readonly:t,clearable:n,clearTrigger:o}=a;return!(!n||t||e||!d.value||!("always"===o||"focus"===a.clearTrigger&&u.value))})),g=e.computed((()=>{const{disabled:e,readonly:t,maxlength:n,showWordLimit:o}=a;return Boolean(!e&&!t&&C(n)&&n>-1&&o)})),m=e.computed((()=>h&&a.prop&&h.errorMessages&&h.errorMessages[a.prop]?h.errorMessages[a.prop]:"")),v=e.computed((()=>{let e=!1;if(h&&h.props.rules){const t=h.props.rules;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n===a.prop&&Array.isArray(t[n])&&(e=t[n].some((e=>e.required)))}return a.required||a.rules.some((e=>e.required))||e})),_=e.computed((()=>String(S(a.modelValue)||"").length)),y=e.computed((()=>`wd-textarea   ${a.label||r.label?"is-cell":""} ${a.center?"is-center":""} ${p.border.value?"is-border":""} ${a.size?"is-"+a.size:""} ${a.error?"is-error":""} ${a.disabled?"is-disabled":""} ${a.autoHeight?"is-auto-height":""} ${_.value>0?"is-not-empty":""}  ${a.noBorder?"is-no-border":""} ${a.customClass}`)),I=e.computed((()=>`wd-textarea__label ${a.customLabelClass} ${v.value?"is-required":""}`)),k=e.computed((()=>`wd-textarea__placeholder  ${a.placeholderClass}`)),E=e.computed((()=>`${_.value>0?"wd-textarea__count-current":""} ${_.value>a.maxlength?"is-error":""}`)),T=e.computed((()=>a.labelWidth?P({"min-width":a.labelWidth,"max-width":a.labelWidth}):""));function S(e){const{maxlength:t,showWordLimit:n}=a;return n&&-1!==t&&String(e).length>t?e.toString().substring(0,t):`${e}`}function M(){return __async(this,null,(function*(){l.value=!0,u.value=!1,d.value="",a.focusWhenClear&&(c.value=!1),yield U(),a.focusWhenClear&&(c.value=!0,u.value=!0),i("update:modelValue",d.value),i("clear")}))}function w(e){return __async(this,arguments,(function*({detail:e}){yield U(150),l.value?l.value=!1:(u.value=!1,i("blur",{value:d.value,cursor:e.cursor?e.cursor:null}))}))}function b({detail:e}){u.value=!0,i("focus",e)}function D({detail:e}){d.value=S(d.value),i("update:modelValue",d.value),i("input",e)}function N({detail:e}){i("keyboardheightchange",e)}function R({detail:e}){i("confirm",e)}function L({detail:e}){i("linechange",e)}function A(){i("clickprefixicon")}return e.onBeforeMount((()=>{d.value=S(d.value),i("update:modelValue",d.value)})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(y.value),style:e.normalizeStyle(t.customStyle)},[t.label||t.$slots.label?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(I.value),style:e.normalizeStyle(T.value)},[t.prefixIcon||t.$slots.prefix?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-textarea__prefix"},[t.prefixIcon&&!t.$slots.prefix?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-textarea__icon",name:t.prefixIcon,onClick:A},null,8,["name"])):e.renderSlot(t.$slots,"prefix",{key:1},void 0,!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-textarea__label-inner"},[t.label&&!t.$slots.label?(e.openBlock(),e.createElementBlock("text",{key:0},e.toDisplayString(t.label),1)):e.renderSlot(t.$slots,"label",{key:1},void 0,!0)])],6)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(`wd-textarea__value ${f.value?"is-suffix":""} ${t.customTextareaContainerClass} ${g.value?"is-show-limit":""}`)},[e.withDirectives(e.createElementVNode("textarea",{class:e.normalizeClass(`wd-textarea__inner ${t.customTextareaClass}`),"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e),"show-count":!1,placeholder:s.value,disabled:t.disabled||t.readonly,maxlength:t.maxlength,focus:c.value,"auto-focus":t.autoFocus,"placeholder-style":t.placeholderStyle,"placeholder-class":k.value,"auto-height":t.autoHeight,"cursor-spacing":t.cursorSpacing,fixed:t.fixed,cursor:t.cursor,"show-confirm-bar":t.showConfirmBar,"selection-start":t.selectionStart,"selection-end":t.selectionEnd,"adjust-position":t.adjustPosition,"hold-keyboard":t.holdKeyboard,"confirm-type":t.confirmType,"confirm-hold":t.confirmHold,"disable-default-padding":t.disableDefaultPadding,ignoreCompositionEvent:t.ignoreCompositionEvent,inputmode:t.inputmode,onInput:D,onFocus:b,onBlur:w,onConfirm:R,onLinechange:L,onKeyboardheightchange:N},null,42,["placeholder","disabled","maxlength","focus","auto-focus","placeholder-style","placeholder-class","auto-height","cursor-spacing","fixed","cursor","show-confirm-bar","selection-start","selection-end","adjust-position","hold-keyboard","confirm-type","confirm-hold","disable-default-padding","ignoreCompositionEvent","inputmode"]),[[e.vModelText,d.value]]),m.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-textarea__error-message"},e.toDisplayString(m.value),1)):e.createCommentVNode("",!0),t.readonly?(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-textarea__readonly-mask"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-textarea__suffix"},[f.value?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-textarea__clear",name:"error-fill",onClick:M})):e.createCommentVNode("",!0),g.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-textarea__count"},[e.createElementVNode("text",{class:e.normalizeClass(E.value)},e.toDisplayString(_.value),3),e.createTextVNode(" /"+e.toDisplayString(t.maxlength),1)])):e.createCommentVNode("",!0)])],2)],6))}})),Vt=ee(xt,[["__scopeId","data-v-b6a06076"]]),Bt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAD1BMVEVHcExRUVFMTExRUVFRUVE9CdWsAAAABHRSTlMAjjrY9ZnUjwAAAQFJREFUWMPt2MsNgzAMgGEEE1B1gKJmAIRYoCH7z9RCXrabh33iYktcIv35EEg5ZBh07pvxJU6MFSPOSRnjnBUjUsaciRUjMsb4xIoRCWNiYsUInzE5sWKEyxiYWDbyefqHx1zIeiYTk7mQYziTYecxHvEJjwmIT3hMQELCYSISEg4TkZj0mYTEpM8kJCU9JiMp6TEZyUmbAUhO2gxAQNJiIAKSFgMRmNQZhMCkziAEJTUGIyipMRjBSZkhCE7KDEFIUmTeGCHJxWz0zXaE0GTCG8ZFtEaS347r/1fe11YyHYVfubxayfjoHmc0YYwmmmiiiSaaaKLJ7ckyz5ve+dw3Xw2emdwm9xSbAAAAAElFTkSuQmCC",Gt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAElBMVEVHcEz///////////////////+IGTx/AAAABnRSTlMA/dAkXZOhASU/AAABYElEQVRYw+2YwXLCIBCGsdAHWGbyAKZ4zxi9O017rxLf/1UaWFAgA1m8dcpedNSPf/l/Vh0Ya/Wn6hN0JcGvoCqRM4C8VBFiDwBqqNuJKV0rAnCgy3AUqZE57x0iqTL8Br4U3WBf/YWaIlTKfAcELU/h9w72CSVPa3C3OCDvhpHbRp/s2vq4fHhCeiCl2A3m4Qd71DQR257mFBlMcTlbFnFWzNtHxewYEfSiaLS4el8d8nyhmKJd1CF4eOS0keLMAuSxubLBIeIGQW8YHCFFo7EH9+YDcQt9FMZEswTheaNxTHwHT8SZorJjMrEVwo4Zo0U8HSEyZvJMOg4RjnmmRr8nDYeIz3OMkbfE/QhBo+U9RnZJxjGCRh/WKmHEMWLNkfPKsGh/CWJk1JjG0kcuJggTt34VDP8aWAFhp4nybVb5+9qQhjSkIQ1pSEMa8k+Q5U9rV3dF8MpFBK+/7miVq1/HZ2qmo9D+pAAAAABJRU5ErkJggg==",Ft="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAKlBMVEVHcEzDw8Ovr6+pqamUlJTCwsKenp61tbWxsbGysrLNzc2bm5u5ubmjo6MpovhuAAAACnRSTlMA/P79/sHDhiZS0DxZowAABBBJREFUWMPtl89rE0EUx7ctTXatB3MI1SWnDbUKPUgXqh4ED8Uf7KUVSm3ooVSpSii0Fn/gD4j4o+APiEoVmos9FO2celiqZVgwgaKHPQiCCkv+F99kM7Ozm5kxq1dfD91k9pPve9/3ZjbRNHHok/mKli4eIPNgSuRObuN9SqSEzM20iGnm0yIbqCuV7NSSSIV7uyPM6JMBYdeTOanh/QihJYZsUCSby+VkMj2AvOt0rAeQAwqE3lfKMZVlQCZk1QOCKkkVPadITCfIRNKxfoJI5+0OIFtJx14CMSg1mRSDko7VAfksRQzEbGYqxOJcVTWMCH2I1/IACNW0PWU2M8cmAVHtnH5mM1VRWtwKZjOd5JbF6s1IbaYqaotjNlPHgDAnlAizubTR6ovMYn052g/U5qcmOpi0WL8xTS/3IfSet5m8MEr5ajjF5le6dq/OJpobrdY0t3i9QgefWrxW9/1BLhk0E9m8FeUMhhXal499iD0eQRfDF+ts/tttORRerfp+oV7f4xJj82iUYm1Yzod+ZQEAlS/8mMBwKebVmCVp1f0JLS6zKd17+iwRKTARVg2SHtz3iEbBH+Q+U28zW2Jiza8Tjb1YFoYZMsJyjDqp3M9XBQdSdPLFdxEpvOB37JrHcmR/y9+LgoTlCFGZEa2sc6d4PGlweEa2JSVPoVm+IfGG3ZL037iV9oH+P+Jxc4HGVflNq1M0pivao/EopO4b/ojVCP9GjmiXOeS0DOn1o/iiccT4ORnyvBGF3yUywkQajW4Ti0SGuiy/wVSg/L8w+X/8Q+hvUx8Xd90z4oV5a1i88MbFWHz0WZZ1UrTwBGPX3Rat9AFiXRMRjoMdIdJLEOt2h7jrYOzgOamKZSWSNspOS0X8SAqRYmxRL7sg4eLzYmNehcxh3uoyud/BH2Udux4ywxFTc1xC7Mgf4vMhc5S+kSH3Y7yj+qpwIWSoPTVCOOPVthGx9FbGqrwFw6wSFxJr+17zeKcztt3u+2roAEVgUjDd+AHGuxHy2rZHaa8JMkTHEeyi85ANPO9j9BVuBRD2FY5LDMo/Sz/2hReqGIs/KiFin+CsPsYO/yvM3jL2vE8EbX7/Bf8ejtr2GLN65bioAdgLd8Bis/mD5GmP2qeqyo2ZwQEOtAjRIDH7mBKpUcMoApbZJ5UIxkEwxyMZyMxW/uKFvHCFR3SSmerHyDNQ2dF4JG6zIMpBgLfjSF9x1D6smFcYnGApjmSLICO3ecCDWrQ48geba9DI3STy2i7ax6WIB62fSyIZIiO3GFQqSURp8wCo7GhJBGwuSovJBNjb7kT6FPVnIa9qJ2Ko+l9mefGIdinaMp0yC1URYiwsdfNE45EuA5Cx9EhalfvN5s+UyItm81vaB3p4joniN+SCP7Qc1hblAAAAAElFTkSuQmCC",zt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAElBMVEX///9HcEz///////////////84chYNAAAABnRSTlP/AGzCOYZj5g1nAAACfklEQVRYw+2YTVPDIBCGtza9Jw25a0bvcax30o73OOr//yvma2F3YWlpPTijXNpAHrK8LLALVPFium2vNIFSbwGKTGQA2GUiHcD29yDNy3sMIdUBQl7r2H8mOEVqAHgPkYZUS6Qc2zYhQqtjyDZEximCZwWZLIBeIgYShs2NzxKpSUehYpMJhURGb+O+w5BpMCAREKPnCDHbIY20SzhM5yxziAXpOiBXydrekT9i5XDEq4NIIHHgyU5mRGqviII4mREJJA4QJzMiILwlRJzpKxJKvCBm8OsBBbLux0tsPl4RKYm5aPu6jw1U4mGxEUR9g8M1PcqBEp/WJliNgYOXueBzS4jZSIcgY5lCtevgDSgyzE+rAfuOTQMq0yzvoGH18qju27Mayzs4fPyMziCx81NJa5RNfW7vPYK9KOfDiVkBxFHG8hAj9txuoBuSWORsFfkpBf7xKFLSeaOefEojh5jz22DJEqMP8fUyaKdQx+RnG+yXMpe8Aars8ueR1pVH/bW3FyyvPRw90upLDHwpgBDtg4aUBNkxRLXMAi03IhcZtr1m+FeI/O/JNyDmmL1djLOauSlNflBpW18RQ2bPqXI22MXXEk75KRHTnkPkYbESbdKP2ZFk0r5sIwffAjy1lx+vx7NLjB6/E7Jfv5ERKhzpN0w8IDE8IGFDv5dhz10s7GFiXRZcUeLCEG5P5nDq9k4PFDcoMpE3GY4OuxuCXhmuyNB6k0RsLIAvqp9NE5r8ZCSS8gxnUp7ODdYhZTqxuiJ9uyJJtPmpqJ7wVj+XVieS903iViHziqAhchLEJAyb7jWU647EpUofQ0ziUuXXXhDddtlllSwjgSQu7r4BRWhQqfDPMVwAAAAASUVORK5CYII=",Ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAElBMVEVRUVFHcExTU1NRUVFRUVFRUVFOSlSUAAAABnRSTlP/AI6+VySB3ZENAAACcElEQVRYw+2YyYKCMAyGI8hdpdxdZu7gcpdZ7jL6/s8yYheSNi0aPdqbwOffpGmaFOYPD3gj4bisN7vddv17N/JVgxn5x12IWgIaWTuO/IE3PseQbwjGPo2cgRmHFLJwdm/X643zwiqOKPPJ1nj3sjEP2iiifZWj5bhopSyGaEO2HX5fbQJzwJ+W7x/jw5ZFjsEU0PMph9xE8i5EqprKALW95eJQURkgzw98uJ/JvwGecR7bIjWWsUgVrrIfFZ2HlLy3sKETD1mmRLRMRhGVssRa0xJkdn3SpJBymBkM8+pSSDXMDNyDaToVHd2fgpNt0sjwiUZO19+jGQ+gQEg9Oq+bufmAVGihomNmjQG7UG3020vrlm7lkFnKFGU3kZ0KGAdmKe821pipQ+qEKcrZeTL2g5FsUks4cStjEZWwXg0b0n4GxmEpkWwIs5VBynjgK7xZaz1/0D7OxkVuLpsY5BQNFyLS84VBjjbg0iL2r2EQHBOxBhikuUOkdxODVF1cxHoWtPPsiyXO455Iv34hssCO8EV4ZIYTjS8SR4qYSHRiTiYQ4ZFbHi0iIhhBTi6dTCgSWRcnw4h4yGTuyTAiOGBIWGoZTgSHJQl+LcOJ4OCnW6yX2bMnJ9pidCOXtkTkTrIGpYuOynAiOF14SamMiOCk5Ke+mq8BcOrrvym8d0zKIQnWT+M1WwOQNO4fFiWb18hhERxJPx2fblbPHHyC41VyiAtKBUFBIih7JMWVoIQTFIr3lKPN80WvoLSWFPC653ioTZA0I0FrQ7qU6asaK0H7JmkSJa2ooOGVtNUsc3j9FYHkIkJy3SG6VHnfXKXGP9t4N9Q4Ye98AAAAAElFTkSuQmCC",jt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkBAMAAACCzIhnAAAAGFBMVEVHcEz///////////////////////////8dS1W+AAAAB3RSTlMAiVYk6KvDHLfaegAAAo1JREFUWMPtWEtzmzAQNhCTq910ytXpiyvxTNOr60zrayepx9d02gnX4sTm7xcEiJX2gdnkGJ1A4tOnfWqXyeR1vMRYzrcPD9v5h5MBl3/Ldvx4cxIg/FWC8X0xjLjalM54uhhCfCrRuJURX0pi3EmIqZV7O59vrRZmguStHL9b7S7ftfLwOtiZDw7AHMtmquAQ12b5Wwbnordm8g9zLLO49qc/m2n6aKnhwPOGZ08hAiNHhheiHae1lOUPGZpQkPKa3q0mOUjaRzSRaGUjpy/mmWSwySSpllcEteBKAT52KEnSbblA51pJEPxBQoiH1FP4E3s5+FJv07h6/ylD6ui7B+9fq/ehrFB98ghec9EoVtyjK8pqCHLmCBOwMWSCeWFNN4MbPAk55NhsvoFHSSVR0k5TCTTEzlUGcqV/nVp7n9oIVkmtaqbAEqEgfdgHJPwsEAyZ9r4VAZXFjpEwyaw3+H2v42KYxKhs1XvY/gSSGv+IHyUSuHXCeZhLAgVI3EjgSGo1Fb3xO0tGGU9S2/KAIbtjxpJASG73qox6w5LUq0cEOa+iIONIWIilQSQ0pPa2jgaRQAgQP7c0mITRWGxpMAmEQFN2NAQJNCV0mI6GIIEO47hlQ0ORQLd0nL+hoUjg1m6I1TRr8uYEAriBHLcVFQ5UEMiBe3XkTBEG04WXlGKGxPnMS305XQPA1Ocn2JiuAZwE66fxnKwBnDTuXxZTMq85lwW6kt5ndLqZPefiU1yvmktcUSooChJF2aMprhQlnKJQ5FxRKkcVRa+itNYU8Io2oVkY14w0NMWYlqft91Bj9VHq+ca3b43BxjWJmla0sfKohlfTVpPN+93L/yLQ/IjQ/O5Q/VR5HdL4D7mlxmjwVdELAAAAAElFTkSuQmCC",qt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAALeGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDg4LCAyMDIwLzA3LzEwLTIyOjA2OjUzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTIyVDIxOjIxOjQ1KzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDI0LTAxLTEzVDE5OjA5OjQwKzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wMS0xM1QxOTowOTo0MCswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ZWQwMWYzNWQtOWRjOC00MDBiLWEyMmQtNjM5OGZiNzVhNGRiIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6ZDhlMzQ3ZmEtMDY2My1jYTRiLTgzNTctNTk4YjBkNGIzOTU2IiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZDA4MDI4MDItMzUyYS04NTRhLTkxYjctNmRlNmQ1MmViM2QwIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHRpZmY6T3JpZW50YXRpb249IjEiIHRpZmY6WFJlc29sdXRpb249IjMwMDAwMDAvMTAwMDAiIHRpZmY6WVJlc29sdXRpb249IjMwMDAwMDAvMTAwMDAiIHRpZmY6UmVzb2x1dGlvblVuaXQ9IjIiIGV4aWY6Q29sb3JTcGFjZT0iMSIgZXhpZjpQaXhlbFhEaW1lbnNpb249IjMwMCIgZXhpZjpQaXhlbFlEaW1lbnNpb249IjMwMCI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZDA4MDI4MDItMzUyYS04NTRhLTkxYjctNmRlNmQ1MmViM2QwIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTIyVDIxOjIxOjQ1KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQwNjg2NzJkLWY5NDMtOTU0Mi1iMDBiLTVlMDExNmE1NmIzZSIgc3RFdnQ6d2hlbj0iMjAyNC0wMS0xM1QxMDoyNjoxNiswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDphYmJkZmUyZC0xY2Q2LTJiNDgtYjUyNS05YzlhZjdlNjA4NDMiIHN0RXZ0OndoZW49IjIwMjQtMDEtMTNUMTE6MjM6NDArMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6YTQ5MjM5MDAtNDhiZC03YTQ1LWI4NGItYmVlZTVjOWUxYTM1IiBzdEV2dDp3aGVuPSIyMDI0LTAxLTEzVDExOjIzOjQwKzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOmVkMDFmMzVkLTlkYzgtNDAwYi1hMjJkLTYzOThmYjc1YTRkYiIgc3RFdnQ6d2hlbj0iMjAyNC0wMS0xM1QxOTowOTo0MCswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjAgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmFiYmRmZTJkLTFjZDYtMmI0OC1iNTI1LTljOWFmN2U2MDg0MyIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjM2ZGQ4NTQxLWQ0MWEtYmY0Yy1iZjA3LWNmNjZhNjZhMDg2MSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmQwODAyODAyLTM1MmEtODU0YS05MWI3LTZkZTZkNTJlYjNkMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pm30U/gAAAAJcEhZcwAALiMAAC4jAXilP3YAAAA/UExURUdwTODg4O3t7e7u7unp6d7e3uTk5M/Pz8nJyePj4+jo6Pj4+MrKyszMzO7u7unp6fb29vLy8vr6+v7+/sHBweag3xAAAAAOdFJOUwAxia5pF0n+/vzX3KbULQ2DYQAACG1JREFUeNrtm4l2o7gShi20IWFrAd7/WUc7EosDWKZ976Hc7WTmdMKXv0qlqpLyeNx222233Xbbbbfddtv/mOHn8xexSNsiRH5PrbFtW4p+DetpsF4v8Gs+HA3WEwOAfwzriYxaLTVsP8X1QK0z+vqQCzewYogi60aL9SEX5oyxphYVCFTGjfSJCTmN1jBruN5KTGCUS8bhySQGHRaohmW4glwtldbOeYJYKlgvbyUuA8aFFEKc++aIM4hrRnyiMnIZKq1PrihcM3GNKboMF1Naa9X9+8T1KrxIlVbGjv3cAEHOYYMqqgUsVuJqqehV3+sjDwB+DTJp0lYtMCyZpxqjF4e+74+sRcQSFZO8UonUSEFzuUY+DKo59A2kZDatGCjzCauy/2AmhSyCq0WHEj0KTNJDmVeNhErMt1Q8W4xti4/FwMJ4jaxl05TKFiNtD3kBGrHnhiph9V0eXQc6DkyE2xX830AlKshFTErXeuCZXK/9m41wFsGSfZ4lcGeyZ98PrylJ7MWCojQZ3qSukL2QslgdngqJnTEPdTJhXvbNBoR/+7wabIxWduN/Ja5dWEivm4XSZ2uQckNzmRlHrn2lc6eiafvS4V2Hd12tesau8toZW0CtWoZYb9t+OqxdCYKYjVPF16pVbILIy/gR7MVaWMHYPCoa2VkzkX4Iry2rirXbumGyAjGC1h62YLw6ApsNKZph3fpIWHt08JovRWD62sejpXhTrhWrPpl6zZ6PW2oTG5ltlvgtF6weNYCWKeJJSfg4W6PNJlj3sVZgOXV4lc8n4RlkMTLEBDVoYc3nI09kpyzzfgWsjyzBZSNDKF2/wjh+sxYvn8Y1scxlfLF9T1RBO3wVHsnq8Fk4oGkEh/0KJPSa8T2CeWE5X9BPmgLsaRIGeNL2kshCsWoLBmdPJW5Wbz1ndAKUXjPwxXYAUpSV3fy5BJg1aa1tyVXHHMgVH31ewDVrleHr9XqC684SUF4mecR3+wW5SC2QNvxUizRv98mLDhPgYiMDb+v8g0OADxqxcnf9w01mZYJF0fUVP5LcdswbsMmy1DVs5PlE5NpNiTR8M8qAWZkOy6aN13VcoOF2/s3xn3Mes8Xza05tgR/BuNz69nlNzMR0fH45p+G4R9oxh2mKt9MF4J7K/lvWUojwF5nCgCpuRUptnZMQ3au0nSo2UsHgV3xpmeLYzGml3ZFBBzYGPCpOQRwXs1/GG1J74dlZc6JKUOtjBAz9XjVxucGWHbZVJDPJQGYDRl1Qmf1ovk2Sbghb6MQlnF7mBzM1bgOqJAPpoOQaVe+4Skcit3uqHMyG/Sh1rHNN0gAfM0nnPrmulfLVBSm20TSZSdWa0LJl2ukVyE4vTYCgP3uQkwv1TKtQWgxDzBSg80OQjCs4klKvuUzHLCfIbDKIE/S5VIGqD1iD2819pkAqTWdmeina+oZABi7X5B1MGoTJqJSchuk6JNHcgUPAcsVFk0+N0oDN68Vo7FQSmCXjx46OEtUk1lpY2ZFQGr/AcpqVato4wPUD+RhfAeyQI5sJ6l2sDwnKqNFSJvpiyJbFl3kTOjZ2ievwCR7hkUoWeV2vOLAXvB39AJoyqYa81A5cvaAidXYTFTycKDBcalVK5f3XS89kzLVl9txfL+K+p6NUnitz5KkKm7D3DrRPNq4bk7l20aFRppNilmuQI+uzTtj9wPBkTsVwM7HbJ5pwGgujyRyZDzQLNoiRFluRtQ+GzEguqRxUL+ZMFqulMzIfaP3ARj2k/txB8c+2HyjmDizCaVWtNoE5MvMlKs/4VQ7HUJZCrU6qCKcNJ2aSWUZhJZu4VI0LB4CHFdj77DRuGi28WKAxoRyZyzGVrmc0jmk1nP5QaxZo1puqq1YIAqgZb8e/rABZJWNCNxV7DSTpOO7Aail9J9nYHtua/4ouE/aS0X1qtXQzwGx+rnbi2vhF/TfZG52oc6DPo1WCi3RTDnRk7TEntoEp38gg+DjYs2opkR3JW5EpL9rU0XSK5/6LOTAVS+72x7pm60zSf5HMdldjhzJqw1FRcxXdS3ZNZp0s92FiyluUvBPoD9ynZNkBiu2NF11ofnlnQbZgKqvusj9R/f6DOzgVsahbNlXxlsxU8y7qrbTupitRyxFBKG6H3aEPUqj7YrzAymq41FXlZLlO4WLbvG2Kg4vYB+wPfWS2B5Rq8TW9ROpAZbiF6MmCTsx1NLLsx7NOoOiZup2CNbZ36xc96ErcxzuILGrmmFhimjtwKo/yTm7feTVwB61IzbnW4967Kt3cDDotGt8JKrTiUyO3Uy2PZZt9tapXEfXhWmTgcoB+JchFWsiCKvYnhmn/tKuJDbgly897FnFfkE1rQLKy810OU7xW3bEJHCD5gERtuTGuxoJqA6qI9TNMa6MbvZomsiubbPYx78YXDaaRqqsyqfSaLZdjYGHLu65rDgydXCWm1P5EvcQ828f9pcBapTILSMv1nZCAc0WzFIFsGfUi/kmAxc6cFqDSYuPSMIbs1OVrwITTQM9HVRFJ5JL56qcoFzzT1uVcd2v9jFw8BHlcWtmEI86hp5Dy/zOlK8cUp/rVseRUBqawz6kmAcPLM9l5m8h4V53Iz/2mFJaTCvF8JbsMvPjU/7crbUXart0v4WyE0LnDPcAX95Knj4VUE8HCdNdUP8BDcOXKdPl4uSWbh4LfOV0HDdfipOmu+eIRrDsNPkIT7np/8ZAzVdOd1u8wHIqeXt8VqtgiO50ePeNaGG+uO9rHiKdL71pnIun8jxEKXv2r2HYBzO/mz96vFKoMM5WLk7tQXS9U5kwCu5lk7n6++kdCFWRaTUzm0/5fClWGWTrM/AGhCrJO/ZBQhTPFLwmV7ebgcdttt91222233Xbbbf+H9h+2WEtdHVinLAAAAABJRU5ErkJggg==",Kt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAACWCAMAAAAL34HQAAALeGlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNi4wLWMwMDIgNzkuMTY0NDg4LCAyMDIwLzA3LzEwLTIyOjA2OjUzICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0RXZ0PSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VFdmVudCMiIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIiB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHhtcDpDcmVhdGVEYXRlPSIyMDIyLTAyLTIyVDIxOjIxOjQ1KzA4OjAwIiB4bXA6TWV0YWRhdGFEYXRlPSIyMDI0LTAxLTEzVDE5OjEwOjEwKzA4OjAwIiB4bXA6TW9kaWZ5RGF0ZT0iMjAyNC0wMS0xM1QxOToxMDoxMCswODowMCIgZGM6Zm9ybWF0PSJpbWFnZS9wbmciIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTQ3NTExNjAtZDY5MC00ZTkzLWFhNGUtNGMwYTViNGU1ZGFjIiB4bXBNTTpEb2N1bWVudElEPSJhZG9iZTpkb2NpZDpwaG90b3Nob3A6YzRiNzlkYWMtZTJmYS1iNzQ0LWIxM2ItOWU1N2VjMDhhM2YwIiB4bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ9InhtcC5kaWQ6ZDA4MDI4MDItMzUyYS04NTRhLTkxYjctNmRlNmQ1MmViM2QwIiBwaG90b3Nob3A6Q29sb3JNb2RlPSIzIiBwaG90b3Nob3A6SUNDUHJvZmlsZT0ic1JHQiBJRUM2MTk2Ni0yLjEiIHRpZmY6T3JpZW50YXRpb249IjEiIHRpZmY6WFJlc29sdXRpb249IjMwMDAwMDAvMTAwMDAiIHRpZmY6WVJlc29sdXRpb249IjMwMDAwMDAvMTAwMDAiIHRpZmY6UmVzb2x1dGlvblVuaXQ9IjIiIGV4aWY6Q29sb3JTcGFjZT0iMSIgZXhpZjpQaXhlbFhEaW1lbnNpb249IjMwMCIgZXhpZjpQaXhlbFlEaW1lbnNpb249IjMwMCI+IDx4bXBNTTpIaXN0b3J5PiA8cmRmOlNlcT4gPHJkZjpsaSBzdEV2dDphY3Rpb249ImNyZWF0ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZDA4MDI4MDItMzUyYS04NTRhLTkxYjctNmRlNmQ1MmViM2QwIiBzdEV2dDp3aGVuPSIyMDIyLTAyLTIyVDIxOjIxOjQ1KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjQwNjg2NzJkLWY5NDMtOTU0Mi1iMDBiLTVlMDExNmE1NmIzZSIgc3RFdnQ6d2hlbj0iMjAyNC0wMS0xM1QxMDoyNjoxNiswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTkgKFdpbmRvd3MpIiBzdEV2dDpjaGFuZ2VkPSIvIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJzYXZlZCIgc3RFdnQ6aW5zdGFuY2VJRD0ieG1wLmlpZDpjZjk1NTE1OC04MjFiLTA4NDUtYWJmNS05YTE1NGM1ZTY4NjEiIHN0RXZ0OndoZW49IjIwMjQtMDEtMTNUMTE6MDQ6MDQrMDg6MDAiIHN0RXZ0OnNvZnR3YXJlQWdlbnQ9IkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE5IChXaW5kb3dzKSIgc3RFdnQ6Y2hhbmdlZD0iLyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0iY29udmVydGVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJmcm9tIGFwcGxpY2F0aW9uL3ZuZC5hZG9iZS5waG90b3Nob3AgdG8gaW1hZ2UvcG5nIi8+IDxyZGY6bGkgc3RFdnQ6YWN0aW9uPSJkZXJpdmVkIiBzdEV2dDpwYXJhbWV0ZXJzPSJjb252ZXJ0ZWQgZnJvbSBhcHBsaWNhdGlvbi92bmQuYWRvYmUucGhvdG9zaG9wIHRvIGltYWdlL3BuZyIvPiA8cmRmOmxpIHN0RXZ0OmFjdGlvbj0ic2F2ZWQiIHN0RXZ0Omluc3RhbmNlSUQ9InhtcC5paWQ6ZGM1Y2IyNWItZDZlNC0yZjQ2LTgyODQtZmUwOTNlY2M2ZTkxIiBzdEV2dDp3aGVuPSIyMDI0LTAxLTEzVDExOjA0OjA0KzA4OjAwIiBzdEV2dDpzb2Z0d2FyZUFnZW50PSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxOSAoV2luZG93cykiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPHJkZjpsaSBzdEV2dDphY3Rpb249InNhdmVkIiBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjE0NzUxMTYwLWQ2OTAtNGU5My1hYTRlLTRjMGE1YjRlNWRhYyIgc3RFdnQ6d2hlbj0iMjAyNC0wMS0xM1QxOToxMDoxMCswODowMCIgc3RFdnQ6c29mdHdhcmVBZ2VudD0iQWRvYmUgUGhvdG9zaG9wIDIyLjAgKE1hY2ludG9zaCkiIHN0RXZ0OmNoYW5nZWQ9Ii8iLz4gPC9yZGY6U2VxPiA8L3htcE1NOkhpc3Rvcnk+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOmNmOTU1MTU4LTgyMWItMDg0NS1hYmY1LTlhMTU0YzVlNjg2MSIgc3RSZWY6ZG9jdW1lbnRJRD0iYWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjM2ZGQ4NTQxLWQ0MWEtYmY0Yy1iZjA3LWNmNjZhNjZhMDg2MSIgc3RSZWY6b3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOmQwODAyODAyLTM1MmEtODU0YS05MWI3LTZkZTZkNTJlYjNkMCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ph2LDQsAAAAJcEhZcwAACxMAAAsTAQCanBgAAAA5UExURUdwTNra2s7Ozq2tre3t7dPT087OzuPj4+3t7dbW1u/v79bW1vz8/MrKytDQ0Nzc3MPDw/X19bi4uMZQDnEAAAAKdFJOUwBqEPywotz+wzqApqiTAAAHW0lEQVR42u1b25akIAwcbx2UFoj//7HLTQVBRcSZfTDnbM/uTl/KSlEkwf75eeONN95444033njjjTduR9/0/yOsbqoevObL7101tYX1HFs9QFtfZalRP+rpQVgdAFx990ZnT8L6eZItUl99jeGpf1DxdV/VP9fV1f/PFlF1bYHoVFSRC60IyVjrFRnuB8IoxpExSrstsErKHpJw1eqybNLbAQvAYkKjUrjoBgKRqAaeIjG5+qaps6hKcMWmcdSwqAJWBbAgCZZaIYbsqggqqlHNbFFa5yVR4jKvrKEErOEjNCqNSwHrfE8lpLsod/u+cOPPMPBJ+Gz5dM0cXNgclre+pSxhYI1WW5Tf9ENSMIdLCiWs6q9hwQprBVYKFqyPlx4WtoSvrT9lC/wkGt8qlkQooC3hi6sgW3Bb8gtdpSV/za/mn49pC0oYhONbfyd5hzDLFivKFpTS1gKM0we0tQCEncfgQn7Rt+DC/299i1MSRJcBC0r7VviG5KZvwV5WIUobxHyrJKy8VRjXVgFYsPu5kOtbxdhycCDuihziXVLoW7xwEiUmDgd544B46luWLW+nugMLB2BimmC3cxTNxCDg8xFtuUSNqoFsDKzY8psa+XtBNWXr74N6qxwsS5T6VL5robKl10+ZRu5S9qBvUYuJwVHzjwjrE3G33qKh+WXBgmkmCvHYquTvZ8oo7rLFA4PJgYW0MdePIRQIGUPNbSMw5lubJMKtJI6+Wk6cVFMmACO+VVryeL7ZgI8MhwS2fnNPPK0geHBRd11eJSiyL4KjrL2umm1XIpRii1MKB/mU/iCZwF+pt5z3UJ7UiF3nQqadAXC3T3xEW2IyuDBe3yDTe0+A64it2WTyYSGVHymUI/EduvSWKJ80Dtv2NbYSoQxbMkVC7yzNGIWFvDF7gRD79RYrWW/BDGti4wwLtgvO7gWKUZ8Mt94qX8vLJE70+xVNwzDm9ghNM+FX7p/jlZUId2HJD+Tf79hMe3WNrAK/30E+C8/6xOCqbqxE5JNMYrNbnaLUvJAewfCg8zF0Ba/tbviWLvPYfsGFA1PVD8ZdnjlVc/DS/o7LK4NHjOjKKbfCTSCo5XmwKbaZM4jlc9NGEYd9Ijd0QS5ZGaOR2O+DPlGyRb2nXZzgnI1GdFWF+0gh3ifyTRqvzpXI2eElk58FeHziCF5hY+hSMV9Ge/mohUTGuQ4vzHYe8bW5sNdFQ58St22Vcf5zzJbtcGT4iYQ7iz8dFuxoWRYMjAM7KCnypHOTLSqdUwYIFpndOD/6B2FBzNQxYmW/zxYE4j8yLHga1s2Rbm/O5PXtGcuNDIW1dTj5hpjGsO+7z2Kk9NP1JWDlnWKAM4H6zCUNM05KyVPHBclYzUbgjE3N3tP2JWHBmbqD4GLeCs2jhMT13lMVljwcEbetwZgtHUxVQ21ho3fE7inf2s8vzMWq0EWpfOBg5hcDSGwaF2+LaysRIzNFqRgBv2sMhi/Ix0WiW8rBKNBv4ExBI7eorx9ANazsPCb5FkSNH+Reacos+AYxaFzX76KMH65c8ytzZ40YvpFAqtgC/otn1eCmMI5K8yVRQVVwq3aVtU+jJktwjyP7x+BKv8vtoH098vXYSJcrWGJcAW11r8WVRxe5vgcuFbXqwnaEZejS6mrLwYKUg1ch2RJswTFYgMOwoau+AQsSp/FuDhVZi7J402ifgGla/GJIzGLYG5H4rnKMCUydL9wcsmZSuPikR2QmjQbWqaV2ob2RdMvaLEvFlRiXpYeTwqVOtMZF+qi0dS4uEjJKMvWuYK3S0jHZwaq7BylYp/O2uu3q04lNqudLWEJQd/3paTBz12IaLIPtzE5P1AUuW9TB8NVzaG9/TIfV+eXsWeezz6HWlptEbo4SIAeWur/Y/RZC/gmZTiLzUY2j5ct6fjKsFvxqgyQxE9sbmfYtnJMIciEKo6+FL0wziJmtkzspIcUl0PgWrL7VCKP7hl61U4WLeN+7Ieli2vZhmq0VgjDOgIyhJ62sSpDkWNZa1wiB8WoLlxzy29XpGVPgn1ut5VYcGyRLK7OCiJaDYMrAneJUkZWdw0yDgNm5nDowqLc0Kp581FO7QS4pC9S/YRW9xkVdNOj0ZHCp9anEZw3VEK/fopiDrkMObkcdJtT1g6+uzQ60bIdUPztdWZWy53m+v/zFYPOGHO4AZsalmtJNkyHrCAx1RXX7mt5g1L1pDezpkXv8wJwpVRSSaf2c26Y0rrXXxyWBptu/ovdak+VhkqjGBZUdvKygqANKA/MqZ/36kcGwFn90RnWp66ksKuHgitLFY8BU+F2ZvqpxpMY9qR3YwOUJ12fc0KUHVKdswcKXuwetErCnwvMKuXxfc/3RVJ2yFc+iosQd3X+WGSVz1UiuN2J156FyVyHbsOUp3krezaPUT/VxXqdfwvknb/Zgp+idTxTbrkLqYuKreRnhy65Gf4W0NsDoYiqf6uZsvr8V9eo6XWc5+3TVf/3N1TfeeOONN95444033njjjTfeSI1/IeOYOeO4fGAAAAAASUVORK5CYII=",Yt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADIBAMAAABfdrOtAAAAElBMVEVRUVH+/v5HcEyZmZlRUVFRUVGm1ByOAAAABnRSTlPMzADMTZAJBBGsAAAEnElEQVR42t2cS27jMAyGf7/2U+QCQeDsbeQCgZDujaC5/1UmkzaJn+JDFGcw3LdfflKibJkkDnxrL7dbg7sNt6+L4O8OYBM+B0ys+QrGkHZG+OEEQ8g6go8Bx1GIGMdpNOQyIG6XdMgnSPtKhLQDGEZFBgYMkhKFtGBb0EIEjDgFRowoBVaMGAWpMedEfxMiZtwpUsgZCqtlkCNUdpVAWigtCCCDFtLwIWeoreZCWiRYYEKGFEjDg+yRZCUH0iLRAgNyToXUNCRZyMqWhGnUN2IPm3wSlwJ7IUspyCBkIQUZhCykIIeQuRTkEDKXAuM9srrtYbrZN7Y98giZSoFd+t1OxmMITG0dcrSFXFchZ1tIvQZpYWxhBbK3hpQrkMEa0iwh5t4a+QvZvDXyF7J5a+Qv5PPW21/I5623v5DPW29/IaO3Xv5Clrw1y1/Ikrdm+Qs5svw83yNnSJ5BQb4F/F7EIEJSnThGBAXxkFQfLOviQUE8JAUPsosHBfGQfDAtHhREQ1JxIV00KIgmrnRI84S0yAd5BAXxxJUck0f6Qnwr9qmr6xF5xLMjcwn/iudIEAdWnyjkEXlQKZiRVzoqRyLbgeUKKR8Q4alY7cSnoxzSf2ggsqehKr6YVpcXpOd7H93f60cKhOd7Re2LteUF4eLqiVS1mr0ge4io6C2+soaFkJ7MuuuQs1yITEp9hwwKISIpzR2iESKSIoT0rLNwuVHQqoSIpAQJpGce60vIUSdEIuUqgPTsJ5QFZK8UIpBS8iG94GFrDjlrhfCl8CG96Llxmle4kEr6vKWBPIVo9kqDQSRk9/3cWoikcCFPAd33v4dIChPyEvLzBA6RlEYWke4JEUnhKXkLeUEKxRHJFfKCQHGucIW8IdZSRkLeEGMpYyEjiK2UsZARxFTKRMgYYillImQMMZQyFTKB2EmZCplAuFLIHT8TMoWwpQwiIVMIUwqpZP5bp5CCvCTiQKr5f5lCQN+tPCBn2ZvVDFJwIDUP0m1BYAfZYRNSsCB7BqTbhoARePIxtZ9tgwWkoJcwCalmv3MBAemtO4R6dah2HaKQqj8Zvp9sQDjvJ21+SPCBHPJDDk6QITekEV7gqCC19CpKAym9IMfckKv4olMBCeIrWwVEfvkshzQekO9r9P1/ALk+IG1eSPCDiCJfyG+FyU+A6ZCa/piZDinpz7LpkCv5gdkAEshP5emQhv7onw6pGeULyZCSUYiRDAmMkpJkCKs4JhFSq8p8hJBSVbAkhARV6ZUQoisik0FqXTmcDHLVFfbJIEFXoiiCNMpiSxGkVJaNiiBBWQArgTTaUl4JpNQWJUsgQVteXQg+AKkLxQWFGKW+5J2+eVp4S168X3CF1CltCKdTJ8lb84YK2bUBO+wZW0Pqv9nk4tKu49N45NJC5dMM5tLW5tOg59Jq6NM06dL+abFXwr/RkuvTXJwae1abtE/Dt0/ruksTvs84AZ/BCC4jHnyGVfiM3VBQFANEXEah+Ax18RlP4zNox2dkkM/wI58xTn8yDCXGYCDV3W5RGSajtXyGhG1jbpbjzpwGt/0MJft8jqC7iUbQ/QZaxdnKqcIftwAAAABJRU5ErkJggg==";const $t=ee({name:"z-paging-empty-view",data:()=>({}),props:{emptyViewText:{type:String,default:"没有数据哦~"},emptyViewImg:{type:String,default:""},showEmptyViewReload:{type:Boolean,default:!1},emptyViewReloadText:{type:String,default:"重新加载"},isLoadFailed:{type:Boolean,default:!1},emptyViewStyle:{type:Object,default:function(){return{}}},emptyViewImgStyle:{type:Object,default:function(){return{}}},emptyViewTitleStyle:{type:Object,default:function(){return{}}},emptyViewReloadStyle:{type:Object,default:function(){return{}}},emptyViewZIndex:{type:Number,default:9},emptyViewFixed:{type:Boolean,default:!0},unit:{type:String,default:"rpx"}},computed:{emptyImg(){return this.isLoadFailed?Kt:qt},finalEmptyViewStyle(){return this.emptyViewStyle["z-index"]=this.emptyViewZIndex,this.emptyViewStyle}},methods:{reloadClick(){this.$emit("reload")},emptyViewClick(){this.$emit("viewClick")}}},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass({"zp-container":!0,"zp-container-fixed":o.emptyViewFixed}),style:e.normalizeStyle([r.finalEmptyViewStyle]),onClick:n[1]||(n[1]=(...e)=>r.emptyViewClick&&r.emptyViewClick(...e))},[e.createElementVNode("view",{class:"zp-main"},[o.emptyViewImg.length?(e.openBlock(),e.createElementBlock("image",{key:1,class:e.normalizeClass({"zp-main-image-rpx":"rpx"===o.unit,"zp-main-image-px":"px"===o.unit}),mode:"aspectFit",style:e.normalizeStyle([o.emptyViewImgStyle]),src:o.emptyViewImg},null,14,["src"])):(e.openBlock(),e.createElementBlock("image",{key:0,class:e.normalizeClass({"zp-main-image-rpx":"rpx"===o.unit,"zp-main-image-px":"px"===o.unit}),style:e.normalizeStyle([o.emptyViewImgStyle]),src:r.emptyImg},null,14,["src"])),e.createElementVNode("text",{class:e.normalizeClass(["zp-main-title",{"zp-main-title-rpx":"rpx"===o.unit,"zp-main-title-px":"px"===o.unit}]),style:e.normalizeStyle([o.emptyViewTitleStyle])},e.toDisplayString(o.emptyViewText),7),o.showEmptyViewReload?(e.openBlock(),e.createElementBlock("text",{key:2,class:e.normalizeClass({"zp-main-error-btn":!0,"zp-main-error-btn-rpx":"rpx"===o.unit,"zp-main-error-btn-px":"px"===o.unit}),style:e.normalizeStyle([o.emptyViewReloadStyle]),onClick:n[0]||(n[0]=e.withModifiers(((...e)=>r.reloadClick&&r.reloadClick(...e)),["stop"]))},e.toDisplayString(o.emptyViewReloadText),7)):e.createCommentVNode("",!0)])],6)}],["__scopeId","data-v-aa7f03b0"]]),Wt="2.8.5",Zt=100,Jt="z-paging-error-emit",Xt="z-paging-complete-emit",Qt="z-paging-cache",en="zp_index",tn="zp_unique_index",nn={},on="Z-PAGING-REFRESHER-TIME-STORAGE-KEY";let an=null,rn=!1;const sn={};function ln(){return uni.getStorageSync(on)}function cn(e){return uni.upx2px(e)}function un(){return(new Date).getTime()}function dn(e){return 1===(e=e.toString()).length?"0"+e:e}const pn={gc:function(e,t){return()=>{if(function(){if(rn)return;nn&&Object.keys(nn).length&&(an=nn);!an&&uni.$zp&&(an=uni.$zp.config);an=an?Object.keys(an).reduce(((e,t)=>(e[function(e){return e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()))}(t)]=an[t],e)),{}):null,rn=!0}(),!an)return t;const n=an[e];return void 0===n?t:n}},setRefesrherTime:function(e,t){const n=ln()||{};n[t]=e,uni.setStorageSync(on,n)},getRefesrherFormatTimeByKey:function(e,t){const n=function(e){const t=ln();return t&&t[e]?t[e]:null}(e),o=n?function(e,t){const n=new Date(e),o=new Date,a=new Date(e).setHours(0,0,0,0),i=(new Date).setHours(0,0,0,0),r=a-i;let s="";const l=function(e){const t=e.getHours(),n=e.getMinutes();return`${dn(t)}:${dn(n)}`}(n);s=0===r?t.today:-864e5===r?t.yesterday:function(e,t=!0){const n=e.getFullYear(),o=e.getMonth()+1,a=e.getDate();return t?`${n}-${dn(o)}-${dn(a)}`:`${dn(o)}-${dn(a)}`}(n,n.getFullYear()!==o.getFullYear());return`${s} ${l}`}(n,t):t.none;return`${t.title}${o}`},getTouch:function(e){let t=null;if(e.touches&&e.touches.length)t=e.touches[0];else if(e.changedTouches&&e.changedTouches.length)t=e.changedTouches[0];else{if(!e.datail||e.datail=={})return{touchX:0,touchY:0};t=e.datail}return{touchX:t.clientX,touchY:t.clientY}},getTouchFromZPaging:function e(t){if(t&&t.tagName&&"BODY"!==t.tagName&&"UNI-PAGE-BODY"!==t.tagName){const n=t.classList;return n&&n.contains("z-paging-content")?{isFromZp:!0,isPageScroll:n.contains("z-paging-content-page"),isReachedTop:n.contains("z-paging-reached-top"),isUseChatRecordMode:n.contains("z-paging-use-chat-record-mode")}:e(t.parentNode)}return{isFromZp:!1}},getParent:function e(t){return t?t.$refs.paging?t:e(t.$parent):null},convertToPx:function(e){if("[object Number]"===Object.prototype.toString.call(e))return e;let t=!1;return-1!==e.indexOf("rpx")||-1!==e.indexOf("upx")?(e=e.replace("rpx","").replace("upx",""),t=!0):-1!==e.indexOf("px")&&(e=e.replace("px","")),isNaN(e)?0:Number(t?cn(e):e)},getTime:un,getInstanceId:function(){const e=[];for(let t=0;t<10;t++)e[t]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return e.join("")+un()},consoleErr:function(e){},delay:function(e,t=Zt,n){const o=setTimeout(e,t);return n&&(sn[n]&&clearTimeout(sn[n]),sn[n]=o),o},wait:function(e){return new Promise((t=>{setTimeout(t,e)}))},isPromise:function(e){return"[object Promise]"===Object.prototype.toString.call(e)},addUnit:function(e,t){if("[object String]"===Object.prototype.toString.call(e)){let t=e;t=t.replace("rpx","").replace("upx","").replace("px",""),-1===e.indexOf("rpx")&&-1===e.indexOf("upx")&&-1!==e.indexOf("px")&&(t=2*parseFloat(t)),e=t}return"rpx"===t?e+"rpx":e/2+"px"},deepCopy:function e(t){if("object"!=typeof t||null===t)return t;let n=Array.isArray(t)?[]:{};for(let o in t)t.hasOwnProperty(o)&&(n[o]=e(t[o]));return n},rpx2px:cn},hn={LoadingType:{Refresher:"refresher",LoadMore:"load-more"},Refresher:{Default:"default",ReleaseToRefresh:"release-to-refresh",Loading:"loading",Complete:"complete",GoF2:"go-f2"},More:{Default:"default",Loading:"loading",NoMore:"no-more",Fail:"fail"},QueryFrom:{UserPullDown:"user-pull-down",Reload:"reload",Refresh:"refresh",LoadMore:"load-more"},CellHeightMode:{Fixed:"fixed",Dynamic:"dynamic"},CacheMode:{Default:"default",Always:"always"}};const fn=ee({name:"z-paging-refresh",data:()=>({R:hn.Refresher,isIos:"ios"===uni.getSystemInfoSync().platform,refresherTimeText:"",zTheme:{title:{white:"#efefef",black:"#555555"},arrow:{white:Gt,black:Bt},flower:{white:zt,black:Ft},success:{white:jt,black:Ht},indicator:{white:"#eeeeee",black:"#777777"}}}),props:["status","defaultThemeStyle","defaultText","pullingText","refreshingText","completeText","goF2Text","defaultImg","pullingImg","refreshingImg","completeImg","refreshingAnimated","showUpdateTime","updateTimeKey","imgStyle","titleStyle","updateTimeStyle","updateTimeTextMap","unit"],computed:{ts(){return this.defaultThemeStyle},statusTextMap(){this.updateTime();const{R:e,defaultText:t,pullingText:n,refreshingText:o,completeText:a,goF2Text:i}=this;return{[e.Default]:t,[e.ReleaseToRefresh]:n,[e.Loading]:o,[e.Complete]:a,[e.GoF2]:i}},currentTitle(){return this.statusTextMap[this.status]||this.defaultText},leftImageClass(){const e=`zp-r-left-image-pre-size-${this.unit}`;return this.status===this.R.Complete?e:`zp-r-left-image ${e} ${this.status===this.R.Default?"zp-r-arrow-down":"zp-r-arrow-top"}`},leftImageStyle(){const e=this.showUpdateTime,t=e?pn.addUnit(36,this.unit):pn.addUnit(34,this.unit);return{width:t,height:t,"margin-right":e?pn.addUnit(20,this.unit):pn.addUnit(9,this.unit)}},leftImageSrc(){const e=this.R,t=this.status;return t===e.Default?this.defaultImg?this.defaultImg:this.zTheme.arrow[this.ts]:t===e.ReleaseToRefresh?this.pullingImg?this.pullingImg:this.defaultImg?this.defaultImg:this.zTheme.arrow[this.ts]:t===e.Loading?this.refreshingImg?this.refreshingImg:this.zTheme.flower[this.ts]:t===e.Complete?this.completeImg?this.completeImg:this.zTheme.success[this.ts]:t===e.GoF2?this.zTheme.arrow[this.ts]:""},rightTextStyle(){let e={};return e.color=this.zTheme.title[this.ts],e["font-size"]=pn.addUnit(30,this.unit),e}},methods:{addUnit:(e,t)=>pn.addUnit(e,t),updateTime(){this.showUpdateTime&&(this.refresherTimeText=pn.getRefesrherFormatTimeByKey(this.updateTimeKey,this.updateTimeTextMap))}}},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("view",{style:{height:"100%"}},[e.createElementVNode("view",{class:e.normalizeClass(o.showUpdateTime?"zp-r-container zp-r-container-padding":"zp-r-container")},[e.createElementVNode("view",{class:"zp-r-left"},[o.status!==i.R.Loading?(e.openBlock(),e.createElementBlock("image",{key:0,class:e.normalizeClass(r.leftImageClass),style:e.normalizeStyle([r.leftImageStyle,o.imgStyle]),src:r.leftImageSrc},null,14,["src"])):(e.openBlock(),e.createElementBlock("image",{key:1,class:e.normalizeClass({"zp-line-loading-image":o.refreshingAnimated,"zp-r-left-image":!0,"zp-r-left-image-pre-size-rpx":"rpx"===o.unit,"zp-r-left-image-pre-size-px":"px"===o.unit}),style:e.normalizeStyle([r.leftImageStyle,o.imgStyle]),src:r.leftImageSrc},null,14,["src"]))]),e.createElementVNode("view",{class:"zp-r-right"},[e.createElementVNode("text",{class:"zp-r-right-text",style:e.normalizeStyle([r.rightTextStyle,o.titleStyle])},e.toDisplayString(r.currentTitle),5),o.showUpdateTime&&i.refresherTimeText.length?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass(["zp-r-right-text",{"zp-r-right-time-text-rpx":"rpx"===o.unit,"zp-r-right-time-text-px":"px"===o.unit}]),style:e.normalizeStyle([{color:i.zTheme.title[r.ts]},o.updateTimeStyle])},e.toDisplayString(i.refresherTimeText),7)):e.createCommentVNode("",!0)])],2)])}],["__scopeId","data-v-ad2f2917"]]);const gn=ee({name:"z-paging-load-more",data:()=>({M:hn.More,zTheme:{title:{white:"#efefef",black:"#a4a4a4"},line:{white:"#efefef",black:"#eeeeee"},circleBorder:{white:"#aaaaaa",black:"#c8c8c8"},circleBorderTop:{white:"#ffffff",black:"#444444"},flower:{white:zt,black:Ft},indicator:{white:"#eeeeee",black:"#777777"}}}),props:["zConfig"],computed:{ts(){return this.c.defaultThemeStyle},c(){return this.zConfig||{}},ownLoadingMoreText(){return{[this.M.Default]:this.c.defaultText,[this.M.Loading]:this.c.loadingText,[this.M.NoMore]:this.c.noMoreText,[this.M.Fail]:this.c.failText}[this.finalStatus]},finalStatus(){return this.c.defaultAsLoading&&this.c.status===this.M.Default?this.M.Loading:this.c.status},finalLoadingIconType(){return this.c.loadingIconType}},methods:{doClick(){this.$emit("doClick")}}},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["zp-l-container",{"zp-l-container-rpx":"rpx"===r.c.unit,"zp-l-container-px":"px"===r.c.unit}]),style:e.normalizeStyle([r.c.customStyle]),onClick:n[0]||(n[0]=(...e)=>r.doClick&&r.doClick(...e))},[r.c.hideContent?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[r.c.showNoMoreLine&&r.finalStatus===i.M.NoMore?(e.openBlock(),e.createElementBlock("text",{key:0,class:e.normalizeClass({"zp-l-line-rpx":"rpx"===r.c.unit,"zp-l-line-px":"px"===r.c.unit}),style:e.normalizeStyle([{backgroundColor:i.zTheme.line[r.ts]},r.c.noMoreLineCustomStyle])},null,6)):e.createCommentVNode("",!0),r.finalStatus===i.M.Loading&&r.c.loadingIconCustomImage?(e.openBlock(),e.createElementBlock("image",{key:1,src:r.c.loadingIconCustomImage,style:e.normalizeStyle([r.c.iconCustomStyle]),class:e.normalizeClass({"zp-l-line-loading-custom-image":!0,"zp-l-line-loading-custom-image-animated":r.c.loadingAnimated,"zp-l-line-loading-custom-image-rpx":"rpx"===r.c.unit,"zp-l-line-loading-custom-image-px":"px"===r.c.unit})},null,14,["src"])):e.createCommentVNode("",!0),r.finalStatus!==i.M.Loading||"flower"!==r.finalLoadingIconType||r.c.loadingIconCustomImage.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("image",{key:2,class:e.normalizeClass({"zp-line-loading-image":!0,"zp-line-loading-image-rpx":"rpx"===r.c.unit,"zp-line-loading-image-px":"px"===r.c.unit}),style:e.normalizeStyle([r.c.iconCustomStyle]),src:i.zTheme.flower[r.ts]},null,14,["src"])),r.finalStatus!==i.M.Loading||"circle"!==r.finalLoadingIconType||r.c.loadingIconCustomImage.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("text",{key:3,class:e.normalizeClass(["zp-l-circle-loading-view",{"zp-l-circle-loading-view-rpx":"rpx"===r.c.unit,"zp-l-circle-loading-view-px":"px"===r.c.unit}]),style:e.normalizeStyle([{borderColor:i.zTheme.circleBorder[r.ts],borderTopColor:i.zTheme.circleBorderTop[r.ts]},r.c.iconCustomStyle])},null,6)),!r.c.isChat||!r.c.chatDefaultAsLoading&&r.finalStatus===i.M.Default||r.finalStatus===i.M.Fail?(e.openBlock(),e.createElementBlock("text",{key:4,class:e.normalizeClass({"zp-l-text-rpx":"rpx"===r.c.unit,"zp-l-text-px":"px"===r.c.unit}),style:e.normalizeStyle([{color:i.zTheme.title[r.ts]},r.c.titleCustomStyle])},e.toDisplayString(r.ownLoadingMoreText),7)):e.createCommentVNode("",!0),r.c.showNoMoreLine&&r.finalStatus===i.M.NoMore?(e.openBlock(),e.createElementBlock("text",{key:5,class:e.normalizeClass({"zp-l-line-rpx":"rpx"===r.c.unit,"zp-l-line-px":"px"===r.c.unit}),style:e.normalizeStyle([{backgroundColor:i.zTheme.line[r.ts]},r.c.noMoreLineCustomStyle])},null,6)):e.createCommentVNode("",!0)],64))],6)}],["__scopeId","data-v-aafc5fd6"]]),mn={data:()=>({systemInfo:null,cssSafeAreaInsetBottom:-1,isReadyDestroy:!1}),computed:{windowTop(){return this.systemInfo&&this.systemInfo.windowTop||0},safeAreaBottom(){if(!this.systemInfo)return 0;let e=0;return e=this.systemInfo.safeAreaInsets.bottom||0,e},isOldWebView(){try{const e=uni.getSystemInfoSync().system.split(" "),t=e[0],n=parseInt(e[1]);if("iOS"===t&&n<=10||"Android"===t&&n<=6)return!0}catch(vs){return!1}return!1},zSlots(){return this.$slots}},beforeDestroy(){this.isReadyDestroy=!0},unmounted(){this.isReadyDestroy=!0},methods:{updateFixedLayout(){this.fixed&&this.$nextTick((()=>{this.systemInfo=uni.getSystemInfoSync()}))},_getNodeClientRect(e,t=!0,n=!1,o=!1){if(this.isReadyDestroy)return Promise.resolve(!1);const a=o?this.$parent:this;let i=t||o?uni.createSelectorQuery().in(a):uni.createSelectorQuery();return n?i.select(e).scrollOffset():i.select(e).boundingClientRect(),new Promise(((e,t)=>{i.exec((t=>{e(!(!t||""==t||null==t||!t.length)&&t)}))}))},_updateLeftAndRightWidth(e,t){this.$nextTick((()=>{setTimeout((()=>{["left","right"].map((n=>{this._getNodeClientRect(`.${t}-${n}`).then((t=>{this.$set(e,n,t?t[0].width+"px":"0px")}))}))}),0)}))},_getCssSafeAreaInsetBottom(e){this._getNodeClientRect(".zp-safe-area-inset-bottom").then((t=>{this.cssSafeAreaInsetBottom=t?t[0].height:-1,t&&e&&e()}))}}},vn="Query",_n="FetchParams",yn="FetchResult",In="Language2Local";function Cn(){return getApp()}function kn(){return Cn()&&Cn().globalData}function En(e,t){try{setTimeout((function(){kn()&&(Cn().globalData[`zp_handle${e}Callback`]=t)}),1)}catch(n){}}function Tn(e){return kn()?Cn().globalData[`zp_handle${e}Callback`]:null}const Sn={handleQuery:function(e){return En(vn,e),this},_handleQuery:function(e,t,n,o){const a=Tn(vn);return a?a(e,t,n,o):[e,t,n]},handleFetchParams:function(e){return En(_n,e),this},_handleFetchParams:function(e,t){const n=Tn(_n);return n?n(e,t||{}):__spreadValues({pageNo:e.pageNo,pageSize:e.pageSize},t||{})},handleFetchResult:function(e){return En(yn,e),this},_handleFetchResult:function(e,t,n){const o=Tn(yn);return o&&o(e,t,n),!!o},handleLanguage2Local:function(e){return En(In,e),this},_handleLanguage2Local:function(e,t){const n=Tn(In);return n?n(e,t):t}},Mn={props:{defaultPageNo:{type:Number,default:pn.gc("defaultPageNo",1),observer:function(e){this.pageNo=e}},defaultPageSize:{type:Number,default:pn.gc("defaultPageSize",10),validator:e=>(e<=0&&pn.consoleErr("default-page-size必须大于0！"),e>0)},dataKey:{type:[Number,String,Object],default:pn.gc("dataKey",null)},useCache:{type:Boolean,default:pn.gc("useCache",!1)},cacheKey:{type:String,default:pn.gc("cacheKey",null)},cacheMode:{type:String,default:pn.gc("cacheMode",hn.CacheMode.Default)},autowireListName:{type:String,default:pn.gc("autowireListName","")},autowireQueryName:{type:String,default:pn.gc("autowireQueryName","")},fetch:{type:Function,default:null},fetchParams:{type:Object,default:pn.gc("fetchParams",null)},auto:{type:Boolean,default:pn.gc("auto",!0)},reloadWhenRefresh:{type:Boolean,default:pn.gc("reloadWhenRefresh",!0)},autoScrollToTopWhenReload:{type:Boolean,default:pn.gc("autoScrollToTopWhenReload",!0)},autoCleanListWhenReload:{type:Boolean,default:pn.gc("autoCleanListWhenReload",!0)},showRefresherWhenReload:{type:Boolean,default:pn.gc("showRefresherWhenReload",!1)},showLoadingMoreWhenReload:{type:Boolean,default:pn.gc("showLoadingMoreWhenReload",!1)},createdReload:{type:Boolean,default:pn.gc("createdReload",!1)},localPagingLoadingTime:{type:[Number,String],default:pn.gc("localPagingLoadingTime",200)},concat:{type:Boolean,default:pn.gc("concat",!0)},callNetworkReject:{type:Boolean,default:pn.gc("callNetworkReject",!0)},value:{type:Array,default:function(){return[]}},modelValue:{type:Array,default:function(){return[]}}},data:()=>({currentData:[],totalData:[],realTotalData:[],totalLocalPagingList:[],dataPromiseResultMap:{reload:null,complete:null,localPaging:null},isSettingCacheList:!1,pageNo:1,currentRefreshPageSize:0,isLocalPaging:!1,isAddedData:!1,isTotalChangeFromAddData:!1,privateConcat:!0,myParentQuery:-1,firstPageLoaded:!1,pagingLoaded:!1,loaded:!1,isUserReload:!0,fromEmptyViewReload:!1,queryFrom:"",listRendering:!1,isHandlingRefreshToPage:!1,isFirstPageAndNoMore:!1,totalDataChangeThrow:!0}),computed:{pageSize(){return this.defaultPageSize},finalConcat(){return this.concat&&this.privateConcat},finalUseCache(){return this.useCache&&!this.cacheKey&&pn.consoleErr("use-cache为true时，必须设置cache-key，否则缓存无效！"),this.useCache&&!!this.cacheKey},finalCacheKey(){return this.cacheKey?`${Qt}-${this.cacheKey}`:null},isFirstPage(){return this.pageNo===this.defaultPageNo}},watch:{totalData(e,t){this._totalDataChange(e,t,this.totalDataChangeThrow),this.totalDataChangeThrow=!0},currentData(e,t){this._currentDataChange(e,t)},useChatRecordMode(e,t){e&&(this.nLoadingMoreFixedHeight=!1)},value:{handler(e){e!==this.totalData&&(this.totalDataChangeThrow=!1,this.totalData=e)},immediate:!0},modelValue:{handler(e){e!==this.totalData&&(this.totalDataChangeThrow=!1,this.totalData=e)},immediate:!0}},methods:{complete(e,t=!0){return this.customNoMore=-1,this.addData(e,t)},completeByKey(e,t=null,n=!0){return null!==t&&null!==this.dataKey&&t!==this.dataKey?(this.isFirstPage&&this.endRefresh(),new Promise((e=>e()))):(this.customNoMore=-1,this.addData(e,n))},completeByTotal(e,t,n=!0){if("undefined"==t)this.customNoMore=-1;else{const o=this._checkDataType(e,n,!1);if(e=o.data,n=o.success,t>=0&&n)return new Promise(((o,a)=>{this.$nextTick((()=>{let i=!1;let r=(this.pageNo==this.defaultPageNo?0:this.realTotalData.length)+(this.privateConcat?e.length:0)-t;r>=0&&(i=!0,r=this.defaultPageSize-r,this.privateConcat&&r>0&&r<e.length&&(e=e.splice(0,r))),this.completeByNoMore(e,i,n).then((e=>o(e))).catch((()=>a()))}))}))}return this.addData(e,n)},completeByNoMore(e,t,n=!0){return"undefined"!=t&&(this.customNoMore=1==t?1:0),this.addData(e,n)},completeByError(e){return this.customerEmptyViewErrorText=e,this.complete(!1)},addData(e,t=!0){this.fromCompleteEmit||(this.disabledCompleteEmit=!0,this.fromCompleteEmit=!1);const n=pn.getTime()-this.requestTimeStamp;let o=this.minDelay;this.isFirstPage&&this.finalShowRefresherWhenReload&&(o=Math.max(400,o));const a=this.requestTimeStamp>0&&n<o?o-n:0;return this.$nextTick((()=>{pn.delay((()=>{this._addData(e,t,!1)}),this.delay>0?this.delay:a)})),new Promise(((e,t)=>{this.dataPromiseResultMap.complete={resolve:e,reject:t}}))},addDataFromTop(e,t=!0,n=!0){let o=!this.isChatRecordModeAndNotInversion;e="[object Array]"!==Object.prototype.toString.call(e)?[e]:o?e.reverse():e,this.finalUseVirtualList&&this._setCellIndex(e,"top"),this.totalData=o?[...e,...this.totalData]:[...this.totalData,...e],t&&pn.delay((()=>this.useChatRecordMode?this.scrollToBottom(n):this.scrollToTop(n)))},resetTotalData(e){this.isTotalChangeFromAddData=!0,e="[object Array]"!==Object.prototype.toString.call(e)?[e]:e,this.totalData=e},setLocalPaging(e,t=!0){return this.isLocalPaging=!0,this.$nextTick((()=>{this._addData(e,t,!0)})),new Promise(((e,t)=>{this.dataPromiseResultMap.localPaging={resolve:e,reject:t}}))},reload(e=this.showRefresherWhenReload){return e&&(this.privateShowRefresherWhenReload=e,this.isUserPullDown=!0),this.showLoadingMoreWhenReload||(this.listRendering=!0),this.$nextTick((()=>{this._preReload(e,!1)})),new Promise(((e,t)=>{this.dataPromiseResultMap.reload={resolve:e,reject:t}}))},refresh(){return this._handleRefreshWithDisPageNo(this.pageNo-this.defaultPageNo+1)},refreshToPage(e){return this.isHandlingRefreshToPage=!0,this._handleRefreshWithDisPageNo(e+this.defaultPageNo-1)},updateCache(){this.finalUseCache&&this.totalData.length&&this._saveLocalCache(this.totalData.slice(0,Math.min(this.totalData.length,this.pageSize)))},clean(){this._reload(!0),this._addData([],!0,!1)},clear(){this.clean()},_preReload(e=this.showRefresherWhenReload,t=!0,n=0){const o=this.finalRefresherEnabled&&this.useCustomRefresher;-1===this.customRefresherHeight&&o?pn.delay((()=>{++n%10==0&&this._updateCustomRefresherHeight(),this._preReload(e,t,n)}),Zt/2):(this.isUserReload=!0,this.loadingType=hn.LoadingType.Refresher,e?(this.privateShowRefresherWhenReload=e,this.useCustomRefresher?this._doRefresherRefreshAnimate():this.refresherTriggered=!0):this._refresherEnd(!1,!1,!1,!1),this._reload(!1,t))},_reload(e=!1,t=!1,n=!1){if(this.isAddedData=!1,this.insideOfPaging=-1,this.cacheScrollNodeHeight=-1,this.pageNo=this.defaultPageNo,this._cleanRefresherEndTimeout(),!this.privateShowRefresherWhenReload&&!e&&this._startLoading(!0),this.firstPageLoaded=!0,this.isTotalChangeFromAddData=!1,this.isSettingCacheList||(this.totalData=[]),!e){this._emitQuery(this.pageNo,this.defaultPageSize,n?hn.QueryFrom.UserPullDown:hn.QueryFrom.Reload);let e=0;pn.delay(this._callMyParentQuery,e),!t&&this.autoScrollToTopWhenReload&&this._scrollToTop(!1)}},_addData(e,t,n){this.isAddedData=!0,this.fromEmptyViewReload=!1,this.isTotalChangeFromAddData=!0,this.refresherTriggered=!1,this._endSystemLoadingAndRefresh();const o=this.isUserPullDown;this.showRefresherUpdateTime&&this.isFirstPage&&(pn.setRefesrherTime(pn.getTime(),this.refresherUpdateTimeKey),this.$refs.refresh&&this.$refs.refresh.updateTime()),!n&&o&&this.isFirstPage&&(this.isUserPullDown=!1),this.listRendering=!0,this.$nextTick((()=>{pn.delay((()=>this.listRendering=!1))}));let a=this._checkDataType(e,t,n);e=a.data,t=a.success;let i=Zt;if(this.useChatRecordMode&&(i=0),this.loadingForNow=!1,pn.delay((()=>{this.pagingLoaded=!0,this.$nextTick((()=>{!n&&this._refresherEnd(i>0,!0,o)}))})),this.isFirstPage&&(this.isLoadFailed=!t,this.$emit("isLoadFailedChange",this.isLoadFailed),this.finalUseCache&&t&&(this.cacheMode===hn.CacheMode.Always||this.isSettingCacheList)&&this._saveLocalCache(e)),this.isSettingCacheList=!1,t){if((!1!==this.privateConcat||this.isHandlingRefreshToPage||this.loadingStatus!==hn.More.NoMore)&&(this.loadingStatus=hn.More.Default),n){this.totalLocalPagingList=e;const t=this.defaultPageNo,n=this.queryFrom!==hn.QueryFrom.Refresh?this.defaultPageSize:this.currentRefreshPageSize;this._localPagingQueryList(t,n,0,(e=>{pn.delay((()=>{this.completeByTotal(e,this.totalLocalPagingList.length)}),0)}))}else{let t=0;pn.delay((()=>{this._currentDataChange(e,this.currentData),this._callDataPromise(!0,this.totalData)}),t)}this.isHandlingRefreshToPage&&(this.isHandlingRefreshToPage=!1,this.pageNo=this.defaultPageNo+Math.ceil(e.length/this.pageSize)-1,e.length%this.pageSize!=0&&(this.customNoMore=1))}else this._currentDataChange(e,this.currentData),this._callDataPromise(!1),this.loadingStatus=hn.More.Fail,this.isHandlingRefreshToPage=!1,this.loadingType===hn.LoadingType.LoadMore&&this.pageNo--},_totalDataChange(e,t,n=!0){(this.isUserReload&&this.autoCleanListWhenReload||!this.firstPageLoaded||e.length||!t.length)&&(this._doCheckScrollViewShouldFullHeight(e),this.realTotalData.length||e.length||(n=!1),this.realTotalData=e,n&&(this.$emit("input",e),this.$emit("update:modelValue",e),this.$emit("update:list",e),this.$emit("listChange",e),this._callMyParentList(e)),this.firstPageLoaded=!1,this.isTotalChangeFromAddData=!1,this.$nextTick((()=>{pn.delay((()=>{this._getNodeClientRect(".zp-paging-container-content").then((e=>{e&&this.$emit("contentHeightChanged",e[0].height)}))}),Zt*(this.isIos?1:3))})))},_currentDataChange(e,t){e=[...e],this.finalUseVirtualList&&this._setCellIndex(e,"bottom"),this.isFirstPage&&this.finalConcat&&(this.totalData=[]),-1!==this.customNoMore?(1===this.customNoMore||0!==this.customNoMore&&!e.length)&&(this.loadingStatus=hn.More.NoMore):(!e.length||e.length&&e.length<this.defaultPageSize)&&(this.loadingStatus=hn.More.NoMore),this.totalData.length&&this.finalConcat?(this.oldScrollTop,this.totalData=[...this.totalData,...e]):this.totalData=e,this.privateConcat=!0},_handleRefreshWithDisPageNo(e){if(!this.isHandlingRefreshToPage&&!this.realTotalData.length)return this.reload();if(e>=1){this.loading=!0,this.privateConcat=!1;const t=e*this.pageSize;this.currentRefreshPageSize=t,this.isLocalPaging&&this.isHandlingRefreshToPage?this._localPagingQueryList(this.defaultPageNo,t,0,(e=>{this.complete(e)})):(this._emitQuery(this.defaultPageNo,t,hn.QueryFrom.Refresh),this._callMyParentQuery(this.defaultPageNo,t))}return new Promise(((e,t)=>{this.dataPromiseResultMap.reload={resolve:e,reject:t}}))},_localPagingQueryList(e,t,n,o){e=Math.max(1,e),t=Math.max(1,t);const a=[...this.totalLocalPagingList],i=(e-1)*t,r=Math.min(a.length,i+t),s=a.splice(i,r-i);pn.delay((()=>o(s)),n)},_saveLocalCache(e){uni.setStorageSync(this.finalCacheKey,e)},_setListByLocalCache(){this.totalData=uni.getStorageSync(this.finalCacheKey)||[],this.isSettingCacheList=!0},_callMyParentList(e){if(this.autowireListName.length){const t=pn.getParent(this.$parent);t&&t[this.autowireListName]&&(t[this.autowireListName]=e)}},_callMyParentQuery(e=0,t=0){if(this.autowireQueryName){if(-1===this.myParentQuery){const e=pn.getParent(this.$parent);e&&e[this.autowireQueryName]&&(this.myParentQuery=e[this.autowireQueryName])}-1!==this.myParentQuery&&(t>0?this.myParentQuery(e,t):this.myParentQuery(this.pageNo,this.defaultPageSize))}},_emitQuery(e,t,n){this.queryFrom=n,this.requestTimeStamp=pn.getTime();const[o]=this.realTotalData.slice(-1);if(this.fetch){const a=Sn._handleFetchParams({pageNo:e,pageSize:t,from:n,lastItem:o||null},this.fetchParams),i=this.fetch(a);Sn._handleFetchResult(i,this,a)||(pn.isPromise(i)?i.then((e=>{this.complete(e)})).catch((e=>{this.complete(!1)})):this.complete(i))}else this.$emit("query",...Sn._handleQuery(e,t,n,o||null))},_callDataPromise(e,t){for(const n in this.dataPromiseResultMap){const o=this.dataPromiseResultMap[n];o&&(e?o.resolve({totalList:t,noMore:this.loadingStatus===hn.More.NoMore}):this.callNetworkReject&&o.reject(`z-paging-${n}-error`))}},_checkDataType(e,t,n){const o=Object.prototype.toString.call(e);return"[object Boolean]"===o?(t=e,e=[]):"[object Array]"!==o&&(e=[],"[object Undefined]"!==o&&"[object Null]"!==o&&pn.consoleErr((n?"setLocalPaging":"complete")+"参数类型不正确，第一个参数类型必须为Array!")),{data:e,success:t}}}},wn=["{","}"];const bn=/^(?:\d)+/,Dn=/^(?:\w)+/;const Nn="zh-Hans",Rn="zh-Hant",Ln="en",An=Object.prototype.hasOwnProperty,On=(e,t)=>An.call(e,t),Pn=new class{constructor(){this._caches=Object.create(null)}interpolate(e,t,n=wn){if(!t)return[e];let o=this._caches[e];return o||(o=function(e,[t,n]){const o=[];let a=0,i="";for(;a<e.length;){let r=e[a++];if(r===t){i&&o.push({type:"text",value:i}),i="";let t="";for(r=e[a++];void 0!==r&&r!==n;)t+=r,r=e[a++];const s=r===n,l=bn.test(t)?"list":s&&Dn.test(t)?"named":"unknown";o.push({value:t,type:l})}else i+=r}return i&&o.push({type:"text",value:i}),o}(e,n),this._caches[e]=o),function(e,t){const n=[];let o=0;const a=Array.isArray(t)?"list":(i=t,null!==i&&"object"==typeof i?"named":"unknown");var i;if("unknown"===a)return n;for(;o<e.length;){const i=e[o];switch(i.type){case"text":n.push(i.value);break;case"list":n.push(t[parseInt(i.value,10)]);break;case"named":"named"===a&&n.push(t[i.value])}o++}return n}(o,t)}};function Un(e,t){if(!e)return;if(e=e.trim().replace(/_/g,"-"),t&&t[e])return e;if("chinese"===(e=e.toLowerCase()))return Nn;if(0===e.indexOf("zh"))return e.indexOf("-hans")>-1?Nn:e.indexOf("-hant")>-1?Rn:(n=e,["-tw","-hk","-mo","-cht"].find((e=>-1!==n.indexOf(e)))?Rn:Nn);var n;let o=[Ln,"fr","es"];t&&Object.keys(t).length>0&&(o=Object.keys(t));const a=function(e,t){return t.find((t=>0===e.indexOf(t)))}(e,o);return a||void 0}class xn{constructor({locale:e,fallbackLocale:t,messages:n,watcher:o,formater:a}){this.locale=Ln,this.fallbackLocale=Ln,this.message={},this.messages={},this.watchers=[],t&&(this.fallbackLocale=t),this.formater=a||Pn,this.messages=n||{},this.setLocale(e||Ln),o&&this.watchLocale(o)}setLocale(e){const t=this.locale;this.locale=Un(e,this.messages)||this.fallbackLocale,this.messages[this.locale]||(this.messages[this.locale]={}),this.message=this.messages[this.locale],t!==this.locale&&this.watchers.forEach((e=>{e(this.locale,t)}))}getLocale(){return this.locale}watchLocale(e){const t=this.watchers.push(e)-1;return()=>{this.watchers.splice(t,1)}}add(e,t,n=!0){const o=this.messages[e];o?n?Object.assign(o,t):Object.keys(t).forEach((e=>{On(o,e)||(o[e]=t[e])})):this.messages[e]=t}f(e,t,n){return this.formater.interpolate(e,t,n).join("")}t(e,t,n){let o=this.message;return"string"==typeof t?(t=Un(t,this.messages))&&(o=this.messages[t]):n=t,On(o,e)?this.formater.interpolate(o[e],n).join(""):e}}const Vn={en:{"zp.refresher.default":"Pull down to refresh","zp.refresher.pulling":"Release to refresh","zp.refresher.refreshing":"Refreshing...","zp.refresher.complete":"Refresh succeeded","zp.refresher.f2":"Refresh to enter 2f","zp.loadingMore.default":"Click to load more","zp.loadingMore.loading":"Loading...","zp.loadingMore.noMore":"No more data","zp.loadingMore.fail":"Load failed,click to reload","zp.emptyView.title":"No data","zp.emptyView.reload":"Reload","zp.emptyView.error":"Sorry,load failed","zp.refresherUpdateTime.title":"Last update: ","zp.refresherUpdateTime.none":"None","zp.refresherUpdateTime.today":"Today","zp.refresherUpdateTime.yesterday":"Yesterday","zp.systemLoading.title":"Loading..."},"zh-Hans":{"zp.refresher.default":"继续下拉刷新","zp.refresher.pulling":"松开立即刷新","zp.refresher.refreshing":"正在刷新...","zp.refresher.complete":"刷新成功","zp.refresher.f2":"松手进入二楼","zp.loadingMore.default":"点击加载更多","zp.loadingMore.loading":"正在加载...","zp.loadingMore.noMore":"没有更多了","zp.loadingMore.fail":"加载失败，点击重新加载","zp.emptyView.title":"没有数据哦~","zp.emptyView.reload":"重新加载","zp.emptyView.error":"很抱歉，加载失败","zp.refresherUpdateTime.title":"最后更新：","zp.refresherUpdateTime.none":"无","zp.refresherUpdateTime.today":"今天","zp.refresherUpdateTime.yesterday":"昨天","zp.systemLoading.title":"加载中..."},"zh-Hant":{"zp.refresher.default":"繼續下拉重繪","zp.refresher.pulling":"鬆開立即重繪","zp.refresher.refreshing":"正在重繪...","zp.refresher.complete":"重繪成功","zp.refresher.f2":"鬆手進入二樓","zp.loadingMore.default":"點擊加載更多","zp.loadingMore.loading":"正在加載...","zp.loadingMore.noMore":"沒有更多了","zp.loadingMore.fail":"加載失敗，點擊重新加載","zp.emptyView.title":"沒有數據哦~","zp.emptyView.reload":"重新加載","zp.emptyView.error":"很抱歉，加載失敗","zp.refresherUpdateTime.title":"最後更新：","zp.refresherUpdateTime.none":"無","zp.refresherUpdateTime.today":"今天","zp.refresherUpdateTime.yesterday":"昨天","zp.systemLoading.title":"加載中..."}},{t:Bn}=function(e,t={},n,o){if("string"!=typeof e){const n=[t,e];e=n[0],t=n[1]}"string"!=typeof e&&(e="undefined"!=typeof uni&&uni.getLocale?uni.getLocale():"undefined"!=typeof global&&global.getLocale?global.getLocale():Ln),"string"!=typeof n&&(n="undefined"!=typeof __uniConfig&&__uniConfig.fallbackLocale||Ln);const a=new xn({locale:e,fallbackLocale:n,messages:t,watcher:o});let i=(e,t)=>{if("function"!=typeof getApp)i=function(e,t){return a.t(e,t)};else{let e=!1;i=function(t,n){const o=getApp().$vm;return o&&(o.$locale,e||(e=!0,function(e,t){e.$watchLocale?e.$watchLocale((e=>{t.setLocale(e)})):e.$watch((()=>e.$locale),(e=>{t.setLocale(e)}))}(o,a))),a.t(t,n)}}return i(e,t)};return{i18n:a,f:(e,t,n)=>a.f(e,t,n),t:(e,t)=>i(e,t),add:(e,t,n=!0)=>a.add(e,t,n),watch:e=>a.watchLocale(e),getLocale:()=>a.getLocale(),setLocale:e=>a.setLocale(e)}}(Vn),Gn=uni.getSystemInfoSync().language,Fn={data:()=>({language:Gn}),computed:{finalLanguage(){try{const e=uni.getLocale(),t=this.language;return"auto"===e?Sn._handleLanguage2Local(t,this._language2Local(t)):e}catch(vs){return"zh-Hans"}},finalRefresherDefaultText(){return this._getI18nText("zp.refresher.default",this.refresherDefaultText)},finalRefresherPullingText(){return this._getI18nText("zp.refresher.pulling",this.refresherPullingText)},finalRefresherRefreshingText(){return this._getI18nText("zp.refresher.refreshing",this.refresherRefreshingText)},finalRefresherCompleteText(){return this._getI18nText("zp.refresher.complete",this.refresherCompleteText)},finalRefresherUpdateTimeTextMap:()=>({title:Bn("zp.refresherUpdateTime.title"),none:Bn("zp.refresherUpdateTime.none"),today:Bn("zp.refresherUpdateTime.today"),yesterday:Bn("zp.refresherUpdateTime.yesterday")}),finalRefresherGoF2Text(){return this._getI18nText("zp.refresher.f2",this.refresherGoF2Text)},finalLoadingMoreDefaultText(){return this._getI18nText("zp.loadingMore.default",this.loadingMoreDefaultText)},finalLoadingMoreLoadingText(){return this._getI18nText("zp.loadingMore.loading",this.loadingMoreLoadingText)},finalLoadingMoreNoMoreText(){return this._getI18nText("zp.loadingMore.noMore",this.loadingMoreNoMoreText)},finalLoadingMoreFailText(){return this._getI18nText("zp.loadingMore.fail",this.loadingMoreFailText)},finalEmptyViewText(){return this.isLoadFailed?this.finalEmptyViewErrorText:this._getI18nText("zp.emptyView.title",this.emptyViewText)},finalEmptyViewReloadText(){return this._getI18nText("zp.emptyView.reload",this.emptyViewReloadText)},finalEmptyViewErrorText(){return this.customerEmptyViewErrorText||this._getI18nText("zp.emptyView.error",this.emptyViewErrorText)},finalSystemLoadingText(){return this._getI18nText("zp.systemLoading.title",this.systemLoadingText)}},methods:{getLanguage(){return this.finalLanguage},_getI18nText(e,t){const n=Object.prototype.toString.call(t);if("[object Object]"===n){const e=t[this.finalLanguage];if(e)return e}else if("[object String]"===n)return t;return Bn(e)},_language2Local(e){const t=e.toLowerCase().replace(new RegExp("_",""),"-");return-1!==t.indexOf("zh")?"zh"===t||"zh-cn"===t||-1!==t.indexOf("zh-hans")?"zh-Hans":"zh-Hant":-1!==t.indexOf("en")?"en":e}}},zn={props:{},data:()=>({nRefresherLoading:!1,nListIsDragging:!1,nShowBottom:!0,nFixFreezing:!1,nShowRefresherReveal:!1,nLoadingMoreFixedHeight:!1,nShowRefresherRevealHeight:0,nOldShowRefresherRevealHeight:-1,nRefresherWidth:pn.rpx2px(750),nF2Opacity:0}),computed:{},mounted(){},methods:{}},Hn={props:{hideEmptyView:{type:Boolean,default:pn.gc("hideEmptyView",!1)},emptyViewText:{type:[String,Object],default:pn.gc("emptyViewText",null)},showEmptyViewReload:{type:Boolean,default:pn.gc("showEmptyViewReload",!1)},showEmptyViewReloadWhenError:{type:Boolean,default:pn.gc("showEmptyViewReloadWhenError",!0)},emptyViewReloadText:{type:[String,Object],default:pn.gc("emptyViewReloadText",null)},emptyViewImg:{type:String,default:pn.gc("emptyViewImg","")},emptyViewErrorText:{type:[String,Object],default:pn.gc("emptyViewErrorText",null)},emptyViewErrorImg:{type:String,default:pn.gc("emptyViewErrorImg","")},emptyViewStyle:{type:Object,default:pn.gc("emptyViewStyle",{})},emptyViewSuperStyle:{type:Object,default:pn.gc("emptyViewSuperStyle",{})},emptyViewImgStyle:{type:Object,default:pn.gc("emptyViewImgStyle",{})},emptyViewTitleStyle:{type:Object,default:pn.gc("emptyViewTitleStyle",{})},emptyViewReloadStyle:{type:Object,default:pn.gc("emptyViewReloadStyle",{})},emptyViewFixed:{type:Boolean,default:pn.gc("emptyViewFixed",!1)},emptyViewCenter:{type:Boolean,default:pn.gc("emptyViewCenter",!0)},autoHideEmptyViewWhenLoading:{type:Boolean,default:pn.gc("autoHideEmptyViewWhenLoading",!0)},autoHideEmptyViewWhenPull:{type:Boolean,default:pn.gc("autoHideEmptyViewWhenPull",!0)},emptyViewZIndex:{type:Number,default:pn.gc("emptyViewZIndex",9)}},data:()=>({customerEmptyViewErrorText:""}),computed:{finalEmptyViewImg(){return this.isLoadFailed?this.emptyViewErrorImg:this.emptyViewImg},finalShowEmptyViewReload(){return this.isLoadFailed?this.showEmptyViewReloadWhenError:this.showEmptyViewReload},showEmpty(){return!(this.refresherOnly||this.hideEmptyView||this.realTotalData.length)&&(!this.autoHideEmptyViewWhenLoading||(!(!this.isAddedData||this.firstPageLoaded||this.loading)||!this.autoHideEmptyViewWhenPull&&!this.isUserReload))}},methods:{_emptyViewReload(){let e=!1;this.$emit("emptyViewReload",(t=>{void 0!==t&&!0!==t||(this.fromEmptyViewReload=!0,this.reload().catch((()=>{}))),e=!0})),this.$nextTick((()=>{e||(this.fromEmptyViewReload=!0,this.reload().catch((()=>{})))}))},_emptyViewClick(){this.$emit("emptyViewClick")}}},jn={props:{refresherThemeStyle:{type:String,default:pn.gc("refresherThemeStyle","")},refresherImgStyle:{type:Object,default:pn.gc("refresherImgStyle",{})},refresherTitleStyle:{type:Object,default:pn.gc("refresherTitleStyle",{})},refresherUpdateTimeStyle:{type:Object,default:pn.gc("refresherUpdateTimeStyle",{})},watchRefresherTouchmove:{type:Boolean,default:pn.gc("watchRefresherTouchmove",!1)},loadingMoreThemeStyle:{type:String,default:pn.gc("loadingMoreThemeStyle","")},refresherOnly:{type:Boolean,default:pn.gc("refresherOnly",!1)},refresherDefaultDuration:{type:[Number,String],default:pn.gc("refresherDefaultDuration",100)},refresherCompleteDelay:{type:[Number,String],default:pn.gc("refresherCompleteDelay",0)},refresherCompleteDuration:{type:[Number,String],default:pn.gc("refresherCompleteDuration",300)},refresherRefreshingScrollable:{type:Boolean,default:pn.gc("refresherRefreshingScrollable",!0)},refresherCompleteScrollable:{type:Boolean,default:pn.gc("refresherCompleteScrollable",!1)},useCustomRefresher:{type:Boolean,default:pn.gc("useCustomRefresher",!0)},refresherFps:{type:[Number,String],default:pn.gc("refresherFps",40)},refresherMaxAngle:{type:[Number,String],default:pn.gc("refresherMaxAngle",40)},refresherAngleEnableChangeContinued:{type:Boolean,default:pn.gc("refresherAngleEnableChangeContinued",!1)},refresherDefaultText:{type:[String,Object],default:pn.gc("refresherDefaultText",null)},refresherPullingText:{type:[String,Object],default:pn.gc("refresherPullingText",null)},refresherRefreshingText:{type:[String,Object],default:pn.gc("refresherRefreshingText",null)},refresherCompleteText:{type:[String,Object],default:pn.gc("refresherCompleteText",null)},refresherGoF2Text:{type:[String,Object],default:pn.gc("refresherGoF2Text",null)},refresherDefaultImg:{type:String,default:pn.gc("refresherDefaultImg",null)},refresherPullingImg:{type:String,default:pn.gc("refresherPullingImg",null)},refresherRefreshingImg:{type:String,default:pn.gc("refresherRefreshingImg",null)},refresherCompleteImg:{type:String,default:pn.gc("refresherCompleteImg",null)},refresherRefreshingAnimated:{type:Boolean,default:pn.gc("refresherRefreshingAnimated",!0)},refresherEndBounceEnabled:{type:Boolean,default:pn.gc("refresherEndBounceEnabled",!0)},refresherEnabled:{type:Boolean,default:pn.gc("refresherEnabled",!0)},refresherThreshold:{type:[Number,String],default:pn.gc("refresherThreshold","80rpx")},refresherDefaultStyle:{type:String,default:pn.gc("refresherDefaultStyle","black")},refresherBackground:{type:String,default:pn.gc("refresherBackground","transparent")},refresherFixedBackground:{type:String,default:pn.gc("refresherFixedBackground","transparent")},refresherFixedBacHeight:{type:[Number,String],default:pn.gc("refresherFixedBacHeight",0)},refresherOutRate:{type:Number,default:pn.gc("refresherOutRate",.65)},refresherF2Enabled:{type:Boolean,default:pn.gc("refresherF2Enabled",!1)},refresherF2Threshold:{type:[Number,String],default:pn.gc("refresherF2Threshold","200rpx")},refresherF2Duration:{type:[Number,String],default:pn.gc("refresherF2Duration",200)},showRefresherF2:{type:Boolean,default:pn.gc("showRefresherF2",!0)},refresherPullRate:{type:Number,default:pn.gc("refresherPullRate",.75)},showRefresherUpdateTime:{type:Boolean,default:pn.gc("showRefresherUpdateTime",!1)},refresherUpdateTimeKey:{type:String,default:pn.gc("refresherUpdateTimeKey","default")},refresherVibrate:{type:Boolean,default:pn.gc("refresherVibrate",!1)},refresherNoTransform:{type:Boolean,default:pn.gc("refresherNoTransform",!1)},useRefresherStatusBarPlaceholder:{type:Boolean,default:pn.gc("useRefresherStatusBarPlaceholder",!1)}},data:()=>({R:hn.Refresher,refresherStatus:hn.Refresher.Default,refresherTouchstartY:0,lastRefresherTouchmove:null,refresherReachMaxAngle:!0,refresherTransform:"translateY(0px)",refresherTransition:"",finalRefresherDefaultStyle:"black",refresherRevealStackCount:0,refresherCompleteTimeout:null,refresherCompleteSubTimeout:null,refresherEndTimeout:null,isTouchmovingTimeout:null,refresherTriggered:!1,isTouchmoving:!1,isTouchEnded:!1,isUserPullDown:!1,privateRefresherEnabled:-1,privateShowRefresherWhenReload:!1,customRefresherHeight:-1,showCustomRefresher:!1,doRefreshAnimateAfter:!1,isRefresherInComplete:!1,showF2:!1,f2Transform:"",pullDownTimeStamp:0,moveDis:0,oldMoveDis:0,currentDis:0,oldCurrentMoveDis:0,oldRefresherTouchmoveY:0,oldTouchDirection:"",oldEmitedTouchDirection:"",oldPullingDistance:-1,refresherThresholdUpdateTag:0}),watch:{refresherDefaultStyle:{handler(e){e.length&&(this.finalRefresherDefaultStyle=e)},immediate:!0},refresherStatus(e){e===hn.Refresher.Loading&&this._cleanRefresherEndTimeout(),this.refresherVibrate&&(e===hn.Refresher.ReleaseToRefresh||e===hn.Refresher.GoF2)&&this._doVibrateShort(),this.$emit("refresherStatusChange",e),this.$emit("update:refresherStatus",e)},refresherEnabled(e){!e&&this.endRefresh()}},computed:{pullDownDisTimeStamp(){return 1e3/this.refresherFps},refresherThresholdUnitConverted(){return pn.addUnit(this.refresherThreshold,this.unit)},finalRefresherEnabled(){return!this.useChatRecordMode&&(-1===this.privateRefresherEnabled?this.refresherEnabled:1===this.privateRefresherEnabled)},finalRefresherThreshold(){let e=this.refresherThresholdUnitConverted,t=!1;return e===pn.addUnit(80,this.unit)&&(t=!0,this.showRefresherUpdateTime&&(e=pn.addUnit(120,this.unit))),t&&this.customRefresherHeight>0?this.customRefresherHeight+this.finalRefresherThresholdPlaceholder:pn.convertToPx(e)+this.finalRefresherThresholdPlaceholder},finalRefresherF2Threshold(){return pn.convertToPx(pn.addUnit(this.refresherF2Threshold,this.unit))},finalRefresherThresholdPlaceholder(){return this.useRefresherStatusBarPlaceholder?this.statusBarHeight:0},finalRefresherFixedBacHeight(){return pn.convertToPx(this.refresherFixedBacHeight)},finalRefresherThemeStyle(){return this.refresherThemeStyle.length?this.refresherThemeStyle:this.defaultThemeStyle},finalRefresherOutRate(){let e=this.refresherOutRate;return e=Math.max(0,e),e=Math.min(1,e),e},finalRefresherPullRate(){let e=this.refresherPullRate;return e=Math.max(0,e),e},finalRefresherTransform(){return this.refresherNoTransform||"translateY(0px)"===this.refresherTransform?"none":this.refresherTransform},finalShowRefresherWhenReload(){return this.showRefresherWhenReload||this.privateShowRefresherWhenReload},finalRefresherTriggered(){return!(!this.finalRefresherEnabled||this.useCustomRefresher)&&this.refresherTriggered},showRefresher(){const e=this.finalRefresherEnabled||this.useCustomRefresher&&!this.useChatRecordMode;return this.active&&-1===this.customRefresherHeight&&e&&this.updateCustomRefresherHeight(),e},hasTouchmove(){return this.watchRefresherTouchmove}},methods:{endRefresh(){this.totalData=this.realTotalData,this._refresherEnd(),this._endSystemLoadingAndRefresh(),this._handleScrollViewBounce({bounce:!0}),this.$nextTick((()=>{this.refresherTriggered=!1}))},updateCustomRefresherHeight(){pn.delay((()=>this.$nextTick(this._updateCustomRefresherHeight)))},closeF2(){this._handleCloseF2()},_onRefresh(e=!1,t=!0){(!e||this.finalRefresherEnabled&&!this.useCustomRefresher)&&(this.$emit("onRefresh"),this.$emit("Refresh"),this.loading||this.isRefresherInComplete||(this.loadingType=hn.LoadingType.Refresher,this.nShowRefresherReveal||(this.isUserPullDown=t,this.isUserReload=!t,this._startLoading(!0),this.refresherTriggered=!0,this.reloadWhenRefresh&&t&&(this.useChatRecordMode?this._onLoadingMore("click"):this._reload(!1,!1,t)))))},_onRestore(){this.refresherTriggered="restore",this.$emit("onRestore"),this.$emit("Restore")},_handleRefresherTouchstart(e){!this.loading&&this.isTouchEnded&&(this.isTouchmoving=!1),this.loadingType=hn.LoadingType.Refresher,this.isTouchmovingTimeout&&clearTimeout(this.isTouchmovingTimeout),this.isTouchEnded=!1,this.refresherTransition="",this.refresherTouchstartY=e.touchY,this.$emit("refresherTouchstart",this.refresherTouchstartY),this.lastRefresherTouchmove=e,this._cleanRefresherCompleteTimeout(),this._cleanRefresherEndTimeout()},_refresherTouchmove(e){const t=pn.getTime();let n=null,o=0;if(this.watchTouchDirectionChange){n=pn.getTouch(e),o=n.touchY;const t=o>this.oldRefresherTouchmoveY?"top":"bottom";t===this.oldTouchDirection&&t!==this.oldEmitedTouchDirection&&(this._handleTouchDirectionChange({direction:t}),this.oldEmitedTouchDirection=t),this.oldTouchDirection=t,this.oldRefresherTouchmoveY=o}if(this.pullDownTimeStamp&&t-this.pullDownTimeStamp<=this.pullDownDisTimeStamp)return;if(this._touchDisabled())return;this.pullDownTimeStamp=Number(t),n=pn.getTouch(e),o=n.touchY;let a=o-this.refresherTouchstartY;if(!(a<0)){if(this.refresherMaxAngle>=0&&this.refresherMaxAngle<=90&&this.lastRefresherTouchmove&&this.lastRefresherTouchmove.touchY<=o){if(!a&&!this.refresherAngleEnableChangeContinued&&this.moveDis<1&&!this.refresherReachMaxAngle)return;const e=Math.abs(n.touchX-this.lastRefresherTouchmove.touchX),t=Math.abs(o-this.lastRefresherTouchmove.touchY),i=Math.sqrt(Math.pow(e,2)+Math.pow(t,2));if((e||t)&&e>1){if(Math.asin(t/i)/Math.PI*180<this.refresherMaxAngle)return this.lastRefresherTouchmove=n,void(this.refresherReachMaxAngle=!1)}}a=this._getFinalRefresherMoveDis(a),this._handleRefresherTouchmove(a,n),this.disabledBounce||(this._handleScrollViewBounce({bounce:!1}),this.disabledBounce=!0),this._emitTouchmove({pullingDistance:a,dy:this.moveDis-this.oldMoveDis})}},_handleRefresherTouchmove(e,t){this.refresherReachMaxAngle=!0,this.isTouchmovingTimeout&&clearTimeout(this.isTouchmovingTimeout),this.isTouchmoving=!0,this.isTouchEnded=!1,e>=this.finalRefresherThreshold?this.refresherStatus=this.refresherF2Enabled&&e>=this.finalRefresherF2Threshold?hn.Refresher.GoF2:hn.Refresher.ReleaseToRefresh:this.refresherStatus=hn.Refresher.Default,this.moveDis=e},_handleRefresherTouchend(e){this.isTouchmovingTimeout&&clearTimeout(this.isTouchmovingTimeout),this.refresherReachMaxAngle=!0,this.isTouchEnded=!0;const t=this.finalRefresherThreshold;e>=t&&(this.refresherStatus===hn.Refresher.ReleaseToRefresh||this.refresherStatus===hn.Refresher.GoF2)?this.refresherStatus===hn.Refresher.GoF2?(this._handleGoF2(),this._refresherEnd()):(pn.delay((()=>{this._emitTouchmove({pullingDistance:t,dy:this.moveDis-t})}),.1),this.moveDis=t,this.refresherStatus=hn.Refresher.Loading,this._doRefresherLoad()):(this._refresherEnd(),this.isTouchmovingTimeout=pn.delay((()=>{this.isTouchmoving=!1}),this.refresherDefaultDuration)),this.scrollEnable=!0,this.$emit("refresherTouchend",e)},_handleListTouchstart(){this.useChatRecordMode&&this.autoHideKeyboardWhenChat&&(uni.hideKeyboard(),this.$emit("hidedKeyboard"))},_handleScrollViewBounce({bounce:e}){this.usePageScroll||this.scrollToTopBounceEnabled||(this.wxsScrollTop<=5?(this.refresherTransition="",this.scrollEnable=e):e&&(this.scrollEnable=e))},_handleWxsPullingDownStatusChange(e){this.wxsOnPullingDown=e,e&&!this.useChatRecordMode&&(this.renderPropScrollTop=0)},_handleWxsPullingDown({moveDis:e,diffDis:t}){this._emitTouchmove({pullingDistance:e,dy:t})},_handleTouchDirectionChange({direction:e}){this.$emit("touchDirectionChange",e)},_handlePropUpdate(){this.wxsPropType=pn.getTime().toString()},_refresherEnd(e=!0,t=!1,n=!1,o=!0){if(this.loadingType===hn.LoadingType.Refresher){const e=t&&(n||this.showRefresherWhenReload)?this.refresherCompleteDelay:0,o=e>0?hn.Refresher.Complete:hn.Refresher.Default;if(this.finalShowRefresherWhenReload){const e=this.refresherRevealStackCount;if(this.refresherRevealStackCount--,e>1)return}this._cleanRefresherEndTimeout(),this.refresherEndTimeout=pn.delay((()=>{this.refresherStatus=o,o!==hn.Refresher.Complete&&(this.isRefresherInComplete=!1)}),this.refresherStatus!==hn.Refresher.Default&&o===hn.Refresher.Default?this.refresherCompleteDuration:0),e>0&&(this.isRefresherInComplete=!0),this._cleanRefresherCompleteTimeout(),this.refresherCompleteTimeout=pn.delay((()=>{let e=1;const n=this.refresherEndBounceEnabled&&t?"cubic-bezier(0.19,1.64,0.42,0.72)":"linear";t&&(e=this.refresherEndBounceEnabled?this.refresherCompleteDuration/1e3:this.refresherCompleteDuration/3e3),this.refresherTransition=`transform ${t?e:this.refresherDefaultDuration/1e3}s ${n}`,this.wxsPropType=this.refresherTransition+"end"+pn.getTime(),this.moveDis=0,o===hn.Refresher.Complete&&(this.refresherCompleteSubTimeout&&(clearTimeout(this.refresherCompleteSubTimeout),this.refresherCompleteSubTimeout=null),this.refresherCompleteSubTimeout=pn.delay((()=>{this.$nextTick((()=>{this.refresherStatus=hn.Refresher.Default,this.isRefresherInComplete=!1}))}),800*e)),this._emitTouchmove({pullingDistance:0,dy:this.moveDis})}),e)}o&&(pn.delay((()=>this.loading=!1),e?10:0),n&&this._onRestore())},_handleGoF2(){!this.showF2&&this.refresherF2Enabled&&(this.$emit("refresherF2Change","go"),this.showRefresherF2&&(this.f2Transform=`translateY(${-this.superContentHeight}px)`,this.showF2=!0,pn.delay((()=>{this.f2Transform="translateY(0px)"}),100,"f2ShowDelay")))},_handleCloseF2(){this.showF2&&this.refresherF2Enabled&&(this.$emit("refresherF2Change","close"),this.showRefresherF2&&(this.f2Transform=`translateY(${-this.superContentHeight}px)`,pn.delay((()=>{this.showF2=!1,this.nF2Opacity=0}),this.refresherF2Duration,"f2CloseDelay")))},_doRefresherRefreshAnimate(){this._cleanRefresherCompleteTimeout();!this.doRefreshAnimateAfter&&this.finalShowRefresherWhenReload&&-1===this.customRefresherHeight&&this.refresherThreshold===pn.addUnit(80,this.unit)?this.doRefreshAnimateAfter=!0:(this.refresherRevealStackCount++,this.wxsPropType="begin"+pn.getTime(),this.moveDis=this.finalRefresherThreshold,this.refresherStatus=hn.Refresher.Loading,this.isTouchmoving=!0,this.isTouchmovingTimeout&&clearTimeout(this.isTouchmovingTimeout),this._doRefresherLoad(!1))},_doRefresherLoad(e=!0){this._onRefresh(!1,e),this.loading=!0},_updateCustomRefresherHeight(){this._getNodeClientRect(".zp-custom-refresher-slot-view").then((e=>{this.customRefresherHeight=e?e[0].height:0,this.showCustomRefresher=this.customRefresherHeight>0,this.doRefreshAnimateAfter&&(this.doRefreshAnimateAfter=!1,this._doRefresherRefreshAnimate())}))},_emitTouchmove(e){e.viewHeight=this.finalRefresherThreshold,e.rate=e.viewHeight>0?e.pullingDistance/e.viewHeight:0,this.hasTouchmove&&this.oldPullingDistance!==e.pullingDistance&&this.$emit("refresherTouchmove",e),this.oldPullingDistance=e.pullingDistance},_cleanRefresherCompleteTimeout(){this.refresherCompleteTimeout=this._cleanTimeout(this.refresherCompleteTimeout)},_cleanRefresherEndTimeout(){this.refresherEndTimeout=this._cleanTimeout(this.refresherEndTimeout)}}},qn={props:{loadingMoreCustomStyle:{type:Object,default:pn.gc("loadingMoreCustomStyle",{})},loadingMoreTitleCustomStyle:{type:Object,default:pn.gc("loadingMoreTitleCustomStyle",{})},loadingMoreLoadingIconCustomStyle:{type:Object,default:pn.gc("loadingMoreLoadingIconCustomStyle",{})},loadingMoreLoadingIconType:{type:String,default:pn.gc("loadingMoreLoadingIconType","flower")},loadingMoreLoadingIconCustomImage:{type:String,default:pn.gc("loadingMoreLoadingIconCustomImage","")},loadingMoreLoadingAnimated:{type:Boolean,default:pn.gc("loadingMoreLoadingAnimated",!0)},loadingMoreEnabled:{type:Boolean,default:pn.gc("loadingMoreEnabled",!0)},toBottomLoadingMoreEnabled:{type:Boolean,default:pn.gc("toBottomLoadingMoreEnabled",!0)},loadingMoreDefaultAsLoading:{type:Boolean,default:pn.gc("loadingMoreDefaultAsLoading",!1)},loadingMoreDefaultText:{type:[String,Object],default:pn.gc("loadingMoreDefaultText",null)},loadingMoreLoadingText:{type:[String,Object],default:pn.gc("loadingMoreLoadingText",null)},loadingMoreNoMoreText:{type:[String,Object],default:pn.gc("loadingMoreNoMoreText",null)},loadingMoreFailText:{type:[String,Object],default:pn.gc("loadingMoreFailText",null)},hideNoMoreInside:{type:Boolean,default:pn.gc("hideNoMoreInside",!1)},hideNoMoreByLimit:{type:Number,default:pn.gc("hideNoMoreByLimit",0)},showDefaultLoadingMoreText:{type:Boolean,default:pn.gc("showDefaultLoadingMoreText",!0)},showLoadingMoreNoMoreView:{type:Boolean,default:pn.gc("showLoadingMoreNoMoreView",!0)},showLoadingMoreNoMoreLine:{type:Boolean,default:pn.gc("showLoadingMoreNoMoreLine",!0)},loadingMoreNoMoreLineCustomStyle:{type:Object,default:pn.gc("loadingMoreNoMoreLineCustomStyle",{})},insideMore:{type:Boolean,default:pn.gc("insideMore",!1)},lowerThreshold:{type:[Number,String],default:pn.gc("lowerThreshold","100rpx")}},data:()=>({M:hn.More,loadingStatus:hn.More.Default,loadingStatusAfterRender:hn.More.Default,loadingMoreTimeStamp:0,loadingMoreDefaultSlot:null,showLoadingMore:!1,customNoMore:-1}),computed:{zLoadMoreConfig(){return{status:this.loadingStatusAfterRender,defaultAsLoading:this.loadingMoreDefaultAsLoading||this.useChatRecordMode&&this.chatLoadingMoreDefaultAsLoading,defaultThemeStyle:this.finalLoadingMoreThemeStyle,customStyle:this.loadingMoreCustomStyle,titleCustomStyle:this.loadingMoreTitleCustomStyle,iconCustomStyle:this.loadingMoreLoadingIconCustomStyle,loadingIconType:this.loadingMoreLoadingIconType,loadingIconCustomImage:this.loadingMoreLoadingIconCustomImage,loadingAnimated:this.loadingMoreLoadingAnimated,showNoMoreLine:this.showLoadingMoreNoMoreLine,noMoreLineCustomStyle:this.loadingMoreNoMoreLineCustomStyle,defaultText:this.finalLoadingMoreDefaultText,loadingText:this.finalLoadingMoreLoadingText,noMoreText:this.finalLoadingMoreNoMoreText,failText:this.finalLoadingMoreFailText,hideContent:!this.loadingMoreDefaultAsLoading&&this.listRendering,unit:this.unit,isChat:this.useChatRecordMode,chatDefaultAsLoading:this.chatLoadingMoreDefaultAsLoading}},finalLoadingMoreThemeStyle(){return this.loadingMoreThemeStyle.length?this.loadingMoreThemeStyle:this.defaultThemeStyle},finalLowerThreshold(){return pn.convertToPx(this.lowerThreshold)},showLoadingMoreDefault(){return this._showLoadingMore("Default")},showLoadingMoreLoading(){return this._showLoadingMore("Loading")},showLoadingMoreNoMore(){return this._showLoadingMore("NoMore")},showLoadingMoreFail(){return this._showLoadingMore("Fail")},showLoadingMoreCustom(){return this._showLoadingMore("Custom")},loadingMoreFixedHeight(){return pn.addUnit("80rpx",this.unit)}},methods:{pageReachBottom(){!this.useChatRecordMode&&this.toBottomLoadingMoreEnabled&&this._onLoadingMore("toBottom")},doLoadMore(e){this._onLoadingMore(e)},_checkScrolledToBottom(e,t=!1){-1===this.cacheScrollNodeHeight?this._getNodeClientRect(".zp-scroll-view").then((t=>{if(t){const n=t[0].height;this.cacheScrollNodeHeight=n,e-n<=this.finalLowerThreshold&&this._onLoadingMore("toBottom")}})):(e-this.cacheScrollNodeHeight<=this.finalLowerThreshold?this._onLoadingMore("toBottom"):e-this.cacheScrollNodeHeight<=500&&!t&&pn.delay((()=>{this._getNodeClientRect(".zp-scroll-view",!0,!0).then((e=>{if(e){this.oldScrollTop=e[0].scrollTop;const t=e[0].scrollHeight-this.oldScrollTop;this._checkScrolledToBottom(t,!0)}}))}),150,"checkScrolledToBottomDelay"),this.oldScrollTop<=150&&0!==this.oldScrollTop&&pn.delay((()=>{0!==this.oldScrollTop&&this._getNodeClientRect(".zp-scroll-view",!0,!0).then((e=>{e&&0===e[0].scrollTop&&0!==this.oldScrollTop&&this._onScrollToUpper()}))}),150,"checkScrolledToTopDelay"))},_onLoadingMore(e="click"){this.isIos&&"toBottom"===e&&!this.scrollToBottomBounceEnabled&&this.scrollEnable&&(this.scrollEnable=!1,this.$nextTick((()=>{this.scrollEnable=!0}))),this.$emit("scrolltolower",e),this.refresherOnly||!this.loadingMoreEnabled||this.loadingStatus!==hn.More.Default&&this.loadingStatus!==hn.More.Fail||this.loading||this.showEmpty||this._doLoadingMore()},_doLoadingMore(){this.pageNo>=this.defaultPageNo&&this.loadingStatus!==hn.More.NoMore&&(this.pageNo++,this._startLoading(!1),this.isLocalPaging?this._localPagingQueryList(this.pageNo,this.defaultPageSize,this.localPagingLoadingTime,(e=>{this.completeByTotal(e,this.totalLocalPagingList.length),this.queryFrom=hn.QueryFrom.LoadMore})):(this._emitQuery(this.pageNo,this.defaultPageSize,hn.QueryFrom.LoadMore),this._callMyParentQuery()),this.loadingType=hn.LoadingType.LoadMore)},_preCheckShowNoMoreInside(e,t,n){this.loadingStatus===hn.More.NoMore&&this.hideNoMoreByLimit>0&&e.length?this.showLoadingMore=e.length>this.hideNoMoreByLimit:this.loadingStatus===hn.More.NoMore&&this.hideNoMoreInside&&e.length||this.insideMore&&!1!==this.insideOfPaging&&e.length?(this.$nextTick((()=>{this._checkShowNoMoreInside(e,t,n)})),this.insideMore&&!1!==this.insideOfPaging&&e.length&&(this.showLoadingMore=e.length)):this.showLoadingMore=e.length},_checkShowNoMoreInside(e,t,n){return __async(this,null,(function*(){try{const e=t||(yield this._getNodeClientRect(".zp-scroll-view"));if(this.usePageScroll){if(e){const t=e[0].top+e[0].height;this.insideOfPaging=t<this.windowHeight,this.hideNoMoreInside&&(this.showLoadingMore=!this.insideOfPaging),this._updateInsideOfPaging()}}else{const t=n||(yield this._getNodeClientRect(".zp-paging-container-content")),o=t?t[0].height:0,a=e?e[0].height:0;this.insideOfPaging=o<a,this.hideNoMoreInside&&(this.showLoadingMore=!this.insideOfPaging),this._updateInsideOfPaging()}}catch(vs){this.insideOfPaging=!e.length,this.hideNoMoreInside&&(this.showLoadingMore=!this.insideOfPaging),this._updateInsideOfPaging()}}))},_showLoadingMore(e){if(!this.showLoadingMoreWhenReload&&(this.loadingStatus===hn.More.Default&&!this.nShowBottom||!this.realTotalData.length))return!1;if((!this.showLoadingMoreWhenReload||this.isUserPullDown||this.loadingStatus!==hn.More.Loading)&&!this.showLoadingMore||!this.loadingMoreEnabled&&(!this.showLoadingMoreWhenReload||this.isUserPullDown||this.loadingStatus!==hn.More.Loading)||this.refresherOnly)return!1;if(this.useChatRecordMode&&"Loading"!==e)return!1;if(!this.zSlots)return!1;if("Custom"===e)return this.showDefaultLoadingMoreText&&!(this.loadingStatus===hn.More.NoMore&&!this.showLoadingMoreNoMoreView);return this.loadingStatus===hn.More[e]&&this.zSlots[`loadingMore${e}`]&&("NoMore"!==e||this.showLoadingMoreNoMoreView)}}},Kn={props:{autoHideLoadingAfterFirstLoaded:{type:Boolean,default:pn.gc("autoHideLoadingAfterFirstLoaded",!0)},loadingFullFixed:{type:Boolean,default:pn.gc("loadingFullFixed",!1)},autoShowSystemLoading:{type:Boolean,default:pn.gc("autoShowSystemLoading",!1)},systemLoadingMask:{type:Boolean,default:pn.gc("systemLoadingMask",!0)},systemLoadingText:{type:[String,Object],default:pn.gc("systemLoadingText",null)}},data:()=>({loading:!1,loadingForNow:!1}),watch:{loadingStatus(e){this.$emit("loadingStatusChange",e),this.$nextTick((()=>{this.loadingStatusAfterRender=e})),!this.useChatRecordMode||!this.isFirstPage||e!==hn.More.NoMore&&e!==hn.More.Fail?this.isFirstPageAndNoMore=!1:this.isFirstPageAndNoMore=!0},loading(e){e&&(this.loadingForNow=e)}},computed:{showLoading(){return!(this.firstPageLoaded||!this.loading||!this.loadingForNow)&&(this.finalShowSystemLoading&&uni.showLoading({title:this.finalSystemLoadingText,mask:this.systemLoadingMask}),this.autoHideLoadingAfterFirstLoaded?!!this.fromEmptyViewReload||!this.pagingLoaded:this.loadingType===hn.LoadingType.Refresher)},finalShowSystemLoading(){return this.autoShowSystemLoading&&this.loadingType===hn.LoadingType.Refresher}},methods:{_startLoading(e=!1){(this.showLoadingMoreWhenReload&&!this.isUserPullDown||!e)&&(this.loadingStatus=hn.More.Loading),this.loading=!0},_endSystemLoadingAndRefresh(){this.finalShowSystemLoading&&uni.hideLoading(),!this.useCustomRefresher&&uni.stopPullDownRefresh()}}},Yn={props:{useChatRecordMode:{type:Boolean,default:pn.gc("useChatRecordMode",!1)},chatRecordMoreOffset:{type:[Number,String],default:pn.gc("chatRecordMoreOffset","0rpx")},autoHideKeyboardWhenChat:{type:Boolean,default:pn.gc("autoHideKeyboardWhenChat",!0)},autoAdjustPositionWhenChat:{type:Boolean,default:pn.gc("autoAdjustPositionWhenChat",!0)},chatAdjustPositionOffset:{type:[Number,String],default:pn.gc("chatAdjustPositionOffset","0rpx")},autoToBottomWhenChat:{type:Boolean,default:pn.gc("autoToBottomWhenChat",!1)},showChatLoadingWhenReload:{type:Boolean,default:pn.gc("showChatLoadingWhenReload",!1)},chatLoadingMoreDefaultAsLoading:{type:Boolean,default:pn.gc("chatLoadingMoreDefaultAsLoading",!0)}},data:()=>({keyboardHeight:0,isKeyboardHeightChanged:!1}),computed:{finalChatRecordMoreOffset(){return pn.convertToPx(this.chatRecordMoreOffset)},finalChatAdjustPositionOffset(){return pn.convertToPx(this.chatAdjustPositionOffset)},chatRecordRotateStyle(){let e;return e=this.useChatRecordMode?{transform:"scaleY(-1)"}:{},this.$emit("update:cellStyle",e),this.$emit("cellStyleChange",e),this.$nextTick((()=>{this.isFirstPage&&this.isChatRecordModeAndNotInversion&&this.$nextTick((()=>{this._scrollToBottom(!1),pn.delay((()=>{this._scrollToBottom(!1),pn.delay((()=>{this._scrollToBottom(!1)}),50)}),50)}))})),e},isChatRecordModeHasTransform(){return this.useChatRecordMode&&this.chatRecordRotateStyle&&this.chatRecordRotateStyle.transform},isChatRecordModeAndNotInversion(){return this.isChatRecordModeHasTransform&&"scaleY(1)"===this.chatRecordRotateStyle.transform},isChatRecordModeAndInversion(){return this.isChatRecordModeHasTransform&&"scaleY(-1)"===this.chatRecordRotateStyle.transform},chatRecordModeSafeAreaBottom(){return this.safeAreaInsetBottom&&!this.keyboardHeight?this.safeAreaBottom:0}},mounted(){this.useChatRecordMode&&uni.onKeyboardHeightChange(this._handleKeyboardHeightChange)},methods:{addChatRecordData(e,t=!0,n=!0){this.useChatRecordMode&&(this.isTotalChangeFromAddData=!0,this.addDataFromTop(e,t,n))},doChatRecordLoadMore(){this.useChatRecordMode&&this._onLoadingMore("click")},_handleKeyboardHeightChange(e){this.$emit("keyboardHeightChange",e),this.autoAdjustPositionWhenChat&&(this.isKeyboardHeightChanged=!0,this.keyboardHeight=e.height>0?e.height+this.finalChatAdjustPositionOffset:e.height),this.autoToBottomWhenChat&&this.keyboardHeight>0&&pn.delay((()=>{this.scrollToBottom(!1),pn.delay((()=>{this.scrollToBottom(!1)}))}))}}},$n={props:{usePageScroll:{type:Boolean,default:pn.gc("usePageScroll",!1)},scrollable:{type:Boolean,default:pn.gc("scrollable",!0)},showScrollbar:{type:Boolean,default:pn.gc("showScrollbar",!0)},scrollX:{type:Boolean,default:pn.gc("scrollX",!1)},scrollToTopBounceEnabled:{type:Boolean,default:pn.gc("scrollToTopBounceEnabled",!1)},scrollToBottomBounceEnabled:{type:Boolean,default:pn.gc("scrollToBottomBounceEnabled",!0)},scrollWithAnimation:{type:Boolean,default:pn.gc("scrollWithAnimation",!1)},scrollIntoView:{type:String,default:pn.gc("scrollIntoView","")}},data:()=>({scrollTop:0,oldScrollTop:0,scrollLeft:0,oldScrollLeft:0,scrollViewStyle:{},scrollViewContainerStyle:{},scrollViewInStyle:{},pageScrollTop:-1,scrollEnable:!0,privateScrollWithAnimation:-1,cacheScrollNodeHeight:-1,superContentHeight:0}),watch:{oldScrollTop(e){!this.usePageScroll&&this._scrollTopChange(e,!1)},pageScrollTop(e){this.usePageScroll&&this._scrollTopChange(e,!0)},usePageScroll:{handler(e){this.loaded&&this.autoHeight&&this._setAutoHeight(!e)},immediate:!0},finalScrollTop(e){this.renderPropScrollTop=e<6?0:10}},computed:{finalScrollWithAnimation(){return-1!==this.privateScrollWithAnimation?1===this.privateScrollWithAnimation:this.scrollWithAnimation},finalScrollViewStyle(){return 1!=this.superContentZIndex&&(this.scrollViewStyle["z-index"]=this.superContentZIndex,this.scrollViewStyle.position="relative"),this.scrollViewStyle},finalScrollTop(){return this.usePageScroll?this.pageScrollTop:this.oldScrollTop},finalIsOldWebView(){return this.isOldWebView&&!this.usePageScroll},finalScrollable(){return this.scrollable&&!this.usePageScroll&&this.scrollEnable&&(!!this.refresherCompleteScrollable||this.refresherStatus!==hn.Refresher.Complete)&&(!!this.refresherRefreshingScrollable||this.refresherStatus!==hn.Refresher.Loading)}},methods:{scrollToTop(e,t=!0){this.useChatRecordMode&&t&&!this.isChatRecordModeAndNotInversion?this.scrollToBottom(e,!1):this.$nextTick((()=>{this._scrollToTop(e,!1)}))},scrollToBottom(e,t=!0){this.useChatRecordMode&&t&&!this.isChatRecordModeAndNotInversion?this.scrollToTop(e,!1):this.$nextTick((()=>{this._scrollToBottom(e)}))},scrollIntoViewById(e,t,n){this._scrollIntoView(e,t,n)},scrollIntoViewByNodeTop(e,t,n){this.scrollTop=this.oldScrollTop,this.$nextTick((()=>{this._scrollIntoViewByNodeTop(e,t,n)}))},scrollToY(e,t,n){this.scrollTop=this.oldScrollTop,this.$nextTick((()=>{this._scrollToY(e,t,n)}))},scrollToX(e,t,n){this.scrollLeft=this.oldScrollLeft,this.$nextTick((()=>{this._scrollToX(e,t,n)}))},scrollIntoViewByIndex(e,t,n){e>=this.realTotalData.length?pn.consoleErr("当前滚动的index超出已渲染列表长度，请先通过refreshToPage加载到对应index页并等待渲染成功后再调用此方法！"):this.$nextTick((()=>{if(this.finalUseVirtualList){const o=this.cellHeightMode===hn.CellHeightMode.Fixed;pn.delay((()=>{if(this.finalUseVirtualList){const a=o?this.virtualCellHeight*e:this.virtualHeightCacheList[e].lastTotalHeight;this.scrollToY(a,t,n)}}),o?0:100)}}))},scrollIntoViewByView(e,t,n){this._scrollIntoView(e,t,n)},updatePageScrollTop(e){this.pageScrollTop=e},updatePageScrollTopHeight(){this._updatePageScrollTopOrBottomHeight("top")},updatePageScrollBottomHeight(){this._updatePageScrollTopOrBottomHeight("bottom")},updateLeftAndRightWidth(){this.finalIsOldWebView&&this.$nextTick((()=>this._updateLeftAndRightWidth(this.scrollViewContainerStyle,"zp-page")))},updateScrollViewScrollTop(e,t=!0){this._updatePrivateScrollWithAnimation(t),this.scrollTop=this.oldScrollTop,this.$nextTick((()=>{this.scrollTop=e,this.oldScrollTop=this.scrollTop}))},_onScrollToUpper(){this.$emit("scrolltoupper"),this.$emit("scrollTopChange",0),this.$nextTick((()=>{this.oldScrollTop=0}))},_onScrollToLower(e){(!e.detail||!e.detail.direction||"bottom"===e.detail.direction)&&this.toBottomLoadingMoreEnabled&&this._onLoadingMore(this.useChatRecordMode?"click":"toBottom")},_scrollToTop(e=!0,t=!0){this.usePageScroll?this.$nextTick((()=>{uni.pageScrollTo({scrollTop:0,duration:e?100:0})})):(this._updatePrivateScrollWithAnimation(e),this.scrollTop=this.oldScrollTop,this.$nextTick((()=>{this.scrollTop=0,this.oldScrollTop=this.scrollTop})))},_scrollToBottom(e=!0){return __async(this,null,(function*(){if(this.usePageScroll)this.$nextTick((()=>{uni.pageScrollTo({scrollTop:Number.MAX_VALUE,duration:e?100:0})}));else try{this._updatePrivateScrollWithAnimation(e);const t=yield this._getNodeClientRect(".zp-paging-container"),n=yield this._getNodeClientRect(".zp-scroll-view"),o=t?t[0].height:0,a=n?n[0].height:0;o>a&&(this.scrollTop=this.oldScrollTop,this.$nextTick((()=>{this.scrollTop=o-a+this.virtualPlaceholderTopHeight,this.oldScrollTop=this.scrollTop})))}catch(vs){}}))},_scrollIntoView(e,t=0,n=!1,o){try{this.scrollTop=this.oldScrollTop,this.$nextTick((()=>{this._getNodeClientRect("#"+e.replace("#",""),this.$parent).then((e=>{if(e){let a=e[0].top;this._scrollIntoViewByNodeTop(a,t,n),o&&o()}}))}))}catch(vs){}},_scrollIntoViewByNodeTop(e,t=0,n=!1){this.isChatRecordModeAndInversion?this._getNodeClientRect(".zp-scroll-view").then((o=>{o&&this._scrollToY(o[0].height-e,t,n,!0)})):this._scrollToY(e,t,n,!0)},_scrollToY(e,t=0,n=!1,o=!1){this._updatePrivateScrollWithAnimation(n),pn.delay((()=>{if(this.usePageScroll){o&&-1!==this.pageScrollTop&&(e+=this.pageScrollTop);const a=e-t;uni.pageScrollTo({scrollTop:a,duration:n?100:0})}else o&&(e+=this.oldScrollTop),this.scrollTop=e-t}),10)},_scrollToX(e,t=0,n=!1){this._updatePrivateScrollWithAnimation(n),pn.delay((()=>{this.usePageScroll?pn.consoleErr("使用页面滚动时不支持scrollToX"):this.scrollLeft=e-t}),10)},_scroll(e){this.$emit("scroll",e);const{scrollTop:t,scrollLeft:n}=e.detail;this.finalUseVirtualList&&this._updateVirtualScroll(t,this.oldScrollTop-t),this.oldScrollTop=t,this.oldScrollLeft=n;const o=e.detail.scrollHeight-this.oldScrollTop;!this.isIos&&this._checkScrolledToBottom(o)},_updatePrivateScrollWithAnimation(e){this.privateScrollWithAnimation=e?1:0,pn.delay((()=>this.$nextTick((()=>{this.privateScrollWithAnimation=-1}))),100,"updateScrollWithAnimationDelay")},_doCheckScrollViewShouldFullHeight(e){this.autoFullHeight&&this.usePageScroll&&this.isTotalChangeFromAddData?this.$nextTick((()=>{this._checkScrollViewShouldFullHeight(((t,n)=>{this._preCheckShowNoMoreInside(e,t,n)}))})):this._preCheckShowNoMoreInside(e)},_checkScrollViewShouldFullHeight(e){return __async(this,null,(function*(){try{const t=yield this._getNodeClientRect(".zp-scroll-view"),n=yield this._getNodeClientRect(".zp-paging-container-content");if(!t||!n)return;const o=n[0].height,a=t[0].top;this.isAddedData&&o+a<=this.windowHeight?(this._setAutoHeight(!0,t),e(t,n)):(this._setAutoHeight(!1),e(null,null))}catch(vs){e(null,null)}}))},_updateCachedSuperContentHeight(){return __async(this,null,(function*(){const e=yield this._getNodeClientRect(".z-paging-content");e&&(this.superContentHeight=e[0].height)}))},_scrollTopChange(e,t){this.$emit("scrollTopChange",e),this.$emit("update:scrollTop",e),this._checkShouldShowBackToTop(e);const n=e>5?6:0;t&&this.wxsPageScrollTop!==n?this.wxsPageScrollTop=n:t||this.wxsScrollTop===n||(this.wxsScrollTop=n,n>6&&(this.scrollEnable=!0))},_updatePageScrollTopOrBottomHeight(e){if(!this.usePageScroll)return;this._doCheckScrollViewShouldFullHeight(this.realTotalData);const t=`.zp-page-${e}`,n=`margin${e.slice(0,1).toUpperCase()+e.slice(1)}`;let o=this.safeAreaInsetBottom;this.$nextTick((()=>{pn.delay((()=>{this._getNodeClientRect(t).then((t=>{if(t){let a=t[0].height;"bottom"===e?o&&(a+=this.safeAreaBottom):this.cacheTopHeight=a,this.$set(this.scrollViewStyle,n,`${a}px`)}else o&&this.$set(this.scrollViewStyle,n,`${this.safeAreaBottom}px`)}))}),0)}))}}},Wn={props:{autoShowBackToTop:{type:Boolean,default:pn.gc("autoShowBackToTop",!1)},backToTopThreshold:{type:[Number,String],default:pn.gc("backToTopThreshold","400rpx")},backToTopImg:{type:String,default:pn.gc("backToTopImg","")},backToTopWithAnimate:{type:Boolean,default:pn.gc("backToTopWithAnimate",!0)},backToTopBottom:{type:[Number,String],default:pn.gc("backToTopBottom","160rpx")},backToTopStyle:{type:Object,default:pn.gc("backToTopStyle",{})},enableBackToTop:{type:Boolean,default:pn.gc("enableBackToTop",!0)}},data:()=>({backToTopClass:"zp-back-to-top zp-back-to-top-hide",lastBackToTopShowTime:0,showBackToTopClass:!1}),computed:{backToTopThresholdUnitConverted(){return pn.addUnit(this.backToTopThreshold,this.unit)},backToTopBottomUnitConverted(){return pn.addUnit(this.backToTopBottom,this.unit)},finalEnableBackToTop(){return!this.usePageScroll&&this.enableBackToTop},finalBackToTopThreshold(){return pn.convertToPx(this.backToTopThresholdUnitConverted)},finalBackToTopStyle(){const e=this.backToTopStyle;return e.bottom||(e.bottom=this.windowBottom+pn.convertToPx(this.backToTopBottomUnitConverted)+"px"),e.position||(e.position=this.usePageScroll?"fixed":"absolute"),e},finalBackToTopClass(){return`${this.backToTopClass} zp-back-to-top-${this.unit}`}},methods:{_backToTopClick(){let e=!1;this.$emit("backToTopClick",(t=>{(void 0===t||!0===t)&&this._handleToTop(),e=!0})),this.$nextTick((()=>{!e&&this._handleToTop()}))},_handleToTop(){!this.backToTopWithAnimate&&this._checkShouldShowBackToTop(0),this.useChatRecordMode?this.scrollToBottom(this.backToTopWithAnimate):this.scrollToTop(this.backToTopWithAnimate)},_checkShouldShowBackToTop(e){this.autoShowBackToTop?e>this.finalBackToTopThreshold?this.showBackToTopClass||(this.showBackToTopClass=!0,this.lastBackToTopShowTime=(new Date).getTime(),pn.delay((()=>{this.backToTopClass="zp-back-to-top zp-back-to-top-show"}),300)):this.showBackToTopClass&&(this.backToTopClass="zp-back-to-top zp-back-to-top-hide",pn.delay((()=>{this.showBackToTopClass=!1}),(new Date).getTime()-this.lastBackToTopShowTime<500?0:300)):this.showBackToTopClass=!1}}},Zn={props:{useVirtualList:{type:Boolean,default:pn.gc("useVirtualList",!1)},useCompatibilityMode:{type:Boolean,default:pn.gc("useCompatibilityMode",!1)},extraData:{type:Object,default:pn.gc("extraData",{})},useInnerList:{type:Boolean,default:pn.gc("useInnerList",!1)},forceCloseInnerList:{type:Boolean,default:pn.gc("forceCloseInnerList",!1)},cellKeyName:{type:String,default:pn.gc("cellKeyName","")},innerListStyle:{type:Object,default:pn.gc("innerListStyle",{})},innerCellStyle:{type:Object,default:pn.gc("innerCellStyle",{})},preloadPage:{type:[Number,String],default:pn.gc("preloadPage",12),validator:e=>(e<=0&&pn.consoleErr("preload-page必须大于0！"),e>0)},cellHeightMode:{type:String,default:pn.gc("cellHeightMode",hn.CellHeightMode.Fixed)},fixedCellHeight:{type:[Number,String],default:pn.gc("fixedCellHeight",0)},virtualListCol:{type:[Number,String],default:pn.gc("virtualListCol",1)},virtualScrollFps:{type:[Number,String],default:pn.gc("virtualScrollFps",80)},virtualCellIdPrefix:{type:String,default:pn.gc("virtualCellIdPrefix","")}},data:()=>({virtualListKey:pn.getInstanceId(),virtualPageHeight:0,virtualCellHeight:0,virtualScrollTimeStamp:0,virtualList:[],virtualPlaceholderTopHeight:0,virtualPlaceholderBottomHeight:0,virtualTopRangeIndex:0,virtualBottomRangeIndex:0,lastVirtualTopRangeIndex:0,lastVirtualBottomRangeIndex:0,virtualItemInsertedCount:0,virtualHeightCacheList:[],getCellHeightRetryCount:{fixed:0,dynamic:0},pagingOrgTop:-1,updateVirtualListFromDataChange:!1}),watch:{realTotalData(){this.updateVirtualListRender()},virtualList(e){this.$emit("update:virtualList",e),this.$emit("virtualListChange",e)},virtualPlaceholderTopHeight(e){this.$emit("virtualTopHeightChange",e)}},computed:{virtualCellIndexKey:()=>en,finalUseVirtualList(){return this.useVirtualList&&this.usePageScroll&&pn.consoleErr("使用页面滚动时，开启虚拟列表无效！"),this.useVirtualList&&!this.usePageScroll},finalUseInnerList(){return this.useInnerList||this.finalUseVirtualList&&!this.forceCloseInnerList},finalCellKeyName(){return this.cellKeyName},finalVirtualPageHeight(){return this.virtualPageHeight>0?this.virtualPageHeight:this.windowHeight},finalFixedCellHeight(){return pn.convertToPx(this.fixedCellHeight)},fianlVirtualCellIdPrefix(){return(this.virtualCellIdPrefix?this.virtualCellIdPrefix+"-":"")+"zp-id"},finalPlaceholderTopHeightStyle:()=>({}),virtualRangePageHeight(){return this.finalVirtualPageHeight*this.preloadPage},virtualScrollDisTimeStamp(){return 1e3/this.virtualScrollFps}},methods:{doInsertVirtualListItem(e,t){if(this.cellHeightMode!==hn.CellHeightMode.Dynamic)return;this.realTotalData.splice(t,0,e),this.realTotalData=[...this.realTotalData],this.virtualItemInsertedCount++,e&&"[object Object]"===Object.prototype.toString.call(e)||(e={item:e});const n=this.virtualCellIndexKey;e[n]=`custom-${this.virtualItemInsertedCount}`,e[tn]=`${this.virtualListKey}-${e[n]}`,this.$nextTick((()=>__async(this,null,(function*(){let o=0;for(;o<=10;){yield pn.wait(Zt);const a=yield this._getVirtualCellNodeByIndex(e[n]);if(!a){o++;continue}const i=a?a[0].height:0,r=this.virtualHeightCacheList[t-1],s=r?r.totalHeight:0;this.virtualHeightCacheList.splice(t,0,{height:i,lastTotalHeight:s,totalHeight:s+i});for(let e=t+1;e<this.virtualHeightCacheList.length;e++){const t=this.virtualHeightCacheList[e];t.lastTotalHeight+=i,t.totalHeight+=i}this._updateVirtualScroll(this.oldScrollTop);break}}))))},didUpdateVirtualListCell(e){if(this.cellHeightMode!==hn.CellHeightMode.Dynamic)return;const t=this.virtualHeightCacheList[e];this.$nextTick((()=>{this._getVirtualCellNodeByIndex(e).then((n=>{const o=n?n[0].height:0,a=o-t.height;t.height=o,t.totalHeight=t.lastTotalHeight+o;for(let t=e+1;t<this.virtualHeightCacheList.length;t++){const e=this.virtualHeightCacheList[t];e.totalHeight+=a,e.lastTotalHeight+=a}}))}))},didDeleteVirtualListCell(e){if(this.cellHeightMode!==hn.CellHeightMode.Dynamic)return;const t=this.virtualHeightCacheList[e];for(let n=e+1;n<this.virtualHeightCacheList.length;n++){const e=this.virtualHeightCacheList[n];e.totalHeight-=t.height,e.lastTotalHeight-=t.height}this.virtualHeightCacheList.splice(e,1)},updateVirtualListRender(){this.finalUseVirtualList&&(this.updateVirtualListFromDataChange=!0,this.$nextTick((()=>{this.getCellHeightRetryCount.fixed=0,this.realTotalData.length?this.cellHeightMode===hn.CellHeightMode.Fixed&&this.isFirstPage&&this._updateFixedCellHeight():this._resetDynamicListState(!this.isUserPullDown),this._updateVirtualScroll(this.oldScrollTop)})))},_virtualListInit(){this.$nextTick((()=>{pn.delay((()=>{this._getNodeClientRect(".zp-scroll-view").then((e=>{e&&(this.pagingOrgTop=e[0].top,this.virtualPageHeight=e[0].height)}))}))}))},_updateFixedCellHeight(){this.finalFixedCellHeight?this.virtualCellHeight=this.finalFixedCellHeight:this.$nextTick((()=>{pn.delay((()=>{this._getVirtualCellNodeByIndex(0).then((e=>{if(e)this.virtualCellHeight=e[0].height,this._updateVirtualScroll(this.oldScrollTop);else{if(this.getCellHeightRetryCount.fixed>10)return;this.getCellHeightRetryCount.fixed++,this._updateFixedCellHeight()}}))}),Zt,"updateFixedCellHeightDelay")}))},_updateDynamicCellHeight(e,t="bottom"){const n="top"===t,o=this.virtualHeightCacheList,a=n?[]:o;let i=0;this.$nextTick((()=>{pn.delay((()=>__async(this,null,(function*(){for(let r=0;r<e.length;r++){const s=yield this._getVirtualCellNodeByIndex(e[r][this.virtualCellIndexKey]),l=s?s[0].height:0;if(!s)return void(this.getCellHeightRetryCount.dynamic<=10&&(o.splice(o.length-r,r),this.getCellHeightRetryCount.dynamic++,this._updateDynamicCellHeight(e,t)));const c=a.length?a.slice(-1)[0]:null,u=c?c.totalHeight:0;a.push({height:l,lastTotalHeight:u,totalHeight:u+l}),n&&(i+=l)}if(n&&e.length){for(let e=0;e<o.length;e++){const t=o[e];t.lastTotalHeight+=i,t.totalHeight+=i}this.virtualHeightCacheList=a.concat(o)}this._updateVirtualScroll(this.oldScrollTop)}))),Zt,"updateDynamicCellHeightDelay")}))},_setCellIndex(e,t="bottom"){let n=0;const o=this.virtualCellIndexKey;if("bottom"===t&&[hn.QueryFrom.Refresh,hn.QueryFrom.Reload].indexOf(this.queryFrom)>=0&&this._resetDynamicListState(),this.totalData.length&&this.queryFrom!==hn.QueryFrom.Refresh){if("bottom"===t){n=this.realTotalData.length;const e=this.realTotalData.length?this.realTotalData.slice(-1)[0]:null;e&&void 0!==e[o]&&(n=e[o]+1)}else if("top"===t){const t=this.realTotalData.length?this.realTotalData[0]:null;t&&void 0!==t[o]&&(n=t[o]-e.length)}}else this._resetDynamicListState();for(let a=0;a<e.length;a++){let t=e[a];t&&"[object Object]"===Object.prototype.toString.call(t)||(t={item:t}),t[tn]&&(t=pn.deepCopy(t)),t[o]=n+a,t[tn]=`${this.virtualListKey}-${t[o]}`,e[a]=t}this.getCellHeightRetryCount.dynamic=0,this.cellHeightMode===hn.CellHeightMode.Dynamic&&this._updateDynamicCellHeight(e,t)},_updateVirtualScroll(e,t=0){const n=pn.getTime();if(0===e&&this._resetTopRange(),0!==e&&this.virtualScrollTimeStamp&&n-this.virtualScrollTimeStamp<=this.virtualScrollDisTimeStamp)return;this.virtualScrollTimeStamp=n;let o=0;const a=this.cellHeightMode;if(a===hn.CellHeightMode.Fixed)o=parseInt(e/this.virtualCellHeight)||0,this._updateFixedTopRangeIndex(o),this._updateFixedBottomRangeIndex(o);else if(a===hn.CellHeightMode.Dynamic){const n=t>0?"top":"bottom",o=this.virtualRangePageHeight,a=e-o,i=e+this.finalVirtualPageHeight+o;let r=0,s=0,l=!1;const c=this.virtualHeightCacheList,u=c?c.slice(-1)[0]:null;let d=this.virtualTopRangeIndex;if("bottom"===n)for(let e=d;e<c.length;e++){const t=c[e];if(t&&t.totalHeight>a){this.virtualTopRangeIndex=e,this.virtualPlaceholderTopHeight=t.lastTotalHeight;break}}else{let e=!1;for(let t=d;t>=0;t--){const n=c[t];if(n&&n.totalHeight<a){this.virtualTopRangeIndex=t,this.virtualPlaceholderTopHeight=n.lastTotalHeight,e=!0;break}}!e&&this._resetTopRange()}for(let e=this.virtualTopRangeIndex;e<c.length;e++){const t=c[e];if(t&&t.totalHeight>i){r=e,s=u.totalHeight-t.totalHeight,l=!0;break}}l&&0!==this.virtualBottomRangeIndex?(this.virtualBottomRangeIndex=r,this.virtualPlaceholderBottomHeight=s):(this.virtualBottomRangeIndex=this.realTotalData.length?this.realTotalData.length-1:this.pageSize,this.virtualPlaceholderBottomHeight=0),this._updateVirtualList()}},_updateFixedTopRangeIndex(e){let t=0===this.virtualCellHeight?0:e-(parseInt(this.finalVirtualPageHeight/this.virtualCellHeight)||1)*this.preloadPage;t*=this.virtualListCol,t=Math.max(0,t),this.virtualTopRangeIndex=t,this.virtualPlaceholderTopHeight=t/this.virtualListCol*this.virtualCellHeight},_updateFixedBottomRangeIndex(e){let t=0===this.virtualCellHeight?this.pageSize:e+(parseInt(this.finalVirtualPageHeight/this.virtualCellHeight)||1)*(this.preloadPage+1);t*=this.virtualListCol,t=Math.min(this.realTotalData.length,t),this.virtualBottomRangeIndex=t,this.virtualPlaceholderBottomHeight=(this.realTotalData.length-t)*this.virtualCellHeight/this.virtualListCol,this._updateVirtualList()},_updateVirtualList(){(this.updateVirtualListFromDataChange||this.lastVirtualTopRangeIndex!==this.virtualTopRangeIndex||this.lastVirtualBottomRangeIndex!==this.virtualBottomRangeIndex)&&(this.updateVirtualListFromDataChange=!1,this.lastVirtualTopRangeIndex=this.virtualTopRangeIndex,this.lastVirtualBottomRangeIndex=this.virtualBottomRangeIndex,this.virtualList=this.realTotalData.slice(this.virtualTopRangeIndex,this.virtualBottomRangeIndex+1))},_resetDynamicListState(e=!1){this.virtualHeightCacheList=[],e&&(this.virtualList=[]),this.virtualTopRangeIndex=0,this.virtualPlaceholderTopHeight=0},_resetTopRange(){this.virtualTopRangeIndex=0,this.virtualPlaceholderTopHeight=0,this._updateVirtualList()},_checkVirtualListScroll(){this.finalUseVirtualList&&this.$nextTick((()=>{this._getNodeClientRect(".zp-paging-touch-view").then((e=>{const t=e?e[0].top:0;(!e||t===this.pagingOrgTop&&0!==this.virtualPlaceholderTopHeight)&&this._updateVirtualScroll(0)}))}))},_getVirtualCellNodeByIndex(e){return this._getNodeClientRect(`#${this.fianlVirtualCellIdPrefix}-${e}`,this.finalUseInnerList,!1,!1)},_innerCellClick(e,t){this.$emit("innerCellClick",e,t)}}},Jn=uni.getSystemInfoSync(),Xn={name:"z-paging",components:{zPagingRefresh:fn,zPagingLoadMore:gn,zPagingEmptyView:$t},mixins:[mn,Mn,Fn,zn,Hn,jn,qn,Kn,Yn,$n,Wn,Zn],data:()=>({base64BackToTop:Yt,loadingType:hn.LoadingType.Refresher,requestTimeStamp:0,wxsPropType:"",renderPropScrollTop:-1,checkScrolledToBottomTimeOut:null,cacheTopHeight:-1,statusBarHeight:Jn.statusBarHeight,insideOfPaging:-1,isLoadFailed:!1,isIos:"ios"===Jn.platform,disabledBounce:!1,fromCompleteEmit:!1,disabledCompleteEmit:!1,pageLaunched:!1,active:!1,wxsIsScrollTopInTopRange:!0,wxsScrollTop:0,wxsPageScrollTop:0,wxsOnPullingDown:!1}),props:{delay:{type:[Number,String],default:pn.gc("delay",0)},minDelay:{type:[Number,String],default:pn.gc("minDelay",0)},pagingStyle:{type:Object,default:pn.gc("pagingStyle",{})},height:{type:String,default:pn.gc("height","")},width:{type:String,default:pn.gc("width","")},maxWidth:{type:String,default:pn.gc("maxWidth","")},bgColor:{type:String,default:pn.gc("bgColor","")},pagingContentStyle:{type:Object,default:pn.gc("pagingContentStyle",{})},autoHeight:{type:Boolean,default:pn.gc("autoHeight",!1)},autoHeightAddition:{type:[Number,String],default:pn.gc("autoHeightAddition","0px")},defaultThemeStyle:{type:String,default:pn.gc("defaultThemeStyle","black")},fixed:{type:Boolean,default:pn.gc("fixed",!0)},safeAreaInsetBottom:{type:Boolean,default:pn.gc("safeAreaInsetBottom",!1)},useSafeAreaPlaceholder:{type:Boolean,default:pn.gc("useSafeAreaPlaceholder",!1)},bottomBgColor:{type:String,default:pn.gc("bottomBgColor","")},topZIndex:{type:Number,default:pn.gc("topZIndex",99)},superContentZIndex:{type:Number,default:pn.gc("superContentZIndex",1)},contentZIndex:{type:Number,default:pn.gc("contentZIndex",1)},f2ZIndex:{type:Number,default:pn.gc("f2ZIndex",100)},autoFullHeight:{type:Boolean,default:pn.gc("autoFullHeight",!0)},watchTouchDirectionChange:{type:Boolean,default:pn.gc("watchTouchDirectionChange",!1)},unit:{type:String,default:pn.gc("unit","rpx")}},created(){this.createdReload&&!this.refresherOnly&&this.auto&&(this._startLoading(),this.$nextTick(this._preReload))},mounted(){this.active=!0,this.wxsPropType=pn.getTime().toString(),this.renderJsIgnore,this.createdReload||this.refresherOnly||!this.auto||pn.delay((()=>this.$nextTick(this._preReload)),0),this.finalUseCache&&this._setListByLocalCache(),this.$nextTick((()=>{this.systemInfo=uni.getSystemInfoSync(),!this.usePageScroll&&this.autoHeight&&this._setAutoHeight(),this.loaded=!0,pn.delay((()=>{this.updateFixedLayout(),this._updateCachedSuperContentHeight()}))})),this.updatePageScrollTopHeight(),this.updatePageScrollBottomHeight(),this.updateLeftAndRightWidth(),this.finalRefresherEnabled&&this.useCustomRefresher&&this.$nextTick((()=>{this.isTouchmoving=!0})),this._onEmit(),this.finalUseVirtualList&&this._virtualListInit()},destroyed(){this._handleUnmounted()},unmounted(){this._handleUnmounted()},watch:{defaultThemeStyle:{handler(e){e.length&&(this.finalRefresherDefaultStyle=e)},immediate:!0},autoHeight(e){this.loaded&&!this.usePageScroll&&this._setAutoHeight(e)},autoHeightAddition(e){this.loaded&&!this.usePageScroll&&this.autoHeight&&this._setAutoHeight(e)}},computed:{finalPagingStyle(){const e=__spreadValues({},this.pagingStyle);if(!this.systemInfo)return e;const{windowTop:t,windowBottom:n}=this;return!this.usePageScroll&&this.fixed&&(t&&!e.top&&(e.top=t+"px"),n&&!e.bottom&&(e.bottom=n+"px")),this.bgColor.length&&!e.background&&(e.background=this.bgColor),this.height.length&&!e.height&&(e.height=this.height),this.width.length&&!e.width&&(e.width=this.width),this.maxWidth.length&&!e["max-width"]&&(e["max-width"]=this.maxWidth,e.margin="0 auto"),e},finalPagingContentStyle(){return 1!=this.contentZIndex&&(this.pagingContentStyle["z-index"]=this.contentZIndex,this.pagingContentStyle.position="relative"),this.pagingContentStyle},renderJsIgnore(){return(this.usePageScroll&&this.useChatRecordMode||!this.refresherEnabled&&this.scrollable||!this.useCustomRefresher)&&this.$nextTick((()=>{this.renderPropScrollTop=10})),0},windowHeight(){return this.systemInfo&&this.systemInfo.windowHeight||0},windowBottom(){if(!this.systemInfo)return 0;let e=this.systemInfo.windowBottom||0;return!this.safeAreaInsetBottom||this.useSafeAreaPlaceholder||this.useChatRecordMode||(e+=this.safeAreaBottom),e},isIosAndH5:()=>!1},methods:{getVersion:()=>`z-paging v${Wt}`,setSpecialEffects(e){this.setListSpecialEffects(e)},setListSpecialEffects(e){this.nFixFreezing=e&&Object.keys(e).length,this.isIos&&(this.privateRefresherEnabled=0),!this.usePageScroll&&this.$refs["zp-n-list"].setSpecialEffects(e)},_handlePageLaunch(){this.pageLaunched&&(this.refresherThresholdUpdateTag=1,this.$nextTick((()=>{this.refresherThresholdUpdateTag=0})),this._checkVirtualListScroll()),this.pageLaunched=!0},_doVibrateShort(){if(this.isIos){const e=new(plus.ios.importClass("UISelectionFeedbackGenerator"));e.init(),setTimeout((()=>{e.selectionChanged()}),0)}else plus.device.vibrate(15)},_setAutoHeight(e=!0,t=null){return __async(this,null,(function*(){const n="min-height";try{if(e){let e=t||(yield this._getNodeClientRect(".zp-scroll-view")),o=yield this._getNodeClientRect(".zp-page-bottom");if(e){const t=e[0].top;let a=this.windowHeight-t;a-=o?o[0].height:0;const i=pn.convertToPx(this.autoHeightAddition);let r=" !important";const s=a+i-(this.insideMore?1:0)+"px"+r;this.$set(this.scrollViewStyle,n,s),this.$set(this.scrollViewInStyle,n,s)}}else this.$delete(this.scrollViewStyle,n),this.$delete(this.scrollViewInStyle,n)}catch(vs){}}))},_handleUnmounted(){this.active=!1,this._offEmit(),this.useChatRecordMode&&uni.offKeyboardHeightChange(this._handleKeyboardHeightChange)},_updateInsideOfPaging(){this.insideMore&&!0===this.insideOfPaging&&setTimeout(this.doLoadMore,200)},_cleanTimeout:e=>(e&&(clearTimeout(e),e=null),e),_onEmit(){uni.$on(Jt,(e=>{this.loading&&(e&&(this.customerEmptyViewErrorText=e),this.complete(!1).catch((()=>{})))})),uni.$on(Xt,(e=>{setTimeout((()=>{if(this.loading)if(this.disabledCompleteEmit)this.disabledCompleteEmit=!1;else{const t=e.type||"normal",n=e.list||e,o=e.rule;switch(this.fromCompleteEmit=!0,t){case"normal":this.complete(n);break;case"total":this.completeByTotal(n,o);break;case"nomore":this.completeByNoMore(n,o);break;case"key":this.completeByKey(n,o)}}}),1)}))},_offEmit(){uni.$off(Jt),uni.$off(Xt)}}},Qn=e=>{(e.$wxs||(e.$wxs=[])).push("pagingWxs"),(e.$wxsModules||(e.$wxsModules={})).pagingWxs="528b4b3e"},eo=e=>{(e.$renderjs||(e.$renderjs=[])).push("pagingRenderjs"),(e.$renderjsModules||(e.$renderjsModules={})).pagingRenderjs="61ca1c76"};Qn(Xn),eo(Xn);const to=ee(Xn,[["render",function(t,n,o,a,i,r){const s=e.resolveComponent("z-paging-refresh"),l=e.resolveComponent("z-paging-load-more"),c=ae(e.resolveDynamicComponent("z-paging-empty-view"),$t);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass({"z-paging-content":!0,"z-paging-content-full":!t.usePageScroll,"z-paging-content-fixed":!t.usePageScroll&&t.fixed,"z-paging-content-page":t.usePageScroll,"z-paging-reached-top":t.renderPropScrollTop<1,"z-paging-use-chat-record-mode":t.useChatRecordMode}),style:e.normalizeStyle([t.finalPagingStyle])},[t.showF2&&t.showRefresherF2?(e.openBlock(),e.createElementBlock("view",{key:0,onTouchmove:n[0]||(n[0]=e.withModifiers((()=>{}),["stop","prevent"])),class:"zp-f2-content",style:e.normalizeStyle([{transform:t.f2Transform,transition:"transform .2s linear",height:t.superContentHeight+"px","z-index":t.f2ZIndex}])},[e.renderSlot(t.$slots,"f2",{},void 0,!0)],36)):e.createCommentVNode("",!0),!t.usePageScroll&&t.zSlots.top?e.renderSlot(t.$slots,"top",{key:1},void 0,!0):t.usePageScroll&&t.zSlots.top?(e.openBlock(),e.createElementBlock("view",{key:2,class:"zp-page-top",onTouchmove:n[1]||(n[1]=e.withModifiers((()=>{}),["stop","prevent"])),style:e.normalizeStyle([{top:`${t.windowTop}px`,"z-index":t.topZIndex}])},[e.renderSlot(t.$slots,"top",{},void 0,!0)],36)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass({"zp-view-super":!0,"zp-scroll-view-super":!t.usePageScroll}),style:e.normalizeStyle([t.finalScrollViewStyle])},[t.zSlots.left?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass({"zp-page-left":!0,"zp-absoulte":t.finalIsOldWebView})},[e.renderSlot(t.$slots,"left",{},void 0,!0)],2)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass({"zp-scroll-view-container":!0,"zp-absoulte":t.finalIsOldWebView}),style:e.normalizeStyle([t.scrollViewContainerStyle])},[e.createElementVNode("scroll-view",{ref:"zp-scroll-view",class:e.normalizeClass({"zp-scroll-view":!0,"zp-scroll-view-absolute":!t.usePageScroll,"zp-scroll-view-hide-scrollbar":!t.showScrollbar}),style:e.normalizeStyle([t.chatRecordRotateStyle]),"scroll-top":t.scrollTop,"scroll-left":t.scrollLeft,"scroll-x":t.scrollX,"scroll-y":t.finalScrollable,"enable-back-to-top":t.finalEnableBackToTop,"show-scrollbar":t.showScrollbar,"scroll-with-animation":t.finalScrollWithAnimation,"scroll-into-view":t.scrollIntoView,"lower-threshold":t.finalLowerThreshold,"upper-threshold":5,"refresher-enabled":t.finalRefresherEnabled&&!t.useCustomRefresher,"refresher-threshold":t.finalRefresherThreshold,"refresher-default-style":t.finalRefresherDefaultStyle,"refresher-background":t.refresherBackground,"refresher-triggered":t.finalRefresherTriggered,onScroll:n[12]||(n[12]=(...e)=>t._scroll&&t._scroll(...e)),onScrolltolower:n[13]||(n[13]=(...e)=>t._onScrollToLower&&t._onScrollToLower(...e)),onScrolltoupper:n[14]||(n[14]=(...e)=>t._onScrollToUpper&&t._onScrollToUpper(...e)),onRefresherrestore:n[15]||(n[15]=(...e)=>t._onRestore&&t._onRestore(...e)),onRefresherrefresh:n[16]||(n[16]=e=>t._onRefresh(!0))},[e.createElementVNode("view",{class:"zp-paging-touch-view",onTouchstart:n[4]||(n[4]=(...e)=>t.pagingWxs.touchstart&&t.pagingWxs.touchstart(...e)),onTouchmove:n[5]||(n[5]=(...e)=>t.pagingWxs.touchmove&&t.pagingWxs.touchmove(...e)),onTouchend:n[6]||(n[6]=(...e)=>t.pagingWxs.touchend&&t.pagingWxs.touchend(...e)),onTouchcancel:n[7]||(n[7]=(...e)=>t.pagingWxs.touchend&&t.pagingWxs.touchend(...e)),onMousedown:n[8]||(n[8]=(...e)=>t.pagingWxs.mousedown&&t.pagingWxs.mousedown(...e)),onMousemove:n[9]||(n[9]=(...e)=>t.pagingWxs.mousemove&&t.pagingWxs.mousemove(...e)),onMouseup:n[10]||(n[10]=(...e)=>t.pagingWxs.mouseup&&t.pagingWxs.mouseup(...e)),onMouseleave:n[11]||(n[11]=(...e)=>t.pagingWxs.mouseleave&&t.pagingWxs.mouseleave(...e))},[t.finalRefresherFixedBacHeight>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"zp-fixed-bac-view",style:e.normalizeStyle([{background:t.refresherFixedBackground,height:`${t.finalRefresherFixedBacHeight}px`}])},null,4)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"zp-paging-main",style:e.normalizeStyle([t.scrollViewInStyle,{transform:t.finalRefresherTransform,transition:t.refresherTransition}]),"change:prop":t.pagingWxs.propObserver,prop:e.wp(t.wxsPropType),"data-refresherThreshold":t.finalRefresherThreshold,"data-refresherF2Enabled":t.refresherF2Enabled,"data-refresherF2Threshold":t.finalRefresherF2Threshold,"data-isIos":t.isIos,"data-loading":t.loading||t.isRefresherInComplete,"data-useChatRecordMode":t.useChatRecordMode,"data-refresherEnabled":t.refresherEnabled,"data-useCustomRefresher":t.useCustomRefresher,"data-pageScrollTop":t.wxsPageScrollTop,"data-scrollTop":t.wxsScrollTop,"data-refresherMaxAngle":t.refresherMaxAngle,"data-refresherNoTransform":t.refresherNoTransform,"data-refresherAecc":t.refresherAngleEnableChangeContinued,"data-usePageScroll":t.usePageScroll,"data-watchTouchDirectionChange":t.watchTouchDirectionChange,"data-oldIsTouchmoving":t.isTouchmoving,"data-refresherOutRate":t.finalRefresherOutRate,"data-refresherPullRate":t.finalRefresherPullRate,"data-hasTouchmove":t.hasTouchmove,"change:renderPropIsIosAndH5":t.pagingRenderjs.renderPropIsIosAndH5Change,renderPropIsIosAndH5:e.wp(t.isIosAndH5)},[t.showRefresher?(e.openBlock(),e.createElementBlock("view",{key:0,class:"zp-custom-refresher-view",style:e.normalizeStyle([{"margin-top":`-${t.finalRefresherThreshold+t.refresherThresholdUpdateTag}px`,background:t.refresherBackground,opacity:t.isTouchmoving?1:0}])},[e.createElementVNode("view",{class:"zp-custom-refresher-container",style:e.normalizeStyle([{height:`${t.finalRefresherThreshold}px`,background:t.refresherBackground}])},[t.useRefresherStatusBarPlaceholder?(e.openBlock(),e.createElementBlock("view",{key:0,class:"zp-custom-refresher-status-bar-placeholder",style:e.normalizeStyle([{height:`${t.statusBarHeight}px`}])},null,4)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"zp-custom-refresher-slot-view"},[t.zSlots.refresherComplete&&t.refresherStatus===t.R.Complete||t.zSlots.refresherF2&&t.refresherStatus===t.R.GoF2?e.createCommentVNode("",!0):e.renderSlot(t.$slots,"refresher",{key:0,refresherStatus:t.refresherStatus},void 0,!0)]),t.zSlots.refresherComplete&&t.refresherStatus===t.R.Complete?e.renderSlot(t.$slots,"refresherComplete",{key:1},void 0,!0):t.zSlots.refresherF2&&t.refresherStatus===t.R.GoF2?e.renderSlot(t.$slots,"refresherF2",{key:2},void 0,!0):t.showCustomRefresher?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(s,{key:3,ref:"refresh",class:"zp-custom-refresher-refresh",style:e.normalizeStyle([{height:t.finalRefresherThreshold-t.finalRefresherThresholdPlaceholder+"px"}]),status:t.refresherStatus,defaultThemeStyle:t.finalRefresherThemeStyle,defaultText:t.finalRefresherDefaultText,pullingText:t.finalRefresherPullingText,refreshingText:t.finalRefresherRefreshingText,completeText:t.finalRefresherCompleteText,goF2Text:t.finalRefresherGoF2Text,defaultImg:t.refresherDefaultImg,pullingImg:t.refresherPullingImg,refreshingImg:t.refresherRefreshingImg,completeImg:t.refresherCompleteImg,refreshingAnimated:t.refresherRefreshingAnimated,showUpdateTime:t.showRefresherUpdateTime,updateTimeKey:t.refresherUpdateTimeKey,updateTimeTextMap:t.finalRefresherUpdateTimeTextMap,imgStyle:t.refresherImgStyle,titleStyle:t.refresherTitleStyle,updateTimeStyle:t.refresherUpdateTimeStyle,unit:t.unit},null,8,["style","status","defaultThemeStyle","defaultText","pullingText","refreshingText","completeText","goF2Text","defaultImg","pullingImg","refreshingImg","completeImg","refreshingAnimated","showUpdateTime","updateTimeKey","updateTimeTextMap","imgStyle","titleStyle","updateTimeStyle","unit"]))],4)],4)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"zp-paging-container",style:e.normalizeStyle([{justifyContent:t.useChatRecordMode?"flex-end":"flex-start"}])},[t.showLoading&&t.zSlots.loading&&!t.loadingFullFixed?e.renderSlot(t.$slots,"loading",{key:0},void 0,!0):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"zp-paging-container-content",style:e.normalizeStyle([t.finalPlaceholderTopHeightStyle,t.finalPagingContentStyle])},[t.useVirtualList?(e.openBlock(),e.createElementBlock("view",{key:0,class:"zp-virtual-placeholder",style:e.normalizeStyle([{height:t.virtualPlaceholderTopHeight+"px"}])},null,4)):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"default",{},void 0,!0),t.finalUseInnerList?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.renderSlot(t.$slots,"header",{},void 0,!0),e.createElementVNode("view",{class:"zp-list-container",style:e.normalizeStyle([t.innerListStyle])},[t.finalUseVirtualList?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(t.virtualList,((n,o)=>(e.openBlock(),e.createElementBlock("view",{class:"zp-list-cell",style:e.normalizeStyle([t.innerCellStyle]),id:`${t.fianlVirtualCellIdPrefix}-${n[t.virtualCellIndexKey]}`,key:n.zp_unique_index,onClick:e=>t._innerCellClick(n,t.virtualTopRangeIndex+o)},[t.useCompatibilityMode?(e.openBlock(),e.createElementBlock("view",{key:0},"使用兼容模式请在组件源码z-paging.vue第103行中注释这一行，并打开下面一行注释")):e.renderSlot(t.$slots,"cell",{key:1,item:n,index:t.virtualTopRangeIndex+o},void 0,!0)],12,["id","onClick"])))),128)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(t.realTotalData,((n,o)=>(e.openBlock(),e.createElementBlock("view",{class:"zp-list-cell",key:o,onClick:e=>t._innerCellClick(n,o)},[e.renderSlot(t.$slots,"cell",{item:n,index:o},void 0,!0)],8,["onClick"])))),128))],4),e.renderSlot(t.$slots,"footer",{},void 0,!0)],64)):e.createCommentVNode("",!0),t.useChatRecordMode&&t.realTotalData.length>=t.defaultPageSize&&(t.loadingStatus!==t.M.NoMore||t.zSlots.chatNoMore)&&(t.realTotalData.length||t.showChatLoadingWhenReload&&t.showLoading)&&!t.isFirstPageAndNoMore?(e.openBlock(),e.createElementBlock("view",{key:2,style:e.normalizeStyle([t.chatRecordRotateStyle])},[t.loadingStatus===t.M.NoMore&&t.zSlots.chatNoMore?e.renderSlot(t.$slots,"chatNoMore",{key:0},void 0,!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[t.zSlots.chatLoading?e.renderSlot(t.$slots,"chatLoading",{key:0,loadingMoreStatus:t.loadingStatus},void 0,!0):(e.openBlock(),e.createBlock(l,{key:1,onDoClick:n[2]||(n[2]=e=>t._onLoadingMore("click")),zConfig:t.zLoadMoreConfig},null,8,["zConfig"]))],64))],4)):e.createCommentVNode("",!0),t.useVirtualList?(e.openBlock(),e.createElementBlock("view",{key:3,class:"zp-virtual-placeholder",style:e.normalizeStyle([{height:t.virtualPlaceholderBottomHeight+"px"}])},null,4)):e.createCommentVNode("",!0),t.showLoadingMoreDefault?e.renderSlot(t.$slots,"loadingMoreDefault",{key:4},void 0,!0):t.showLoadingMoreLoading?e.renderSlot(t.$slots,"loadingMoreLoading",{key:5},void 0,!0):t.showLoadingMoreNoMore?e.renderSlot(t.$slots,"loadingMoreNoMore",{key:6},void 0,!0):t.showLoadingMoreFail?e.renderSlot(t.$slots,"loadingMoreFail",{key:7},void 0,!0):t.showLoadingMoreCustom?(e.openBlock(),e.createBlock(l,{key:8,onDoClick:n[3]||(n[3]=e=>t._onLoadingMore("click")),zConfig:t.zLoadMoreConfig},null,8,["zConfig"])):e.createCommentVNode("",!0),t.safeAreaInsetBottom&&t.useSafeAreaPlaceholder&&!t.useChatRecordMode?(e.openBlock(),e.createElementBlock("view",{key:9,class:"zp-safe-area-placeholder",style:e.normalizeStyle([{height:t.safeAreaBottom+"px"}])},null,4)):e.createCommentVNode("",!0)],4),t.showEmpty?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass({"zp-empty-view":!0,"zp-empty-view-center":t.emptyViewCenter}),style:e.normalizeStyle([t.emptyViewSuperStyle,t.chatRecordRotateStyle])},[t.zSlots.empty?e.renderSlot(t.$slots,"empty",{key:0,isLoadFailed:t.isLoadFailed},void 0,!0):(e.openBlock(),e.createBlock(c,{key:1,emptyViewImg:t.finalEmptyViewImg,emptyViewText:t.finalEmptyViewText,showEmptyViewReload:t.finalShowEmptyViewReload,emptyViewReloadText:t.finalEmptyViewReloadText,isLoadFailed:t.isLoadFailed,emptyViewStyle:t.emptyViewStyle,emptyViewTitleStyle:t.emptyViewTitleStyle,emptyViewImgStyle:t.emptyViewImgStyle,emptyViewReloadStyle:t.emptyViewReloadStyle,emptyViewZIndex:t.emptyViewZIndex,emptyViewFixed:t.emptyViewFixed,unit:t.unit,onReload:t._emptyViewReload,onViewClick:t._emptyViewClick},null,8,["emptyViewImg","emptyViewText","showEmptyViewReload","emptyViewReloadText","isLoadFailed","emptyViewStyle","emptyViewTitleStyle","emptyViewImgStyle","emptyViewReloadStyle","emptyViewZIndex","emptyViewFixed","unit","onReload","onViewClick"]))],6)):e.createCommentVNode("",!0)],4)],12,["change:prop","prop","data-refresherThreshold","data-refresherF2Enabled","data-refresherF2Threshold","data-isIos","data-loading","data-useChatRecordMode","data-refresherEnabled","data-useCustomRefresher","data-pageScrollTop","data-scrollTop","data-refresherMaxAngle","data-refresherNoTransform","data-refresherAecc","data-usePageScroll","data-watchTouchDirectionChange","data-oldIsTouchmoving","data-refresherOutRate","data-refresherPullRate","data-hasTouchmove","change:renderPropIsIosAndH5","renderPropIsIosAndH5"])],32)],46,["scroll-top","scroll-left","scroll-x","scroll-y","enable-back-to-top","show-scrollbar","scroll-with-animation","scroll-into-view","lower-threshold","refresher-enabled","refresher-threshold","refresher-default-style","refresher-background","refresher-triggered"])],6),t.zSlots.right?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass({"zp-page-right":!0,"zp-absoulte zp-right":t.finalIsOldWebView})},[e.renderSlot(t.$slots,"right",{},void 0,!0)],2)):e.createCommentVNode("",!0)],6),e.createElementVNode("view",{class:"zp-page-bottom-container",style:e.normalizeStyle({background:t.bottomBgColor})},[!t.usePageScroll&&t.zSlots.bottom?e.renderSlot(t.$slots,"bottom",{key:0},void 0,!0):t.usePageScroll&&t.zSlots.bottom?(e.openBlock(),e.createElementBlock("view",{key:1,class:"zp-page-bottom",onTouchmove:n[17]||(n[17]=e.withModifiers((()=>{}),["stop","prevent"])),style:e.normalizeStyle([{bottom:`${t.windowBottom}px`}])},[e.renderSlot(t.$slots,"bottom",{},void 0,!0)],36)):e.createCommentVNode("",!0),t.useChatRecordMode&&t.autoAdjustPositionWhenChat?(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[e.createElementVNode("view",{style:e.normalizeStyle([{height:t.chatRecordModeSafeAreaBottom+"px"}])},null,4),e.createElementVNode("view",{class:"zp-page-bottom-keyboard-placeholder-animate",style:e.normalizeStyle([{height:t.keyboardHeight+"px"}])},null,4)],64)):e.createCommentVNode("",!0)],4),t.showBackToTopClass?(e.openBlock(),e.createElementBlock("view",{key:3,class:e.normalizeClass(t.finalBackToTopClass),style:e.normalizeStyle([t.finalBackToTopStyle]),onClick:n[18]||(n[18]=e.withModifiers(((...e)=>t._backToTopClick&&t._backToTopClick(...e)),["stop"]))},[t.zSlots.backToTop?e.renderSlot(t.$slots,"backToTop",{key:0},void 0,!0):(e.openBlock(),e.createElementBlock("image",{key:1,class:e.normalizeClass(["zp-back-to-top-img",{"zp-back-to-top-img-inversion":t.useChatRecordMode&&!t.backToTopImg.length}]),src:t.backToTopImg.length?t.backToTopImg:t.base64BackToTop},null,10,["src"]))],6)):e.createCommentVNode("",!0),t.showLoading&&t.zSlots.loading&&t.loadingFullFixed?(e.openBlock(),e.createElementBlock("view",{key:4,class:"zp-loading-fixed"},[e.renderSlot(t.$slots,"loading",{},void 0,!0)])):e.createCommentVNode("",!0)],6)}],["__scopeId","data-v-6244fbf3"]]),no=__spreadProps(__spreadValues({},X),{show:$(!1),duration:{type:[Object,Number,Boolean],default:300},lazyRender:$(!1),name:[String,Array],destroy:$(!0),enterClass:J(""),enterActiveClass:J(""),enterToClass:J(""),leaveClass:J(""),leaveActiveClass:J(""),leaveToClass:J("")}),oo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-transition",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:no,emits:["click","before-enter","enter","before-leave","leave","after-leave","after-enter"],setup(t,{emit:n}){const o=e=>{let t=`${a.enterClass} ${a.enterActiveClass}`,n=`${a.enterToClass} ${a.enterActiveClass}`,o=`${a.leaveClass} ${a.leaveActiveClass}`,i=`${a.leaveToClass} ${a.leaveActiveClass}`;if(Array.isArray(e))for(let a=0;a<e.length;a++)t=`wd-${e[a]}-enter wd-${e[a]}-enter-active ${t}`,n=`wd-${e[a]}-enter-to wd-${e[a]}-enter-active ${n}`,o=`wd-${e[a]}-leave wd-${e[a]}-leave-active ${o}`,i=`wd-${e[a]}-leave-to wd-${e[a]}-leave-active ${i}`;else e&&(t=`wd-${e}-enter wd-${e}-enter-active ${t}`,n=`wd-${e}-enter-to wd-${e}-enter-active ${n}`,o=`wd-${e}-leave wd-${e}-leave-active ${o}`,i=`wd-${e}-leave-to wd-${e}-leave-active ${i}`);return{enter:t,"enter-to":n,leave:o,"leave-to":i}},a=t,i=n,r=e.ref(!1),s=e.ref(!1),l=e.ref(""),c=e.ref(!1),u=e.ref(300),d=e.ref(""),p=e.ref(null),h=e.ref(null),g=e.ref(null),m=e.computed((()=>`-webkit-transition-duration:${u.value}ms;transition-duration:${u.value}ms;${s.value||!a.destroy?"":"display: none;"}${a.customStyle}`)),v=e.computed((()=>`wd-transition ${a.customClass}  ${d.value}`));function y(){i("click")}function I(){p.value=new f((e=>__async(this,null,(function*(){try{const t=o(a.name),n=_(a.duration)?a.duration.enter:a.duration;l.value="enter",i("before-enter"),h.value=U(),yield h.value,i("enter"),d.value=t.enter,u.value=n,h.value=U(),yield h.value,r.value=!0,s.value=!0,h.value=U(),yield h.value,h.value=null,c.value=!1,d.value=t["enter-to"],e()}catch(t){}}))))}function C(){c.value||(c.value=!0,"leave"===l.value?i("after-leave"):"enter"===l.value&&i("after-enter"),!a.show&&s.value&&(s.value=!1))}return e.onBeforeMount((()=>{a.show&&I()})),e.watch((()=>a.show),(e=>{e?(O(p.value)&&p.value.abort(),O(h.value)&&h.value.abort(),O(g.value)&&g.value.abort(),p.value=null,h.value=null,g.value=null,I()):function(){__async(this,null,(function*(){if(!p.value)return c.value=!1,C();try{if(yield p.value,!s.value)return;const e=o(a.name),t=_(a.duration)?a.duration.leave:a.duration;l.value="leave",i("before-leave"),u.value=t,g.value=U(),yield g.value,i("leave"),d.value=e.leave,g.value=U(),yield g.value,c.value=!1,d.value=e["leave-to"],g.value=function(e){return new f((t=>{const n=setTimeout((()=>{clearTimeout(n),t()}),e)}))}(u.value),yield g.value,g.value=null,C(),p.value=null}catch(e){}}))}()}),{deep:!0}),(t,n)=>!t.lazyRender||r.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(v.value),style:e.normalizeStyle(m.value),onTransitionend:C,onClick:y},[e.renderSlot(t.$slots,"default",{},void 0,!0)],38)):e.createCommentVNode("",!0)}})),[["__scopeId","data-v-1fc69211"]]),ao=__spreadProps(__spreadValues({},X),{show:$(!1),duration:{type:[Object,Number,Boolean],default:300},lockScroll:$(!0),zIndex:W(10)}),io=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-overlay",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:ao,emits:["click"],setup(t,{emit:n}){const o=n;function a(){o("click")}function i(){}return(t,n)=>(e.openBlock(),e.createBlock(oo,{show:t.show,name:"fade","custom-class":"wd-overlay",duration:t.duration,"custom-style":`z-index: ${t.zIndex}; ${t.customStyle}`,onClick:a,onTouchmove:n[0]||(n[0]=e.withModifiers((e=>t.lockScroll?i:""),["stop","prevent"]))},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},void 0,!0)])),_:3},8,["show","duration","custom-style"]))}})),[["__scopeId","data-v-3d3ab6e7"]]),ro=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.ref(!1),a=e.ref(0),i=e.ref([]),r=e.ref(!1),s=()=>{uni.navigateBack()},l=()=>{i.value.push({text:"",checked:!1})},c=()=>{i.value.length>0?o.value=!0:uni.showToast({title:"请先添加自动回复模板",icon:"none",duration:2e3})},u=()=>{r.value=!1},d=()=>{i.value.splice(a.value,1)},p=()=>{o.value=!1};return(t,h)=>{const f=ae(e.resolveDynamicComponent("wd-img"),te),g=ae(e.resolveDynamicComponent("wd-text"),me),m=ae(e.resolveDynamicComponent("wd-switch"),Mt),v=ae(e.resolveDynamicComponent("wd-textarea"),Vt),_=ae(e.resolveDynamicComponent("z-paging"),to),y=ae(e.resolveDynamicComponent("wd-button"),Te),I=ae(e.resolveDynamicComponent("wd-overlay"),io);return e.openBlock(),e.createElementBlock("view",{class:"autoapply_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(f,{class:"back",src:"/static/images/back.png",onClick:s}),e.createElementVNode("view",{class:"title"},"自动回复"),e.createElementVNode("view",{class:"manage",onClick:c},"管理")]),e.createElementVNode("view",{class:"list"},[e.createVNode(_,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:"card"},[e.createElementVNode("view",{class:"cardHeader"},[e.createElementVNode("view",{class:"flex items-center"},[e.createVNode(f,{class:"w-24px h-24px mr-5px",src:"/static/images/hi.png"}),e.createVNode(g,{text:"设为打招呼文案",size:"15px",color:"#191C32"})]),o.value?(e.openBlock(),e.createBlock(f,{key:1,class:"w-24px h-24px",src:"/static/images/delete.png",onClick:e=>(e=>{a.value=e,r.value=!0})(n)},null,8,["onClick"])):(e.openBlock(),e.createBlock(m,{key:0,modelValue:t.checked,"onUpdate:modelValue":e=>t.checked=e,size:"small","active-color":"#34C759","inactive-color":"rgba(120, 120, 128, 0.16)",onChange:e=>((e,t)=>{i.value.forEach(((n,o)=>{n.checked=!!e&&t===o}))})(e,n)},null,8,["modelValue","onUpdate:modelValue","onChange"]))]),e.createElementVNode("view",{class:"cardContent"},[e.createVNode(v,{"custom-class":"textarea",modelValue:t.text,"onUpdate:modelValue":e=>t.text=e,placeholder:"点击输入打招呼文案"},null,8,["modelValue","onUpdate:modelValue"])])])))),128))])),_:1})]),e.createElementVNode("view",{class:"btnWrapper"},[o.value?(e.openBlock(),e.createBlock(y,{key:1,class:"cancelBtn",onClick:p},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1})):(e.openBlock(),e.createBlock(y,{key:0,class:"addBtn",onClick:l},{default:e.withCtx((()=>[e.createTextVNode("添加")])),_:1}))]),e.createVNode(I,{show:r.value,onClick:h[0]||(h[0]=e=>r.value=!1)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"dialog_wrapper"},[e.createElementVNode("view",{class:"block"},[e.createVNode(f,{class:"w-48px h-48px mt-20px",src:"/static/images/bell.png"}),e.createElementVNode("view",{class:"text"},"是否删除该自动回复模板？"),e.createElementVNode("view",{class:"btns"},[e.createVNode(y,{class:"cancel",onClick:u},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1}),e.createVNode(y,{class:"confirm",onClick:d},{default:e.withCtx((()=>[e.createTextVNode("确认")])),_:1})])])])])),_:1},8,["show"])],4)}}}),[["__scopeId","data-v-ef9229fb"]]),so=__spreadProps(__spreadValues({},X),{customInputClass:J(""),customLabelClass:J(""),placeholder:String,placeholderStyle:String,placeholderClass:J(""),cursorSpacing:W(0),cursor:W(-1),selectionStart:W(-1),selectionEnd:W(-1),adjustPosition:$(!0),holdKeyboard:$(!1),confirmType:J("done"),confirmHold:$(!1),focus:$(!1),type:J("text"),maxlength:{type:Number,default:-1},disabled:$(!1),alwaysEmbed:$(!1),alignRight:$(!1),modelValue:Z(""),showPassword:$(!1),clearable:$(!1),readonly:$(!1),prefixIcon:String,suffixIcon:String,showWordLimit:$(!1),label:String,labelWidth:J(""),size:String,error:$(!1),center:$(!1),noBorder:$(!1),required:$(!1),prop:String,rules:Y(),clearTrigger:J("always"),focusWhenClear:$(!0),ignoreCompositionEvent:$(!0),inputmode:J("text")}),lo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-input",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:so,emits:["update:modelValue","clear","blur","focus","input","keyboardheightchange","confirm","clicksuffixicon","clickprefixicon","click"],setup(t,{emit:n}){const o=t,a=n,i=e.useSlots(),{translate:r}=Pt("input"),s=e.ref(!1),l=e.ref(!1),c=e.ref(!1),u=e.ref(!1),d=e.ref(function(){const e=function(e){const{maxlength:t}=o;if(C(t)&&-1!==t&&String(e).length>t)return e.toString().slice(0,t);return e}(o.modelValue);t=e,n=o.modelValue,M(String(t),String(n))||a("update:modelValue",e);var t,n;return e}()),p=Dt();e.watch((()=>o.focus),(e=>{c.value=e}),{immediate:!0,deep:!0}),e.watch((()=>o.modelValue),(e=>{d.value=C(e)?String(e):""}));const{parent:h}=wt(Nt),f=e.computed((()=>C(o.placeholder)?o.placeholder:r("placeholder"))),g=e.computed((()=>{const{disabled:e,readonly:t,clearable:n,clearTrigger:a}=o;return!(!n||t||e||!d.value||!("always"===a||"focus"===o.clearTrigger&&u.value))})),m=e.computed((()=>{const{disabled:e,readonly:t,maxlength:n,showWordLimit:a}=o;return Boolean(!e&&!t&&C(n)&&n>-1&&a)})),v=e.computed((()=>h&&o.prop&&h.errorMessages&&h.errorMessages[o.prop]?h.errorMessages[o.prop]:"")),_=e.computed((()=>{let e=!1;if(h&&h.props.rules){const t=h.props.rules;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n===o.prop&&Array.isArray(t[n])&&(e=t[n].some((e=>e.required)))}return o.required||o.rules.some((e=>e.required))||e})),y=e.computed((()=>`wd-input  ${o.label||i.label?"is-cell":""} ${o.center?"is-center":""} ${p.border.value?"is-border":""} ${o.size?"is-"+o.size:""} ${o.error?"is-error":""} ${o.disabled?"is-disabled":""}  ${d.value&&String(d.value).length>0?"is-not-empty":""}  ${o.noBorder?"is-no-border":""} ${o.customClass}`)),I=e.computed((()=>`wd-input__label ${o.customLabelClass} ${_.value?"is-required":""}`)),k=e.computed((()=>`wd-input__placeholder  ${o.placeholderClass}`)),E=e.computed((()=>o.labelWidth?P({"min-width":o.labelWidth,"max-width":o.labelWidth}):""));function T(){s.value=!s.value}function S(){return __async(this,null,(function*(){l.value=!0,u.value=!1,d.value="",o.focusWhenClear&&(c.value=!1),yield U(),o.focusWhenClear&&(c.value=!0,u.value=!0),a("update:modelValue",d.value),a("clear")}))}function w(){return __async(this,null,(function*(){yield U(150),l.value?l.value=!1:(u.value=!1,a("blur",{value:d.value}))}))}function b({detail:e}){u.value=!0,a("focus",e)}function D({detail:e}){a("update:modelValue",d.value),a("input",e)}function N({detail:e}){a("keyboardheightchange",e)}function R({detail:e}){a("confirm",e)}function L(){a("clicksuffixicon")}function A(){a("clickprefixicon")}function O(e){a("click",e)}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(y.value),style:e.normalizeStyle(t.customStyle),onClick:O},[t.label||t.$slots.label?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(I.value),style:e.normalizeStyle(E.value)},[t.prefixIcon||t.$slots.prefix?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-input__prefix"},[t.prefixIcon&&!t.$slots.prefix?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-input__icon",name:t.prefixIcon,onClick:A},null,8,["name"])):e.renderSlot(t.$slots,"prefix",{key:1},void 0,!0)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-input__label-inner"},[t.label&&!t.$slots.label?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.label),1)],64)):e.renderSlot(t.$slots,"label",{key:1},void 0,!0)])],6)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-input__body"},[e.createElementVNode("view",{class:"wd-input__value"},[!t.prefixIcon&&!t.$slots.prefix||t.label?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-input__prefix"},[t.prefixIcon&&!t.$slots.prefix?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-input__icon",name:t.prefixIcon,onClick:A},null,8,["name"])):e.renderSlot(t.$slots,"prefix",{key:1},void 0,!0)])),e.withDirectives(e.createElementVNode("input",{class:e.normalizeClass(["wd-input__inner",t.prefixIcon?"wd-input__inner--prefix":"",m.value?"wd-input__inner--count":"",t.alignRight?"is-align-right":"",t.customInputClass]),type:t.type,password:t.showPassword&&!s.value,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e),placeholder:f.value,disabled:t.disabled||t.readonly,maxlength:t.maxlength,focus:c.value,"confirm-type":t.confirmType,"confirm-hold":t.confirmHold,cursor:t.cursor,"cursor-spacing":t.cursorSpacing,"placeholder-style":t.placeholderStyle,"selection-start":t.selectionStart,"selection-end":t.selectionEnd,"adjust-position":t.adjustPosition,"hold-keyboard":t.holdKeyboard,"always-embed":t.alwaysEmbed,"placeholder-class":k.value,ignoreCompositionEvent:t.ignoreCompositionEvent,inputmode:t.inputmode,onInput:D,onFocus:b,onBlur:w,onConfirm:R,onKeyboardheightchange:N},null,42,["type","password","placeholder","disabled","maxlength","focus","confirm-type","confirm-hold","cursor","cursor-spacing","placeholder-style","selection-start","selection-end","adjust-position","hold-keyboard","always-embed","placeholder-class","ignoreCompositionEvent","inputmode"]),[[e.vModelDynamic,d.value]]),t.readonly?(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-input__readonly-mask"})):e.createCommentVNode("",!0),g.value||t.showPassword||t.suffixIcon||m.value||t.$slots.suffix?(e.openBlock(),e.createElementBlock("view",{key:2,class:"wd-input__suffix"},[g.value?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-input__clear",name:"error-fill",onClick:S})):e.createCommentVNode("",!0),t.showPassword?(e.openBlock(),e.createBlock(_e,{key:1,"custom-class":"wd-input__icon",name:s.value?"view":"eye-close",onClick:T},null,8,["name"])):e.createCommentVNode("",!0),m.value?(e.openBlock(),e.createElementBlock("view",{key:2,class:"wd-input__count"},[e.createElementVNode("text",{class:e.normalizeClass([d.value&&String(d.value).length>0?"wd-input__count-current":"",String(d.value).length>t.maxlength?"is-error":""])},e.toDisplayString(String(d.value).length),3),e.createTextVNode(" /"+e.toDisplayString(t.maxlength),1)])):e.createCommentVNode("",!0),t.suffixIcon&&!t.$slots.suffix?(e.openBlock(),e.createBlock(_e,{key:3,"custom-class":"wd-input__icon",name:t.suffixIcon,onClick:L},null,8,["name"])):e.renderSlot(t.$slots,"suffix",{key:4},void 0,!0)])):e.createCommentVNode("",!0)]),v.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-input__error-message"},e.toDisplayString(v.value),1)):e.createCommentVNode("",!0)])],6))}})),[["__scopeId","data-v-40bd894e"]]),co=__spreadProps(__spreadValues({},X),{type:J("ring"),color:J("#4D80F0"),size:Z("")}),uo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-loading",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:co,setup(t){const n=b.id++,o=b.id++,a=b.id++,i={outline:(e="#4D80F0")=>`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 42 42"><defs><linearGradient x1="100%" y1="0%" x2="0%" y2="0%" id="${n}"><stop stop-color="#FFF" offset="0%" stop-opacity="0"/><stop stop-color="#FFF" offset="100%"/></linearGradient></defs><g fill="none" fill-rule="evenodd"><path d="M21 1c11.046 0 20 8.954 20 20s-8.954 20-20 20S1 32.046 1 21 9.954 1 21 1zm0 7C13.82 8 8 13.82 8 21s5.82 13 13 13 13-5.82 13-13S28.18 8 21 8z" fill="${e}"/><path d="M4.599 21c0 9.044 7.332 16.376 16.376 16.376 9.045 0 16.376-7.332 16.376-16.376" stroke="url(#${n}) " stroke-width="3.5" stroke-linecap="round"/></g></svg>`,ring:(e="#4D80F0",t="#a6bff7")=>`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200"><linearGradient id="${o}" gradientUnits="userSpaceOnUse" x1="50" x2="50" y2="180"><stop offset="0" stop-color="${e}"></stop> <stop offset="1" stop-color="${t}"></stop></linearGradient> <path fill="url(#${o})" d="M20 100c0-44.1 35.9-80 80-80V0C44.8 0 0 44.8 0 100s44.8 100 100 100v-20c-44.1 0-80-35.9-80-80z"></path> <linearGradient id="${a}" gradientUnits="userSpaceOnUse" x1="150" y1="20" x2="150" y2="180"><stop offset="0" stop-color="#fff" stop-opacity="0"></stop> <stop offset="1" stop-color="${t}"></stop></linearGradient> <path fill="url(#${a})" d="M100 0v20c44.1 0 80 35.9 80 80s-35.9 80-80 80v20c55.2 0 100-44.8 100-100S155.2 0 100 0z"></path> <circle cx="100" cy="10" r="10" fill="${e}"></circle></svg>`},r=t,s=e.ref(""),l=e.ref(""),c=e.ref(null);e.watch((()=>r.size),(e=>{c.value=v(e)}),{deep:!0,immediate:!0}),e.watch((()=>r.type),(()=>{d()}),{deep:!0,immediate:!0});const u=e.computed((()=>{const e={};return C(c.value)&&(e.height=v(c.value),e.width=v(c.value)),`${P(e)}; ${r.customStyle}`}));function d(){const{type:e,color:t}=r;let n=C(e)?e:"ring";const o=`"data:image/svg+xml;base64,${ke("ring"===n?i[n](t,l.value):i[n](t))}"`;s.value=o}return e.onBeforeMount((()=>{l.value=((e,t,n=2)=>{const o=T(e),a=T(t),i=(a[0]-o[0])/n,r=(a[1]-o[1])/n,s=(a[2]-o[2])/n,l=[];for(let c=0;c<n;c++)l.push(E(parseInt(String(i*c+o[0])),parseInt(String(r*c+o[1])),parseInt(String(s*c+o[2]))));return l})(r.color,"#ffffff",2)[1],d()})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-loading ${r.customClass}`),style:e.normalizeStyle(u.value)},[e.createElementVNode("view",{class:"wd-loading__body"},[e.createElementVNode("view",{class:"wd-loading__svg",style:e.normalizeStyle(`background-image: url(${s.value});`)},null,4)])],6))}})),[["__scopeId","data-v-93cab7fd"]]),po="__TOAST_OPTION__",ho={duration:2e3,show:!1},fo=Symbol("None");const go=e=>e?`${po}${e}`:po,mo={success:()=>'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>成功</title><desc>Created with Sketch.</desc><defs><filter x="-63.2%" y="-80.0%" width="226.3%" height="260.0%" filterUnits="objectBoundingBox" id="filter-1"><feOffset dx="0" dy="2" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="2" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.122733141   0 0 0 0 0.710852582   0 0 0 0 0.514812768  0 0 0 1 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter><rect id="path-2" x="3.4176226" y="5.81442199" width="3" height="8.5" rx="1.5"></rect><linearGradient x1="50%" y1="0.126649064%" x2="50%" y2="100%" id="linearGradient-4"><stop stop-color="#ACFFBD" stop-opacity="0.208123907" offset="0%"></stop><stop stop-color="#10B87C" offset="100%"></stop></linearGradient></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-388.000000, -538.000000)"><g id="成功" transform="translate(388.000000, 538.000000)"><circle id="Oval" fill="#34D19D" opacity="0.400000006" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#34D19D" cx="21" cy="21" r="16"></circle><g id="Group-6" filter="url(#filter-1)" transform="translate(11.500000, 14.000000)"><mask id="mask-3" fill="white"><use xlink:href="#path-2"></use></mask><use id="Rectangle-Copy-24" fill="#C4FFEB" transform="translate(4.917623, 10.064422) rotate(-45.000000) translate(-4.917623, -10.064422) " xlink:href="#path-2"></use><rect id="Rectangle" fill="url(#linearGradient-4)" mask="url(#mask-3)" transform="translate(6.215869, 11.372277) rotate(-45.000000) translate(-6.215869, -11.372277) " x="4.71586891" y="9.52269089" width="3" height="3.69917136"></rect><rect id="Rectangle" fill="#FFFFFF" transform="translate(11.636236, 7.232744) scale(1, -1) rotate(-45.000000) translate(-11.636236, -7.232744) " x="10.1362361" y="-1.02185365" width="3" height="16.5091951" rx="1.5"></rect></g></g></g></g></svg>',warning:()=>'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>警告</title><desc>Created with Sketch.</desc> <defs> <filter x="-240.0%" y="-60.0%" width="580.0%" height="220.0%" filterUnits="objectBoundingBox" id="filter-1"><feOffset dx="0" dy="2" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="2" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.824756567   0 0 0 0 0.450356612   0 0 0 0 0.168550194  0 0 0 1 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode> <feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-580.000000, -538.000000)"> <g id="警告" transform="translate(580.000000, 538.000000)"><circle id="Oval" fill="#F0883A" opacity="0.400000006" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#F0883A" cx="21" cy="21" r="16"></circle><g id="Group-6" filter="url(#filter-1)" transform="translate(18.500000, 10.800000)"><rect id="Rectangle" fill="#FFFFFF" transform="translate(2.492935, 7.171583) scale(1, -1) rotate(-360.000000) translate(-2.492935, -7.171583) " x="0.992934699" y="0.955464537" width="3" height="12.4322365" rx="1.5"></rect><rect id="Rectangle-Copy-25" fill="#FFDEC5" transform="translate(2.508751, 17.202636) scale(1, -1) rotate(-360.000000) translate(-2.508751, -17.202636) " x="1.00875134" y="15.200563" width="3" height="4.00414639" rx="1.5"></rect></g></g></g></g></svg>',info:()=>'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>常规</title><desc>Created with Sketch.</desc><defs><filter x="-300.0%" y="-57.1%" width="700.0%" height="214.3%" filterUnits="objectBoundingBox" id="filter-1"><feOffset dx="0" dy="2" in="SourceAlpha" result="shadowOffsetOuter1"></feOffset><feGaussianBlur stdDeviation="2" in="shadowOffsetOuter1" result="shadowBlurOuter1"></feGaussianBlur><feColorMatrix values="0 0 0 0 0.362700096   0 0 0 0 0.409035039   0 0 0 0 0.520238904  0 0 0 1 0" type="matrix" in="shadowBlurOuter1" result="shadowMatrixOuter1"></feColorMatrix><feMerge><feMergeNode in="shadowMatrixOuter1"></feMergeNode><feMergeNode in="SourceGraphic"></feMergeNode></feMerge></filter></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-772.000000, -538.000000)"><g id="常规" transform="translate(772.000000, 538.000000)"><circle id="Oval" fill="#909CB7" opacity="0.4" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#909CB7" cx="21" cy="21" r="16"></circle><g id="Group-6" filter="url(#filter-1)" transform="translate(18.500000, 9.800000)"><g id="编组-2" transform="translate(2.492935, 10.204709) rotate(-180.000000) translate(-2.492935, -10.204709) translate(0.992935, 0.204709)"><rect id="Rectangle" fill="#FFFFFF" transform="translate(1.500000, 7.000000) scale(1, -1) rotate(-360.000000) translate(-1.500000, -7.000000) " x="0" y="0" width="3" height="14" rx="1.5"></rect><rect id="Rectangle-Copy-25" fill="#EEEEEE" transform="translate(1.500000, 18.000000) scale(1, -1) rotate(-360.000000) translate(-1.500000, -18.000000) " x="0" y="16" width="3" height="4" rx="1.5"></rect></g></g></g></g></g></svg>',error:()=>'<svg width="42px" height="42px" viewBox="0 0 42 42" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><title>toast</title><desc>Created with Sketch.</desc><defs><linearGradient x1="99.6229896%" y1="50.3770104%" x2="0.377010363%" y2="50.3770104%" id="linearGradient-1"><stop stop-color="#FFDFDF" offset="0%"></stop><stop stop-color="#F9BEBE" offset="100%"></stop></linearGradient><linearGradient x1="0.377010363%" y1="50.3770104%" x2="99.6229896%" y2="50.3770104%" id="linearGradient-2"><stop stop-color="#FFDFDF" offset="0%"></stop><stop stop-color="#F9BEBE" offset="100%"></stop></linearGradient></defs><g id="规范" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd"><g id="反馈-轻提示" transform="translate(-196.000000, -538.000000)"> <g id="toast" transform="translate(196.000000, 538.000000)"><circle id="Oval" fill="#FA4350" opacity="0.400000006" cx="21" cy="21" r="20"></circle><circle id="Oval" fill="#FA4350" opacity="0.900000036" cx="21" cy="21" r="16"></circle><rect id="矩形" fill="#FFDFDF" transform="translate(21.071068, 21.071068) rotate(-225.000000) translate(-21.071068, -21.071068) " x="12.5710678" y="19.5710678" width="17" height="3" rx="1.5"></rect><rect id="矩形" fill="url(#linearGradient-1)" transform="translate(19.303301, 22.838835) rotate(-225.000000) translate(-19.303301, -22.838835) " x="17.3033009" y="21.3388348" width="4" height="3"></rect><rect id="矩形" fill="url(#linearGradient-2)" transform="translate(22.838835, 19.303301) rotate(-225.000000) translate(-22.838835, -19.303301) " x="20.8388348" y="17.8033009" width="4" height="3"></rect><rect id="矩形" fill="#FFFFFF" transform="translate(21.071068, 21.071068) rotate(-315.000000) translate(-21.071068, -21.071068) " x="12.5710678" y="19.5710678" width="17" height="3" rx="1.5"></rect></g></g></g></svg>'},vo=__spreadProps(__spreadValues({},X),{selector:J(""),msg:{type:String,default:""},direction:J("horizontal"),iconName:{type:String,default:""},iconSize:Number,loadingType:J("outline"),loadingColor:{type:String,default:"#4D80F0"},loadingSize:Number,iconColor:String,position:J("middle-top"),zIndex:{type:Number,default:100},cover:{type:Boolean,default:!1},iconClass:{type:String,default:""},classPrefix:{type:String,default:"wd-icon"},opened:Function,closed:Function}),_o=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-toast",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:vo,setup(t){const n=t,o=e.ref(""),a=e.ref(""),i=e.ref("middle"),r=e.ref(!1),s=e.ref(100),l=e.ref("outline"),c=e.ref("#4D80F0"),u=e.ref(),d=e.ref(),p=e.ref(""),h=e.ref(!1),f=e.ref("wd-icon"),g=e.ref(""),m=e.ref("horizontal");let _=null,y=null;const I=go(n.selector),k=e.inject(I,e.ref(ho));e.watch((()=>k.value),(e=>{var t;t=e,r.value=!!C(t.show)&&t.show,r.value&&function(e,t){o.value=C(e.iconName)?e.iconName:t.iconName,g.value=C(e.iconClass)?e.iconClass:t.iconClass,a.value=C(e.msg)?e.msg:t.msg,i.value=C(e.position)?e.position:t.position,s.value=C(e.zIndex)?e.zIndex:t.zIndex,l.value=C(e.loadingType)?e.loadingType:t.loadingType,c.value=C(e.loadingColor)?e.loadingColor:t.loadingColor,u.value=C(e.iconSize)?v(e.iconSize):C(t.iconSize)?v(t.iconSize):void 0,d.value=C(e.loadingSize)?v(e.loadingSize):C(t.loadingSize)?v(t.loadingSize):void 0,h.value=C(e.cover)?e.cover:t.cover,f.value=C(e.classPrefix)?e.classPrefix:t.classPrefix,m.value=C(e.direction)?e.direction:t.direction,y=R(e.closed)?e.closed:R(t.closed)?t.closed:null,_=R(e.opened)?e.opened:R(t.opened)?t.opened:null}(t,n)}),{deep:!0,immediate:!0}),e.watch((()=>o.value),(()=>{b()}),{deep:!0,immediate:!0});const E=e.computed((()=>P({"z-index":s.value,position:"fixed",top:"50%",left:0,width:"100%",transform:"translate(0, -50%)","text-align":"center","pointer-events":"none"}))),T=e.computed((()=>`wd-toast ${n.customClass} wd-toast--${i.value} ${"loading"===o.value&&!a.value||!o.value&&!g.value?"":"wd-toast--with-icon"} ${"loading"!==o.value||a.value?"":"wd-toast--loading"} ${"vertical"===m.value?"is-vertical":""}`)),S=e.computed((()=>{const e={backgroundImage:`url(${p.value})`};return C(u.value)&&(e.width=u.value,e.height=u.value),P(e)}));function M(){R(_)&&_()}function w(){R(y)&&y()}function b(){if("success"!==o.value&&"warning"!==o.value&&"info"!==o.value&&"error"!==o.value)return;const e=`"data:image/svg+xml;base64,${ke(mo[o.value]())}"`;p.value=e}return e.onBeforeMount((()=>{b()})),(t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[h.value?(e.openBlock(),e.createBlock(io,{key:0,"z-index":s.value,"lock-scroll":"",show:r.value,"custom-style":"background-color: transparent;pointer-events: auto;"},null,8,["z-index","show"])):e.createCommentVNode("",!0),e.createVNode(oo,{name:"fade",show:r.value,"custom-style":E.value,onAfterEnter:M,onAfterLeave:w},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(T.value)},["loading"===o.value?(e.openBlock(),e.createBlock(uo,{key:0,type:l.value,color:c.value,size:d.value,"custom-class":"wd-toast__icon "+("vertical"===m.value?"is-vertical":"")},null,8,["type","color","size","custom-class"])):"success"===o.value||"warning"===o.value||"info"===o.value||"error"===o.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass("wd-toast__iconWrap wd-toast__icon "+("vertical"===m.value?"is-vertical":""))},[e.createElementVNode("view",{class:"wd-toast__iconBox"},[e.createElementVNode("view",{class:"wd-toast__iconSvg",style:e.normalizeStyle(S.value)},null,4)])],2)):g.value?(e.openBlock(),e.createBlock(_e,{key:2,"custom-class":"wd-toast__icon "+("vertical"===m.value?"is-vertical":""),size:u.value,"class-prefix":f.value,name:g.value},null,8,["custom-class","size","class-prefix","name"])):e.createCommentVNode("",!0),a.value?(e.openBlock(),e.createElementBlock("view",{key:3,class:"wd-toast__msg"},e.toDisplayString(a.value),1)):e.createCommentVNode("",!0)],2)])),_:1},8,["show","custom-style"])],64))}})),[["__scopeId","data-v-d24ac773"]]);const yo=(e,t)=>{const n=e.indexOf(t);return-1===n?e.findIndex((e=>void 0!==t.key&&null!==t.key&&e.type===t.type&&e.key===t.key)):n};function Io(e,t,n){const o=e&&e.subTree&&e.subTree.children?function(e){const t=[],n=e=>{Array.isArray(e)&&e.forEach((e=>{var o,a;(a=e)&&!0===a.__v_isVNode&&(t.push(e),(null==(o=e.component)?void 0:o.subTree)&&(t.push(e.component.subTree),n(e.component.subTree.children)),e.children&&n(e.children))}))};return n(e),t}(e.subTree.children):[];n.sort(((e,t)=>yo(o,e.vnode)-yo(o,t.vnode)));const a=n.map((e=>e.proxy));t.sort(((e,t)=>a.indexOf(e)-a.indexOf(t)))}function Co(t){const n=e.reactive([]),o=e.reactive([]),a=e.getCurrentInstance();return{children:n,linkChildren:i=>{e.provide(t,Object.assign({link:e=>{e.proxy&&(o.push(e),n.push(e.proxy),Io(a,n,o))},unlink:e=>{const t=o.indexOf(e);n.splice(t,1),o.splice(t,1)},children:n,internalChildren:o},i))}}}const ko=e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-form",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Rt,setup(t,{expose:n}){const{show:o}=function(t=""){const n=go(t),o=e.inject(n,e.ref(fo));o.value===fo&&(o.value=ho,e.provide(n,o));let a=null;const i=e=>t=>r(V(e,"string"==typeof t?{msg:t}:t)),r=e=>{const t=V(ho,"string"==typeof e?{msg:e}:e);o.value=V(t,{show:!0}),a&&clearTimeout(a),o.value.duration&&o.value.duration>0&&(a=setTimeout((()=>{a&&clearTimeout(a),p()}),t.duration))},s=i({iconName:"loading",duration:0,cover:!0}),l=i({iconName:"success",duration:1500}),c=i({iconName:"error"}),u=i({iconName:"warning"}),d=i({iconName:"info"}),p=()=>{o.value={show:!1}};return{show:r,loading:s,success:l,error:c,warning:u,info:d,close:p}}("wd-form-toast"),a=t,{children:i,linkChildren:r}=Co(Nt);let s=e.reactive({});function l(e){e?s[e]="":Object.keys(s).forEach((e=>{s[e]=""}))}return r({props:a,errorMessages:s}),e.watch((()=>a.model),(()=>{a.resetOnChange&&l()}),{immediate:!0,deep:!0}),n({validate:function(e){return __async(this,null,(function*(){const t=[];let n=!0;const r=[],c=function(){const e=x(a.rules),t=i.map((e=>e.prop));return Object.keys(e).forEach((n=>{t.includes(n)||delete e[n]})),i.forEach((t=>{C(t.prop)&&C(t.rules)&&t.rules.length&&(e[t.prop]?e[t.prop]=[...e[t.prop],...t.rules]:e[t.prop]=t.rules)})),e}(),u=N(e)?e:C(e)?[e]:[],d=u.length>0?u.reduce(((e,t)=>(c[t]&&(e[t]=c[t]),e)),{}):c;for(const e in d){const o=d[e],i=F(a.model,e);if(o&&o.length>0)for(const a of o){if(a.required&&(!C(i)||""===i)){t.push({prop:e,message:a.message}),n=!1;break}if(a.pattern&&!a.pattern.test(i)){t.push({prop:e,message:a.message}),n=!1;break}const o=a,{validator:s}=o,l=__objRest(o,["validator"]);if(s){const o=s(i,l);O(o)?r.push(o.then((o=>{"string"==typeof o?(t.push({prop:e,message:o}),n=!1):"boolean"!=typeof o||o||(t.push({prop:e,message:a.message}),n=!1)})).catch((o=>{const i=C(o)?L(o)?o:o.message||a.message:a.message;t.push({prop:e,message:i}),n=!1}))):o||(t.push({prop:e,message:a.message}),n=!1)}}}return yield Promise.all(r),function(e){const t=i.map((e=>e.prop)).filter(Boolean),n=e.filter((e=>e.message&&t.includes(e.prop)));n.length&&(n.sort(((e,n)=>t.indexOf(e.prop)-t.indexOf(n.prop))),"toast"===a.errorType?o(n[0].message):"message"===a.errorType&&n.forEach((e=>{s[e.prop]=e.message})))}(t),n&&(u.length?u.forEach(l):l()),{valid:n,errors:t}}))},reset:function(){l()}}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-form ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[e.renderSlot(t.$slots,"default",{},void 0,!0),"toast"===a.errorType?(e.openBlock(),e.createBlock(_o,{key:0,selector:"wd-form-toast"})):e.createCommentVNode("",!0)],6))}})),Eo=ee(ko,[["__scopeId","data-v-e513a788"]]),To=__spreadProps(__spreadValues({},X),{transition:String,closable:$(!1),position:J("center"),closeOnClickModal:$(!0),duration:{type:[Number,Boolean],default:300},modal:$(!0),zIndex:W(10),hideWhenClose:$(!0),modalStyle:J(""),safeAreaInsetBottom:$(!1),modelValue:$(!1),lazyRender:$(!0),lockScroll:$(!0)}),So=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-popup",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:To,emits:["update:modelValue","before-enter","enter","before-leave","leave","after-leave","after-enter","click-modal","close"],setup(t,{emit:n}){const o=t,a=n,i=e.computed((()=>o.transition?o.transition:"center"===o.position?["zoom-in","fade"]:"left"===o.position?"slide-left":"right"===o.position?"slide-right":"bottom"===o.position?"slide-up":"top"===o.position?"slide-down":"slide-up")),r=e.ref(0),s=e.computed((()=>`z-index:${o.zIndex}; padding-bottom: ${r.value}px;${o.customStyle}`)),l=e.computed((()=>`wd-popup wd-popup--${o.position} ${o.transition||"center"!==o.position?"":"is-deep"} ${o.customClass||""}`));function c(){a("click-modal"),o.closeOnClickModal&&u()}function u(){a("close"),a("update:modelValue",!1)}function d(){}return e.onBeforeMount((()=>{if(o.safeAreaInsetBottom){const{safeArea:e,screenHeight:t,safeAreaInsets:n}=uni.getSystemInfoSync();r.value=e&&n?n.bottom:0}})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"wd-popup-wrapper"},[t.modal?(e.openBlock(),e.createBlock(io,{key:0,show:t.modelValue,"z-index":t.zIndex,"lock-scroll":t.lockScroll,duration:t.duration,"custom-style":t.modalStyle,onClick:c,onTouchmove:d},null,8,["show","z-index","lock-scroll","duration","custom-style"])):e.createCommentVNode("",!0),e.createVNode(oo,{"lazy-render":t.lazyRender,"custom-class":l.value,"custom-style":s.value,duration:t.duration,show:t.modelValue,name:i.value,destroy:t.hideWhenClose,onBeforeEnter:n[0]||(n[0]=e=>a("before-enter")),onEnter:n[1]||(n[1]=e=>a("enter")),onAfterEnter:n[2]||(n[2]=e=>a("after-enter")),onBeforeLeave:n[3]||(n[3]=e=>a("before-leave")),onLeave:n[4]||(n[4]=e=>a("leave")),onAfterLeave:n[5]||(n[5]=e=>a("after-leave"))},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},void 0,!0),t.closable?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-popup__close",name:"add",onClick:u})):e.createCommentVNode("",!0)])),_:3},8,["lazy-render","custom-class","custom-style","duration","show","name","destroy"])]))}})),[["__scopeId","data-v-974776cf"]]),Mo=__spreadProps(__spreadValues({},X),{loading:$(!1),loadingColor:J("#4D80F0"),columnsHeight:W(217),valueKey:J("value"),labelKey:J("label"),immediateChange:$(!1),modelValue:{type:[String,Number,Boolean,Array,Array,Array],default:"",required:!0},columns:Y(),columnChange:Function});function wo(e,t,n){let o=N(e)?e:[e];const a=new Set(e.map(y));if(1!==a.size&&a.has("object"))throw Error("The columns are correct");N(e[0])||(o=[o]);return o.map((e=>e.map((e=>{if(!_(e))return{[t]:e,[n]:e};if(!e.hasOwnProperty(t)&&!e.hasOwnProperty(n))throw Error("Can't find valueKey and labelKey in columns");return e.hasOwnProperty(n)||(e[n]=e[t]),e.hasOwnProperty(t)||(e[t]=e[n]),e}))))}const bo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-picker-view",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Mo,emits:["change","pickstart","pickend","update:modelValue"],setup(t,{expose:n,emit:o}){const a=t,i=o,r=e.ref([]),s=e.ref(35),l=e.ref([]);e.watch([()=>a.modelValue,()=>a.columns],((e,t)=>{!M(t[1],e[1])&&N(e[1])&&e[1].length>0&&(r.value=wo(e[1],a.valueKey,a.labelKey)),C(e[0])&&function(e){if(0===r.value.length)return;(""===e||!C(e)||N(e)&&0===e.length)&&(e=r.value.map((e=>e[0][a.valueKey])));const t=y(e);["string","number","boolean","array"].indexOf(t);e=(e=N(e)?e:[e]).slice(0,r.value.length);let n=x(l.value);e.forEach(((e,t)=>{let o=r.value[t].findIndex((t=>t[a.valueKey].toString()===e.toString()));o=-1===o?0:o,n=u(t,o,n)})),l.value=n.slice(0,e.length)}(e[0])}),{deep:!0,immediate:!0});const{proxy:c}=e.getCurrentInstance();function u(e,t,n){const o=r.value[e];if(!o||!o[t])throw Error(`The value to select with Col:${e} Row:${t} is incorrect`);const a=x(n);if(a[e]=t,o[t].disabled){const n=o.slice(0,t).reverse().findIndex((e=>!e.disabled)),i=o.slice(t+1).findIndex((e=>!e.disabled));-1!==n?a[e]=t-1-n:-1!==i?a[e]=t+1+i:void 0===a[e]&&(a[e]=0)}return a}function d({detail:{value:t}}){const n=function(e){e=e.slice(0,r.value.length);const t=x(l.value);let n=x(l.value);e.forEach(((e,o)=>{(e=S(e,0,r.value[o].length-1))!==t[o]&&(n=u(o,e,n))}));const o=function(e,t){if(!e||!t)return-1;const n=e.findIndex(((e,n)=>e!==t[n]));return n}(n,t);if(-1===o)return;const a=n[o];return 1===n.length?a:o}(t=t.map((e=>Number(e||0))));l.value=x(t),e.nextTick((()=>{l.value=function(e){let t=x(e);return e.forEach(((e,n)=>{e=S(e,0,r.value[n].length-1),t=u(n,e,t)})),t}(t),a.columnChange?a.columnChange.length<4?(a.columnChange(c.$.exposed,h(),n||0,(()=>{})),p(n||0)):a.columnChange(c.$.exposed,h(),n||0,(()=>{p(n||0)})):p(n||0)}))}function p(e){const t=f();M(t,a.modelValue)||(i("update:modelValue",t),setTimeout((()=>{i("change",{picker:c.$.exposed,value:t,index:e})}),0))}function h(){const e=l.value.map(((e,t)=>r.value[t][e]));return 1===e.length?e[0]:e}function f(){const{valueKey:e}=a,t=l.value.map(((t,n)=>r.value[n][t][e]));return 1===t.length?t[0]:t}function g(){i("pickstart")}function m(){i("pickend")}return n({getSelects:h,getValues:f,setColumnData:function(e,t,n=0){r.value[e]=wo(t,a.valueKey,a.labelKey).reduce(((e,t)=>e.concat(t)),[]),l.value=u(e,n,l.value)},getColumnsData:function(){return x(r.value)},getColumnData:function(e){return r.value[e]},getColumnIndex:function(e){return l.value[e]},getLabels:function(){const{labelKey:e}=a;return l.value.map(((t,n)=>r.value[n][t][e]))},getSelectedIndex:function(){return l.value},resetColumns:function(e){N(e)&&e.length&&(r.value=wo(e,a.valueKey,a.labelKey))}}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-picker-view ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[t.loading?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-picker-view__loading"},[e.createVNode(uo,{color:t.loadingColor},null,8,["color"])])):e.createCommentVNode("",!0),e.createElementVNode("view",{style:e.normalizeStyle(`height: ${t.columnsHeight-20}px;`)},[e.createElementVNode("picker-view",{"mask-class":"wd-picker-view__mask","indicator-class":"wd-picker-view__roller","indicator-style":`height: ${s.value}px;`,style:e.normalizeStyle(`height: ${t.columnsHeight-20}px;`),value:l.value,"immediate-change":t.immediateChange,onChange:d,onPickstart:g,onPickend:m},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(r.value,((n,o)=>(e.openBlock(),e.createElementBlock("picker-view-column",{key:o,class:"wd-picker-view-column"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n,((n,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(`wd-picker-view-column__item ${n.disabled?"wd-picker-view-column__item--disabled":""}  ${l.value[o]==a?"wd-picker-view-column__item--active":""}`),style:e.normalizeStyle(`line-height: ${s.value}px;`)},e.toDisplayString(n[t.labelKey]),7)))),128))])))),128))],44,["indicator-style","value","immediate-change"])],4)],6))}})),[["__scopeId","data-v-ce7f0a32"]]),Do=__spreadProps(__spreadValues({},X),{customLabelClass:J(""),customValueClass:J(""),customViewClass:J(""),label:String,placeholder:String,disabled:$(!1),readonly:$(!1),loading:$(!1),loadingColor:J("#4D80F0"),title:String,cancelButtonText:String,confirmButtonText:String,required:$(!1),size:String,labelWidth:String,useDefaultSlot:$(!1),useLabelSlot:$(!1),error:$(!1),alignRight:$(!1),beforeConfirm:Function,closeOnClickModal:$(!0),safeAreaInsetBottom:$(!0),ellipsis:$(!1),columnsHeight:W(217),valueKey:J("value"),labelKey:J("label"),modelValue:{type:[String,Number,Array],default:""},columns:{type:Array,default:()=>[]},columnChange:Function,displayFormat:Function,zIndex:W(15),prop:String,rules:Y(),immediateChange:$(!1),clearable:$(!1)}),No=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-picker",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Do,emits:["confirm","open","cancel","clear","update:modelValue"],setup(t,{expose:n,emit:o}){const{translate:a}=Pt("picker"),i=t,r=o,s=e.ref(null),l=Dt(),c=e.ref(!1),u=e.ref(!1),d=e.ref(""),p=e.ref(""),h=e.ref([]),f=e.ref([]),g=e.ref(!1),m=e.ref(!1),v=e.computed((()=>i.loading||c.value));e.watch((()=>i.displayFormat),(e=>{e&&R(e),s.value&&0!==s.value.getSelectedIndex().length&&S(i.modelValue)}),{immediate:!0,deep:!0}),e.watch((()=>i.modelValue),(e=>{p.value=e,S(e)}),{deep:!0,immediate:!0}),e.watch((()=>i.columns),(e=>{h.value=x(e),f.value=x(e),S(i.modelValue)}),{deep:!0,immediate:!0}),e.watch((()=>i.columnChange),(e=>{e&&R(e)}),{deep:!0,immediate:!0});const{parent:_}=wt(Nt),k=e.computed((()=>_&&i.prop&&_.errorMessages&&_.errorMessages[i.prop]?_.errorMessages[i.prop]:"")),E=e.computed((()=>{let e=!1;if(_&&_.props.rules){const t=_.props.rules;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n===i.prop&&Array.isArray(t[n])&&(e=t[n].some((e=>e.required)))}return i.required||i.rules.some((e=>e.required))||e})),{proxy:T}=e.getCurrentInstance();function S(t){N(t)&&t.length>0||C(t)&&!N(t)&&""!==t?s.value?e.nextTick((()=>{A(s.value.getSelects())})):A(function(e){const t=wo(i.columns,i.valueKey,i.labelKey);if(0===i.columns.length)return;if(""===e||!C(e)||N(e)&&0===e.length)return;const n=y(e);if(-1===["string","number","boolean","array"].indexOf(n))return[];e=N(e)?e:[e],e=e.slice(0,t.length),0===e.length&&(e=t.map((()=>0)));let o=[];e.forEach(((e,n)=>{let a=t[n].findIndex((t=>t[i.valueKey].toString()===e.toString()));a=-1===a?0:a,o.push(a)}));const a=o.map(((e,n)=>t[n][e]));if(1===a.length)return a[0];return a}(t)):d.value=""}function M(){i.disabled||i.readonly||(r("open"),u.value=!0,p.value=i.modelValue,h.value=f.value)}function w(){u.value=!1,r("cancel");let e=setTimeout((()=>{clearTimeout(e),C(s.value)&&s.value.resetColumns(f.value)}),300)}function b(){if(v.value)return;if(g.value)return void(m.value=!0);const{beforeConfirm:e}=i;e&&R(e)?e(p.value,(e=>{e&&D()}),T.$.exposed):D()}function D(){if(v.value||i.disabled)return void(u.value=!1);const e=s.value.getSelects(),t=s.value.getValues(),n=s.value.getColumnsData();u.value=!1,f.value=x(n),r("update:modelValue",t),A(e),r("confirm",{value:t,selectedItems:e})}function L({value:e}){p.value=e}function A(e){if(N(e)&&!e.length||!e)return;const{valueKey:t,labelKey:n}=i;d.value=(i.displayFormat||I)(e,{valueKey:t,labelKey:n})}function O(){}function P(){g.value=!0}function U(){g.value=!1,m.value&&(m.value=!1,b())}e.onMounted((()=>{S(i.modelValue)})),e.onBeforeMount((()=>{h.value=x(i.columns),f.value=x(i.columns)}));const V=e.computed((()=>i.clearable&&!i.disabled&&!i.readonly&&d.value.length));function B(){const e=N(p.value)?[]:"";r("update:modelValue",e),r("clear")}const G=e.computed((()=>!i.disabled&&!i.readonly&&!V.value));return n({close:function(){w()},open:function(){M()},setLoading:function(e){c.value=e}}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-picker ${t.disabled?"is-disabled":""} ${t.size?"is-"+t.size:""}  ${e.unref(l).border.value?"is-border":""} ${t.alignRight?"is-align-right":""} ${t.error?"is-error":""} ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[e.createElementVNode("view",{class:"wd-picker__field",onClick:M},[t.useDefaultSlot?e.renderSlot(t.$slots,"default",{key:0},void 0,!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-picker__cell"},[t.label||t.useLabelSlot?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-picker__label ${t.customLabelClass}  ${E.value?"is-required":""}`),style:e.normalizeStyle(t.labelWidth?"min-width:"+t.labelWidth+";max-width:"+t.labelWidth+";":"")},[t.label?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.label),1)],64)):e.renderSlot(t.$slots,"label",{key:1},void 0,!0)],6)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-picker__body"},[e.createElementVNode("view",{class:"wd-picker__value-wraper"},[e.createElementVNode("view",{class:e.normalizeClass(`wd-picker__value ${t.ellipsis&&"is-ellipsis"} ${t.customValueClass} ${d.value?"":"wd-picker__placeholder"}`)},e.toDisplayString(d.value?d.value:t.placeholder||e.unref(a)("placeholder")),3),G.value?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-picker__arrow",name:"arrow-right"})):V.value?(e.openBlock(),e.createElementBlock("view",{key:1,onClick:e.withModifiers(B,["stop"])},[e.createVNode(_e,{"custom-class":"wd-picker__clear",name:"error-fill"})])):e.createCommentVNode("",!0)]),k.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-picker__error-message"},e.toDisplayString(k.value),1)):e.createCommentVNode("",!0)])]))]),e.createVNode(So,{modelValue:u.value,"onUpdate:modelValue":n[1]||(n[1]=e=>u.value=e),position:"bottom","hide-when-close":!1,"close-on-click-modal":t.closeOnClickModal,"z-index":t.zIndex,"safe-area-inset-bottom":t.safeAreaInsetBottom,onClose:w,"custom-class":"wd-picker__popup"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"wd-picker__wraper"},[e.createElementVNode("view",{class:"wd-picker__toolbar",onTouchmove:O},[e.createElementVNode("view",{class:"wd-picker__action wd-picker__action--cancel",onClick:w},e.toDisplayString(t.cancelButtonText||e.unref(a)("cancel")),1),t.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-picker__title"},e.toDisplayString(t.title),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass("wd-picker__action "+(v.value?"is-loading":"")),onClick:b},e.toDisplayString(t.confirmButtonText||e.unref(a)("done")),3)],32),e.createVNode(bo,{ref_key:"pickerViewWd",ref:s,"custom-class":t.customViewClass,modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=e=>p.value=e),columns:h.value,loading:v.value,"loading-color":t.loadingColor,"columns-height":t.columnsHeight,"value-key":t.valueKey,"label-key":t.labelKey,"immediate-change":t.immediateChange,onChange:L,onPickstart:P,onPickend:U,"column-change":t.columnChange},null,8,["custom-class","modelValue","columns","loading","loading-color","columns-height","value-key","label-key","immediate-change","column-change"])])])),_:1},8,["modelValue","close-on-click-modal","z-index","safe-area-inset-bottom"])],6))}})),[["__scopeId","data-v-7de1ae2d"]]);function Ro(e,t){const n=[],o=new Date(e);if("time"===t){const t=String(e).split(":");n.push(parseInt(t[0]),parseInt(t[1]))}else n.push(o.getFullYear(),o.getMonth()+1),"date"===t?n.push(o.getDate()):"datetime"===t&&n.push(o.getDate(),o.getHours(),o.getMinutes());return n}const Lo=__spreadProps(__spreadValues({},X),{modelValue:K([String,Number]),loading:$(!1),loadingColor:J("#4D80F0"),columnsHeight:W(217),valueKey:J("value"),labelKey:J("label"),type:J("datetime"),filter:Function,formatter:Function,columnFormatter:Function,minDate:W(new Date((new Date).getFullYear()-10,0,1).getTime()),maxDate:W(new Date((new Date).getFullYear()+10,11,31).getTime()),minHour:W(0),maxHour:W(23),minMinute:W(0),maxMinute:W(59),immediateChange:$(!1),startSymbol:$(!1)}),Ao=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-datetime-picker-view",virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}),{props:Lo,emits:["change","pickstart","pickend","update:modelValue"],setup(t,{expose:n,emit:o}){const a=(e,t)=>32-new Date(e,t-1,32).getDate(),i=t,r=o,s=e.ref(),l=e.ref(null),c=e.ref([]),u=e.ref([]),d=e.ref(!1),{proxy:p}=e.getCurrentInstance();n(__spreadValues({updateColumns:g,setColumns:function(e){c.value=e},getSelects:function(){var e;const t=null==(e=s.value)?void 0:e.getSelects();return null==t?void 0:N(t)?t:[t]},correctValue:v,getPickerValue:Ro,getOriginColumns:m},i));const h=G((()=>{if(!d.value)return;const e=v(i.modelValue);e===l.value?c.value=g():y(e)}),50);function f({value:e}){u.value=e;const t=function(){var e;const{type:t}=i;let n="";const o=(null==(e=s.value)?void 0:e.getValues())||[],r=N(o)?o:[o];if("time"===t)return n=`${w(r[0])}:${w(r[1])}`,n;const l=r[0]&&parseInt(r[0]),c="year"===t?1:r[1]&&parseInt(r[1]),u=a(Number(l),Number(c));let d=1;"year-month"!==t&&"year"!==t&&(d=(Number(r[2])&&parseInt(String(r[2])))>u?u:r[2]&&parseInt(String(r[2])));let p=0,h=0;"datetime"===t&&(p=Number(r[3])&&parseInt(r[3]),h=Number(r[4])&&parseInt(r[4]));const f=new Date(Number(l),Number(c)-1,Number(d),p,h).getTime();return n=v(f),n}();r("update:modelValue",t),r("change",{value:t,picker:p.$.exposed})}function g(){const{formatter:e,columnFormatter:t}=i;return t?t(p.$.exposed):m().map((t=>t.values.map((n=>({label:e?e(t.type,w(n)):w(n),value:n})))))}function m(){const{filter:e}=i;return function(){if("time"===i.type)return[{type:"hour",range:[i.minHour,i.maxHour]},{type:"minute",range:[i.minMinute,i.maxMinute]}];const{maxYear:e,maxDate:t,maxMonth:n,maxHour:o,maxMinute:a}=_("max",l.value),{minYear:r,minDate:s,minMonth:c,minHour:u,minMinute:d}=_("min",l.value),p=[{type:"year",range:[r,e]},{type:"month",range:[c,n]},{type:"date",range:[s,t]},{type:"hour",range:[u,o]},{type:"minute",range:[d,a]}];"date"===i.type&&p.splice(3,2);"year-month"===i.type&&p.splice(2,3);"year"===i.type&&p.splice(1,4);return p}().map((({type:t,range:n})=>{let o=((e,t)=>{let n=-1;const o=Array(e<0?0:e);for(;++n<e;)o[n]=t(n);return o})(n[1]-n[0]+1,(e=>n[0]+e));return e&&(o=e(t,o)),{type:t,values:o}}))}function v(e){const t="time"!==i.type;var n;if(t&&(!C(n=e)||Number.isNaN(n))?e=i.minDate:t||e||(e=`${w(i.minHour)}:00`),!t){let[t,n]=e.split(":");return t=w(S(Number(t),i.minHour,i.maxHour)),n=w(S(Number(n),i.minMinute,i.maxMinute)),`${t}:${n}`}return e=Math.min(Math.max(Number(e),i.minDate),i.maxDate)}function _(e,t){const n=new Date(t),o=new Date(i[`${e}Date`]),r=o.getFullYear();let s=1,l=1,c=0,u=0;return"max"===e&&(s=12,l=a(n.getFullYear(),n.getMonth()+1),c=23,u=59),n.getFullYear()===r&&(s=o.getMonth()+1,n.getMonth()+1===s&&(l=o.getDate(),n.getDate()===l&&(c=o.getHours(),n.getHours()===c&&(u=o.getMinutes())))),{[`${e}Year`]:r,[`${e}Month`]:s,[`${e}Date`]:l,[`${e}Hour`]:c,[`${e}Minute`]:u}}function y(e){const t=Ro(e,i.type);i.modelValue!==e&&(r("update:modelValue",e),r("change",{value:e,picker:p.$.exposed})),l.value=e,c.value=g(),u.value=t}function I(e){if("time"===i.type||"year-month"===i.type||"year"===i.type)return;const t=e.getValues(),n=Number(t[0]),o=Number(t[1]),r=a(n,o);let s=Number(t[2]);s=s>r?r:s;let c=0,u=0;"datetime"===i.type&&(c=Number(t[3]),u=Number(t[4]));const d=new Date(n,o-1,s,c,u).getTime();l.value=v(d);const p=g(),h=e.getSelectedIndex().slice(0);p.forEach(((t,n)=>{const o=n+1,a=p[o];o>p.length-1||e.setColumnData(o,a,h[o]<=a.length-1?h[o]:0)}))}function k(){r("pickstart")}function E(){r("pickend")}return e.watch((()=>i.modelValue),((e,t)=>{if(e===t)return;y(v(e))}),{deep:!0,immediate:!0}),e.watch((()=>i.type),(e=>{["date","year-month","time","datetime","year"].indexOf(e),h()}),{deep:!0,immediate:!0}),e.watch((()=>i.filter),(e=>{e&&R(e),h()}),{deep:!0,immediate:!0}),e.watch((()=>i.formatter),(e=>{e&&R(e),h()}),{deep:!0,immediate:!0}),e.watch((()=>i.columnFormatter),(e=>{e&&R(e),h()}),{deep:!0,immediate:!0}),e.watch([()=>i.minDate,()=>i.maxDate,()=>i.minHour,()=>i.maxHour,()=>i.minMinute,()=>i.minMinute,()=>i.maxMinute],(()=>{h()}),{deep:!0,immediate:!0}),e.onBeforeMount((()=>{d.value=!0;y(v(i.modelValue))})),(t,n)=>(e.openBlock(),e.createElementBlock("view",null,[e.createVNode(bo,{ref_key:"datePickerview",ref:s,"custom-class":t.customClass,"custom-style":t.customStyle,"immediate-change":t.immediateChange,modelValue:u.value,"onUpdate:modelValue":n[0]||(n[0]=e=>u.value=e),columns:c.value,"columns-height":t.columnsHeight,columnChange:I,loading:t.loading,"loading-color":t.loadingColor,onChange:f,onPickstart:k,onPickend:E},null,8,["custom-class","custom-style","immediate-change","modelValue","columns","columns-height","loading","loading-color"])]))}})),[["__scopeId","data-v-c82f34ec"]]),Oo=__spreadProps(__spreadValues({},X),{label:String,placeholder:String,disabled:$(!1),readonly:$(!1),loading:$(!1),loadingColor:J("#4D80F0"),title:String,cancelButtonText:String,confirmButtonText:String,required:$(!1),size:String,labelWidth:J("33%"),useDefaultSlot:$(!1),useLabelSlot:$(!1),error:$(!1),alignRight:$(!1),closeOnClickModal:$(!0),safeAreaInsetBottom:$(!0),ellipsis:$(!1),columnsHeight:W(217),valueKey:J("value"),labelKey:J("label"),modelValue:K([String,Number,Array]),type:J("datetime"),minDate:W(new Date((new Date).getFullYear()-10,0,1).getTime()),maxDate:W(new Date((new Date).getFullYear()+10,11,31,23,59,59).getTime()),minHour:W(0),maxHour:W(23),minMinute:W(0),maxMinute:W(59),filter:Function,formatter:Function,displayFormat:Function,beforeConfirm:Function,displayFormatTabLabel:Function,defaultValue:[String,Number,Array],zIndex:W(15),prop:String,rules:Y(),customCellClass:J(""),customViewClass:J(""),customLabelClass:J(""),customValueClass:J(""),immediateChange:$(!1)}),Po=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-datetime-picker",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Oo,emits:["change","open","toggle","cancel","confirm","update:modelValue"],setup(t,{expose:n,emit:o}){const a=t,i=o,{translate:r}=Pt("datetime-picker"),s=e.ref(),l=e.ref(),c=e.ref(""),u=e.ref(!1),d=e.ref(!0),p=e.ref(!1),h=e.ref([]),f=e.ref(""),g=e.ref(""),m=e.ref(!1),v=e.ref(!1),_=e.ref(!1),{proxy:y}=e.getCurrentInstance(),I=Dt();e.watch((()=>a.modelValue),((t,n)=>{M(t,n)||(N(t)?(p.value=!0,f.value=x(L(!0)),g.value=x(L(!0,!0))):f.value=x(L()),e.nextTick((()=>{j(!1,!1,!0)})))}),{deep:!0,immediate:!0}),e.watch((()=>a.displayFormat),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.filter),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.formatter),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.beforeConfirm),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.displayFormatTabLabel),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.defaultValue),(e=>{N(e)||p.value?(f.value=x(L(!0)),g.value=x(L(!0,!0))):f.value=x(L())}),{deep:!0,immediate:!0});const{parent:k}=wt(Nt),E=e.computed((()=>k&&a.prop&&k.errorMessages&&k.errorMessages[a.prop]?k.errorMessages[a.prop]:"")),T=e.computed((()=>{let e=!1;if(k&&k.props.rules){const t=k.props.rules;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n===a.prop&&Array.isArray(t[n])&&(e=t[n].some((e=>e.required)))}return a.required||a.rules.some((e=>e.required))||e})),S=e=>{if(!e)return[];const{type:t}=a,{startSymbol:n,formatter:o}=e,i=e.correctValue(f.value),r=e.correctValue(g.value),s=n?e.getPickerValue(i,t):e.getPickerValue(r,t),l=n?e.getPickerValue(r,t):e.getPickerValue(i,t),c=e.getOriginColumns();return c.map(((e,t)=>e.values.map((i=>{const r=function(e,t,n,o,i,r){const{type:s}=a,l=t[n];if("datetime"===s){const t=r[0],n=r[1],a=r[2],s=r[3],c=r[4];if("year"===l.type)return e?o>t:o<t;if("month"===l.type&&i[0]===t)return e?o>n:o<n;if("date"===l.type&&i[0]===t&&i[1]===n)return e?o>a:o<a;if("hour"===l.type&&i[0]===t&&i[1]===n&&i[2]===a)return e?o>s:o<s;if("minute"===l.type&&i[0]===t&&i[1]===n&&i[2]===a&&i[3]===s)return e?o>c:o<c}else if("year-month"===s){const t=r[0],n=r[1];if("year"===l.type)return e?o>t:o<t;if("month"===l.type&&i[0]===t)return e?o>n:o<n}else if("year"===s){const t=r[0];if("year"===l.type)return e?o>t:o<t}else if("date"===s){const t=r[0],n=r[1],a=r[2];if("year"===l.type)return e?o>t:o<t;if("month"===l.type&&i[0]===t)return e?o>n:o<n;if("date"===l.type&&i[0]===t&&i[1]===n)return e?o>a:o<a}else if("time"===s){const t=r[0],n=r[1];if("hour"===l.type)return e?o>t:o<t;if("minute"===l.type&&i[0]===t)return e?o>n:o<n}return!1}(n,c,t,i,s,l);return{label:o?o(e.type,w(i)):w(i),value:i,disabled:r}}))))};function b(e){let t="before"===e?f.value:g.value,n=[];return t&&(n=Ro(t,a.type)),n.map((e=>({[a.labelKey]:w(e),[a.valueKey]:e})))}function D(){}function L(e,t){const{modelValue:n,defaultValue:o,maxDate:i,minDate:r,type:s}=a;if(e){const e=t?1:0,a=N(n)?n[e]:"",l=N(o)?o[e]:"",c="time"===s?ge(i).format("HH:mm"):i,u="time"===s?ge(r).format("HH:mm"):r;return a||l||(t?c:u)}return C(n||o)?n||o:""}function A(){a.disabled||a.readonly||(i("open"),p.value?(u.value=!0,d.value=!0,f.value=x(L(!0,!1)),g.value=x(L(!0,!0))):(u.value=!0,f.value=x(L())),j(!0,!1,!0))}function O(){d.value=!d.value;const e=d.value?s.value:l.value;e.setColumns(e.updateColumns()),i("toggle",d.value?f.value:g.value)}function P({value:e}){f.value=x(e),p.value?(h.value=[H(),x(h.value[1])],i("change",{value:[e,g.value]}),s.value&&s.value.setColumns(s.value.updateColumns()),l.value&&l.value.setColumns(l.value.updateColumns())):i("change",{value:f.value})}function U({value:e}){g.value=x(e),h.value=[x(h.value[0]),H(1)],i("change",{value:[f.value,e]}),s.value&&s.value.setColumns(s.value.updateColumns()),l.value&&l.value.setColumns(l.value.updateColumns())}function V(){u.value=!1,setTimeout((()=>{p.value?(f.value=x(L(!0)),g.value=x(L(!0,!0))):f.value=x(L())}),200),i("cancel")}function B(){if(a.loading||_.value)return;if(m.value)return void(v.value=!0);const{beforeConfirm:e}=a;e?e(p.value?[f.value,g.value]:f.value,(e=>{e&&z()}),y.$.exposed):z()}function G(){m.value=!0}function F(){m.value=!1,setTimeout((()=>{v.value&&(v.value=!1,B())}),50)}function z(){if(a.loading||_.value||a.disabled)return void(u.value=!1);const e=p.value?[f.value,g.value]:f.value;u.value=!1,i("update:modelValue",e),i("confirm",{value:e}),j(!1,!0)}function H(e=0){if(p.value){let t=[];return t=0===e?(s.value?s.value.getSelects():void 0)||f.value&&b("before"):(l.value?l.value.getSelects():void 0)||g.value&&b("after"),q(t,!0)}return""}function j(e=!1,t=!1,n=!1){if(p.value){const o=n?f.value&&b("before")||[]:s.value&&s.value.getSelects&&s.value.getSelects()||[],i=n?g.value&&b("after")||[]:l.value&&l.value.getSelects&&l.value.getSelects()||[];c.value=e?c.value:[a.modelValue[0]||t?q(o):"",a.modelValue[1]||t?q(i):""],h.value=[q(o,!0),q(i,!0)]}else{const e=n?f.value&&b("before")||[]:s.value&&s.value.getSelects&&s.value.getSelects()||[];c.value=x(a.modelValue||t?q(e):"")}}function q(e,t=!1){if(0===e.length)return"";if(t&&a.displayFormatTabLabel)return a.displayFormatTabLabel(e);if(a.displayFormat)return a.displayFormat(e);if(a.formatter){const t={year:["year"],datetime:["year","month","date","hour","minute"],date:["year","month","date"],time:["hour","minute"],"year-month":["year","month"]};return e.map(((e,n)=>a.formatter(t[a.type][n],e.value))).join("")}switch(a.type){case"year":return e[0].label;case"date":return`${e[0].label}-${e[1].label}-${e[2].label}`;case"year-month":return`${e[0].label}-${e[1].label}`;case"time":return`${e[0].label}:${e[1].label}`;case"datetime":return`${e[0].label}-${e[1].label}-${e[2].label} ${e[3].label}:${e[4].label}`}}return e.onBeforeMount((()=>{const{modelValue:e}=a;N(e)?(p.value=!0,f.value=x(L(!0)),g.value=x(L(!0,!0))):f.value=x(L())})),e.onMounted((()=>{j(!1,!1,!0)})),n({open:function(){A()},close:function(){V()},setLoading:function(e){_.value=e}}),(t,n)=>{const o=ae(e.resolveDynamicComponent("wd-icon"),_e);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-picker ${t.disabled?"is-disabled":""} ${t.size?"is-"+t.size:""}  ${e.unref(I).border.value?"is-border":""} ${t.alignRight?"is-align-right":""} ${t.error?"is-error":""} ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[e.createElementVNode("view",{class:"wd-picker__field",onClick:A},[t.useDefaultSlot?e.renderSlot(t.$slots,"default",{key:0},void 0,!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(["wd-picker__cell",t.customCellClass])},[t.label||t.useLabelSlot?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-picker__label ${t.customLabelClass} ${T.value?"is-required":""}`),style:e.normalizeStyle(t.labelWidth?"min-width:"+t.labelWidth+";max-width:"+t.labelWidth+";":"")},[t.label?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.label),1)],64)):e.renderSlot(t.$slots,"label",{key:1},void 0,!0)],6)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-picker__body"},[e.createElementVNode("view",{class:"wd-picker__value-wraper"},[e.createElementVNode("view",{class:e.normalizeClass(`wd-picker__value ${t.customValueClass}`)},[p.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(N)(c.value)?(e.openBlock(),e.createElementBlock("view",{key:0},[e.createElementVNode("text",{class:e.normalizeClass(c.value[0]?"":"wd-picker__placeholder")},e.toDisplayString(c.value[0]?c.value[0]:t.placeholder||e.unref(r)("placeholder")),3),e.createTextVNode(" "+e.toDisplayString(e.unref(r)("to"))+" ",1),e.createElementVNode("text",{class:e.normalizeClass(c.value[1]?"":"wd-picker__placeholder")},e.toDisplayString(c.value[1]?c.value[1]:t.placeholder||e.unref(r)("placeholder")),3)])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-picker__placeholder"},e.toDisplayString(t.placeholder||e.unref(r)("placeholder")),1))],64)):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(c.value?"":"wd-picker__placeholder")},e.toDisplayString(c.value?c.value:t.placeholder||e.unref(r)("placeholder")),3))],2),t.disabled||t.readonly?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(o,{key:0,"custom-class":"wd-picker__arrow",name:"arrow-right"}))]),E.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-picker__error-message"},e.toDisplayString(E.value),1)):e.createCommentVNode("",!0)])],2))]),e.createVNode(So,{modelValue:u.value,"onUpdate:modelValue":n[2]||(n[2]=e=>u.value=e),position:"bottom","hide-when-close":!1,"close-on-click-modal":t.closeOnClickModal,"safe-area-inset-bottom":t.safeAreaInsetBottom,"z-index":t.zIndex,onClose:V,"custom-class":"wd-picker__popup"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"wd-picker__wraper"},[e.createElementVNode("view",{class:"wd-picker__toolbar",onTouchmove:D},[e.createElementVNode("view",{class:"wd-picker__action wd-picker__action--cancel",onClick:V},e.toDisplayString(t.cancelButtonText||e.unref(r)("cancel")),1),t.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-picker__title"},e.toDisplayString(t.title),1)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass("wd-picker__action "+(t.loading||_.value?"is-loading":"")),onClick:B},e.toDisplayString(t.confirmButtonText||e.unref(r)("confirm")),3)],32),p.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-picker__region-tabs"},[e.createElementVNode("view",{class:e.normalizeClass(`wd-picker__region ${d.value?"is-active":""} `),onClick:O},[e.createElementVNode("view",null,e.toDisplayString(e.unref(r)("start")),1),e.createElementVNode("view",{class:"wd-picker__region-time"},e.toDisplayString(h.value[0]),1)],2),e.createElementVNode("view",{class:e.normalizeClass("wd-picker__region "+(d.value?"":"is-active")),onClick:O},[e.createElementVNode("view",null,e.toDisplayString(e.unref(r)("end")),1),e.createElementVNode("view",{class:"wd-picker__region-time"},e.toDisplayString(h.value[1]),1)],2)])):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(d.value?"wd-picker__show":"wd-picker__hidden")},[e.createVNode(Ao,{"custom-class":t.customViewClass,ref_key:"datetimePickerView",ref:s,type:t.type,modelValue:f.value,"onUpdate:modelValue":n[0]||(n[0]=e=>f.value=e),loading:t.loading||_.value,"loading-color":t.loadingColor,"columns-height":t.columnsHeight,"value-key":t.valueKey,"label-key":t.labelKey,formatter:t.formatter,filter:t.filter,"column-formatter":e.unref(N)(t.modelValue)?S:void 0,"max-hour":t.maxHour,"min-hour":t.minHour,"max-date":t.maxDate,"min-date":t.minDate,"max-minute":t.maxMinute,"min-minute":t.minMinute,"start-symbol":!0,"immediate-change":t.immediateChange,onChange:P,onPickstart:G,onPickend:F},null,8,["custom-class","type","modelValue","loading","loading-color","columns-height","value-key","label-key","formatter","filter","column-formatter","max-hour","min-hour","max-date","min-date","max-minute","min-minute","immediate-change"])],2),e.createElementVNode("view",{class:e.normalizeClass(d.value?"wd-picker__hidden":"wd-picker__show")},[e.createVNode(Ao,{"custom-class":t.customViewClass,ref_key:"datetimePickerView1",ref:l,type:t.type,modelValue:g.value,"onUpdate:modelValue":n[1]||(n[1]=e=>g.value=e),loading:t.loading||_.value,"loading-color":t.loadingColor,"columns-height":t.columnsHeight,"value-key":t.valueKey,"label-key":t.labelKey,formatter:t.formatter,filter:t.filter,"column-formatter":e.unref(N)(t.modelValue)?S:void 0,"max-hour":t.maxHour,"min-hour":t.minHour,"max-date":t.maxDate,"min-date":t.minDate,"max-minute":t.maxMinute,"min-minute":t.minMinute,"start-symbol":!1,"immediate-change":t.immediateChange,onChange:U,onPickstart:G,onPickend:F},null,8,["custom-class","type","modelValue","loading","loading-color","columns-height","value-key","label-key","formatter","filter","column-formatter","max-hour","min-hour","max-date","min-date","max-minute","min-minute","immediate-change"])],2)])])),_:1},8,["modelValue","close-on-click-modal","safe-area-inset-bottom","z-index"])],6)}}})),[["__scopeId","data-v-8e276261"]]),Uo=__spreadProps(__spreadValues({},X),{customHeaderClass:J(""),modelValue:__spreadValues(__spreadValues({},$(!1)),K(Boolean)),actions:Y(),panels:Y(),title:String,cancelText:String,closeOnClickAction:$(!0),closeOnClickModal:$(!0),duration:W(200),zIndex:W(10),lazyRender:$(!0),safeAreaInsetBottom:$(!0)}),xo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-action-sheet",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Uo,emits:["select","click-modal","cancel","closed","close","open","opened","update:modelValue"],setup(t,{emit:n}){const o=t,a=n,i=e.ref([]),r=e.ref(!1);function s(){return o.panels.length&&!N(o.panels[0])}function l(e,t,n){if("action"===t){if(o.actions[e].disabled||o.actions[e].loading)return;a("select",{item:o.actions[e],index:e})}else s()?a("select",{item:o.panels[Number(n)],index:n}):a("select",{item:o.panels[e][Number(n)],rowIndex:e,colIndex:n});o.closeOnClickAction&&d()}function c(){a("click-modal")}function u(){a("cancel"),d()}function d(){a("update:modelValue",!1),a("close")}function p(){a("open")}function h(){a("opened")}function f(){a("closed")}return e.watch((()=>o.panels),(function(){i.value=s()?[o.panels]:o.panels}),{deep:!0,immediate:!0}),e.watch((()=>o.modelValue),(e=>{r.value=e}),{deep:!0,immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("view",null,[e.createVNode(So,{"custom-class":"wd-action-sheet__popup","custom-style":""+(t.actions&&t.actions.length||t.panels&&t.panels.length?"background: transparent;":""),modelValue:r.value,"onUpdate:modelValue":n[0]||(n[0]=e=>r.value=e),duration:t.duration,position:"bottom","close-on-click-modal":t.closeOnClickModal,"safe-area-inset-bottom":t.safeAreaInsetBottom,"lazy-render":t.lazyRender,onEnter:p,onClose:d,onAfterEnter:h,onAfterLeave:f,onClickModal:c,"z-index":t.zIndex},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(`wd-action-sheet ${t.customClass}`),style:e.normalizeStyle(`${t.actions&&t.actions.length||t.panels&&t.panels.length?"margin: 0 10px calc(var(--window-bottom) + 10px) 10px; border-radius: 16px;":"margin-bottom: var(--window-bottom);"} ${t.customStyle}`)},[t.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-action-sheet__header ${t.customHeaderClass}`)},[e.createTextVNode(e.toDisplayString(t.title)+" ",1),e.createVNode(_e,{"custom-class":"wd-action-sheet__close",name:"add",onClick:d})],2)):e.createCommentVNode("",!0),t.actions&&t.actions.length?(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-action-sheet__actions"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.actions,((t,n)=>(e.openBlock(),e.createElementBlock("button",{key:n,class:e.normalizeClass(`wd-action-sheet__action ${t.disabled?"wd-action-sheet__action--disabled":""}  ${t.loading?"wd-action-sheet__action--loading":""}`),style:e.normalizeStyle(`color: ${t.color}`),onClick:e=>l(n,"action")},[t.loading?(e.openBlock(),e.createBlock(uo,{key:0,"custom-class":"`wd-action-sheet__action-loading"})):(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-action-sheet__name"},e.toDisplayString(t.name),1)),!t.loading&&t.subname?(e.openBlock(),e.createElementBlock("view",{key:2,class:"wd-action-sheet__subname"},e.toDisplayString(t.subname),1)):e.createCommentVNode("",!0)],14,["onClick"])))),128))])):e.createCommentVNode("",!0),i.value&&i.value.length?(e.openBlock(),e.createElementBlock("view",{key:2},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:"wd-action-sheet__panels"},[e.createElementVNode("view",{class:"wd-action-sheet__panels-content"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:"wd-action-sheet__panel",onClick:e=>l(n,"panels",o)},[e.createElementVNode("image",{class:"wd-action-sheet__panel-img",src:t.iconUrl},null,8,["src"]),e.createElementVNode("view",{class:"wd-action-sheet__panel-title"},e.toDisplayString(t.title),1)],8,["onClick"])))),128))])])))),128))])):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"default",{},void 0,!0),t.cancelText?(e.openBlock(),e.createElementBlock("button",{key:3,class:"wd-action-sheet__cancel",onClick:u},e.toDisplayString(t.cancelText),1)):e.createCommentVNode("",!0)],6)])),_:3},8,["custom-style","modelValue","duration","close-on-click-modal","safe-area-inset-bottom","lazy-render","z-index"])]))}})),[["__scopeId","data-v-04c084fb"]]),Vo=__spreadProps(__spreadValues({},X),{modelValue:K(Array),columns:Y(),label:String,labelWidth:J("33%"),useLabelSlot:$(!1),useDefaultSlot:$(!1),disabled:$(!1),readonly:$(!1),placeholder:String,title:String,columnChange:Function,displayFormat:Function,beforeConfirm:Function,alignRight:$(!1),error:$(!1),required:$(!1),size:String,valueKey:J("value"),labelKey:J("label"),tipKey:J("tip"),loadingColor:J("#4D80F0"),closeOnClickModal:$(!0),autoComplete:$(!1),zIndex:W(15),safeAreaInsetBottom:$(!0),ellipsis:$(!1),prop:String,rules:Y(),lineWidth:q,lineHeight:q,customViewClass:J(""),customLabelClass:J(""),customValueClass:J("")}),Bo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-col-picker",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Vo,emits:["close","update:modelValue","confirm"],setup(t,{expose:n,emit:o}){const{translate:a}=Pt("col-picker"),i=".wd-col-picker__selected-container",r=".wd-col-picker__selected-item",s=t,l=o,c=e.ref(!1),u=e.ref(0),d=e.ref([]),p=e.ref([]),h=e.ref([]),f=e.ref(!1),g=e.ref(!1),m=e.ref([]),_=e.ref([]),y=e.ref(0),I=e.ref(!1),k=e.ref(!1),E=e.reactive({lineStyle:"display:none;"}),{proxy:T}=e.getCurrentInstance(),S=Dt(),M=G((function(e=!0){!function(e=!0){if(!I.value)return;const{lineWidth:t,lineHeight:n}=s;D(r,!0,T).then((o=>{const a={};C(t)&&(a.width=v(t)),C(n)&&(a.height=v(n),a.borderRadius=`calc(${v(n)} / 2)`);const i=o[u.value];let r=o.slice(0,u.value).reduce(((e,t)=>e+Number(t.width)),0)+Number(i.width)/2;a.transform=`translateX(${r}px) translateX(-50%)`,e&&(a.transition="width 300ms ease, transform 300ms ease"),E.lineStyle=P(a)})).catch((()=>{}))}(e),function(){if(!I.value)return;Promise.all([D(r,!0,T),D(i,!1,T)]).then((([e,t])=>{if(!N(e)||0===e.length)return;const n=e[u.value],o=e.slice(0,u.value).reduce(((e,t)=>e+Number(t.width)),0);y.value=o-(t.width-Number(n.width))/2})).catch((()=>{}))}()}),50),w=e.computed((()=>{const e=(s.modelValue||[]).map(((e,t)=>B(e,t,d.value)));return s.displayFormat?s.displayFormat(e):e.map((e=>e[s.labelKey])).join("")}));e.watch((()=>s.modelValue),(e=>{e!==p.value&&(p.value=e,e.map(((e,t)=>B(e,t,d.value)[s.labelKey])),function(){if(s.autoComplete&&(d.value.length<s.modelValue.length||0===d.value.length)){if(!k.value){H(0===d.value.length?-1:d.value.length-1)}k.value=!0}}())}),{deep:!0,immediate:!0}),e.watch((()=>s.columns),((e,t)=>{if(e.length&&!N(e[0]))return;if(0===e.length&&!t)return;const n=e.slice(0);d.value=n,h.value=p.value.map(((e,t)=>B(e,t,n)[s.labelKey])),m.value=n,n.length>0&&(u.value=n.length-1)}),{deep:!0,immediate:!0}),e.watch((()=>s.columnChange),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>s.displayFormat),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>s.beforeConfirm),(e=>{e&&R(e)}),{deep:!0,immediate:!0});const{parent:b}=wt(Nt),L=e.computed((()=>b&&s.prop&&b.errorMessages&&b.errorMessages[s.prop]?b.errorMessages[s.prop]:"")),A=e.computed((()=>{let e=!1;if(b&&b.props.rules){const t=b.props.rules;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n===s.prop&&Array.isArray(t[n])&&(e=t[n].some((e=>e.required)))}return s.required||s.rules.some((e=>e.required))||e}));function O(){M(!1)}function U(){c.value=!1,l("close")}function x(){g.value&&setTimeout((()=>{d.value=m.value.slice(0),p.value=_.value.slice(0),h.value=_.value.map(((e,t)=>B(e,t,m.value)[s.labelKey])),u.value=m.value.length-1,g.value=!1}),250)}function V(){const{disabled:e,readonly:t}=s;e||t||(c.value=!0,_.value=p.value.slice(0),m.value=d.value.slice(0))}function B(e,t,n){const{valueKey:o,labelKey:a}=s;if(n[t]){const a=n[t].filter((t=>t[o]===e));if(a.length>0)return a[0]}return{[o]:e,[a]:""}}function F(e,t,n,o){f.value=!0;const{columnChange:a,beforeConfirm:i}=s;a&&a({selectedItem:t,index:e,rowIndex:n,resolve:t=>{if(!N(t))return;const n=d.value.slice(0);n[e+1]=t,d.value=n,f.value=!1,u.value=e+1,M(!0),"function"==typeof o&&(k.value=!1,h.value=p.value.map(((e,t)=>B(e,t,d.value)[s.labelKey])),o())},finish:e=>{if("function"==typeof o)return f.value=!1,void(k.value=!1);"boolean"!=typeof e||e?i?i(p.value,p.value.map(((e,t)=>B(e,t,d.value))),(e=>{e?z():f.value=!1})):z():f.value=!1}})}function z(){g.value=!1,f.value=!1,c.value=!1,l("update:modelValue",p.value),l("confirm",{value:p.value,selectedItems:p.value.map(((e,t)=>B(e,t,d.value)))})}function H(e){const t=-1===e?{}:{[s.valueKey]:s.modelValue[e]};F(e,t,-1,(()=>{d.value.length<s.modelValue.length&&H(e+1)}))}return e.onMounted((()=>{I.value=!0})),n({close:function(){U()},open:function(){V()}}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-col-picker ${e.unref(S).border.value?"is-border":""} ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[e.createElementVNode("view",{class:"wd-col-picker__field",onClick:V},[t.useDefaultSlot?e.renderSlot(t.$slots,"default",{key:0},void 0,!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(`wd-col-picker__cell ${t.disabled&&"is-disabled"} ${t.readonly&&"is-readonly"} ${t.alignRight&&"is-align-right"} ${t.error&&"is-error"}  ${t.size&&"is-"+t.size}`)},[t.label||t.useLabelSlot?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-col-picker__label ${A.value&&"is-required"} ${t.customLabelClass}`),style:e.normalizeStyle(t.labelWidth?"min-width:"+t.labelWidth+";max-width:"+t.labelWidth+";":"")},[t.label?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.label),1)],64)):e.renderSlot(t.$slots,"label",{key:1},void 0,!0)],6)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-col-picker__body"},[e.createElementVNode("view",{class:"wd-col-picker__value-wraper"},[e.createElementVNode("view",{class:e.normalizeClass(`wd-col-picker__value ${t.ellipsis&&"is-ellipsis"} ${t.customValueClass} ${w.value?"":"wd-col-picker__value--placeholder"}`)},e.toDisplayString(w.value||t.placeholder||e.unref(a)("placeholder")),3),t.disabled||t.readonly?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-col-picker__arrow",name:"arrow-right"}))]),L.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-col-picker__error-message"},e.toDisplayString(L.value),1)):e.createCommentVNode("",!0)])],2))]),e.createVNode(xo,{modelValue:c.value,"onUpdate:modelValue":n[0]||(n[0]=e=>c.value=e),duration:250,title:t.title||e.unref(a)("title"),"close-on-click-modal":t.closeOnClickModal,"z-index":t.zIndex,"safe-area-inset-bottom":t.safeAreaInsetBottom,onOpen:O,onClose:U,onClosed:x},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"wd-col-picker__selected"},[e.createElementVNode("scroll-view",{"scroll-x":!0,"scroll-with-animation":"","scroll-left":y.value},[e.createElementVNode("view",{class:"wd-col-picker__selected-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,class:e.normalizeClass(`wd-col-picker__selected-item  ${n===u.value&&"is-selected"}`),onClick:e=>{return t=n,g.value=!0,u.value=t,void M(!0);var t}},e.toDisplayString(h.value[n]||e.unref(a)("select")),11,["onClick"])))),128)),e.createElementVNode("view",{class:"wd-col-picker__selected-line",style:e.normalizeStyle(E.lineStyle)},null,4)])],8,["scroll-left"])]),e.createElementVNode("view",{class:"wd-col-picker__list-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(d.value,((n,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:"wd-col-picker__list",style:e.normalizeStyle(o===u.value?"display: block;":"display: none;")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n,((n,a)=>(e.openBlock(),e.createElementBlock("view",{key:a,class:e.normalizeClass(`wd-col-picker__list-item ${p.value[o]&&n[t.valueKey]===p.value[o]&&"is-selected"} ${n.disabled&&"is-disabled"}`),onClick:e=>function(e,t){const n=d.value[e][t];if(n.disabled)return;const o=p.value.slice(0,e);o.push(n[s.valueKey]),g.value=!0,p.value=o,d.value=d.value.slice(0,e+1),h.value=o.map(((e,t)=>B(e,t,d.value)[s.labelKey])),h.value[e]&&e===u.value&&M(!0),F(e,n,t)}(o,a)},[e.createElementVNode("view",null,[e.createElementVNode("view",{class:"wd-col-picker__list-item-label"},e.toDisplayString(n[t.labelKey]),1),n[t.tipKey]?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-col-picker__list-item-tip"},e.toDisplayString(n[t.tipKey]),1)):e.createCommentVNode("",!0)]),e.createVNode(_e,{"custom-class":"wd-col-picker__checked",name:"check"})],10,["onClick"])))),128)),f.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-col-picker__loading"},[e.createVNode(uo,{color:t.loadingColor},null,8,["color"])])):e.createCommentVNode("",!0)],4)))),128))])])),_:1},8,["modelValue","title","close-on-click-modal","z-index","safe-area-inset-bottom"])],6))}})),[["__scopeId","data-v-1f575d9c"]]),Go=__spreadProps(__spreadValues({},X),{customInputClass:J(""),modelValue:J(""),useSuffixSlot:$(!1),placeholder:String,cancelTxt:String,light:$(!1),hideCancel:$(!1),disabled:$(!1),maxlength:W(-1),placeholderLeft:$(!1),focus:$(!1),focusWhenClear:$(!1),placeholderStyle:String,placeholderClass:J("")}),Fo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-search",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Go,emits:["update:modelValue","change","clear","search","focus","blur","cancel"],setup(t,{emit:n}){const o=t,a=n,{translate:i}=Pt("search"),r=e.ref(!1),s=e.ref(!1),l=e.ref(""),c=e.ref(!0),u=e.ref(!1);e.watch((()=>o.modelValue),(e=>{l.value=e,e&&(s.value=!0)}),{immediate:!0}),e.watch((()=>o.focus),(e=>{if(e){if(o.disabled)return;f()}})),e.onMounted((()=>{o.focus&&f()}));const d=e.computed((()=>`wd-search  ${o.light?"is-light":""}  ${o.hideCancel?"is-without-cancel":""} ${o.customClass}`)),p=e.computed((()=>P({display:""===l.value&&c.value?"flex":"none"})));function h(e){return __async(this,null,(function*(){s.value=e,yield U(),r.value=e}))}function f(){return __async(this,null,(function*(){o.disabled||(yield U(100),c.value=!1,h(!0))}))}function g(e){l.value=e.detail.value,a("update:modelValue",e.detail.value),a("change",{value:e.detail.value})}function m(){return __async(this,null,(function*(){l.value="",u.value=!0,o.focusWhenClear&&(r.value=!1),yield U(100),o.focusWhenClear?(c.value=!1,h(!0)):(c.value=!0,h(!1)),a("change",{value:""}),a("update:modelValue",""),a("clear")}))}function v({detail:{value:e}}){a("search",{value:e})}function _(){u.value?u.value=!1:(c.value=!1,a("focus",{value:l.value}))}function y(){u.value||(c.value=!l.value,s.value=!c.value,r.value=!1,a("blur",{value:l.value}))}function I(){a("cancel",{value:l.value})}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(d.value),style:e.normalizeStyle(t.customStyle)},[e.createElementVNode("view",{class:"wd-search__block"},[e.renderSlot(t.$slots,"prefix",{},void 0,!0),e.createElementVNode("view",{class:"wd-search__field"},[t.placeholderLeft?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,style:e.normalizeStyle(p.value),class:"wd-search__cover",onClick:f},[e.createVNode(_e,{name:"search","custom-class":"wd-search__search-icon"}),e.createElementVNode("text",{class:e.normalizeClass(`wd-search__placeholder-txt ${t.placeholderClass}`)},e.toDisplayString(t.placeholder||e.unref(i)("search")),3)],4)),s.value||l.value||t.placeholderLeft?(e.openBlock(),e.createBlock(_e,{key:1,name:"search","custom-class":"wd-search__search-left-icon"})):e.createCommentVNode("",!0),s.value||l.value||t.placeholderLeft?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:2,placeholder:t.placeholder||e.unref(i)("search"),"placeholder-class":`wd-search__placeholder-txt ${t.placeholderClass}`,"placeholder-style":t.placeholderStyle,"confirm-type":"search","onUpdate:modelValue":n[0]||(n[0]=e=>l.value=e),class:e.normalizeClass(["wd-search__input",t.customInputClass]),onFocus:_,onInput:g,onBlur:y,onConfirm:v,disabled:t.disabled,maxlength:t.maxlength,focus:r.value},null,42,["placeholder","placeholder-class","placeholder-style","disabled","maxlength","focus"])),[[e.vModelText,l.value]]):e.createCommentVNode("",!0),l.value?(e.openBlock(),e.createBlock(_e,{key:3,"custom-class":"wd-search__clear wd-search__clear-icon",name:"error-fill",onClick:m})):e.createCommentVNode("",!0)])]),t.hideCancel?e.createCommentVNode("",!0):e.renderSlot(t.$slots,"suffix",{key:0},(()=>[e.createElementVNode("view",{class:"wd-search__cancel",onClick:I},e.toDisplayString(t.cancelTxt||e.unref(i)("cancel")),1)]),!0)],6))}})),[["__scopeId","data-v-6bb79eb7"]]),zo=Symbol("wd-checkbox-group"),Ho=__spreadProps(__spreadValues({},X),{modelValue:{type:Array,default:()=>[]},cell:$(!1),shape:J("circle"),checkedColor:String,disabled:$(!1),min:W(0),max:W(0),inline:$(!1),size:String}),jo=__spreadProps(__spreadValues({},X),{customLabelClass:J(""),customShapeClass:J(""),modelValue:{type:[String,Number,Boolean],required:!0,default:!1},shape:{type:String},checkedColor:String,disabled:{type:[Boolean,null],default:null},trueValue:{type:[String,Number,Boolean],default:!0},falseValue:{type:[String,Number,Boolean],default:!1},size:String,maxWidth:String}),qo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-checkbox",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:jo,emits:["change","update:modelValue"],setup(t,{expose:n,emit:o}){const a=t,i=o;n({toggle:_});const{parent:r,index:s}=wt(zo),l=e.computed((()=>r?r.props.modelValue.indexOf(a.modelValue)>-1:a.modelValue===a.trueValue)),c=e.computed((()=>0===s.value)),u=e.computed((()=>{const e=C(r)?r.children:[];return s.value===e.length-1})),{proxy:d}=e.getCurrentInstance();e.watch((()=>a.modelValue),(()=>{r&&r&&r.children&&r.children.forEach((e=>{e.$.uid!==d.$.uid&&(e.modelValue,a.modelValue)}))})),e.watch((()=>a.shape),(e=>{C(e)&&["circle","square","button"].indexOf(e)}));const p=e.computed((()=>a.shape||F(r,"props.shape")||"circle")),h=e.computed((()=>a.checkedColor||F(r,"props.checkedColor"))),f=e.computed((()=>{if(!r)return a.disabled;const{max:e,min:t,modelValue:n,disabled:o}=r.props;return!!(e&&n.length>=e&&!l.value||t&&n.length<=t&&l.value||!0===a.disabled||o&&null===a.disabled)||a.disabled})),g=e.computed((()=>F(r,"props.inline")||!1)),m=e.computed((()=>F(r,"props.cell")||!1)),v=e.computed((()=>a.size||F(r,"props.size")));function _(){if(!f.value)if(r)i("change",{value:!l.value}),r.changeSelectState(a.modelValue);else{const e=a.modelValue===a.trueValue?a.falseValue:a.trueValue;i("update:modelValue",e),i("change",{value:e})}}return e.onBeforeMount((()=>{a.modelValue})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-checkbox ${m.value?"is-cell-box":""} ${"button"===p.value?"is-button-box":""} ${l.value?"is-checked":""} ${c.value?"is-first-child":""} ${u.value?"is-last-child":""} ${g.value?"is-inline":""} ${"button"===p.value?"is-button":""} ${f.value?"is-disabled":""} ${v.value?"is-"+v.value:""} ${t.customClass}`),style:e.normalizeStyle(t.customStyle),onClick:_},["button"!==p.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-checkbox__shape ${"square"===p.value?"is-square":""} ${t.customShapeClass}`),style:e.normalizeStyle(l.value&&!f.value&&h.value?"color :"+h.value:"")},[e.createVNode(_e,{"custom-class":"wd-checkbox__check",name:"check-bold"})],6)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(`wd-checkbox__label ${t.customLabelClass}`),style:e.normalizeStyle(l.value&&"button"===p.value&&!f.value&&h.value?"color:"+h.value:"")},["button"===p.value&&l.value?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-checkbox__btn-check",name:"check-bold"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-checkbox__txt",style:e.normalizeStyle(t.maxWidth?"max-width:"+t.maxWidth:"")},[e.renderSlot(t.$slots,"default",{},void 0,!0)],4)],6)],6))}})),[["__scopeId","data-v-92af0321"]]),Ko=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-checkbox-group",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Ho,emits:["change","update:modelValue"],setup(t,{emit:n}){const o=t,a=n,{linkChildren:i}=Co(zo);return i({props:o,changeSelectState:function(e){const t=x(o.modelValue),n=t.indexOf(e);n>-1?t.splice(n,1):t.push(e);a("update:modelValue",t),a("change",{value:t})}}),e.watch((()=>o.modelValue),(e=>{new Set(e).size,e.length,e.length,o.min,0!==o.max&&(e.length,o.max)}),{deep:!0,immediate:!0}),e.watch((()=>o.shape),(e=>{["circle","square","button"].indexOf(e)}),{deep:!0,immediate:!0}),e.watch((()=>o.min),(e=>{k(e,"min")}),{deep:!0,immediate:!0}),e.watch((()=>o.max),(e=>{k(e,"max")}),{deep:!0,immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-checkbox-group ${"button"===t.shape&&t.cell?"is-button":""} ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6))}})),[["__scopeId","data-v-1de25cbc"]]),Yo=Symbol("wd-radio-group"),$o=__spreadProps(__spreadValues({},X),{modelValue:[String,Number,Boolean],shape:J("check"),checkedColor:String,disabled:$(!1),cell:$(!1),size:J(""),inline:$(!1),iconPlacement:J("auto")}),Wo=__spreadProps(__spreadValues({},X),{value:K([String,Number,Boolean]),shape:String,checkedColor:String,disabled:{type:[Boolean,null],default:null},cell:{type:[Boolean,null],default:null},size:String,inline:{type:[Boolean,null],default:null},maxWidth:String,iconPlacement:{type:String}}),Zo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-radio",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Wo,setup(t){const n=t,{parent:o}=wt(Yo),a=e.computed((()=>!!o&&n.value===o.props.modelValue)),i=e.computed((()=>n.shape||F(o,"props.shape"))),r=e.computed((()=>n.checkedColor||F(o,"props.checkedColor"))),s=e.computed((()=>C(n.disabled)?n.disabled:F(o,"props.disabled"))),l=e.computed((()=>C(n.inline)?n.inline:F(o,"props.inline"))),c=e.computed((()=>n.size||F(o,"props.size"))),u=e.computed((()=>C(n.cell)?n.cell:F(o,"props.cell"))),d=e.computed((()=>C(n.iconPlacement)?n.iconPlacement:F(o,"props.iconPlacement")));function p(){const{value:e}=n;!s.value&&o&&C(e)&&o.updateValue(e)}return e.watch((()=>n.shape),(e=>{!e||["check","dot","button"].indexOf(e)})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-radio ${u.value?"is-cell-radio":""} ${u.value&&"button"==i.value?"is-button-radio":""} ${c.value?"is-"+c.value:""} ${l.value?"is-inline":""} ${a.value?"is-checked":""} ${"check"!==i.value?"is-"+i.value:""} ${s.value?"is-disabled":""} icon-placement-${d.value} ${t.customClass}`),style:e.normalizeStyle(t.customStyle),onClick:p},[e.createElementVNode("view",{class:"wd-radio__label",style:e.normalizeStyle(`${t.maxWidth?"max-width:"+t.maxWidth:""};  ${a.value&&"button"===i.value&&!s.value?"color :"+r.value:""}`)},[e.renderSlot(t.$slots,"default",{},void 0,!0)],4),e.createElementVNode("view",{class:"wd-radio__shape",style:e.normalizeStyle(a.value&&!s.value?"color: "+r.value:"")},["check"===i.value?(e.openBlock(),e.createBlock(_e,{key:0,style:e.normalizeStyle(a.value&&!s.value?"color: "+r.value:""),name:"check"},null,8,["style"])):e.createCommentVNode("",!0)],4)],6))}})),[["__scopeId","data-v-66db7d09"]]),Jo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-radio-group",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:$o,emits:["change","update:modelValue"],setup(t,{emit:n}){const o=t,a=n,{linkChildren:i}=Co(Yo);return i({props:o,updateValue:function(e){a("update:modelValue",e),a("change",{value:e})}}),e.watch((()=>o.shape),(e=>{["check","dot","button"].indexOf(e)}),{deep:!0,immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-radio-group  ${t.customClass} ${t.cell&&"button"===t.shape?"is-button":""}`),style:e.normalizeStyle(t.customStyle)},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6))}})),[["__scopeId","data-v-87ff328b"]]),Xo=__spreadProps(__spreadValues({},X),{label:String,labelWidth:J("33%"),disabled:$(!1),readonly:Boolean,placeholder:String,title:String,alignRight:$(!1),error:$(!1),required:$(!1),useLabelSlot:$(!1),useDefaultSlot:$(!1),size:String,checkedColor:String,min:W(0),max:W(0),selectSize:String,loading:$(!1),loadingColor:J("#4D80F0"),closeOnClickModal:$(!0),modelValue:K([String,Number,Boolean,Array]),columns:Y(),type:J("checkbox"),valueKey:J("value"),labelKey:J("label"),confirmButtonText:String,displayFormat:Function,beforeConfirm:Function,zIndex:W(15),safeAreaInsetBottom:$(!0),filterable:$(!1),filterPlaceholder:String,ellipsis:$(!1),scrollIntoView:$(!0),prop:String,rules:Y(),customContentClass:J(""),customLabelClass:J(""),customValueClass:J(""),showConfirm:$(!0),clearable:$(!1)}),Qo=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-select-picker",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Xo,emits:["change","cancel","confirm","clear","update:modelValue","open","close"],setup(t,{expose:n,emit:o}){const{translate:a}=Pt("select-picker"),i=t,r=o,s=e.ref(!1),l=e.ref([]),c=e.ref(!1),u=e.ref([]),d=e.ref(""),p=e.ref([]),h=e.ref(0),f=Dt(),g=e.computed((()=>{const e=E(i.modelValue);let t="";if(i.displayFormat)t=i.displayFormat(e,i.columns);else{const{type:n,labelKey:o}=i;if("checkbox"===n){t=(N(e)?e:[]).map((e=>k(e))).map((e=>e[o])).join(", ")}else if("radio"===n){t=k(e)[o]}else t=e}return t}));e.watch((()=>i.modelValue),(e=>{e!==l.value&&(l.value=E(e),u.value=E(e))}),{deep:!0,immediate:!0}),e.watch((()=>i.columns),(e=>{i.filterable&&d.value?O(e,d.value):p.value=e}),{deep:!0,immediate:!0}),e.watch((()=>i.displayFormat),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>i.beforeConfirm),(e=>{e&&R(e)}),{deep:!0,immediate:!0});const{parent:m}=wt(Nt),v=e.computed((()=>m&&i.prop&&m.errorMessages&&m.errorMessages[i.prop]?m.errorMessages[i.prop]:"")),_=e.computed((()=>{let e=!1;if(m&&m.props.rules){const t=m.props.rules;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n===i.prop&&Array.isArray(t[n])&&(e=t[n].some((e=>e.required)))}return i.required||i.rules.some((e=>e.required))||e}));e.onBeforeMount((()=>{l.value=E(i.modelValue),p.value=i.columns}));const{proxy:y}=e.getCurrentInstance();function I(){}function k(e){const{valueKey:t,labelKey:n,columns:o}=i,a=o.filter((n=>n[t]===e));return a.length>0?a[0]:{[t]:e,[n]:""}}function E(e){return"checkbox"===i.type?N(e)?e:[]:e}function T({value:e}){l.value=e,r("change",{value:e}),"radio"!==i.type||i.showConfirm||w()}function S(){s.value=!1,c.value||(l.value=E(u.value)),r("cancel"),r("close")}function M(){i.disabled||i.readonly||(l.value=E(i.modelValue),s.value=!0,c.value=!1,r("open"))}function w(){if(i.loading)return s.value=!1,r("confirm"),void r("close");i.beforeConfirm?i.beforeConfirm(l.value,(e=>{e&&b()})):b()}function b(){c.value=!0,s.value=!1,u.value=E(l.value);let e={};e="checkbox"===i.type?(N(u.value)?u.value:[]).map((e=>k(e))):k(u.value),r("update:modelValue",u.value),r("confirm",{value:u.value,selectedItems:e}),r("close")}function L(e,t){const n=new RegExp(`(${t})`,"g");return e.split(n).map((e=>({type:e===t?"active":"normal",label:e})))}function A({value:t}){""===t?(p.value=[],d.value=t,e.nextTick((()=>{p.value=i.columns}))):(d.value=t,O(i.columns,t))}function O(t,n){const o=t.filter((e=>e[i.labelKey].indexOf(n)>-1)).map((e=>__spreadProps(__spreadValues({},e),{[i.labelKey]:L(e[i.labelKey],n)})));p.value=[],e.nextTick((()=>{p.value=o}))}const P=e.computed((()=>"radio"===i.type&&i.showConfirm||"checkbox"===i.type)),x=e.computed((()=>i.clearable&&!i.disabled&&!i.readonly&&g.value.length));function V(){r("update:modelValue","checkbox"===i.type?[]:""),r("clear")}const B=e.computed((()=>!i.disabled&&!i.readonly&&!x.value));return n({close:S,open:M}),(t,n)=>{const o=ae(e.resolveDynamicComponent("wd-icon"),_e),i=ae(e.resolveDynamicComponent("wd-search"),Fo);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-select-picker ${e.unref(f).border.value?"is-border":""} ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[e.createElementVNode("view",{class:"wd-select-picker__field",onClick:M},[t.useDefaultSlot?e.renderSlot(t.$slots,"default",{key:0},void 0,!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(`wd-select-picker__cell ${t.disabled&&"is-disabled"} ${t.readonly&&"is-readonly"} ${t.alignRight&&"is-align-right"} ${t.error&&"is-error"} ${t.size&&"is-"+t.size}`)},[t.label||t.useLabelSlot?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-select-picker__label ${_.value&&"is-required"} ${t.customLabelClass}`),style:e.normalizeStyle(t.labelWidth?"min-width:"+t.labelWidth+";max-width:"+t.labelWidth+";":"")},[t.label?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.label),1)],64)):e.renderSlot(t.$slots,"label",{key:1},void 0,!0)],6)):e.createCommentVNode("",!0),e.createElementVNode("view",{class:"wd-select-picker__body"},[e.createElementVNode("view",{class:"wd-select-picker__value-wraper"},[e.createElementVNode("view",{class:e.normalizeClass(`wd-select-picker__value ${t.ellipsis&&"is-ellipsis"} ${t.customValueClass} ${g.value?"":"wd-select-picker__value--placeholder"}`)},e.toDisplayString(g.value||t.placeholder||e.unref(a)("placeholder")),3),B.value?(e.openBlock(),e.createBlock(o,{key:0,"custom-class":"wd-select-picker__arrow",name:"arrow-right"})):x.value?(e.openBlock(),e.createElementBlock("view",{key:1,onClick:e.withModifiers(V,["stop"])},[e.createVNode(o,{"custom-class":"wd-select-picker__clear",name:"error-fill"})])):e.createCommentVNode("",!0)]),v.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-select-picker__error-message"},e.toDisplayString(v.value),1)):e.createCommentVNode("",!0)])],2))]),e.createVNode(xo,{modelValue:s.value,"onUpdate:modelValue":n[3]||(n[3]=e=>s.value=e),duration:250,title:t.title||e.unref(a)("title"),"close-on-click-modal":t.closeOnClickModal,"z-index":t.zIndex,"safe-area-inset-bottom":t.safeAreaInsetBottom,onClose:S,onOpened:n[4]||(n[4]=n=>t.scrollIntoView?function(){return __async(this,null,(function*(){let t="",n=[];C(l.value)&&""!==l.value&&!N(l.value)?(t="#wd-radio-group",n=[D(`#radio${l.value}`,!1,y)]):N(l.value)&&l.value.length>0&&(l.value.forEach((e=>{n.push(D(`#check${e}`,!1,y))})),t="#wd-checkbox-group"),t&&(yield U(2e3/30),Promise.all([D(".wd-select-picker__wrapper",!1,y),D(t,!1,y),...n]).then((t=>{if(C(t)&&N(t)){const n=t[0],o=t[1],a=t.slice(2)||[];C(o)&&C(n)&&a.findIndex((e=>e.bottom>n.top&&e.top<n.bottom))<0&&(h.value=-1,e.nextTick((()=>{h.value=Math.max(0,a[0].top-o.top-n.height/2)})))}})))}))}():""),"custom-header-class":"wd-select-picker__header"},{default:e.withCtx((()=>[t.filterable?(e.openBlock(),e.createBlock(i,{key:0,modelValue:d.value,"onUpdate:modelValue":n[0]||(n[0]=e=>d.value=e),placeholder:t.filterPlaceholder||e.unref(a)("filterPlaceholder"),"hide-cancel":"","placeholder-left":"",onChange:A},null,8,["modelValue","placeholder"])):e.createCommentVNode("",!0),e.createElementVNode("scroll-view",{class:e.normalizeClass(`wd-select-picker__wrapper ${t.filterable?"is-filterable":""} ${t.loading?"is-loading":""} ${t.customContentClass}`),"scroll-y":!t.loading,"scroll-top":h.value,"scroll-with-animation":!0},["checkbox"===t.type&&e.unref(N)(l.value)?(e.openBlock(),e.createElementBlock("view",{key:0,id:"wd-checkbox-group"},[e.createVNode(Ko,{modelValue:l.value,"onUpdate:modelValue":n[1]||(n[1]=e=>l.value=e),cell:"",size:t.selectSize,"checked-color":t.checkedColor,min:t.min,max:t.max,onChange:T},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,(n=>(e.openBlock(),e.createElementBlock("view",{key:n[t.valueKey],id:"check"+n[t.valueKey]},[e.createVNode(qo,{modelValue:n[t.valueKey],disabled:n.disabled},{default:e.withCtx((()=>[t.filterable&&d.value?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(n[t.labelKey],(t=>(e.openBlock(),e.createElementBlock(e.Fragment,{key:t.label},["active"===t.type?(e.openBlock(),e.createElementBlock("text",{key:0,class:"wd-select-picker__text-active"},e.toDisplayString(t.label),1)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(t.label),1)],64))],64)))),128)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(n[t.labelKey]),1)],64))])),_:2},1032,["modelValue","disabled"])],8,["id"])))),128))])),_:1},8,["modelValue","size","checked-color","min","max"])])):e.createCommentVNode("",!0),"radio"!==t.type||e.unref(N)(l.value)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,id:"wd-radio-group"},[e.createVNode(Jo,{modelValue:l.value,"onUpdate:modelValue":n[2]||(n[2]=e=>l.value=e),cell:"",size:t.selectSize,"checked-color":t.checkedColor,onChange:T},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(p.value,((n,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,id:"radio"+n[t.valueKey]},[e.createVNode(Zo,{value:n[t.valueKey],disabled:n.disabled},{default:e.withCtx((()=>[t.filterable&&d.value?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(n[t.labelKey],(t=>(e.openBlock(),e.createElementBlock("text",{key:t.label,class:e.normalizeClass(""+("active"===t.type?"wd-select-picker__text-active":""))},e.toDisplayString(t.label),3)))),128)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(n[t.labelKey]),1)],64))])),_:2},1032,["value","disabled"])],8,["id"])))),128))])),_:1},8,["modelValue","size","checked-color"])])),t.loading?(e.openBlock(),e.createElementBlock("view",{key:2,class:"wd-select-picker__loading",onTouchmove:I},[e.createVNode(uo,{color:t.loadingColor},null,8,["color"])],32)):e.createCommentVNode("",!0)],10,["scroll-y","scroll-top"]),P.value?(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-select-picker__footer"},[e.createVNode(Te,{block:"",size:"large",onClick:w,disabled:t.loading},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(t.confirmButtonText||e.unref(a)("confirm")),1)])),_:1},8,["disabled"])])):e.createCommentVNode("",!0)])),_:1},8,["modelValue","title","close-on-click-modal","z-index","safe-area-inset-bottom"])],6)}}})),[["__scopeId","data-v-b9908799"]]);var ea={exports:{}};!function(e){e.exports=function(){var e=1e3,t=6e4,n=36e5,o="millisecond",a="second",i="minute",r="hour",s="day",l="week",c="month",u="quarter",d="year",p="date",h="Invalid Date",f=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,g=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,m={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(e){var t=["th","st","nd","rd"],n=e%100;return"["+e+(t[(n-20)%10]||t[n]||t[0])+"]"}},v=function(e,t,n){var o=String(e);return!o||o.length>=t?e:""+Array(t+1-o.length).join(n)+e},_={s:v,z:function(e){var t=-e.utcOffset(),n=Math.abs(t),o=Math.floor(n/60),a=n%60;return(t<=0?"+":"-")+v(o,2,"0")+":"+v(a,2,"0")},m:function e(t,n){if(t.date()<n.date())return-e(n,t);var o=12*(n.year()-t.year())+(n.month()-t.month()),a=t.clone().add(o,c),i=n-a<0,r=t.clone().add(o+(i?-1:1),c);return+(-(o+(n-a)/(i?a-r:r-a))||0)},a:function(e){return e<0?Math.ceil(e)||0:Math.floor(e)},p:function(e){return{M:c,y:d,w:l,d:s,D:p,h:r,m:i,s:a,ms:o,Q:u}[e]||String(e||"").toLowerCase().replace(/s$/,"")},u:function(e){return void 0===e}},y="en",I={};I[y]=m;var C="$isDayjsObject",k=function(e){return e instanceof M||!(!e||!e[C])},E=function e(t,n,o){var a;if(!t)return y;if("string"==typeof t){var i=t.toLowerCase();I[i]&&(a=i),n&&(I[i]=n,a=i);var r=t.split("-");if(!a&&r.length>1)return e(r[0])}else{var s=t.name;I[s]=t,a=s}return!o&&a&&(y=a),a||!o&&y},T=function(e,t){if(k(e))return e.clone();var n="object"==typeof t?t:{};return n.date=e,n.args=arguments,new M(n)},S=_;S.l=E,S.i=k,S.w=function(e,t){return T(e,{locale:t.$L,utc:t.$u,x:t.$x,$offset:t.$offset})};var M=function(){function m(e){this.$L=E(e.locale,null,!0),this.parse(e),this.$x=this.$x||e.x||{},this[C]=!0}var v=m.prototype;return v.parse=function(e){this.$d=function(e){var t=e.date,n=e.utc;if(null===t)return new Date(NaN);if(S.u(t))return new Date;if(t instanceof Date)return new Date(t);if("string"==typeof t&&!/Z$/i.test(t)){var o=t.match(f);if(o){var a=o[2]-1||0,i=(o[7]||"0").substring(0,3);return n?new Date(Date.UTC(o[1],a,o[3]||1,o[4]||0,o[5]||0,o[6]||0,i)):new Date(o[1],a,o[3]||1,o[4]||0,o[5]||0,o[6]||0,i)}}return new Date(t)}(e),this.init()},v.init=function(){var e=this.$d;this.$y=e.getFullYear(),this.$M=e.getMonth(),this.$D=e.getDate(),this.$W=e.getDay(),this.$H=e.getHours(),this.$m=e.getMinutes(),this.$s=e.getSeconds(),this.$ms=e.getMilliseconds()},v.$utils=function(){return S},v.isValid=function(){return!(this.$d.toString()===h)},v.isSame=function(e,t){var n=T(e);return this.startOf(t)<=n&&n<=this.endOf(t)},v.isAfter=function(e,t){return T(e)<this.startOf(t)},v.isBefore=function(e,t){return this.endOf(t)<T(e)},v.$g=function(e,t,n){return S.u(e)?this[t]:this.set(n,e)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(e,t){var n=this,o=!!S.u(t)||t,u=S.p(e),h=function(e,t){var a=S.w(n.$u?Date.UTC(n.$y,t,e):new Date(n.$y,t,e),n);return o?a:a.endOf(s)},f=function(e,t){return S.w(n.toDate()[e].apply(n.toDate("s"),(o?[0,0,0,0]:[23,59,59,999]).slice(t)),n)},g=this.$W,m=this.$M,v=this.$D,_="set"+(this.$u?"UTC":"");switch(u){case d:return o?h(1,0):h(31,11);case c:return o?h(1,m):h(0,m+1);case l:var y=this.$locale().weekStart||0,I=(g<y?g+7:g)-y;return h(o?v-I:v+(6-I),m);case s:case p:return f(_+"Hours",0);case r:return f(_+"Minutes",1);case i:return f(_+"Seconds",2);case a:return f(_+"Milliseconds",3);default:return this.clone()}},v.endOf=function(e){return this.startOf(e,!1)},v.$set=function(e,t){var n,l=S.p(e),u="set"+(this.$u?"UTC":""),h=(n={},n[s]=u+"Date",n[p]=u+"Date",n[c]=u+"Month",n[d]=u+"FullYear",n[r]=u+"Hours",n[i]=u+"Minutes",n[a]=u+"Seconds",n[o]=u+"Milliseconds",n)[l],f=l===s?this.$D+(t-this.$W):t;if(l===c||l===d){var g=this.clone().set(p,1);g.$d[h](f),g.init(),this.$d=g.set(p,Math.min(this.$D,g.daysInMonth())).$d}else h&&this.$d[h](f);return this.init(),this},v.set=function(e,t){return this.clone().$set(e,t)},v.get=function(e){return this[S.p(e)]()},v.add=function(o,u){var p,h=this;o=Number(o);var f=S.p(u),g=function(e){var t=T(h);return S.w(t.date(t.date()+Math.round(e*o)),h)};if(f===c)return this.set(c,this.$M+o);if(f===d)return this.set(d,this.$y+o);if(f===s)return g(1);if(f===l)return g(7);var m=(p={},p[i]=t,p[r]=n,p[a]=e,p)[f]||1,v=this.$d.getTime()+o*m;return S.w(v,this)},v.subtract=function(e,t){return this.add(-1*e,t)},v.format=function(e){var t=this,n=this.$locale();if(!this.isValid())return n.invalidDate||h;var o=e||"YYYY-MM-DDTHH:mm:ssZ",a=S.z(this),i=this.$H,r=this.$m,s=this.$M,l=n.weekdays,c=n.months,u=n.meridiem,d=function(e,n,a,i){return e&&(e[n]||e(t,o))||a[n].slice(0,i)},p=function(e){return S.s(i%12||12,e,"0")},f=u||function(e,t,n){var o=e<12?"AM":"PM";return n?o.toLowerCase():o};return o.replace(g,(function(e,o){return o||function(e){switch(e){case"YY":return String(t.$y).slice(-2);case"YYYY":return S.s(t.$y,4,"0");case"M":return s+1;case"MM":return S.s(s+1,2,"0");case"MMM":return d(n.monthsShort,s,c,3);case"MMMM":return d(c,s);case"D":return t.$D;case"DD":return S.s(t.$D,2,"0");case"d":return String(t.$W);case"dd":return d(n.weekdaysMin,t.$W,l,2);case"ddd":return d(n.weekdaysShort,t.$W,l,3);case"dddd":return l[t.$W];case"H":return String(i);case"HH":return S.s(i,2,"0");case"h":return p(1);case"hh":return p(2);case"a":return f(i,r,!0);case"A":return f(i,r,!1);case"m":return String(r);case"mm":return S.s(r,2,"0");case"s":return String(t.$s);case"ss":return S.s(t.$s,2,"0");case"SSS":return S.s(t.$ms,3,"0");case"Z":return a}return null}(e)||a.replace(":","")}))},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(o,p,h){var f,g=this,m=S.p(p),v=T(o),_=(v.utcOffset()-this.utcOffset())*t,y=this-v,I=function(){return S.m(g,v)};switch(m){case d:f=I()/12;break;case c:f=I();break;case u:f=I()/3;break;case l:f=(y-_)/6048e5;break;case s:f=(y-_)/864e5;break;case r:f=y/n;break;case i:f=y/t;break;case a:f=y/e;break;default:f=y}return h?f:S.a(f)},v.daysInMonth=function(){return this.endOf(c).$D},v.$locale=function(){return I[this.$L]},v.locale=function(e,t){if(!e)return this.$L;var n=this.clone(),o=E(e,t,!0);return o&&(n.$L=o),n},v.clone=function(){return S.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},m}(),w=M.prototype;return T.prototype=w,[["$ms",o],["$s",a],["$m",i],["$H",r],["$W",s],["$M",c],["$y",d],["$D",p]].forEach((function(e){w[e[1]]=function(t){return this.$g(t,e[0],e[1])}})),T.extend=function(e,t){return e.$i||(e(t,M,T),e.$i=!0),T},T.locale=E,T.isDayjs=k,T.unix=function(e){return T(1e3*e)},T.en=I[y],T.Ls=I,T.p={},T}()}(ea);var ta=ea.exports;const na=He(ta),oa="app".startsWith("mp-weixin"),aa=e=>new Promise(((t,n)=>{uni.request(__spreadProps(__spreadValues({},e),{url:e.url,dataType:"json",responseType:"json",success(o){if(oe("log","at utils/http.ts:18",o),o.statusCode>=200&&o.statusCode<300)if(401===o.data.code){It().logout(),uni.navigateTo({url:"/pages/asplash/index?type=relogin"}),n(o)}else t(o.data);else if(401===o.statusCode){It().logout(),uni.navigateTo({url:"/pages/asplash/index?type=relogin"}),n(o)}else!e.hideErrorToast&&uni.showToast({icon:"none",title:o.data.msg||"请求错误"}),n(o)},fail(e){uni.showToast({icon:"none",title:"网络错误，换个网络试试"}),n(e)}}))}));aa.get=(e,t)=>aa({url:e,query:t,method:"GET"}),aa.post=(e,t,n)=>aa({url:e,query:n,data:t,method:"POST"}),aa.put=(e,t,n)=>aa({url:e,query:n,data:t,method:"PUT"}),aa.delete=(e,t,n)=>aa({url:e,query:n,data:t,method:"DELETE"});const ia=()=>aa.get("/prod-api/common/enums/map"),ra=e=>aa.get("/prod-api/common/address",e),sa=()=>aa.get("/prod-api/app/user"),la=e=>aa.put("/prod-api/app/user/edit",e),ca=()=>aa.get("/prod-api/app/follow/list"),ua=()=>aa.get("/prod-api/app/follow/list/follow-me"),da=()=>aa.get("/prod-api/app/follow/list/mutual"),pa=()=>aa.get("/prod-api/app/follow/list/visit-me"),ha=e=>aa.post(`/prod-api/app/follow/user/${e}`),fa=e=>aa.delete(`/prod-api/app/follow/unfollow/${e}`),ga=__spreadValues({},X),ma=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-video-preview",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:ga,setup(t,{expose:n}){const o=e.ref(!1),a=e.reactive({url:"",poster:"",title:""});function i(){o.value=!1,e.nextTick((()=>{a.url="",a.poster="",a.title=""}))}return n({open:function(e){o.value=!0,a.url=e.url,a.poster=e.poster,a.title=e.title},close:i}),(t,n)=>o.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-video-preview ${t.customClass}`),style:e.normalizeStyle(t.customStyle),onClick:i},[e.createElementVNode("view",{class:"wd-video-preview__video",onClick:n[0]||(n[0]=e.withModifiers((()=>{}),["stop"]))},[a.url?(e.openBlock(),e.createElementBlock("video",{key:0,class:"wd-video-preview__video",controls:!0,poster:a.poster,title:a.title,"play-btn-position":"center",enableNative:!0,src:a.url,"enable-progress-gesture":!1},null,8,["poster","title","src"])):e.createCommentVNode("",!0)]),e.createVNode(_e,{name:"close","custom-class":"wd-video-preview__close",onClick:i})],6)):e.createCommentVNode("",!0)}})),[["__scopeId","data-v-0c4b6798"]]);function va(e){if(N(e.tempFiles)){const t=[];return e.tempFiles.forEach((e=>__async(this,null,(function*(){t.push({path:e.path||"",name:e.name||"",size:e.size,type:"image",thumb:e.path||""})})))),t}return[{path:e.tempFiles.path||"",name:e.tempFiles.name||"",size:e.tempFiles.size,type:"image",thumb:e.tempFiles.path||""}]}const _a=__spreadProps(__spreadValues({},X),{fileList:Y(),action:J(""),header:{type:Object,default:()=>({})},multiple:$(!1),disabled:$(!1),limit:Number,showLimitNum:$(!0),maxSize:W(Number.MAX_VALUE),sourceType:{type:Array,default:()=>["album","camera"]},sizeType:{type:Array,default:()=>["original","compressed"]},name:J("file"),formData:{type:Object,default:()=>{}},onPreviewFail:Function,beforeUpload:Function,beforeChoose:Function,beforeRemove:Function,beforePreview:Function,buildFormData:Function,loadingType:J("ring"),loadingColor:J("#ffffff"),accept:J("image"),statusKey:J("status"),loadingSize:J("24px"),compressed:$(!0),maxDuration:W(60),camera:J("back"),imageMode:J("aspectFit"),successStatus:W(200),customEvokeClass:J(""),customPreviewClass:J(""),autoUpload:$(!0),reupload:$(!1),uploadMethod:Function}),ya=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-upload",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:_a,emits:["fail","change","success","progress","oversize","chooseerror","remove","update:fileList"],setup(t,{expose:n,emit:o}){const a=t,i=o;n({submit:()=>f()});const{translate:r}=Pt("upload"),s=e.ref([]),l=e.computed((()=>!a.limit||s.value.length<a.limit)),c=e.ref();function u(){i("update:fileList",s.value)}e.watch((()=>a.fileList),(e=>{const{statusKey:t}=a;if(M(e,s.value))return;const n=e.map((e=>(e[t]=e[t]||"success",e.response=e.response||"",__spreadProps(__spreadValues({},e),{uid:b.id++}))));s.value=n}),{deep:!0,immediate:!0}),e.watch((()=>a.limit),(e=>{e&&s.value.length}),{deep:!0,immediate:!0}),e.watch((()=>a.beforePreview),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.onPreviewFail),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.beforeRemove),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.beforeUpload),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.beforeChoose),(e=>{e&&R(e)}),{deep:!0,immediate:!0}),e.watch((()=>a.buildFormData),(e=>{e&&R(e)}),{deep:!0,immediate:!0});const d=(e,t,n)=>{const{statusKey:o,uploadMethod:i}=a;e[o]="loading",R(i)?i(e,t,n):((e,t,n)=>{uni.uploadFile({url:n.action,header:n.header,name:n.name,fileName:n.name,fileType:n.fileType,formData:t,filePath:e.url,success(o){o.statusCode===n.statusCode?n.onSuccess(o,e,t):n.onError(__spreadProps(__spreadValues({},o),{errMsg:o.errMsg||""}),e,t)},fail(o){n.onError(o,e,t)}}).onProgressUpdate((t=>{n.onProgress(t,e)}))})(e,t,n)};function p(e){return new Promise(((t,n)=>{uni.getImageInfo({src:e,success:e=>{t(e)},fail:e=>{n(e)}})}))}function h(e,t){const{statusKey:n}=a,o={uid:b.id++,name:e.name||"",thumb:e.thumb||"",[n]:"pending",size:e.size||0,url:e.path,percent:0};"number"==typeof t?s.value.splice(t,1,o):s.value.push(o),a.autoUpload&&f()}function f(){const{buildFormData:e,formData:t={},statusKey:n}=a,{action:o,name:i,header:r={},accept:l,successStatus:c}=a,u=C(c)?c:200;for(const a of s.value)"pending"==a[n]&&(e?e({file:a,formData:t,resolve:e=>{e&&d(a,e,{onSuccess:m,onError:g,onProgress:v,action:o,header:r,name:i,fileName:i,fileType:l,statusCode:u})}}):d(a,t,{onSuccess:m,onError:g,onProgress:v,action:o,header:r,name:i,fileName:i,fileType:l,statusCode:u}))}function g(e,t,n){const{statusKey:o}=a,r=s.value.findIndex((e=>e.uid===t.uid));r>-1&&(s.value[r][o]="fail",s.value[r].error=e.message,s.value[r].response=e,i("fail",{error:e,file:t,formData:n}),u())}function m(e,t,n){const{statusKey:o}=a,r=s.value.findIndex((e=>e.uid===t.uid));r>-1&&(s.value[r][o]="success",s.value[r].response=e.data,i("change",{fileList:s.value}),i("success",{file:t,fileList:s.value,formData:n}),u())}function v(e,t){const n=s.value.findIndex((e=>e.uid===t.uid));n>-1&&(s.value[n].percent=e.progress,i("progress",{response:e,file:t}))}function _(e){const{multiple:t,maxSize:n,accept:o,sizeType:r,limit:l,sourceType:c,compressed:u,maxDuration:d,camera:f,beforeUpload:g}=a;(function({multiple:e,sizeType:t,sourceType:n,maxCount:o,accept:a,compressed:i,maxDuration:r,camera:s}){return new Promise(((l,c)=>{switch(a){case"image":uni.chooseImage({count:e?Math.min(o,9):1,sizeType:t,sourceType:n,success:e=>l(va(e)),fail:e=>{c(e)}});break;case"video":uni.chooseVideo({sourceType:n,compressed:i,maxDuration:r,camera:s,success:e=>{l(function(e){return[{path:e.tempFilePath||e.filePath||"",name:e.name||"",size:e.size,type:"video",thumb:e.thumbTempFilePath||"",duration:e.duration}]}(e))},fail:c});break;case"all":break;default:uni.chooseImage({count:e?Math.min(o,9):1,sizeType:t,sourceType:n,success:e=>l(va(e)),fail:c})}}))})({multiple:t,sizeType:r,sourceType:c,maxCount:l?l-s.value.length:9,accept:o,compressed:u,maxDuration:d,camera:f}).then((o=>{let a=o;t||(a=a.slice(0,1));const r=t=>__async(this,null,(function*(){for(let o=0;o<t.length;o++){const a=t[o];if("image"===a.type&&!a.size){const e=yield p(a.path);a.size=e.width*e.height}Number(a.size)<=n?h(a,e):i("oversize",{file:a})}}));g?g({files:a,fileList:s.value,resolve:e=>{e&&r(a)}}):r(a)})).catch((e=>{i("chooseerror",{error:e})}))}function y(e){if(a.disabled)return;const{beforeChoose:t}=a;t?t({fileList:s.value,resolve:t=>{t&&_(e)}}):_(e)}function I(e){s.value.splice(s.value.findIndex((t=>t.uid===e.uid)),1),i("change",{fileList:s.value}),i("remove",{file:e}),u()}function k(e){uni.openDocument({filePath:e.url,showMenu:!0})}function E(e,t){const{onPreviewFail:n}=a;uni.previewImage({urls:t,current:t[e],fail(){n?n({index:e,imgList:t}):uni.showToast({title:"预览图片失败",icon:"none"})}})}function T(e,t){var n;const{onPreviewFail:o}=a;null==(n=c.value)||n.open({url:t[e].url,poster:t[e].thumb,title:t[e].name})}function S(e){const{beforePreview:t,reupload:n}=a,o=x(s.value),i=o.findIndex((t=>t.url===e.url)),r=o.filter((e=>w(e))),l=r.findIndex((t=>t.url===e.url));n?y(i):t?t({file:e,index:i,imgList:[],fileList:o,resolve:e=>{e&&T(l,r)}}):T(l,r)}function w(e){return e.name&&H(e.name)||H(e.url)}function D(e){return e.name&&j(e.name)||j(e.url)}return(t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("view",{class:e.normalizeClass(["wd-upload",t.customClass]),style:e.normalizeStyle(t.customStyle)},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value,((n,o)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["wd-upload__preview",t.customPreviewClass]),key:o},[e.createElementVNode("view",{class:"wd-upload__status-content"},[D(n)?(e.openBlock(),e.createElementBlock("image",{key:0,src:n.url,mode:t.imageMode,class:"wd-upload__picture",onClick:e=>function(e){const{beforePreview:t,reupload:n}=a,o=x(s.value),i=o.findIndex((t=>t.url===e.url)),r=o.filter((e=>D(e))).map((e=>e.url)),l=r.findIndex((t=>t===e.url));n?y(i):t?t({file:e,index:i,fileList:o,imgList:r,resolve:e=>{e&&E(l,r)}}):E(l,r)}(n)},null,8,["src","mode","onClick"])):w(n)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[n.thumb?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-upload__video",onClick:e=>S(n)},[e.createElementVNode("image",{src:n.thumb,mode:t.imageMode,class:"wd-upload__picture"},null,8,["src","mode"]),e.createVNode(_e,{name:"play-circle-filled","custom-class":"wd-upload__video-paly"})],8,["onClick"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-upload__video",onClick:e=>S(n)},[e.createVNode(_e,{"custom-class":"wd-upload__video-icon",name:"video"})],8,["onClick"]))],64)):(e.openBlock(),e.createElementBlock("view",{key:2,class:"wd-upload__file",onClick:e=>function(e){const{beforePreview:t,reupload:n}=a,o=x(s.value),i=o.findIndex((t=>t.url===e.url));n?y(i):t?t({file:e,index:i,imgList:[],fileList:o,resolve:t=>{t&&k(e)}}):k(e)}(n)},[e.createVNode(_e,{name:"file","custom-class":"wd-upload__file-icon"}),e.createElementVNode("view",{class:"wd-upload__file-name"},e.toDisplayString(n.name||n.url),1)],8,["onClick"]))]),"success"!==n[a.statusKey]?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-upload__mask wd-upload__status-content"},["loading"===n[a.statusKey]?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-upload__status-content"},[e.createVNode(uo,{type:t.loadingType,size:t.loadingSize,color:t.loadingColor},null,8,["type","size","color"]),e.createElementVNode("text",{class:"wd-upload__progress-txt"},e.toDisplayString(n.percent)+"%",1)])):e.createCommentVNode("",!0),"fail"===n[a.statusKey]?(e.openBlock(),e.createElementBlock("view",{key:1,class:"wd-upload__status-content"},[e.createVNode(_e,{name:"close-outline","custom-class":"wd-upload__icon"}),e.createElementVNode("text",{class:"wd-upload__progress-txt"},e.toDisplayString(n.error||e.unref(r)("error")),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),"loading"===n[a.statusKey]||t.disabled?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(_e,{key:1,name:"error-fill","custom-class":"wd-upload__close",onClick:e=>function(e){const{beforeRemove:t}=a,n=e,o=s.value[n];t?t({file:o,index:n,fileList:s.value,resolve:e=>{e&&I(o)}}):I(o)}(o)},null,8,["onClick"])),t.$slots["preview-cover"]?e.renderSlot(t.$slots,"preview-cover",{key:2,file:n,index:o},void 0,!0):e.createCommentVNode("",!0)],2)))),128)),l.value?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[t.$slots.default?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["wd-upload__evoke-slot",t.customEvokeClass]),onClick:y},[e.renderSlot(t.$slots,"default",{},void 0,!0)],2)):(e.openBlock(),e.createElementBlock("view",{key:1,onClick:y,class:e.normalizeClass(["wd-upload__evoke",t.disabled?"is-disabled":"",t.customEvokeClass])},[e.createVNode(_e,{class:"wd-upload__evoke-icon",name:"fill-camera"}),t.limit&&t.showLimitNum?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-upload__evoke-num"},"（"+e.toDisplayString(s.value.length)+"/"+e.toDisplayString(t.limit)+"）",1)):e.createCommentVNode("",!0)],2))],64)):e.createCommentVNode("",!0)],6),e.createVNode(ma,{ref_key:"videoPreview",ref:c},null,512)],64))}})),[["__scopeId","data-v-ef48e04d"]]),Ia=ee(e.defineComponent({__name:"index",props:{type:{type:String,default:"picture"},limit:{type:Number},fileList:{type:Array,default:()=>[]}},emits:["before-upload-file","update-file-list"],setup(t,{emit:n}){const o=t,a=n,i=e.ref([]),r=e.ref(!0),s=({files:e,resolve:t})=>{a("before-upload-file",e),t(!0)},l=(e,t,n)=>{oe("log","at components/upload/index.vue:56",e,t,n);uni.uploadFile({url:"/prod-api/common/oss/upload",header:n.header,name:n.name,fileName:n.name,fileType:n.fileType,formData:t,timeout:2e4,filePath:e.url,success(o){o.statusCode===n.statusCode?(oe("log","at components/upload/index.vue:69","成功！！！！！",o,e,t),n.onSuccess(o,e,t)):(oe("log","at components/upload/index.vue:76","失败！！！！！",o,e,t),n.onError(__spreadProps(__spreadValues({},o),{errMsg:o.errMsg||""}),e,t))},fail(o){n.onError(o,e,t)}}).onProgressUpdate((t=>{n.onProgress(t,e)}))},c=({fileList:e})=>{oe("log","at components/upload/index.vue:94","文件变更！！!",e);const t=e.every((e=>"success"===e.status));r.value=!o.limit||e.length<o.limit,t&&a("update-file-list",e.map((e=>{if(e.response){return{url:JSON.parse(e.response).msg}}return{url:e.url}})))};return e.watch(o.fileList,(e=>{oe("log","at components/upload/index.vue:119","哈哈哈哈哈哈哈",e),i.value=e}),{immediate:!0,deep:!0}),(n,o)=>{const a=ae(e.resolveDynamicComponent("wd-upload"),ya);return e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["upload",e.unref(r)?"showEvoke":"hideEvoke"])},["picture"===t.type?(e.openBlock(),e.createBlock(a,{key:0,"image-mode":"aspectFill",multiple:!0,limit:t.limit,"file-list":e.unref(i),"onUpdate:fileList":o[0]||(o[0]=t=>e.isRef(i)?i.value=t:null),"upload-method":l,"before-upload":s,onChange:c},null,8,["limit","file-list"])):e.createCommentVNode("",!0),"video"===t.type?(e.openBlock(),e.createBlock(a,{key:1,accept:"video",limit:1,"file-list":e.unref(i),"onUpdate:fileList":o[1]||(o[1]=t=>e.isRef(i)?i.value=t:null),"upload-method":l,"before-upload":s,onChange:c},null,8,["file-list"])):e.createCommentVNode("",!0)],2)}}}),[["__scopeId","data-v-c61539c5"]]),Ca=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(),o=It(),{sexOpts:a,ageOpts:i,tagOpts:r,tagDataMap:s,heightOpts:l,assetsOpts:c,incomeOpts:u,marriageOpts:d,educationOpts:p,timePickerStamp:h}=(()=>{const e=Ct(),t=[new Date("1900-01-01").getTime(),(new Date).getTime()],n=Array.from({length:101},((e,t)=>`${t+140}`)).map((e=>({value:e,label:`${e} cm`}))),o=e.dataMap.education.map((e=>({label:e.info,value:e.code}))),a={};return{ageOpts:[{label:"不选",value:""},{label:"20岁-30岁",value:"20-30"},{label:"25岁-35岁",value:"25-35"},{label:"30岁-40岁",value:"30-40"},{label:"35岁-45岁",value:"35-45"},{label:"40岁-50岁",value:"40-50"},{label:"45岁-55岁",value:"45-55"}],sexOpts:[{label:"男",value:1},{label:"女",value:0}],timePickerStamp:t,heightOpts:n,educationOpts:o,assetsOpts:[{label:"不选",value:""},{label:"已购房",value:"已购房"},{label:"与父母同住",value:"与父母同住"},{label:"无房产",value:"无房产"}],incomeOpts:[{label:"不选",value:""},{label:"4千以下",value:"0-4000"},{label:"4千-6千",value:"4000-6000"},{label:"6千-1万",value:"6000-10000"},{label:"1万-2万",value:"10000-20000"},{label:"2万-5万",value:"20000-50000"},{label:"5万-10万",value:"50000-100000"},{label:"10万以上",value:"100000-"}],tagOpts:e.dataMap.tags.map((e=>(a[e.code]=e.info,{label:e.info,value:e.code}))),tagDataMap:a,marriageOpts:[{label:"不选",value:""},{label:"未婚",value:"未婚"},{label:"离异",value:"离异"},{label:"丧偶",value:"丧偶"}]}})(),f=e.ref(!1),g=e.ref(!1),m=e.ref([]),v=e.ref([]),_=e.reactive({userId:"",avatar:"",userDesc:"",nickName:"",sex:"",birthday:"",height:"",orientation:[],home:[],qualifications:"",graduateSchool:"",occupation:"",maritalStatus:"",haveHouse:"",datingVoices:"",monthlySalary:"",clientUserTags:[],friendArea:[],friAge:""}),y=e.ref([]),I=e.ref([]),C=e.ref([]),k=e.ref([]),E=(e,t)=>{if(!t)return e;for(const n of e){if(n.code===t)return n.children||null;if(n.children){const e=E(n.children,t);if(e)return e}}return null},T=({selectedItem:e,resolve:t,finish:n})=>{const o=E(k.value,e.code);o&&o.length?t(o.map((e=>({code:e.code,name:e.name})))):n()},S=e.ref([]),M=e.ref(!1),w=()=>{uni.chooseImage({count:1,sizeType:["original","compressed"],sourceType:["album","camera"],success:({tempFilePaths:e,tempFiles:t})=>{uni.uploadFile({url:"/prod-api/common/oss/upload",filePath:e[0],name:"file",success:e=>{oe("log","at pages/baseInfo/index.vue:488","上传成功：",e);const t=JSON.parse(e.data);_.avatar=t.msg},fail:e=>{oe("error","at pages/baseInfo/index.vue:493","上传失败：",e)}})},fail:e=>{oe("error","at pages/baseInfo/index.vue:498","选择图片失败:",e)}})},b=()=>{M.value=!0},D=e=>{v.value=e},N=()=>{M.value=!1},R=()=>{m.value=v.value,M.value=!1},L=({value:e,selectedItem:t})=>{_.clientUserTags=e,S.value=e.map((e=>s[e]))},A=()=>{uni.navigateBack()},O=()=>__async(this,null,(function*(){f.value=!0;const e=o.getUserInfo(),{data:t}=yield aa.get("/prod-api/system/code/list/tree");k.value=t,Object.entries(e).forEach((([e,t])=>{switch(e){case"birthday":_.birthday=na(t).valueOf();break;case"clientUserImages":_.clientUserImages=t&&t.length>0?t:[],m.value=t&&t.length>0?t.map((e=>({url:e}))):[];break;case"friAge":_[e]=t||"";break;default:_[e]=t||null}})),_.orientation=[e.orientationProvinceId,e.orientationCityId,e.orientationDistrictId],_.home=[e.homeProvinceId,e.homeCityId,e.homeDistrictId],_.friendArea=[e.friProvinceId,e.friCityId,e.friDistrictId],C.value=[k.value.map((e=>({code:e.code,name:e.name}))),...e.orientationProvinceId?[E(k.value,e.orientationProvinceId).map((e=>({code:e.code,name:e.name})))]:[],...e.orientationCityId?[E(k.value,e.orientationCityId).map((e=>({code:e.code,name:e.name})))]:[]],y.value=[k.value.map((e=>({code:e.code,name:e.name}))),...e.homeProvinceId?[E(k.value,e.homeProvinceId).map((e=>({code:e.code,name:e.name})))]:[],...e.homeCityId?[E(k.value,e.homeCityId).map((e=>({code:e.code,name:e.name})))]:[]],I.value=[k.value.map((e=>({code:e.code,name:e.name}))),...e.friProvinceId?[E(k.value,e.friProvinceId).map((e=>({code:e.code,name:e.name})))]:[],...e.friCityId?[E(k.value,e.friCityId).map((e=>({code:e.code,name:e.name})))]:[]],S.value=e.clientUserTags.map((e=>s[e])),o.setUserInfo(e),oe("log","at pages/baseInfo/index.vue:644","嘿嘿嘿嘿嘿",m.value),f.value=!1})),P=()=>__async(this,null,(function*(){const e={};if(!(_.userDesc&&_.nickName&&_.birthday&&0!==_.home.length&&_.occupation&&_.monthlySalary&&_.datingVoices&&0!==_.clientUserTags.length))return uni.showToast({title:"请填写必填项！",icon:"none",duration:2e3});Object.entries(_).forEach((([t,n])=>{switch(t){case"birthday":e[t]=na(n).format("YYYY-MM-DD");break;case"orientation":case"orientationCityId":case"orientationDistrictId":case"orientationProvinceId":e.orientationCityId=_.orientation[1],e.orientationDistrictId=_.orientation[2],e.orientationProvinceId=_.orientation[0];break;case"home":case"homeCityId":case"homeDistrictId":case"homeProvinceId":e.homeCityId=_.home[1],e.homeDistrictId=_.home[2],e.homeProvinceId=_.home[0];break;case"friendArea":case"friCityId":case"friDistrictId":case"friProvinceId":e.friCityId=_.friendArea[1],e.friDistrictId=_.friendArea[2],e.friProvinceId=_.friendArea[0];break;case"clientUserImages":e.clientUserImages=m.value.map((e=>e.url));break;case"maxSalary":case"minSalary":case"monthlySalary":e.minSalary=_.monthlySalary.split("-")[0],e.maxSalary=_.monthlySalary.split("-")[1],e.monthlySalary=_.monthlySalary;break;case"friAge":e.friAge=_.friAge;break;default:e[t]=n}})),yield la(e),yield O(),uni.showToast({title:"保存成功！",icon:"none",duration:2e3}),uni.switchTab({url:"/pages/own/index"})}));return ce((e=>{g.value="edit"===e.type})),re((()=>{O()})),(t,o)=>{const s=ae(e.resolveDynamicComponent("wd-img"),te),v=ae(e.resolveDynamicComponent("wd-icon"),_e),k=ae(e.resolveDynamicComponent("z-paging"),to),E=ae(e.resolveDynamicComponent("wd-input"),lo),O=ae(e.resolveDynamicComponent("wd-form"),Eo),U=ae(e.resolveDynamicComponent("wd-picker"),No),x=ae(e.resolveDynamicComponent("wd-datetime-picker"),Po),V=ae(e.resolveDynamicComponent("wd-col-picker"),Bo),B=ae(e.resolveDynamicComponent("wd-select-picker"),Qo),G=ae(e.resolveDynamicComponent("wd-button"),Te),F=ae(e.resolveDynamicComponent("wd-overlay"),io);return e.openBlock(),e.createElementBlock("view",{class:"baseInfo_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(s,{class:"back",src:"/static/images/back.png",onClick:A}),e.createElementVNode("view",{class:"title"},"基本资料")]),e.createElementVNode("view",{class:"body"},[e.createVNode(k,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[f.value?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("view",{class:"avatar"},[_.avatar?(e.openBlock(),e.createBlock(s,{key:0,class:"w-100px h-100px rounded-50px overflow-hidden",src:_.avatar},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"w-100px h-100px rounded-50px overflow-hidden bg-gray-200 flex items-center justify-center text-[14px] text-gray-400"}," 暂无头像 ")),e.withDirectives(e.createElementVNode("view",{class:"iconBg",onClick:w},[e.createElementVNode("view",{class:"iconWrapper"},[e.createVNode(s,{class:"w-14px h-14px",src:"/static/images/camera.png"})])],512),[[e.vShow,g.value]])]),e.createElementVNode("view",{class:"album"},[e.createElementVNode("view",{class:"title"},"个人相册"),e.createElementVNode("view",{class:"pictures_container"},[e.withDirectives(e.createElementVNode("view",{class:"add",onClick:b},[e.createVNode(v,{name:"add",size:"20px",color:"rgba(147, 149, 164, 0.9)"})],512),[[e.vShow,g.value]]),e.createVNode(k,{class:"pictures_scroll","scroll-x":"",fixed:!1,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"content-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(m.value,((t,n)=>(e.openBlock(),e.createBlock(s,{class:"min-w-50px h-50px mr-10px rounded-5px overflow-hidden",key:n,src:t.url},null,8,["src"])))),128))])])),_:1})])]),e.createElementVNode("view",{class:"desc"},[e.createVNode(O,{ref:"form",model:_},{default:e.withCtx((()=>[e.createVNode(E,{required:"","align-right":"",label:"一句话简介","label-width":"100px",prop:"userDesc",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.userDesc,"onUpdate:modelValue":o[0]||(o[0]=e=>_.userDesc=e),placeholder:"请填写一句话简介"},null,8,["disabled","class","modelValue"])])),_:1},8,["model"])]),e.createElementVNode("view",{class:"base"},[e.createElementVNode("view",{class:"title"},"基本信息"),e.createVNode(O,{ref:"form",model:_},{default:e.withCtx((()=>[e.createVNode(E,{required:"","align-right":"",label:"昵称","label-width":"100px",prop:"nickName",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.nickName,"onUpdate:modelValue":o[1]||(o[1]=e=>_.nickName=e),placeholder:"请输入昵称"},null,8,["disabled","class","modelValue"]),e.createVNode(U,{"align-right":"",label:"性别","label-width":"100px",placeholder:"请选择性别",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.sex,"onUpdate:modelValue":o[2]||(o[2]=e=>_.sex=e),columns:e.unref(a)},null,8,["disabled","class","modelValue","columns"]),e.createVNode(x,{required:"","align-right":"",type:"date",label:"生日","label-width":"100px",placeholder:"请选择生日",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),minDate:e.unref(h)[0],maxDate:e.unref(h)[1],modelValue:_.birthday,"onUpdate:modelValue":o[3]||(o[3]=e=>_.birthday=e)},null,8,["disabled","class","minDate","maxDate","modelValue"]),e.createVNode(U,{"align-right":"",label:"身高","label-width":"100px",placeholder:"请选择身高",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),columns:e.unref(l),modelValue:_.height,"onUpdate:modelValue":o[4]||(o[4]=e=>_.height=e)},null,8,["disabled","class","columns","modelValue"]),e.createVNode(V,{"align-right":"",label:"所在地","label-width":"80px",placeholder:"请选择所在地","value-key":"code","label-key":"name",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),columns:C.value,"column-change":T,modelValue:_.orientation,"onUpdate:modelValue":o[5]||(o[5]=e=>_.orientation=e)},null,8,["disabled","class","columns","modelValue"]),e.createVNode(V,{required:"","align-right":"",label:"家乡","label-width":"50px",placeholder:"请选择家乡","value-key":"code","label-key":"name",columns:y.value,"column-change":T,disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.home,"onUpdate:modelValue":o[6]||(o[6]=e=>_.home=e)},null,8,["columns","disabled","class","modelValue"]),e.createVNode(U,{"align-right":"",label:"学历","label-width":"100px",placeholder:"请选择学历",columns:e.unref(p),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.qualifications,"onUpdate:modelValue":o[7]||(o[7]=e=>_.qualifications=e)},null,8,["columns","disabled","class","modelValue"]),e.createVNode(E,{"align-right":"",label:"学校","label-width":"100px",prop:"graduateSchool",placeholder:"您的毕业院校是？",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.graduateSchool,"onUpdate:modelValue":o[8]||(o[8]=e=>_.graduateSchool=e)},null,8,["disabled","class","modelValue"]),e.createVNode(E,{required:"","align-right":"",label:"职业","label-width":"100px",prop:"occupation",placeholder:"您从事什么工作？",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.occupation,"onUpdate:modelValue":o[9]||(o[9]=e=>_.occupation=e)},null,8,["disabled","class","modelValue"]),e.createVNode(E,{"align-right":"",label:"公司","label-width":"100px",prop:"companyName",placeholder:"请填写就职公司",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.companyName,"onUpdate:modelValue":o[10]||(o[10]=e=>_.companyName=e)},null,8,["disabled","class","modelValue"]),e.createVNode(U,{required:"","align-right":"",label:"月收入","label-width":"100px",placeholder:"请选择月收入",columns:e.unref(u),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.monthlySalary,"onUpdate:modelValue":o[11]||(o[11]=e=>_.monthlySalary=e)},null,8,["columns","disabled","class","modelValue"]),e.createVNode(U,{"align-right":"",label:"婚姻状况","label-width":"100px",placeholder:"请选择您的婚姻状况",columns:e.unref(d),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.maritalStatus,"onUpdate:modelValue":o[12]||(o[12]=e=>_.maritalStatus=e)},null,8,["columns","disabled","class","modelValue"]),e.createVNode(U,{"align-right":"",label:"有无房产","label-width":"100px",placeholder:"是否购房",columns:e.unref(c),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.haveHouse,"onUpdate:modelValue":o[13]||(o[13]=e=>_.haveHouse=e)},null,8,["columns","disabled","class","modelValue"])])),_:1},8,["model"])]),e.createElementVNode("view",{class:"desc"},[e.createVNode(O,{ref:"form",model:_},{default:e.withCtx((()=>[e.createVNode(E,{required:"","align-right":"",label:"交友心声","label-width":"100px",prop:"datingVoices",placeholder:"请填写交友心声",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.datingVoices,"onUpdate:modelValue":o[14]||(o[14]=e=>_.datingVoices=e)},null,8,["disabled","class","modelValue"])])),_:1},8,["model"])]),e.createElementVNode("view",{class:"tags"},[e.createVNode(O,{ref:"form",model:_},{default:e.withCtx((()=>[e.createVNode(B,{required:"",ellipsis:"","align-right":"",label:"个性标签","label-width":"100px",placeholder:"请选择个性标签",columns:e.unref(r),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.clientUserTags,"onUpdate:modelValue":o[15]||(o[15]=e=>_.clientUserTags=e),onChange:L},null,8,["columns","disabled","class","modelValue"])])),_:1},8,["model"]),e.createElementVNode("view",{class:"tagList"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(S.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"tag",key:n},e.toDisplayString(t),1)))),128))])]),e.createElementVNode("view",{class:"range"},[e.createElementVNode("view",{class:"title"},"交友范围"),e.createVNode(O,{ref:"form",model:_},{default:e.withCtx((()=>[e.createVNode(V,{"align-right":"",label:"所在地","label-width":"80px",placeholder:"不限","value-key":"code","label-key":"name",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),columns:I.value,"column-change":T,modelValue:_.friendArea,"onUpdate:modelValue":o[16]||(o[16]=e=>_.friendArea=e)},null,8,["disabled","class","columns","modelValue"]),e.createVNode(U,{"align-right":"",label:"年龄","label-width":"100px",placeholder:"不限",columns:e.unref(i),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.friAge,"onUpdate:modelValue":o[17]||(o[17]=e=>_.friAge=e)},null,8,["columns","disabled","class","modelValue"]),e.createVNode(U,{"align-right":"",label:"身高","label-width":"100px",placeholder:"不限",columns:e.unref(l),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.friHeight,"onUpdate:modelValue":o[18]||(o[18]=e=>_.friHeight=e)},null,8,["columns","disabled","class","modelValue"]),e.createVNode(U,{"align-right":"",label:"最低学历","label-width":"100px",placeholder:"不限",columns:e.unref(p),disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.friQualifications,"onUpdate:modelValue":o[19]||(o[19]=e=>_.friQualifications=e)},null,8,["columns","disabled","class","modelValue"]),e.createVNode(E,{type:"number","align-right":"",label:"最低月收入","label-width":"100px",placeholder:"不限",disabled:!g.value,class:e.normalizeClass([g.value?"":"formText"]),modelValue:_.friMinSalary,"onUpdate:modelValue":o[20]||(o[20]=e=>_.friMinSalary=e)},null,8,["disabled","class","modelValue"])])),_:1},8,["model"])]),e.withDirectives(e.createVNode(G,{class:"saveBtn",block:"",onClick:P},{default:e.withCtx((()=>[e.createTextVNode(" 保存 ")])),_:1},512),[[e.vShow,g.value]])],64))])),_:1})]),e.createVNode(F,{show:M.value},{default:e.withCtx((()=>[M.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"dialog_wrapper"},[e.createElementVNode("view",{class:"block"},[e.createElementVNode("view",{class:"title"},"编辑相册"),e.createVNode(k,{class:"dialog_pictures_scroll",fixed:!1,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createVNode(Ia,{fileList:m.value,onUpdateFileList:D},null,8,["fileList"])])),_:1}),e.createElementVNode("view",{class:"btns"},[e.createVNode(G,{class:"cancel",onClick:N},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1}),e.createVNode(G,{class:"confirm",onClick:R},{default:e.withCtx((()=>[e.createTextVNode("保存")])),_:1})])])])):e.createCommentVNode("",!0)])),_:1},8,["show"])],4)}}}),[["__scopeId","data-v-9a761ca9"]]),ka=[{path:"pages/asplash/index",type:"home",style:{navigationStyle:"custom"}},{path:"pages/autoapply/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/baseInfo/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/bindphone/index",type:"page",style:{navigationBarTitleText:"手机号码换绑",navigationBarBackgroundColor:"#f3f5f6"}},{path:"pages/block/index",type:"page",style:{navigationBarTitleText:"黑名单",navigationBarBackgroundColor:"#f3f5f6"}},{path:"pages/connect/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/connectus/index",type:"page",style:{navigationBarTitleText:"联系我们",navigationBarBackgroundColor:"#f3f5f6"}},{path:"pages/invite/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/inviteList/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/login/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/message/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/notice/index",type:"page",style:{navigationBarTitleText:"消息通知",navigationBarBackgroundColor:"#ffffff"}},{path:"pages/own/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/person/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/policy/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/postDetail/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/profile/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/publish/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/realcheck/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/search/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/settings/index",type:"page",style:{navigationBarTitleText:"设置",navigationBarBackgroundColor:"#f3f5f6"}},{path:"pages/square/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/suggestion/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/systemauth/index",type:"page",style:{navigationBarTitleText:"系统权限管理",navigationBarBackgroundColor:"#f3f5f6"}},{path:"pages/validate/index",type:"page",style:{navigationBarTitleText:"认证中心",navigationBarBackgroundColor:"#f3f5f6"}},{path:"pages/views/login",type:"page",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"pages/views/profile",type:"page",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"pages/vip/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/wallet/index",type:"page",style:{navigationStyle:"custom"}},{path:"pages/withdraw/index",type:"page",style:{navigationStyle:"custom"}},{path:"TUIKit/components/TUIConversation/index",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"TUIKit/components/TUIChat/index",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"TUIKit/components/TUIContact/index",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"TUIKit/components/TUIChat/video-play",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"TUIKit/components/TUIChat/web-view",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"TUIKit/components/TUIGroup/index",style:{navigationBarTitleText:"腾讯云 IM"}},{path:"TUIKit/components/TUISearch/index",style:{navigationBarTitleText:"聊天记录"}}],Ea=[],Ta=((e="needLogin")=>{const t=[...ka.filter((t=>!e||t[e])).map((e=>__spreadProps(__spreadValues({},e),{path:`/${e.path}`})))],n=[];Ea.forEach((t=>{const{root:o}=t;t.pages.filter((t=>!e||t[e])).forEach((e=>{n.push(__spreadProps(__spreadValues({},e),{path:`/${o}/${e.path}`}))}))}));return[...t,...n]})("needLogin").map((e=>e.path)),Sa=e=>e.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2"),Ma=e=>aa.get("/prod-api/common/sms/send",{phone:e}),wa=e=>aa.post("/prod-api/app/user/login",e),ba=ee(e.defineComponent({__name:"index",setup(t){const n=It(),{pagePadding:o}=Et(0,15,0,15),a=e.reactive({uuid:"",code:"",phone:""}),i=e.computed((()=>/^1[3-9]\d{9}$/.test(a.phone)&&a.code)),r=e.ref(""),s=e.ref(null),l=e.ref(60),c=e.ref(!0),u=e.computed((()=>/^1[3-9]\d{9}$/.test(a.phone)&&c.value)),d=()=>__async(this,null,(function*(){c.value=!1,l.value=60,s.value=setInterval((()=>{l.value>0?l.value-=1:clearInterval(s.value)}),1e3);const e=yield Ma(a.phone);r.value=e.code,a.uuid=e.uuid})),p=()=>__async(this,null,(function*(){if(a.code!==r.value)return uni.showToast({title:"验证码错误",icon:"none",duration:1500});try{yield(e={uuid:a.uuid,phone:a.phone},aa.post("/prod-api/app/user/login",e)),uni.showToast({title:"手机号码换绑成功",icon:"none",duration:2e3})}catch(t){}var e}));return(t,r)=>{const s=ae(e.resolveDynamicComponent("wd-img"),te),h=ae(e.resolveDynamicComponent("wd-input"),lo),f=ae(e.resolveDynamicComponent("wd-button"),Te);return e.openBlock(),e.createElementBlock("view",{class:"bindphone_container",style:e.normalizeStyle({padding:e.unref(o)})},[e.createElementVNode("view",{class:"curPhone"}," 现绑定手机号 "+e.toDisplayString(e.unref(Sa)(e.unref(n).userInfo.phonenumber)),1),e.createElementVNode("view",{class:"form"},[e.createElementVNode("view",{class:"formItem"},[e.createElementVNode("view",{class:"label"},[e.createVNode(s,{class:"w-24px h-24px mr-8px",src:"/static/images/phone2.png"}),e.createTextVNode(" 手机号 ")]),e.createVNode(h,{type:"number",modelValue:a.phone,"onUpdate:modelValue":r[0]||(r[0]=e=>a.phone=e),placeholder:"请输入手机号码"},null,8,["modelValue"])]),e.createElementVNode("view",{class:"formItem"},[e.createElementVNode("view",{class:"label"},[e.createVNode(s,{class:"w-24px h-24px mr-8px",src:"/static/images/code.png"}),e.createTextVNode(" 验证码 ")]),e.createElementVNode("view",{class:"flex items-center justify-between"},[e.createVNode(h,{class:"codeInput",type:"number",modelValue:a.code,"onUpdate:modelValue":r[1]||(r[1]=e=>a.code=e),placeholder:"请输入验证码"},null,8,["modelValue"]),e.createVNode(f,{class:"codeBtn",size:"small",disabled:!e.unref(u),onClick:d},{default:e.withCtx((()=>[e.unref(c)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode("获取验证码")],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode("重新获取 ("+e.toDisplayString(e.unref(l))+")",1)],64))])),_:1},8,["disabled"])])])]),e.createVNode(f,{class:"confirmBtn",block:"",disabled:!e.unref(i),onClick:p},{default:e.withCtx((()=>[e.createTextVNode(" 确认 ")])),_:1},8,["disabled"])],4)}}}),[["__scopeId","data-v-b1b6c212"]]);const Da=ee({},[["render",function(t,n){const o=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"user3card"},[e.createVNode(o,{class:"avatar",src:"/static/images/image.png"}),e.createElementVNode("view",{class:"h-100% flex-1 flex flex-col"},[e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",{class:"name"},"石榴籽儿"),e.createVNode(o,{class:"icon",src:"/static/images/vip.png"}),e.createVNode(o,{class:"icon",src:"/static/images/checked.png"})]),e.createElementVNode("view",{class:"line1"},[e.createElementVNode("view",null,"马莉莉"),e.createElementVNode("view",{class:"divider"}),e.createElementVNode("view",null,"310098888888888"),e.createElementVNode("view",{class:"divider"}),e.createVNode(o,{class:"w-12px h-12px",src:"/static/images/male.png"}),e.createElementVNode("view",null,"·26岁")]),e.createElementVNode("view",{class:"line1"},[e.createElementVNode("view",null,"梦缘ID：100000001")]),e.createElementVNode("view",{class:"reason"},"原因:后台返回拉黑原因，后台返回拉黑原因后")])])}],["__scopeId","data-v-97fa4eef"]]),Na=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15);return(t,o)=>{const a=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"black_contianer",style:e.normalizeStyle({padding:e.unref(n)})},[e.createVNode(a,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(9,(t=>e.createVNode(Da,{key:t,class:"card"}))),64))])),_:1})],4)}}}),[["__scopeId","data-v-c4580c0b"]]),Ra=__spreadProps(__spreadValues({},X),{current:W(0),direction:J("horizontal"),minShowNum:W(2),indicatorPosition:J("bottom"),showControls:$(!1),total:W(0),type:J("dots")}),La=ee(e.defineComponent({__name:"wd-swiper-nav",props:Ra,emits:["change"],setup(t,{emit:n}){const o=n;function a(e){o("change",{dir:e,source:"nav"})}return(t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[t.showControls?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-swiper-nav__btn"},[e.createElementVNode("view",{class:"wd-swiper-nav__btn--prev",onClick:n[0]||(n[0]=e=>a("prev"))}),e.createElementVNode("view",{class:"wd-swiper-nav__btn--next",onClick:n[1]||(n[1]=e=>a("next"))})])):e.createCommentVNode("",!0),t.total>=t.minShowNum?(e.openBlock(),e.createElementBlock("view",{key:1,style:e.normalizeStyle(t.customStyle),class:e.normalizeClass(`wd-swiper-nav wd-swiper-nav--${t.direction} wd-swiper-nav--${t.type} wd-swiper-nav--${t.indicatorPosition} ${t.customClass}`)},["dots"===t.type||"dots-bar"===t.type?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(t.total,((n,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,class:e.normalizeClass(`wd-swiper-nav__item--${t.type} ${t.current===o?"is-active":""} is-${t.direction}`)},null,2)))),128)):e.createCommentVNode("",!0),"fraction"===t.type?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(t.current+1)+"/"+e.toDisplayString(t.total),1)],64)):e.createCommentVNode("",!0)],6)):e.createCommentVNode("",!0)],64))}}),[["__scopeId","data-v-30cb510a"]]),Aa=__spreadProps(__spreadValues({},X),{autoplay:$(!0),current:W(0),direction:J("horizontal"),displayMultipleItems:W(1),duration:W(300),easingFunction:J("default"),height:Z("192"),interval:W(5e3),list:{type:Array,default:()=>[]},loop:$(!0),videoLoop:$(!0),muted:$(!0),nextMargin:Z("0"),indicatorPosition:J("bottom"),previousMargin:Z("0"),snapToEdge:$(!1),indicator:{type:[Boolean,Object],default:!0},imageMode:J("aspectFill"),valueKey:J("value"),textKey:J("text"),autoplayVideo:$(!0),stopPreviousVideo:$(!0),stopAutoplayWhenVideoPlay:$(!1),adjustHeight:J("highest"),adjustVerticalHeight:$(!1),customIndicatorClass:J(""),customImageClass:J(""),customPrevImageClass:J(""),customNextImageClass:J(""),customItemClass:J(""),customPrevClass:J(""),customNextClass:J(""),customTextClass:J(""),customTextStyle:J("")}),Oa=e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-swiper",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Aa,emits:["click","change","animationfinish","update:current"],setup(t,{emit:n}){const o=t,a=n,i=e.ref(o.current),r=e.ref(o.current),s=(e,t=!1)=>{r.value=e,t&&(i.value=e),a("update:current",e)},l=e.ref(!1),{proxy:c}=e.getCurrentInstance(),u=e.ref(g());e.watch((()=>o.current),(e=>{e<0?o.loop?m():f():e>=o.list.length?o.loop?f():m():h(e)}));const d=e.computed((()=>{const{list:e,direction:t,indicatorPosition:n,indicator:a}=o,i={current:r.value||0,total:e.length||0,direction:t||"horizontal",indicatorPosition:n||"bottom"};return _(a)&&(i.type=a.type||"dots",i.minShowNum=a.minShowNum||2,i.showControls=a.showControls||!1),i})),p=e=>((e,t)=>{const n=e=>H(e);return _(e)?e.type&&["video","image"].includes(e.type)?e.type===t:n(e[o.valueKey]):n(e)})(e,"video");function h(e){e!==r.value&&s(e,!0)}function f(){h(0)}function m(){h(o.list.length-1)}function y(){o.stopAutoplayWhenVideoPlay&&(l.value=!0)}function I(){l.value=!1}function k(e,t,n){let a="";return function(e,t,n){return(e-1+n.length)%n.length===t}(e,t,n)&&(a=o.customPrevClass||o.customPrevImageClass),function(e,t,n){return(e+1+n.length)%n.length===t}(e,t,n)&&(a=o.customNextClass||o.customNextImageClass),a}function E(e){const{current:t,source:n}=e.detail,i=r.value;if(a("change",{current:t,source:n}),t!==r.value){s(t,"autoplay"===n||"touch"===n)}!function(e,t){(function(e){if(o.stopPreviousVideo){const t=o.list[e];if(C(t)&&p(t)){uni.createVideoContext(`video-${e}-${u.value}`,c).pause()}}else o.stopAutoplayWhenVideoPlay&&I()})(e),function(e){if(o.autoplayVideo){const t=o.list[e];if(C(t)&&p(t)){uni.createVideoContext(`video-${e}-${u.value}`,c).play()}}}(t)}(i,t)}function T(e){const{current:t,source:n}=e.detail;if(t!==r.value){s(t,"autoplay"===n||"touch"===n)}a("animationfinish",{current:t,source:n})}function S(e,t){a("click",{index:e,item:t})}function M({dir:e}){const{list:t,loop:n}=o,a=t.length;let i="next"===e?r.value+1:r.value-1;i=n?"next"===e?(r.value+1)%a:(r.value-1+a)%a:i<0||i>=a?r.value:i,i!==r.value&&h(i)}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-swiper ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[e.createElementVNode("swiper",{"adjust-height":t.adjustHeight,"adjust-vertical-height":t.adjustVerticalHeight,class:"wd-swiper__track",autoplay:t.autoplay&&!l.value,current:i.value,interval:t.interval,duration:t.duration,circular:t.loop,vertical:"vertical"==t.direction,"easing-function":t.easingFunction,"previous-margin":e.unref(v)(t.previousMargin),"next-margin":e.unref(v)(t.nextMargin),"snap-to-edge":t.snapToEdge,"display-multiple-items":t.displayMultipleItems,style:e.normalizeStyle({height:e.unref(v)(t.height)}),onChange:E,onAnimationfinish:T},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list,((n,o)=>(e.openBlock(),e.createElementBlock("swiper-item",{key:o,class:"wd-swiper__item"},[p(n)?(e.openBlock(),e.createElementBlock("video",{key:0,id:`video-${o}-${u.value}`,style:e.normalizeStyle({height:e.unref(v)(t.height)}),src:e.unref(_)(n)?n[t.valueKey]:n,poster:e.unref(_)(n)?n.poster:"",class:e.normalizeClass(`wd-swiper__video ${t.customItemClass} ${k(r.value,o,t.list)}`),onPlay:y,onPause:I,"enable-progress-gesture":!1,loop:t.videoLoop,muted:t.muted,autoplay:t.autoplayVideo,objectFit:"cover",onClick:e=>S(o,n)},null,46,["id","src","poster","loop","muted","autoplay","onClick"])):(e.openBlock(),e.createElementBlock("image",{key:1,src:e.unref(_)(n)?n[t.valueKey]:n,class:e.normalizeClass(`wd-swiper__image ${t.customImageClass} ${t.customItemClass} ${k(r.value,o,t.list)}`),style:e.normalizeStyle({height:e.unref(v)(t.height)}),mode:t.imageMode,onClick:e=>S(o,n)},null,14,["src","mode","onClick"])),e.unref(_)(n)&&n[t.textKey]?(e.openBlock(),e.createElementBlock("text",{key:2,class:e.normalizeClass(`wd-swiper__text ${t.customTextClass}`),style:e.normalizeStyle(t.customTextStyle)},e.toDisplayString(n[t.textKey]),7)):e.createCommentVNode("",!0)])))),128))],44,["adjust-height","adjust-vertical-height","autoplay","current","interval","duration","circular","vertical","easing-function","previous-margin","next-margin","snap-to-edge","display-multiple-items"]),t.indicator?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.renderSlot(t.$slots,"indicator",{current:r.value,total:t.list.length},void 0,!0),t.$slots.indicator?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(La,{key:0,"custom-class":t.customIndicatorClass,type:d.value.type,current:d.value.current,total:d.value.total,direction:d.value.direction,"indicator-position":d.value.indicatorPosition,"min-show-num":d.value.minShowNum,"show-controls":d.value.showControls,onChange:M},null,8,["custom-class","type","current","total","direction","indicator-position","min-show-num","show-controls"]))],64)):e.createCommentVNode("",!0)],6))}})),Pa=ee(Oa,[["__scopeId","data-v-3e5c0fb1"]]),Ua=Symbol("wd-tabs"),xa=__spreadProps(__spreadValues({},X),{modelValue:Z(0),slidableNum:W(6),mapNum:W(10),mapTitle:String,sticky:$(!1),offsetTop:W(0),swipeable:$(!1),autoLineWidth:$(!1),lineWidth:q,lineHeight:q,color:J(""),inactiveColor:J(""),animated:$(!1),duration:W(300),slidable:J("auto")}),Va=__spreadProps(__spreadValues({},X),{name:q,title:String,disabled:$(!1),lazy:$(!0),badgeProps:Object}),Ba=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-tab",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Va,setup(t){const n=t,{proxy:o}=e.getCurrentInstance(),{parent:a,index:i}=wt(Ua),r=e.computed((()=>!!C(a)&&a.state.activeIndex===i.value)),s=e.ref(r.value),l=e.computed((()=>{const e={};return r.value||C(a)&&a.props.animated||(e.display="none"),P(e)})),c=e.computed((()=>!n.lazy||s.value||r.value));return e.watch(r,(e=>{e&&(s.value=!0)})),e.watch((()=>n.name),(e=>{(!C(e)||A(e)||L(e))&&a&&function(e){const{name:t}=n;if(null==t||""===t)return;a&&a.children.forEach((t=>{t.$.uid!==e.$.uid&&t.name}))}(o)}),{deep:!0,immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-tab ${t.customClass}`),style:e.normalizeStyle(t.customStyle)},[c.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["wd-tab__body",{"wd-tab__body--inactive":!r.value}]),style:e.normalizeStyle(l.value)},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)):e.createCommentVNode("",!0)],6))}})),[["__scopeId","data-v-9d733961"]]),Ga=__spreadProps(__spreadValues({},X),{modelValue:q,showZero:$(!1),bgColor:String,max:Number,isDot:Boolean,hidden:Boolean,type:J(void 0),top:q,right:q}),Fa=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-badge",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:Ga,setup(t){const n=t,o=e.computed((()=>{const{modelValue:e,max:t,isDot:o}=n;if(o)return"";let a=e;return a&&t&&A(a)&&!Number.isNaN(a)&&!Number.isNaN(t)&&(a=t<a?`${t}+`:a),a})),a=e.computed((()=>{const e={};return C(n.bgColor)&&(e.backgroundColor=n.bgColor),C(n.top)&&(e.top=v(n.top)),C(n.right)&&(e.right=v(n.right)),P(e)})),i=e.computed((()=>!n.hidden&&(o.value||0===o.value&&n.showZero||n.isDot)));return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["wd-badge",t.customClass]),style:e.normalizeStyle(t.customStyle)},[e.renderSlot(t.$slots,"default",{},void 0,!0),i.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(["wd-badge__content","is-fixed",t.type?"wd-badge__content--"+t.type:"",t.isDot?"is-dot":""]),style:e.normalizeStyle(a.value)},e.toDisplayString(o.value),7)):e.createCommentVNode("",!0)],6))}})),[["__scopeId","data-v-019b04f1"]]),za=__spreadProps(__spreadValues({},X),{customContainerClass:J("")}),Ha=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-resize",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:za,emits:["resize"],setup(t,{emit:n}){const o=t,a=n,i=e.ref(0),r=e.ref(0),s=e.ref(0),l=e.ref(0),c=e.ref(0),u=e.ref(0),d=e.ref(0),p=e.computed((()=>`${P({width:v(u.value),height:v(c.value)})};${o.customStyle}`));let h=()=>{};const{proxy:f}=e.getCurrentInstance(),m=e.ref(`resize${g()}`);function _({lastWidth:e,lastHeight:t}){i.value=1e5+t,r.value=3*c.value+t,s.value=1e5+e,l.value=3*u.value+e}return e.onMounted((()=>{uni.createSelectorQuery().in(f).select(`#${m.value}`).boundingClientRect().exec((([e])=>{let t=e.height,n=e.width;c.value=t,u.value=n,h=()=>{uni.createSelectorQuery().in(f).select(`#${m.value}`).boundingClientRect().exec((([e])=>{if(0==d.value++){const t={};["bottom","top","left","right","height","width"].forEach((n=>{t[n]=e[n]})),a("resize",t)}if(d.value<3)return;const o=e.height,i=e.width;c.value=o,u.value=i;const r=[];if(o!==t&&(t=o,r.push(1)),i!==n&&(n=i,r.push(1)),0!==r.length){const t={};["bottom","top","left","right","height","width"].forEach((n=>{t[n]=e[n]})),a("resize",t)}_({lastWidth:n,lastHeight:t})}))},_({lastWidth:n,lastHeight:t})}))})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-resize ${t.customClass}`),style:e.normalizeStyle(p.value)},[e.createElementVNode("view",{id:m.value,class:e.normalizeClass(`wd-resize__container ${t.customContainerClass}`)},[e.renderSlot(t.$slots,"default",{},void 0,!0),e.createElementVNode("scroll-view",{class:"wd-resize__wrapper","scroll-y":!0,"scroll-top":i.value,"scroll-x":!0,"scroll-left":s.value,onScroll:n[0]||(n[0]=(...t)=>e.unref(h)&&e.unref(h)(...t))},[e.createElementVNode("view",{class:"wd-resize__wrapper--placeholder",style:{height:"100000px",width:"100000px"}})],40,["scroll-top","scroll-left"]),e.createElementVNode("scroll-view",{class:"wd-resize__wrapper","scroll-y":!0,"scroll-top":r.value,"scroll-x":!0,"scroll-left":l.value,onScroll:n[1]||(n[1]=(...t)=>e.unref(h)&&e.unref(h)(...t))},[e.createElementVNode("view",{class:"wd-resize__wrapper--placeholder",style:{height:"250%",width:"250%"}})],40,["scroll-top","scroll-left"])],10,["id"])],6))}})),[["__scopeId","data-v-224b5eff"]]),ja=__spreadProps(__spreadValues({},X),{zIndex:W(1),offsetTop:W(0)}),qa=Symbol("wd-sticky-box"),Ka=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-sticky",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:ja,setup(t,{expose:n}){const o=t,a=e.ref(`wd-sticky${g()}`),i=e.ref([]),r=e.reactive({position:"absolute",boxLeaved:!1,top:0,height:0,width:0,state:""}),{parent:s}=wt(qa),{proxy:l}=e.getCurrentInstance(),c=e.computed((()=>{const e={"z-index":o.zIndex,height:v(r.height),width:v(r.width)};return r.boxLeaved||(e.position="relative"),`${P(e)};${o.customStyle}`})),u=e.computed((()=>{const e={"z-index":o.zIndex,height:v(r.height),width:v(r.width)};return r.boxLeaved||(e.position="relative"),`${P(e)};`})),d=e.computed((()=>P({position:r.position,top:v(r.top)}))),p=e.computed((()=>0+o.offsetTop));function h(e){return __async(this,null,(function*(){r.width=e.width,r.height=e.height,yield U(),function(){if(0===r.height&&0===r.width)return;const e=p.value+r.height;(function(){for(;0!==i.value.length;)i.value.pop().disconnect()})(),function(){const e=uni.createIntersectionObserver(l,{thresholds:[0,.5]});return i.value.push(e),e}().relativeToViewport({top:-e}).observe(`#${a.value}`,(e=>{f(e)})),D(`#${a.value}`,!1,l).then((t=>{Number(t.bottom)<=e&&f({boundingClientRect:t})}))}(),s&&s.observerForChild&&s.observerForChild(l)}))}function f({boundingClientRect:e}){if(s&&r.height>=s.boxStyle.height)return r.position="absolute",void(r.top=0);let t=e.top<=p.value;t=e.top<p.value,t?(r.state="sticky",r.boxLeaved=!1,r.position="fixed",r.top=p.value):(r.state="normal",r.boxLeaved=!1,r.position="absolute",r.top=0)}return n({setPosition:function(e,t,n){r.boxLeaved=e,r.position=t,r.top=n},stickyState:r,offsetTop:o.offsetTop}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{style:e.normalizeStyle(`${c.value};display: inline-block;`)},[e.createElementVNode("view",{class:e.normalizeClass(`wd-sticky ${t.customClass}`),style:e.normalizeStyle(u.value),id:a.value},[e.createElementVNode("view",{class:"wd-sticky__container",style:e.normalizeStyle(d.value)},[e.createVNode(Ha,{onResize:h,"custom-style":"display: inline-block;"},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},void 0,!0)])),_:3})],4)],14,["id"])],4))}})),[["__scopeId","data-v-26e74d29"]]),Ya=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-sticky-box",options:{addGlobalClass:!0,styleIsolation:"shared"}}),{props:X,setup(t){const n=t,o=e.ref(`wd-sticky-box${g()}`),a=e.ref(new Map),i=e.reactive({height:0,width:0}),{proxy:r}=e.getCurrentInstance(),{children:s,linkChildren:l}=Co(qa);function c(e){i.width=e.width,i.height=e.height;const t=a.value;a.value=new Map;for(const[n]of t){u(s.find((e=>e.$.uid===n)))}t.forEach((e=>{e.disconnect()})),t.clear()}function u(e){!function(e){const t=a.value.get(e.$.uid);t&&(t.disconnect(),a.value.delete(e.$.uid))}(e);const t=function(e){const t=uni.createIntersectionObserver(r,{thresholds:[0,.5]});return a.value.set(e.$.uid,t),t}(e),n=e.$.exposed;let s=n.stickyState.height+n.offsetTop;i.height<=n.stickyState.height&&n.setPosition(!1,"absolute",0),t.relativeToViewport({top:-s}).observe(`#${o.value}`,(e=>{d(n,e)})),D(`#${o.value}`,!1,r).then((e=>{Number(e.bottom)<=s&&d(n,{boundingClientRect:e})})).catch((e=>{}))}function d(e,{boundingClientRect:t}){let n=e.offsetTop;const o=e.stickyState.height+n;let a=t.bottom<=o;if(a=t.bottom<o,a)e.setPosition(!0,"absolute",t.height-e.stickyState.height);else if(t.top<=o&&!a){if("normal"===e.stickyState.state)return;e.setPosition(!1,"fixed",n)}}return l({boxStyle:i,observerForChild:u}),e.onBeforeMount((()=>{a.value=new Map})),(t,a)=>(e.openBlock(),e.createElementBlock("view",{style:{position:"relative"}},[e.createElementVNode("view",{class:e.normalizeClass(`wd-sticky-box ${n.customClass}`),style:e.normalizeStyle(t.customStyle),id:o.value},[e.createVNode(Ha,{onResize:c},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},void 0,!0)])),_:3})],14,["id"])]))}})),[["__scopeId","data-v-d250ad24"]]);const $a=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-tabs",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:xa,emits:["change","disabled","click","update:modelValue"],setup(t,{expose:n,emit:o}){const a=".wd-tabs__nav-item",i=t,r=o,{translate:s}=Pt("tabs"),l=e.reactive({activeIndex:0,lineStyle:"display:none;",useInnerLine:!1,inited:!1,animating:!1,mapShow:!1,scrollLeft:0}),{children:c,linkChildren:u}=Co(Ua);u({state:l,props:i});const{proxy:d}=e.getCurrentInstance(),p=function(){const t=e.ref(""),n=e.ref(0),o=e.ref(0),a=e.ref(0),i=e.ref(0),r=e.ref(0),s=e.ref(0);return{touchStart:function(e){const l=e.touches[0];t.value="",n.value=0,o.value=0,a.value=0,i.value=0,r.value=l.clientX,s.value=l.clientY},touchMove:function(e){const l=e.touches[0];n.value=l.clientX-r.value,o.value=l.clientY-s.value,a.value=Math.abs(n.value),i.value=Math.abs(o.value),t.value=a.value>i.value?"horizontal":a.value<i.value?"vertical":""},direction:t,deltaX:n,deltaY:o,offsetX:a,offsetY:i,startX:r,startY:s}}(),h=e.computed((()=>"always"===i.slidable||c.length>i.slidableNum)),f=e.computed((()=>i.animated?P({left:-100*l.activeIndex+"%","transition-duration":i.duration+"ms","-webkit-transition-duration":i.duration+"ms"}):"")),g=(e,t)=>C(e.name)?e.name:t,m=(e=0,t=!1,n=!0)=>{0!==c.length&&(e=b(e),c[e].disabled||(l.activeIndex=e,n&&(I(!1===t),E()),function(){if(!l.inited)return;const e=g(c[l.activeIndex],l.activeIndex);e!==i.modelValue&&(r("change",{index:l.activeIndex,name:e}),r("update:modelValue",e))}()))},_=G(m,100,{leading:!0});function y(){l.mapShow?(l.animating=!1,setTimeout((()=>{l.mapShow=!1}),300)):(l.mapShow=!0,setTimeout((()=>{l.animating=!0}),100))}function I(e=!0){return __async(this,null,(function*(){if(!l.inited)return;const{autoLineWidth:t,lineWidth:n,lineHeight:o}=i;try{const i={};if(C(n))i.width=v(n);else if(t){const e=yield D(".wd-tabs__nav-item-text",!0,d),t=Number(e[l.activeIndex].width);i.width=v(t)}C(o)&&(i.height=v(o),i.borderRadius=`calc(${v(o)} / 2)`);const r=yield D(a,!0,d),s=r[l.activeIndex];let c=r.slice(0,l.activeIndex).reduce(((e,t)=>e+Number(t.width)),0)+Number(s.width)/2;c&&(i.transform=`translateX(${c}px) translateX(-50%)`,e&&(i.transition="width 0.3s cubic-bezier(0.4, 0, 0.2, 1), transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);"),l.useInnerLine=!1,l.lineStyle=P(i))}catch(r){}}))}function E(){l.inited&&Promise.all([D(a,!0,d),D(".wd-tabs__nav-container",!1,d)]).then((([e,t])=>{const n=e[l.activeIndex],o=e.slice(0,l.activeIndex).reduce(((e,t)=>e+t.width),0)-(t.width-Number(n.width))/2;o===l.scrollLeft?l.scrollLeft=o+Math.random()/1e4:l.scrollLeft=o}))}function T(e){if(void 0===e)return;const{disabled:t}=c[e],n=g(c[e],e);t?r("disabled",{index:e,name:n}):(l.mapShow&&y(),_(e),r("click",{index:e,name:n}))}function S(e){i.swipeable&&p.touchStart(e)}function M(e){i.swipeable&&p.touchMove(e)}function w(){if(!i.swipeable)return;const{direction:e,deltaX:t,offsetX:n}=p;"horizontal"===e.value&&n.value>=50&&(t.value>0&&0!==l.activeIndex?_(l.activeIndex-1):t.value<0&&l.activeIndex!==c.length-1&&_(l.activeIndex+1))}function b(e){if(A(e)&&e>=c.length&&(e=0),L(e)){const t=c.findIndex((t=>t.name===e));e=-1===t?0:t}return e}return e.watch((()=>i.modelValue),(e=>{!A(e)&&L(e),""===e||C(e)}),{immediate:!0,deep:!0}),e.watch((()=>i.modelValue),(e=>{const t=b(e);_(e,!1,t!==l.activeIndex)}),{immediate:!1,deep:!0}),e.watch((()=>c.length),(()=>{l.inited&&e.nextTick((()=>{_(i.modelValue)}))})),e.watch((()=>i.slidableNum),(e=>{k(e,"slidableNum")})),e.watch((()=>i.mapNum),(e=>{k(e,"mapNum")})),e.onMounted((()=>{l.inited=!0,e.nextTick((()=>{m(i.modelValue,!0),l.useInnerLine=!0}))})),n({setActive:_,scrollIntoView:E,updateLineStyle:I}),(t,n)=>{const o=ae(e.resolveDynamicComponent("wd-badge"),Fa);return t.sticky?(e.openBlock(),e.createBlock(Ya,{key:0},{default:e.withCtx((()=>[e.createElementVNode("view",{class:e.normalizeClass(`wd-tabs ${t.customClass} ${h.value?"is-slide":""} ${t.mapNum<e.unref(c).length&&0!==t.mapNum?"is-map":""}`),style:e.normalizeStyle(t.customStyle)},[e.createVNode(Ka,{"offset-top":t.offsetTop},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"wd-tabs__nav wd-tabs__nav--sticky"},[e.createElementVNode("view",{class:"wd-tabs__nav--wrap"},[e.createElementVNode("scroll-view",{"scroll-x":h.value,"scroll-with-animation":"","scroll-left":l.scrollLeft},[e.createElementVNode("view",{class:"wd-tabs__nav-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((n,a)=>(e.openBlock(),e.createElementBlock("view",{onClick:e=>T(a),key:a,class:e.normalizeClass(`wd-tabs__nav-item  ${l.activeIndex===a?"is-active":""} ${n.disabled?"is-disabled":""}`),style:e.normalizeStyle(l.activeIndex===a?t.color?"color:"+t.color:"":t.inactiveColor?"color:"+t.inactiveColor:"")},[n.badgeProps?(e.openBlock(),e.createBlock(o,e.normalizeProps(e.mergeProps({key:0},n.badgeProps)),{default:e.withCtx((()=>[e.createElementVNode("text",{class:"wd-tabs__nav-item-text"},e.toDisplayString(n.title),1)])),_:2},1040)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"wd-tabs__nav-item-text"},e.toDisplayString(n.title),1)),l.activeIndex===a&&l.useInnerLine?(e.openBlock(),e.createElementBlock("view",{key:2,class:"wd-tabs__line wd-tabs__line--inner"})):e.createCommentVNode("",!0)],14,["onClick"])))),128)),e.createElementVNode("view",{class:"wd-tabs__line",style:e.normalizeStyle(l.lineStyle)},null,4)])],8,["scroll-x","scroll-left"])]),t.mapNum<e.unref(c).length&&0!==t.mapNum?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-tabs__map"},[e.createElementVNode("view",{class:e.normalizeClass("wd-tabs__map-btn  "+(l.animating?"is-open":"")),onClick:y},[e.createElementVNode("view",{class:e.normalizeClass("wd-tabs__map-arrow  "+(l.animating?"is-open":""))},[e.createVNode(_e,{name:"arrow-down"})],2)],2),e.createElementVNode("view",{class:"wd-tabs__map-header",style:e.normalizeStyle(`${l.mapShow?"":"display:none;"}  ${l.animating?"opacity:1;":""}`)},e.toDisplayString(t.mapTitle||e.unref(s)("all")),5),e.createElementVNode("view",{class:e.normalizeClass("wd-tabs__map-body  "+(l.animating?"is-open":"")),style:e.normalizeStyle(l.mapShow?"":"display:none")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((n,o)=>(e.openBlock(),e.createElementBlock("view",{class:"wd-tabs__map-nav-item",key:o,onClick:e=>T(o)},[e.createElementVNode("view",{class:e.normalizeClass(`wd-tabs__map-nav-btn ${l.activeIndex===o?"is-active":""}  ${n.disabled?"is-disabled":""}`),style:e.normalizeStyle(l.activeIndex===o?t.color?"color:"+t.color+";border-color:"+t.color:"":t.inactiveColor?"color:"+t.inactiveColor:"")},e.toDisplayString(n.title),7)],8,["onClick"])))),128))],6)])):e.createCommentVNode("",!0)])])),_:1},8,["offset-top"]),e.createElementVNode("view",{class:"wd-tabs__container",onTouchstart:S,onTouchmove:M,onTouchend:w,onTouchcancel:w},[e.createElementVNode("view",{class:e.normalizeClass(["wd-tabs__body",t.animated?"is-animated":""]),style:e.normalizeStyle(f.value)},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)],32),e.createElementVNode("view",{class:"wd-tabs__mask",style:e.normalizeStyle(`${l.mapShow?"":"display:none;"} ${l.animating?"opacity:1;":""}`),onClick:y},null,4)],6)])),_:3})):(e.openBlock(),e.createElementBlock("view",{key:1,class:e.normalizeClass(`wd-tabs ${t.customClass} ${h.value?"is-slide":""} ${t.mapNum<e.unref(c).length&&0!==t.mapNum?"is-map":""}`)},[e.createElementVNode("view",{class:"wd-tabs__nav"},[e.createElementVNode("view",{class:"wd-tabs__nav--wrap"},[e.createElementVNode("scroll-view",{"scroll-x":h.value,"scroll-with-animation":"","scroll-left":l.scrollLeft},[e.createElementVNode("view",{class:"wd-tabs__nav-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((n,a)=>(e.openBlock(),e.createElementBlock("view",{onClick:e=>T(a),key:a,class:e.normalizeClass(`wd-tabs__nav-item ${l.activeIndex===a?"is-active":""} ${n.disabled?"is-disabled":""}`),style:e.normalizeStyle(l.activeIndex===a?t.color?"color:"+t.color:"":t.inactiveColor?"color:"+t.inactiveColor:"")},[n.badgeProps?(e.openBlock(),e.createBlock(o,e.mergeProps({key:0,"custom-class":"wd-tabs__nav-item-badge"},n.badgeProps),{default:e.withCtx((()=>[e.createElementVNode("text",{class:"wd-tabs__nav-item-text"},e.toDisplayString(n.title),1)])),_:2},1040)):(e.openBlock(),e.createElementBlock("text",{key:1,class:"wd-tabs__nav-item-text"},e.toDisplayString(n.title),1)),l.activeIndex===a&&l.useInnerLine?(e.openBlock(),e.createElementBlock("view",{key:2,class:"wd-tabs__line wd-tabs__line--inner"})):e.createCommentVNode("",!0)],14,["onClick"])))),128)),e.createElementVNode("view",{class:"wd-tabs__line",style:e.normalizeStyle(l.lineStyle)},null,4)])],8,["scroll-x","scroll-left"])]),t.mapNum<e.unref(c).length&&0!==t.mapNum?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-tabs__map"},[e.createElementVNode("view",{class:"wd-tabs__map-btn",onClick:y},[e.createElementVNode("view",{class:e.normalizeClass("wd-tabs__map-arrow "+(l.animating?"is-open":""))},[e.createVNode(_e,{name:"arrow-down"})],2)]),e.createElementVNode("view",{class:"wd-tabs__map-header",style:e.normalizeStyle(`${l.mapShow?"":"display:none;"}  ${l.animating?"opacity:1;":""}`)},e.toDisplayString(t.mapTitle||e.unref(s)("all")),5),e.createElementVNode("view",{class:e.normalizeClass("wd-tabs__map-body "+(l.animating?"is-open":"")),style:e.normalizeStyle(l.mapShow?"":"display:none")},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"wd-tabs__map-nav-item",key:n,onClick:e=>T(n)},[e.createElementVNode("view",{class:e.normalizeClass(`wd-tabs__map-nav-btn ${l.activeIndex===n?"is-active":""}  ${t.disabled?"is-disabled":""}`)},e.toDisplayString(t.title),3)],8,["onClick"])))),128))],6)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"wd-tabs__container",onTouchstart:S,onTouchmove:M,onTouchend:w,onTouchcancel:w},[e.createElementVNode("view",{class:e.normalizeClass(["wd-tabs__body",t.animated?"is-animated":""]),style:e.normalizeStyle(f.value)},[e.renderSlot(t.$slots,"default",{},void 0,!0)],6)],32),e.createElementVNode("view",{class:"wd-tabs__mask",style:e.normalizeStyle(`${l.mapShow?"":"display:none;"}  ${l.animating?"opacity:1":""}`),onClick:y},null,4)],2))}}})),[["__scopeId","data-v-dbb5bc2a"]]);let Wa=[];const Za="__QUEUE_KEY__",Ja=Symbol("wd-drop-menu"),Xa=__spreadProps(__spreadValues({},X),{zIndex:W(12),direction:J("down"),modal:$(!0),closeOnClickModal:$(!0),duration:W(200)}),Qa=__spreadProps(__spreadValues({},X),{customTitle:J(""),customIcon:J(""),modelValue:[String,Number],options:Y(),disabled:$(!1),iconName:J("check"),title:String,icon:J("arrow-down"),iconSize:J("14px"),beforeToggle:Function,valueKey:J("value"),labelKey:J("label"),tipKey:J("tip"),customPopupClass:J(""),customPopupStyle:J("")}),ei=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-drop-menu-item",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Qa,emits:["change","update:modelValue","open","opened","closed","close"],setup(t,{expose:n,emit:o}){const a=t,i=o,r=e.inject(Za,null),s=e.ref(!1),l=e.ref(!1),c=e.ref(),u=e.ref(12),d=e.ref(!0),p=e.ref(!0),h=e.ref(0),{parent:f}=wt(Ja),{proxy:g}=e.getCurrentInstance(),m=e.computed((()=>{let e="";return e=s.value&&f?"down"===f.props.direction?`top: calc(var(--window-top) + ${f.offset.value}px); bottom: 0;`:`top: 0; bottom: calc(var(--window-bottom) + ${f.offset.value}px)`:"",e}));function v(){l.value&&(R(a.beforeToggle)?a.beforeToggle({status:!1,resolve:e=>{e&&_()}}):_())}function _(){l.value&&(l.value=!1)}function y(){l.value||(R(a.beforeToggle)?a.beforeToggle({status:!0,resolve:e=>{e&&I()}}):I())}function I(){s.value=!0,l.value=!0,f&&(d.value=Boolean(f.props.modal),h.value=Number(f.props.duration),p.value=Boolean(f.props.closeOnClickModal),c.value="down"===f.props.direction?"top":"bottom"),i("open")}function k(){s.value=!1,i("closed")}function E(){i("open")}function T(){i("opened")}function S(){i("close")}return e.watch((()=>a.modelValue),(e=>{C(e)}),{deep:!0,immediate:!0}),e.onBeforeMount((()=>{var e;r&&r.pushToQueue?r.pushToQueue(g):(e=g,Wa.push(e))})),e.onBeforeUnmount((()=>{var e;r&&r.removeFromQueue?r.removeFromQueue(g):(e=g,Wa=Wa.filter((t=>t.$.uid!==e.$.uid)))})),n({getShowPop:function(){return l.value},open:y,close:v,toggle:function(){l.value?v():y()}}),(t,n)=>s.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(`wd-drop-item  ${t.customClass}`),style:e.normalizeStyle(`z-index: ${u.value}; ${m.value};${t.customStyle}`)},[e.createVNode(So,{modelValue:l.value,"onUpdate:modelValue":n[0]||(n[0]=e=>l.value=e),"z-index":u.value,duration:h.value,position:c.value,"custom-style":`position: absolute; max-height: 80%;${t.customPopupStyle}`,"custom-class":t.customPopupClass,"modal-style":"position: absolute;",modal:d.value,"close-on-click-modal":!1,onClickModal:n[1]||(n[1]=e=>p.value&&v()),onBeforeEnter:E,onAfterEnter:T,onBeforeLeave:S,onAfterLeave:k},{default:e.withCtx((()=>[t.options.length?(e.openBlock(),e.createElementBlock("view",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.options,((n,o)=>(e.openBlock(),e.createElementBlock("view",{key:o,onClick:e=>function(e){if(a.disabled)return;const{valueKey:t}=a,n=a.options[e];i("update:modelValue",""!==n[t]&&void 0!==n[t]?n[t]:n),i("change",{value:""!==n[t]&&void 0!==n[t]?n[t]:n,selectedItem:n}),v()}(o),class:e.normalizeClass("wd-drop-item__option "+((""!==n[t.valueKey]?n[t.valueKey]:n)===t.modelValue?"is-active":""))},[e.createElementVNode("view",{class:e.normalizeClass(`wd-drop-item__title ${t.customTitle}`)},[e.createElementVNode("text",null,e.toDisplayString(n[t.labelKey]?n[t.labelKey]:n),1),n[t.tipKey]?(e.openBlock(),e.createElementBlock("text",{key:0,class:"wd-drop-item__tip"},e.toDisplayString(n[t.tipKey]),1)):e.createCommentVNode("",!0)],2),(""!==n[t.valueKey]?n[t.valueKey]:n)===t.modelValue?(e.openBlock(),e.createBlock(_e,{key:0,name:t.iconName,size:"20px",class:e.normalizeClass(`wd-drop-item__icon ${t.customIcon}`)},null,8,["name","class"])):e.createCommentVNode("",!0)],10,["onClick"])))),128))])):e.renderSlot(t.$slots,"default",{key:1},void 0,!0)])),_:3},8,["modelValue","z-index","duration","position","custom-style","custom-class","modal"])],6)):e.createCommentVNode("",!0)}})),[["__scopeId","data-v-7a651fe0"]]),ti=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-drop-menu",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:Xa,setup(t){const n=t,o=e.inject(Za,null),a=e.ref(`dropMenuId${g()}`),i=e.ref(0),r=e.ref(0),{proxy:s}=e.getCurrentInstance(),{linkChildren:l,children:c}=Co(Ja);function u(e){e.preventDefault(),e.stopPropagation()}function d(e){const{title:t,modelValue:n,options:o,valueKey:a,labelKey:i}=e;if(t)return t;for(let r=0,s=o.length;r<s;r++)if(n===o[r][a])return o[r][i]}function p(e){var t;e&&!e.disabled&&(o&&o.closeOther?o.closeOther(e):(t=e,Wa.forEach((e=>{e.$.uid!==t.$.uid&&e.$.exposed.close()}))),h(e))}function h(e){D(`#${a.value}`,!1,s).then((t=>{if(!t)return;const{top:o,bottom:a}=t;"down"===n.direction?i.value=Number(a):i.value=r.value-Number(o),e.$.exposed.toggle()}))}return l({props:n,fold:h,offset:i}),e.watch((()=>n.direction),(e=>{["up","down"].includes(e)}),{deep:!0,immediate:!0}),e.onBeforeMount((()=>{r.value=uni.getSystemInfoSync().windowHeight})),(t,n)=>{const o=ae(e.resolveDynamicComponent("wd-icon"),_e);return e.openBlock(),e.createElementBlock("view",{style:e.normalizeStyle(t.customStyle),class:e.normalizeClass(`wd-drop-menu ${t.customClass}`),onClick:e.withModifiers(u,["stop"]),id:a.value},[e.createElementVNode("view",{class:"wd-drop-menu__list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((t,n)=>(e.openBlock(),e.createElementBlock("view",{key:n,onClick:e=>p(t),class:e.normalizeClass(`wd-drop-menu__item ${t.disabled?"is-disabled":""} ${t.$.exposed.getShowPop()?"is-active":""}`)},[e.createElementVNode("view",{class:"wd-drop-menu__item-title"},[e.createElementVNode("view",{class:"wd-drop-menu__item-title-text"},e.toDisplayString(d(t)),1),e.createVNode(o,{name:t.icon,size:t.iconSize,"custom-class":"wd-drop-menu__arrow"},null,8,["name","size"])])],10,["onClick"])))),128))]),e.renderSlot(t.$slots,"default",{},void 0,!0)],14,["id"])}}})),[["__scopeId","data-v-0eef0830"]]),ni=e=>aa.post("/prod-api/app/index",e),oi=ee(e.defineComponent({__name:"user",props:{userData:{type:Object,default:()=>({})}},setup(t){const n=t,o=e.computed((()=>0===n.userData.sex?"/static/images/female.png":"/static/images/male.png"));return(n,a)=>{const i=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"user1card"},[e.createVNode(i,{class:"avatar",src:"/static/images/image.png"}),e.createElementVNode("view",{class:"h-100% flex-1 flex items-center justify-between"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",{class:"name"},e.toDisplayString(t.userData.nickName),1),"1"===t.userData.vipOpean?(e.openBlock(),e.createBlock(i,{key:0,class:"icon",src:"/static/images/vip.png"})):e.createCommentVNode("",!0),"1"===t.userData.hasRealName?(e.openBlock(),e.createBlock(i,{key:1,class:"icon",src:"/static/images/checked.png"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"line1"},[e.createElementVNode("view",null,e.toDisplayString(t.userData.locationCity)+" · "+e.toDisplayString(t.userData.distance?t.userData.distance.toFixed(2):"0.00")+"km ",1),e.createElementVNode("view",{class:"divider"}),e.createVNode(i,{class:"w-12px h-12px",src:e.unref(o)},null,8,["src"]),e.createElementVNode("view",null,"·"+e.toDisplayString(t.userData.age)+"岁",1)]),e.createElementVNode("view",{class:"line2"},[e.createElementVNode("view",{class:"type"},"近期活跃")])]),e.createElementVNode("view",{class:"right"},[e.createVNode(i,{class:"icon",src:"/static/images/heart.png"}),e.createTextVNode(" 打招呼 ")])])])}}}),[["__scopeId","data-v-e1ee087f"]]),ai=ee(e.defineComponent({__name:"index",setup(t){const n=e.ref([{iconPath:"/static/tabbar/home1.png",selectedIconPath:"/static/tabbar/home2.png",pagePath:"pages/connect/index",text:"缘分",active:!1},{iconPath:"/static/tabbar/guangchang1.png",selectedIconPath:"/static/tabbar/guangchang2.png",pagePath:"pages/square/index",text:"广场",active:!1},{iconPath:"/static/tabbar/message.png",selectedIconPath:"/static/tabbar/message.png",pagePath:"pages/publish/index",text:"CUSTOM",active:!1},{iconPath:"/static/tabbar/xiaoxi1.png",selectedIconPath:"/static/tabbar/xiaoxi2.png",pagePath:"pages/message/index",text:"消息",active:!1},{iconPath:"/static/tabbar/own1.png",selectedIconPath:"/static/tabbar/own2.png",pagePath:"pages/own/index",text:"我的",active:!1}]);return e.onMounted((()=>{(()=>{const e=getCurrentPages(),t=e[e.length-1].route;n.value=n.value.map((e=>(oe("log","at components/tabbar/index.vue:78",e.pagePath,t),__spreadProps(__spreadValues({},e),{active:e.pagePath===t}))))})()})),(t,o)=>{const a=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"app_tabbar"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(n.value,((t,o)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["tabbar_item",{custom:"CUSTOM"===t.text}]),key:o,onClick:e=>(e=>{let t;n.value.forEach(((n,o)=>{e===o&&(t=n.pagePath)})),uni.switchTab({url:`/${t}`})})(o)},[t.active?(e.openBlock(),e.createBlock(a,{key:0,class:e.normalizeClass(["CUSTOM"===t.text?"customIcon":"w-[30px] h-[30px]"]),src:t.selectedIconPath},null,8,["class","src"])):(e.openBlock(),e.createBlock(a,{key:1,class:e.normalizeClass(["CUSTOM"===t.text?"customIcon":"w-[30px] h-[30px]"]),src:t.iconPath},null,8,["class","src"])),e.createElementVNode("view",{class:e.normalizeClass(["tabbar_title",[t.active?"active":""]])},e.toDisplayString("CUSTOM"!==t.text?t.text:""),3)],10,["onClick"])))),128))])}}}),[["__scopeId","data-v-66f7a683"]]),ii=__spreadProps(__spreadValues({},X),{index:K([String,Number])}),ri={sticky:$(!1)},si=Symbol("wd-index-bar"),li=ee(e.defineComponent({__name:"wd-index-anchor",props:ii,setup(t,{expose:n}){const o=t,{parent:a}=wt(si),i=e.ref(`indexBar${g()}`),{proxy:r}=e.getCurrentInstance(),s=e.ref(0),l=e.computed((()=>a&&a.props.sticky&&a.anchorState.activeIndex===o.index));return e.onMounted((()=>{D(`#${i.value}`,!1,r).then((e=>{C(a)&&(s.value=Math.floor(e.top))}))})),n({top:s}),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(`wd-index-anchor ${l.value?"is-sticky":""} ${t.customClass}`),style:e.normalizeStyle(t.customStyle),id:i.value},[e.renderSlot(t.$slots,"default",{},(()=>[e.createTextVNode(e.toDisplayString(t.index),1)]),!0)],14,["id"]))}}),[["__scopeId","data-v-823e1bfb"]]),ci=__spreadProps(__spreadValues({},X),{title:String,value:Z(""),icon:String,label:String,isLink:$(!1),to:String,replace:$(!1),clickable:$(!1),size:String,border:$(void 0),titleWidth:String,center:$(!1),required:$(!1),vertical:$(!1),prop:String,rules:Y(),customIconClass:J(""),customLabelClass:J(""),customValueClass:J(""),customTitleClass:J("")}),ui=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-cell",options:{addGlobalClass:!0,virtualHost:!0,styleIsolation:"shared"}}),{props:ci,emits:["click"],setup(t,{emit:n}){const o=t,a=n,i=Dt(),r=e.computed((()=>Boolean(C(o.border)?o.border:i.border.value))),{parent:s}=wt(Nt),l=e.computed((()=>s&&o.prop&&s.errorMessages&&s.errorMessages[o.prop]?s.errorMessages[o.prop]:"")),c=e.computed((()=>{let e=!1;if(s&&s.props.rules){const t=s.props.rules;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&n===o.prop&&Array.isArray(t[n])&&(e=t[n].some((e=>e.required)))}return o.required||o.rules.some((e=>e.required))||e}));function u(){const e=o.to;(o.clickable||o.isLink)&&a("click"),e&&o.isLink&&(o.replace?uni.redirectTo({url:e}):uni.navigateTo({url:e}))}return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["wd-cell",r.value?"is-border":"",t.size?"is-"+t.size:"",t.center?"is-center":"",t.customClass]),style:e.normalizeStyle(t.customStyle),"hover-class":t.isLink||t.clickable?"is-hover":"none","hover-stay-time":70,onClick:u},[e.createElementVNode("view",{class:e.normalizeClass(["wd-cell__wrapper",t.vertical?"is-vertical":""])},[e.createElementVNode("view",{class:e.normalizeClass(["wd-cell__left",c.value?"is-required":""]),style:e.normalizeStyle(t.titleWidth?"min-width:"+t.titleWidth+";max-width:"+t.titleWidth+";":"")},[t.icon?(e.openBlock(),e.createBlock(_e,{key:0,name:t.icon,"custom-class":`wd-cell__icon  ${t.customIconClass}`},null,8,["name","custom-class"])):e.renderSlot(t.$slots,"icon",{key:1},void 0,!0),e.createElementVNode("view",{class:"wd-cell__title"},[t.title?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass(t.customTitleClass)},e.toDisplayString(t.title),3)):e.renderSlot(t.$slots,"title",{key:1},void 0,!0),t.label?(e.openBlock(),e.createElementBlock("view",{key:2,class:e.normalizeClass(`wd-cell__label ${t.customLabelClass}`)},e.toDisplayString(t.label),3)):e.renderSlot(t.$slots,"label",{key:3},void 0,!0)])],6),e.createElementVNode("view",{class:"wd-cell__right"},[e.createElementVNode("view",{class:"wd-cell__body"},[e.createElementVNode("view",{class:e.normalizeClass(`wd-cell__value ${t.customValueClass}`)},[e.renderSlot(t.$slots,"default",{},(()=>[e.createTextVNode(e.toDisplayString(t.value),1)]),!0)],2),t.isLink?(e.openBlock(),e.createBlock(_e,{key:0,"custom-class":"wd-cell__arrow-right",name:"arrow-right"})):e.renderSlot(t.$slots,"right-icon",{key:1},void 0,!0)]),l.value?(e.openBlock(),e.createElementBlock("view",{key:0,class:"wd-cell__error-message"},e.toDisplayString(l.value),1)):e.createCommentVNode("",!0)])],2)],14,["hover-class"]))}})),[["__scopeId","data-v-511ba0af"]]),di=e.defineComponent({__name:"wd-index-bar",props:ri,setup(t){const n=t,o=e.ref(`indexBar${g()}`),{proxy:a}=e.getCurrentInstance(),i=e.reactive({activeIndex:null}),{linkChildren:r,children:s}=Co(si);r({props:n,anchorState:i}),e.watch((()=>s),(e=>{e.length?C(i.activeIndex)&&e.find((e=>e.index===i.activeIndex))||(i.activeIndex=e[0].index):i.activeIndex=null}),{deep:!0,immediate:!0});const l=e.reactive({scrollTop:0,prevScrollTop:0,touching:!1});let c=0,u={offsetTop:0,indexHeight:24};function d(e){if(l.touching)return;const{detail:t}=e,n=Math.floor(t.scrollTop),o=s.find(((e,t)=>!C(s[t+1])||e.$.exposed.top.value-c<=n&&s[t+1].$.exposed.top.value-c>n));C(o)&&i.activeIndex!==o.index&&(i.activeIndex=o.index),l.prevScrollTop=n}function p(e){const t=e-u.offsetTop;let n=Math.floor(t/u.indexHeight);return n<0?n=0:n>s.length-1&&(n=s.length-1),s[n]}function h(){l.touching=!0}function f(e){const t=e.touches[0].pageY;i.activeIndex!==p(t).index&&(i.activeIndex=p(t).index,v(p(t).$.exposed.top.value-c))}function m(e){return __async(this,null,(function*(){const t=e.changedTouches[0].pageY;i.activeIndex=p(t).index,v(p(t).$.exposed.top.value-c),yield U(),l.touching=!1}))}function v(t){l.scrollTop===t?(l.scrollTop=l.prevScrollTop,e.nextTick((()=>{l.scrollTop=t}))):l.scrollTop=t}return e.onMounted((()=>{setTimeout((()=>{Promise.all([D(`#${o.value}`,!1,a),D(".wd-index-bar__sidebar",!1,a),D(".wd-index-bar__index",!1,a)]).then((([e,t,n])=>{c=e.top,u.offsetTop=t.top,u.indexHeight=n.height}))}),100)})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"wd-index-bar",id:o.value},[e.createElementVNode("scroll-view",{scrollTop:l.scrollTop,"scroll-y":!0,class:"wd-index-bar__content",onScroll:d},[e.renderSlot(t.$slots,"default",{},void 0,!0)],40,["scrollTop"]),e.createElementVNode("view",{class:"wd-index-bar__sidebar",onTouchstart:e.withModifiers(h,["stop","prevent"]),onTouchmove:e.withModifiers(f,["stop","prevent"]),onTouchend:e.withModifiers(m,["stop","prevent"]),onTouchcancel:e.withModifiers(m,["stop","prevent"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),(t=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(["wd-index-bar__index",{"is-active":t.index===i.activeIndex}]),key:t.index},e.toDisplayString(t.index),3)))),128))],32)],8,["id"]))}}),pi=ee(di,[["__scopeId","data-v-e41f0575"]]),hi=ee(e.defineComponent({__name:"index",props:{position:{type:String,default:"top"}},emits:["updateLoactionCity"],setup(t,{expose:n,emit:o}){const{pagePadding:a}=Et(0,10,10,10),i=It(),r=t,s=o,l=e.ref(!1),c=e.ref(!1),u=e.ref(!1),d=e.ref([]),p=e.ref([]),h=e.computed((()=>"top"===r.position?"border-bottom-left-radius:20px;border-bottom-right-radius:20px;":"")),f=()=>{l.value=!1},g=()=>__async(this,null,(function*(){u.value=!0,uni.getLocation({type:"wgs84",success:e=>__async(this,null,(function*(){const t=yield ra({latitude:e.latitude,longitude:e.longitude});yield la(__spreadProps(__spreadValues({},i.userInfo),{orientationCityId:t.data.cityCode,orientationDistrictId:t.data.districtCode,orientationProvinceId:t.data.provinceCode}));const n=yield sa();i.setUserInfo(n.data),u.value=!1,m({name:t.data.locationCity,code:t.data.cityCode})})),fail:e=>{oe("error","at components/location/index.vue:167","获取位置信息失败",e)}})})),m=(e,t=!0)=>{s("updateLoactionCity",e),t&&f()};return n({open:()=>__async(this,null,(function*(){c.value=!0,l.value=!0;const e=yield aa.get("/prod-api/system/code/list/city"),t=yield aa.get("/prod-api/system/code/hot/city");d.value=e.data.map((e=>({index:e.index,data:e.areaCode}))),p.value=t.data.map((e=>({name:e.name,code:e.code}))),c.value=!1})),close:f}),(n,o)=>{const r=ae(e.resolveDynamicComponent("wd-button"),Te),s=ae(e.resolveDynamicComponent("wd-loading"),uo),f=ae(e.resolveDynamicComponent("wd-index-anchor"),li),v=ae(e.resolveDynamicComponent("wd-cell"),ui),_=ae(e.resolveDynamicComponent("wd-index-bar"),pi),y=ae(e.resolveDynamicComponent("wd-popup"),So);return e.openBlock(),e.createBlock(y,{modelValue:e.unref(l),"onUpdate:modelValue":o[0]||(o[0]=t=>e.isRef(l)?l.value=t:null),position:t.position,"custom-style":e.unref(h)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"location_container",style:e.normalizeStyle({padding:e.unref(a)})},[e.createElementVNode("view",{class:"mb-10px"},[e.createElementVNode("view",{class:"title"},"重新定位"),e.createElementVNode("view",{class:"flex items-center"},[e.createVNode(r,{size:"small",icon:"location",loading:e.unref(u),class:e.normalizeClass([e.unref(i).userInfo.locationCity?"active":"inactive"]),onClick:g},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(i).userInfo.locationCity||"重新定位"),1)])),_:1},8,["loading","class"])])]),e.createElementVNode("view",{class:"mb-10px"},[e.createElementVNode("view",{class:"title"},"热门城市"),e.createElementVNode("view",{class:"hotCity"},[e.unref(c)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loadingBody"},[e.createVNode(s,{color:"#fd2b58"})])):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(p),((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"cityTag",key:n,onClick:e=>m(t)},e.toDisplayString(t.name),9,["onClick"])))),128))])]),e.createElementVNode("view",{class:"mt-10px"},[e.createElementVNode("view",{class:"title"},"城市选项"),e.unref(c)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"loadingBody"},[e.createVNode(s,{color:"#fd2b58"})])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"cityList"},[e.createVNode(_,{sticky:""},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(t=>(e.openBlock(),e.createElementBlock("view",{key:t.index},[e.createVNode(f,{index:t.index},null,8,["index"]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data,(t=>(e.openBlock(),e.createBlock(v,{border:"",clickable:"",key:t.code,title:t.name,onClick:e=>m(t)},null,8,["title","onClick"])))),128))])))),128))])),_:1})]))])],4)])),_:1},8,["modelValue","position","custom-style"])}}}),[["__scopeId","data-v-fcd5b93e"]]),fi=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,0,80,0),o=It(),a=e.ref({name:o.userInfo.locationCity,code:""}),i=e.ref(null),r=()=>{i.value.open()},s=e=>{a.value={name:e.name,code:e.code},"city"===h.indexType&&I()},l=e.ref(0),c=e.ref([]),u=e=>{oe("log","at pages/connect/index.vue:128",e.linkUrl)},d=e.ref(null),p=((e=20,t=50,n=5)=>{const o=[];for(let a=e;a<t;a++)o.push([a,a+n]);return o})().map((e=>({label:`${e[0]}岁 - ${e[1]}岁`,value:`${e[0]}-${e[1]}`}))),h=e.reactive({sex:2,cityCode:"",ageRange:"20-50",indexType:"recommend"}),f=e.ref(null),g=e.ref([]),m=()=>{uni.navigateTo({url:"/pages/search/index"})},v=()=>__async(this,null,(function*(){const{data:e}=yield aa.get("/prod-api/app/banner/list");c.value=e.map((e=>({imgUrl:e.bannerImageUrl,linkUrl:e.linkUrl})))})),_=()=>{h.sex=2,h.ageRange="20-50"},y=()=>{d.value.close(),I()},I=()=>__async(this,null,(function*(){const e=h.ageRange.split("-");h.cityCode=o.userInfo.orientationCityId;const{rows:t,total:n}=yield ni("city"===h.indexType&&a.value.code?{sex:2===h.sex?"":h.sex,indexType:h.indexType,startAge:e[0],endAge:e[1],cityCode:a.value.code}:{sex:2===h.sex?"":h.sex,indexType:h.indexType,startAge:e[0],endAge:e[1]});g.value=t,f.value.complete(g.value)}));return e.watch((()=>h.indexType),(e=>{I()}),{immediate:!1}),e.onMounted((()=>{uni.hideTabBar({animation:!1}),v()})),(t,o)=>{const v=ae(e.resolveDynamicComponent("wd-img"),te),C=ae(e.resolveDynamicComponent("wd-swiper"),Pa),k=ae(e.resolveDynamicComponent("wd-tab"),Ba),E=ae(e.resolveDynamicComponent("wd-tabs"),$a),T=ae(e.resolveDynamicComponent("wd-picker"),No),S=ae(e.resolveDynamicComponent("wd-button"),Te),M=ae(e.resolveDynamicComponent("wd-drop-menu-item"),ei),w=ae(e.resolveDynamicComponent("wd-drop-menu"),ti),b=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"connect_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"search"},[e.createElementVNode("view",{class:"city",onClick:r},[e.createTextVNode(e.toDisplayString(a.value.name)+" ",1),e.createVNode(v,{class:"icon",src:"/static/images/arrow3.png"})]),e.createVNode(v,{class:"icon",src:"/static/images/search.png",onClick:m})]),e.createVNode(C,{autoplay:"","value-key":"imgUrl",height:130,list:c.value,indicator:{type:"dots-bar"},current:l.value,"onUpdate:current":o[0]||(o[0]=e=>l.value=e),onClick:u},null,8,["list","current"]),e.createElementVNode("view",{class:"filter"},[e.createVNode(E,{class:"tab",modelValue:e.unref(h).indexType,"onUpdate:modelValue":o[1]||(o[1]=t=>e.unref(h).indexType=t)},{default:e.withCtx((()=>[e.createVNode(k,{title:"推荐",name:"recommend"}),e.createVNode(k,{title:"附近的人",name:"nearby"}),e.createVNode(k,{title:"同城",name:"city"})])),_:1},8,["modelValue"]),e.createVNode(w,{class:"menu"},{default:e.withCtx((()=>[e.createVNode(M,{title:"年龄段",ref_key:"filterRef",ref:d,icon:"fill-arrow-down","icon-size":"24px"},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"box-border p-5"},[e.createVNode(T,{"align-right":"",label:"性别：",placeholder:"请选择性别",modelValue:e.unref(h).sex,"onUpdate:modelValue":o[2]||(o[2]=t=>e.unref(h).sex=t),columns:[{label:"全部",value:2},{label:"男",value:0},{label:"女",value:1}]},null,8,["modelValue"]),e.createVNode(T,{"align-right":"",label:"年龄：",placeholder:"请选择年龄",modelValue:e.unref(h).ageRange,"onUpdate:modelValue":o[3]||(o[3]=t=>e.unref(h).ageRange=t),columns:e.unref(p)},null,8,["modelValue","columns"])]),e.createElementVNode("view",{class:"flex justify-evenly items-center mb-20px box-border pl-20px pr-20px"},[e.createVNode(S,{type:"info",onClick:_},{default:e.withCtx((()=>[e.createTextVNode("重置")])),_:1}),e.createVNode(S,{onClick:y},{default:e.withCtx((()=>[e.createTextVNode("确认")])),_:1})])])),_:1},512)])),_:1})]),e.createElementVNode("view",{class:"userList"},[e.createVNode(b,{class:"list_scroll",modelValue:g.value,"onUpdate:modelValue":o[4]||(o[4]=e=>g.value=e),ref_key:"userListRef",ref:f,fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1,"refresher-complete-text":"刷新完成","refresher-default-text":"下拉刷新","refresher-pulling-text":"释放刷新","refresher-refreshing-text":"加载中...","loading-more-no-more-text":"没有更多数据啦~",onQuery:I},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(g.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"card",key:n},[e.createVNode(oi,{userData:t,onClick:e=>{return n=t,void uni.navigateTo({url:`/pages/profile/index?type=other&id=${n.userId}`});var n}},null,8,["userData","onClick"])])))),128))])),_:1},8,["modelValue"])]),e.createVNode(hi,{ref_key:"locationRef",ref:i,onUpdateLoactionCity:s},null,512),e.createVNode(ai)],4)}}}),[["__scopeId","data-v-e3cfae11"]]),gi=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15);return(t,o)=>{const a=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"connectus_contianer",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"link"},[e.createElementVNode("view",{class:"iconBg"},[e.createVNode(a,{class:"w-30px h-30px",src:"/static/images/phone.png"})]),e.createElementVNode("view",{class:"mt-12px mb-12px color-#686A7A"},"联系方式"),e.createElementVNode("view",{class:"content"},"400-888-888")]),e.createElementVNode("view",{class:"link"},[e.createVNode(a,{class:"w-48px h-48px",src:"/static/images/wechat.png"}),e.createElementVNode("view",{class:"mt-12px mb-12px color-#686A7A"},"客服微信公众账号"),e.createElementVNode("view",{class:"content"},"梦缘婚恋")])],4)}}}),[["__scopeId","data-v-006f0a85"]]),mi=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,20,15),o=e.ref(!1),a=()=>{uni.navigateBack()},i=()=>{uni.navigateTo({url:"/pages/inviteList/index"})},r=()=>{o.value=!0},s=()=>{o.value=!1},l=()=>{e.nextTick((()=>{const e=uni.createCanvasContext("posterCanvas");(e=>{const t=e.map((e=>new Promise(((t,n)=>{uni.getImageInfo({src:e,success:e=>t(e),fail:e=>n(e)})}))));return Promise.all(t)})(["/static/images/background5.png","/static/images/money.png","/static/images/scanBg.png","/static/images/qr.png"]).then((([t,n,o,a])=>{e.drawImage(t.path,0,0,300,450),e.drawImage(n.path,28,-40,250,250),e.drawImage(o.path,25,210,260,40),e.drawImage(a.path,70,262,170,170),e.setFillStyle("#ffffff"),e.setFontSize(16),e.setTextAlign("center"),e.setTextBaseline("middle"),e.fillText("扫码注册后快来领奖品~",160,230),e.draw()}))}))},c=()=>{uni.canvasToTempFilePath({canvasId:"posterCanvas",success:e=>{const t=e.tempFilePath;uni.saveImageToPhotosAlbum({filePath:t,success:()=>{s(),uni.showToast({title:"已保存到相册",icon:"none"})},fail:e=>{oe("log","at pages/invite/index.vue:131","保存失败:",e),s(),uni.showToast({title:"保存失败",icon:"none"})}})},fail:e=>{oe("log","at pages/invite/index.vue:138","生成图片失败:",e)}},this)};return(t,u)=>{const d=ae(e.resolveDynamicComponent("wd-icon"),_e),p=ae(e.resolveDynamicComponent("wd-img"),te),h=ae(e.resolveDynamicComponent("wd-button"),Te),f=ae(e.resolveDynamicComponent("wd-popup"),So);return e.openBlock(),e.createElementBlock(e.Fragment,null,[e.createElementVNode("view",{class:"invite_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(d,{class:"back",name:"arrow-left",size:"18px",color:"#ffffff",onClick:a}),e.createElementVNode("view",null,"邀请好友")]),e.createElementVNode("view",{class:"list"},[e.createVNode(p,{class:"w-23px h-23px mr-10px",src:"/static/images/bell2.png"}),e.createTextVNode(" 恭喜您!您已邀请成功:99999人 "),e.createElementVNode("view",{class:"check",onClick:i},[e.createTextVNode(" 查看全部 "),e.createVNode(d,{name:"arrow-right",size:"15px",color:"#ffffff"})])]),e.createElementVNode("view",{class:"moneyBg"}),e.createElementVNode("view",{class:"scanBg"}),e.createElementVNode("view",{class:"qr w-310px h-310px"},[e.createVNode(p,{class:"w-220px h-220px",src:"/static/images/qr.png"}),e.createElementVNode("view",{class:"text"},"--扫码注册APP--")]),e.createElementVNode("view",{class:"btn"},[e.createVNode(h,{class:"btnColor w-314px",size:"large",onClick:r},{default:e.withCtx((()=>[e.createTextVNode("邀请好友")])),_:1}),e.createElementVNode("view",{class:"cancelBtn",onClick:r},"保存相册")])],4),e.createVNode(f,{"custom-style":"border-radius: 10px",modelValue:e.unref(o),"onUpdate:modelValue":u[0]||(u[0]=t=>e.isRef(o)?o.value=t:null),onAfterEnter:l},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"posterWrapper"},[e.createElementVNode("view",{class:"poster"},[e.createElementVNode("canvas",{style:{width:"300px",height:"450px"},"canvas-id":"posterCanvas",id:"posterCanvas"})]),e.createElementVNode("view",{class:"btns"},[e.createVNode(h,{type:"info",onClick:s},{default:e.withCtx((()=>[e.createTextVNode("取消")])),_:1}),e.createVNode(h,{onClick:c},{default:e.withCtx((()=>[e.createTextVNode("保存到本地")])),_:1})])])])),_:1},8,["modelValue"])],64)}}}),[["__scopeId","data-v-789ad822"]]),vi=ee(e.defineComponent({__name:"user4",props:{data:{type:Object,default:()=>({})}},setup:t=>(n,o)=>{const a=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"user4card"},[e.createVNode(a,{class:"avatar",src:t.data.avatar},null,8,["src"]),e.createElementVNode("view",{class:"h-100% flex-1 flex items-center justify-between"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",{class:"name"},e.toDisplayString(t.data.nickName),1),e.createVNode(a,{class:"icon",src:"/static/images/vip.png"}),e.createVNode(a,{class:"icon",src:"/static/images/checked.png"})]),e.createElementVNode("view",{class:"line1"},[e.createElementVNode("view",null,e.toDisplayString(t.data.realName),1)])]),e.createElementVNode("view",{class:"right"},"2024-12-12")])])}}),[["__scopeId","data-v-6a8bdf24"]]),_i=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.ref([]),a=()=>{uni.navigateBack()},i=()=>__async(this,null,(function*(){}));return e.onMounted((()=>{i()})),(t,i)=>{const r=ae(e.resolveDynamicComponent("wd-icon"),_e),s=ae(e.resolveDynamicComponent("wd-img"),te),l=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"inviteList_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(r,{class:"back",name:"arrow-left",size:"18px",onClick:a}),e.createElementVNode("view",{class:"title"},"我的邀请")]),e.createElementVNode("view",{class:"list"},[e.createVNode(l,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[o.value.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(o.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"card",key:n},[e.createVNode(vi,{data:t},null,8,["data"])])))),128)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty"},[e.createVNode(s,{class:"w-200px h-200px",src:"/static/images/empty.png"}),e.createTextVNode(" 暂无数据 ")]))])),_:1})])],4)}}}),[["__scopeId","data-v-d1640635"]]);var yi="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},Ii=[],Ci=[],ki="undefined"!=typeof Uint8Array?Uint8Array:Array,Ei=!1;function Ti(){Ei=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)Ii[t]=e[t],Ci[e.charCodeAt(t)]=t;Ci["-".charCodeAt(0)]=62,Ci["_".charCodeAt(0)]=63}function Si(e,t,n){for(var o,a,i=[],r=t;r<n;r+=3)o=(e[r]<<16)+(e[r+1]<<8)+e[r+2],i.push(Ii[(a=o)>>18&63]+Ii[a>>12&63]+Ii[a>>6&63]+Ii[63&a]);return i.join("")}function Mi(e){var t;Ei||Ti();for(var n=e.length,o=n%3,a="",i=[],r=0,s=n-o;r<s;r+=16383)i.push(Si(e,r,r+16383>s?s:r+16383));return 1===o?(t=e[n-1],a+=Ii[t>>2],a+=Ii[t<<4&63],a+="=="):2===o&&(t=(e[n-2]<<8)+e[n-1],a+=Ii[t>>10],a+=Ii[t>>4&63],a+=Ii[t<<2&63],a+="="),i.push(a),i.join("")}function wi(e,t,n,o,a){var i,r,s=8*a-o-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?a-1:0,p=n?-1:1,h=e[t+d];for(d+=p,i=h&(1<<-u)-1,h>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=p,u-=8);for(r=i&(1<<-u)-1,i>>=-u,u+=o;u>0;r=256*r+e[t+d],d+=p,u-=8);if(0===i)i=1-c;else{if(i===l)return r?NaN:1/0*(h?-1:1);r+=Math.pow(2,o),i-=c}return(h?-1:1)*r*Math.pow(2,i-o)}function bi(e,t,n,o,a,i){var r,s,l,c=8*i-a-1,u=(1<<c)-1,d=u>>1,p=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,h=o?0:i-1,f=o?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,r=u):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=u?(s=0,r=u):r+d>=1?(s=(t*l-1)*Math.pow(2,a),r+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),r=0));a>=8;e[n+h]=255&s,h+=f,s/=256,a-=8);for(r=r<<a|s,c+=a;c>0;e[n+h]=255&r,h+=f,r/=256,c-=8);e[n+h-f]|=128*g}var Di={}.toString,Ni=Array.isArray||function(e){return"[object Array]"==Di.call(e)};function Ri(){return Ai.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function Li(e,t){if(Ri()<t)throw new RangeError("Invalid typed array length");return Ai.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=Ai.prototype:(null===e&&(e=new Ai(t)),e.length=t),e}function Ai(e,t,n){if(!(Ai.TYPED_ARRAY_SUPPORT||this instanceof Ai))return new Ai(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return Ui(this,e)}return Oi(this,e,t,n)}function Oi(e,t,n,o){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,o){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===o?new Uint8Array(t):void 0===o?new Uint8Array(t,n):new Uint8Array(t,n,o),Ai.TYPED_ARRAY_SUPPORT?(e=t).__proto__=Ai.prototype:e=xi(e,t),e}(e,t,n,o):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!Ai.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|Gi(t,n),a=(e=Li(e,o)).write(t,n);return a!==o&&(e=e.slice(0,a)),e}(e,t,n):function(e,t){if(Bi(t)){var n=0|Vi(t.length);return 0===(e=Li(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(o=t.length)!=o?Li(e,0):xi(e,t);if("Buffer"===t.type&&Ni(t.data))return xi(e,t.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function Pi(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function Ui(e,t){if(Pi(t),e=Li(e,t<0?0:0|Vi(t)),!Ai.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function xi(e,t){var n=t.length<0?0:0|Vi(t.length);e=Li(e,n);for(var o=0;o<n;o+=1)e[o]=255&t[o];return e}function Vi(e){if(e>=Ri())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+Ri().toString(16)+" bytes");return 0|e}function Bi(e){return!(null==e||!e._isBuffer)}function Gi(e,t){if(Bi(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return hr(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return fr(e).length;default:if(o)return hr(e).length;t=(""+t).toLowerCase(),o=!0}}function Fi(e,t,n){var o=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return nr(this,t,n);case"utf8":case"utf-8":return Xi(this,t,n);case"ascii":return er(this,t,n);case"latin1":case"binary":return tr(this,t,n);case"base64":return Ji(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return or(this,t,n);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function zi(e,t,n){var o=e[t];e[t]=e[n],e[n]=o}function Hi(e,t,n,o,a){if(0===e.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof t&&(t=Ai.from(t,o)),Bi(t))return 0===t.length?-1:ji(e,t,n,o,a);if("number"==typeof t)return t&=255,Ai.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):ji(e,[t],n,o,a);throw new TypeError("val must be string, number or Buffer")}function ji(e,t,n,o,a){var i,r=1,s=e.length,l=t.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(e.length<2||t.length<2)return-1;r=2,s/=2,l/=2,n/=2}function c(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(a){var u=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*r}else-1!==u&&(i-=i-u),u=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){for(var d=!0,p=0;p<l;p++)if(c(e,i+p)!==c(t,p)){d=!1;break}if(d)return i}return-1}function qi(e,t,n,o){n=Number(n)||0;var a=e.length-n;o?(o=Number(o))>a&&(o=a):o=a;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");o>i/2&&(o=i/2);for(var r=0;r<o;++r){var s=parseInt(t.substr(2*r,2),16);if(isNaN(s))return r;e[n+r]=s}return r}function Ki(e,t,n,o){return gr(hr(t,e.length-n),e,n,o)}function Yi(e,t,n,o){return gr(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,o)}function $i(e,t,n,o){return Yi(e,t,n,o)}function Wi(e,t,n,o){return gr(fr(t),e,n,o)}function Zi(e,t,n,o){return gr(function(e,t){for(var n,o,a,i=[],r=0;r<e.length&&!((t-=2)<0);++r)o=(n=e.charCodeAt(r))>>8,a=n%256,i.push(a),i.push(o);return i}(t,e.length-n),e,n,o)}function Ji(e,t,n){return 0===t&&n===e.length?Mi(e):Mi(e.slice(t,n))}function Xi(e,t,n){n=Math.min(e.length,n);for(var o=[],a=t;a<n;){var i,r,s,l,c=e[a],u=null,d=c>239?4:c>223?3:c>191?2:1;if(a+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(i=e[a+1]))&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[a+1],r=e[a+2],128==(192&i)&&128==(192&r)&&(l=(15&c)<<12|(63&i)<<6|63&r)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[a+1],r=e[a+2],s=e[a+3],128==(192&i)&&128==(192&r)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&r)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,o.push(u>>>10&1023|55296),u=56320|1023&u),o.push(u),a+=d}return function(e){var t=e.length;if(t<=Qi)return String.fromCharCode.apply(String,e);for(var n="",o=0;o<t;)n+=String.fromCharCode.apply(String,e.slice(o,o+=Qi));return n}(o)}Ai.TYPED_ARRAY_SUPPORT=void 0===yi.TYPED_ARRAY_SUPPORT||yi.TYPED_ARRAY_SUPPORT,Ai.poolSize=8192,Ai._augment=function(e){return e.__proto__=Ai.prototype,e},Ai.from=function(e,t,n){return Oi(null,e,t,n)},Ai.TYPED_ARRAY_SUPPORT&&(Ai.prototype.__proto__=Uint8Array.prototype,Ai.__proto__=Uint8Array),Ai.alloc=function(e,t,n){return o=null,i=t,r=n,Pi(a=e),a<=0?Li(o,a):void 0!==i?"string"==typeof r?Li(o,a).fill(i,r):Li(o,a).fill(i):Li(o,a);var o,a,i,r},Ai.allocUnsafe=function(e){return Ui(null,e)},Ai.allocUnsafeSlow=function(e){return Ui(null,e)},Ai.isBuffer=mr,Ai.compare=function(e,t){if(!Bi(e)||!Bi(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,o=t.length,a=0,i=Math.min(n,o);a<i;++a)if(e[a]!==t[a]){n=e[a],o=t[a];break}return n<o?-1:o<n?1:0},Ai.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},Ai.concat=function(e,t){if(!Ni(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return Ai.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var o=Ai.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var i=e[n];if(!Bi(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(o,a),a+=i.length}return o},Ai.byteLength=Gi,Ai.prototype._isBuffer=!0,Ai.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)zi(this,t,t+1);return this},Ai.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)zi(this,t,t+3),zi(this,t+1,t+2);return this},Ai.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)zi(this,t,t+7),zi(this,t+1,t+6),zi(this,t+2,t+5),zi(this,t+3,t+4);return this},Ai.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?Xi(this,0,e):Fi.apply(this,arguments)},Ai.prototype.equals=function(e){if(!Bi(e))throw new TypeError("Argument must be a Buffer");return this===e||0===Ai.compare(this,e)},Ai.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},Ai.prototype.compare=function(e,t,n,o,a){if(!Bi(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===a&&(a=this.length),t<0||n>e.length||o<0||a>this.length)throw new RangeError("out of range index");if(o>=a&&t>=n)return 0;if(o>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(o>>>=0),r=(n>>>=0)-(t>>>=0),s=Math.min(i,r),l=this.slice(o,a),c=e.slice(t,n),u=0;u<s;++u)if(l[u]!==c[u]){i=l[u],r=c[u];break}return i<r?-1:r<i?1:0},Ai.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},Ai.prototype.indexOf=function(e,t,n){return Hi(this,e,t,n,!0)},Ai.prototype.lastIndexOf=function(e,t,n){return Hi(this,e,t,n,!1)},Ai.prototype.write=function(e,t,n,o){if(void 0===t)o="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)o=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return qi(this,e,t,n);case"utf8":case"utf-8":return Ki(this,e,t,n);case"ascii":return Yi(this,e,t,n);case"latin1":case"binary":return $i(this,e,t,n);case"base64":return Wi(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Zi(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},Ai.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Qi=4096;function er(e,t,n){var o="";n=Math.min(e.length,n);for(var a=t;a<n;++a)o+=String.fromCharCode(127&e[a]);return o}function tr(e,t,n){var o="";n=Math.min(e.length,n);for(var a=t;a<n;++a)o+=String.fromCharCode(e[a]);return o}function nr(e,t,n){var o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var a="",i=t;i<n;++i)a+=pr(e[i]);return a}function or(e,t,n){for(var o=e.slice(t,n),a="",i=0;i<o.length;i+=2)a+=String.fromCharCode(o[i]+256*o[i+1]);return a}function ar(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function ir(e,t,n,o,a,i){if(!Bi(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+o>e.length)throw new RangeError("Index out of range")}function rr(e,t,n,o){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-n,2);a<i;++a)e[n+a]=(t&255<<8*(o?a:1-a))>>>8*(o?a:1-a)}function sr(e,t,n,o){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-n,4);a<i;++a)e[n+a]=t>>>8*(o?a:3-a)&255}function lr(e,t,n,o,a,i){if(n+o>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function cr(e,t,n,o,a){return a||lr(e,0,n,4),bi(e,t,n,o,23,4),n+4}function ur(e,t,n,o,a){return a||lr(e,0,n,8),bi(e,t,n,o,52,8),n+8}Ai.prototype.slice=function(e,t){var n,o=this.length;if((e=~~e)<0?(e+=o)<0&&(e=0):e>o&&(e=o),(t=void 0===t?o:~~t)<0?(t+=o)<0&&(t=0):t>o&&(t=o),t<e&&(t=e),Ai.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=Ai.prototype;else{var a=t-e;n=new Ai(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+e]}return n},Ai.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||ar(e,t,this.length);for(var o=this[e],a=1,i=0;++i<t&&(a*=256);)o+=this[e+i]*a;return o},Ai.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||ar(e,t,this.length);for(var o=this[e+--t],a=1;t>0&&(a*=256);)o+=this[e+--t]*a;return o},Ai.prototype.readUInt8=function(e,t){return t||ar(e,1,this.length),this[e]},Ai.prototype.readUInt16LE=function(e,t){return t||ar(e,2,this.length),this[e]|this[e+1]<<8},Ai.prototype.readUInt16BE=function(e,t){return t||ar(e,2,this.length),this[e]<<8|this[e+1]},Ai.prototype.readUInt32LE=function(e,t){return t||ar(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},Ai.prototype.readUInt32BE=function(e,t){return t||ar(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},Ai.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||ar(e,t,this.length);for(var o=this[e],a=1,i=0;++i<t&&(a*=256);)o+=this[e+i]*a;return o>=(a*=128)&&(o-=Math.pow(2,8*t)),o},Ai.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||ar(e,t,this.length);for(var o=t,a=1,i=this[e+--o];o>0&&(a*=256);)i+=this[e+--o]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},Ai.prototype.readInt8=function(e,t){return t||ar(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},Ai.prototype.readInt16LE=function(e,t){t||ar(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},Ai.prototype.readInt16BE=function(e,t){t||ar(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},Ai.prototype.readInt32LE=function(e,t){return t||ar(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},Ai.prototype.readInt32BE=function(e,t){return t||ar(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},Ai.prototype.readFloatLE=function(e,t){return t||ar(e,4,this.length),wi(this,e,!0,23,4)},Ai.prototype.readFloatBE=function(e,t){return t||ar(e,4,this.length),wi(this,e,!1,23,4)},Ai.prototype.readDoubleLE=function(e,t){return t||ar(e,8,this.length),wi(this,e,!0,52,8)},Ai.prototype.readDoubleBE=function(e,t){return t||ar(e,8,this.length),wi(this,e,!1,52,8)},Ai.prototype.writeUIntLE=function(e,t,n,o){e=+e,t|=0,n|=0,o||ir(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},Ai.prototype.writeUIntBE=function(e,t,n,o){e=+e,t|=0,n|=0,o||ir(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},Ai.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,1,255,0),Ai.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},Ai.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,2,65535,0),Ai.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):rr(this,e,t,!0),t+2},Ai.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,2,65535,0),Ai.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):rr(this,e,t,!1),t+2},Ai.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,4,4294967295,0),Ai.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):sr(this,e,t,!0),t+4},Ai.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,4,4294967295,0),Ai.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):sr(this,e,t,!1),t+4},Ai.prototype.writeIntLE=function(e,t,n,o){if(e=+e,t|=0,!o){var a=Math.pow(2,8*n-1);ir(this,e,t,n,a-1,-a)}var i=0,r=1,s=0;for(this[t]=255&e;++i<n&&(r*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/r|0)-s&255;return t+n},Ai.prototype.writeIntBE=function(e,t,n,o){if(e=+e,t|=0,!o){var a=Math.pow(2,8*n-1);ir(this,e,t,n,a-1,-a)}var i=n-1,r=1,s=0;for(this[t+i]=255&e;--i>=0&&(r*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/r|0)-s&255;return t+n},Ai.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,1,127,-128),Ai.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},Ai.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,2,32767,-32768),Ai.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):rr(this,e,t,!0),t+2},Ai.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,2,32767,-32768),Ai.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):rr(this,e,t,!1),t+2},Ai.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,4,2147483647,-2147483648),Ai.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):sr(this,e,t,!0),t+4},Ai.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||ir(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),Ai.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):sr(this,e,t,!1),t+4},Ai.prototype.writeFloatLE=function(e,t,n){return cr(this,e,t,!0,n)},Ai.prototype.writeFloatBE=function(e,t,n){return cr(this,e,t,!1,n)},Ai.prototype.writeDoubleLE=function(e,t,n){return ur(this,e,t,!0,n)},Ai.prototype.writeDoubleBE=function(e,t,n){return ur(this,e,t,!1,n)},Ai.prototype.copy=function(e,t,n,o){if(n||(n=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-n&&(o=e.length-t+n);var a,i=o-n;if(this===e&&n<t&&t<o)for(a=i-1;a>=0;--a)e[a+t]=this[a+n];else if(i<1e3||!Ai.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},Ai.prototype.fill=function(e,t,n,o){if("string"==typeof e){if("string"==typeof t?(o=t,t=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!Ai.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var r=Bi(e)?e:hr(new Ai(e,o).toString()),s=r.length;for(i=0;i<n-t;++i)this[i+t]=r[i%s]}return this};var dr=/[^+\/0-9A-Za-z-_]/g;function pr(e){return e<16?"0"+e.toString(16):e.toString(16)}function hr(e,t){var n;t=t||1/0;for(var o=e.length,a=null,i=[],r=0;r<o;++r){if((n=e.charCodeAt(r))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(r+1===o){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function fr(e){return function(e){var t,n,o,a,i,r;Ei||Ti();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===e[s-2]?2:"="===e[s-1]?1:0,r=new ki(3*s/4-i),o=i>0?s-4:s;var l=0;for(t=0,n=0;t<o;t+=4,n+=3)a=Ci[e.charCodeAt(t)]<<18|Ci[e.charCodeAt(t+1)]<<12|Ci[e.charCodeAt(t+2)]<<6|Ci[e.charCodeAt(t+3)],r[l++]=a>>16&255,r[l++]=a>>8&255,r[l++]=255&a;return 2===i?(a=Ci[e.charCodeAt(t)]<<2|Ci[e.charCodeAt(t+1)]>>4,r[l++]=255&a):1===i&&(a=Ci[e.charCodeAt(t)]<<10|Ci[e.charCodeAt(t+1)]<<4|Ci[e.charCodeAt(t+2)]>>2,r[l++]=a>>8&255,r[l++]=255&a),r}(function(e){if((e=(t=e,t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(dr,"")).length<2)return"";for(var t;e.length%4!=0;)e+="=";return e}(e))}function gr(e,t,n,o){for(var a=0;a<o&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function mr(e){return null!=e&&(!!e._isBuffer||vr(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&vr(t.slice(0,0)));var t}function vr(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function _r(e,t){return e(t={exports:{}},t.exports),t.exports}var yr=_r((function(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f;e.exports=(n=n||(o=Math,a=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r=(i={}).lib={},s=r.Base={extend:function(e){var t=a(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=r.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes,a=e.sigBytes;if(this.clamp(),o%4)for(var i=0;i<a;i++){var r=n[i>>>2]>>>24-i%4*8&255;t[o+i>>>2]|=r<<24-(o+i)%4*8}else for(i=0;i<a;i+=4)t[o+i>>>2]=n[i>>>2];return this.sigBytes+=a,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=o.ceil(t/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t,n=[],a=function(e){var t=987654321,n=4294967295;return function(){var a=((t=36969*(65535&t)+(t>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return a/=4294967296,(a+=.5)*(o.random()>.5?1:-1)}},i=0;i<e;i+=4){var r=a(4294967296*(t||o.random()));t=987654071*r(),n.push(4294967296*r()|0)}return new l.init(n,e)}}),c=i.enc={},u=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;o.push((i>>>4).toString(16)),o.push((15&i).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new l.init(n,t/2)}},d=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;return new l.init(n,t)}},p=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},h=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,a=t.sigBytes,i=this.blockSize,r=a/(4*i),s=(r=e?o.ceil(r):o.max((0|r)-this._minBufferSize,0))*i,c=o.min(4*s,a);if(s){for(var u=0;u<s;u+=i)this._doProcessBlock(n,u);var d=n.splice(0,s);t.sigBytes-=c}return new l.init(d,c)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),r.Hasher=h.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),f=i.algo={},i),n)})),Ir=(_r((function(e,t){var n,o,a,i,r,s;e.exports=(a=(o=n=yr).lib,i=a.Base,r=a.WordArray,(s=o.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],o=0;o<t;o++){var a=e[o];n.push(a.high),n.push(a.low)}return r.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,o=0;o<n;o++)t[o]=t[o].clone();return e}}),n)})),_r((function(e,t){var n;e.exports=(n=yr,function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,o=[],a=0;a<n;a++)o[a>>>2]|=e[a]<<24-a%4*8;t.call(this,o,n)}else t.apply(this,arguments)}).prototype=e}}(),n.lib.WordArray)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib.WordArray,o=e.enc;function a(e){return e<<8&4278255360|e>>>8&16711935}o.Utf16=o.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a+=2){var i=t[a>>>2]>>>16-a%4*8&65535;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var n=e.length,o=[],a=0;a<n;a++)o[a>>>1]|=e.charCodeAt(a)<<16-a%2*16;return t.create(o,2*n)}},o.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],i=0;i<n;i+=2){var r=a(t[i>>>2]>>>16-i%4*8&65535);o.push(String.fromCharCode(r))}return o.join("")},parse:function(e){for(var n=e.length,o=[],i=0;i<n;i++)o[i>>>1]|=a(e.charCodeAt(i)<<16-i%2*16);return t.create(o,2*n)}}}(),n.enc.Utf16)})),_r((function(e,t){var n,o,a;e.exports=(a=(o=n=yr).lib.WordArray,o.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,o=this._map;e.clamp();for(var a=[],i=0;i<n;i+=3)for(var r=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)a.push(o.charAt(r>>>6*(3-s)&63));var l=o.charAt(64);if(l)for(;a.length%4;)a.push(l);return a.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var r=n.charAt(64);if(r){var s=e.indexOf(r);-1!==s&&(t=s)}return function(e,t,n){for(var o=[],i=0,r=0;r<t;r++)if(r%4){var s=n[e.charCodeAt(r-1)]<<r%4*2,l=n[e.charCodeAt(r)]>>>6-r%4*2;o[i>>>2]|=(s|l)<<24-i%4*8,i++}return a.create(o,i)}(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)})),_r((function(e,t){var n;e.exports=(n=yr,function(e){var t=n,o=t.lib,a=o.WordArray,i=o.Hasher,r=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=r.MD5=i.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,a=e[o];e[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var i=this._hash.words,r=e[t+0],l=e[t+1],h=e[t+2],f=e[t+3],g=e[t+4],m=e[t+5],v=e[t+6],_=e[t+7],y=e[t+8],I=e[t+9],C=e[t+10],k=e[t+11],E=e[t+12],T=e[t+13],S=e[t+14],M=e[t+15],w=i[0],b=i[1],D=i[2],N=i[3];w=c(w,b,D,N,r,7,s[0]),N=c(N,w,b,D,l,12,s[1]),D=c(D,N,w,b,h,17,s[2]),b=c(b,D,N,w,f,22,s[3]),w=c(w,b,D,N,g,7,s[4]),N=c(N,w,b,D,m,12,s[5]),D=c(D,N,w,b,v,17,s[6]),b=c(b,D,N,w,_,22,s[7]),w=c(w,b,D,N,y,7,s[8]),N=c(N,w,b,D,I,12,s[9]),D=c(D,N,w,b,C,17,s[10]),b=c(b,D,N,w,k,22,s[11]),w=c(w,b,D,N,E,7,s[12]),N=c(N,w,b,D,T,12,s[13]),D=c(D,N,w,b,S,17,s[14]),w=u(w,b=c(b,D,N,w,M,22,s[15]),D,N,l,5,s[16]),N=u(N,w,b,D,v,9,s[17]),D=u(D,N,w,b,k,14,s[18]),b=u(b,D,N,w,r,20,s[19]),w=u(w,b,D,N,m,5,s[20]),N=u(N,w,b,D,C,9,s[21]),D=u(D,N,w,b,M,14,s[22]),b=u(b,D,N,w,g,20,s[23]),w=u(w,b,D,N,I,5,s[24]),N=u(N,w,b,D,S,9,s[25]),D=u(D,N,w,b,f,14,s[26]),b=u(b,D,N,w,y,20,s[27]),w=u(w,b,D,N,T,5,s[28]),N=u(N,w,b,D,h,9,s[29]),D=u(D,N,w,b,_,14,s[30]),w=d(w,b=u(b,D,N,w,E,20,s[31]),D,N,m,4,s[32]),N=d(N,w,b,D,y,11,s[33]),D=d(D,N,w,b,k,16,s[34]),b=d(b,D,N,w,S,23,s[35]),w=d(w,b,D,N,l,4,s[36]),N=d(N,w,b,D,g,11,s[37]),D=d(D,N,w,b,_,16,s[38]),b=d(b,D,N,w,C,23,s[39]),w=d(w,b,D,N,T,4,s[40]),N=d(N,w,b,D,r,11,s[41]),D=d(D,N,w,b,f,16,s[42]),b=d(b,D,N,w,v,23,s[43]),w=d(w,b,D,N,I,4,s[44]),N=d(N,w,b,D,E,11,s[45]),D=d(D,N,w,b,M,16,s[46]),w=p(w,b=d(b,D,N,w,h,23,s[47]),D,N,r,6,s[48]),N=p(N,w,b,D,_,10,s[49]),D=p(D,N,w,b,S,15,s[50]),b=p(b,D,N,w,m,21,s[51]),w=p(w,b,D,N,E,6,s[52]),N=p(N,w,b,D,f,10,s[53]),D=p(D,N,w,b,C,15,s[54]),b=p(b,D,N,w,l,21,s[55]),w=p(w,b,D,N,y,6,s[56]),N=p(N,w,b,D,M,10,s[57]),D=p(D,N,w,b,v,15,s[58]),b=p(b,D,N,w,T,21,s[59]),w=p(w,b,D,N,g,6,s[60]),N=p(N,w,b,D,k,10,s[61]),D=p(D,N,w,b,h,15,s[62]),b=p(b,D,N,w,I,21,s[63]),i[0]=i[0]+w|0,i[1]=i[1]+b|0,i[2]=i[2]+D|0,i[3]=i[3]+N|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,a=8*t.sigBytes;n[a>>>5]|=128<<24-a%32;var i=e.floor(o/4294967296),r=o;n[15+(a+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,l=s.words,c=0;c<4;c++){var u=l[c];l[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,o,a,i,r){var s=e+(t&n|~t&o)+a+r;return(s<<i|s>>>32-i)+t}function u(e,t,n,o,a,i,r){var s=e+(t&o|n&~o)+a+r;return(s<<i|s>>>32-i)+t}function d(e,t,n,o,a,i,r){var s=e+(t^n^o)+a+r;return(s<<i|s>>>32-i)+t}function p(e,t,n,o,a,i,r){var s=e+(n^(t|~o))+a+r;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(l),t.HmacMD5=i._createHmacHelper(l)}(Math),n.MD5)})),_r((function(e,t){var n,o,a,i,r,s,l,c;e.exports=(a=(o=n=yr).lib,i=a.WordArray,r=a.Hasher,s=o.algo,l=[],c=s.SHA1=r.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],c=0;c<80;c++){if(c<16)l[c]=0|e[t+c];else{var u=l[c-3]^l[c-8]^l[c-14]^l[c-16];l[c]=u<<1|u>>>31}var d=(o<<5|o>>>27)+s+l[c];d+=c<20?1518500249+(a&i|~a&r):c<40?1859775393+(a^i^r):c<60?(a&i|a&r|i&r)-1894007588:(a^i^r)-899497514,s=r,r=i,i=a<<30|a>>>2,a=o,o=d}n[0]=n[0]+o|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+r|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(o+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),o.SHA1=r._createHelper(c),o.HmacSHA1=r._createHmacHelper(c),n.SHA1)})),_r((function(e,t){var n;e.exports=(n=yr,function(e){var t=n,o=t.lib,a=o.WordArray,i=o.Hasher,r=t.algo,s=[],l=[];!function(){function t(t){for(var n=e.sqrt(t),o=2;o<=n;o++)if(!(t%o))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var o=2,a=0;a<64;)t(o)&&(a<8&&(s[a]=n(e.pow(o,.5))),l[a]=n(e.pow(o,1/3)),a++),o++}();var c=[],u=r.SHA256=i.extend({_doReset:function(){this._hash=new a.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=0;h<64;h++){if(h<16)c[h]=0|e[t+h];else{var f=c[h-15],g=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,m=c[h-2],v=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[h]=g+c[h-7]+v+c[h-16]}var _=o&a^o&i^a&i,y=(o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22),I=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&d)+l[h]+c[h];p=d,d=u,u=s,s=r+I|0,r=i,i=a,a=o,o=I+(y+_)|0}n[0]=n[0]+o|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+r|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(o/4294967296),n[15+(a+64>>>9<<4)]=o,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(u),t.HmacSHA256=i._createHmacHelper(u)}(Math),n.SHA256)})),_r((function(e,t){var n,o,a,i,r,s;e.exports=(a=(o=n=yr).lib.WordArray,i=o.algo,r=i.SHA256,s=i.SHA224=r.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=4,e}}),o.SHA224=r._createHelper(s),o.HmacSHA224=r._createHmacHelper(s),n.SHA224)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib.Hasher,o=e.x64,a=o.Word,i=o.WordArray,r=e.algo;function s(){return a.create.apply(a,arguments)}var l=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var u=r.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=o.high,f=o.low,g=a.high,m=a.low,v=i.high,_=i.low,y=r.high,I=r.low,C=s.high,k=s.low,E=u.high,T=u.low,S=d.high,M=d.low,w=p.high,b=p.low,D=h,N=f,R=g,L=m,A=v,O=_,P=y,U=I,x=C,V=k,B=E,G=T,F=S,z=M,H=w,j=b,q=0;q<80;q++){var K=c[q];if(q<16)var Y=K.high=0|e[t+2*q],$=K.low=0|e[t+2*q+1];else{var W=c[q-15],Z=W.high,J=W.low,X=(Z>>>1|J<<31)^(Z>>>8|J<<24)^Z>>>7,Q=(J>>>1|Z<<31)^(J>>>8|Z<<24)^(J>>>7|Z<<25),ee=c[q-2],te=ee.high,ne=ee.low,oe=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ae=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=c[q-7],re=ie.high,se=ie.low,le=c[q-16],ce=le.high,ue=le.low;Y=(Y=(Y=X+re+(($=Q+se)>>>0<Q>>>0?1:0))+oe+(($+=ae)>>>0<ae>>>0?1:0))+ce+(($+=ue)>>>0<ue>>>0?1:0),K.high=Y,K.low=$}var de,pe=x&B^~x&F,he=V&G^~V&z,fe=D&R^D&A^R&A,ge=N&L^N&O^L&O,me=(D>>>28|N<<4)^(D<<30|N>>>2)^(D<<25|N>>>7),ve=(N>>>28|D<<4)^(N<<30|D>>>2)^(N<<25|D>>>7),_e=(x>>>14|V<<18)^(x>>>18|V<<14)^(x<<23|V>>>9),ye=(V>>>14|x<<18)^(V>>>18|x<<14)^(V<<23|x>>>9),Ie=l[q],Ce=Ie.high,ke=Ie.low,Ee=H+_e+((de=j+ye)>>>0<j>>>0?1:0),Te=ve+ge;H=F,j=z,F=B,z=G,B=x,G=V,x=P+(Ee=(Ee=(Ee=Ee+pe+((de+=he)>>>0<he>>>0?1:0))+Ce+((de+=ke)>>>0<ke>>>0?1:0))+Y+((de+=$)>>>0<$>>>0?1:0))+((V=U+de|0)>>>0<U>>>0?1:0)|0,P=A,U=O,A=R,O=L,R=D,L=N,D=Ee+(me+fe+(Te>>>0<ve>>>0?1:0))+((N=de+Te|0)>>>0<de>>>0?1:0)|0}f=o.low=f+N,o.high=h+D+(f>>>0<N>>>0?1:0),m=a.low=m+L,a.high=g+R+(m>>>0<L>>>0?1:0),_=i.low=_+O,i.high=v+A+(_>>>0<O>>>0?1:0),I=r.low=I+U,r.high=y+P+(I>>>0<U>>>0?1:0),k=s.low=k+V,s.high=C+x+(k>>>0<V>>>0?1:0),T=u.low=T+G,u.high=E+B+(T>>>0<G>>>0?1:0),M=d.low=M+z,d.high=S+F+(M>>>0<z>>>0?1:0),b=p.low=b+j,p.high=w+H+(b>>>0<j>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[30+(o+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(o+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(u),e.HmacSHA512=t._createHmacHelper(u)}(),n.SHA512)})),_r((function(e,t){var n,o,a,i,r,s,l,c;e.exports=(a=(o=n=yr).x64,i=a.Word,r=a.WordArray,s=o.algo,l=s.SHA512,c=s.SHA384=l.extend({_doReset:function(){this._hash=new r.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=l._doFinalize.call(this);return e.sigBytes-=16,e}}),o.SHA384=l._createHelper(c),o.HmacSHA384=l._createHmacHelper(c),n.SHA384)})),_r((function(e,t){var n;e.exports=(n=yr,function(e){var t=n,o=t.lib,a=o.WordArray,i=o.Hasher,r=t.x64.Word,s=t.algo,l=[],c=[],u=[];!function(){for(var e=1,t=0,n=0;n<24;n++){l[e+5*t]=(n+1)*(n+2)/2%64;var o=(2*e+3*t)%5;e=t%5,t=o}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var a=1,i=0;i<24;i++){for(var s=0,d=0,p=0;p<7;p++){if(1&a){var h=(1<<p)-1;h<32?d^=1<<h:s^=1<<h-32}128&a?a=a<<1^113:a<<=1}u[i]=r.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=r.create()}();var p=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new r.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,o=this.blockSize/2,a=0;a<o;a++){var i=e[t+2*a],r=e[t+2*a+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),(b=n[a]).high^=r,b.low^=i}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var h=0,f=0,g=0;g<5;g++)h^=(b=n[p+5*g]).high,f^=b.low;var m=d[p];m.high=h,m.low=f}for(p=0;p<5;p++){var v=d[(p+4)%5],_=d[(p+1)%5],y=_.high,I=_.low;for(h=v.high^(y<<1|I>>>31),f=v.low^(I<<1|y>>>31),g=0;g<5;g++)(b=n[p+5*g]).high^=h,b.low^=f}for(var C=1;C<25;C++){var k=(b=n[C]).high,E=b.low,T=l[C];T<32?(h=k<<T|E>>>32-T,f=E<<T|k>>>32-T):(h=E<<T-32|k>>>64-T,f=k<<T-32|E>>>64-T);var S=d[c[C]];S.high=h,S.low=f}var M=d[0],w=n[0];for(M.high=w.high,M.low=w.low,p=0;p<5;p++)for(g=0;g<5;g++){var b=n[C=p+5*g],D=d[C],N=d[(p+1)%5+5*g],R=d[(p+2)%5+5*g];b.high=D.high^~N.high&R.high,b.low=D.low^~N.low&R.low}b=n[0];var L=u[s];b.high^=L.high,b.low^=L.low}},_doFinalize:function(){var t=this._data,n=t.words,o=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;n[o>>>5]|=1<<24-o%32,n[(e.ceil((o+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var r=this._state,s=this.cfg.outputLength/8,l=s/8,c=[],u=0;u<l;u++){var d=r[u],p=d.high,h=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),c.push(h),c.push(p)}return new a.init(c,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=i._createHelper(p),t.HmacSHA3=i._createHmacHelper(p)}(Math),n.SHA3)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib,o=t.WordArray,a=t.Hasher,i=e.algo,r=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=o.create([0,1518500249,1859775393,2400959708,2840853838]),d=o.create([1352829926,1548603684,1836072691,2053994217,0]),p=i.RIPEMD160=a.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,a=e[o];e[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var i,p,y,I,C,k,E,T,S,M,w,b=this._hash.words,D=u.words,N=d.words,R=r.words,L=s.words,A=l.words,O=c.words;for(k=i=b[0],E=p=b[1],T=y=b[2],S=I=b[3],M=C=b[4],n=0;n<80;n+=1)w=i+e[t+R[n]]|0,w+=n<16?h(p,y,I)+D[0]:n<32?f(p,y,I)+D[1]:n<48?g(p,y,I)+D[2]:n<64?m(p,y,I)+D[3]:v(p,y,I)+D[4],w=(w=_(w|=0,A[n]))+C|0,i=C,C=I,I=_(y,10),y=p,p=w,w=k+e[t+L[n]]|0,w+=n<16?v(E,T,S)+N[0]:n<32?m(E,T,S)+N[1]:n<48?g(E,T,S)+N[2]:n<64?f(E,T,S)+N[3]:h(E,T,S)+N[4],w=(w=_(w|=0,O[n]))+M|0,k=M,M=S,S=_(T,10),T=E,E=w;w=b[1]+y+S|0,b[1]=b[2]+I+M|0,b[2]=b[3]+C+k|0,b[3]=b[4]+i+E|0,b[4]=b[0]+p+T|0,b[0]=w},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,i=a.words,r=0;r<5;r++){var s=i[r];i[r]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return a},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function f(e,t,n){return e&t|~e&n}function g(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function _(e,t){return e<<t|e>>>32-t}e.RIPEMD160=a._createHelper(p),e.HmacRIPEMD160=a._createHmacHelper(p)}(),n.RIPEMD160)})),_r((function(e,t){var n,o,a,i;e.exports=(o=(n=yr).lib.Base,a=n.enc,i=a.Utf8,void(n.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var n=e.blockSize,o=4*n;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),r=this._iKey=t.clone(),s=a.words,l=r.words,c=0;c<n;c++)s[c]^=1549556828,l[c]^=909522486;a.sigBytes=r.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),_r((function(e,t){var n,o,a,i,r,s,l,c,u;e.exports=(i=(a=(o=n=yr).lib).Base,r=a.WordArray,l=(s=o.algo).SHA1,c=s.HMAC,u=s.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=c.create(n.hasher,e),a=r.create(),i=r.create([1]),s=a.words,l=i.words,u=n.keySize,d=n.iterations;s.length<u;){var p=o.update(t).finalize(i);o.reset();for(var h=p.words,f=h.length,g=p,m=1;m<d;m++){g=o.finalize(g),o.reset();for(var v=g.words,_=0;_<f;_++)h[_]^=v[_]}a.concat(p),l[0]++}return a.sigBytes=4*u,a}}),o.PBKDF2=function(e,t,n){return u.create(n).compute(e,t)},n.PBKDF2)})),_r((function(e,t){var n,o,a,i,r,s,l,c;e.exports=(i=(a=(o=n=yr).lib).Base,r=a.WordArray,l=(s=o.algo).MD5,c=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=n.hasher.create(),a=r.create(),i=a.words,s=n.keySize,l=n.iterations;i.length<s;){c&&o.update(c);var c=o.update(e).finalize(t);o.reset();for(var u=1;u<l;u++)c=o.finalize(c),o.reset();a.concat(c)}return a.sigBytes=4*s,a}}),o.EvpKDF=function(e,t,n){return c.create(n).compute(e,t)},n.EvpKDF)})),_r((function(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f,g,m,v,_,y,I,C,k,E,T;e.exports=void((n=yr).lib.Cipher||(o=n,a=o.lib,i=a.Base,r=a.WordArray,s=a.BufferedBlockAlgorithm,l=o.enc,l.Utf8,c=l.Base64,u=o.algo,d=u.EvpKDF,p=a.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?T:C}return function(t){return{encrypt:function(n,o,a){return e(o).encrypt(t,n,o,a)},decrypt:function(n,o,a){return e(o).decrypt(t,n,o,a)}}}}()}),a.StreamCipher=p.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),h=o.mode={},f=a.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),g=h.CBC=function(){var e=f.extend();function t(e,t,n){var o=this._iv;if(o){var a=o;this._iv=undefined}else a=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=a[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize;t.call(this,e,n,a),o.encryptBlock(e,n),this._prevBlock=e.slice(n,n+a)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize,i=e.slice(n,n+a);o.decryptBlock(e,n),t.call(this,e,n,a),this._prevBlock=i}}),e}(),m=o.pad={},v=m.Pkcs7={pad:function(e,t){for(var n=4*t,o=n-e.sigBytes%n,a=o<<24|o<<16|o<<8|o,i=[],s=0;s<o;s+=4)i.push(a);var l=r.create(i,o);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},a.BlockCipher=p.extend({cfg:p.cfg.extend({mode:g,padding:v}),reset:function(){p.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var o=n.createEncryptor;else{o=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==o?this._mode.init(this,t&&t.words):(this._mode=o.call(n,this,t&&t.words),this._mode.__creator=o)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{t=this._process(!0);e.unpad(t)}return t},blockSize:4}),_=a.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=o.format={},I=y.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var o=r.create([1398893684,1701076831]).concat(n).concat(t);else o=t;return o.toString(c)},parse:function(e){var t=c.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var o=r.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return _.create({ciphertext:t,salt:o})}},C=a.SerializableCipher=i.extend({cfg:i.extend({format:I}),encrypt:function(e,t,n,o){o=this.cfg.extend(o);var a=e.createEncryptor(n,o),i=a.finalize(t),r=a.cfg;return _.create({ciphertext:i,key:n,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:o.format})},decrypt:function(e,t,n,o){return o=this.cfg.extend(o),t=this._parse(t,o.format),e.createDecryptor(n,o).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),k=o.kdf={},E=k.OpenSSL={execute:function(e,t,n,o){o||(o=r.random(8));var a=d.create({keySize:t+n}).compute(e,o),i=r.create(a.words.slice(t),4*n);return a.sigBytes=4*t,_.create({key:a,iv:i,salt:o})}},T=a.PasswordBasedCipher=C.extend({cfg:C.cfg.extend({kdf:E}),encrypt:function(e,t,n,o){var a=(o=this.cfg.extend(o)).kdf.execute(n,e.keySize,e.ivSize);o.iv=a.iv;var i=C.encrypt.call(this,e,t,a.key,o);return i.mixIn(a),i},decrypt:function(e,t,n,o){o=this.cfg.extend(o),t=this._parse(t,o.format);var a=o.kdf.execute(n,e.keySize,e.ivSize,t.salt);return o.iv=a.iv,C.decrypt.call(this,e,t,a.key,o)}})))})),_r((function(e,t){var n;e.exports=((n=yr).mode.CFB=function(){var e=n.lib.BlockCipherMode.extend();function t(e,t,n,o){var a=this._iv;if(a){var i=a.slice(0);this._iv=void 0}else i=this._prevBlock;o.encryptBlock(i,0);for(var r=0;r<n;r++)e[t+r]^=i[r]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize;t.call(this,e,n,a,o),this._prevBlock=e.slice(n,n+a)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize,i=e.slice(n,n+a);t.call(this,e,n,a,o),this._prevBlock=i}}),e}(),n.mode.CFB)})),_r((function(e,t){var n,o,a;e.exports=((n=yr).mode.CTR=(a=(o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,a=this._iv,i=this._counter;a&&(i=this._counter=a.slice(0),this._iv=void 0);var r=i.slice(0);n.encryptBlock(r,0),i[o-1]=i[o-1]+1|0;for(var s=0;s<o;s++)e[t+s]^=r[s]}}),o.Decryptor=a,o),n.mode.CTR)})),_r((function(e,t){var n;e.exports=((n=yr).mode.CTRGladman=function(){var e=n.lib.BlockCipherMode.extend();function t(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,o=255&e;255===t?(t=0,255===n?(n=0,255===o?o=0:++o):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=o}return e}var o=e.Encryptor=e.extend({processBlock:function(e,n){var o,a=this._cipher,i=a.blockSize,r=this._iv,s=this._counter;r&&(s=this._counter=r.slice(0),this._iv=void 0),0===((o=s)[0]=t(o[0]))&&(o[1]=t(o[1]));var l=s.slice(0);a.encryptBlock(l,0);for(var c=0;c<i;c++)e[n+c]^=l[c]}});return e.Decryptor=o,e}(),n.mode.CTRGladman)})),_r((function(e,t){var n,o,a;e.exports=((n=yr).mode.OFB=(a=(o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,a=this._iv,i=this._keystream;a&&(i=this._keystream=a.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var r=0;r<o;r++)e[t+r]^=i[r]}}),o.Decryptor=a,o),n.mode.OFB)})),_r((function(e,t){var n,o;e.exports=((n=yr).mode.ECB=((o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),o.Decryptor=o.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),o),n.mode.ECB)})),_r((function(e,t){var n;e.exports=((n=yr).pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,o=4*t,a=o-n%o,i=n+a-1;e.clamp(),e.words[i>>>2]|=a<<24-i%4*8,e.sigBytes+=a},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Ansix923)})),_r((function(e,t){var n;e.exports=((n=yr).pad.Iso10126={pad:function(e,t){var o=4*t,a=o-e.sigBytes%o;e.concat(n.lib.WordArray.random(a-1)).concat(n.lib.WordArray.create([a<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Iso10126)})),_r((function(e,t){var n;e.exports=((n=yr).pad.Iso97971={pad:function(e,t){e.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(e,t)},unpad:function(e){n.pad.ZeroPadding.unpad(e),e.sigBytes--}},n.pad.Iso97971)})),_r((function(e,t){var n;e.exports=((n=yr).pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},n.pad.ZeroPadding)})),_r((function(e,t){var n;e.exports=((n=yr).pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)})),_r((function(e,t){var n,o,a,i;e.exports=(a=(o=n=yr).lib.CipherParams,i=o.enc.Hex,o.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return a.create({ciphertext:t})}},n.format.Hex)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib.BlockCipher,o=e.algo,a=[],i=[],r=[],s=[],l=[],c=[],u=[],d=[],p=[],h=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,o=0;for(t=0;t<256;t++){var f=o^o<<1^o<<2^o<<3^o<<4;f=f>>>8^255&f^99,a[n]=f,i[f]=n;var g=e[n],m=e[g],v=e[m],_=257*e[f]^16843008*f;r[n]=_<<24|_>>>8,s[n]=_<<16|_>>>16,l[n]=_<<8|_>>>24,c[n]=_,_=16843009*v^65537*m^257*g^16843008*n,u[f]=_<<24|_>>>8,d[f]=_<<16|_>>>16,p[f]=_<<8|_>>>24,h[f]=_,n?(n=g^e[e[e[v^g]]],o^=e[e[o]]):n=o=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],g=o.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,o=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],r=0;r<o;r++)if(r<n)i[r]=t[r];else{var s=i[r-1];r%n?n>6&&r%n==4&&(s=a[s>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s]):(s=a[(s=s<<8|s>>>24)>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s],s^=f[r/n|0]<<24),i[r]=i[r-n]^s}for(var l=this._invKeySchedule=[],c=0;c<o;c++)r=o-c,s=c%4?i[r]:i[r-4],l[c]=c<4||r<=4?s:u[a[s>>>24]]^d[a[s>>>16&255]]^p[a[s>>>8&255]]^h[a[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,r,s,l,c,a)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,d,p,h,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,o,a,i,r,s){for(var l=this._nRounds,c=e[t]^n[0],u=e[t+1]^n[1],d=e[t+2]^n[2],p=e[t+3]^n[3],h=4,f=1;f<l;f++){var g=o[c>>>24]^a[u>>>16&255]^i[d>>>8&255]^r[255&p]^n[h++],m=o[u>>>24]^a[d>>>16&255]^i[p>>>8&255]^r[255&c]^n[h++],v=o[d>>>24]^a[p>>>16&255]^i[c>>>8&255]^r[255&u]^n[h++],_=o[p>>>24]^a[c>>>16&255]^i[u>>>8&255]^r[255&d]^n[h++];c=g,u=m,d=v,p=_}g=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^n[h++],m=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^n[h++],v=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^n[h++],_=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^n[h++],e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=_},keySize:8});e.AES=t._createHelper(g)}(),n.AES)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib,o=t.WordArray,a=t.BlockCipher,i=e.algo,r=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=a.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var o=r[n]-1;t[n]=e[o>>>5]>>>31-o%32&1}for(var a=this._subKeys=[],i=0;i<16;i++){var c=a[i]=[],u=l[i];for(n=0;n<24;n++)c[n/6|0]|=t[(s[n]-1+u)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(s[n+24]-1+u)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=a[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),p.call(this,1,1431655765);for(var o=0;o<16;o++){for(var a=n[o],i=this._lBlock,r=this._rBlock,s=0,l=0;l<8;l++)s|=c[l][((r^a[l])&u[l])>>>0];this._lBlock=r,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function h(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=a._createHelper(d);var f=i.TripleDES=a.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(o.create(e.slice(0,2))),this._des2=d.createEncryptor(o.create(e.slice(2,4))),this._des3=d.createEncryptor(o.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=a._createHelper(f)}(),n.TripleDES)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,a=o.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,o=this._S=[],a=0;a<256;a++)o[a]=a;a=0;for(var i=0;a<256;a++){var r=a%n,s=t[r>>>2]>>>24-r%4*8&255;i=(i+o[a]+s)%256;var l=o[a];o[a]=o[i],o[i]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,o=0,a=0;a<4;a++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,o|=e[(e[t]+e[n])%256]<<24-8*a}return this._i=t,this._j=n,o}e.RC4=t._createHelper(a);var r=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(r)}(),n.RC4)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,a=[],i=[],r=[],s=o.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var o=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)a[n]^=o[n+4&7];if(t){var i=t.words,r=i[0],s=i[1],c=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(a[0]^=c,a[1]^=d,a[2]^=u,a[3]^=p,a[4]^=c,a[5]^=d,a[6]^=u,a[7]^=p,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)a[o]=16711935&(a[o]<<8|a[o]>>>24)|4278255360&(a[o]<<24|a[o]>>>8),e[t+o]^=a[o]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],a=65535&o,s=o>>>16,l=((a*a>>>17)+a*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);r[n]=l^c}e[0]=r[0]+(r[7]<<16|r[7]>>>16)+(r[6]<<16|r[6]>>>16)|0,e[1]=r[1]+(r[0]<<8|r[0]>>>24)+r[7]|0,e[2]=r[2]+(r[1]<<16|r[1]>>>16)+(r[0]<<16|r[0]>>>16)|0,e[3]=r[3]+(r[2]<<8|r[2]>>>24)+r[1]|0,e[4]=r[4]+(r[3]<<16|r[3]>>>16)+(r[2]<<16|r[2]>>>16)|0,e[5]=r[5]+(r[4]<<8|r[4]>>>24)+r[3]|0,e[6]=r[6]+(r[5]<<16|r[5]>>>16)+(r[4]<<16|r[4]>>>16)|0,e[7]=r[7]+(r[6]<<8|r[6]>>>24)+r[5]|0}e.Rabbit=t._createHelper(s)}(),n.Rabbit)})),_r((function(e,t){var n;e.exports=(n=yr,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,a=[],i=[],r=[],s=o.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var a=0;a<4;a++)l.call(this);for(a=0;a<8;a++)o[a]^=n[a+4&7];if(t){var i=t.words,r=i[0],s=i[1],c=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(o[0]^=c,o[1]^=d,o[2]^=u,o[3]^=p,o[4]^=c,o[5]^=d,o[6]^=u,o[7]^=p,a=0;a<4;a++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)a[o]=16711935&(a[o]<<8|a[o]>>>24)|4278255360&(a[o]<<24|a[o]>>>8),e[t+o]^=a[o]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],a=65535&o,s=o>>>16,l=((a*a>>>17)+a*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);r[n]=l^c}e[0]=r[0]+(r[7]<<16|r[7]>>>16)+(r[6]<<16|r[6]>>>16)|0,e[1]=r[1]+(r[0]<<8|r[0]>>>24)+r[7]|0,e[2]=r[2]+(r[1]<<16|r[1]>>>16)+(r[0]<<16|r[0]>>>16)|0,e[3]=r[3]+(r[2]<<8|r[2]>>>24)+r[1]|0,e[4]=r[4]+(r[3]<<16|r[3]>>>16)+(r[2]<<16|r[2]>>>16)|0,e[5]=r[5]+(r[4]<<8|r[4]>>>24)+r[3]|0,e[6]=r[6]+(r[5]<<16|r[5]>>>16)+(r[4]<<16|r[4]>>>16)|0,e[7]=r[7]+(r[6]<<8|r[6]>>>24)+r[5]|0}e.RabbitLegacy=t._createHelper(s)}(),n.RabbitLegacy)})),_r((function(e,t){e.exports=yr})));function Cr(){throw new Error("setTimeout has not been defined")}function kr(){throw new Error("clearTimeout has not been defined")}var Er=Cr,Tr=kr;function Sr(e){if(Er===setTimeout)return setTimeout(e,0);if((Er===Cr||!Er)&&setTimeout)return Er=setTimeout,setTimeout(e,0);try{return Er(e,0)}catch(t){try{return Er.call(null,e,0)}catch(n){return Er.call(this,e,0)}}}"function"==typeof yi.setTimeout&&(Er=setTimeout),"function"==typeof yi.clearTimeout&&(Tr=clearTimeout);var Mr,wr=[],br=!1,Dr=-1;function Nr(){br&&Mr&&(br=!1,Mr.length?wr=Mr.concat(wr):Dr=-1,wr.length&&Rr())}function Rr(){if(!br){var e=Sr(Nr);br=!0;for(var t=wr.length;t;){for(Mr=wr,wr=[];++Dr<t;)Mr&&Mr[Dr].run();Dr=-1,t=wr.length}Mr=null,br=!1,function(e){if(Tr===clearTimeout)return clearTimeout(e);if((Tr===kr||!Tr)&&clearTimeout)return Tr=clearTimeout,clearTimeout(e);try{Tr(e)}catch(t){try{return Tr.call(null,e)}catch(n){return Tr.call(this,e)}}}(e)}}function Lr(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];wr.push(new Ar(e,t)),1!==wr.length||br||Sr(Rr)}function Ar(e,t){this.fun=e,this.array=t}Ar.prototype.run=function(){this.fun.apply(null,this.array)};var Or=yi.performance||{};function Pr(){}function Ur(){Ur.init.call(this)}function xr(e){return void 0===e._maxListeners?Ur.defaultMaxListeners:e._maxListeners}function Vr(e,t,n,o){var a,i,r,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),r=i[t]):(i=e._events=new Pr,e._eventsCount=0),r){if("function"==typeof r?r=i[t]=o?[n,r]:[r,n]:o?r.unshift(n):r.push(n),!r.warned&&(a=xr(e))&&a>0&&r.length>a){r.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=r.length,s=l,"function"==typeof console.warn?oe("warn","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2",s):oe("log","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2",s)}}else r=i[t]=n,++e._eventsCount;return e}function Br(e,t,n){var o=!1;function a(){e.removeListener(t,a),o||(o=!0,n.apply(e,arguments))}return a.listener=n,a}function Gr(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function Fr(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}Or.now||Or.mozNow||Or.msNow||Or.oNow||Or.webkitNow,Pr.prototype=Object.create(null),Ur.EventEmitter=Ur,Ur.usingDomains=!1,Ur.prototype.domain=void 0,Ur.prototype._events=void 0,Ur.prototype._maxListeners=void 0,Ur.defaultMaxListeners=10,Ur.init=function(){this.domain=null,Ur.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new Pr,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Ur.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},Ur.prototype.getMaxListeners=function(){return xr(this)},Ur.prototype.emit=function(e){var t,n,o,a,i,r,s,l="error"===e;if(r=this._events)l=l&&null==r.error;else if(!l)return!1;if(s=this.domain,l){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=r[e]))return!1;var u="function"==typeof n;switch(o=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var o=e.length,a=Fr(e,o),i=0;i<o;++i)a[i].call(n)}(n,u,this);break;case 2:!function(e,t,n,o){if(t)e.call(n,o);else for(var a=e.length,i=Fr(e,a),r=0;r<a;++r)i[r].call(n,o)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,o,a){if(t)e.call(n,o,a);else for(var i=e.length,r=Fr(e,i),s=0;s<i;++s)r[s].call(n,o,a)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,o,a,i){if(t)e.call(n,o,a,i);else for(var r=e.length,s=Fr(e,r),l=0;l<r;++l)s[l].call(n,o,a,i)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(o-1),i=1;i<o;i++)a[i-1]=arguments[i];!function(e,t,n,o){if(t)e.apply(n,o);else for(var a=e.length,i=Fr(e,a),r=0;r<a;++r)i[r].apply(n,o)}(n,u,this,a)}return!0},Ur.prototype.addListener=function(e,t){return Vr(this,e,t,!1)},Ur.prototype.on=Ur.prototype.addListener,Ur.prototype.prependListener=function(e,t){return Vr(this,e,t,!0)},Ur.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,Br(this,e,t)),this},Ur.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,Br(this,e,t)),this},Ur.prototype.removeListener=function(e,t){var n,o,a,i,r;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(o=this._events))return this;if(!(n=o[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new Pr:(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,i=n.length;i-- >0;)if(n[i]===t||n[i].listener&&n[i].listener===t){r=n[i].listener,a=i;break}if(a<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new Pr,this;delete o[e]}else!function(e,t){for(var n=t,o=n+1,a=e.length;o<a;n+=1,o+=1)e[n]=e[o];e.pop()}(n,a);o.removeListener&&this.emit("removeListener",e,r||t)}return this},Ur.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new Pr,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new Pr:delete n[e]),this;if(0===arguments.length){for(var o,a=Object.keys(n),i=0;i<a.length;++i)"removeListener"!==(o=a[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new Pr,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},Ur.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},Ur.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):Gr.call(e,t)},Ur.prototype.listenerCount=Gr,Ur.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var zr="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},Hr=/%[sdj%]/g;function jr(e){if(!ns(e)){for(var t=[],n=0;n<arguments.length;n++)t.push($r(arguments[n]));return t.join(" ")}n=1;for(var o=arguments,a=o.length,i=String(e).replace(Hr,(function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(t){return"[Circular]"}default:return e}})),r=o[n];n<a;r=o[++n])ts(r)||!is(r)?i+=" "+r:i+=" "+$r(r);return i}function qr(e,t){if(os(yi.process))return function(){return qr(e,t).apply(this,arguments)};var n=!1;return function(){return n||(oe("error","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2",t),n=!0),e.apply(this,arguments)}}var Kr,Yr={};function $r(e,t){var n={seen:[],stylize:Zr};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),es(t)?n.showHidden=t:t&&function(e,t){if(!t||!is(t))return e;for(var n=Object.keys(t),o=n.length;o--;)e[n[o]]=t[n[o]]}(n,t),os(n.showHidden)&&(n.showHidden=!1),os(n.depth)&&(n.depth=2),os(n.colors)&&(n.colors=!1),os(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=Wr),Jr(n,e,n.depth)}function Wr(e,t){var n=$r.styles[t];return n?"["+$r.colors[n][0]+"m"+e+"["+$r.colors[n][1]+"m":e}function Zr(e,t){return e}function Jr(e,t,n){if(e.customInspect&&t&&ls(t.inspect)&&t.inspect!==$r&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(n,e);return ns(o)||(o=Jr(e,o,n)),o}var a=function(e,t){if(os(t))return e.stylize("undefined","undefined");if(ns(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return"number"==typeof t?e.stylize(""+t,"number"):es(t)?e.stylize(""+t,"boolean"):ts(t)?e.stylize("null","null"):void 0}(e,t);if(a)return a;var i,r=Object.keys(t),s=(i={},r.forEach((function(e,t){i[e]=!0})),i);if(e.showHidden&&(r=Object.getOwnPropertyNames(t)),ss(t)&&(r.indexOf("message")>=0||r.indexOf("description")>=0))return Xr(t);if(0===r.length){if(ls(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(as(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(rs(t))return e.stylize(Date.prototype.toString.call(t),"date");if(ss(t))return Xr(t)}var c,u,d="",p=!1,h=["{","}"];return c=t,Array.isArray(c)&&(p=!0,h=["[","]"]),ls(t)&&(d=" [Function"+(t.name?": "+t.name:"")+"]"),as(t)&&(d=" "+RegExp.prototype.toString.call(t)),rs(t)&&(d=" "+Date.prototype.toUTCString.call(t)),ss(t)&&(d=" "+Xr(t)),0!==r.length||p&&0!=t.length?n<0?as(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=p?function(e,t,n,o,a){for(var i=[],r=0,s=t.length;r<s;++r)us(t,String(r))?i.push(Qr(e,t,n,o,String(r),!0)):i.push("");return a.forEach((function(a){a.match(/^\d+$/)||i.push(Qr(e,t,n,o,a,!0))})),i}(e,t,n,s,r):r.map((function(o){return Qr(e,t,n,s,o,p)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(u,d,h)):h[0]+d+h[1]}function Xr(e){return"["+Error.prototype.toString.call(e)+"]"}function Qr(e,t,n,o,a,i){var r,s,l;if((l=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),us(o,a)||(r="["+a+"]"),s||(e.seen.indexOf(l.value)<0?(s=ts(n)?Jr(e,l.value,null):Jr(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),os(r)){if(i&&a.match(/^\d+$/))return s;(r=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),r=e.stylize(r,"string"))}return r+": "+s}function es(e){return"boolean"==typeof e}function ts(e){return null===e}function ns(e){return"string"==typeof e}function os(e){return void 0===e}function as(e){return is(e)&&"[object RegExp]"===cs(e)}function is(e){return"object"==typeof e&&null!==e}function rs(e){return is(e)&&"[object Date]"===cs(e)}function ss(e){return is(e)&&("[object Error]"===cs(e)||e instanceof Error)}function ls(e){return"function"==typeof e}function cs(e){return Object.prototype.toString.call(e)}function us(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ds(){this.head=null,this.tail=null,this.length=0}$r.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},$r.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},ds.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},ds.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},ds.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},ds.prototype.clear=function(){this.head=this.tail=null,this.length=0},ds.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},ds.prototype.concat=function(e){if(0===this.length)return Ai.alloc(0);if(1===this.length)return this.head.data;for(var t=Ai.allocUnsafe(e>>>0),n=this.head,o=0;n;)n.data.copy(t,o),o+=n.data.length,n=n.next;return t};var ps=Ai.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function hs(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!ps(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=gs;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=ms;break;default:return void(this.write=fs)}this.charBuffer=new Ai(6),this.charReceived=0,this.charLength=0}function fs(e){return e.toString(this.encoding)}function gs(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function ms(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}hs.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((o=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&o<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var o,a=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,a),a-=this.charReceived),a=(t+=e.toString(this.encoding,0,a)).length-1,(o=t.charCodeAt(a))>=55296&&o<=56319){var i=this.surrogateSize;return this.charLength+=i,this.charReceived+=i,this.charBuffer.copy(this.charBuffer,i,0,i),e.copy(this.charBuffer,0,0,i),t.substring(0,a)}return t},hs.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},hs.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,o=this.charBuffer,a=this.encoding;t+=o.slice(0,n).toString(a)}return t},Is.ReadableState=ys;var vs,_s=(vs="stream",os(Kr)&&(Kr=""),vs=vs.toUpperCase(),Yr[vs]||(new RegExp("\\b"+vs+"\\b","i").test(Kr)?Yr[vs]=function(){var e=jr.apply(null,arguments);oe("error","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","%s %d: %s",vs,0,e)}:Yr[vs]=function(){}),Yr[vs]);function ys(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof $s&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:o,this.highWaterMark=~~this.highWaterMark,this.buffer=new ds,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new hs(e.encoding),this.encoding=e.encoding)}function Is(e){if(!(this instanceof Is))return new Is(e);this._readableState=new ys(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),Ur.call(this)}function Cs(e,t,n,o,a){var i,r,s,l=(i=t,s=null,mr(r=n)||"string"==typeof r||null==r||i.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s);if(l)e.emit("error",l);else if(null===n)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,Ts(e)}}(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!a){var c=new Error("stream.push() after EOF");e.emit("error",c)}else if(t.endEmitted&&a){var u=new Error("stream.unshift() after end event");e.emit("error",u)}else{var d;!t.decoder||a||o||(n=t.decoder.write(n),d=!t.objectMode&&0===n.length),a||(t.reading=!1),d||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,a?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&Ts(e))),function(e,t){t.readingMore||(t.readingMore=!0,Lr(Ms,e,t))}(e,t)}else a||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}zr(Is,Ur),Is.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=Ai.from(e,t),t=""),Cs(this,n,e,t,!1)},Is.prototype.unshift=function(e){return Cs(this,this._readableState,e,"",!0)},Is.prototype.isPaused=function(){return!1===this._readableState.flowing},Is.prototype.setEncoding=function(e){return this._readableState.decoder=new hs(e),this._readableState.encoding=e,this};var ks=8388608;function Es(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=((n=e)>=ks?n=ks:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var n}function Ts(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(_s("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?Lr(Ss,e):Ss(e))}function Ss(e){_s("emit readable"),e.emit("readable"),Ds(e)}function Ms(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(_s("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function ws(e){_s("readable nexttick read 0"),e.read(0)}function bs(e,t){t.reading||(_s("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Ds(e),t.flowing&&!t.reading&&e.read(0)}function Ds(e){var t=e._readableState;for(_s("flow",t.flowing);t.flowing&&null!==e.read(););}function Ns(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):(n=e,o=t.buffer,a=t.decoder,n<o.head.data.length?(i=o.head.data.slice(0,n),o.head.data=o.head.data.slice(n)):i=n===o.head.data.length?o.shift():a?function(e,t){var n=t.head,o=1,a=n.data;for(e-=a.length;n=n.next;){var i=n.data,r=e>i.length?i.length:e;if(r===i.length?a+=i:a+=i.slice(0,e),0==(e-=r)){r===i.length?(++o,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(r));break}++o}return t.length-=o,a}(n,o):function(e,t){var n=Ai.allocUnsafe(e),o=t.head,a=1;for(o.data.copy(n),e-=o.data.length;o=o.next;){var i=o.data,r=e>i.length?i.length:e;if(i.copy(n,n.length-e,0,r),0==(e-=r)){r===i.length?(++a,o.next?t.head=o.next:t.head=t.tail=null):(t.head=o,o.data=i.slice(r));break}++a}return t.length-=a,n}(n,o),r=i),r);var n,o,a,i,r}function Rs(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,Lr(Ls,t,e))}function Ls(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function As(e,t){for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function Os(){}function Ps(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function Us(e,t){Object.defineProperty(this,"buffer",{get:qr((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof $s&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:o,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n,o=e._writableState,a=o.sync,i=o.writecb;if((n=o).writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t)!function(e,t,n,o,a){--t.pendingcb,n?Lr(a,o):a(o),e._writableState.errorEmitted=!0,e.emit("error",o)}(e,o,a,t,i);else{var r=Fs(o);r||o.corked||o.bufferProcessing||!o.bufferedRequest||Gs(e,o),a?Lr(Bs,e,o,r,i):Bs(e,o,r,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new js(this)}function xs(e){if(!(this instanceof xs||this instanceof $s))return new xs(e);this._writableState=new Us(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),Ur.call(this)}function Vs(e,t,n,o,a,i,r){t.writelen=o,t.writecb=r,t.writing=!0,t.sync=!0,n?e._writev(a,t.onwrite):e._write(a,i,t.onwrite),t.sync=!1}function Bs(e,t,n,o){var a,i;n||(a=e,0===(i=t).length&&i.needDrain&&(i.needDrain=!1,a.emit("drain"))),t.pendingcb--,o(),Hs(e,t)}function Gs(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var o=t.bufferedRequestCount,a=new Array(o),i=t.corkedRequestsFree;i.entry=n;for(var r=0;n;)a[r]=n,n=n.next,r+=1;Vs(e,t,!0,t.length,a,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new js(t)}else{for(;n;){var s=n.chunk,l=n.encoding,c=n.callback;if(Vs(e,t,!1,t.objectMode?1:s.length,s,l,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function Fs(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function zs(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function Hs(e,t){var n=Fs(t);return n&&(0===t.pendingcb?(zs(e,t),t.finished=!0,e.emit("finish")):zs(e,t)),n}function js(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var o=t.entry;for(t.entry=null;o;){var a=o.callback;e.pendingcb--,a(n),o=o.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}Is.prototype.read=function(e){_s("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return _s("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?Rs(this):Ts(this),null;if(0===(e=Es(e,t))&&t.ended)return 0===t.length&&Rs(this),null;var o,a=t.needReadable;return _s("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&_s("length less than watermark",a=!0),t.ended||t.reading?_s("reading or ended",a=!1):a&&(_s("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=Es(n,t))),null===(o=e>0?Ns(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&Rs(this)),null!==o&&this.emit("data",o),o},Is.prototype._read=function(e){this.emit("error",new Error("not implemented"))},Is.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,_s("pipe count=%d opts=%j",o.pipesCount,t);var a=t&&!1===t.end?c:r;function i(e){_s("onunpipe"),e===n&&c()}function r(){_s("onend"),e.end()}o.endEmitted?Lr(a):n.once("end",a),e.on("unpipe",i);var s=function(e){return function(){var t=e._readableState;_s("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,Ds(e))}}(n);e.on("drain",s);var l=!1;function c(){_s("cleanup"),e.removeListener("close",h),e.removeListener("finish",f),e.removeListener("drain",s),e.removeListener("error",p),e.removeListener("unpipe",i),n.removeListener("end",r),n.removeListener("end",c),n.removeListener("data",d),l=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var u=!1;function d(t){_s("ondata"),u=!1,!1!==e.write(t)||u||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==As(o.pipes,e))&&!l&&(_s("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,u=!0),n.pause())}function p(t){_s("onerror",t),g(),e.removeListener("error",p),0===e.listeners("error").length&&e.emit("error",t)}function h(){e.removeListener("finish",f),g()}function f(){_s("onfinish"),e.removeListener("close",h),g()}function g(){_s("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",p),e.once("close",h),e.once("finish",f),e.emit("pipe",n),o.flowing||(_s("pipe resume"),n.resume()),e},Is.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var n=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<o;a++)n[a].emit("unpipe",this);return this}var i=As(t.pipes,e);return-1===i||(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},Is.prototype.on=function(e,t){var n=Ur.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var o=this._readableState;o.endEmitted||o.readableListening||(o.readableListening=o.needReadable=!0,o.emittedReadable=!1,o.reading?o.length&&Ts(this):Lr(ws,this))}return n},Is.prototype.addListener=Is.prototype.on,Is.prototype.resume=function(){var e,t,n=this._readableState;return n.flowing||(_s("resume"),n.flowing=!0,e=this,(t=n).resumeScheduled||(t.resumeScheduled=!0,Lr(bs,e,t))),this},Is.prototype.pause=function(){return _s("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(_s("pause"),this._readableState.flowing=!1,this.emit("pause")),this},Is.prototype.wrap=function(e){var t=this._readableState,n=!1,o=this;for(var a in e.on("end",(function(){if(_s("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&o.push(e)}o.push(null)})),e.on("data",(function(a){_s("wrapped data"),t.decoder&&(a=t.decoder.write(a)),t.objectMode&&null==a||(t.objectMode||a&&a.length)&&(o.push(a)||(n=!0,e.pause()))})),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));return function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n])}(["error","close","destroy","pause","resume"],(function(t){e.on(t,o.emit.bind(o,t))})),o._read=function(t){_s("wrapped _read",t),n&&(n=!1,e.resume())},o},Is._fromList=Ns,xs.WritableState=Us,zr(xs,Ur),Us.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},xs.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},xs.prototype.write=function(e,t,n){var o,a,i,r=this._writableState,s=!1;return"function"==typeof t&&(n=t,t=null),Ai.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=Os),r.ended?(o=this,a=n,i=new Error("write after end"),o.emit("error",i),Lr(a,i)):function(e,t,n,o){var a=!0,i=!1;return null===n?i=new TypeError("May not write null values to stream"):Ai.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),Lr(o,i),a=!1),a}(this,r,e,n)&&(r.pendingcb++,s=function(e,t,n,o,a){var i,r,s;r=n,s=o,(i=t).objectMode||!1===i.decodeStrings||"string"!=typeof r||(r=Ai.from(r,s)),n=r,Ai.isBuffer(n)&&(o="buffer");var l=t.objectMode?1:n.length;t.length+=l;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new Ps(n,o,a),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else Vs(e,t,!1,l,n,o,a);return c}(this,r,e,t,n)),s},xs.prototype.cork=function(){this._writableState.corked++},xs.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Gs(this,e))},xs.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},xs.prototype._write=function(e,t,n){n(new Error("not implemented"))},xs.prototype._writev=null,xs.prototype.end=function(e,t,n){var o,a,i,r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||(o=this,i=n,(a=r).ending=!0,Hs(o,a),i&&(a.finished?Lr(i):o.once("finish",i)),a.ended=!0,o.writable=!1)},zr($s,Is);for(var qs=Object.keys(xs.prototype),Ks=0;Ks<qs.length;Ks++){var Ys=qs[Ks];$s.prototype[Ys]||($s.prototype[Ys]=xs.prototype[Ys])}function $s(e){if(!(this instanceof $s))return new $s(e);Is.call(this,e),xs.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",Ws)}function Ws(){this.allowHalfOpen||this._writableState.ended||Lr(Zs,this)}function Zs(e){e.end()}function Js(e){this.afterTransform=function(t,n){return function(e,t,n){var o=e._transformState;o.transforming=!1;var a=o.writecb;if(!a)return e.emit("error",new Error("no writecb in Transform class"));o.writechunk=null,o.writecb=null,null!=n&&e.push(n),a(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function Xs(e){if(!(this instanceof Xs))return new Xs(e);$s.call(this,e),this._transformState=new Js(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){Qs(t,e)})):Qs(t)}))}function Qs(e,t){if(t)return e.emit("error",t);var n=e._writableState,o=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(o.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function el(e){if(!(this instanceof el))return new el(e);Xs.call(this,e)}function tl(){Ur.call(this)}zr(Xs,$s),Xs.prototype.push=function(e,t){return this._transformState.needTransform=!1,$s.prototype.push.call(this,e,t)},Xs.prototype._transform=function(e,t,n){throw new Error("Not implemented")},Xs.prototype._write=function(e,t,n){var o=this._transformState;if(o.writecb=n,o.writechunk=e,o.writeencoding=t,!o.transforming){var a=this._readableState;(o.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},Xs.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},zr(el,Xs),el.prototype._transform=function(e,t,n){n(null,e)},zr(tl,Ur),tl.Readable=Is,tl.Writable=xs,tl.Duplex=$s,tl.Transform=Xs,tl.PassThrough=el,tl.Stream=tl,tl.prototype.pipe=function(e,t){var n=this;function o(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",o),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",r),n.on("close",s));var i=!1;function r(){i||(i=!0,e.end())}function s(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(c(),0===Ur.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",o),e.removeListener("drain",a),n.removeListener("end",r),n.removeListener("close",s),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",l),e.on("error",l),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e};var nl={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function ol(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function al(e,t,n,o,a){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+o),a);else for(var i=0;i<o;i++)e[a+i]=t[n+i]}var il=Uint8Array,rl=Uint16Array,sl=Int32Array;function ll(e){for(var t=e.length;--t>=0;)e[t]=0}var cl=256,ul=286,dl=30,pl=15,hl=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],fl=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],gl=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],ml=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],vl=new Array(576);ll(vl);var _l=new Array(60);ll(_l);var yl=new Array(512);ll(yl);var Il=new Array(256);ll(Il);var Cl=new Array(29);ll(Cl);var kl,El,Tl,Sl=new Array(dl);function Ml(e,t,n,o,a){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=o,this.max_length=a,this.has_stree=e&&e.length}function wl(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function bl(e){return e<256?yl[e]:yl[256+(e>>>7)]}function Dl(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function Nl(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,Dl(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function Rl(e,t,n){Nl(e,n[2*t],n[2*t+1])}function Ll(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function Al(e,t,n){var o,a,i=new Array(16),r=0;for(o=1;o<=pl;o++)i[o]=r=r+n[o-1]<<1;for(a=0;a<=t;a++){var s=e[2*a+1];0!==s&&(e[2*a]=Ll(i[s]++,s))}}function Ol(e){var t;for(t=0;t<ul;t++)e.dyn_ltree[2*t]=0;for(t=0;t<dl;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Pl(e){e.bi_valid>8?Dl(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Ul(e,t,n,o){var a=2*t,i=2*n;return e[a]<e[i]||e[a]===e[i]&&o[t]<=o[n]}function xl(e,t,n){for(var o=e.heap[n],a=n<<1;a<=e.heap_len&&(a<e.heap_len&&Ul(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!Ul(t,o,e.heap[a],e.depth));)e.heap[n]=e.heap[a],n=a,a<<=1;e.heap[n]=o}function Vl(e,t,n){var o,a,i,r,s=0;if(0!==e.last_lit)do{o=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],a=e.pending_buf[e.l_buf+s],s++,0===o?Rl(e,a,t):(Rl(e,(i=Il[a])+cl+1,t),0!==(r=hl[i])&&Nl(e,a-=Cl[i],r),Rl(e,i=bl(--o),n),0!==(r=fl[i])&&Nl(e,o-=Sl[i],r))}while(s<e.last_lit);Rl(e,256,t)}function Bl(e,t){var n,o,a,i=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,s&&(e.static_len-=r[2*a+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)xl(e,i,n);a=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],xl(e,i,1),o=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=o,i[2*a]=i[2*n]+i[2*o],e.depth[a]=(e.depth[n]>=e.depth[o]?e.depth[n]:e.depth[o])+1,i[2*n+1]=i[2*o+1]=a,e.heap[1]=a++,xl(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,o,a,i,r,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(i=0;i<=pl;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(i=l[2*l[2*(o=e.heap[n])+1]+1]+1)>f&&(i=f,g++),l[2*o+1]=i,o>c||(e.bl_count[i]++,r=0,o>=h&&(r=p[o-h]),s=l[2*o],e.opt_len+=s*(i+r),d&&(e.static_len+=s*(u[2*o+1]+r)));if(0!==g){do{for(i=f-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[f]--,g-=2}while(g>0);for(i=f;0!==i;i--)for(o=e.bl_count[i];0!==o;)(a=e.heap[--n])>c||(l[2*a+1]!==i&&(e.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),o--)}}(e,t),Al(i,c,e.bl_count)}function Gl(e,t,n){var o,a,i=-1,r=t[1],s=0,l=7,c=4;for(0===r&&(l=138,c=3),t[2*(n+1)+1]=65535,o=0;o<=n;o++)a=r,r=t[2*(o+1)+1],++s<l&&a===r||(s<c?e.bl_tree[2*a]+=s:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=a,0===r?(l=138,c=3):a===r?(l=6,c=3):(l=7,c=4))}function Fl(e,t,n){var o,a,i=-1,r=t[1],s=0,l=7,c=4;for(0===r&&(l=138,c=3),o=0;o<=n;o++)if(a=r,r=t[2*(o+1)+1],!(++s<l&&a===r)){if(s<c)do{Rl(e,a,e.bl_tree)}while(0!=--s);else 0!==a?(a!==i&&(Rl(e,a,e.bl_tree),s--),Rl(e,16,e.bl_tree),Nl(e,s-3,2)):s<=10?(Rl(e,17,e.bl_tree),Nl(e,s-3,3)):(Rl(e,18,e.bl_tree),Nl(e,s-11,7));s=0,i=a,0===r?(l=138,c=3):a===r?(l=6,c=3):(l=7,c=4)}}ll(Sl);var zl=!1;function Hl(e,t,n,o){var a,i,r;Nl(e,0+(o?1:0),3),i=t,r=n,Pl(a=e),Dl(a,r),Dl(a,~r),al(a.pending_buf,a.window,i,r,a.pending),a.pending+=r}function jl(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(Il[n]+cl+1)]++,e.dyn_dtree[2*bl(t)]++),e.last_lit===e.lit_bufsize-1}function ql(e,t,n,o){for(var a=65535&e,i=e>>>16&65535,r=0;0!==n;){n-=r=n>2e3?2e3:n;do{i=i+(a=a+t[o++]|0)|0}while(--r);a%=65521,i%=65521}return a|i<<16}var Kl=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var o=0;o<8;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();function Yl(e,t,n,o){var a=Kl,i=o+n;e^=-1;for(var r=o;r<i;r++)e=e>>>8^a[255&(e^t[r])];return~e}var $l,Wl=-2,Zl=258,Jl=262,Xl=103,Ql=113,ec=666;function tc(e,t){return e.msg=nl[t],t}function nc(e){return(e<<1)-(e>4?9:0)}function oc(e){for(var t=e.length;--t>=0;)e[t]=0}function ac(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(al(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function ic(e,t){(function(e,t,n,o){var a,i,r=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<cl;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),Bl(e,e.l_desc),Bl(e,e.d_desc),r=function(e){var t;for(Gl(e,e.dyn_ltree,e.l_desc.max_code),Gl(e,e.dyn_dtree,e.d_desc.max_code),Bl(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*ml[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=a&&(a=i)):a=i=n+5,n+4<=a&&-1!==t?Hl(e,t,n,o):4===e.strategy||i===a?(Nl(e,2+(o?1:0),3),Vl(e,vl,_l)):(Nl(e,4+(o?1:0),3),function(e,t,n,o){var a;for(Nl(e,t-257,5),Nl(e,n-1,5),Nl(e,o-4,4),a=0;a<o;a++)Nl(e,e.bl_tree[2*ml[a]+1],3);Fl(e,e.dyn_ltree,t-1),Fl(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,r+1),Vl(e,e.dyn_ltree,e.dyn_dtree)),Ol(e),o&&Pl(e)})(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ac(e.strm)}function rc(e,t){e.pending_buf[e.pending++]=t}function sc(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function lc(e,t){var n,o,a=e.max_chain_length,i=e.strstart,r=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-Jl?e.strstart-(e.w_size-Jl):0,c=e.window,u=e.w_mask,d=e.prev,p=e.strstart+Zl,h=c[i+r-1],f=c[i+r];e.prev_length>=e.good_match&&(a>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+r]===f&&c[n+r-1]===h&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<p);if(o=Zl-(p-i),i=p-Zl,o>r){if(e.match_start=t,r=o,o>=s)break;h=c[i+r-1],f=c[i+r]}}}while((t=d[t&u])>l&&0!=--a);return r<=e.lookahead?r:e.lookahead}function cc(e){var t,n,o,a,i,r,s,l,c,u,d=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-Jl)){al(e.window,e.window,d,d,0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=n=e.hash_size;do{o=e.head[--t],e.head[t]=o>=d?o-d:0}while(--n);t=n=d;do{o=e.prev[--t],e.prev[t]=o>=d?o-d:0}while(--n);a+=d}if(0===e.strm.avail_in)break;if(r=e.strm,s=e.window,l=e.strstart+e.lookahead,c=a,u=void 0,(u=r.avail_in)>c&&(u=c),n=0===u?0:(r.avail_in-=u,al(s,r.input,r.next_in,u,l),1===r.state.wrap?r.adler=ql(r.adler,s,u,l):2===r.state.wrap&&(r.adler=Yl(r.adler,s,u,l)),r.next_in+=u,r.total_in+=u,u),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+3-1])&e.hash_mask,e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<Jl&&0!==e.strm.avail_in)}function uc(e,t){for(var n,o;;){if(e.lookahead<Jl){if(cc(e),e.lookahead<Jl&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-Jl&&(e.match_length=lc(e,n)),e.match_length>=3)if(o=jl(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else o=jl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(ic(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(ic(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ic(e,!1),0===e.strm.avail_out)?1:2}function dc(e,t){for(var n,o,a;;){if(e.lookahead<Jl){if(cc(e),e.lookahead<Jl&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-Jl&&(e.match_length=lc(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,o=jl(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,o&&(ic(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((o=jl(e,0,e.window[e.strstart-1]))&&ic(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=jl(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(ic(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ic(e,!1),0===e.strm.avail_out)?1:2}function pc(e,t,n,o,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=o,this.func=a}function hc(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new rl(1146),this.dyn_dtree=new rl(122),this.bl_tree=new rl(78),oc(this.dyn_ltree),oc(this.dyn_dtree),oc(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new rl(16),this.heap=new rl(573),oc(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new rl(573),oc(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function fc(e){var t,n,o,a=(n=e)&&n.state?(n.total_in=n.total_out=0,n.data_type=2,(o=n.state).pending=0,o.pending_out=0,o.wrap<0&&(o.wrap=-o.wrap),o.status=o.wrap?42:Ql,n.adler=2===o.wrap?0:1,o.last_flush=0,function(e){zl||(function(){var e,t,n,o,a,i=new Array(16);for(n=0,o=0;o<28;o++)for(Cl[o]=n,e=0;e<1<<hl[o];e++)Il[n++]=o;for(Il[n-1]=o,a=0,o=0;o<16;o++)for(Sl[o]=a,e=0;e<1<<fl[o];e++)yl[a++]=o;for(a>>=7;o<dl;o++)for(Sl[o]=a<<7,e=0;e<1<<fl[o]-7;e++)yl[256+a++]=o;for(t=0;t<=pl;t++)i[t]=0;for(e=0;e<=143;)vl[2*e+1]=8,e++,i[8]++;for(;e<=255;)vl[2*e+1]=9,e++,i[9]++;for(;e<=279;)vl[2*e+1]=7,e++,i[7]++;for(;e<=287;)vl[2*e+1]=8,e++,i[8]++;for(Al(vl,287,i),e=0;e<dl;e++)_l[2*e+1]=5,_l[2*e]=Ll(e,5);kl=new Ml(vl,hl,257,ul,pl),El=new Ml(_l,fl,0,dl,pl),Tl=new Ml(new Array(0),gl,0,19,7)}(),zl=!0),e.l_desc=new wl(e.dyn_ltree,kl),e.d_desc=new wl(e.dyn_dtree,El),e.bl_desc=new wl(e.bl_tree,Tl),e.bi_buf=0,e.bi_valid=0,Ol(e)}(o),0):tc(n,Wl);return 0===a&&((t=e.state).window_size=2*t.w_size,oc(t.head),t.max_lazy_match=$l[t.level].max_lazy,t.good_match=$l[t.level].good_length,t.nice_match=$l[t.level].nice_length,t.max_chain_length=$l[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),a}function gc(e,t){var n,o,a,i;if(!e||!e.state||t>5||t<0)return e?tc(e,Wl):Wl;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||o.status===ec&&4!==t)return tc(e,0===e.avail_out?-5:Wl);if(o.strm=e,n=o.last_flush,o.last_flush=t,42===o.status)if(2===o.wrap)e.adler=0,rc(o,31),rc(o,139),rc(o,8),o.gzhead?(rc(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),rc(o,255&o.gzhead.time),rc(o,o.gzhead.time>>8&255),rc(o,o.gzhead.time>>16&255),rc(o,o.gzhead.time>>24&255),rc(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),rc(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(rc(o,255&o.gzhead.extra.length),rc(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=Yl(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(rc(o,0),rc(o,0),rc(o,0),rc(o,0),rc(o,0),rc(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),rc(o,3),o.status=Ql);else{var r=8+(o.w_bits-8<<4)<<8;r|=(o.strategy>=2||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(r|=32),r+=31-r%31,o.status=Ql,sc(o,r),0!==o.strstart&&(sc(o,e.adler>>>16),sc(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(a=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>a&&(e.adler=Yl(e.adler,o.pending_buf,o.pending-a,a)),ac(e),a=o.pending,o.pending!==o.pending_buf_size));)rc(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>a&&(e.adler=Yl(e.adler,o.pending_buf,o.pending-a,a)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=Yl(e.adler,o.pending_buf,o.pending-a,a)),ac(e),a=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,rc(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>a&&(e.adler=Yl(e.adler,o.pending_buf,o.pending-a,a)),0===i&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=Yl(e.adler,o.pending_buf,o.pending-a,a)),ac(e),a=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,rc(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>a&&(e.adler=Yl(e.adler,o.pending_buf,o.pending-a,a)),0===i&&(o.status=Xl)}else o.status=Xl;if(o.status===Xl&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&ac(e),o.pending+2<=o.pending_buf_size&&(rc(o,255&e.adler),rc(o,e.adler>>8&255),e.adler=0,o.status=Ql)):o.status=Ql),0!==o.pending){if(ac(e),0===e.avail_out)return o.last_flush=-1,0}else if(0===e.avail_in&&nc(t)<=nc(n)&&4!==t)return tc(e,-5);if(o.status===ec&&0!==e.avail_in)return tc(e,-5);if(0!==e.avail_in||0!==o.lookahead||0!==t&&o.status!==ec){var s=2===o.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(cc(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=jl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(ic(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(ic(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ic(e,!1),0===e.strm.avail_out)?1:2}(o,t):3===o.strategy?function(e,t){for(var n,o,a,i,r=e.window;;){if(e.lookahead<=Zl){if(cc(e),e.lookahead<=Zl&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=r[a=e.strstart-1])===r[++a]&&o===r[++a]&&o===r[++a]){i=e.strstart+Zl;do{}while(o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&a<i);e.match_length=Zl-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=jl(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=jl(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(ic(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(ic(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(ic(e,!1),0===e.strm.avail_out)?1:2}(o,t):$l[o.level].func(o,t);if(3!==s&&4!==s||(o.status=ec),1===s||3===s)return 0===e.avail_out&&(o.last_flush=-1),0;if(2===s&&(1===t?function(e){var t;Nl(e,2,3),Rl(e,256,vl),16===(t=e).bi_valid?(Dl(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(o):5!==t&&(Hl(o,0,0,!1),3===t&&(oc(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),ac(e),0===e.avail_out))return o.last_flush=-1,0}return 4!==t?0:o.wrap<=0?1:(2===o.wrap?(rc(o,255&e.adler),rc(o,e.adler>>8&255),rc(o,e.adler>>16&255),rc(o,e.adler>>24&255),rc(o,255&e.total_in),rc(o,e.total_in>>8&255),rc(o,e.total_in>>16&255),rc(o,e.total_in>>24&255)):(sc(o,e.adler>>>16),sc(o,65535&e.adler)),ac(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?0:1)}$l=[new pc(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(cc(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var o=e.block_start+n;if((0===e.strstart||e.strstart>=o)&&(e.lookahead=e.strstart-o,e.strstart=o,ic(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-Jl&&(ic(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(ic(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(ic(e,!1),e.strm.avail_out),1)})),new pc(4,4,8,4,uc),new pc(4,5,16,8,uc),new pc(4,6,32,32,uc),new pc(4,4,16,16,dc),new pc(8,16,32,32,dc),new pc(8,16,128,128,dc),new pc(8,32,128,256,dc),new pc(32,128,258,1024,dc),new pc(32,258,258,4096,dc)];function mc(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f,g,m,v,_,y,I,C,k,E,T,S,M;n=e.state,o=e.next_in,S=e.input,a=o+(e.avail_in-5),i=e.next_out,M=e.output,r=i-(t-e.avail_out),s=i+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,d=n.wnext,p=n.window,h=n.hold,f=n.bits,g=n.lencode,m=n.distcode,v=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;e:do{f<15&&(h+=S[o++]<<f,f+=8,h+=S[o++]<<f,f+=8),y=g[h&v];t:for(;;){if(h>>>=I=y>>>24,f-=I,0==(I=y>>>16&255))M[i++]=65535&y;else{if(!(16&I)){if(!(64&I)){y=g[(65535&y)+(h&(1<<I)-1)];continue t}if(32&I){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}C=65535&y,(I&=15)&&(f<I&&(h+=S[o++]<<f,f+=8),C+=h&(1<<I)-1,h>>>=I,f-=I),f<15&&(h+=S[o++]<<f,f+=8,h+=S[o++]<<f,f+=8),y=m[h&_];n:for(;;){if(h>>>=I=y>>>24,f-=I,!(16&(I=y>>>16&255))){if(!(64&I)){y=m[(65535&y)+(h&(1<<I)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(k=65535&y,f<(I&=15)&&(h+=S[o++]<<f,(f+=8)<I&&(h+=S[o++]<<f,f+=8)),(k+=h&(1<<I)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=I,f-=I,k>(I=i-r)){if((I=k-I)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,T=p,0===d){if(E+=c-I,I<C){C-=I;do{M[i++]=p[E++]}while(--I);E=i-k,T=M}}else if(d<I){if(E+=c+d-I,(I-=d)<C){C-=I;do{M[i++]=p[E++]}while(--I);if(E=0,d<C){C-=I=d;do{M[i++]=p[E++]}while(--I);E=i-k,T=M}}}else if(E+=d-I,I<C){C-=I;do{M[i++]=p[E++]}while(--I);E=i-k,T=M}for(;C>2;)M[i++]=T[E++],M[i++]=T[E++],M[i++]=T[E++],C-=3;C&&(M[i++]=T[E++],C>1&&(M[i++]=T[E++]))}else{E=i-k;do{M[i++]=M[E++],M[i++]=M[E++],M[i++]=M[E++],C-=3}while(C>2);C&&(M[i++]=M[E++],C>1&&(M[i++]=M[E++]))}break}}break}}while(o<a&&i<s);o-=C=f>>3,h&=(1<<(f-=C<<3))-1,e.next_in=o,e.next_out=i,e.avail_in=o<a?a-o+5:5-(o-a),e.avail_out=i<s?s-i+257:257-(i-s),n.hold=h,n.bits=f}var vc=15,_c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],yc=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ic=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Cc=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function kc(e,t,n,o,a,i,r,s){var l,c,u,d,p,h,f,g,m,v=s.bits,_=0,y=0,I=0,C=0,k=0,E=0,T=0,S=0,M=0,w=0,b=null,D=0,N=new rl(16),R=new rl(16),L=null,A=0;for(_=0;_<=vc;_++)N[_]=0;for(y=0;y<o;y++)N[t[n+y]]++;for(k=v,C=vc;C>=1&&0===N[C];C--);if(k>C&&(k=C),0===C)return a[i++]=20971520,a[i++]=20971520,s.bits=1,0;for(I=1;I<C&&0===N[I];I++);for(k<I&&(k=I),S=1,_=1;_<=vc;_++)if(S<<=1,(S-=N[_])<0)return-1;if(S>0&&(0===e||1!==C))return-1;for(R[1]=0,_=1;_<vc;_++)R[_+1]=R[_]+N[_];for(y=0;y<o;y++)0!==t[n+y]&&(r[R[t[n+y]]++]=y);if(0===e?(b=L=r,h=19):1===e?(b=_c,D-=257,L=yc,A-=257,h=256):(b=Ic,L=Cc,h=-1),w=0,y=0,_=I,p=i,E=k,T=0,u=-1,d=(M=1<<k)-1,1===e&&M>852||2===e&&M>592)return 1;for(;;){f=_-T,r[y]<h?(g=0,m=r[y]):r[y]>h?(g=L[A+r[y]],m=b[D+r[y]]):(g=96,m=0),l=1<<_-T,I=c=1<<E;do{a[p+(w>>T)+(c-=l)]=f<<24|g<<16|m}while(0!==c);for(l=1<<_-1;w&l;)l>>=1;if(0!==l?(w&=l-1,w+=l):w=0,y++,0==--N[_]){if(_===C)break;_=t[n+r[y]]}if(_>k&&(w&d)!==u){for(0===T&&(T=k),p+=I,S=1<<(E=_-T);E+T<C&&!((S-=N[E+T])<=0);)E++,S<<=1;if(M+=1<<E,1===e&&M>852||2===e&&M>592)return 1;a[u=w&d]=k<<24|E<<16|p-i}}return 0!==w&&(a[p+w]=_-T<<24|64<<16),s.bits=k,0}var Ec=-2,Tc=12,Sc=30;function Mc(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function wc(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new rl(320),this.work=new rl(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function bc(e){var t,n,o;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,(n=e)&&n.state?(o=n.state,n.total_in=n.total_out=o.total=0,n.msg="",o.wrap&&(n.adler=1&o.wrap),o.mode=1,o.last=0,o.havedict=0,o.dmax=32768,o.head=null,o.hold=0,o.bits=0,o.lencode=o.lendyn=new sl(852),o.distcode=o.distdyn=new sl(592),o.sane=1,o.back=-1,0):Ec):Ec}var Dc,Nc,Rc=!0;function Lc(e){if(Rc){var t;for(Dc=new sl(512),Nc=new sl(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(kc(1,e.lens,0,288,Dc,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;kc(2,e.lens,0,32,Nc,0,e.work,{bits:5}),Rc=!1}e.lencode=Dc,e.lenbits=9,e.distcode=Nc,e.distbits=5}var Ac;function Oc(e){if(e<1||e>7)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function Pc(e,t){for(var n=0;n<e.length;n++)this[t+n]=e[n]}Oc.prototype.init=function(e,t,n,o,a){var i;switch(this.windowBits=e,this.level=t,this.memLevel=n,this.strategy=o,3!==this.mode&&4!==this.mode||(this.windowBits+=16),7===this.mode&&(this.windowBits+=32),5!==this.mode&&6!==this.mode||(this.windowBits=-this.windowBits),this.strm=new ol,this.mode){case 1:case 3:case 5:i=function(e,t,n,o,a,i){if(!e)return Wl;var r=1;if(-1===t&&(t=6),o<0?(r=0,o=-o):o>15&&(r=2,o-=16),a<1||a>9||o<8||o>15||t<0||t>9||i<0||i>4)return tc(e,Wl);8===o&&(o=9);var s=new hc;return e.state=s,s.strm=e,s.wrap=r,s.gzhead=null,s.w_bits=o,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=a+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new il(2*s.w_size),s.head=new rl(s.hash_size),s.prev=new rl(s.w_size),s.lit_bufsize=1<<a+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new il(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=i,s.method=8,fc(e)}(this.strm,this.level,0,this.windowBits,this.memLevel,this.strategy);break;case 2:case 4:case 6:case 7:i=function(e,t){var n,o,a,i,r,s;return e?(o=new wc,e.state=o,o.window=null,0!==(i=t,n=(a=e)&&a.state?(s=a.state,i<0?(r=0,i=-i):(r=1+(i>>4),i<48&&(i&=15)),i&&(i<8||i>15)?Ec:(null!==s.window&&s.wbits!==i&&(s.window=null),s.wrap=r,s.wbits=i,bc(a))):Ec)&&(e.state=null),n):Ec}(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}0===i?(this.write_in_progress=!1,this.init_done=!0):this._error(i)},Oc.prototype.params=function(){throw new Error("deflateParams Not supported")},Oc.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(0===this.mode)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},Oc.prototype.write=function(e,t,n,o,a,i,r){this._writeCheck(),this.write_in_progress=!0;var s=this;return Lr((function(){s.write_in_progress=!1;var l=s._write(e,t,n,o,a,i,r);s.callback(l[0],l[1]),s.pending_close&&s.close()})),this},Oc.prototype.writeSync=function(e,t,n,o,a,i,r){return this._writeCheck(),this._write(e,t,n,o,a,i,r)},Oc.prototype._write=function(e,t,n,o,a,i,r){if(this.write_in_progress=!0,0!==e&&1!==e&&2!==e&&3!==e&&4!==e&&5!==e)throw new Error("Invalid flush value");null==t&&(t=new Ai(0),o=0,n=0),a._set?a.set=a._set:a.set=Pc;var s,l=this.strm;switch(l.avail_in=o,l.input=t,l.next_in=n,l.avail_out=r,l.output=a,l.next_out=i,this.mode){case 1:case 3:case 5:s=gc(l,e);break;case 7:case 2:case 4:case 6:s=function(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f,g,m,v,_,y,I,C,k,E,T,S,M,w,b,D,N,R,L=0,A=new il(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return Ec;(n=e.state).mode===Tc&&(n.mode=13),r=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,u=n.bits,d=s,p=l,E=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(2&n.wrap&&35615===c){n.check=0,A[0]=255&c,A[1]=c>>>8&255,n.check=Yl(n.check,A,2,0),c=0,u=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=Sc;break}if(8!=(15&c)){e.msg="unknown compression method",n.mode=Sc;break}if(u-=4,k=8+(15&(c>>>=4)),0===n.wbits)n.wbits=k;else if(k>n.wbits){e.msg="invalid window size",n.mode=Sc;break}n.dmax=1<<k,e.adler=n.check=1,n.mode=512&c?10:Tc,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(n.flags=c,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=Sc;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=Sc;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,n.check=Yl(n.check,A,2,0)),c=0,u=0,n.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,n.check=Yl(n.check,A,4,0)),c=0,u=0,n.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,n.check=Yl(n.check,A,2,0)),c=0,u=0,n.mode=5;case 5:if(1024&n.flags){for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,n.check=Yl(n.check,A,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((h=n.length)>s&&(h=s),h&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),al(n.head.extra,o,i,h,k)),512&n.flags&&(n.check=Yl(n.check,o,h,i)),s-=h,i+=h,n.length-=h),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break e;h=0;do{k=o[i+h++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k))}while(k&&h<s);if(512&n.flags&&(n.check=Yl(n.check,o,h,i)),s-=h,i+=h,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break e;h=0;do{k=o[i+h++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k))}while(k&&h<s);if(512&n.flags&&(n.check=Yl(n.check,o,h,i)),s-=h,i+=h,k)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=Sc;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=Tc;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}e.adler=n.check=Mc(c),c=0,u=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,2;e.adler=n.check=1,n.mode=Tc;case Tc:if(5===t||6===t)break e;case 13:if(n.last){c>>>=7&u,u-=7&u,n.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}switch(n.last=1&c,u-=1,3&(c>>>=1)){case 0:n.mode=14;break;case 1:if(Lc(n),n.mode=20,6===t){c>>>=2,u-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=Sc}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=Sc;break}if(n.length=65535&c,c=0,u=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(h=n.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break e;al(a,o,i,h,r),s-=h,i+=h,l-=h,r+=h,n.length-=h;break}n.mode=Tc;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=Sc;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.lens[O[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[O[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},E=kc(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid code lengths set",n.mode=Sc;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;v=(L=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&L,!((m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(_<16)c>>>=m,u-=m,n.lens[n.have++]=_;else{if(16===_){for(S=m+2;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c>>>=m,u-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=Sc;break}k=n.lens[n.have-1],h=3+(3&c),c>>>=2,u-=2}else if(17===_){for(S=m+3;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}u-=m,k=0,h=3+(7&(c>>>=m)),c>>>=3,u-=3}else{for(S=m+7;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}u-=m,k=0,h=11+(127&(c>>>=m)),c>>>=7,u-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=Sc;break}for(;h--;)n.lens[n.have++]=k}}if(n.mode===Sc)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=Sc;break}if(n.lenbits=9,T={bits:n.lenbits},E=kc(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid literal/lengths set",n.mode=Sc;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},E=kc(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,E){e.msg="invalid distances set",n.mode=Sc;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(s>=6&&l>=258){e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,mc(e,p),r=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,u=n.bits,n.mode===Tc&&(n.back=-1);break}for(n.back=0;v=(L=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&L,!((m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(v&&!(240&v)){for(y=m,I=v,C=_;v=(L=n.lencode[C+((c&(1<<y+I)-1)>>y)])>>>16&255,_=65535&L,!(y+(m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}c>>>=y,u-=y,n.back+=y}if(c>>>=m,u-=m,n.back+=m,n.length=_,0===v){n.mode=26;break}if(32&v){n.back=-1,n.mode=Tc;break}if(64&v){e.msg="invalid literal/length code",n.mode=Sc;break}n.extra=15&v,n.mode=22;case 22:if(n.extra){for(S=n.extra;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;v=(L=n.distcode[c&(1<<n.distbits)-1])>>>16&255,_=65535&L,!((m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(!(240&v)){for(y=m,I=v,C=_;v=(L=n.distcode[C+((c&(1<<y+I)-1)>>y)])>>>16&255,_=65535&L,!(y+(m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}c>>>=y,u-=y,n.back+=y}if(c>>>=m,u-=m,n.back+=m,64&v){e.msg="invalid distance code",n.mode=Sc;break}n.offset=_,n.extra=15&v,n.mode=24;case 24:if(n.extra){for(S=n.extra;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=Sc;break}n.mode=25;case 25:if(0===l)break e;if(h=p-l,n.offset>h){if((h=n.offset-h)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=Sc;break}h>n.wnext?(h-=n.wnext,f=n.wsize-h):f=n.wnext-h,h>n.length&&(h=n.length),g=n.window}else g=a,f=r-n.offset,h=n.length;h>l&&(h=l),l-=h,n.length-=h;do{a[r++]=g[f++]}while(--h);0===n.length&&(n.mode=21);break;case 26:if(0===l)break e;a[r++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;u<32;){if(0===s)break e;s--,c|=o[i++]<<u,u+=8}if(p-=l,e.total_out+=p,n.total+=p,p&&(e.adler=n.check=n.flags?Yl(n.check,a,p,r-p):ql(n.check,a,p,r-p)),p=l,(n.flags?c:Mc(c))!==n.check){e.msg="incorrect data check",n.mode=Sc;break}c=0,u=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=Sc;break}c=0,u=0}n.mode=29;case 29:E=1;break e;case Sc:E=-3;break e;case 31:return-4;default:return Ec}return e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<Sc&&(n.mode<27||4!==t))&&(M=e,w=e.output,b=e.next_out,D=p-e.avail_out,null===(R=M.state).window&&(R.wsize=1<<R.wbits,R.wnext=0,R.whave=0,R.window=new il(R.wsize)),D>=R.wsize?(al(R.window,w,b-R.wsize,R.wsize,0),R.wnext=0,R.whave=R.wsize):((N=R.wsize-R.wnext)>D&&(N=D),al(R.window,w,b-D,N,R.wnext),(D-=N)?(al(R.window,w,b-D,D,0),R.wnext=D,R.whave=R.wsize):(R.wnext+=N,R.wnext===R.wsize&&(R.wnext=0),R.whave<R.wsize&&(R.whave+=N)))),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,n.wrap&&p&&(e.adler=n.check=n.flags?Yl(n.check,a,p,e.next_out-p):ql(n.check,a,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===Tc?128:0)+(20===n.mode||15===n.mode?256:0),(0===d&&0===p||4===t)&&0===E&&(E=-5),E}(l,e);break;default:throw new Error("Unknown mode "+this.mode)}return 1!==s&&0!==s&&this._error(s),this.write_in_progress=!1,[l.avail_in,l.avail_out]},Oc.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,1===this.mode||3===this.mode||5===this.mode?function(e){var t;e&&e.state&&(42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==Xl&&t!==Ql&&t!==ec?tc(e,Wl):(e.state=null,t===Ql&&tc(e,-3)))}(this.strm):function(e){if(!e||!e.state)return Ec;var t=e.state;t.window&&(t.window=null),e.state=null}(this.strm),this.mode=0)},Oc.prototype.reset=function(){switch(this.mode){case 1:case 5:Ac=fc(this.strm);break;case 2:case 6:Ac=bc(this.strm)}0!==Ac&&this._error(Ac)},Oc.prototype._error=function(e){this.onerror(nl[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var Uc=Object.freeze({NONE:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8,Zlib:Oc}),xc={};Object.keys(Uc).forEach((function(e){xc[e]=Uc[e]})),xc.Z_MIN_WINDOWBITS=8,xc.Z_MAX_WINDOWBITS=15,xc.Z_DEFAULT_WINDOWBITS=15,xc.Z_MIN_CHUNK=64,xc.Z_MAX_CHUNK=1/0,xc.Z_DEFAULT_CHUNK=16384,xc.Z_MIN_MEMLEVEL=1,xc.Z_MAX_MEMLEVEL=9,xc.Z_DEFAULT_MEMLEVEL=8,xc.Z_MIN_LEVEL=-1,xc.Z_MAX_LEVEL=9,xc.Z_DEFAULT_LEVEL=xc.Z_DEFAULT_COMPRESSION;var Vc={Z_OK:xc.Z_OK,Z_STREAM_END:xc.Z_STREAM_END,Z_NEED_DICT:xc.Z_NEED_DICT,Z_ERRNO:xc.Z_ERRNO,Z_STREAM_ERROR:xc.Z_STREAM_ERROR,Z_DATA_ERROR:xc.Z_DATA_ERROR,Z_MEM_ERROR:xc.Z_MEM_ERROR,Z_BUF_ERROR:xc.Z_BUF_ERROR,Z_VERSION_ERROR:xc.Z_VERSION_ERROR};function Bc(e,t){if("string"==typeof t&&(t=new Ai(t)),!mr(t))throw new TypeError("Not a string or buffer");var n=xc.Z_FINISH;return e._processChunk(t,n)}function Gc(e){if(!(this instanceof Gc))return new Gc(e);Yc.call(this,e,xc.DEFLATE)}function Fc(e){if(!(this instanceof Fc))return new Fc(e);Yc.call(this,e,xc.INFLATE)}function zc(e){if(!(this instanceof zc))return new zc(e);Yc.call(this,e,xc.GZIP)}function Hc(e){if(!(this instanceof Hc))return new Hc(e);Yc.call(this,e,xc.GUNZIP)}function jc(e){if(!(this instanceof jc))return new jc(e);Yc.call(this,e,xc.DEFLATERAW)}function qc(e){if(!(this instanceof qc))return new qc(e);Yc.call(this,e,xc.INFLATERAW)}function Kc(e){if(!(this instanceof Kc))return new Kc(e);Yc.call(this,e,xc.UNZIP)}function Yc(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||xc.Z_DEFAULT_CHUNK,Xs.call(this,e),e.flush&&e.flush!==xc.Z_NO_FLUSH&&e.flush!==xc.Z_PARTIAL_FLUSH&&e.flush!==xc.Z_SYNC_FLUSH&&e.flush!==xc.Z_FULL_FLUSH&&e.flush!==xc.Z_FINISH&&e.flush!==xc.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||xc.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<xc.Z_MIN_CHUNK||e.chunkSize>xc.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<xc.Z_MIN_WINDOWBITS||e.windowBits>xc.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<xc.Z_MIN_LEVEL||e.level>xc.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<xc.Z_MIN_MEMLEVEL||e.memLevel>xc.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=xc.Z_FILTERED&&e.strategy!=xc.Z_HUFFMAN_ONLY&&e.strategy!=xc.Z_RLE&&e.strategy!=xc.Z_FIXED&&e.strategy!=xc.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!mr(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new xc.Zlib(t);var n=this;this._hadError=!1,this._binding.onerror=function(e,t){n._binding=null,n._hadError=!0;var o=new Error(e);o.errno=t,o.code=xc.codes[t],n.emit("error",o)};var o=xc.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(o=e.level);var a=xc.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(a=e.strategy),this._binding.init(e.windowBits||xc.Z_DEFAULT_WINDOWBITS,o,e.memLevel||xc.Z_DEFAULT_MEMLEVEL,a,e.dictionary),this._buffer=new Ai(this._chunkSize),this._offset=0,this._closed=!1,this._level=o,this._strategy=a,this.once("end",this.close)}Object.keys(Vc).forEach((function(e){Vc[Vc[e]]=e})),zr(Yc,Xs),Yc.prototype.params=function(e,t,n){if(e<xc.Z_MIN_LEVEL||e>xc.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=xc.Z_FILTERED&&t!=xc.Z_HUFFMAN_ONLY&&t!=xc.Z_RLE&&t!=xc.Z_FIXED&&t!=xc.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var o=this;this.flush(xc.Z_SYNC_FLUSH,(function(){o._binding.params(e,t),o._hadError||(o._level=e,o._strategy=t,n&&n())}))}else Lr(n)},Yc.prototype.reset=function(){return this._binding.reset()},Yc.prototype._flush=function(e){this._transform(new Ai(0),"",e)},Yc.prototype.flush=function(e,t){var n=this._writableState;if(("function"==typeof e||void 0===e&&!t)&&(t=e,e=xc.Z_FULL_FLUSH),n.ended)t&&Lr(t);else if(n.ending)t&&this.once("end",t);else if(n.needDrain){var o=this;this.once("drain",(function(){o.flush(t)}))}else this._flushFlag=e,this.write(new Ai(0),"",t)},Yc.prototype.close=function(e){if(e&&Lr(e),!this._closed){this._closed=!0,this._binding.close();var t=this;Lr((function(){t.emit("close")}))}},Yc.prototype._transform=function(e,t,n){var o,a=this._writableState,i=(a.ending||a.ended)&&(!e||a.length===e.length);if(null===!e&&!mr(e))return n(new Error("invalid input"));i?o=xc.Z_FINISH:(o=this._flushFlag,e.length>=a.length&&(this._flushFlag=this._opts.flush||xc.Z_NO_FLUSH)),this._processChunk(e,o,n)},Yc.prototype._processChunk=function(e,t,n){var o=e&&e.length,a=this._chunkSize-this._offset,i=0,r=this,s="function"==typeof n;if(!s){var l,c=[],u=0;this.on("error",(function(e){l=e}));do{var d=this._binding.writeSync(t,e,i,o,this._buffer,this._offset,a)}while(!this._hadError&&f(d[0],d[1]));if(this._hadError)throw l;var p=Ai.concat(c,u);return this.close(),p}var h=this._binding.write(t,e,i,o,this._buffer,this._offset,a);function f(l,d){if(!r._hadError){var p=a-d;if(function(e){if(!e)throw new Error("have should not go down")}(p>=0),p>0){var h=r._buffer.slice(r._offset,r._offset+p);r._offset+=p,s?r.push(h):(c.push(h),u+=h.length)}if((0===d||r._offset>=r._chunkSize)&&(a=r._chunkSize,r._offset=0,r._buffer=new Ai(r._chunkSize)),0===d){if(i+=o-l,o=l,!s)return!0;var g=r._binding.write(t,e,i,o,r._buffer,r._offset,r._chunkSize);return g.callback=f,void(g.buffer=e)}if(!s)return!1;n()}}h.buffer=e,h.callback=f},zr(Gc,Yc),zr(Fc,Yc),zr(zc,Yc),zr(Hc,Yc),zr(jc,Yc),zr(qc,Yc),zr(Kc,Yc);var $c=function(e,t){return Bc(new Gc(t),e)},Wc=function(e,t){return Bc(new Fc(t),e)};class Zc{constructor(e,t,n){this.SDKAPPID=e,this.EXPIRETIME=n,this.PRIVATEKEY=t}genTestUserSig(e){return this._isNumber(this.SDKAPPID)?this._isString(this.PRIVATEKEY)?this._isString(e)?this._isNumber(this.EXPIRETIME)?(oe("log","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","sdkAppID="+this.SDKAPPID+" key="+this.PRIVATEKEY+" userID="+e+" expire="+this.EXPIRETIME),this.genSigWithUserbuf(e,this.EXPIRETIME,null)):(oe("error","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","expireTime must be a number"),""):(oe("error","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","userID must be a string"),""):(oe("error","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","privateKey must be a string"),""):(oe("error","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","sdkAppID must be a number"),"")}newBuffer(e,t){return Ai.from?Ai.from(e,t):new Ai(e,t)}unescape(e){return e.replace(/_/g,"=").replace(/\-/g,"/").replace(/\*/g,"+")}escape(e){return e.replace(/\+/g,"*").replace(/\//g,"-").replace(/=/g,"_")}encode(e){return this.escape(this.newBuffer(e).toString("base64"))}decode(e){return this.newBuffer(this.unescape(e),"base64")}base64encode(e){return this.newBuffer(e).toString("base64")}base64decode(e){return this.newBuffer(e,"base64").toString()}_hmacsha256(e,t,n,o){let a="TLS.identifier:"+e+"\n";a+="TLS.sdkappid:"+this.SDKAPPID+"\n",a+="TLS.time:"+t+"\n",a+="TLS.expire:"+n+"\n",null!=o&&(a+="TLS.userbuf:"+o+"\n");let i=Ir.HmacSHA256(a,this.PRIVATEKEY);return Ir.enc.Base64.stringify(i)}_utc(){return Math.round(Date.now()/1e3)}_isNumber(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"==typeof e&&e.constructor===Number)}_isString(e){return"string"==typeof e}genSigWithUserbuf(e,t,n){let o=this._utc(),a={"TLS.ver":"2.0","TLS.identifier":e,"TLS.sdkappid":this.SDKAPPID,"TLS.time":o,"TLS.expire":t},i="";if(null!=n){let r=this.base64encode(n);a["TLS.userbuf"]=r,i=this._hmacsha256(e,o,t,r)}else i=this._hmacsha256(e,o,t,null);a["TLS.sig"]=i;let r=JSON.stringify(a),s=$c(this.newBuffer(r)).toString("base64"),l=this.escape(s);return oe("log","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","ret="+l),l}validate(e){let t=this.decode(e);oe("log","at TUIKit/debug/lib-generate-test-usersig-es.min.js:2","validate ret="+Wc(t))}}function Jc(e,t){var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(o=Object.getOwnPropertySymbols(e);a<o.length;a++)t.indexOf(o[a])<0&&Object.prototype.propertyIsEnumerable.call(e,o[a])&&(n[o[a]]=e[o[a]])}return n}function Xc(e,t,n,o){return new(n||(n=Promise))((function(t,a){function i(e){try{s(o.next(e))}catch(t){a(t)}}function r(e){try{s(o.throw(e))}catch(t){a(t)}}function s(e){var o;e.done?t(e.value):(o=e.value,o instanceof n?o:new n((function(e){e(o)}))).then(i,r)}s((o=o.apply(e,[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;let Qc=class e{constructor(t){return e.instance||(e.instance=this,this.engine=t,this.events={},this.bindIMEvents()),e.instance}addEvent(e,t){this.events[e]||(this.events[e]=new Map),this.events[e].set(t,1)}removeEvents(){Object.keys(this.events).forEach((e=>{this.events[e].clear()})),this.events={}}dispatch(e,t){if(this.events[e])for(const n of this.events[e].keys())n.call(this,t)}bindIMEvents(){this.engine.chat.on(this.engine.EVENT.SDK_READY,this.onSDKReady,this),this.engine.chat.on(this.engine.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.engine.chat.on(this.engine.EVENT.KICKED_OUT,this.onKickedOut,this),this.engine.chat.on(this.engine.EVENT.NET_STATE_CHANGE,this.onNetStateChange,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_RECEIVED,this.onReceiveMessage,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_MODIFIED,this.onMessageModified,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_REVOKED,this.onMessageRevoked,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived,this),this.engine.chat.on(this.engine.EVENT.MESSAGE_REACTIONS_UPDATED,this.onMessageReactionsUpdated,this),this.engine.chat.on(this.engine.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated,this),this.engine.chat.on(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalMessageCountUpdated,this),this.engine.chat.on(this.engine.EVENT.PROFILE_UPDATED,this.onProfileUpdated,this),this.engine.chat.on(this.engine.EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated,this),this.engine.chat.on(this.engine.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated,this),this.engine.chat.on(this.engine.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated,this),this.engine.chat.on(this.engine.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated,this),this.engine.chat.on(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated,this)}unbindIMEvents(){this.engine.chat.off(this.engine.EVENT.SDK_READY,this.onSDKReady,this),this.engine.chat.off(this.engine.EVENT.SDK_NOT_READY,this.onSDKNotReady,this),this.engine.chat.off(this.engine.EVENT.KICKED_OUT,this.onKickedOut,this),this.engine.chat.off(this.engine.EVENT.NET_STATE_CHANGE,this.onNetStateChange,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_RECEIVED,this.onReceiveMessage,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_MODIFIED,this.onMessageModified,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_REVOKED,this.onMessageRevoked,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived,this),this.engine.chat.off(this.engine.EVENT.MESSAGE_REACTIONS_UPDATED,this.onMessageReactionsUpdated,this),this.engine.chat.off(this.engine.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated,this),this.engine.chat.off(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalMessageCountUpdated,this),this.engine.chat.off(this.engine.EVENT.PROFILE_UPDATED,this.onProfileUpdated,this),this.engine.chat.off(this.engine.EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated,this),this.engine.chat.off(this.engine.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated,this),this.engine.chat.off(this.engine.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated,this),this.engine.chat.off(this.engine.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated,this),this.engine.chat.off(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated,this)}onSDKReady(e){this.dispatch(this.engine.EVENT.SDK_READY,e.data)}onSDKNotReady(e){this.dispatch(this.engine.EVENT.SDK_NOT_READY,e.data)}onKickedOut(e){this.dispatch(this.engine.EVENT.KICKED_OUT,e.data)}onNetStateChange(e){this.dispatch(this.engine.EVENT.NET_STATE_CHANGE,e.data)}onReceiveMessage(e){this.dispatch(this.engine.EVENT.MESSAGE_RECEIVED,e.data)}onMessageModified(e){this.dispatch(this.engine.EVENT.MESSAGE_MODIFIED,e.data)}onMessageRevoked(e){this.dispatch(this.engine.EVENT.MESSAGE_REVOKED,e.data)}onMessageReadByPeer(e){this.dispatch(this.engine.EVENT.MESSAGE_READ_BY_PEER,e.data)}onMessageReadReceiptReceived(e){this.dispatch(this.engine.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,e.data)}onMessageReactionsUpdated(e){this.dispatch(this.engine.EVENT.MESSAGE_REACTIONS_UPDATED,e.data)}onConversationListUpdated(e){this.dispatch(this.engine.EVENT.CONVERSATION_LIST_UPDATED,e.data)}onTotalMessageCountUpdated(e){this.dispatch(this.engine.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,e.data)}onProfileUpdated(e){this.dispatch(this.engine.EVENT.PROFILE_UPDATED,e.data)}onBlacklistUpdated(e){this.dispatch(this.engine.EVENT.BLACKLIST_UPDATED,e.data)}onUserStatusUpdated(e){this.dispatch(this.engine.EVENT.USER_STATUS_UPDATED,e.data)}onGroupListUpdated(e){this.dispatch(this.engine.EVENT.GROUP_LIST_UPDATED,e.data)}onGroupAttributesUpdated(e){this.dispatch(this.engine.EVENT.GROUP_ATTRIBUTES_UPDATED,e.data)}onGroupCounterUpdated(e){this.dispatch(this.engine.EVENT.GROUP_COUNTER_UPDATED,e.data)}onFriendListUpdated(e){this.dispatch(this.engine.EVENT.FRIEND_LIST_UPDATED,e.data)}onFriendApplicationListUpdated(e){this.dispatch(this.engine.EVENT.FRIEND_APPLICATION_LIST_UPDATED,e.data)}};var eu,tu,nu,ou,au,iu,ru,su,lu;!function(e){e.TUIStore="TUIStore",e.TUITranslate="TUITranslate",e.TUIConversation="TUIConversation",e.TUIChat="TUIChat",e.TUIGroup="TUIGroup",e.TUIUser="TUIUser",e.TUIFriend="TUIFriend",e.TUIReport="TUIReport"}(eu||(eu={})),function(e){e.APP="application",e.CONV="conversation",e.CHAT="chat",e.GRP="group",e.USER="user",e.FRIEND="friend",e.SEARCH="search",e.CUSTOM="custom"}(tu||(tu={})),function(e){e[e.UNSUB_USER=-1]="UNSUB_USER"}(nu||(nu={})),function(e){e.BUSINESS_ID="user_typing_status",e[e.STATUS_START=1]="STATUS_START",e[e.STATUS_END=0]="STATUS_END",e[e.VERSION=1]="VERSION",e[e.ACTION_START_ID=14]="ACTION_START_ID",e[e.ACTION_END_ID=0]="ACTION_END_ID",e.ACTION_START="EIMAMSG_InputStatus_Ing",e.ACTION_END="EIMAMSG_InputStatus_End",e[e.NEED_TYPING=1]="NEED_TYPING"}(ou||(ou={})),function(e){e.ADD="add",e.REMOVE="remove"}(au||(au={})),function(e){e[e.MSG_MODIFY_CONFLICT=2480]="MSG_MODIFY_CONFLICT",e[e.MSG_MODIFY_DISABLED_IN_AVCHATROOM=2481]="MSG_MODIFY_DISABLED_IN_AVCHATROOM",e[e.MODIFY_MESSAGE_NOT_EXIST=20026]="MODIFY_MESSAGE_NOT_EXIST"}(iu||(iu={})),function(e){e[e.NOT_INIT=-1e5]="NOT_INIT",e[e.INVALID_CONV_ID=-100001]="INVALID_CONV_ID",e[e.CONV_ID_SAME=-100002]="CONV_ID_SAME",e[e.CONV_NOT_EXIST=-100003]="CONV_NOT_EXIST",e[e.GET_MSG_LIST_ERROR=-100004]="GET_MSG_LIST_ERROR",e[e.MISMATCH_TYPE_AND_PAYLOAD=-100005]="MISMATCH_TYPE_AND_PAYLOAD"}(ru||(ru={})),function(e){e.MSG_MODIFY_CONFLICT="MODIFY_MESSAGE_ERROR,修改消息发生冲突, data.message 是最新的消息",e.MSG_MODIFY_DISABLED_IN_AVCHATROOM="MODIFY_MESSAGE_ERROR,不支持修改直播群消息.",e.MODIFY_MESSAGE_NOT_EXIST="MODIFY_MESSAGE_ERROR,消息不存在."}(su||(su={})),function(e){e.NOT_INIT="TUIChatEngine 初始化未完成，请确认 TUIChatEngine.login 接口调用是否正常。",e.INVALID_CONV_ID="会话 ID 无效",e.CONV_ID_SAME="您切换的是同一个会话 ID",e.CONV_NOT_EXIST="会话不存在",e.GET_MSG_LIST_ERROR="Chat SDK is not ready.",e.MISMATCH_TYPE_AND_PAYLOAD="type 与 payload 不匹配."}(lu||(lu={}));const cu={logout:1,destroy:1},uu=function(e){return void 0===e},du=function(e){return e.startsWith("_")},pu=function(e){return/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e)},hu=function(e){return e&&function(e){if("string"==typeof e)try{return!!JSON.parse(e)}catch(t){return!1}return!1}(e)?JSON.parse(e):e},fu=function(e){let t="";return t=e>=1048576?`${(e/1048576).toFixed(2)} Mb`:e>=1024?`${(e/1024).toFixed(2)} Kb`:`${e.toFixed(2)}B`,t},gu={"[TUIEmoji_Expect]":"emoji_0@2x.png","[TUIEmoji_Blink]":"emoji_1@2x.png","[TUIEmoji_Guffaw]":"emoji_2@2x.png","[TUIEmoji_KindSmile]":"emoji_3@2x.png","[TUIEmoji_Haha]":"emoji_4@2x.png","[TUIEmoji_Cheerful]":"emoji_5@2x.png","[TUIEmoji_Smile]":"emoji_6@2x.png","[TUIEmoji_Sorrow]":"emoji_7@2x.png","[TUIEmoji_Speechless]":"emoji_8@2x.png","[TUIEmoji_Amazed]":"emoji_9@2x.png","[TUIEmoji_Complacent]":"emoji_10@2x.png","[TUIEmoji_Lustful]":"emoji_11@2x.png","[TUIEmoji_Stareyes]":"emoji_12@2x.png","[TUIEmoji_Giggle]":"emoji_13@2x.png","[TUIEmoji_Daemon]":"emoji_14@2x.png","[TUIEmoji_Rage]":"emoji_15@2x.png","[TUIEmoji_Yawn]":"emoji_16@2x.png","[TUIEmoji_TearsLaugh]":"emoji_17@2x.png","[TUIEmoji_Silly]":"emoji_18@2x.png","[TUIEmoji_Wail]":"emoji_19@2x.png","[TUIEmoji_Kiss]":"emoji_20@2x.png","[TUIEmoji_Trapped]":"emoji_21@2x.png","[TUIEmoji_Fear]":"emoji_22@2x.png","[TUIEmoji_BareTeeth]":"emoji_23@2x.png","[TUIEmoji_FlareUp]":"emoji_24@2x.png","[TUIEmoji_Tact]":"emoji_25@2x.png","[TUIEmoji_Shit]":"emoji_26@2x.png","[TUIEmoji_ShutUp]":"emoji_27@2x.png","[TUIEmoji_Sigh]":"emoji_28@2x.png","[TUIEmoji_Hehe]":"emoji_29@2x.png","[TUIEmoji_Silent]":"emoji_30@2x.png","[TUIEmoji_Skull]":"emoji_31@2x.png","[TUIEmoji_Mask]":"emoji_32@2x.png","[TUIEmoji_Beer]":"emoji_33@2x.png","[TUIEmoji_Cake]":"emoji_34@2x.png","[TUIEmoji_RedPacket]":"emoji_35@2x.png","[TUIEmoji_Bombs]":"emoji_36@2x.png","[TUIEmoji_Ai]":"emoji_37@2x.png","[TUIEmoji_Celebrate]":"emoji_38@2x.png","[TUIEmoji_Bless]":"emoji_39@2x.png","[TUIEmoji_Flower]":"emoji_40@2x.png","[TUIEmoji_Watermelon]":"emoji_41@2x.png","[TUIEmoji_Cow]":"emoji_42@2x.png","[TUIEmoji_Fool]":"emoji_43@2x.png","[TUIEmoji_Surprised]":"emoji_44@2x.png","[TUIEmoji_Askance]":"emoji_45@2x.png","[TUIEmoji_Monster]":"emoji_46@2x.png","[TUIEmoji_Pig]":"emoji_47@2x.png","[TUIEmoji_Coffee]":"emoji_48@2x.png","[TUIEmoji_Ok]":"emoji_49@2x.png","[TUIEmoji_Heart]":"emoji_50@2x.png","[TUIEmoji_Sun]":"emoji_51@2x.png","[TUIEmoji_Moon]":"emoji_52@2x.png","[TUIEmoji_Star]":"emoji_53@2x.png","[TUIEmoji_Rich]":"emoji_54@2x.png","[TUIEmoji_Fortune]":"emoji_55@2x.png","[TUIEmoji_857]":"emoji_56@2x.png","[TUIEmoji_666]":"emoji_57@2x.png","[TUIEmoji_Prohibit]":"emoji_58@2x.png","[TUIEmoji_Convinced]":"emoji_59@2x.png","[TUIEmoji_Knife]":"emoji_60@2x.png","[TUIEmoji_Like]":"emoji_61@2x.png"},mu={"[TUIEmoji_Smile]":"[微笑]","[TUIEmoji_Expect]":"[期待]","[TUIEmoji_Blink]":"[眨眼]","[TUIEmoji_Guffaw]":"[大笑]","[TUIEmoji_KindSmile]":"[姨母笑]","[TUIEmoji_Haha]":"[哈哈哈]","[TUIEmoji_Cheerful]":"[愉快]","[TUIEmoji_Speechless]":"[无语]","[TUIEmoji_Amazed]":"[惊讶]","[TUIEmoji_Sorrow]":"[悲伤]","[TUIEmoji_Complacent]":"[得意]","[TUIEmoji_Silly]":"[傻了]","[TUIEmoji_Lustful]":"[色]","[TUIEmoji_Giggle]":"[憨笑]","[TUIEmoji_Kiss]":"[亲亲]","[TUIEmoji_Wail]":"[大哭]","[TUIEmoji_TearsLaugh]":"[哭笑]","[TUIEmoji_Trapped]":"[困]","[TUIEmoji_Mask]":"[口罩]","[TUIEmoji_Fear]":"[恐惧]","[TUIEmoji_BareTeeth]":"[龇牙]","[TUIEmoji_FlareUp]":"[发怒]","[TUIEmoji_Yawn]":"[打哈欠]","[TUIEmoji_Tact]":"[机智]","[TUIEmoji_Stareyes]":"[星星眼]","[TUIEmoji_ShutUp]":"[闭嘴]","[TUIEmoji_Sigh]":"[叹气]","[TUIEmoji_Hehe]":"[呵呵]","[TUIEmoji_Silent]":"[收声]","[TUIEmoji_Surprised]":"[惊喜]","[TUIEmoji_Askance]":"[白眼]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[便便]","[TUIEmoji_Monster]":"[怪兽]","[TUIEmoji_Daemon]":"[恶魔]","[TUIEmoji_Rage]":"[恶魔怒]","[TUIEmoji_Fool]":"[衰]","[TUIEmoji_Pig]":"[猪]","[TUIEmoji_Cow]":"[牛]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[骷髅]","[TUIEmoji_Bombs]":"[炸弹]","[TUIEmoji_Coffee]":"[咖啡]","[TUIEmoji_Cake]":"[蛋糕]","[TUIEmoji_Beer]":"[啤酒]","[TUIEmoji_Flower]":"[花]","[TUIEmoji_Watermelon]":"[瓜]","[TUIEmoji_Rich]":"[壕]","[TUIEmoji_Heart]":"[爱心]","[TUIEmoji_Moon]":"[月亮]","[TUIEmoji_Sun]":"[太阳]","[TUIEmoji_Star]":"[星星]","[TUIEmoji_RedPacket]":"[红包]","[TUIEmoji_Celebrate]":"[庆祝]","[TUIEmoji_Bless]":"[福]","[TUIEmoji_Fortune]":"[发]","[TUIEmoji_Convinced]":"[服]","[TUIEmoji_Prohibit]":"[禁]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[刀]","[TUIEmoji_Like]":"[赞]"},vu={enabledMessageReadReceipt:Math.pow(2,5),enabledEmojiPlugin:Math.pow(2,48),enabledOnlineStatus:Math.pow(2,7),enabledCustomerServicePlugin:Math.pow(2,40),enabledTranslationPlugin:Math.pow(2,38),enabledVoiceToText:Math.pow(2,39)},_u=["messageList","conversationList","newMessageList"],yu=["translateTextInfo","voiceToTextInfo"],Iu="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),Cu="undefined"!=typeof uni&&"undefined"==typeof window,ku=Iu||Cu,Eu="undefined"!=typeof uni,Tu=("undefined"!=typeof uni||"undefined"!=typeof window)&&!ku,Su=Iu?wx:Eu?uni:window,Mu=Tu&&window&&window.navigator&&window.navigator.userAgent||"",wu=/Android/i.test(Mu),bu=/(?:Windows Phone)/.test(Mu),Du=/(?:SymbianOS)/.test(Mu),Nu=/iPad/i.test(Mu)||/iPhone/i.test(Mu)||/iPod/i.test(Mu),Ru=wu||bu||Du||Nu,Lu=Tu&&!Ru;let Au=class e{constructor(){this.global=Su,this.isOfficial=!1}static getInstance(){return e.instance||(e.instance=new e),e.instance}initOfficial(e){this.isOfficial=e}getPlatform(){let e="";return Lu?e="pc":Ru?e="h5":Iu?e="wechat":Cu&&!Iu&&(e="app"),e}};let Ou=class e{constructor(){this.EVENT=qe.EVENT,this.TYPES=qe.TYPES,this.loginStatusPromise=new Map,this.userID="",this.isInited=!1}static getInstance(){return e.instance||(e.instance=new e),e.instance}mount(e,t){this[e]=t}login(e){const{chat:t,SDKAppID:n,userID:o}=e,a=1400187352===n||1400188366===n;return this.createChat(e),this.userID=o,Au.getInstance().initOfficial(a),this.TUIStore.update(tu.APP,"isOfficial",a),this.TUIStore.update(tu.APP,"SDKVersion",qe.VERSION),this.eventCenter=new Qc(this),this.eventCenter.removeEvents(),this.resetStore(),this.initService(),t&&t.isReady()?(this.TUIUser.getUserProfile(),this.checkCommercialAbility(),Promise.resolve({})):(this.registerPlugin(e),this.eventCenter.addEvent(this.EVENT.SDK_READY,(()=>{this.onSDKReady()})),this.eventCenter.addEvent(this.EVENT.SDK_NOT_READY,(()=>{this.onSDKNotReady()})),this.loginChat(e))}logout(){return this.userID="",this.isInited=!1,this.resetStore(),this.chat.logout()}isReady(){var e;return(null===(e=this.chat)||void 0===e?void 0:e.isReady())||!1}setLogLevel(e){this.chat&&this.chat.setLogLevel(e)}destroy(){return this.eventCenter.unbindIMEvents(),this.isInited=!1,this.resetStore(),this.chat.destroy()}getMyUserID(){return this.userID}resetStore(){this.TUIStore.reset(tu.CHAT),this.TUIStore.reset(tu.CONV),this.TUIStore.reset(tu.GRP),this.TUIStore.reset(tu.USER),this.TUIStore.reset(tu.SEARCH),this.TUIStore.reset(tu.FRIEND),this.TUIStore.reset(tu.CUSTOM)}initService(){this.TUIChat.init(),this.TUIConversation.init(),this.TUIUser.init(),this.initOptionalServices(),this.isInited=!0}initOptionalServices(){const e=qe.VERSION.split(".");e[0]>3||3===e[0]&&e[1]>=3&&e[2]>0?(!0===this.chat.callExperimentalAPI("canIUseModule",["group-module"])&&this.TUIGroup.init(),!0===this.chat.callExperimentalAPI("canIUseModule",["relationship-module"])&&this.TUIFriend.init()):(this.TUIGroup.init(),this.TUIFriend.init())}createChat(e){const{chat:t}=e,n=Jc(e,["chat"]);uu(t)?this.chat=qe.create(Object.assign(Object.assign({},n),{scene:"chat-uikit-engine"})):this.chat=t}loginChat(e){const{userID:t,userSig:n}=e;return new Promise(((e,o)=>{this.chat.login({userID:t,userSig:n}).then((t=>{this.checkCommercialAbility(),t.data.repeatLogin&&this.chat.isReady()&&e(t),this.loginStatusPromise.set("login",{resolve:e,reject:o,imResponse:t})})).catch((e=>{o(e)}))}))}registerPlugin(e){const{useUploadPlugin:t=!1,useProfanityFilterPlugin:n=!1,TIMPush:o,pushConfig:a,TUIOfflinePush:i,offlinePushConfig:r}=e;!0===t&&this.chat.registerPlugin({"tim-upload-plugin":Ye}),!0===n&&this.chat.registerPlugin({"tim-profanity-filter-plugin":Je}),!Cu||Iu||uu(o)||uu(a)||this.chat.registerPlugin({"tim-push":o,pushConfig:a}),!Cu||Iu||uu(i)||uu(r)||this.chat.registerPlugin({"tim-offline-push-plugin":i,offlinePushConfig:r})}onSDKReady(){if(this.loginStatusPromise.has("login")){const e=this.loginStatusPromise.get("login");e.resolve(e.imResponse),this.TUIUser.getUserProfile()}this.loginStatusPromise.delete("login")}onSDKNotReady(){this.loginStatusPromise.has("login")&&this.loginStatusPromise.get("login").reject(new Error("sdk not ready")),this.loginStatusPromise.delete("login"),this.resetStore()}checkCommercialAbility(){Object.keys(vu).forEach((e=>{const t=vu[e];this.chat.callExperimentalAPI("isCommercialAbilityEnabled",t).then((t=>{const{enabled:n=!1}=t.data;this.TUIStore.update(tu.APP,e,n)}))}))}},Pu=class{constructor(){this.defaultStore={enabledMessageReadReceipt:!1,enabledEmojiPlugin:!1,enabledOnlineStatus:!1,enabledCustomerServicePlugin:!1,enabledTranslationPlugin:!1,enabledVoiceToText:!1,enableTyping:!0,enableConversationDraft:!0,isOfficial:!1,SDKVersion:"3.0.0",tasks:{sendMessage:!1,revokeMessage:!1,modifyNickName:!1,groupChat:!1,muteGroup:!1,dismissGroup:!1,call:!1,searchCloudMessage:!1,customerService:!1,translateTextMessage:!1}},this.store={enabledEmojiPlugin:!1,enabledMessageReadReceipt:!1,enabledOnlineStatus:!1,enabledCustomerServicePlugin:!1,enabledTranslationPlugin:!1,enabledVoiceToText:!1,enableTyping:!0,enableConversationDraft:!0,isOfficial:!1,SDKVersion:"3.0.0",tasks:{sendMessage:!1,revokeMessage:!1,modifyNickName:!1,groupChat:!1,muteGroup:!1,dismissGroup:!1,call:!1,searchCloudMessage:!1,customerService:!1,translateTextMessage:!1}}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}},Uu=class{constructor(){this.defaultStore={userProfile:{},displayOnlineStatus:!1,displayMessageReadReceipt:!0,userStatusList:new Map,kickedOut:"",netStateChange:"",userBlacklist:[],targetLanguage:"zh"},this.store={userProfile:{},displayOnlineStatus:!1,displayMessageReadReceipt:!0,userStatusList:new Map,kickedOut:"",netStateChange:"",userBlacklist:[],targetLanguage:"zh"}}update(e,t){"userStatusList"===e?this.updateUserStatusList(t):this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateUserStatusList(e){0!==e.length?e.forEach((e=>{const{userID:t,statusType:n=0,customStatus:o=""}=e;n===nu.UNSUB_USER?this.store.userStatusList.delete(t):this.store.userStatusList.set(t,{statusType:n,customStatus:o})})):this.store.userStatusList.clear()}},xu=class{getEngine(){return Ou.getInstance()}};const Vu=function(e){if(null==e)return!0;if("boolean"==typeof e)return!1;if("number"==typeof e)return 0===e;if("string"==typeof e)return 0===e.length;if("function"==typeof e)return 0===e.length;if(Array.isArray(e))return 0===e.length;if(e instanceof Error)return""===e.message;if(function(e){if("object"!=typeof e||null===e)return!1;const t=Object.getPrototypeOf(e);if(null===t)return!0;let n=t;for(;null!==Object.getPrototypeOf(n);)n=Object.getPrototypeOf(n);return t===n}(e)){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}return!1},Bu=["[图片]","[语音]","[视频]","[文件]","[位置]","[地理位置]","[动画表情]","[自定义消息]","[群提示消息]","[聊天记录]"];let Gu=class extends xu{constructor(e){super(),this.initProxy(e),this.isMuted=this.messageRemindType===this.getEngine().TYPES.MSG_REMIND_ACPT_NOT_NOTE||this.messageRemindType===this.getEngine().TYPES.MSG_REMIND_DISCARD,this.operationType=0,this._conversation=e}initProxy(e){Object.keys(e).forEach((t=>{du(t)||(this[t]=e[t])}))}updateProperties(e){Object.keys(e).forEach((t=>{du(t)||(this[t]=e[t])}))}updateOperationType(e){this.operationType=e}getConversation(){return this._conversation}deleteConversation(){return this.getEngine().TUIConversation.deleteConversation(this.conversationID)}pinConversation(){return this.getEngine().TUIConversation.pinConversation({conversationID:this.conversationID,isPinned:!this.isPinned})}muteConversation(){const e=this.getEngine(),t={messageRemindType:!0===this.isMuted?e.TYPES.MSG_REMIND_ACPT_AND_NOTE:e.TYPES.MSG_REMIND_ACPT_NOT_NOTE};if(this.type===e.TYPES.CONV_C2C){const n=this.conversationID.replace(e.TYPES.CONV_C2C,"");t.userIDList=[n]}else if(this.type===e.TYPES.CONV_GROUP){const n=this.conversationID.replace(e.TYPES.CONV_GROUP,"");t.groupID=n}return e.TUIConversation.muteConversation(t)}getAvatar(){var e,t,n,o,a,i;const r=this.getEngine();let s="";switch(this.type){case r.TYPES.CONV_C2C:s=pu(null===(e=this.userProfile)||void 0===e?void 0:e.avatar)?null===(t=this.userProfile)||void 0===t?void 0:t.avatar:"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_16.png";break;case r.TYPES.CONV_GROUP:s=pu(null===(n=this.groupProfile)||void 0===n?void 0:n.avatar)?null===(o=this.groupProfile)||void 0===o?void 0:o.avatar:"https://web.sdk.qcloud.com/im/demo/TUIkit/web/img/constomer.png";break;case r.TYPES.CONV_SYSTEM:s=pu(null===(a=this.groupProfile)||void 0===a?void 0:a.avatar)?null===(i=this.groupProfile)||void 0===i?void 0:i.avatar:"https://web.sdk.qcloud.com/component/TUIKit/assets/group_avatar.png"}return s}getShowName(){var e,t,n,o;const a=this.getEngine();let i="";switch(this.type){case a.TYPES.CONV_C2C:i=this.remark||(null===(e=this.userProfile)||void 0===e?void 0:e.nick)||(null===(t=this.userProfile)||void 0===t?void 0:t.userID)||"";break;case a.TYPES.CONV_GROUP:i=(null===(n=this.groupProfile)||void 0===n?void 0:n.name)||(null===(o=this.groupProfile)||void 0===o?void 0:o.groupID)||"";break;case a.TYPES.CONV_SYSTEM:i=a.TUITranslate.t("系统通知")}return i}getGroupAtInfo(){const e=this.getEngine(),t=e.TUITranslate.t.bind(e.TUITranslate),n=[`[${t("TUIConversation.有人@我")}]`,`[${t("TUIConversation.@所有人")}]`,`[${t("TUIConversation.@所有人")}][${t("TUIConversation.有人@我")}]`];let o="";for(let a=0;a<this.groupAtInfoList.length;a++)this.groupAtInfoList[a].atTypeArray[0]&&this.unreadCount>0&&(o=n[this.groupAtInfoList[a].atTypeArray[0]-1]);return o}getLastMessage(e){return"time"===e?this.getLastMessageTime():"text"===e?this.getLastMessageText():null}getLastMessageTime(){var e;const t=this.getEngine();let n="";return(null===(e=this.lastMessage)||void 0===e?void 0:e.lastTime)>0&&(n=function(e,t){const n=36e5,o=24*n,a=7*o,i=(new Date).getTime()-e;let r="";if(i<0)return r;const s=i/6e4,l=i/n,c=i/o,u=i/a;if(u>=1&&u<=4)r=` ${parseInt(`${u}`,10)} ${t("time.周")}${t("time.前")}`;else if(c>=1&&c<=6)r=` ${parseInt(`${c}`,10)} ${t("time.天")}${t("time.前")}`;else if(l>=1&&l<=23)r=` ${parseInt(`${l}`,10)} ${t("time.小时")}${t("time.前")}`;else if(s>=1&&s<=59)r=` ${parseInt(`${s}`,10)} ${t("time.分钟")}${t("time.前")}`;else if(i>=0&&i<=6e4)r=`${t("time.刚刚")}`;else{const t=new Date;t.setTime(e),r=`${t.getFullYear()}-${t.getMonth()+1<10?`0${t.getMonth()+1}`:t.getMonth()+1}-${t.getDate()<10?`0${t.getDate()}`:t.getDate()}`}return r}(1e3*this.lastMessage.lastTime,t.TUITranslate.t.bind(t.TUITranslate))),n}getLastMessageText(){var e;if(this.draftText)return hu(this.draftText).abstract;const t=this.getEngine(),n=t.TUITranslate.t.bind(t.TUITranslate);if(4===this.operationType)return n("TUIConversation.您已被群管理员移出群聊");if(5===this.operationType)return n("TUIConversation.该群聊已被解散");if(8===this.operationType)return n("TUIConversation.您已退出该群聊");const o=this._conversation,{lastMessage:a}=this;let i="",r="";const s=o.unreadCount>0&&o.messageRemindType===t.TYPES.MSG_REMIND_ACPT_NOT_NOTE?`[${o.unreadCount>99?"99+":o.unreadCount}${n("TUIConversation.条")}]`:"";if(o.type===t.TYPES.CONV_GROUP)if(a.fromAccount===t.getMyUserID())i=n("TUIConversation.我");else{const e=a.fromAccount;i=t.TUIFriend.getFriendRemark([e])[e]||a.nameCard||a.nick||e}if(a.type===t.TYPES.MSG_TEXT)r=this.decodeTextMessage(a.payload.text);else if(a.type===t.TYPES.MSG_CUSTOM){const o=hu(null===(e=null==a?void 0:a.payload)||void 0===e?void 0:e.data);if(1===(null==o?void 0:o.businessID))return r=t.TUIChat.messageHandler.handleCallKitSignaling(a),r;r=Bu.includes(a.messageForShow)?n(`TUIChat.${a.messageForShow}`):a.messageForShow}else r=Bu.includes(a.messageForShow)?n(`TUIChat.${a.messageForShow}`):a.messageForShow;return a.isRevoked&&(r=n("TUIChat.撤回了一条消息")),o.type===t.TYPES.CONV_GROUP&&a.type===t.TYPES.MSG_GRP_TIP?r:`${s}${i?`${i}:`:""}${r}`}decodeTextMessage(e){if(Vu(e))return e;const t=/(\[.+?\])/g;let n=e;if(t.test(e)){const o=this.getEngine(),a=o.TUITranslate.t.bind(o.TUITranslate);n=e.replace(t,(e=>{const t=a(`Emoji.${e}`);return Iu||!t||t.startsWith("Emoji.")?mu[e]||e:t}))}return n}},Fu=class{constructor(){this.defaultStore={currentConversationID:"",totalUnreadCount:0,conversationList:[],currentConversation:null,operationTypeMap:new Map},this.store={currentConversationID:"",totalUnreadCount:0,conversationList:[],currentConversation:null,operationTypeMap:new Map}}update(e,t){switch(e){case"conversationList":this.updateConversationList(t);break;case"operationTypeMap":this.updateOperationTypeMap(t);break;default:this.store[e]=t}}getData(e){return this.store[e]}getModel(e){return this.store.conversationList.find((t=>t.conversationID===e))}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateConversationList(e){const t=[];e.forEach((e=>{let n=e;e instanceof Gu?n.updateProperties(e):n=new Gu(e);const o=this.getOperationType(e);n.updateOperationType(o),t.push(n)})),this.store.conversationList=t}updateOperationTypeMap(e){const{conversationID:t,operationType:n=0}=e;this.store.operationTypeMap.set(t,n)}getOperationType(e){const{conversationID:t}=e;return this.store.operationTypeMap.get(t)||0}},zu=class extends xu{constructor(e){super(),this.messageHandlers={[this.getEngine().TYPES.MSG_TEXT]:e=>this.getEngine().TUIChat.messageHandler.handleTextMessage(e),[this.getEngine().TYPES.MSG_FACE]:e=>this.getEngine().TUIChat.messageHandler.handleFaceMessage(e),[this.getEngine().TYPES.MSG_LOCATION]:e=>this.getEngine().TUIChat.messageHandler.handleLocationMessage(e),[this.getEngine().TYPES.MSG_IMAGE]:e=>this.getEngine().TUIChat.messageHandler.handleImageMessage(e),[this.getEngine().TYPES.MSG_AUDIO]:e=>this.getEngine().TUIChat.messageHandler.handleAudioMessage(e),[this.getEngine().TYPES.MSG_VIDEO]:e=>this.getEngine().TUIChat.messageHandler.handleVideoMessage(e),[this.getEngine().TYPES.MSG_FILE]:e=>this.getEngine().TUIChat.messageHandler.handleFileMessage(e),[this.getEngine().TYPES.MSG_CUSTOM]:e=>this.getEngine().TUIChat.messageHandler.handleCustomMessage(e),[this.getEngine().TYPES.MSG_MERGER]:e=>this.getEngine().TUIChat.messageHandler.handleMergeMessage(e),[this.getEngine().TYPES.MSG_GRP_TIP]:e=>this.getEngine().TUIChat.messageHandler.handleGroupTipsMessage(e)},this._message=e,this._signalingInfo=void 0,this.progress=0,this.reactionList=[],this.initProperties(e)}initProperties(e){Object.keys(e).forEach((t=>{du(t)||(this[t]=e[t])}))}updateProperties(e){this._message=e,Object.keys(e).forEach((t=>{du(t)||(this[t]=e[t])}))}getMessage(){return this._message}modifyMessage(e){return e.type&&this._message.type!==e.type&&!e.payload?Promise.reject({code:ru.MISMATCH_TYPE_AND_PAYLOAD,message:lu.MISMATCH_TYPE_AND_PAYLOAD}):(this._message.type=e.type||this._message.type,this._message.payload=e.payload||this._message.payload,this._message.cloudCustomData=e.cloudCustomData||this._message.cloudCustomData,this.getEngine().TUIChat.modifyMessage(this._message))}revokeMessage(){return this.getEngine().TUIChat.revokeMessage(this._message)}resendMessage(){return this.getEngine().TUIChat.resendMessage(this._message)}deleteMessage(){return this.getEngine().TUIChat.deleteMessage([this._message])}quoteMessage(){return this.getEngine().TUIChat.quoteMessage(this._message)}replyMessage(){return this.getEngine().TUIChat.replyMessage(this._message)}setMessageExtensions(e){return this.getEngine().TUIChat.setMessageExtensions(this._message,e)}getMessageExtensions(){return this.getEngine().TUIChat.getMessageExtensions(this._message)}deleteMessageExtensions(e){return this.getEngine().TUIChat.deleteMessageExtensions(this._message,e)}getSignalingInfo(){return this.type!==this.getEngine().TYPES.MSG_CUSTOM?null:uu(this._signalingInfo)?(this._signalingInfo=this.getEngine().chat.getSignalingInfo(this._message),this._signalingInfo):this._signalingInfo}getMessageContent(){const e=this.messageHandlers[this.type];if(uu(e))return{};if(this.type===this.getEngine().TYPES.MSG_GRP_TIP)return e(this._message);const t=this.getEngine().TUIFriend.getFriendRemark([this.from]);return Object.assign(Object.assign({},e(this._message)),{showName:t[this.from]||this.nameCard||this.nick||this.from})}sendForwardMessage(e){return this.getEngine().TUIChat.sendForwardMessage(e,[this._message])}},Hu=class{constructor(){this.defaultStore={messageList:[],isCompleted:!1,nextReqMessageID:"",quoteMessage:{},newMessageList:[],typingStatus:!1,messageSource:void 0,translateTextInfo:void 0,voiceToTextInfo:void 0,userInfo:{}},this.store={messageList:[],isCompleted:!1,nextReqMessageID:"",quoteMessage:{},newMessageList:[],typingStatus:!1,messageSource:void 0,translateTextInfo:void 0,voiceToTextInfo:void 0,userInfo:{}}}update(e,t){switch(e){case"messageList":this.updateMessageList(t);break;case"translateTextInfo":this.updateTranslateTextInfo(t);break;case"voiceToTextInfo":this.updateVoiceToTextInfo(t);break;default:this.store[e]=t}}getData(e){return this.store[e]}getModel(e){return this.store.messageList.find((t=>t.ID===e))}reset(e=[]){const t=e.filter((e=>!yu.includes(e)));this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),null==t?void 0:t.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateMessageList(e){const t=[];e.forEach((e=>{let n=e;e instanceof zu||(n=this.getModel(e.ID),n?n.updateProperties(e):n=new zu(e)),t.push(n)})),this.store.messageList=t}updateTranslateTextInfo(e){this.updateBykey("translateTextInfo",e)}updateVoiceToTextInfo(e){this.updateBykey("voiceToTextInfo",e)}updateBykey(e,t){const{conversationID:n,messageID:o,visible:a=!1}=t;this.store[e]||(this.store[e]=new Map),this.store[e].has(n)||this.store[e].set(n,[]);const i=this.store[e].get(n)||[];let r=!0;for(let s=0;s<i.length;s++)if(i[s].messageID===o){i[s].visible=a,r=!1;break}r&&i.push({messageID:o,visible:a}),this.store[e].set(n,i)}},ju=class{constructor(e){this.groupAttributes={},this.groupCounters={},this.initProxy(e)}initProxy(e){Object.keys(e).forEach((t=>{du(t)||(this[t]=e[t])}))}},qu=class{constructor(){this.defaultStore={currentGroupID:"",currentGroup:{},currentGroupAttributes:{},currentGroupCounters:{},currentGroupMemberList:[],groupList:[],groupSystemNoticeList:[],isCompleted:!1,offset:0},this.store={currentGroupID:"",currentGroup:void 0,currentGroupAttributes:{},currentGroupCounters:{},currentGroupMemberList:[],groupList:[],groupSystemNoticeList:[],isCompleted:!1,offset:0}}update(e,t){switch(e){case"groupList":this.updateGroupList(t);break;case"currentGroup":this.store.currentGroup=t instanceof ju?t:new ju(t);break;default:this.store[e]=t}}getData(e){if("groupSystemNoticeList"===e){const e=[...this.store.groupSystemNoticeList];return this.store.groupSystemNoticeList.length=0,e}return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}updateGroupList(e){this.store.groupList=e.map((e=>e instanceof ju?e:new ju(e)))}},Ku=class{constructor(){this.store={}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){0===e.length&&(this.store={}),this.store=Object.assign(Object.assign({},this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:void 0})),{}))}},Yu=class{constructor(){this.defaultStore={friendList:[],friendApplicationList:[],friendApplicationUnreadCount:0},this.store={friendList:[],friendApplicationList:[],friendApplicationUnreadCount:0}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}},$u=class{constructor(){this.defaultStore={currentSearchInputValue:{value:"",searchType:"global"},currentSearchMessageType:{value:{key:"",label:"",value:""},searchType:"global"},currentSearchMessageTime:{value:{key:"",label:"",value:{timePosition:0,timePeriod:0}},searchType:"global"},currentSearchingStatus:{isSearching:!1,searchType:"global"},isShowInConversationSearch:!1},this.store={currentSearchInputValue:{value:"",searchType:"global"},currentSearchMessageType:{value:{key:"",label:"",value:""},searchType:"global"},currentSearchMessageTime:{value:{key:"",label:"",value:{timePosition:0,timePeriod:0}},searchType:"global"},currentSearchingStatus:{isSearching:!1,searchType:"global"},isShowInConversationSearch:!1}}update(e,t){this.store[e]=t}getData(e){return this.store[e]}reset(e=[]){this.store=Object.assign(Object.assign(Object.assign({},this.defaultStore),this.store),null==e?void 0:e.reduce(((e,t)=>Object.assign(Object.assign({},e),{[t]:this.defaultStore[t]})),{}))}};function Wu(e){return(Wu="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Zu(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Ju(e){var t=function(e,t){if("object"!=Wu(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var o=n.call(e,t);if("object"!=Wu(o))return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==Wu(t)?t:t+""}function Xu(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,Ju(o.key),o)}}function Qu(e,t,n){return t&&Xu(e.prototype,t),n&&Xu(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ed(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function td(e,t){return(td=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function nd(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&td(e,t)}function od(e,t){if(t&&("object"==Wu(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return ed(e)}function ad(e){return(ad=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function id(e,t,n){return(t=Ju(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function rd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=Array(t);n<t;n++)o[n]=e[n];return o}function sd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ld(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sd(Object(n),!0).forEach((function(t){id(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var cd={type:"logger",log:function(e){this.output("log",e)},warn:function(e){this.output("warn",e)},error:function(e){this.output("error",e)},output:function(e,t){console&&console[e]}},ud=new(function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Zu(this,e),this.init(t,n)}return Qu(e,[{key:"init",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||cd,this.options=t,this.debug=t.debug}},{key:"setDebug",value:function(e){this.debug=e}},{key:"log",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"log","",!0)}},{key:"warn",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","",!0)}},{key:"error",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"error","")}},{key:"deprecate",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}},{key:"forward",value:function(e,t,n,o){return o&&!this.debug?null:("string"==typeof e[0]&&(e[0]="".concat(n).concat(this.prefix," ").concat(e[0])),this.logger[t](e))}},{key:"create",value:function(t){return new e(this.logger,ld(ld({},{prefix:"".concat(this.prefix,":").concat(t,":")}),this.options))}},{key:"clone",value:function(t){return(t=t||this.options).prefix=t.prefix||this.prefix,new e(this.logger,t)}}]),e}()),dd=function(){function e(){Zu(this,e),this.observers={}}return Qu(e,[{key:"on",value:function(e,t){var n=this;return e.split(" ").forEach((function(e){n.observers[e]=n.observers[e]||[],n.observers[e].push(t)})),this}},{key:"off",value:function(e,t){this.observers[e]&&(t?this.observers[e]=this.observers[e].filter((function(e){return e!==t})):delete this.observers[e])}},{key:"emit",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];this.observers[e]&&[].concat(this.observers[e]).forEach((function(e){e.apply(void 0,n)})),this.observers["*"]&&[].concat(this.observers["*"]).forEach((function(t){t.apply(t,[e].concat(n))}))}}]),e}();function pd(){var e,t,n=new Promise((function(n,o){e=n,t=o}));return n.resolve=e,n.reject=t,n}function hd(e){return null==e?"":""+e}function fd(e,t,n){function o(e){return e&&e.indexOf("###")>-1?e.replace(/###/g,"."):e}function a(){return!e||"string"==typeof e}for(var i="string"!=typeof t?[].concat(t):t.split(".");i.length>1;){if(a())return{};var r=o(i.shift());!e[r]&&n&&(e[r]=new n),e=Object.prototype.hasOwnProperty.call(e,r)?e[r]:{}}return a()?{}:{obj:e,k:o(i.shift())}}function gd(e,t,n){var o=fd(e,t,Object);o.obj[o.k]=n}function md(e,t){var n=fd(e,t),o=n.obj,a=n.k;if(o)return o[a]}function vd(e,t,n){for(var o in t)"__proto__"!==o&&"constructor"!==o&&(o in e?"string"==typeof e[o]||e[o]instanceof String||"string"==typeof t[o]||t[o]instanceof String?n&&(e[o]=t[o]):vd(e[o],t[o],n):e[o]=t[o]);return e}function _d(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var yd={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function Id(e){return"string"==typeof e?e.replace(/[&<>"'\/]/g,(function(e){return yd[e]})):e}var Cd="undefined"!=typeof window&&window.navigator&&void 0===window.navigator.userAgentData&&window.navigator.userAgent&&window.navigator.userAgent.indexOf("MSIE")>-1,kd=[" ",",","?","!",";"];function Ed(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(e){if(e[t])return e[t];for(var o=t.split(n),a=e,i=0;i<o.length;++i){if(!a)return;if("string"==typeof a[o[i]]&&i+1<o.length)return;if(void 0===a[o[i]]){for(var r=2,s=o.slice(i,i+r).join(n),l=a[s];void 0===l&&o.length>i+r;)r++,l=a[s=o.slice(i,i+r).join(n)];if(void 0===l)return;if(null===l)return null;if(t.endsWith(s)){if("string"==typeof l)return l;if(s&&"string"==typeof l[s])return l[s]}var c=o.slice(i+r).join(n);return c?Ed(l,c,n):void 0}a=a[o[i]]}return a}}function Td(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Sd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Td(Object(n),!0).forEach((function(t){id(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Td(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Md=function(){nd(t,dd);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ad(e);if(t){var a=ad(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return od(this,n)}}(t);function t(n){var o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};return Zu(this,t),o=e.call(this),Cd&&dd.call(ed(o)),o.data=n||{},o.options=a,void 0===o.options.keySeparator&&(o.options.keySeparator="."),void 0===o.options.ignoreJSONStructure&&(o.options.ignoreJSONStructure=!0),o}return Qu(t,[{key:"addNamespaces",value:function(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}},{key:"removeNamespaces",value:function(e){var t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}},{key:"getResource",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},a=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator,i=void 0!==o.ignoreJSONStructure?o.ignoreJSONStructure:this.options.ignoreJSONStructure,r=[e,t];n&&"string"!=typeof n&&(r=r.concat(n)),n&&"string"==typeof n&&(r=r.concat(a?n.split(a):n)),e.indexOf(".")>-1&&(r=e.split("."));var s=md(this.data,r);return s||!i||"string"!=typeof n?s:Ed(this.data&&this.data[e]&&this.data[e][t],n,a)}},{key:"addResource",value:function(e,t,n,o){var a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1},i=void 0!==a.keySeparator?a.keySeparator:this.options.keySeparator,r=[e,t];n&&(r=r.concat(i?n.split(i):n)),e.indexOf(".")>-1&&(o=t,t=(r=e.split("."))[1]),this.addNamespaces(t),gd(this.data,r,o),a.silent||this.emit("added",e,t,n,o)}},{key:"addResources",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(var a in n)"string"!=typeof n[a]&&"[object Array]"!==Object.prototype.toString.apply(n[a])||this.addResource(e,t,a,n[a],{silent:!0});o.silent||this.emit("added",e,t,n)}},{key:"addResourceBundle",value:function(e,t,n,o,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1},r=[e,t];e.indexOf(".")>-1&&(o=n,n=t,t=(r=e.split("."))[1]),this.addNamespaces(t);var s=md(this.data,r)||{};o?vd(s,n,a):s=Sd(Sd({},s),n),gd(this.data,r,s),i.silent||this.emit("added",e,t,n)}},{key:"removeResourceBundle",value:function(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}},{key:"hasResourceBundle",value:function(e,t){return void 0!==this.getResource(e,t)}},{key:"getResourceBundle",value:function(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?Sd(Sd({},{}),this.getResource(e,t)):this.getResource(e,t)}},{key:"getDataByLanguage",value:function(e){return this.data[e]}},{key:"hasLanguageSomeTranslations",value:function(e){var t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((function(e){return t[e]&&Object.keys(t[e]).length>0}))}},{key:"toJSON",value:function(){return this.data}}]),t}(),wd={processors:{},addPostProcessor:function(e){this.processors[e.name]=e},handle:function(e,t,n,o,a){var i=this;return e.forEach((function(e){i.processors[e]&&(t=i.processors[e].process(t,n,o,a))})),t}};function bd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Dd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bd(Object(n),!0).forEach((function(t){id(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Nd={},Rd=function(){nd(t,dd);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ad(e);if(t){var a=ad(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return od(this,n)}}(t);function t(n){var o,a,i,r,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return Zu(this,t),o=e.call(this),Cd&&dd.call(ed(o)),a=["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],i=n,r=ed(o),a.forEach((function(e){i[e]&&(r[e]=i[e])})),o.options=s,void 0===o.options.keySeparator&&(o.options.keySeparator="."),o.logger=ud.create("translator"),o}return Qu(t,[{key:"changeLanguage",value:function(e){e&&(this.language=e)}},{key:"exists",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;var n=this.resolve(e,t);return n&&void 0!==n.res}},{key:"extractFromKey",value:function(e,t){var n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");var o=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,a=t.ns||this.options.defaultNS||[],i=n&&e.indexOf(n)>-1,r=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||function(e,t,n){t=t||"",n=n||"";var o=kd.filter((function(e){return t.indexOf(e)<0&&n.indexOf(e)<0}));if(0===o.length)return!0;var a=new RegExp("(".concat(o.map((function(e){return"?"===e?"\\?":e})).join("|"),")")),i=!a.test(e);if(!i){var r=e.indexOf(n);r>0&&!a.test(e.substring(0,r))&&(i=!0)}return i}(e,n,o));if(i&&!r){var s=e.match(this.interpolator.nestingRegexp);if(s&&s.length>0)return{key:e,namespaces:a};var l=e.split(n);(n!==o||n===o&&this.options.ns.indexOf(l[0])>-1)&&(a=l.shift()),e=l.join(o)}return"string"==typeof a&&(a=[a]),{key:e,namespaces:a}}},{key:"translate",value:function(e,n,o){var a=this;if("object"!==Wu(n)&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),"object"===Wu(n)&&(n=Dd({},n)),n||(n={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);var i=void 0!==n.returnDetails?n.returnDetails:this.options.returnDetails,r=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,s=this.extractFromKey(e[e.length-1],n),l=s.key,c=s.namespaces,u=c[c.length-1],d=n.lng||this.language,p=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(d&&"cimode"===d.toLowerCase()){if(p){var h=n.nsSeparator||this.options.nsSeparator;return i?{res:"".concat(u).concat(h).concat(l),usedKey:l,exactUsedKey:l,usedLng:d,usedNS:u}:"".concat(u).concat(h).concat(l)}return i?{res:l,usedKey:l,exactUsedKey:l,usedLng:d,usedNS:u}:l}var f=this.resolve(e,n),g=f&&f.res,m=f&&f.usedKey||l,v=f&&f.exactUsedKey||l,_=Object.prototype.toString.apply(g),y=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,I=!this.i18nFormat||this.i18nFormat.handleAsObject;if(I&&g&&"string"!=typeof g&&"boolean"!=typeof g&&"number"!=typeof g&&["[object Number]","[object Function]","[object RegExp]"].indexOf(_)<0&&("string"!=typeof y||"[object Array]"!==_)){if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");var C=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,g,Dd(Dd({},n),{},{ns:c})):"key '".concat(l," (").concat(this.language,")' returned an object instead of string.");return i?(f.res=C,f):C}if(r){var k="[object Array]"===_,E=k?[]:{},T=k?v:m;for(var S in g)if(Object.prototype.hasOwnProperty.call(g,S)){var M="".concat(T).concat(r).concat(S);E[S]=this.translate(M,Dd(Dd({},n),{joinArrays:!1,ns:c})),E[S]===M&&(E[S]=g[S])}g=E}}else if(I&&"string"==typeof y&&"[object Array]"===_)(g=g.join(y))&&(g=this.extendTranslation(g,e,n,o));else{var w=!1,b=!1,D=void 0!==n.count&&"string"!=typeof n.count,N=t.hasDefaultValue(n),R=D?this.pluralResolver.getSuffix(d,n.count,n):"",L=n["defaultValue".concat(R)]||n.defaultValue;!this.isValidLookup(g)&&N&&(w=!0,g=L),this.isValidLookup(g)||(b=!0,g=l);var A=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&b?void 0:g,O=N&&L!==g&&this.options.updateMissing;if(b||w||O){if(this.logger.log(O?"updateKey":"missingKey",d,u,l,O?L:g),r){var P=this.resolve(l,Dd(Dd({},n),{},{keySeparator:!1}));P&&P.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}var U=[],x=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&x&&x[0])for(var V=0;V<x.length;V++)U.push(x[V]);else"all"===this.options.saveMissingTo?U=this.languageUtils.toResolveHierarchy(n.lng||this.language):U.push(n.lng||this.language);var B=function(e,t,o){var i=N&&o!==g?o:A;a.options.missingKeyHandler?a.options.missingKeyHandler(e,u,t,i,O,n):a.backendConnector&&a.backendConnector.saveMissing&&a.backendConnector.saveMissing(e,u,t,i,O,n),a.emit("missingKey",e,u,t,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&D?U.forEach((function(e){a.pluralResolver.getSuffixes(e,n).forEach((function(t){B([e],l+t,n["defaultValue".concat(t)]||L)}))})):B(U,l,L))}g=this.extendTranslation(g,e,n,f,o),b&&g===l&&this.options.appendNamespaceToMissingKey&&(g="".concat(u,":").concat(l)),(b||w)&&this.options.parseMissingKeyHandler&&(g="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?"".concat(u,":").concat(l):l,w?g:void 0):this.options.parseMissingKeyHandler(g))}return i?(f.res=g,f):g}},{key:"extendTranslation",value:function(e,t,n,o,a){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,Dd(Dd({},this.options.interpolation.defaultVariables),n),o.usedLng,o.usedNS,o.usedKey,{resolved:o});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(Dd(Dd({},n),{interpolation:Dd(Dd({},this.options.interpolation),n.interpolation)}));var r,s="string"==typeof e&&(n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);if(s){var l=e.match(this.interpolator.nestingRegexp);r=l&&l.length}var c=n.replace&&"string"!=typeof n.replace?n.replace:n;if(this.options.interpolation.defaultVariables&&(c=Dd(Dd({},this.options.interpolation.defaultVariables),c)),e=this.interpolator.interpolate(e,c,n.lng||this.language,n),s){var u=e.match(this.interpolator.nestingRegexp);r<(u&&u.length)&&(n.nest=!1)}!n.lng&&"v1"!==this.options.compatibilityAPI&&o&&o.res&&(n.lng=o.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,o=new Array(e),r=0;r<e;r++)o[r]=arguments[r];return a&&a[0]===o[0]&&!n.context?(i.logger.warn("It seems you are nesting recursively key: ".concat(o[0]," in key: ").concat(t[0])),null):i.translate.apply(i,o.concat([t]))}),n)),n.interpolation&&this.interpolator.reset()}var d=n.postProcess||this.options.postProcess,p="string"==typeof d?[d]:d;return null!=e&&p&&p.length&&!1!==n.applyPostProcessor&&(e=wd.handle(p,e,t,this.options&&this.options.postProcessPassResolved?Dd({i18nResolved:o},n):n,this)),e}},{key:"resolve",value:function(e){var t,n,o,a,i,r=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"string"==typeof e&&(e=[e]),e.forEach((function(e){if(!r.isValidLookup(t)){var l=r.extractFromKey(e,s),c=l.key;n=c;var u=l.namespaces;r.options.fallbackNS&&(u=u.concat(r.options.fallbackNS));var d=void 0!==s.count&&"string"!=typeof s.count,p=d&&!s.ordinal&&0===s.count&&r.pluralResolver.shouldUseIntlApi(),h=void 0!==s.context&&("string"==typeof s.context||"number"==typeof s.context)&&""!==s.context,f=s.lngs?s.lngs:r.languageUtils.toResolveHierarchy(s.lng||r.language,s.fallbackLng);u.forEach((function(e){r.isValidLookup(t)||(i=e,!Nd["".concat(f[0],"-").concat(e)]&&r.utils&&r.utils.hasLoadedNamespace&&!r.utils.hasLoadedNamespace(i)&&(Nd["".concat(f[0],"-").concat(e)]=!0,r.logger.warn('key "'.concat(n,'" for languages "').concat(f.join(", "),'" won\'t get resolved as namespace "').concat(i,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),f.forEach((function(n){if(!r.isValidLookup(t)){a=n;var i,l=[c];if(r.i18nFormat&&r.i18nFormat.addLookupKeys)r.i18nFormat.addLookupKeys(l,c,n,e,s);else{var u;d&&(u=r.pluralResolver.getSuffix(n,s.count,s));var f="".concat(r.options.pluralSeparator,"zero");if(d&&(l.push(c+u),p&&l.push(c+f)),h){var g="".concat(c).concat(r.options.contextSeparator).concat(s.context);l.push(g),d&&(l.push(g+u),p&&l.push(g+f))}}for(;i=l.pop();)r.isValidLookup(t)||(o=i,t=r.getResource(n,e,i,s))}})))}))}})),{res:t,usedKey:n,exactUsedKey:o,usedLng:a,usedNS:i}}},{key:"isValidLookup",value:function(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}},{key:"getResource",value:function(e,t,n){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,n,o):this.resourceStore.getResource(e,t,n,o)}}],[{key:"hasDefaultValue",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}]),t}();function Ld(e){return e.charAt(0).toUpperCase()+e.slice(1)}var Ad=function(){function e(t){Zu(this,e),this.options=t,this.supportedLngs=this.options.supportedLngs||!1,this.logger=ud.create("languageUtils")}return Qu(e,[{key:"getScriptPartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return null;var t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}},{key:"getLanguagePartFromCode",value:function(e){if(!e||e.indexOf("-")<0)return e;var t=e.split("-");return this.formatLanguageCode(t[0])}},{key:"formatLanguageCode",value:function(e){if("string"==typeof e&&e.indexOf("-")>-1){var t=["hans","hant","latn","cyrl","cans","mong","arab"],n=e.split("-");return this.options.lowerCaseLng?n=n.map((function(e){return e.toLowerCase()})):2===n.length?(n[0]=n[0].toLowerCase(),n[1]=n[1].toUpperCase(),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=Ld(n[1].toLowerCase()))):3===n.length&&(n[0]=n[0].toLowerCase(),2===n[1].length&&(n[1]=n[1].toUpperCase()),"sgn"!==n[0]&&2===n[2].length&&(n[2]=n[2].toUpperCase()),t.indexOf(n[1].toLowerCase())>-1&&(n[1]=Ld(n[1].toLowerCase())),t.indexOf(n[2].toLowerCase())>-1&&(n[2]=Ld(n[2].toLowerCase()))),n.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}},{key:"isSupportedCode",value:function(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}},{key:"getBestMatchFromCodes",value:function(e){var t,n=this;return e?(e.forEach((function(e){if(!t){var o=n.formatLanguageCode(e);n.options.supportedLngs&&!n.isSupportedCode(o)||(t=o)}})),!t&&this.options.supportedLngs&&e.forEach((function(e){if(!t){var o=n.getLanguagePartFromCode(e);if(n.isSupportedCode(o))return t=o;t=n.options.supportedLngs.find((function(e){return e===o?e:e.indexOf("-")<0&&o.indexOf("-")<0?void 0:0===e.indexOf(o)?e:void 0}))}})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t):null}},{key:"getFallbackCodes",value:function(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),"string"==typeof e&&(e=[e]),"[object Array]"===Object.prototype.toString.apply(e))return e;if(!t)return e.default||[];var n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}},{key:"toResolveHierarchy",value:function(e,t){var n=this,o=this.getFallbackCodes(t||this.options.fallbackLng||[],e),a=[],i=function(e){e&&(n.isSupportedCode(e)?a.push(e):n.logger.warn("rejecting language code not found in supportedLngs: ".concat(e)))};return"string"==typeof e&&e.indexOf("-")>-1?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(e))):"string"==typeof e&&i(this.formatLanguageCode(e)),o.forEach((function(e){a.indexOf(e)<0&&i(n.formatLanguageCode(e))})),a}}]),e}(),Od=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],Pd={1:function(e){return Number(e>1)},2:function(e){return Number(1!=e)},3:function(e){return 0},4:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},5:function(e){return Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5)},6:function(e){return Number(1==e?0:e>=2&&e<=4?1:2)},7:function(e){return Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2)},8:function(e){return Number(1==e?0:2==e?1:8!=e&&11!=e?2:3)},9:function(e){return Number(e>=2)},10:function(e){return Number(1==e?0:2==e?1:e<7?2:e<11?3:4)},11:function(e){return Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3)},12:function(e){return Number(e%10!=1||e%100==11)},13:function(e){return Number(0!==e)},14:function(e){return Number(1==e?0:2==e?1:3==e?2:3)},15:function(e){return Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2)},16:function(e){return Number(e%10==1&&e%100!=11?0:0!==e?1:2)},17:function(e){return Number(1==e||e%10==1&&e%100!=11?0:1)},18:function(e){return Number(0==e?0:1==e?1:2)},19:function(e){return Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3)},20:function(e){return Number(1==e?0:0==e||e%100>0&&e%100<20?1:2)},21:function(e){return Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0)},22:function(e){return Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)}},Ud=["v1","v2","v3"],xd={zero:0,one:1,two:2,few:3,many:4,other:5},Vd=function(){function e(t){var n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};Zu(this,e),this.languageUtils=t,this.options=o,this.logger=ud.create("pluralResolver"),this.options.compatibilityJSON&&"v4"!==this.options.compatibilityJSON||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(n={},Od.forEach((function(e){e.lngs.forEach((function(t){n[t]={numbers:e.nr,plurals:Pd[e.fc]}}))})),n)}return Qu(e,[{key:"addRule",value:function(e,t){this.rules[e]=t}},{key:"getRule",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(e,{type:t.ordinal?"ordinal":"cardinal"})}catch(n){return}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}},{key:"needsPlural",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this.getRule(e,t);return this.shouldUseIntlApi()?n&&n.resolvedOptions().pluralCategories.length>1:n&&n.numbers.length>1}},{key:"getPluralFormsOfKey",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,n).map((function(e){return"".concat(t).concat(e)}))}},{key:"getSuffixes",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=this.getRule(e,n);return o?this.shouldUseIntlApi()?o.resolvedOptions().pluralCategories.sort((function(e,t){return xd[e]-xd[t]})).map((function(e){return"".concat(t.options.prepend).concat(e)})):o.numbers.map((function(o){return t.getSuffix(e,o,n)})):[]}},{key:"getSuffix",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=this.getRule(e,n);return o?this.shouldUseIntlApi()?"".concat(this.options.prepend).concat(o.select(t)):this.getSuffixRetroCompatible(o,t):(this.logger.warn("no plural rule found for: ".concat(e)),"")}},{key:"getSuffixRetroCompatible",value:function(e,t){var n=this,o=e.noAbs?e.plurals(t):e.plurals(Math.abs(t)),a=e.numbers[o];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===a?a="plural":1===a&&(a=""));var i=function(){return n.options.prepend&&a.toString()?n.options.prepend+a.toString():a.toString()};return"v1"===this.options.compatibilityJSON?1===a?"":"number"==typeof a?"_plural_".concat(a.toString()):i():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?i():this.options.prepend&&o.toString()?this.options.prepend+o.toString():o.toString()}},{key:"shouldUseIntlApi",value:function(){return!Ud.includes(this.options.compatibilityJSON)}}]),e}();function Bd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Gd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Bd(Object(n),!0).forEach((function(t){id(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Bd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Fd(e,t,n){var o,a,i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",s=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],l=(o=t,void 0!==(i=md(e,a=n))?i:md(o,a));return!l&&s&&"string"==typeof n&&void 0===(l=Ed(e,n,r))&&(l=Ed(t,n,r)),l}var zd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Zu(this,e),this.logger=ud.create("interpolator"),this.options=t,this.format=t.interpolation&&t.interpolation.format||function(e){return e},this.init(t)}return Qu(e,[{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});var t=e.interpolation;this.escape=void 0!==t.escape?t.escape:Id,this.escapeValue=void 0===t.escapeValue||t.escapeValue,this.useRawValueToEscape=void 0!==t.useRawValueToEscape&&t.useRawValueToEscape,this.prefix=t.prefix?_d(t.prefix):t.prefixEscaped||"{{",this.suffix=t.suffix?_d(t.suffix):t.suffixEscaped||"}}",this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||",",this.unescapePrefix=t.unescapeSuffix?"":t.unescapePrefix||"-",this.unescapeSuffix=this.unescapePrefix?"":t.unescapeSuffix||"",this.nestingPrefix=t.nestingPrefix?_d(t.nestingPrefix):t.nestingPrefixEscaped||_d("$t("),this.nestingSuffix=t.nestingSuffix?_d(t.nestingSuffix):t.nestingSuffixEscaped||_d(")"),this.nestingOptionsSeparator=t.nestingOptionsSeparator?t.nestingOptionsSeparator:t.nestingOptionsSeparator||",",this.maxReplaces=t.maxReplaces?t.maxReplaces:1e3,this.alwaysFormat=void 0!==t.alwaysFormat&&t.alwaysFormat,this.resetRegExp()}},{key:"reset",value:function(){this.options&&this.init(this.options)}},{key:"resetRegExp",value:function(){var e="".concat(this.prefix,"(.+?)").concat(this.suffix);this.regexp=new RegExp(e,"g");var t="".concat(this.prefix).concat(this.unescapePrefix,"(.+?)").concat(this.unescapeSuffix).concat(this.suffix);this.regexpUnescape=new RegExp(t,"g");var n="".concat(this.nestingPrefix,"(.+?)").concat(this.nestingSuffix);this.nestingRegexp=new RegExp(n,"g")}},{key:"interpolate",value:function(e,t,n,o){var a,i,r,s=this,l=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function c(e){return e.replace(/\$/g,"$$$$")}var u=function(e){if(e.indexOf(s.formatSeparator)<0){var a=Fd(t,l,e,s.options.keySeparator,s.options.ignoreJSONStructure);return s.alwaysFormat?s.format(a,void 0,n,Gd(Gd(Gd({},o),t),{},{interpolationkey:e})):a}var i=e.split(s.formatSeparator),r=i.shift().trim(),c=i.join(s.formatSeparator).trim();return s.format(Fd(t,l,r,s.options.keySeparator,s.options.ignoreJSONStructure),c,n,Gd(Gd(Gd({},o),t),{},{interpolationkey:r}))};this.resetRegExp();var d=o&&o.missingInterpolationHandler||this.options.missingInterpolationHandler,p=o&&o.interpolation&&void 0!==o.interpolation.skipOnVariables?o.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:function(e){return c(e)}},{regex:this.regexp,safeValue:function(e){return s.escapeValue?c(s.escape(e)):c(e)}}].forEach((function(t){for(r=0;a=t.regex.exec(e);){var n=a[1].trim();if(void 0===(i=u(n)))if("function"==typeof d){var l=d(e,a,o);i="string"==typeof l?l:""}else if(o&&Object.prototype.hasOwnProperty.call(o,n))i="";else{if(p){i=a[0];continue}s.logger.warn("missed to pass in variable ".concat(n," for interpolating ").concat(e)),i=""}else"string"==typeof i||s.useRawValueToEscape||(i=hd(i));var c=t.safeValue(i);if(e=e.replace(a[0],c),p?(t.regex.lastIndex+=i.length,t.regex.lastIndex-=a[0].length):t.regex.lastIndex=0,++r>=s.maxReplaces)break}})),e}},{key:"nest",value:function(e,t){var n,o,a,i=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};function s(e,t){var n=this.nestingOptionsSeparator;if(e.indexOf(n)<0)return e;var o=e.split(new RegExp("".concat(n,"[ ]*{"))),i="{".concat(o[1]);e=o[0];var r=(i=this.interpolate(i,a)).match(/'/g),s=i.match(/"/g);(r&&r.length%2==0&&!s||s.length%2!=0)&&(i=i.replace(/'/g,'"'));try{a=JSON.parse(i),t&&(a=Gd(Gd({},t),a))}catch(l){return this.logger.warn("failed parsing options string in nesting for key ".concat(e),l),"".concat(e).concat(n).concat(i)}return delete a.defaultValue,e}for(;n=this.nestingRegexp.exec(e);){var l=[];(a=(a=Gd({},r)).replace&&"string"!=typeof a.replace?a.replace:a).applyPostProcessor=!1,delete a.defaultValue;var c=!1;if(-1!==n[0].indexOf(this.formatSeparator)&&!/{.*}/.test(n[1])){var u=n[1].split(this.formatSeparator).map((function(e){return e.trim()}));n[1]=u.shift(),l=u,c=!0}if((o=t(s.call(this,n[1].trim(),a),a))&&n[0]===e&&"string"!=typeof o)return o;"string"!=typeof o&&(o=hd(o)),o||(this.logger.warn("missed to resolve ".concat(n[1]," for nesting ").concat(e)),o=""),c&&(o=l.reduce((function(e,t){return i.format(e,t,r.lng,Gd(Gd({},r),{},{interpolationkey:n[1].trim()}))}),o.trim())),e=e.replace(n[0],o),this.regexp.lastIndex=0}return e}}]),e}();function Hd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function qd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Hd(Object(n),!0).forEach((function(t){id(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Hd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Kd(e){var t={};return function(n,o,a){var i=o+JSON.stringify(a),r=t[i];return r||(r=e(o,a),t[i]=r),r(n)}}var Yd=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Zu(this,e),this.logger=ud.create("formatter"),this.options=t,this.formats={number:Kd((function(e,t){var n=new Intl.NumberFormat(e,qd({},t));return function(e){return n.format(e)}})),currency:Kd((function(e,t){var n=new Intl.NumberFormat(e,qd(qd({},t),{},{style:"currency"}));return function(e){return n.format(e)}})),datetime:Kd((function(e,t){var n=new Intl.DateTimeFormat(e,qd({},t));return function(e){return n.format(e)}})),relativetime:Kd((function(e,t){var n=new Intl.RelativeTimeFormat(e,qd({},t));return function(e){return n.format(e,t.range||"day")}})),list:Kd((function(e,t){var n=new Intl.ListFormat(e,qd({},t));return function(e){return n.format(e)}}))},this.init(t)}return Qu(e,[{key:"init",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=t.formatSeparator?t.formatSeparator:t.formatSeparator||","}},{key:"add",value:function(e,t){this.formats[e.toLowerCase().trim()]=t}},{key:"addCached",value:function(e,t){this.formats[e.toLowerCase().trim()]=Kd(t)}},{key:"format",value:function(e,t,n){var o=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return t.split(this.formatSeparator).reduce((function(e,t){var i=function(e){var t=e.toLowerCase().trim(),n={};if(e.indexOf("(")>-1){var o=e.split("(");t=o[0].toLowerCase().trim();var a=o[1].substring(0,o[1].length-1);"currency"===t&&a.indexOf(":")<0?n.currency||(n.currency=a.trim()):"relativetime"===t&&a.indexOf(":")<0?n.range||(n.range=a.trim()):a.split(";").forEach((function(e){if(e){var t=function(e){return function(e){if(Array.isArray(e))return e}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return rd(e,t);var n={}.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?rd(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split(":")),o=t[0],a=t.slice(1).join(":").trim().replace(/^'+|'+$/g,"");n[o.trim()]||(n[o.trim()]=a),"false"===a&&(n[o.trim()]=!1),"true"===a&&(n[o.trim()]=!0),isNaN(a)||(n[o.trim()]=parseInt(a,10))}}))}return{formatName:t,formatOptions:n}}(t),r=i.formatName,s=i.formatOptions;if(o.formats[r]){var l=e;try{var c=a&&a.formatParams&&a.formatParams[a.interpolationkey]||{},u=c.locale||c.lng||a.locale||a.lng||n;l=o.formats[r](e,u,qd(qd(qd({},s),a),c))}catch(d){o.logger.warn(d)}return l}return o.logger.warn("there was no format function for ".concat(r)),e}),e)}}]),e}();function $d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function Wd(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$d(Object(n),!0).forEach((function(t){id(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Zd=function(){nd(t,dd);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ad(e);if(t){var a=ad(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return od(this,n)}}(t);function t(n,o,a){var i,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return Zu(this,t),i=e.call(this),Cd&&dd.call(ed(i)),i.backend=n,i.store=o,i.services=a,i.languageUtils=a.languageUtils,i.options=r,i.logger=ud.create("backendConnector"),i.waitingReads=[],i.maxParallelReads=r.maxParallelReads||10,i.readingCalls=0,i.maxRetries=r.maxRetries>=0?r.maxRetries:5,i.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,i.state={},i.queue=[],i.backend&&i.backend.init&&i.backend.init(a,r.backend,r),i}return Qu(t,[{key:"queueLoad",value:function(e,t,n,o){var a=this,i={},r={},s={},l={};return e.forEach((function(e){var o=!0;t.forEach((function(t){var s="".concat(e,"|").concat(t);!n.reload&&a.store.hasResourceBundle(e,t)?a.state[s]=2:a.state[s]<0||(1===a.state[s]?void 0===r[s]&&(r[s]=!0):(a.state[s]=1,o=!1,void 0===r[s]&&(r[s]=!0),void 0===i[s]&&(i[s]=!0),void 0===l[t]&&(l[t]=!0)))})),o||(s[e]=!0)})),(Object.keys(i).length||Object.keys(r).length)&&this.queue.push({pending:r,pendingCount:Object.keys(r).length,loaded:{},errors:[],callback:o}),{toLoad:Object.keys(i),pending:Object.keys(r),toLoadLanguages:Object.keys(s),toLoadNamespaces:Object.keys(l)}}},{key:"loaded",value:function(e,t,n){var o=e.split("|"),a=o[0],i=o[1];t&&this.emit("failedLoading",a,i,t),n&&this.store.addResourceBundle(a,i,n),this.state[e]=t?-1:2;var r={};this.queue.forEach((function(n){var o,s,l,c,u,d,p;o=n.loaded,s=i,(c=(l=fd(o,[a],Object)).obj)[u=l.k]=c[u]||[],c[u].push(s),p=e,void 0!==(d=n).pending[p]&&(delete d.pending[p],d.pendingCount--),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach((function(e){r[e]||(r[e]={});var t=n.loaded[e];t.length&&t.forEach((function(t){void 0===r[e][t]&&(r[e][t]=!0)}))})),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())})),this.emit("loaded",r),this.queue=this.queue.filter((function(e){return!e.done}))}},{key:"read",value:function(e,t,n){var o=this,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,r=arguments.length>5?arguments[5]:void 0;if(!e.length)return r(null,{});if(this.readingCalls>=this.maxParallelReads)this.waitingReads.push({lng:e,ns:t,fcName:n,tried:a,wait:i,callback:r});else{this.readingCalls++;var s=function(s,l){if(o.readingCalls--,o.waitingReads.length>0){var c=o.waitingReads.shift();o.read(c.lng,c.ns,c.fcName,c.tried,c.wait,c.callback)}s&&l&&a<o.maxRetries?setTimeout((function(){o.read.call(o,e,t,n,a+1,2*i,r)}),i):r(s,l)},l=this.backend[n].bind(this.backend);if(2!==l.length)return l(e,t,s);try{var c=l(e,t);c&&"function"==typeof c.then?c.then((function(e){return s(null,e)})).catch(s):s(null,c)}catch(u){s(u)}}}},{key:"prepareLoading",value:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),a&&a();"string"==typeof e&&(e=this.languageUtils.toResolveHierarchy(e)),"string"==typeof t&&(t=[t]);var i=this.queueLoad(e,t,o,a);if(!i.toLoad.length)return i.pending.length||a(),null;i.toLoad.forEach((function(e){n.loadOne(e)}))}},{key:"load",value:function(e,t,n){this.prepareLoading(e,t,{},n)}},{key:"reload",value:function(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}},{key:"loadOne",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",o=e.split("|"),a=o[0],i=o[1];this.read(a,i,"read",void 0,void 0,(function(o,r){o&&t.logger.warn("".concat(n,"loading namespace ").concat(i," for language ").concat(a," failed"),o),!o&&r&&t.logger.log("".concat(n,"loaded namespace ").concat(i," for language ").concat(a),r),t.loaded(e,o,r)}))}},{key:"saveMissing",value:function(e,t,n,o,a){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},r=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(){};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t))this.logger.warn('did not save key "'.concat(n,'" as the namespace "').concat(t,'" was not yet loaded'),"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(null!=n&&""!==n){if(this.backend&&this.backend.create){var s=Wd(Wd({},i),{},{isUpdate:a}),l=this.backend.create.bind(this.backend);if(l.length<6)try{var c;(c=5===l.length?l(e,t,n,o,s):l(e,t,n,o))&&"function"==typeof c.then?c.then((function(e){return r(null,e)})).catch(r):r(null,c)}catch(u){r(u)}else l(e,t,n,o,r,s)}e&&e[0]&&this.store.addResource(e[0],t,n,o)}}}]),t}();function Jd(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!0,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(e){var t={};if("object"===Wu(e[1])&&(t=e[1]),"string"==typeof e[1]&&(t.defaultValue=e[1]),"string"==typeof e[2]&&(t.tDescription=e[2]),"object"===Wu(e[2])||"object"===Wu(e[3])){var n=e[3]||e[2];Object.keys(n).forEach((function(e){t[e]=n[e]}))}return t},interpolation:{escapeValue:!0,format:function(e,t,n,o){return e},prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function Xd(e){return"string"==typeof e.ns&&(e.ns=[e.ns]),"string"==typeof e.fallbackLng&&(e.fallbackLng=[e.fallbackLng]),"string"==typeof e.fallbackNS&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e}function Qd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function ep(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qd(Object(n),!0).forEach((function(t){id(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function tp(){}var np=function(){nd(t,dd);var e=function(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=ad(e);if(t){var a=ad(this).constructor;n=Reflect.construct(o,arguments,a)}else n=o.apply(this,arguments);return od(this,n)}}(t);function t(){var n,o,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0;if(Zu(this,t),n=e.call(this),Cd&&dd.call(ed(n)),n.options=Xd(a),n.services={},n.logger=ud,n.modules={external:[]},o=ed(n),Object.getOwnPropertyNames(Object.getPrototypeOf(o)).forEach((function(e){"function"==typeof o[e]&&(o[e]=o[e].bind(o))})),i&&!n.isInitialized&&!a.isClone){if(!n.options.initImmediate)return n.init(a,i),od(n,ed(n));setTimeout((function(){n.init(a,i)}),0)}return n}return Qu(t,[{key:"init",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=arguments.length>1?arguments[1]:void 0;"function"==typeof t&&(n=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&("string"==typeof t.ns?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));var o=Jd();function a(e){return e?"function"==typeof e?new e:e:null}if(this.options=ep(ep(ep({},o),this.options),Xd(t)),"v1"!==this.options.compatibilityAPI&&(this.options.interpolation=ep(ep({},o.interpolation),this.options.interpolation)),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator),!this.options.isClone){var i;this.modules.logger?ud.init(a(this.modules.logger),this.options):ud.init(null,this.options),this.modules.formatter?i=this.modules.formatter:"undefined"!=typeof Intl&&(i=Yd);var r=new Ad(this.options);this.store=new Md(this.options.resources,this.options);var s=this.services;s.logger=ud,s.resourceStore=this.store,s.languageUtils=r,s.pluralResolver=new Vd(r,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!i||this.options.interpolation.format&&this.options.interpolation.format!==o.interpolation.format||(s.formatter=a(i),s.formatter.init(s,this.options),this.options.interpolation.format=s.formatter.format.bind(s.formatter)),s.interpolator=new zd(this.options),s.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},s.backendConnector=new Zd(a(this.modules.backend),s.resourceStore,s,this.options),s.backendConnector.on("*",(function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];e.emit.apply(e,[t].concat(o))})),this.modules.languageDetector&&(s.languageDetector=a(this.modules.languageDetector),s.languageDetector.init&&s.languageDetector.init(s,this.options.detection,this.options)),this.modules.i18nFormat&&(s.i18nFormat=a(this.modules.i18nFormat),s.i18nFormat.init&&s.i18nFormat.init(this)),this.translator=new Rd(this.services,this.options),this.translator.on("*",(function(t){for(var n=arguments.length,o=new Array(n>1?n-1:0),a=1;a<n;a++)o[a-1]=arguments[a];e.emit.apply(e,[t].concat(o))})),this.modules.external.forEach((function(t){t.init&&t.init(e)}))}if(this.format=this.options.interpolation.format,n||(n=tp),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){var l=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);l.length>0&&"dev"!==l[0]&&(this.options.lng=l[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments)}})),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((function(t){e[t]=function(){var n;return(n=e.store)[t].apply(n,arguments),e}}));var c=pd(),u=function(){var t=function(t,o){e.isInitialized&&!e.initializedStoreOnce&&e.logger.warn("init: i18next is already initialized. You should call init just once!"),e.isInitialized=!0,e.options.isClone||e.logger.log("initialized",e.options),e.emit("initialized",e.options),c.resolve(o),n(t,o)};if(e.languages&&"v1"!==e.options.compatibilityAPI&&!e.isInitialized)return t(null,e.t.bind(e));e.changeLanguage(e.options.lng,t)};return this.options.resources||!this.options.initImmediate?u():setTimeout(u,0),c}},{key:"loadResources",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tp,o="string"==typeof e?e:this.language;if("function"==typeof e&&(n=e),!this.options.resources||this.options.partialBundledLanguages){if(o&&"cimode"===o.toLowerCase())return n();var a=[],i=function(e){e&&t.services.languageUtils.toResolveHierarchy(e).forEach((function(e){a.indexOf(e)<0&&a.push(e)}))};o?i(o):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((function(e){return i(e)})),this.options.preload&&this.options.preload.forEach((function(e){return i(e)})),this.services.backendConnector.load(a,this.options.ns,(function(e){e||t.resolvedLanguage||!t.language||t.setResolvedLanguage(t.language),n(e)}))}else n(null)}},{key:"reloadResources",value:function(e,t,n){var o=pd();return e||(e=this.languages),t||(t=this.options.ns),n||(n=tp),this.services.backendConnector.reload(e,t,(function(e){o.resolve(),n(e)})),o}},{key:"use",value:function(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&wd.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}},{key:"setResolvedLanguage",value:function(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(var t=0;t<this.languages.length;t++){var n=this.languages[t];if(!(["cimode","dev"].indexOf(n)>-1)&&this.store.hasLanguageSomeTranslations(n)){this.resolvedLanguage=n;break}}}},{key:"changeLanguage",value:function(e,t){var n=this;this.isLanguageChangingTo=e;var o=pd();this.emit("languageChanging",e);var a=function(e){n.language=e,n.languages=n.services.languageUtils.toResolveHierarchy(e),n.resolvedLanguage=void 0,n.setResolvedLanguage(e)},i=function(i){e||i||!n.services.languageDetector||(i=[]);var r="string"==typeof i?i:n.services.languageUtils.getBestMatchFromCodes(i);r&&(n.language||a(r),n.translator.language||n.translator.changeLanguage(r),n.services.languageDetector&&n.services.languageDetector.cacheUserLanguage&&n.services.languageDetector.cacheUserLanguage(r)),n.loadResources(r,(function(e){var i,s;i=e,(s=r)?(a(s),n.translator.changeLanguage(s),n.isLanguageChangingTo=void 0,n.emit("languageChanged",s),n.logger.log("languageChanged",s)):n.isLanguageChangingTo=void 0,o.resolve((function(){return n.t.apply(n,arguments)})),t&&t(i,(function(){return n.t.apply(n,arguments)}))}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(i):this.services.languageDetector.detect(i):i(e):i(this.services.languageDetector.detect()),o}},{key:"getFixedT",value:function(e,t,n){var o=this,a=function e(t,a){var i;if("object"!==Wu(a)){for(var r=arguments.length,s=new Array(r>2?r-2:0),l=2;l<r;l++)s[l-2]=arguments[l];i=o.options.overloadTranslationOptionHandler([t,a].concat(s))}else i=ep({},a);i.lng=i.lng||e.lng,i.lngs=i.lngs||e.lngs,i.ns=i.ns||e.ns,i.keyPrefix=i.keyPrefix||n||e.keyPrefix;var c,u=o.options.keySeparator||".";return c=i.keyPrefix&&Array.isArray(t)?t.map((function(e){return"".concat(i.keyPrefix).concat(u).concat(e)})):i.keyPrefix?"".concat(i.keyPrefix).concat(u).concat(t):t,o.t(c,i)};return"string"==typeof e?a.lng=e:a.lngs=e,a.ns=t,a.keyPrefix=n,a}},{key:"t",value:function(){var e;return this.translator&&(e=this.translator).translate.apply(e,arguments)}},{key:"exists",value:function(){var e;return this.translator&&(e=this.translator).exists.apply(e,arguments)}},{key:"setDefaultNamespace",value:function(e){this.options.defaultNS=e}},{key:"hasLoadedNamespace",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;var o=n.lng||this.resolvedLanguage||this.languages[0],a=!!this.options&&this.options.fallbackLng,i=this.languages[this.languages.length-1];if("cimode"===o.toLowerCase())return!0;var r=function(e,n){var o=t.services.backendConnector.state["".concat(e,"|").concat(n)];return-1===o||2===o};if(n.precheck){var s=n.precheck(this,r);if(void 0!==s)return s}return!(!this.hasResourceBundle(o,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!r(o,e)||a&&!r(i,e)))}},{key:"loadNamespaces",value:function(e,t){var n=this,o=pd();return this.options.ns?("string"==typeof e&&(e=[e]),e.forEach((function(e){n.options.ns.indexOf(e)<0&&n.options.ns.push(e)})),this.loadResources((function(e){o.resolve(),t&&t(e)})),o):(t&&t(),Promise.resolve())}},{key:"loadLanguages",value:function(e,t){var n=pd();"string"==typeof e&&(e=[e]);var o=this.options.preload||[],a=e.filter((function(e){return o.indexOf(e)<0}));return a.length?(this.options.preload=o.concat(a),this.loadResources((function(e){n.resolve(),t&&t(e)})),n):(t&&t(),Promise.resolve())}},{key:"dir",value:function(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";var t=this.services&&this.services.languageUtils||new Ad(Jd());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}},{key:"cloneInstance",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:tp,a=ep(ep(ep({},this.options),n),{isClone:!0}),i=new t(a);return void 0===n.debug&&void 0===n.prefix||(i.logger=i.logger.clone(n)),["store","services","language"].forEach((function(t){i[t]=e[t]})),i.services=ep({},this.services),i.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i.translator=new Rd(i.services,i.options),i.translator.on("*",(function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];i.emit.apply(i,[e].concat(n))})),i.init(a,o),i.translator.options=i.options,i.translator.backendConnector.services.utils={hasLoadedNamespace:i.hasLoadedNamespace.bind(i)},i}},{key:"toJSON",value:function(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}]),t}();id(np,"createInstance",(function(){return new np(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}));var op=np.createInstance();op.createInstance=np.createInstance,op.createInstance,op.dir,op.init,op.loadResources,op.reloadResources,op.use,op.changeLanguage,op.getFixedT,op.t,op.exists,op.setDefaultNamespace,op.hasLoadedNamespace,op.loadNamespaces,op.loadLanguages;let ap=class{constructor(e){this.TUIUserService=e}getEngine(){return this.TUIUserService.getEngine()}init(){this.getEngine().eventCenter.addEvent(this.getEngine().EVENT.PROFILE_UPDATED,this.onProfileUpdated.bind(this)),this.getEngine().eventCenter.addEvent(this.getEngine().EVENT.BLACKLIST_UPDATED,this.onBlacklistUpdated.bind(this)),this.getUserProfileInitData()}onProfileUpdated(e){const t=this.getEngine(),n=t.TUIStore.getData(tu.USER,"userProfile");e.forEach((e=>{e.userID===n.userID&&t.TUIStore.update(tu.USER,"userProfile",e)}))}onBlacklistUpdated(e){const t=this.getEngine();this.getBlacklistProfile(e).then((e=>{t.TUIStore.update(tu.USER,"userBlacklist",e)}))}getUserProfileInitData(){const e=this.getEngine();e.chat.isReady()&&e.chat.getBlacklist().then((e=>{const t=e.data||[];t.length>0&&this.onBlacklistUpdated(t)}))}getBlacklistProfile(e){const t=[];let n=0;for(;n<e.length;)t.push(e.slice(n,n+=100));const o=[];t.forEach((e=>{o.push(this.TUIUserService.getUserProfile({userIDList:e}))}));const a=[];return Promise.all(o).then((e=>(e.forEach((e=>{const t=e.data.map((e=>{const{userID:t,nick:n,avatar:o}=e;return{userID:t,nick:n,avatar:o}}));a.push(...t)})),a)))}getUserProfile(e){const t=this.getEngine();return uu(e)?t.chat.getMyProfile().then((e=>(t.TUIStore.update(tu.USER,"userProfile",e.data),e))).catch((e=>Promise.reject(e))):t.chat.getUserProfile(e)}updateMyProfile(e){return this.getEngine().chat.updateMyProfile(e)}addToBlacklist(e){return this.getEngine().chat.addToBlacklist(e)}removeFromBlacklist(e){return this.getEngine().chat.removeFromBlacklist(e)}};function ip(e,t,n=!0){var o,a;o=n?sp(e):e,a=t,ku?Su.setStorageSync(o,a):lp()&&localStorage.setItem(o,JSON.stringify(a))}function rp(e,t=!0){try{return function(e){if(ku)return Su.getStorageSync(e);if(lp()){const t=localStorage.getItem(e);if("undefined"!==t)return JSON.parse(t)}}(t?sp(e):e)}catch(n){return}}function sp(e){return`chat_engine_${e}`}function lp(){return navigator&&navigator.cookieEnabled&&localStorage}let cp=class{constructor(e){this.TUIUserService=e}getEngine(){return this.TUIUserService.getEngine()}init(){const e=this.getEngine(),t=rp("displayOnlineStatus")||!1;e.TUIStore.update(tu.USER,"displayOnlineStatus",t),e.eventCenter.addEvent(e.EVENT.USER_STATUS_UPDATED,this.onUserStatusUpdated.bind(this)),this.onConversationListUpdated()}onConversationListUpdated(){const e=this.getEngine();e.TUIStore.watch(tu.CONV,{conversationList:()=>{const t=e.TUIStore.getData(tu.APP,"enabledOnlineStatus"),n=e.TUIStore.getData(tu.USER,"displayOnlineStatus");t&&n&&this.startToSubscribe()}})}onUserStatusUpdated(e){this.getEngine().TUIStore.update(tu.USER,"userStatusList",e)}switchUserStatus(e){const t=this.getEngine(),{displayOnlineStatus:n=!1}=e;t.TUIStore.update(tu.USER,"displayOnlineStatus",n),ip("displayOnlineStatus",n);t.TUIStore.getData(tu.APP,"enabledOnlineStatus")&&(!0===n?this.startToSubscribe():this.unsubscribeUserStatus())}getUserStatus(e){const t=this.getEngine();return t.chat.getUserStatus(e).then((e=>{const{successUserList:n}=e.data;return n.length>0&&t.TUIStore.update(tu.USER,"userStatusList",n),e})).catch((e=>Promise.reject(e)))}subscribeUserStatus(e){var t;return 0===((null===(t=null==e?void 0:e.userIDList)||void 0===t?void 0:t.length)||0)?Promise.resolve():this.getEngine().chat.subscribeUserStatus(e)}unsubscribeUserStatus(e){const t=this.getEngine(),{userIDList:n=[]}=e||{};return t.chat.unsubscribeUserStatus({userIDList:n}).then((e=>{const{failureUserList:o}=e.data,a=[];return n.forEach((e=>{o.includes(e)||a.push({userID:e,statusType:nu.UNSUB_USER})})),t.TUIStore.update(tu.USER,"userStatusList",a),e})).catch((e=>Promise.reject(e)))}startToSubscribe(){const e=this.getEngine(),t=e.TUIStore.getData(tu.CONV,"conversationList"),n=e.TUIStore.getData(tu.USER,"userStatusList"),o=[];t.forEach((t=>{if(t.type===e.TYPES.CONV_C2C){const a=t.conversationID.replace(e.TYPES.CONV_C2C,"");n.has(a)||o.push(a)}})),0!==o.length&&e.chat.isReady()&&(this.subscribeUserStatus({userIDList:o}),this.getUserStatus({userIDList:o}))}},up=class{constructor(e){this.TUIChatService=e,this.userShowNameMap=new Map,this.requestedUserMap=new Map}getEngine(){return this.TUIChatService.getEngine()}t(e){return this.getEngine().TUITranslate.t(e)}handleTextMessage(e){return{text:this.decodeText(e.payload)}}handleFaceMessage(e){const t={name:"",url:"",type:""};return e.payload.data.indexOf("@custom")>-1?(t.name=e.payload.data,t.type="custom",t):(t.name=e.payload.data.indexOf("@2x")<0?`${e.payload.data}@2x`:e.payload.data,t.url=`https://web.sdk.qcloud.com/im/assets/face-elem/${t.name}.png`,t)}handleLocationMessage(e){const t={lon:"",lat:"",href:"",url:"",description:""};return t.lon=e.payload.longitude.toFixed(6),t.lat=e.payload.latitude.toFixed(6),t.href=`https://map.qq.com/?type=marker&isopeninfowin=1&markertype=1&pointx=${t.lon}&pointy=${t.lat}&name=${e.payload.description}`,t.url=`https://apis.map.qq.com/ws/staticmap/v2/?center=${t.lat},${t.lon}&zoom=10&size=300*150&maptype=roadmap&markers=size:large|color:0xFFCCFF|label:k|${t.lat},${t.lon}&key=UBNBZ-PTP3P-TE7DB-LHRTI-Y4YLE-VWBBD`,t.description=e.payload.description,t}handleImageMessage(e){return{url:e.payload.imageInfoArray[0].url,width:e.payload.imageInfoArray[0].width,height:e.payload.imageInfoArray[0].height}}handleAudioMessage(e){return{url:e.payload.url,second:e.payload.second}}handleVideoMessage(e){return{url:e.payload.videoUrl,snapshotUrl:e.payload.snapshotUrl,snapshotWidth:e.payload.snapshotWidth,snapshotHeight:e.payload.snapshotHeight}}handleFileMessage(e){return{url:e.payload.fileUrl,name:e.payload.fileName,size:fu(e.payload.fileSize)}}handleCustomMessage(e){var t;const n=this.handleCreateGroupCustomMessage(e);return{custom:this.handleCallKitSignaling(e)||n||(null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.extension)||`${this.t("TUIChat.[自定义消息]")}`,businessID:n?"group_create":""}}handleMergeMessage(e){return Object.assign({},e.payload)}handleGroupTipsMessage(e){var t,n,o,a,i,r;const s=this.getEngine(),l={text:""};let c=(null==e?void 0:e.nick)||(null===(n=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.userIDList)||void 0===n?void 0:n.join(","));switch((null===(a=null===(o=null==e?void 0:e.payload)||void 0===o?void 0:o.memberList)||void 0===a?void 0:a.length)>0&&(c="",null===(r=null===(i=null==e?void 0:e.payload)||void 0===i?void 0:i.memberList)||void 0===r||r.map((e=>{const t=(null==e?void 0:e.nick)||(null==e?void 0:e.userID);return c+=`${this.substringByLength(t)},`,e})),c=null==c?void 0:c.slice(0,-1)),e.payload.operationType){case s.TYPES.GRP_TIP_MBR_JOIN:l.text=`${c} ${this.t("message.tip.加入群组")}`;break;case s.TYPES.GRP_TIP_MBR_QUIT:l.text=`${this.t("message.tip.群成员")}：${c} ${this.t("message.tip.退出群组")}`;break;case s.TYPES.GRP_TIP_MBR_KICKED_OUT:l.text=`${this.t("message.tip.群成员")}：${c} ${this.t("message.tip.被")}${this.t("message.tip.踢出群组")}`;break;case s.TYPES.GRP_TIP_MBR_SET_ADMIN:l.text=`${this.t("message.tip.群成员")}：${c} ${this.t("message.tip.成为管理员")}`;break;case s.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:l.text=`${this.t("message.tip.群成员")}：${c} ${this.t("message.tip.被撤销管理员")}`;break;case s.TYPES.GRP_TIP_GRP_PROFILE_UPDATED:l.text=this.handleGroupProfileUpdated(e);break;case s.TYPES.GRP_TIP_MBR_PROFILE_UPDATED:for(const t of e.payload.memberList)t.muteTime>0?l.text=`${this.t("message.tip.群成员")}：${c} ${this.t("message.tip.被禁言")}`:l.text=`${this.t("message.tip.群成员")}：${c} ${this.t("message.tip.被取消禁言")}`;break;default:l.text=`[${this.t("message.tip.群提示消息")}]`}return l}handleGroupSystemMessage(e){const t=e.payload.groupProfile.name||e.payload.groupProfile.groupID,n={text:""};switch(e.payload.operationType){case 1:n.text=`${e.payload.operatorID} ${this.t("message.tip.申请加入群组")}：${t}`;break;case 2:n.text=`${this.t("message.tip.成功加入群组")}：${t}`;break;case 3:n.text=`${this.t("message.tip.申请加入群组")}：${t} ${this.t("message.tip.被拒绝")}`;break;case 4:n.text=`${this.t("message.tip.你被管理员")}${e.payload.operatorID} ${this.t("message.tip.踢出群组")}：${t}`;break;case 5:n.text=`${this.t("message.tip.群")}：${t} ${this.t("message.tip.被")} ${e.payload.operatorID} ${this.t("message.tip.解散")}`;break;case 6:n.text=`${e.payload.operatorID} ${this.t("message.tip.创建群")}：${t}`;break;case 7:case 12:n.text=`${e.payload.operatorID} ${this.t("message.tip.邀请你加群")}：${t}`;break;case 8:n.text=`${this.t("message.tip.你退出群组")}：${t}`;break;case 9:n.text=`${this.t("message.tip.你被")}${e.payload.operatorID} ${this.t("message.tip.设置为群")}：${t} ${this.t("message.tip.的管理员")}`;break;case 10:n.text=`${this.t("message.tip.你被")}${e.payload.operatorID} ${this.t("message.tip.撤销群")}：${t} ${this.t("message.tip.的管理员身份")}`;break;case 13:n.text=`${e.payload.operatorID} ${this.t("message.tip.同意加群")}：${t}`;break;case 14:n.text=`${e.payload.operatorID} ${this.t("message.tip.拒接加群")}：${t}`;break;case 255:n.text=`${this.t("message.tip.自定义群系统通知")}: ${e.payload.userDefinedField}`;break;default:n.text="未解析的群系统通知"}return n}handleCallKitSignaling(e){var t,n,o,a,i,r,s,l,c,u;const d=hu(e.payload.data);if(1!==(null==d?void 0:d.businessID))return"";const p=hu(null==d?void 0:d.data),h=e.fromAccount||e.from,f=this.getEngine().TUIFriend.getFriendRemark([h]),g=this.getEngine().getMyUserID();let m=f[h]||e.nameCard||e.nick||h;switch(m=this.substringByLength(m),null==d?void 0:d.actionType){case 1:return"audioCall"!==(null===(t=null==p?void 0:p.data)||void 0===t?void 0:t.cmd)&&"videoCall"!==(null===(n=null==p?void 0:p.data)||void 0===n?void 0:n.cmd)||!(null==d?void 0:d.groupID)?"hangup"===(null===(o=null==p?void 0:p.data)||void 0===o?void 0:o.cmd)?(null==d?void 0:d.groupID)?`${this.t("message.custom.通话结束")}`:`${this.t("message.custom.通话时长")}：${function(e){const t=e;let n,o,a,i="";return t>=3600?(n=parseInt(""+t/3600,10)<10?`0${parseInt(""+t/3600,10)}`:parseInt(""+t/3600,10),o=parseInt(""+t%60/60,10)<10?`0${parseInt(""+t%60/60,10)}`:parseInt(""+t%60/60,10),a=t%3600<10?"0"+t%3600:t%3600,a>60&&(o=parseInt(""+a/60,10)<10?`0${parseInt(""+a/60,10)}`:parseInt(""+a/60,10),a=a%60<10?"0"+a%60:a%60),i=`${n}:${o}:${a}`):t>=60&&t<3600?(o=parseInt(""+t/60,10)<10?`0${parseInt(""+t/60,10)}`:parseInt(""+t/60,10),a=t%60<10?"0"+t%60:t%60,i=`00:${o}:${a}`):t<60&&(a=t<10?`0${t}`:t,i=`00:00:${a}`),i}(null==p?void 0:p.call_end)}`:"switchToAudio"===(null===(a=null==p?void 0:p.data)||void 0===a?void 0:a.cmd)?`${this.t("message.custom.切换语音通话")}`:"switchToVideo"===(null===(i=null==p?void 0:p.data)||void 0===i?void 0:i.cmd)?`${this.t("message.custom.切换视频通话")}`:`${this.t("message.custom.发起通话")}`:`${m} ${this.t("message.custom.发起通话")}`;case 2:return(null==d?void 0:d.groupID)?`${m} ${this.t("message.custom.取消通话")}`:this.isOldUIKit("message.custom.已取消")?this.t("message.custom.取消通话"):(null==d?void 0:d.inviter)===g?this.t("message.custom.已取消"):this.t("message.custom.对方已取消");case 3:return"switchToAudio"===(null===(r=null==p?void 0:p.data)||void 0===r?void 0:r.cmd)?`${this.t("message.custom.切换语音通话")}`:"switchToVideo"===(null===(s=null==p?void 0:p.data)||void 0===s?void 0:s.cmd)?`${this.t("message.custom.切换视频通话")}`:(null==d?void 0:d.groupID)?`${m} ${this.t("message.custom.已接听")}`:this.t("message.custom.已接听");case 4:return(null==d?void 0:d.groupID)?`${m} ${this.t("message.custom.拒绝通话")}`:this.isOldUIKit("message.custom.已拒绝")?this.t("message.custom.拒绝通话"):"line_busy"===(null==p?void 0:p.line_busy)||"lineBusy"===(null==p?void 0:p.data.message)?(null==d?void 0:d.inviter)===g?this.t("message.custom.对方忙线中"):this.t("message.custom.忙线未接听"):(null==d?void 0:d.inviter)===g?this.t("message.custom.对方已拒绝"):this.t("message.custom.已拒绝");case 5:if("switchToAudio"===(null===(l=null==p?void 0:p.data)||void 0===l?void 0:l.cmd))return`${this.t("message.custom.切换语音通话")}`;if("switchToVideo"===(null===(c=null==p?void 0:p.data)||void 0===c?void 0:c.cmd))return`${this.t("message.custom.切换视频通话")}`;if(null==d?void 0:d.groupID){if(h===(null==d?void 0:d.inviter)){this.handleCallkitTimeoutSignaling(d.inviteeList);let e="";return null===(u=d.inviteeList)||void 0===u||u.forEach((t=>{const n=this.userShowNameMap.get(t)||t;e+=`${this.substringByLength(n)}、`})),e=e.substring(0,e.lastIndexOf("、")),`${e} ${this.t("message.custom.无应答")}`}return`${m} ${this.t("message.custom.无应答")}`}return this.isOldUIKit("message.custom.对方无应答")?this.t("message.custom.无应答"):(null==d?void 0:d.inviter)===g?this.t("message.custom.对方无应答"):this.t("message.custom.超时无应答");default:return""}}handleCreateGroupCustomMessage(e){let t;const n=hu(e.payload.data);return"group_create"===(null==n?void 0:n.businessID)&&(t=`${n.opUser} ${n.content}`),t}decodeText(e){const t=[];let n=e.text,o=-1,a=-1;for(;""!==n;)switch(o=n.indexOf("["),a=n.indexOf("]"),o){case 0:if(-1===a)t.push({name:"text",text:n}),n="";else{const e=n.slice(0,a+1);e.indexOf("@custom")>-1?(t.push({name:"img",src:"",type:"custom",emojiKey:e}),n=n.substring(a+1)):gu[e]?(t.push({name:"img",src:"https://web.sdk.qcloud.com/im/assets/emoji-plugin/"+gu[e],emojiKey:e}),n=n.substring(a+1)):(t.push({name:"text",text:"["}),n=n.slice(1))}break;case-1:t.push({name:"text",text:n}),n="";break;default:t.push({name:"text",text:n.slice(0,o)}),n=n.substring(o)}return t}handleGroupProfileUpdated(e){const{nick:t,payload:n}=e,{newGroupProfile:o,memberList:a,operatorID:i}=n;let r="";const s=t||i,l=Object.keys(o)[0];switch(l){case"muteAllMembers":r=o[l]?`${this.t("message.tip.管理员")} ${s} ${this.t("message.tip.开启全员禁言")}`:`${this.t("message.tip.管理员")} ${s} ${this.t("message.tip.取消全员禁言")}`;break;case"ownerID":r=`${a[0].nick||a[0].userID} ${this.t("message.tip.成为新的群主")}`;break;case"groupName":r=`${s} ${this.t("message.tip.修改群名为")} ${o[l]}`;break;case"notification":r=this.isOldUIKit("message.tip.把群公告修改为")?`${s} ${this.t("message.tip.发布新公告")}`:`${s} ${this.t("message.tip.把群公告修改为")} "${o[l]}"`}return r}handleCallkitTimeoutSignaling(e=[]){if(0===e.length)return;const t=this.getEngine().TUIFriend.getFriendRemark(e),n=[];e.forEach((e=>{const o=t[e];o?this.userShowNameMap.set(e,o):this.requestedUserMap.has(e)||(n.push(e),this.requestedUserMap.set(e,1))})),n.length>0&&this.getEngine().TUIUser.getUserProfile({userIDList:n}).then((e=>{(e.data||[]).forEach((e=>{const{userID:t,nick:n}=e,o=n||t;this.userShowNameMap.set(t,o)}))})).catch((()=>{}))}substringByLength(e,t=12){return e.length>t?`${e.slice(0,t)}...`:e}isOldUIKit(e){var t;const n=e.lastIndexOf("."),o=e.slice(0,n+1);return null===(t=this.t(e))||void 0===t?void 0:t.startsWith(o)}},dp=class{constructor(e){this.TUIChatService=e,this.typingTo="",this.timer=null}getEngine(){return this.TUIChatService.getEngine()}clearTypingStatus(){this.getEngine().TUIStore.getData(tu.CHAT,"typingStatus")&&this.getEngine().TUIStore.update(tu.CHAT,"typingStatus",!1),this.timer&&clearTimeout(this.timer),this.timer=null}handleLastMessage(e){const t=this.getEngine(),n=t.TUIStore.getData(tu.CHAT,"typingStatus");if(e.type===this.getEngine().TYPES.MSG_CUSTOM&&"in"===e.flow){const o=hu(e.payload.data);if(o.businessID===ou.BUSINESS_ID){const{typingStatus:e,userAction:a}=o;if(e===ou.STATUS_START||a===ou.ACTION_START_ID)return n?(this.timer&&clearTimeout(this.timer),this.timer=null):t.TUIStore.update(tu.CHAT,"typingStatus",!0),this.timer=setTimeout((()=>{this.clearTypingStatus()}),3e4),t.TUIStore.getData(tu.CHAT,"typingStatus");e!==ou.STATUS_END&&a!==ou.ACTION_END_ID||this.clearTypingStatus()}}}filterTypingMessage(e=[]){return 0===e.length?[]:(this.getEngine().TUIStore.getData(tu.APP,"enableTyping")&&this.handleLastMessage(e[e.length-1]),e.filter((e=>e.type!==this.getEngine().TYPES.MSG_CUSTOM||hu(e.payload.data).businessID!==ou.BUSINESS_ID)))}createTypingMessage(e=ou.STATUS_END,t=""){const{BUSINESS_ID:n,STATUS_START:o,VERSION:a,ACTION_START_ID:i,ACTION_END_ID:r,ACTION_START:s,ACTION_END:l,NEED_TYPING:c}=ou;return{to:t,conversationType:this.getEngine().TYPES.CONV_C2C,payload:{data:JSON.stringify({businessID:n,typingStatus:e,version:a,userAction:e===o?i:r,actionParam:e===o?s:l}),description:"",extension:""},cloudCustomData:JSON.stringify({messageFeature:{needTyping:c,version:a}})}}sendTyping(e=!1,t=""){if(e){this.typingTo=t;const e=this.createTypingMessage(ou.STATUS_START,t);this.getEngine().TUIChat.sendCustomMessage(e,{onlineUserOnly:!0})}else this.sendTypingEnd()}sendTypingEnd(){if(this.typingTo){const e=this.createTypingMessage(ou.STATUS_END,this.typingTo);this.getEngine().TUIChat.sendCustomMessage(e,{onlineUserOnly:!0})}this.typingTo=""}},pp=class{constructor(e){this.TUIChatService=e}getEngine(){return this.TUIChatService.getEngine()}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.MESSAGE_READ_RECEIPT_RECEIVED,this.onMessageReadReceiptReceived.bind(this))}onMessageReadReceiptReceived(e){const t=this.getEngine(),n=t.TUIStore.getData(tu.CONV,"currentConversationID"),o=[];e.forEach((e=>{const{messageID:a}=e,i=t.chat.findMessage(a);i&&n===i.conversationID&&o.push(i)})),o.length>0&&t.TUIChat.updateMessageList(o,"edit")}sendMessageReadReceipt(e){const t=[];return e.forEach((e=>{const n=e.getMessage();t.push(n)})),this.getEngine().chat.sendMessageReadReceipt(t)}getGroupMessageReadMemberList(e){const t=e.message.getMessage(),n=Object.assign(Object.assign({},e),{message:t});return this.getEngine().chat.getGroupMessageReadMemberList(n)}getMessageReadReceiptList(e){const t=this.getEngine(),n=t.TUIStore.getData(tu.APP,"enabledMessageReadReceipt"),o=t.TUIStore.getData(tu.USER,"displayMessageReadReceipt");!n||!o||0===e.length||e[0].conversationType!==t.TYPES.CONV_GROUP||t.chat.getMessageReadReceiptList(e).then((e=>{const{messageList:t}=e.data;this.TUIChatService.updateMessageList(t,"edit")})).catch((e=>{}))}},hp=class{constructor(){this.cache=[],this.middlewares=[],this.options=null}use(e){return this.cache.push(e),this}next(){if(this.middlewares&&this.middlewares.length>0)return this.middlewares.shift().call(this,this.options,this.next.bind(this))}run(e){return this.middlewares=this.cache.map((e=>e)),this.options=e,this.next()}};function fp(e,t,n){const o=Object.create(null);Object.keys(n).forEach((n=>{if(!t[n])return;o[n]=t[n];const a=new hp;t[n]=function(){const i=Array.from(arguments);return a.use(((t,o)=>e.isInited?o():Promise.reject({code:ru.NOT_INIT,message:`${n} | ${lu.NOT_INIT}`}))).use((e=>o[n].apply(t,e))),a.run(i)}}))}const gp=Ou.getInstance();Au.getInstance();const mp=class e{constructor(){this.storeMap={[tu.APP]:new Pu,[tu.USER]:new Uu,[tu.CONV]:new Fu,[tu.CHAT]:new Hu,[tu.GRP]:new qu,[tu.FRIEND]:new Yu,[tu.SEARCH]:new $u},this.task={}}static getInstance(){return e.instance||(e.instance=new e),e.instance}watch(e,t){this.task[e]||(this.task[e]={});const n=this.task[e];Object.keys(t).forEach((o=>{const a=t[o];n[o]||(n[o]=new Map),n[o].set(a,1),this.notifyOnWatch(e,o,a)}))}unwatch(e,t){if(!this.task[e])return;const n=this.task[e];Object.keys(t).forEach((e=>{var o;null===(o=n[e])||void 0===o||o.delete(t[e])}))}update(e,t,n){var o;e!==tu.CUSTOM||this.storeMap[e]||(this.storeMap[e]=new Ku),null===(o=this.storeMap[e])||void 0===o||o.update(t,n),this.notify(e,t)}getData(e,t){var n;return e!==tu.CUSTOM||this.storeMap[e]||(this.storeMap[e]=new Ku),null===(n=this.storeMap[e])||void 0===n?void 0:n.getData(t)}getConversationModel(e){var t;return null===(t=this.storeMap[tu.CONV])||void 0===t?void 0:t.getModel(e)}getMessageModel(e){var t;return null===(t=this.storeMap[tu.CHAT])||void 0===t?void 0:t.getModel(e)}reset(e,t=[],n=!1){if(e in this.storeMap){const o=this.storeMap[e];0===t.length&&(t=Object.keys(null==o?void 0:o.store)),o.reset(t),n&&t.forEach((t=>{this.notify(e,t)}))}}notifyOnWatch(e,t,n){const o=this.getData(e,t);_u.indexOf(t)>-1&&0===o.length||n&&n.call(this,o)}notify(e,t){if(!this.task[e])return;const n=this.task[e];if(n[t]){const o=n[t],a=this.getData(e,t);for(const[e]of o.entries())e.call(this,a)}}}.getInstance(),vp=class e extends xu{constructor(){super(),this.languages=null,this.keyMap={}}static getInstance(){return e.instance||(e.instance=new e),e.instance}provideLanguages(e){var t;Iu||(this.languages=e,(null===(t=e["zh-CN"])||void 0===t?void 0:t.Chat)&&this.setKeyMap(e["zh-CN"]))}useI18n(e){var t;if(Iu)return;if(!this.languages)return;const n={};for(const[a,i]of Object.entries(this.languages))n["zh_cn"===a?"zh":a]={translation:i};op.init({compatibilityJSON:"v3",lng:e||"zh",fallbackLng:"zh",detection:{order:["querystring","navigator"],caches:["localStorage","cookie"]},resources:n});let o=this.normalizeLanguageKey(e||"zh");null===(t=this.getEngine().TUIReport)||void 0===t||t.reportFeature(201,o)}changeLanguage(e){let t=this.normalizeLanguageKey(e);return this.getEngine().TUIReport.reportFeature(201,t),op.changeLanguage(e)}normalizeLanguageKey(e){return e.includes("en")?"en-us":e.includes("tw")?"zh-tw":e.includes("zh")||e.includes("cn")?"zh-cn":e.includes("ko")||e.includes("kr")?"ko-kr":e.includes("ja")||e.includes("jp")?"ja-jp":"other-"+e}t(e){if(!this.languages){let t=e;return!uu(e)&&e.indexOf(".")>-1&&(t=e.split(".").pop()||""),t}const t=this.keyMap[e];return t?op.t(t):op.t(e)}setKeyMap(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const o=t?`${t}.${n}`:n;if(e[n]&&"object"==typeof e[n]&&!Array.isArray(e[n])&&null!==e[n])this.setKeyMap(e[n],o);else{let o=t?`${t}.${e[n]}`:e[n];o=this.replaceKey(o),this.keyMap[o]=`${t}.${n}`}}}replaceKey(e){return e.startsWith("Chat")?e.replace("Chat","TUIChat"):e.startsWith("Conversation")?e.replace("Conversation","TUIConversation"):e.startsWith("Message")?e.replace("Message","message.tip"):e.startsWith("Call")?e.replace("Call","message.custom"):e}}.getInstance(),_p=class e extends xu{constructor(){super(),this.serv="TUIConversationService"}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.CONVERSATION_LIST_UPDATED,this.onConversationListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.TOTAL_UNREAD_MESSAGE_COUNT_UPDATED,this.onTotalUnreadCountUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),this.getConversationInitData()}onConversationListUpdated(e){const t=this.filterSystemConversation(e);this.getEngine().TUIStore.update(tu.CONV,"conversationList",t),this.updateCurrentConversation()}onTotalUnreadCountUpdated(e){this.getEngine().TUIStore.update(tu.CONV,"totalUnreadCount",e)}onMessageReceived(e){const t=this.getEngine(),n=this.getEngine().TUIStore.getData(tu.CONV,"conversationList");let o=!1;for(let a=0;a<e.length;a++){if(e[a].type!==t.TYPES.MSG_GRP_SYS_NOTICE)continue;const{operationType:i}=e[a].payload,r=`GROUP${e[a].to}`,s=4===i||5===i||8===i,l=2===i||6===i||7===i;if(s||l)for(let e=0;e<n.length;e++)if(n[e].type!==t.TYPES.CONV_C2C&&n[e].conversationID===r){if(s){this.getEngine().TUIStore.update(tu.CONV,"operationTypeMap",{conversationID:r,operationType:i}),o=!0;break}if(l&&n[e].operationType>0){this.getEngine().TUIStore.update(tu.CONV,"operationTypeMap",{conversationID:r,operationType:0}),o=!0;break}}}if(o){this.getEngine().TUIStore.update(tu.CONV,"conversationList",n);const e=this.getEngine().TUIStore.getData(tu.CONV,"currentConversationID")||"",t=this.findConversation(e);t&&this.getEngine().TUIStore.update(tu.CONV,"currentConversation",t)}}getConversationInitData(){const e=this.getEngine();e.chat.isReady()&&e.chat.getConversationList().then((t=>{const{conversationList:n,isSyncCompleted:o}=t.data;if(n.length>0){this.onConversationListUpdated(n);const t=e.chat.getTotalUnreadMessageCount();this.onTotalUnreadCountUpdated(t)}}))}switchConversation(e){return Xc(this,0,void 0,(function*(){this.serv;const t=this.getEngine();if(!e)return t.TUIStore.reset(tu.CHAT,["messageList","isCompleted","nextReqMessageID"]),t.TUIStore.update(tu.CONV,"currentConversationID",""),t.TUIStore.update(tu.CONV,"currentConversation",null),Promise.resolve({});if(!e.startsWith(t.TYPES.CONV_C2C)&&!e.startsWith(t.TYPES.CONV_GROUP))return Promise.reject({code:ru.INVALID_CONV_ID,message:lu.INVALID_CONV_ID});const n=t.TUIStore.getData(tu.CONV,"currentConversationID");if(n&&n===e)return this.setMessageRead(n),Promise.resolve({code:ru.CONV_ID_SAME,message:lu.CONV_ID_SAME});const o=yield this.getConversationModel(e);return uu(o)?Promise.reject({code:ru.CONV_NOT_EXIST,message:lu.CONV_NOT_EXIST}):(n&&this.setMessageRead(n),e&&this.setMessageRead(e),t.TUIStore.reset(tu.CHAT,["messageList","isCompleted","nextReqMessageID"]),t.TUIStore.update(tu.CONV,"currentConversationID",e),t.TUIStore.update(tu.CONV,"currentConversation",o),Promise.resolve(o))}))}getConversationModel(e){return Xc(this,0,void 0,(function*(){let t=this.findConversation(e);if(uu(t))try{const n=yield this.getConversationProfile(e);n.data&&n.data.conversation&&(t=new Gu(n.data.conversation))}catch(n){t=void 0}return t}))}findConversation(e){let t;const n=this.getEngine().TUIStore.getData(tu.CONV,"conversationList");for(let o=0;o<n.length;o++)if(n[o].conversationID===e){t=n[o];break}return t}updateCurrentConversation(){const e=this.getEngine(),t=e.TUIStore.getData(tu.CONV,"currentConversationID"),n=this.findConversation(t);n&&e.TUIStore.update(tu.CONV,"currentConversation",n)}getConversationList(){return this.getEngine().chat.getConversationList()}getConversationProfile(e){return this.getEngine().chat.getConversationProfile(e)}deleteConversation(e){return this.getEngine().chat.deleteConversation(e).then((t=>{const n=this.getEngine().TUIStore.getData(tu.CONV,"currentConversationID");return e===n&&(this.getEngine().TUIStore.update(tu.CONV,"currentConversationID",""),this.getEngine().TUIStore.update(tu.CONV,"currentConversation",null)),t}))}pinConversation(e){return this.getEngine().chat.pinConversation(e)}muteConversation(e){return this.getEngine().chat.setMessageRemindType(e)}clearHistoryMessage(e){return this.getEngine().chat.clearHistoryMessage(e).then((e=>(this.getEngine().TUIStore.update(tu.CHAT,"messageList",[]),this.getEngine().TUIStore.update(tu.CHAT,"nextReqMessageID",""),this.getEngine().TUIStore.update(tu.CHAT,"isCompleted",!0),e)))}setMessageRead(e){return this.getEngine().chat.setMessageRead({conversationID:e})}setConversationDraft(e){const{conversationID:t,draftInfo:n}=e;let o="";return n&&(o=JSON.stringify(n)),this.getEngine().chat.setConversationDraft({conversationID:t,draftText:o}).then((e=>{const{conversation:t}=e.data;this.updateConversation(t)}))}updateConversation(e){let t=!1;const n=this.getEngine().TUIStore.getData(tu.CONV,"conversationList");for(let o=0;o<n.length;o++)if(n[o].conversationID===e.conversationID){n[o]=e,t=!0;break}t&&this.getEngine().TUIStore.update(tu.CONV,"conversationList",n)}filterSystemConversation(e){return e.filter((e=>e.type!==this.getEngine().TYPES.CONV_SYSTEM))}}.getInstance(),yp=class e extends xu{constructor(){super(),this.userProfileHandler=new ap(this),this.userStatusHandler=new cp(this)}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.KICKED_OUT,this.onKickedOut.bind(this)),e.eventCenter.addEvent(e.EVENT.NET_STATE_CHANGE,this.onNetStateChange.bind(this)),this.userProfileHandler.init(),this.userStatusHandler.init(),this.initMessageReadReceipt()}onKickedOut(e){this.getEngine().TUIStore.update(tu.USER,"kickedOut",e.type)}onNetStateChange(e){this.getEngine().TUIStore.update(tu.USER,"netStateChange",e.state)}initMessageReadReceipt(){const e=rp("displayMessageReadReceipt")||!0;this.getEngine().TUIStore.update(tu.USER,"displayMessageReadReceipt",e)}switchUserStatus(e){return this.userStatusHandler.switchUserStatus(e)}switchMessageReadStatus(e){this.getEngine().TUIStore.update(tu.USER,"displayMessageReadReceipt",e),ip("displayMessageReadReceipt",e)}getUserProfile(e){return this.userProfileHandler.getUserProfile(e)}updateMyProfile(e){return this.userProfileHandler.updateMyProfile(e)}addToBlacklist(e){return this.userProfileHandler.addToBlacklist(e)}removeFromBlacklist(e){return this.userProfileHandler.removeFromBlacklist(e)}getUserStatus(e){return this.userStatusHandler.getUserStatus(e)}subscribeUserStatus(e){return this.userStatusHandler.subscribeUserStatus(e)}unsubscribeUserStatus(e){return this.userStatusHandler.unsubscribeUserStatus(e)}}.getInstance(),Ip=class e extends xu{constructor(){super(),this.serv="TUIChatService",this.messageHandler=new up(this),this.typingHandler=new dp(this),this.readReceiptHandler=new pp(this),this.isSwitching=!0,this.delayGetHoppingFunction=void 0,this.hoppingConfigMap=new Map}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_MODIFIED,this.onMessageModified.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_REVOKED,this.onMessageRevoked.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_READ_BY_PEER,this.onMessageReadByPeer.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_REACTIONS_UPDATED,this.onMessageReactionsUpdated.bind(this)),this.onCurrentConversationIDUpdated(),this.onMessageSource(),this.readReceiptHandler.init()}onMessageReceived(e){this.updateMessageList(e,"received"),this.getEngine().TUIStore.update(tu.CHAT,"newMessageList",e)}onMessageModified(e){this.updateMessageList(e,"edit")}onMessageRevoked(e){this.updateMessageList(e,"edit")}onMessageReadByPeer(e){this.updateMessageList(e,"edit")}onMessageReactionsUpdated(e){this.updateMessageReactionList([e])}onCurrentConversationIDUpdated(){const e=this.getEngine();e.TUIStore.watch(tu.CONV,{currentConversationID:t=>{this.isSwitching=!0,this.delayGetHoppingFunction=void 0,this.hoppingConfigMap.clear(),e.TUIStore.reset(tu.CHAT),this.typingHandler.clearTypingStatus(),this.typingHandler.sendTypingEnd(),Vu(t)||this.getMessageList().finally((()=>{this.isSwitching=!1,this.delayGetHoppingFunction&&this.delayGetHoppingFunction()}))}})}onMessageSource(){const e=this.getEngine();e.TUIStore.watch(tu.CHAT,{messageSource:t=>{const n=this.getStoreData(tu.CONV,"currentConversationID");if(!n||t&&t.conversationID!==n)return;if(uu(t))return this.hoppingConfigMap.clear(),e.TUIStore.update(tu.CHAT,"messageList",[]),e.TUIStore.update(tu.CHAT,"nextReqMessageID",""),e.TUIStore.update(tu.CHAT,"isCompleted",!1),void this.getMessageList();const o=this.getStoreData(tu.CHAT,"messageList");o&&o.find((e=>t&&e.ID===t.ID))||(this.isSwitching?this.delayGetHoppingFunction=this.getMessageListHoppingForDown:this.getMessageListHoppingForDown())}})}getMessageListHoppingForDown(){const e=this.getStoreData(tu.CHAT,"messageList"),{conversationID:t,sequence:n,time:o,ID:a}=this.getStoreData(tu.CHAT,"messageSource");if(e&&e.find((e=>a&&e.ID===a)))return;const i=this.getEngine();i.TUIStore.update(tu.CHAT,"messageList",[]),i.TUIStore.update(tu.CHAT,"nextReqMessageID",""),i.TUIStore.update(tu.CHAT,"isCompleted",!1),this.getMessageListHopping({conversationID:t,sequence:n,time:o,direction:1})}getStoreData(e,t){return this.getEngine().TUIStore.getData(e,t)}sendMessage(e,t){this.updateMessageList([e],"send");const n=this.getEngine().chat.sendMessage(e,t);return this.getResponse(n)}getResponse(e,t=!0,n=!0){return e.then((e=>{const n=e.data.messageList?e.data.messageList:[e.data.message];return t&&this.updateMessageList(n,"edit"),e})).catch((e=>{var t;return n&&(null===(t=null==e?void 0:e.data)||void 0===t?void 0:t.message)&&this.updateMessageList([e.data.message],"edit"),Promise.reject(e)}))}updateMessageList(e,t=""){if(this.getStoreData(tu.CHAT,"messageSource")&&"unshift"!==t&&"edit"!==t)return;const n=this.getStoreData(tu.CHAT,"messageList"),o=this.updateTargetMessageList(e,n,t);this.getEngine().TUIStore.update(tu.CHAT,"messageList",o)}updateTargetMessageList(e,t,n=""){const o=this.getStoreData(tu.CONV,"currentConversationID");let a=e.filter((e=>e.conversationID===o));if(a=this.handleC2CCallSignaling(a),!n||0===a.length)return t;const i=t||[];let r=[];if("send"===n||"push"===n){const e=this.getStoreData(tu.CHAT,"userInfo");Object.keys(e).length>0&&this.updateLocalMessage(a,e)}switch(n){case"edit":for(const e of t){const t=a.find((t=>t.ID===e.ID));r.push(t||e)}break;case"resend":r=i.filter((e=>e.ID!==a[0].ID)).concat(a);break;case"send":r=i.concat(this.typingHandler.filterTypingMessage(a));break;case"push":r=i.concat(this.typingHandler.filterTypingMessage(a)),this.getEngine().chat.setMessageRead({conversationID:o});break;case"received":r=i.concat(this.typingHandler.filterTypingMessage(a)),r=this.sortMessageList(r),this.getEngine().chat.setMessageRead({conversationID:o});break;case"unshift":r=a.filter((e=>0===i.length||!i.find((t=>t.ID===e.ID)))),r.push(...i),r=this.sortMessageList(r)}return r}enterTypingState(){this.getStoreData(tu.APP,"enableTyping")&&this.sendTyping(!0)}leaveTypingState(){this.getStoreData(tu.APP,"enableTyping")&&this.sendTyping(!1)}sendTyping(e){const t=this.getEngine(),n=this.getStoreData(tu.CONV,"currentConversationID");if(!n.startsWith(t.TYPES.CONV_C2C))return;const o=n.replace(t.TYPES.CONV_C2C,"");if(e){const e=this.getStoreData(tu.CHAT,"messageList").filter((e=>"in"===e.flow));if(0===e.length)return;const t=1e3*e[e.length-1].time;if((new Date).getTime()-t>3e4)return}this.typingHandler.sendTyping(e,o)}quoteMessage(e){var t;return this.getEngine().TUIStore.update(tu.CHAT,"quoteMessage",{message:e,type:"quote"}),null===(t=this.getEngine().TUIReport)||void 0===t||t.reportFeature(205),e}replyMessage(e){return this.getEngine().TUIStore.update(tu.CHAT,"quoteMessage",{message:e,type:"reply"}),e}getCurrentConvInfo(){const{conversationID:e="",type:t}=this.getStoreData(tu.CONV,"currentConversation")||{};return{to:e.replace(t,""),conversationType:t}}t(e){return this.getEngine().TUITranslate.t(e)||e}getMessageAbstractAndType(e){var t,n;const o=this.getEngine(),a={abstract:"",type:0};switch(e.type){case o.TYPES.MSG_TEXT:a.abstract=null===(t=null==e?void 0:e.payload)||void 0===t?void 0:t.text,a.type=1;break;case o.TYPES.MSG_CUSTOM:a.abstract="[自定义消息]",a.type=2;break;case o.TYPES.MSG_IMAGE:a.abstract="[图片]",a.type=3;break;case o.TYPES.MSG_AUDIO:a.abstract="[语音]",a.type=4;break;case o.TYPES.MSG_VIDEO:a.abstract="[视频]",a.type=5;break;case o.TYPES.MSG_FILE:a.abstract="[文件]",a.type=6;break;case o.TYPES.MSG_LOCATION:a.type=7;break;case o.TYPES.MSG_FACE:a.abstract="[表情]",a.type=8;break;case o.TYPES.MSG_GRP_TIP:a.type=9;break;case o.TYPES.MSG_MERGER:a.abstract=null===(n=null==e?void 0:e.payload)||void 0===n?void 0:n.title,a.type=10}return a}genMessageReply(e,t){if("reply"!==t&&"quote"!==t)return{};const{abstract:n,type:o}=this.getMessageAbstractAndType(e),a={messageAbstract:n,messageSender:e.nick||e.from,messageID:e.ID},i=Object.assign(Object.assign({},a),{messageType:o,messageTime:null==e?void 0:e.time,messageSequence:null==e?void 0:e.sequence,version:1});if("reply"===t&&(i.messageRootID=e.ID,e.cloudCustomData)){const t=hu(e.cloudCustomData);t.messageReply&&t.messageReply.messageRootID&&(i.messageRootID=t.messageReply.messageRootID)}return{messageReply:i,messageReplyRoot:a}}getMessageInfo(e,t,n){const{messageReply:o,messageReplyRoot:a}=this.genMessageReply(t,n),i=e.cloudCustomData?hu(e.cloudCustomData):{};let r;if(i.messageReply?i.messageReply=Object.assign(Object.assign({},o),i.messageReply):i.messageReply=o,"reply"===n){const{messageRootID:e}=o;r=this.getEngine().chat.findMessage(e);const t=(null==r?void 0:r.cloudCustomData)?hu(r.cloudCustomData):{};t.messageReplies||(t.messageReplies={}),s=t.messageReplies.replies,("function"==typeof Array.isArray?Array.isArray(s):"array"===Object.prototype.toString.call(s).match(/^\[object (.*)\]$/)[1].toLowerCase())||(t.messageReplies.replies=[]),t.messageReplies.replies.push(a),r.cloudCustomData=JSON.stringify(t)}var s;return{cloudCustomData:JSON.stringify(i),rootMessage:r}}sendTextMessage(e,t){const n=this.getEngine(),{message:o,type:a}=this.getStoreData(tu.CHAT,"quoteMessage");let i={cloudCustomData:e.cloudCustomData||"",rootMessage:void 0};o&&(i=this.getMessageInfo(e,o,a));const r=n.chat.createTextMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{cloudCustomData:i.cloudCustomData}));return this.sendMessage(r,t).then((e=>(i.rootMessage&&this.modifyMessage(i.rootMessage),n.TUIStore.reset(tu.CHAT,["quoteMessage"],!0),e)))}sendTextAtMessage(e,t){const n=this.getEngine(),{message:o,type:a}=this.getStoreData(tu.CHAT,"quoteMessage");let i={cloudCustomData:e.cloudCustomData||"",rootMessage:void 0};o&&(i=this.getMessageInfo(e,o,a));const r=n.chat.createTextAtMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{cloudCustomData:i.cloudCustomData}));return this.sendMessage(r,t).then((e=>(i.rootMessage&&this.modifyMessage(i.rootMessage),n.TUIStore.reset(tu.CHAT,["quoteMessage"],!0),e)))}sendImageMessage(e,t){const n=this.getEngine().chat.createImageMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendAudioMessage(e,t){const n=this.getEngine().chat.createAudioMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendVideoMessage(e,t){const n=this.getEngine().chat.createVideoMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendCustomMessage(e,t){const n=this.getEngine().chat.createCustomMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}sendFaceMessage(e,t){const n=this.getEngine().chat.createFaceMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}sendFileMessage(e,t){const n=this.getEngine().chat.createFileMessage(Object.assign(Object.assign(Object.assign({},this.getCurrentConvInfo()),e),{onProgress:e=>{this.onProgress(n.ID,e)}}));return this.sendMessage(n,t)}sendLocationMessage(e,t){const n=this.getEngine().chat.createLocationMessage(Object.assign(Object.assign({},this.getCurrentConvInfo()),e));return this.sendMessage(n,t)}onProgress(e,t){const n=this.getEngine().TUIStore.getMessageModel(e);n&&(t-n.progress>=.1||1===t)&&(n.progress=t,this.updateMessageList([n],"edit"))}setAbstractList(e){const t=this.getEngine(),n=e.nick||e.from;let o="";switch(e.type){case t.TYPES.MSG_TEXT:o=e.payload.text||"",o.length>20&&(o=o.slice(0,20));break;case t.TYPES.MSG_MERGER:o=`${this.t("TUIChat.[聊天记录]")}`;break;case t.TYPES.MSG_IMAGE:o=`${this.t("TUIChat.[图片]")}`;break;case t.TYPES.MSG_AUDIO:o=`${this.t("TUIChat.[音频]")}`;break;case t.TYPES.MSG_VIDEO:o=`${this.t("TUIChat.[视频]")}`;break;case t.TYPES.MSG_CUSTOM:o=`${this.t("TUIChat.[自定义消息]")}`;break;case t.TYPES.MSG_FILE:o=`${this.t("TUIChat.[文件]")}`;break;case t.TYPES.MSG_FACE:o=`${this.t("TUIChat.[动画表情]")}`}return`${n}: ${o}`}genMergerForwardPayload(e,t){const{abstractList:n=[],compatibleText:o="",title:a}=t;return 0===n.length&&e.forEach((e=>{n.push(this.setAbstractList(e))})),{messageList:e,title:a,abstractList:n,compatibleText:o||this.t("TUIChat.请升级IMSDK到v2.10.1或更高版本查看此消息")}}genSendMergerForwardMessage(e){const{conversationList:t,messageList:n,params:o,mergeInfo:a,sendMessageOptions:i}=e,r=[];for(let s=0;s<t.length;s++){const{conversationID:e,type:l}=t[s],c=Object.assign({to:e.replace(`${l}`,""),conversationType:l,payload:this.genMergerForwardPayload(n,a)},o),u=this.getEngine().chat.createMergerMessage(c);r.push(this.sendMessage(u,i))}return r}genTitle(e,t){const{nick:n,from:o,to:a}=e;return`${n||o} ${this.t("TUIChat.和")} ${t||a} ${this.t("TUIChat.的聊天记录")}`}genMergeInfo(e){var t;return Xc(this,0,void 0,(function*(){const{messageList:n,mergeInfo:o}=e;if(o.title)return o;if(n[0].conversationType===this.getEngine().TYPES.CONV_GROUP)return o.title=this.t("TUIChat.群聊的聊天记录"),o;try{const{data:e=[]}=yield this.getEngine().TUIUser.getUserProfile({userIDList:[n[0].to]});o.title=this.genTitle(n[0],null===(t=e[0])||void 0===t?void 0:t.nick)}catch(a){o.title=this.genTitle(n[0])}return o}))}sendMergerForwardMessage(e){return Xc(this,0,void 0,(function*(){return e.mergeInfo=yield this.genMergeInfo(e),Promise.all(this.genSendMergerForwardMessage(e))}))}getOriginMessageList(e){return e.map((e=>e instanceof zu?e.getMessage():e))}sendForwardMessage(e,t,n){t=this.getOriginMessageList(t);const o=n||{},{needMerge:a=!1,params:i={},mergeInfo:r={}}=o,s=Jc(o,["needMerge","params","mergeInfo"]);if(a)return this.sendMergerForwardMessage({conversationList:e,messageList:t,params:i,mergeInfo:r,sendMessageOptions:s});const l=[];for(let c=0;c<e.length;c++){const{conversationID:n,type:o}=e[c],a=Object.assign({to:n.replace(`${o}`,""),conversationType:o},i),r=s[n]||s;for(let e=0;e<t.length;e++){Reflect.set(a,"payload",t[e]);const n=this.getEngine().chat.createForwardMessage(a);l.push(this.sendMessage(n,r))}}return Promise.all(l)}revokeMessage(e){const t=this.getEngine().chat.revokeMessage(e);return this.getResponse(t,!0,!1)}resendMessage(e){e.status="unSend",this.updateMessageList([e],"resend");const t=this.getEngine().chat.resendMessage(e);return this.getResponse(t,!0,!0)}deleteMessage(e){const t=this.getEngine().chat.deleteMessage(e);return this.getResponse(t,!0,!1)}setMessageExtensions(e,t){return this.getEngine().chat.setMessageExtensions(e,t)}getMessageExtensions(e){return this.getEngine().chat.getMessageExtensions(e)}deleteMessageExtensions(e,t){return this.getEngine().chat.deleteMessageExtensions(e,t)}modifyMessage(e){const t=this.getEngine().chat.modifyMessage(e);return this.getResponse(t,!0,!1).catch((e=>{const{code:t=0,data:n={}}=e.code;throw t===iu.MSG_MODIFY_CONFLICT||t===iu.MSG_MODIFY_DISABLED_IN_AVCHATROOM||iu.MODIFY_MESSAGE_NOT_EXIST,e}))}getMessageList(e={conversationID:this.getStoreData(tu.CONV,"currentConversationID"),nextReqMessageID:this.getStoreData(tu.CHAT,"nextReqMessageID")}){const t=this.getEngine();if(!t.chat.isReady())return Promise.reject({code:ru.GET_MSG_LIST_ERROR,message:lu.GET_MSG_LIST_ERROR});if(this.getStoreData(tu.CHAT,"isCompleted"))return Promise.resolve({data:{messageList:[],nextReqMessageID:"",isCompleted:!0}});const n=this.getStoreData(tu.CHAT,"messageSource"),o=this.hoppingConfigMap.get("nextMessageSeq"),a=this.hoppingConfigMap.get("nextMessageTime"),i=o||a;return n&&n.conversationID===(null==e?void 0:e.conversationID)&&i?this.getMessageListHopping():t.chat.getMessageList(e).then((e=>{var n;const{messageList:o,nextReqMessageID:a,isCompleted:i}=e.data,r=this.getStoreData(tu.CHAT,"userInfo");Object.keys(r).length>0&&this.updateLocalMessage(o,r),this.updateMessageList(o,"unshift"),t.TUIStore.update(tu.CHAT,"nextReqMessageID",a),t.TUIStore.update(tu.CHAT,"isCompleted",i);const s=null===(n=o[0])||void 0===n?void 0:n.conversationID,{operationType:l=0}=this.getEngine().TUIStore.getConversationModel(s)||{};return 0===l&&(this.getMessageReactions({messageList:o}),this.readReceiptHandler.getMessageReadReceiptList(o)),e})).catch((e=>Promise.reject(e)))}getMessageListHopping(e){var t;void 0===e&&(e={conversationID:null===(t=this.getStoreData(tu.CHAT,"messageSource"))||void 0===t?void 0:t.conversationID,sequence:this.hoppingConfigMap.get("nextMessageSeq"),time:this.hoppingConfigMap.get("nextMessageTime")});const n=this.getEngine();return n.chat.getMessageListHopping(e).then((t=>{const{messageList:o,nextMessageSeq:a,nextMessageTime:i,isCompleted:r}=t.data,s=1===e.direction?e.sequence:a,l=1===e.direction?e.time:i;return this.updateMessageList(o,"unshift"),this.delayGetHoppingFunction=void 0,this.hoppingConfigMap.set("nextMessageSeq",s),this.hoppingConfigMap.set("nextMessageTime",l),n.TUIStore.update(tu.CHAT,"isCompleted",r),t})).catch((e=>Promise.reject(e)))}sendMessageReadReceipt(e){return this.readReceiptHandler.sendMessageReadReceipt(e)}getGroupMessageReadMemberList(e){return this.readReceiptHandler.getGroupMessageReadMemberList(e).then((e=>{const{isCompleted:t,cursor:n,messageID:o,unreadUserIDList:a,readUserIDList:i}=e.data,r={code:0,data:{cursor:n,isCompleted:t,messageID:o,unreadUserInfoList:[],readUserInfoList:[]}},s=[...a,...i];return 0===s.length?r:this.getEngine().TUIUser.getUserProfile({userIDList:s}).then((e=>(a.length>0?e.data.forEach((e=>{const{userID:t,nick:n="",avatar:o=""}=e;r.data.unreadUserInfoList.push({userID:t,nick:n,avatar:o})})):e.data.forEach((e=>{const{userID:t,nick:n="",avatar:o=""}=e;r.data.readUserInfoList.push({userID:t,nick:n,avatar:o})})),r)))}))}downloadMergedMessages(e){return this.getEngine().chat.downloadMergerMessage(e)}setTranslationLanguage(e){this.getEngine().TUIStore.update(tu.USER,"targetLanguage",e)}translateText(e){const t=this.getStoreData(tu.USER,"targetLanguage"),n=Object.assign({targetLanguage:t,sourceLanguage:"auto"},e);return this.getEngine().chat.translateText(n)}searchCloudMessages(e){const t=this.getStoreData(tu.CONV,"conversationList");return this.getEngine().chat.searchCloudMessages(e).then((e=>{const{searchResultList:n}=e.data;return e.data.searchResultList=n.map((e=>{const{messageList:n,conversationID:o}=e,a=Jc(e,["messageList","conversationID"]),i=n.map((e=>new zu(e))),r=t.find((e=>e.conversationID===o));return Object.assign(Object.assign({},a),{messageList:i.sort(((e,t)=>t.time-e.time)),conversation:r})})),e}))}addMessageReaction(e,t){return this.getEngine().chat.addMessageReaction(e.getMessage(),t)}removeMessageReaction(e,t){return this.getEngine().chat.removeMessageReaction(e.getMessage(),t)}getMessageReactions(e){const{messageList:t=[]}=e;this.getStoreData(tu.APP,"enabledEmojiPlugin")&&t.length>0&&this.getEngine().chat.getMessageReactions(e).then((e=>{const t=e.data.resultList||e.data;this.updateMessageReactionList(t)})).catch((()=>{}))}getAllUserListOfMessageReaction(e){var t;return this.getEngine().chat.getAllUserListOfMessageReaction(Object.assign(Object.assign({},e),{message:null===(t=null==e?void 0:e.message)||void 0===t?void 0:t.getMessage()}))}updateMessageReactionList(e){const t=[];e.forEach((e=>{const{messageID:n,reactionList:o}=e,a=this.getEngine().TUIStore.getMessageModel(n);if(a){const e=[];for(let t=0;t<o.length;t++){let n=!0;for(let e=0;e<a.reactionList.length;e++)if(o[t].reactionID===a.reactionList[e].reactionID){a.reactionList[e]=o[t],n=!1;break}n&&e.push(o[t])}a.reactionList.push(...e),e.length=0,t.push(a)}})),t.length>0&&this.updateMessageList(t,"edit")}convertVoiceToText(e){const{message:t,language:n="zh"}=e,o=t.getMessage();return this.getEngine().chat.convertVoiceToText({message:o,language:n})}clearHistoryMessage(e){const t=this.getEngine();return t.chat.clearHistoryMessage(e).then((e=>(t.TUIStore.update(tu.CHAT,"messageList",[]),t.TUIStore.update(tu.CHAT,"nextReqMessageID",""),t.TUIStore.update(tu.CHAT,"isCompleted",!1),e)))}updateMessageInfo(e){const t=this.getStoreData(tu.CHAT,"userInfo");this.getEngine().TUIStore.update(tu.CHAT,"userInfo",Object.assign(t,e));const n=this.getStoreData(tu.CHAT,"messageList");n.length>0&&this.updateLocalMessage(n,e)&&this.getEngine().TUIStore.update(tu.CHAT,"messageList",n)}updateLocalMessage(e,t){let n=!1;return e.forEach((e=>{if(t[e.from]){const{nick:o,nameCard:a,avatar:i}=t[e.from];o&&(e.nick=o,n=!0),a&&(e.nameCard=a,n=!0),i&&(e.avatar=i,n=!0)}})),n}handleC2CCallSignaling(e){const t=this.getEngine(),n=t.getMyUserID();return e.filter((e=>{var o,a,i,r;const{conversationType:s,type:l,payload:c}=e;let u=!0;if(s===t.TYPES.CONV_C2C&&l===t.TYPES.MSG_CUSTOM&&t.chat.getSignalingInfo(e)){const t=hu(c.data);if(1===(null==t?void 0:t.businessID)){const s=hu(t.data);if(u=!(e._isExcludedFromUnreadCount&&e._isExcludedFromLastMessage),u&&!0!==(null===(o=null==s?void 0:s.data)||void 0===o?void 0:o.consumed)){let o=null===(a=null==s?void 0:s.data)||void 0===a?void 0:a.inviter;"line_busy"!==(null==s?void 0:s.line_busy)&&"lineBusy"!==(null===(i=null==s?void 0:s.data)||void 0===i?void 0:i.message)||(o=t.inviter);const{from:l,to:c}=e;if(o!==n&&e.from===n){const t=this.getStoreData(tu.CONV,"currentConversation");e.from=c,e.to=l,e.flow="in",e.avatar=(null===(r=null==t?void 0:t.userProfile)||void 0===r?void 0:r.avatar)||""}if(o===n&&e.from!==n){const t=this.getStoreData(tu.USER,"userProfile");e.from=c,e.to=l,e.flow="out",e.avatar=null==t?void 0:t.avatar}}}}return u}))}sortMessageList(e){const{conversationType:t}=e[0];if(t===this.getEngine().TYPES.CONV_C2C)return e.sort(((e,t)=>e.time-t.time));const n=e.filter((e=>"success"===e.status)).sort(((e,t)=>e.sequence-t.sequence));for(let o=0;o<e.length;o++)"success"!==e[o].status&&n.splice(o,0,e[o]);return n}}.getInstance(),Cp=class e extends xu{constructor(){super(),this.groupMap=new Map}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.GROUP_LIST_UPDATED,this.onGroupListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.GROUP_ATTRIBUTES_UPDATED,this.onGroupAttributesUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.GROUP_COUNTER_UPDATED,this.onGroupCounterUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.MESSAGE_RECEIVED,this.onMessageReceived.bind(this)),this.getGroupInitData()}onGroupListUpdated(e){const t=this.getEngine();t.TUIStore.update(tu.GRP,"groupList",e);const n=t.TUIStore.getData(tu.GRP,"currentGroupID");e.forEach((e=>{e.groupID===n&&t.TUIStore.update(tu.GRP,"currentGroup",e)}))}onGroupAttributesUpdated(e){const t=this.getEngine(),n=t.TUIStore.getData(tu.GRP,"currentGroupID");let o=t.TUIStore.getData(tu.GRP,"groupList");const{groupID:a,groupAttributes:i}=e;n===a&&t.TUIStore.update(tu.GRP,"currentGroupAttributes",i),o=o.map((e=>(e.groupID===a&&(e.groupAttributes=i),e))),t.TUIStore.update(tu.GRP,"groupList",o)}onGroupCounterUpdated(e){const t=this.getEngine(),n=t.TUIStore.getData(tu.GRP,"currentGroupID"),o=t.TUIStore.getData(tu.GRP,"currentGroupCounters")||{};let a=t.TUIStore.getData(tu.GRP,"groupList");const{groupID:i,key:r,value:s}=e;n===i&&(o[r]=s,t.TUIStore.update(tu.GRP,"currentGroupCounters",o)),a=a.map((e=>(e.groupID===i&&(e.groupCounters=Object.assign(Object.assign({},e.groupCounters),{[r]:s})),e))),t.TUIStore.update(tu.GRP,"groupList",a)}onMessageReceived(e){const t=this.getEngine(),n=[];e.forEach((e=>{if(e.type===t.TYPES.MSG_GRP_TIP){const{payload:n}=e,{operationType:o,userIDList:a}=n;switch(o){case t.TYPES.GRP_TIP_MBR_JOIN:this.addMemberList(a);break;case t.TYPES.GRP_TIP_MBR_QUIT:case t.TYPES.GRP_TIP_MBR_KICKED_OUT:this.removeMemberList(a);break;case t.TYPES.GRP_TIP_MBR_SET_ADMIN:case t.TYPES.GRP_TIP_MBR_CANCELED_ADMIN:this.updateGroupMember(a);break;case t.TYPES.GRP_TIP_GRP_PROFILE_UPDATED:break;case t.TYPES.GRP_TIP_MBR_PROFILE_UPDATED:case t.TYPES.GRP_TIP_BAN_AVCHATROOM_MEMBER:case t.TYPES.GRP_TIP_UNBAN_AVCHATROOM_MEMBER:this.updateGroupMember(a)}}e.type===t.TYPES.MSG_GRP_SYS_NOTICE&&n.push(e)})),n.length>0&&t.TUIStore.update(tu.GRP,"groupSystemNoticeList",n)}getGroupInitData(){const e=this.getEngine();e.chat.isReady()&&e.chat.getGroupList().then((e=>{const{groupList:t=[]}=e.data;t.length>0&&this.onGroupListUpdated(t)}))}updateGroupMember(e){return Xc(this,0,void 0,(function*(){const t=this.getEngine().TUIStore.getData(tu.GRP,"currentGroupID");if(t){const n=yield this.getGroupMemberProfile({groupID:t,userIDList:e}),{memberList:o}=n.data;this.updateMemberList(o)}}))}resetCurrentStore(){this.getEngine().TUIStore.reset(tu.GRP,["currentGroupID","currentGroup","currentGroupAttributes","currentGroupCounters","currentGroupMemberList"],!0)}switchGroup(e){return Xc(this,0,void 0,(function*(){const t=this.getEngine();t.TUIStore.update(tu.GRP,"offset",0),t.TUIStore.update(tu.GRP,"isCompleted",!1);const n=t.TUIStore.getConversationModel(`GROUP${e}`);if((null==n?void 0:n.operationType)>0){const e=t.TUIStore.getData(tu.GRP,"currentGroup");return Promise.resolve(e)}const o=t.TUIStore.getData(tu.GRP,"currentGroupID");if(!e)return this.resetCurrentStore(),Promise.resolve({});if(o===e){const e=t.TUIStore.getData(tu.GRP,"currentGroup");return Promise.resolve(e)}this.resetCurrentStore(),t.TUIStore.update(tu.GRP,"currentGroupID",e);try{yield this.getGroupInfo(e)}catch(r){Promise.reject(r)}const a=setTimeout((()=>{this.groupMap.delete(e),clearTimeout(a)}),5e3),i=t.TUIStore.getData(tu.GRP,"currentGroup");return Promise.resolve(i)}))}getGroupInfo(e){return Xc(this,0,void 0,(function*(){const t=this.getEngine(),n=this.groupMap.get(e);if(n)return this.updateMemberList((null==n?void 0:n.memberList)||[]),t.TUIStore.update(tu.GRP,"currentGroup",n.group),t.TUIStore.update(tu.GRP,"currentGroupAttributes",n.groupAttributes||{}),void t.TUIStore.update(tu.GRP,"currentGroupCounters",n.counters||{});const o={group:{},memberList:[],groupAttributes:void 0,counters:void 0},{data:{group:a}}=yield this.getGroupProfile({groupID:e});o.group=a;const{data:{memberList:i}}=yield this.getGroupMemberList({groupID:e});o.memberList=i;const r=yield this.getGroupAttributes({groupID:e,keyList:[]}),{groupAttributes:s}=r.data;o.groupAttributes=s,t.TUIStore.update(tu.GRP,"currentGroupAttributes",s);try{const n=yield this.getGroupCounters({groupID:e,keyList:[]}),{counters:a}=n.data;o.counters=a,t.TUIStore.update(tu.GRP,"currentGroupCounters",a)}catch(l){}this.groupMap.set(e,o)}))}getGroupProfile(e){const t=this.getEngine();return t.chat.getGroupProfile(e).then((n=>Xc(this,0,void 0,(function*(){if(t.TUIStore.getData(tu.GRP,"currentGroupID")===e.groupID){const{group:e}=n.data;t.TUIStore.update(tu.GRP,"currentGroup",e)}return n}))))}updateGroupProfile(e){return this.getEngine().chat.updateGroupProfile(e)}createGroup(e){return this.getEngine().chat.createGroup(e)}dismissGroup(e){return this.getEngine().chat.dismissGroup(e)}searchGroupByID(e){const t=this.getEngine();return t.chat.searchGroupByID(e).then((e=>{const{group:n}=e.data,o=t.TUIStore.getData(tu.GRP,"groupList");return e.data.group.isJoinedGroup=o.some((e=>e.groupID===n.groupID)),e}))}joinGroup(e){return this.getEngine().chat.joinGroup(e)}quitGroup(e){return this.getEngine().chat.quitGroup(e)}getGroupApplicationList(){return this.getEngine().chat.getGroupApplicationList()}handleGroupApplication(e){return this.getEngine().chat.handleGroupApplication(e)}getGroupOnlineMemberCount(e){return this.getEngine().chat.getGroupOnlineMemberCount(e)}changeGroupOwner(e){return this.getEngine().chat.changeGroupOwner(e)}initGroupAttributes(e){return this.getEngine().chat.initGroupAttributes(e)}setGroupAttributes(e){return this.getEngine().chat.setGroupAttributes(e)}deleteGroupAttributes(e){return this.getEngine().chat.deleteGroupAttributes(e)}getGroupAttributes(e){return this.getEngine().chat.getGroupAttributes(e)}setGroupCounters(e){return this.getEngine().chat.setGroupCounters(e)}increaseGroupCounter(e){return this.getEngine().chat.increaseGroupCounter(e)}decreaseGroupCounter(e){return this.getEngine().chat.decreaseGroupCounter(e)}getGroupCounters(e){return this.getEngine().chat.getGroupCounters(e)}updateMemberList(e){const t=this.getEngine(),n=[...(t.TUIStore.getData(tu.GRP,"currentGroupMemberList")||[]).filter((t=>!e.find((e=>e.userID===t.userID)))),...e];t.TUIStore.update(tu.GRP,"currentGroupMemberList",n)}addMemberList(e){return Xc(this,0,void 0,(function*(){const t=this.getEngine().TUIStore.getData(tu.GRP,"currentGroupID");if(t)try{const n=yield this.getGroupMemberProfile({groupID:t,userIDList:e}),{memberList:o}=n.data;this.updateMemberList(o)}catch(n){const t=e.map((e=>({userID:e,avatar:"",nick:"",role:"",joinTime:0,nameCard:"",muteUntil:0,memberCustomField:[]})));this.updateMemberList(t)}}))}removeMemberList(e){const t=this.getEngine(),n=t.TUIStore.getData(tu.GRP,"currentGroupMemberList").filter((t=>-1===e.indexOf(t.userID)));t.TUIStore.update(tu.GRP,"currentGroupMemberList",n)}getGroupMemberList(e){const t=this.getEngine();if(uu(e.offset)){const n=t.TUIStore.getData(tu.GRP,"offset");e.offset=n}return t.chat.getGroupMemberList(e).then((n=>{if(t.TUIStore.getData(tu.GRP,"currentGroupID")===e.groupID){const{memberList:e,offset:o=0}=n.data;this.updateMemberList(e),t.TUIStore.update(tu.GRP,"offset",o),0===o&&t.TUIStore.update(tu.GRP,"isCompleted",!0)}return n}))}getGroupMemberProfile(e){return this.getEngine().chat.getGroupMemberProfile(e)}addGroupMember(e){const t=this.getEngine();return t.chat.addGroupMember(e).then((n=>Xc(this,0,void 0,(function*(){if(t.TUIStore.getData(tu.GRP,"currentGroupID")===e.groupID){const{successUserIDList:e,group:o}=n.data;t.TUIStore.update(tu.GRP,"currentGroup",o),this.addMemberList(e)}return n}))))}deleteGroupMember(e){const t=this.getEngine();return t.chat.deleteGroupMember(e).then((n=>{if(t.TUIStore.getData(tu.GRP,"currentGroupID")===e.groupID){const{userIDList:e,group:o}=n.data;this.removeMemberList(e),t.TUIStore.update(tu.GRP,"currentGroup",o)}return n}))}setGroupMemberMuteTime(e){return this.getEngine().chat.setGroupMemberMuteTime(e)}setGroupMemberRole(e){return this.getEngine().chat.setGroupMemberRole(e)}setGroupMemberNameCard(e){return this.getEngine().chat.setGroupMemberNameCard(e)}setGroupMemberCustomField(e){return this.getEngine().chat.setGroupMemberCustomField(e)}markGroupMemberList(e){return this.getEngine().chat.markGroupMemberList(e)}}.getInstance(),kp=class e extends xu{constructor(){super()}static getInstance(){return e.instance||(e.instance=new e),e.instance}init(){const e=this.getEngine();e.eventCenter.addEvent(e.EVENT.FRIEND_LIST_UPDATED,this.onFriendListUpdated.bind(this)),e.eventCenter.addEvent(e.EVENT.FRIEND_APPLICATION_LIST_UPDATED,this.onFriendApplicationListUpdated.bind(this)),this.getFriendInitData()}onFriendListUpdated(e){this.getEngine().TUIStore.update(tu.FRIEND,"friendList",e)}onFriendApplicationListUpdated(e){const{friendApplicationList:t,unreadCount:n=0}=e,o=this.getEngine();o.TUIStore.update(tu.FRIEND,"friendApplicationList",t),o.TUIStore.update(tu.FRIEND,"friendApplicationUnreadCount",n)}getFriendInitData(){const e=this.getEngine();e.chat.isReady()&&(e.chat.getFriendList().then((e=>{const t=e.data||[];t.length>0&&this.onFriendListUpdated(t)})),e.chat.getFriendApplicationList().then((e=>{this.onFriendApplicationListUpdated(e.data)})))}getFriendList(){return this.getEngine().chat.getFriendList()}getFriendRemark(e){const t=this.getEngine().TUIStore.getData(tu.FRIEND,"friendList"),n={};return e.forEach((e=>{for(let o=0;o<t.length;o++)t[o].userID!==e||(n[e]=t[o].remark)})),n}addFriend(e){return this.getEngine().chat.addFriend(e)}deleteFriend(e){return this.getEngine().chat.deleteFriend(e)}checkFriend(e){return this.getEngine().chat.checkFriend(e)}getFriendProfile(e){return this.getEngine().chat.getFriendProfile(e)}updateFriend(e){return this.getEngine().chat.updateFriend(e)}acceptFriendApplication(e){return this.getEngine().chat.acceptFriendApplication(e)}refuseFriendApplication(e){return this.getEngine().chat.refuseFriendApplication({userID:e})}deleteFriendApplication(e){return this.getEngine().chat.deleteFriendApplication(e)}setFriendApplicationRead(){return this.getEngine().chat.setFriendApplicationRead()}}.getInstance(),Ep=class e extends xu{static getInstance(){return e.instance||(e.instance=new e),e.instance}reportFeature(e,t){var n;return null===(n=this.getEngine().chat)||void 0===n?void 0:n.callExperimentalAPI("statTUIKeyFeatures",{code:e,msg:t?`${e}-${t}`:""})}}.getInstance();gp.mount(eu.TUIStore,mp),gp.mount(eu.TUITranslate,vp),gp.mount(eu.TUIConversation,_p),gp.mount(eu.TUIUser,yp),gp.mount(eu.TUIChat,Ip),gp.mount(eu.TUIGroup,Cp),gp.mount(eu.TUIFriend,kp),gp.mount(eu.TUIReport,Ep),fp(gp,gp,cu),fp(gp,_p,{deleteConversation:1,pinConversation:1,muteConversation:1,switchConversation:1,getConversationProfile:1,clearHistoryMessage:1}),fp(gp,Ip,{modifyMessage:1,revokeMessage:1,resendMessage:1,deleteMessage:1,quoteMessage:1,replyMessage:1,setMessageExtensions:1,deleteMessageExtensions:1,getMessageExtensions:1,sendTextMessage:1,sendTextAtMessage:1,sendImageMessage:1,sendAudioMessage:1,sendVideoMessage:1,sendFileMessage:1,sendCustomMessage:1,sendFaceMessage:1,sendLocationMessage:1,sendForwardMessage:1,enterTypingState:1,leaveTypingState:1,sendMessageReadReceipt:1,getGroupMessageReadMemberList:1,getMessageList:1,downloadMergedMessages:1,setTranslationLanguage:1,translateText:1,searchCloudMessages:1,addMessageReaction:1,removeMessageReaction:1,getMessageReactions:1,getAllUserListOfMessageReaction:1}),fp(gp,Cp,{switchGroup:1,getGroupProfile:1,updateGroupProfile:1,createGroup:1,dismissGroup:1,searchGroupByID:1,joinGroup:1,quitGroup:1,getGroupApplicationList:1,handleGroupApplication:1,getGroupOnlineMemberCount:1,changeGroupOwner:1,initGroupAttributes:1,setGroupAttributes:1,deleteGroupAttributes:1,getGroupAttributes:1,setGroupCounters:1,increaseGroupCounter:1,decreaseGroupCounter:1,getGroupCounters:1,getGroupMemberList:1,getGroupMemberProfile:1,addGroupMember:1,deleteGroupMember:1,setGroupMemberMuteTime:1,setGroupMemberRole:1,setGroupMemberNameCard:1,setGroupMemberCustomField:1,markGroupMemberList:1}),fp(gp,yp,{switchUserStatus:1,switchMessageReadStatus:1,getUserProfile:1,updateMyProfile:1,addToBlacklist:1,removeFromBlacklist:1}),fp(gp,kp,{getFriendList:1,addFriend:1,deleteFriend:1,checkFriend:1,getFriendProfile:1,updateFriend:1,acceptFriendApplication:1,refuseFriendApplication:1,deleteFriendApplication:1,setFriendApplicationRead:1}),fp(gp,Ep,cu);const Tp="undefined"!=typeof wx&&"function"==typeof wx.getSystemInfoSync&&Boolean(wx.getSystemInfoSync().fontSizeSetting),Sp="undefined"!=typeof uni&&"undefined"==typeof window,Mp="undefined"!=typeof uni,wp=("undefined"!=typeof uni||"undefined"!=typeof window)&&!(Tp||Sp),bp=Tp?wx:Mp?uni:"undefined"!=typeof window?window:{},Dp=wp&&window&&window.navigator&&window.navigator.userAgent||"",Np=/Android/i.test(Dp),Rp=/(?:Windows Phone)/.test(Dp),Lp=/(?:SymbianOS)/.test(Dp),Ap=/OpenHarmony/i.test(Dp),Op=wp&&("ontouchstart"in window||navigator.maxTouchPoints>0)&&function(){if(wp){if(/Tablet|Pad/i.test(Dp))return!0;if(180===window.orientation||0===window.orientation)return window.innerWidth>=768&&window.innerHeight>=1024;if(90===window.orientation||-90===window.orientation)return window.innerWidth>=1024&&window.innerHeight>=768}return!1}(),Pp=/iPhone/i.test(Dp)||/iPod/i.test(Dp),Up=Tp,xp=Np||Rp||Lp||Pp||Op||Ap,Vp=wp&&!xp,Bp=Sp&&!Tp;function Gp(){let e="";return Vp?e="pc":xp?e="h5":Up?e="wechat":Bp&&(e="app"),e}const Fp=new Map;function zp(e,t){if(!e)return Promise.reject(new Error(`getBoundingClientRect get error selector ${typeof e}.`));if(window||document){const t="object"==typeof e?e:document.querySelector(e);if(!t)return Promise.reject(new Error(`getBoundingClientRect can't find ${e} dom.`));const n=t.getBoundingClientRect();return Promise.resolve({id:t.id,top:n.top,left:n.left,right:n.right,bottom:n.bottom,width:n.width,height:n.height,x:n.x,y:n.y})}if(Mp){const n=uni.createSelectorQuery().in(Fp.get(t));return new Promise(((t,o)=>{n.select(e).boundingClientRect((e=>{e&&t(e)})).exec(),setTimeout((()=>o(new Error(`getBoundingClientRect ${e} timeout.`))),500)}))}return Promise.reject(new Error("getBoundingClientRect occur error"))}function Hp(e,t){if(!Mp&&window){const t=document.querySelector(e);return t?Promise.resolve({id:t.id,scrollTop:t.scrollTop,scrollLeft:t.scrollLeft,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight}):Promise.reject(new Error(`getScrollInfo can't find ${e} dom.`))}if(Mp){const n=uni.createSelectorQuery().in(Fp.get(t));return new Promise(((t,o)=>{n.select(e).scrollOffset((e=>{e&&t(e)})).exec(),setTimeout((()=>o(new Error(`getScrollInfo ${e} timeout.`))),500)}))}return Promise.reject(new Error("getScrollInfo occur error"))}const jp={PROTOCOLS:["javascript:","vbscript:","file:","about:","ftp:","ws:","wss:","mailto:","tel:","sms:","gopher:","data:","blob:"],HTML_TAGS:["<script","<img","<iframe","<object","<embed","<video","<audio","<link","<meta","<style","<form","<input","<svg","<xml","<xmp","<xsl","<base"],EVENT_HANDLERS:["onclick","onload","onerror","onmouseover","onmouseout","onfocus","onblur","onsubmit","onreset","onselect","onchange","onkeyup","onkeydown","onkeypress","ondblclick","oncontextmenu","ondrag","ondrop","onmouseenter","onmouseleave","onanimation","onafterprint","onbeforeprint","onbeforeunload","onhashchange","onmessage","onoffline","ononline","onpagehide","onpageshow","onpopstate","onresize","onstorage","onunload"],JS_FUNCTIONS:["eval(","setTimeout(","setInterval(","Function(","constructor","prototype","__proto__","window.","document.","location.","alert(","confirm(","prompt(","fetch(","XMLHttpRequest"],CSS_PATTERNS:["expression(","url(","@import","behavior:","-moz-binding"],ENCODING_SEQUENCES:["&#","\\","fromCharCode","String.fromCharCode","unescape(","escape(","encodeURI(","decodeURI(","atob(","btoa("],SPECIAL_MARKERS:["\x3c!--","--\x3e","*/>","]]>","<!ENTITY","<!DOCTYPE"],DATA_MARKERS:["base64,","0x","%0","U+","\\u","\\x"],OTHER_PATTERNS:["null","undefined","NaN","true","false","instanceof"]};function qp(e){return function(e){const t=/(?:https?:\/\/|mailto:|www\.)(?:localhost(?::\d{1,5})?|[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b)(?:[-a-zA-Z0-9()@:%_+.~#?&/=]*)/gi,n=[],o=e.split(t),a=e.match(t)||[];let i=0;return o.forEach((e=>{if(e&&n.push({type:"text",text:e}),a[i]){const e=a[i];let t=e;e.toLowerCase().startsWith("www.")&&(t="https://"+e),n.push({type:"url",text:e,url:t}),i++}})),n}(e).map((e=>{if("url"===e.type){const t=function(t,n={}){const{maxLength:o=2083,allowedProtocols:a=["http:","https:","mailto:"],allowCredentials:i=!1,allowDataUrl:r=!1}=n;if(!t||"string"!=typeof t)return"about:blank";if(t.length>o)return"about:blank";try{let n=t.replace(/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/g,"");n=n.normalize("NFKC"),n=n.replace(/\s+/g," ").trim();let o=n;const s=new Set;let l=0;for(;l<5;)try{const e=decodeURIComponent(o);if(s.has(e))break;s.add(e),o=e,l++}catch(e){break}const c=function(){const e=[],t=Object.keys(jp);for(let n=0;n<t.length;n++){const o=jp[t[n]];for(let t=0;t<o.length;t++)e.push(o[t])}return e}();for(const e of s){const t=e.toLowerCase();for(let e=0;e<c.length;e++)if(-1!==t.indexOf(c[e]))return"about:blank"}const u=function(e){const t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/);if(!t)throw new Error("Invalid URL");const n=(t[4]||"").split("@"),o=n[n.length-1];let a="",i="";if(n.length>1){const e=n[0].split(":");a=e[0]||"",i=e[1]||""}const r=o.split(":"),s=r[0],l=r[1]||"";return{href:e,protocol:(t[1]||"").toLowerCase(),host:o,hostname:s,port:l,pathname:t[5]||"",search:t[6]||"",hash:t[8]||"",username:a,password:i}}(n),d=u.protocol.replace(":","").toLowerCase()+":";let p=!1;for(let e=0;e<a.length;e++)if(a[e]===d){p=!0;break}if(!p)return"about:blank";if(!i&&(u.username||u.password))return"about:blank";if(!r&&"data:"===d)return"about:blank";if(!/^[\w\-.]+(:\d+)?$/.test(u.host))return"about:blank";const h=u.pathname+u.search+u.hash;return/^[\w\-./=?#&%+@,:()[\]]+$/.test(h)?n:"about:blank"}catch(e){return"about:blank"}}(e.url);return"about:blank"===t?{type:"text",text:e.text}:Object.assign(Object.assign({},e),{url:t})}return e}))}const Kp=new class e{constructor(){if(e.instance)return e.instance;e.instance=this,this.eventCallback=null,this.listener=null,this.button=0,this.init()}init(){wp&&(this.eventCallback=e=>{this.listener&&this.listener(e)},document.addEventListener("mousedown",this.eventCallback))}listen(e){if(wp){const{domRefs:t,ignoreDomRefs:n,handler:o,button:a=0}=e;this.button=a,this.listener=e=>{const a=Array.isArray(n)?n:[n];for(const t of a)if(t&&t.contains(e.target))return;const i=Array.isArray(t)?t:[t];for(const t of i)if(t&&t.contains(e.target)&&this.button===e.button)return;o(e),this.remove()}}}remove(){this.listener=null,this.button=-1}},Yp=e=>"function"==typeof e,$p=e=>/^(https?:\/\/(([a-zA-Z0-9]+-?)+[a-zA-Z0-9]+\.)+[a-zA-Z]+)(:\d+)?(\/.*)?(\?.*)?(#.*)?$/.test(e),Wp=e=>e&&(e=>{if("string"==typeof e)try{return!!JSON.parse(e)}catch(t){return!1}return!1})(e)?JSON.parse(e):e,Zp="pc"===Gp(),Jp="h5"===Gp(),Xp="wechat"===Gp(),Qp="app"===Gp(),eh="undefined"!=typeof uni,th=Jp||Xp||Qp;class nh{constructor(){_t.registerEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS,this),_t.registerService(nt.TUICalling.SERVICE.NAME,this),_t.registerExtension(nt.TUIChat.EXTENSION.INPUT_MORE.EXT_ID,this)}onNotifyEvent(e,t){if(e===nt.TUILogin.EVENT.LOGIN_STATE_CHANGED){let e,n,o,a;if(t===nt.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS)a=yt.getContext(),e=a.SDKAppID,n=a.userID,o=a.userSig,bp.$TUICallKit&&bp.$TUICallKit.login({SDKAppID:e,userID:n,userSig:o},(e=>{0===e.code?(oe("log","at TUIKit/plugins/extension-server/callkit.ts:32","TUICallkit login success!"),bp.$TUICallKit.enableFloatWindow(!0)):oe("error","at TUIKit/plugins/extension-server/callkit.ts:36",`TUICallkit login failed,${e.msg}`)}))}}onGetExtension(e,t){if(!bp.$TUICallKit)return oe("warn","at TUIKit/plugins/extension-server/callkit.ts:49","请检查原生插件 TencentCloud-TUICallKit 是否已集成"),[];if(e===nt.TUIChat.EXTENSION.INPUT_MORE.EXT_ID){const e=[],n={weight:1e3,text:"语音通话",icon:"https://web.sdk.qcloud.com/component/TUIKit/assets/call.png",data:{name:"voiceCall"},listener:{onClicked:e=>{this.setCallExtension(e)}}},o={weight:900,text:"视频通话",icon:"https://web.sdk.qcloud.com/component/TUIKit/assets/call-video-reverse.svg",data:{name:"videoCall"},listener:{onClicked:e=>{this.setCallExtension(e)}}};return(null==t?void 0:t.filterVoice)||e.push(n),(null==t?void 0:t.filterVideo)||e.push(o),e}}onCall(e,t){if(bp.$TUICallKit){if(e===nt.TUICalling.SERVICE.METHOD.START_CALL){const{groupID:e,userIDList:n=[],type:o,callParams:a}=t;e?bp.$TUICallKit.groupCall({groupID:e,userIDList:n,callMediaType:o,callParams:a},(e=>{0===e.code?oe("log","at TUIKit/plugins/extension-server/callkit.ts:108","TUICallkit groupCall success"):oe("error","at TUIKit/plugins/extension-server/callkit.ts:110",`TUICallkit groupCall failed,${e.msg}`)})):1===n.length&&bp.$TUICallKit.call({userID:n[0],callMediaType:o,callParams:a},(e=>{0===e.code?oe("log","at TUIKit/plugins/extension-server/callkit.ts:122","TUICallkit call success"):oe("log","at TUIKit/plugins/extension-server/callkit.ts:124",`TUICallkit call failed,${e.msg}`)}))}}else oe("warn","at TUIKit/plugins/extension-server/callkit.ts:95","请检查原生插件 TencentCloud-TUICallKit 是否已集成")}setCallExtension(e){const{groupID:t,userIDList:n=[],type:o,callParams:a}=e;try{t?bp.$TUICallKit.groupCall({groupID:t,userIDList:n,callMediaType:o,callParams:a},(e=>{0===e.code?oe("log","at TUIKit/plugins/extension-server/callkit.ts:143","TUICallkit groupCall success"):oe("log","at TUIKit/plugins/extension-server/callkit.ts:145",`TUICallkit groupCall failed,${e.msg}`)})):1===n.length&&bp.$TUICallKit.call({userID:n[0],callMediaType:o,callParams:a},(e=>{0===e.code?oe("log","at TUIKit/plugins/extension-server/callkit.ts:158","TUICallkit call success"):oe("log","at TUIKit/plugins/extension-server/callkit.ts:160",`TUICallkit call failed,${e.msg}`)}))}catch(i){bp.showToast({title:"拨打失败！",icon:"error"})}}}const oh={"[TUIEmoji_Smile]":"[Smile]","[TUIEmoji_Expect]":"[Expect]","[TUIEmoji_Blink]":"[Blink]","[TUIEmoji_Guffaw]":"[Guffaw]","[TUIEmoji_KindSmile]":"[KindSmile]","[TUIEmoji_Haha]":"[Haha]","[TUIEmoji_Cheerful]":"[Cheerful]","[TUIEmoji_Speechless]":"[Speechless]","[TUIEmoji_Amazed]":"[Amazed]","[TUIEmoji_Sorrow]":"[Sorrow]","[TUIEmoji_Complacent]":"[Complacent]","[TUIEmoji_Silly]":"[Silly]","[TUIEmoji_Lustful]":"[Lustful]","[TUIEmoji_Giggle]":"[Giggle]","[TUIEmoji_Kiss]":"[Kiss]","[TUIEmoji_Wail]":"[Wail]","[TUIEmoji_TearsLaugh]":"[TearsLaugh]","[TUIEmoji_Trapped]":"[Trapped]","[TUIEmoji_Mask]":"[Mask]","[TUIEmoji_Fear]":"[Fear]","[TUIEmoji_BareTeeth]":"[BareTeeth]","[TUIEmoji_FlareUp]":"[FlareUp]","[TUIEmoji_Yawn]":"[Yawn]","[TUIEmoji_Tact]":"[Tact]","[TUIEmoji_Stareyes]":"[StarEyes]","[TUIEmoji_ShutUp]":"[ShutUp]","[TUIEmoji_Sigh]":"[Sigh]","[TUIEmoji_Hehe]":"[Hehe]","[TUIEmoji_Silent]":"[Silent]","[TUIEmoji_Surprised]":"[Surprised]","[TUIEmoji_Askance]":"[Askance]]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[Shit]","[TUIEmoji_Monster]":"[Monster]","[TUIEmoji_Daemon]":"[Daemon]","[TUIEmoji_Rage]":"[Rage]","[TUIEmoji_Fool]":"[Fool]","[TUIEmoji_Pig]":"[Pig]","[TUIEmoji_Cow]":"[Cow]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[Skull]","[TUIEmoji_Bombs]":"[Bombs]","[TUIEmoji_Coffee]":"[Coffee]","[TUIEmoji_Cake]":"[Cake]","[TUIEmoji_Beer]":"[Beer]","[TUIEmoji_Flower]":"[Flower]","[TUIEmoji_Watermelon]":"[Watermelon]","[TUIEmoji_Rich]":"[Rich]","[TUIEmoji_Heart]":"[Heart]","[TUIEmoji_Moon]":"[Moon]","[TUIEmoji_Sun]":"[Sun]","[TUIEmoji_Star]":"[Star]","[TUIEmoji_RedPacket]":"[RedPacket]","[TUIEmoji_Celebrate]":"[Celebrate]","[TUIEmoji_Bless]":"[Bless]","[TUIEmoji_Fortune]":"[Fortune]","[TUIEmoji_Convinced]":"[Convinced]","[TUIEmoji_Prohibit]":"[Prohibit]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[Knife]","[TUIEmoji_Like]":"[Like]"},ah={"[TUIEmoji_Smile]":"[微笑]","[TUIEmoji_Expect]":"[期待]","[TUIEmoji_Blink]":"[眨眼]","[TUIEmoji_Guffaw]":"[大笑]","[TUIEmoji_KindSmile]":"[姨母笑]","[TUIEmoji_Haha]":"[哈哈哈]","[TUIEmoji_Cheerful]":"[愉快]","[TUIEmoji_Speechless]":"[无语]","[TUIEmoji_Amazed]":"[惊讶]","[TUIEmoji_Sorrow]":"[悲伤]","[TUIEmoji_Complacent]":"[得意]","[TUIEmoji_Silly]":"[傻了]","[TUIEmoji_Lustful]":"[色]","[TUIEmoji_Giggle]":"[憨笑]","[TUIEmoji_Kiss]":"[亲亲]","[TUIEmoji_Wail]":"[大哭]","[TUIEmoji_TearsLaugh]":"[哭笑]","[TUIEmoji_Trapped]":"[困]","[TUIEmoji_Mask]":"[口罩]","[TUIEmoji_Fear]":"[恐惧]","[TUIEmoji_BareTeeth]":"[龇牙]","[TUIEmoji_FlareUp]":"[发怒]","[TUIEmoji_Yawn]":"[打哈欠]","[TUIEmoji_Tact]":"[机智]","[TUIEmoji_Stareyes]":"[星星眼]","[TUIEmoji_ShutUp]":"[闭嘴]","[TUIEmoji_Sigh]":"[叹气]","[TUIEmoji_Hehe]":"[呵呵]","[TUIEmoji_Silent]":"[收声]","[TUIEmoji_Surprised]":"[惊喜]","[TUIEmoji_Askance]":"[白眼]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[便便]","[TUIEmoji_Monster]":"[怪兽]","[TUIEmoji_Daemon]":"[恶魔]","[TUIEmoji_Rage]":"[恶魔怒]","[TUIEmoji_Fool]":"[衰]","[TUIEmoji_Pig]":"[猪]","[TUIEmoji_Cow]":"[牛]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[骷髅]","[TUIEmoji_Bombs]":"[炸弹]","[TUIEmoji_Coffee]":"[咖啡]","[TUIEmoji_Cake]":"[蛋糕]","[TUIEmoji_Beer]":"[啤酒]","[TUIEmoji_Flower]":"[花]","[TUIEmoji_Watermelon]":"[瓜]","[TUIEmoji_Rich]":"[壕]","[TUIEmoji_Heart]":"[爱心]","[TUIEmoji_Moon]":"[月亮]","[TUIEmoji_Sun]":"[太阳]","[TUIEmoji_Star]":"[星星]","[TUIEmoji_RedPacket]":"[红包]","[TUIEmoji_Celebrate]":"[庆祝]","[TUIEmoji_Bless]":"[福]","[TUIEmoji_Fortune]":"[发]","[TUIEmoji_Convinced]":"[服]","[TUIEmoji_Prohibit]":"[禁]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[刀]","[TUIEmoji_Like]":"[赞]"},ih={zh_cn:{"取消":"取消","发送":"发送","系统通知":"系统通知","关闭":"关闭","确定":"确定","开始时间":"开始时间","结束时间":"结束时间","消息":"消息","通讯录":"通讯录","欢迎使用腾讯云即时通信IM":"欢迎使用腾讯云即时通信IM",TUIChat:{"【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。":"【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。","按Enter发送，Ctrl+Enter换行":"按Enter发送，Ctrl+Enter换行","表情":"[表情]","查看更多":"查看更多","撤回":"撤回","撤回了一条消息":"撤回了一条消息","打开":"打开","单击下载":"单击下载","点此投诉":"点此投诉","点击处理":"点击处理","对方正在输入":"对方正在输入...","发起群视频":"发起群视频","发起群语音":"发起群语音","发起通话":"发起通话","发送失败":"发送失败","复制":"复制","复制成功":"文本复制成功","该消息不存在":"该消息不存在","关闭阅读状态":"关闭","管理员开启全员禁言":"管理员开启全员禁言","欢迎使用TUICallKit":"欢迎使用腾讯云音视频通话组件TUICallKit ","回到最新位置":"回到最新位置","回复":"回复","回复详情":"回复详情","集成TUICallKit":"集成 TUICallKit ","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"检测到您暂未集成TUICallKit，无法体验音视频通话功能。","结束群聊":"结束群聊","进行体验":"进行体验。","经度":"经度","拒绝":"拒绝","拒绝通话":"拒绝通话","开通腾讯实时音视频服务":"开通腾讯实时音视频服务","聊天记录":"[聊天记录]","描述":"描述","内容包含敏感词汇":"内容包含敏感词汇","您":"您","您当前购买使用的套餐包暂未开通此功能":"您当前购买使用的套餐包暂未开通此功能。","您当前购买使用的套餐包暂未开通群消息已读回执功能":"您当前购买使用的套餐包暂未开通【群消息已读回执】功能，请升级至旗舰版进行体验","您当前购买使用的套餐包暂未开通在线用户列表功能":"您当前购买使用的套餐包暂未开通【在线用户列表】功能，请升级至旗舰版进行体验","您已被管理员禁言":"您已被管理员禁言","您有":"您有","请点击":"请点击","请输入消息":"请输入消息","取消":"取消","取消通话":"取消通话","全部已读":"全部已读","确定":"确定","确认重发该消息？":"确认重发该消息？","人关闭阅读状态":"人关闭阅读状态","人未读":"人未读","人已读":"人已读","删除":"删除","涉及敏感内容":"涉及敏感内容","申请加入":"申请加入","视频":"[视频]","视频通话":"视频通话","条回复":"条回复","条入群申请":"条入群申请","条新消息":"条新消息","通话时长":"通话时长","同意":"同意","图片":"[图片]","图片消息失败,无效的图片格式":"图片消息失败,无效的图片格式","纬度":"纬度","未读":"未读","位置":"[位置]","文件":"[文件]","文件不存在,请检查文件路径是否正确":"文件不存在,请检查文件路径是否正确","文件大小超出了限制,如果上传文件,最大限制是100MB":"文件大小超出了限制,如果上传文件,最大限制是100MB","文件消息失败,禁止发送违规封禁的文件":"文件消息失败,禁止发送违规封禁的文件","我":"我","无法查看":"无法查看","无法定位到原消息":"无法定位到原消息","无法收听":"无法收听","正在加载":"正在加载...","加载结束":"加载结束","无应答":"无应答","系统消息":"系统消息","消息":"message","消息或者资料中文本存在敏感内容,发送失败":"消息或者资料中文本存在敏感内容,发送失败","消息详情":"消息详情","消息长度超出限制,消息长度不要超过12K":"消息长度超出限制,消息长度不要超过12K","消息中图片存在敏感内容,发送失败":"消息中图片存在敏感内容,发送失败","选择提醒的人":"选择提醒的人","已读":"已读","已过撤回时限":"已过撤回时限","已接听":"已接听","已拒绝":"已拒绝","已同意":"已同意","引用":"引用","引用失败":"引用失败","语音":"[语音]","语音通话":"语音通话","重新编辑":"重新编辑","重新发送":"重新发送","转发":"转发","翻译":"翻译","转文字":"转文字","隐藏":"隐藏","转发给":"转发给","自定义":"[自定义消息]","自定义消息":"自定义消息","腾讯云 IM":"腾讯云 IM","空":"空","文本包含本地审核拦截词":"文本包含本地审核拦截词","按住说话":"按住说话","抬起发送":"抬起发送","抬起取消":"抬起取消","正在录音":"正在录音","继续上滑可取消":"继续上滑可取消","松开手指 取消发送":"松开手指 取消发送","此机型暂不支持复制功能":"此机型暂不支持复制功能","请开通翻译功能":"请开通翻译功能","请开通语音转文字功能":"请开通语音转文字功能","翻译中":"翻译中","转换中":"转换中","由IM提供翻译支持":"由IM提供翻译支持","所有人":"所有人","已达到表情回应上限数量":"已达到表情回应上限数量","等":"等","人":"人","返回":"返回","关闭":"关闭","多选":"多选","合并转发":"合并转发","逐条转发":"逐条转发","未选择消息":"未选择消息","引用内容已撤回":"引用内容已撤回","[草稿]":"[草稿]","[消息]":"[消息]","[文本]":"[文本]","[自定义消息]":"[自定义消息]","[图片]":"[图片]","[音频]":"[音频]","[语音]":"[语音]","[视频]":"[视频]","[文件]":"[文件]","[位置]":"[地理位置]","[地理位置]":"[地理位置]","[动画表情]":"[动画表情]","[群提示]":"[群提示]","[群提示消息]":"[群提示消息]","[聊天记录]":"[聊天记录]","[机器人自定义消息]":"[机器人自定义消息]","群聊的聊天记录":"群聊的聊天记录","和":"和","的聊天记录":"的聊天记录","请升级IMSDK到v2.10.1或更高版本查看此消息":"请升级IMSDK到v2.10.1或更高版本查看此消息","您已被管理员移出群聊":"您已被管理员移出群聊","该群聊已被解散":"该群聊已被解散","您已退出该群聊":"您已退出该群聊","您已被禁止聊天":"您已被禁止聊天"},TUIConversation:{"发起会话":"发起会话","发起单聊":"发起单聊","发起群聊":"发起群聊","请输入userID":"请输入userID","删除会话":"删除会话","删除后，将清空该聊天的消息记录":"删除后，将清空该聊天的消息记录","删除后，将清空该群聊的消息记录":"删除后，将清空该群聊的消息记录","置顶会话":"置顶会话","取消置顶":"取消置顶","消息免打扰":"消息免打扰","取消免打扰":"取消免打扰","系统通知":"系统通知","有人@我":"有人@我","@所有人":"@所有人","条":"条","我":"我","网络异常，请您检查网络设置":"网络异常，请您检查网络设置","您已被群管理员移出群聊":"您已被群管理员移出群聊","该群聊已被解散":"该群聊已被解散","您已退出该群聊":"您已退出该群聊"},TUIGroup:{"输入groupID搜索":"输入groupID搜索","群名称":"群名称","群ID":"群ID","加入群聊":"加入群聊","解散群聊":"解散群聊","退出群聊":"退出群聊","群类型":"群类型","请填写验证信息":"请填写验证信息","申请加入":"申请加入","已申请":"已申请","群公告":"群公告","群成员":"群成员","群管理":"群管理","好友工作群":"好友工作群","陌生人社交群":"陌生人社交群","临时会议群":"临时会议群","直播群":"直播群","社群":"社群","自由加入":"自由加入","需要验证":"需要验证","禁止加群":"禁止加群","人":"人","群头像":"群头像","加群方式":"加群方式","转让群组":"转让群组","退出群组":"退出群组","群管理员":"群管理员","全员禁言":"全员禁言","全员禁言开启后，只允许群主和管理员发言。":"全员禁言开启后，只允许群主和管理员发言。","单独禁言人员":"单独禁言人员","删除成员":"删除成员","确定从群聊中删除该成员？":"确定从群聊中删除该成员？","确定从群聊中删除所选成员？":"确定从群聊中删除所选成员？","暂无公告":"暂无公告","发布":"发布","编辑":"编辑","查看更多":"查看更多","管理员":"管理员","群主":"群主","我":"我","确认":"确认","添加成员":"添加成员","新增管理员":"新增管理员","移除管理员":"移除管理员","新增禁言用户":"新增禁言用户","移除禁言用户":"移除禁言用户","修改群聊名称":"修改群聊名称","修改群聊名称后，将在群内通知其他成员":"修改群聊名称后，将在群内通知其他成员","仅限中文、字母、数字和下划线，2-20个字":"仅限中文、字母、数字和下划线，2-20个字","请先注册 TUIGroup 模块":"请先注册 TUIGroup 模块","该用户不存在":"该用户不存在","该用户不在群组内":"该用户不在群组内","添加群聊":"添加群聊","该群组不存在":"该群组不存在","创建群聊，请注册 TUIGroup 模块":"创建群聊，请注册 TUIGroup 模块","创建成功":"创建成功","发起多人会话（群聊）":"发起多人会话（群聊）","选填":"选填","取消":"取消","创建":"创建","类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主审批。详见":"类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主审批。详见","类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见":"类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见","创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见":"创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见","创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见":"创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见","创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见":"创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见","产品文档":"产品文档","设置群名称":"设置群名称","请输入群名称":"请输入群名称","设置群ID":"设置群ID","请输入群ID":"请输入群ID","选择群类型":"选择群类型","陌生人社交群（Public）":"陌生人社交群（Public）","临时会议群（Meeting）":"临时会议群（Meeting）","好友工作群（Work）":"好友工作群（Work）","直播群（AVChatroom）":"直播群（AVChatroom）","社群（Community）":"社群（Community）","群组创建成功":"群组创建成功","群组解散成功":"群组解散成功","禁言设置成功":"禁言设置成功","取消禁言成功":"取消禁言成功","群名称不能为空":"群名称不能为空","群名称修改成功":"群名称修改成功","群公告字数超出限制，最大长度为150":"群公告字数超出限制，最大长度为150"},TUIContact:{"群聊通知":"群聊通知","系统通知":"系统通知","我的群聊":"我的群聊","输入ID":"请输入用户/群聊 ID，回车搜索","群名称":"群名称","群ID":"群ID","加入群聊":"加入群聊","解散群聊":"解散群聊","退出群聊":"退出群聊","进入群聊":"进入群聊","群类型":"群类型","请填写验证信息":"请填写验证信息","申请加入":"申请加入","已申请":"已申请","接受":"接受","拒绝":"拒绝","已处理":"已处理","添加群聊":"添加群聊","已加入":"已加入","该群组不存在":"该群组不存在","加群":"加群","我的好友":"我的好友","发送消息":"发送消息","个性签名":"个性签名","等待管理员同意":"申请成功，等待管理员同意入群申请","加群成功":"加群成功","您已是群成员":"您已是群成员","新的联系人":"新的联系人","黑名单":"黑名单","无搜索结果":"无搜索结果","客服号":"客服号",ID:"ID","联系人":"联系人","群聊":"群聊","添加好友/群聊":"添加好友/群聊","备注名":"备注名","加入黑名单":"加入黑名单","删除好友":"删除好友","等待验证":"等待验证","验证信息":"验证信息","发送申请":"发送申请","加入直播群":"加入直播群","同意":"同意","删除好友成功":"删除好友成功","删除好友失败":"删除好友失败","申请已发送":"申请已发送","申请发送失败":"申请发送失败","进入会话失败":"进入会话失败","添加好友成功":"添加好友成功","同意好友申请失败":"同意好友申请失败","拒绝成功":"拒绝成功","拒绝好友申请失败":"拒绝好友申请失败","解散群聊成功":"解散群聊成功","解散群聊失败":"解散群聊失败","退出群组成功":"退出群组成功","退出群组失败":"退出群组失败","申请入群失败":"申请入群失败","加入黑名单失败":"加入黑名单失败","移除黑名单失败":"移除黑名单失败","修改备注失败: 备注长度不得超过 96 字节":"修改备注失败: 备注长度不得超过 96 字节","修改备注成功":"修改备注成功","修改备注失败":"修改备注失败"},message:{tip:{"群成员":"群成员","加入群组":"加入群组","退出群组":"退出群组","被":"被","踢出群组":"踢出群组","成为管理员":"成为管理员","被撤销管理员":"被撤销管理员","被禁言":"被禁言","被取消禁言":"被取消禁言","群提示消息":"群提示消息","管理员":"管理员","开启全员禁言":"开启全员禁言","取消全员禁言":"取消全员禁言","成为新的群主":"成为新的群主","修改群名为":"修改群名为","发布新公告":"发布新公告","把群公告修改为":"把群公告修改为","申请加入群组":"申请加入群组","成功加入群组":"成功加入群组","被拒绝":"被拒绝","你被管理员":"你被管理员","群":"群","解散":"解散","创建群":"创建群","邀请你加群":"邀请你加群","你退出群组":"你退出群组","你被":"你被","设置为群":"设置为群","的管理员":"的管理员","撤销群":"撤销群","的管理员身份":"的管理员身份","同意加群":"同意加群","拒接加群":"拒接加群","自定义群系统通知":"自定义群系统通知"},custom:{"自定义消息":"自定义消息","通话时长":"通话时长","通话结束":"通话结束","切换语音通话":"切换语音通话","切换视频通话":"切换视频通话","发起通话":"发起通话","取消通话":"取消通话","已接听":"已接听","拒绝通话":"拒绝通话","无应答":"无应答","对本次服务评价":"对本次服务评价","查看详情>>":"查看详情>>","已取消":"已取消","对方已取消":"对方已取消","已拒绝":"已拒绝","对方已拒绝":"对方已拒绝","对方忙线中":"对方忙线中","忙线未接听":"忙线未接听","对方无应答":"对方无应答","超时无应答":"超时无应答"}},component:{"取消":"取消","完成":"完成","已选中":"已选中","人":"人","保存":"保存","请输入userID":"请输入userID","请输入groupID":"请输入groupID","确定":"确定","全选":"全选","已在群聊中":"已在群聊中","查看更多":"查看更多","图片 url 不存在":"图片 url 不存在","已取消":"已取消","获取权限失败":"获取权限失败","已保存至相册":"已保存至相册","图片下载失败":"图片下载失败","暂不支持下载此类型图片":"暂不支持下载此类型图片"},time:{"周":"周","天":"天","小时":"小时","分钟":"分钟","刚刚":"刚刚","前":"前","昨天":"昨天","星期一":"星期一","星期二":"星期二","星期三":"星期三","星期四":"星期四","星期五":"星期五","星期六":"星期六","星期日":"星期日","一月":"一月","二月":"二月","三月":"三月","四月":"四月","五月":"五月","六月":"六月","七月":"七月","八月":"八月","九月":"九月","十月":"十月","十一月":"十一月","十二月":"十二月","一":"一","二":"二","三":"三","四":"四","五":"五","六":"六","日":"日"},Evaluate:{"请对本次服务进行评价":"请对本次服务进行评价","提交评价":"提交评价","服务评价工具":"服务评价工具","使用":"使用","自定义消息":"自定义消息","搭建":"搭建","星":"星"},Words:{"常用语-快捷回复工具":"常用语-快捷回复工具","在吗？在吗？在吗？重要的话说三遍。":"在吗？在吗？在吗？重要的话说三遍。","好久没聊天了，快来和我说说话～":"好久没聊天了，快来和我说说话～","好的，就这么说定了。":"好的，就这么说定了。","感恩的心，感谢有你。":"感恩的心，感谢有你。","糟糕！是心动的感觉！":"糟糕！是心动的感觉！","心疼地抱抱自己，我太难了！":"心疼地抱抱自己，我太难了！","没关系，别在意，事情过去就过去了。":"没关系，别在意，事情过去就过去了。","早上好，今天也是让人期待的一天呢！":"早上好，今天也是让人期待的一天呢！","熬夜有什么用，又没人陪你聊天，早点休息吧。":"熬夜有什么用，又没人陪你聊天，早点休息吧。"},TUISearch:{"搜索":"搜索","全部":"全部","联系人":"联系人","群聊":"群聊","聊天记录":"聊天记录","文本":"文本","文件":"文件","图片/视频":"图片/视频","其他":"其他","选择时间":"选择时间","今天":"今天","近三天":"近三天","近七天":"近七天","查看更多":"查看更多","条相关":"条相关","条与":"条与","相关的":"相关的","进入聊天":"进入聊天","定位到聊天位置":"定位到聊天位置","搜索会话内容":"搜索会话内容","查看更多历史记录":"查看更多历史记录","暂无搜索结果":"暂无搜索结果","结果":"结果","取消":"取消","[文本]":"[文本]","[图片]":"[图片]","[语音]":"[语音]","[视频]":"[视频]","[文件]":"[文件]","[自定义消息]":"[自定义消息]","[系统消息]":"[系统消息]","[合并消息]":"[合并消息]","[位置消息]":"[位置消息]","消息云端搜索失败：":"消息云端搜索失败：","查找联系人失败：":"查找联系人失败：","查找群聊失败：":"查找群聊失败：","进入会话失败":"进入会话失败"},Emoji:ah}},rh={zh_tw:{"取消":"取消","发送":"發送","系统通知":"系統通知","关闭":"關閉","确定":"確定","开始时间":"開始時間","结束时间":"結束時間","消息":"消息","通讯录":"通訊錄","欢迎使用腾讯云即时通信IM":"歡迎使用騰訊雲即時通信IM",TUIChat:{"【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。":"【安全提示】本 APP 僅用於體驗騰訊雲即時通信 IM 產品功能，不可用於業務洽談與拓展。請勿輕信匯款、中奖等涉及錢款的信息，勿輕易撥打陌生電話，謹防上當受騙。","按Enter发送，Ctrl+Enter换行":"按Enter發送，Ctrl+Enter換行","表情":"[表情]","查看更多":"查看更多","撤回":"撤回","撤回了一条消息":"撤回了一條消息","打开":"打開","单击下载":"單擊下載","点此投诉":"點此投訴","点击处理":"點擊處理","对方正在输入":"對方正在輸入...","发起群视频":"發起群視頻","发起群语音":"發起群語音","发起通话":"發起通話","发送失败":"發送失敗","复制":"複製","复制成功":"文本複製成功","该消息不存在":"該消息不存在","关闭阅读状态":"關閉","管理员开启全员禁言":"管理員開啟全員禁言","欢迎使用TUICallKit":"歡迎使用騰訊雲音視頻通話組件TUICallKit","回到最新位置":"回到最新位置","回复":"回覆","回复详情":"回覆詳情","集成TUICallKit":"集成 TUICallKit","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"檢測到您暫未集成TUICallKit，無法體驗音視頻通話功能。","结束群聊":"結束群聊","进行体验":"進行體驗。","经度":"經度","拒绝":"拒絕","拒绝通话":"拒絕通話","开通腾讯实时音视频服务":"開通騰訊實時音視頻服務","聊天记录":"[聊天記錄]","描述":"描述","内容包含敏感词汇":"內容包含敏感詞彙","您":"您","您当前购买使用的套餐包暂未开通此功能":"您當前購買使用的套餐包暫未開通此功能。","您当前购买使用的套餐包暂未开通群消息已读回执功能":"您當前購買使用的套餐包暫未開通【群消息已讀回執】功能，請升級至旗艦版進行體驗","您当前购买使用的套餐包暂未开通在线用户列表功能":"您當前購買使用的套餐包暫未開通【在線用戶列表】功能，請升級至旗艦版進行體驗","您已被管理员禁言":"您已被管理員禁言","您有":"您有","请点击":"請點擊","请输入消息":"請輸入消息","取消":"取消","取消通话":"取消通話","全部已读":"全部已讀","确定":"確定","确认重发该消息？":"確認重發該消息？","人关闭阅读状态":"人關閉閱讀狀態","人未读":"人未讀","人已读":"人已讀","删除":"刪除","涉及敏感内容":"涉及敏感內容","申请加入":"申請加入","视频":"[視頻]","视频通话":"視頻通話","条回复":"條回覆","条入群申请":"條入群申請","条新消息":"條新消息","通话时长":"通話時長","同意":"同意","图片":"[圖片]","图片消息失败,无效的图片格式":"圖片消息失敗,無效的圖片格式","纬度":"緯度","未读":"未讀","位置":"[位置]","文件":"[文件]","文件不存在,请检查文件路径是否正确":"文件不存在,請檢查文件路徑是否正確","文件大小超出了限制,如果上传文件,最大限制是100MB":"文件大小超出了限制,如果上傳文件,最大限制是100MB","文件消息失败,禁止发送违规封禁的文件":"文件消息失敗,禁止發送違規封禁的文件","我":"我","无法查看":"無法查看","无法定位到原消息":"無法定位到原消息","无法收听":"無法收聽","正在加载":"正在加載...","加载结束":"加載結束","无应答":"無應答","系统消息":"系統消息","消息":"message","消息或者资料中文本存在敏感内容,发送失败":"消息或者資料中文本存在敏感內容,發送失敗","消息详情":"消息詳情","消息长度超出限制,消息长度不要超过12K":"消息長度超出限制,消息長度不要超過12K","消息中图片存在敏感内容,发送失败":"消息中圖片存在敏感內容,發送失敗","选择提醒的人":"選擇提醒的人","已读":"已讀","已过撤回时限":"已過撤回時限","已接听":"已接聽","已拒绝":"已拒絕","已同意":"已同意","引用":"引用","引用失败":"引用失敗","语音":"[語音]","语音通话":"語音通話","重新编辑":"重新編輯","重新发送":"重新發送","转发":"轉發","翻译":"翻譯","转文字":"轉文字","隐藏":"隱藏","转发给":"轉發給","自定义":"[自定義消息]","自定义消息":"自定義消息","腾讯云 IM":"騰訊雲 IM","空":"空","文本包含本地审核拦截词":"文本包含本地審核攔截詞","按住说话":"按住說話","抬起发送":"抬起發送","抬起取消":"抬起取消","正在录音":"正在錄音","继续上滑可取消":"繼續上滑可取消","松开手指 取消发送":"松開手指 取消發送","此机型暂不支持复制功能":"此機型暫不支持複製功能","请开通翻译功能":"請開通翻譯功能","请开通语音转文字功能":"請開通語音轉文字功能","翻译中":"翻譯中","转换中":"轉換中","由IM提供翻译支持":"由IM提供翻譯支持","所有人":"所有人","已达到表情回应上限数量":"已達到表情回應上限數量","等":"等","人":"人","返回":"返回","关闭":"關閉","多选":"多選","合并转发":"合併轉發","逐条转发":"逐條轉發","未选择消息":"未選擇消息","引用内容已撤回":"引用內容已撤回","[草稿]":"[草稿]","[消息]":"[消息]","[文本]":"[文本]","[自定义消息]":"[自定義消息]","[图片]":"[圖片]","[音频]":"[音頻]","[语音]":"[語音]","[视频]":"[視頻]","[文件]":"[文件]","[位置]":"[地理位置]","[地理位置]":"[地理位置]","[动画表情]":"[動畫表情]","[群提示]":"[群提示]","[群提示消息]":"[群提示消息]","[聊天记录]":"[聊天記錄]","[机器人自定义消息]":"[機器人自訂訊息]","群聊的聊天记录":"群聊的聊天記錄","和":"和","的聊天记录":"的聊天記錄","请升级IMSDK到v2.10.1或更高版本查看此消息":"請升級IMSDK到v2.10.1或更高版本查看此消息","您已被管理员移出群聊":"您已被管理員移出群聊","该群聊已被解散":"該群聊已被解散","您已退出该群聊":"您已退出該群聊","您已被禁止聊天":"您已被禁止聊天"},TUIConversation:{"发起会话":"發起會話","发起单聊":"發起單聊","发起群聊":"發起群聊","请输入userID":"請輸入userID","删除会话":"刪除會話","删除后，将清空该聊天的消息记录":"刪除後，將清空該聊天的消息記錄","删除后，将清空该群聊的消息记录":"刪除後，將清空該群聊的消息記錄","置顶会话":"置頂會話","取消置顶":"取消置頂","消息免打扰":"消息免打擾","取消免打扰":"取消免打擾","系统通知":"系統通知","有人@我":"有人@我","@所有人":"@所有人","条":"條","我":"我","网络异常，请您检查网络设置":"網絡異常，請您檢查網絡設置","您已被群管理员移出群聊":"您已被群管理員移出群聊","该群聊已被解散":"該群聊已被解散","您已退出该群聊":"您已退出該群聊"},TUIGroup:{"输入groupID搜索":"輸入groupID搜索","群名称":"群名稱","群ID":"群ID","加入群聊":"加入群聊","解散群聊":"解散群聊","退出群聊":"退出群聊","群类型":"群類型","请填写验证信息":"請填寫驗證信息","申请加入":"申請加入","已申请":"已申請","群公告":"群公告","群成员":"群成員","群管理":"群管理","好友工作群":"好友工作群","陌生人社交群":"陌生人社交群","临时会议群":"臨時會議群","直播群":"直播群","社群":"社群","自由加入":"自由加入","需要验证":"需要驗證","禁止加群":"禁止加群","人":"人","群头像":"群頭像","加群方式":"加群方式","转让群组":"轉讓群組","退出群组":"退出群組","群管理员":"群管理員","全员禁言":"全員禁言","全员禁言开启后，只允许群主和管理员发言。":"全員禁言開啟後，只允許群主和管理員發言。","单独禁言人员":"單獨禁言人員","删除成员":"刪除成員","确定从群聊中删除该成员？":"確定從群聊中刪除該成員？","确定从群聊中删除所选成员？":"確定從群聊中刪除所選成員？","暂无公告":"暫無公告","发布":"發布","编辑":"編輯","查看更多":"查看更多","管理员":"管理員","群主":"群主","我":"我","确认":"確認","添加成员":"添加成員","新增管理员":"新增管理員","移除管理员":"移除管理員","新增禁言用户":"新增禁言用戶","移除禁言用户":"移除禁言用戶","修改群聊名称":"修改群聊名稱","修改群聊名称后，将在群内通知其他成员":"修改群聊名稱後，將在群內通知其他成員","仅限中文、字母、数字和下划线，2-20个字":"僅限中文、字母、數字和下劃線，2-20個字","请先注册 TUIGroup 模块":"請先註冊 TUIGroup 模塊","该用户不存在":"該用戶不存在","该用户不在群组内":"該用戶不在群組內","添加群聊":"添加群聊","该群组不存在":"該群組不存在","创建群聊，请注册 TUIGroup 模块":"創建群聊，請註冊 TUIGroup 模塊","创建成功":"創建成功","发起多人会话（群聊）":"發起多人會話（群聊）","选填":"選填","取消":"取消","创建":"創建","类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主审批。详见":"類似普通微信群，創建後僅支持已在群內的好友邀請加群，且無需被邀請方同意或群主審批。詳見","类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见":"類似 QQ 群，創建後群主可以指定群管理員，用戶搜索群 ID 發起加群申請後，需要群主或管理員審批通過才能入群。詳見","创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见":"創建後可以隨意進出，且支持查看入群前消息；適合用於音視頻會議場景、在線教育場景等與實時音視頻產品結合的場景。詳見","创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见":"創建後可以隨意進出，沒有群成員數量上限，但不支持歷史消息存儲；適合與直播產品結合，用於彈幕聊天場景。詳見","创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见":"創建後可以隨意進出，最多支持100000人，支持歷史消息存儲，用戶搜索群 ID 發起加群申請後，無需管理員審批即可進群。詳見","产品文档":"產品文檔","设置群名称":"設置群名稱","请输入群名称":"請輸入群名稱","设置群ID":"設置群ID","请输入群ID":"請輸入群ID","选择群类型":"選擇群類型","陌生人社交群（Public）":"陌生人社交群（Public）","临时会议群（Meeting）":"臨時會議群（Meeting）","好友工作群（Work）":"好友工作群（Work）","直播群（AVChatroom）":"直播群（AVChatroom）","社群（Community）":"社群（Community）","群组创建成功":"群組創建成功","群组解散成功":"群組解散成功","禁言设置成功":"禁言設置成功","取消禁言成功":"取消禁言成功","群名称不能为空":"群名稱不能為空","群名称修改成功":"群名稱修改成功","群公告字数超出限制，最大长度为150":"群公告字數超出限制，最大長度為150"},TUIContact:{"群聊通知":"群聊通知","系统通知":"系統通知","我的群聊":"我的群聊","输入ID":"請輸入用戶/群聊 ID，回車搜索","群名称":"群名稱","群ID":"群ID","加入群聊":"加入群聊","解散群聊":"解散群聊","退出群聊":"退出群聊","进入群聊":"進入群聊","群类型":"群類型","请填写验证信息":"請填寫驗證信息","申请加入":"申請加入","已申请":"已申請","接受":"接受","拒绝":"拒絕","已处理":"已處理","添加群聊":"添加群聊","已加入":"已加入","该群组不存在":"該群組不存在","加群":"加群","我的好友":"我的好友","发送消息":"發送消息","个性签名":"個性簽名","等待管理员同意":"申請成功，等待管理員同意入群申請","加群成功":"加群成功","您已是群成员":"您已是群成員","新的联系人":"新的聯繫人","黑名单":"黑名單","无搜索结果":"無搜索結果","客服号":"客服號",ID:"ID","联系人":"聯繫人","群聊":"群聊","添加好友/群聊":"添加好友/群聊","备注名":"備註名","加入黑名单":"加入黑名單","删除好友":"刪除好友","等待验证":"等待驗證","验证信息":"驗證信息","发送申请":"發送申請","加入直播群":"加入直播群","同意":"同意","删除好友成功":"刪除好友成功","删除好友失败":"刪除好友失敗","申请已发送":"申請已發送","申请发送失败":"申請發送失敗","进入会话失败":"進入會話失敗","添加好友成功":"添加好友成功","同意好友申请失败":"同意好友申請失敗","拒绝成功":"拒絕成功","拒绝好友申请失败":"拒絕好友申請失敗","解散群聊成功":"解散群聊成功","解散群聊失败":"解散群聊失敗","退出群组成功":"退出群組成功","退出群组失败":"退出群組失敗","申请入群失败":"申請入群失敗","加入黑名单失败":"加入黑名單失敗","移除黑名单失败":"移除黑名單失敗","修改备注失败: 备注长度不得超过 96 字节":"修改備註失敗: 備註長度不得超過 96 字節","修改备注成功":"修改備註成功","修改备注失败":"修改備註失敗"},message:{tip:{"群成员":"群成員","加入群组":"加入群組","退出群组":"退出群組","被":"被","踢出群组":"踢出群組","成为管理员":"成為管理員","被撤销管理员":"被撤銷管理員","被禁言":"被禁言","被取消禁言":"被取消禁言","群提示消息":"群提示消息","管理员":"管理員","开启全员禁言":"開啟全員禁言","取消全员禁言":"取消全員禁言","成为新的群主":"成為新的群主","修改群名为":"修改群名為","发布新公告":"發布新公告","把群公告修改为":"把群公告修改為","申请加入群组":"申請加入群組","成功加入群组":"成功加入群組","被拒绝":"被拒絕","你被管理员":"你被管理員","群":"群","解散":"解散","创建群":"創建群","邀请你加群":"邀請你加群","你退出群组":"你退出群組","你被":"你被","设置为群":"設置為群","的管理员":"的管理員","撤销群":"撤銷群","的管理员身份":"的管理員身份","同意加群":"同意加群","拒接加群":"拒接加群","自定义群系统通知":"自定義群系統通知"},custom:{"自定义消息":"自定義消息","通话时长":"通話時長","通话结束":"通話結束","切换语音通话":"切換語音通話","切换视频通话":"切換視頻通話","发起通话":"發起通話","取消通话":"取消通話","已接听":"已接聽","拒绝通话":"拒絕通話","无应答":"無應答","对本次服务评价":"對本次服務評價","查看详情>>":"查看詳情>>","已取消":"已取消","对方已取消":"對方已取消","已拒绝":"已拒絕","对方已拒绝":"對方已拒絕","对方忙线中":"對方忙線中","忙线未接听":"忙線未接聽","对方无应答":"對方無應答","超时无应答":"超時無應答"}},component:{"取消":"取消","完成":"完成","已选中":"已選中","人":"人","保存":"保存","请输入userID":"請輸入userID","请输入groupID":"請輸入groupID","确定":"確定","全选":"全選","已在群聊中":"已在群聊中","查看更多":"查看更多","图片 url 不存在":"圖片 url 不存在","已取消":"已取消","获取权限失败":"獲取權限失敗","已保存至相册":"已保存至相冊","图片下载失败":"圖片下載失敗","暂不支持下载此类型图片":"暫不支持下載此類型圖片"},time:{"周":"週","天":"天","小时":"小時","分钟":"分鐘","刚刚":"剛剛","前":"前","昨天":"昨天","星期一":"星期一","星期二":"星期二","星期三":"星期三","星期四":"星期四","星期五":"星期五","星期六":"星期六","星期日":"星期日","一月":"一月","二月":"二月","三月":"三月","四月":"四月","五月":"五月","六月":"六月","七月":"七月","八月":"八月","九月":"九月","十月":"十月","十一月":"十一月","十二月":"十二月","一":"一","二":"二","三":"三","四":"四","五":"五","六":"六","日":"日"},Evaluate:{"请对本次服务进行评价":"請對本次服務進行評價","提交评价":"提交評價","服务评价工具":"服務評價工具","使用":"使用","自定义消息":"自定義消息","搭建":"搭建","星":"星"},Words:{"常用语-快捷回复工具":"常用語-快捷回覆工具","在吗？在吗？在吗？重要的话说三遍。":"在嗎？在嗎？在嗎？重要的話說三遍。","好久没聊天了，快来和我说说话～":"好久沒聊天了，快來和我說說話～","好的，就这么说定了。":"好的，就這麼說定了。","感恩的心，感谢有你。":"感恩的心，感謝有你。","糟糕！是心动的感觉！":"糟糕！是心動的感覺！","心疼地抱抱自己，我太难了！":"心疼地抱抱自己，我太難了！","没关系，别在意，事情过去就过去了。":"沒關係，別在意，事情過去就過去了。","早上好，今天也是让人期待的一天呢！":"早上好，今天也是讓人期待的一天呢！","熬夜有什么用，又没人陪你聊天，早点休息吧。":"熬夜有什麼用，又沒人陪你聊天，早點休息吧。"},TUISearch:{"搜索":"搜索","全部":"全部","联系人":"聯繫人","群聊":"群聊","聊天记录":"聊天記錄","文本":"文本","文件":"文件","图片/视频":"圖片/視頻","其他":"其他","选择时间":"選擇時間","今天":"今天","近三天":"近三天","近七天":"近七天","查看更多":"查看更多","条相关":"條相關","条与":"條與","相关的":"相關的","进入聊天":"進入聊天","定位到聊天位置":"定位到聊天位置","搜索会话内容":"搜索會話內容","查看更多历史记录":"查看更多歷史記錄","暂无搜索结果":"暫無搜索結果","结果":"結果","取消":"取消","[文本]":"[文本]","[图片]":"[圖片]","[语音]":"[語音]","[视频]":"[視頻]","[文件]":"[文件]","[自定义消息]":"[自定義消息]","[系统消息]":"[系統消息]","[合并消息]":"[合併消息]","[位置消息]":"[位置消息]","消息云端搜索失败：":"消息雲端搜索失敗：","查找联系人失败：":"查找聯繫人失敗：","查找群聊失败：":"查找群聊失敗：","进入会话失败":"進入會話失敗"},Emoji:{"[TUIEmoji_Smile]":"[微笑]","[TUIEmoji_Expect]":"[期待]","[TUIEmoji_Blink]":"[眨眼]","[TUIEmoji_Guffaw]":"[大笑]","[TUIEmoji_KindSmile]":"[姨母笑]","[TUIEmoji_Haha]":"[哈哈哈]","[TUIEmoji_Cheerful]":"[愉快]","[TUIEmoji_Speechless]":"[無語]","[TUIEmoji_Amazed]":"[驚訝]","[TUIEmoji_Sorrow]":"[悲傷]","[TUIEmoji_Complacent]":"[得意]","[TUIEmoji_Silly]":"[傻了]","[TUIEmoji_Lustful]":"[色]","[TUIEmoji_Giggle]":"[憨笑]","[TUIEmoji_Kiss]":"[親親]","[TUIEmoji_Wail]":"[大哭]","[TUIEmoji_TearsLaugh]":"[哭笑]","[TUIEmoji_Trapped]":"[困]","[TUIEmoji_Mask]":"[口罩]","[TUIEmoji_Fear]":"[恐懼]","[TUIEmoji_BareTeeth]":"[齜牙]","[TUIEmoji_FlareUp]":"[發怒]","[TUIEmoji_Yawn]":"[打哈欠]","[TUIEmoji_Tact]":"[機智]","[TUIEmoji_Stareyes]":"[星星眼]","[TUIEmoji_ShutUp]":"[閉嘴]","[TUIEmoji_Sigh]":"[嘆氣]","[TUIEmoji_Hehe]":"[呵呵]","[TUIEmoji_Silent]":"[收聲]","[TUIEmoji_Surprised]":"[驚喜]","[TUIEmoji_Askance]":"[白眼]","[TUIEmoji_Ok]":"[OK]","[TUIEmoji_Shit]":"[便便]","[TUIEmoji_Monster]":"[怪獸]","[TUIEmoji_Daemon]":"[惡魔]","[TUIEmoji_Rage]":"[惡魔怒]","[TUIEmoji_Fool]":"[衰]","[TUIEmoji_Pig]":"[豬]","[TUIEmoji_Cow]":"[牛]","[TUIEmoji_Ai]":"[AI]","[TUIEmoji_Skull]":"[骷髏]","[TUIEmoji_Bombs]":"[炸彈]","[TUIEmoji_Coffee]":"[咖啡]","[TUIEmoji_Cake]":"[蛋糕]","[TUIEmoji_Beer]":"[啤酒]","[TUIEmoji_Flower]":"[花]","[TUIEmoji_Watermelon]":"[瓜]","[TUIEmoji_Rich]":"[壕]","[TUIEmoji_Heart]":"[愛心]","[TUIEmoji_Moon]":"[月亮]","[TUIEmoji_Sun]":"[太陽]","[TUIEmoji_Star]":"[星星]","[TUIEmoji_RedPacket]":"[紅包]","[TUIEmoji_Celebrate]":"[慶祝]","[TUIEmoji_Bless]":"[福]","[TUIEmoji_Fortune]":"[發]","[TUIEmoji_Convinced]":"[服]","[TUIEmoji_Prohibit]":"[禁]","[TUIEmoji_666]":"[666]","[TUIEmoji_857]":"[857]","[TUIEmoji_Knife]":"[刀]","[TUIEmoji_Like]":"[讚]"}}},sh=__spreadValues(__spreadValues(__spreadValues({},{en:{"取消":"Cancel","发送":"Send","系统通知":"System notification","关闭":"Close","确定":"Save","开始时间":"Start Date","结束时间":"End Date","消息":"Messages","通讯录":"Contacts","欢迎使用腾讯云即时通信IM":"Welcome to Tencent Cloud Chat",TUIChat:{"【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。":"【Security Tips】This APP is only used to experience the functions of Tencent Cloud Instant Messaging products, and cannot be used for business negotiation and expansion. Don't trust money-related information such as remittances and lottery wins, don't make unfamiliar phone calls easily, and beware of being deceived.","按Enter发送，Ctrl+Enter换行":"Press Enter to send a message and Ctrl+Enter to start a new line","表情":"[Face]","查看更多":"View more","撤回":"Recall","撤回了一条消息":" recalled a message","打开":"Open","单击下载":"Click download","点此投诉":"Complain","点击处理":"Click action","对方正在输入":"Typing...","发起群视频":"Make group video call","发起群语音":"Make group voice call","发起通话":"Start Call","发送失败":"send failed","复制":"Copy","复制成功":"Copied to clipboard","该消息不存在":"The message does not exist","关闭阅读状态":"Read status closed","管理员开启全员禁言":"The admin enables Mute All","欢迎使用TUICallKit":"Welcome to TUICallKit","回到最新位置":"Back to the latest location","回复":"Reply","回复详情":"Replies","集成TUICallKit":" Integrate TUICallKit ","检测到您暂未集成TUICallKit，无法体验音视频通话功能":"It is detected that you have not integrated TUI CallKit yet, so you cannot experience the audio and video call. ","结束群聊":"Edit Group Call","进行体验":"to experience.","经度":"Longitude","拒绝":"Reject","拒绝通话":"Decline Call","开通腾讯实时音视频服务":"Integration Tencent Real-Time Communication","聊天记录":"[Chat history]","描述":"Description","内容包含敏感词汇":"Content contains sensitive words","您":"You","您当前购买使用的套餐包暂未开通此功能":"The package you purchased does not support this ability.","您当前购买使用的套餐包暂未开通群消息已读回执功能":"The package you purchased does not support the read receipt of group messages.","您当前购买使用的套餐包暂未开通在线用户列表功能":"The package you purchased does not support the online user list.","您已被管理员禁言":"You have been muted by the admin","您有":"You have","请点击":"Please click","请输入消息":"Enter a message","取消":"Cancel","取消通话":"Cancel Call","全部已读":"All read","确定":"Submit","确认重发该消息？":"Confirm to resend the message?","人关闭阅读状态":" read status closed","人未读":" unread","人已读":" read","删除":"Delete","涉及敏感内容":"Sensitive content","申请加入":"Application for join in","视频":"[video]","视频通话":"Video Call","条回复":"replies","条入群申请":"Item group application","条新消息":" new messages","通话时长":"Duration","同意":"Agree","图片":"[Image]","图片消息失败,无效的图片格式":"Image message failed, invalid image format.","纬度":"Latitude","未读":"Unread","位置":"[Location]","文件":"[File]","文件不存在,请检查文件路径是否正确":"The file does not exist, please check if the file path is correct.","文件大小超出了限制,如果上传文件,最大限制是100MB":"The file size exceeds the limit; if uploading a file, the maximum limit is 100MB.","文件消息失败,禁止发送违规封禁的文件":"File message failed, sending prohibited and banned files is not allowed.","我":"I","无法查看":"unable to view","无法定位到原消息":"Unable to navigate to the original message","无法收听":"unable to listen","正在加载":"Loading...","加载结束":"Load end","无应答":"No Answer","系统消息":"System message","消息":"[message]","消息或者资料中文本存在敏感内容,发送失败":"Sensitive content found in the message or information text, sending failed.","消息详情":"Message Detail","消息长度超出限制,消息长度不要超过12K":"Message length exceeds the limit; please keep the message length under 12K.","消息中图片存在敏感内容,发送失败":" Sensitive content is found in the picture in the message, sending failed.","选择提醒的人":"Select Contact","已读":"Read","已过撤回时限":"Withdrawal deadline has passed","已接听":"Answered","已拒绝":"Rejected","已同意":"Approved","引用":"Reference","引用失败":"quote failed","语音":"[Voice]","语音通话":"Voice Call","重新编辑":"Re-edit","重新发送":"Resend","转发":"Forward","翻译":"Translate","转文字":"Convert","隐藏":"Hidden","转发给":"Forward to","自定义":"[custom message]","自定义消息":"Custom message","腾讯云 IM":"Tencent Cloud Chat","空":"Empty","文本包含本地审核拦截词":"Text contains local moderation blocking words","按住说话":"Hold to speak","抬起发送":"Release to send","抬起取消":"Release to cancel","正在录音":"Recording","继续上滑可取消":"Continue to swipe to cancel","松开手指 取消发送":"Release to cancel","此机型暂不支持复制功能":"This model does not support the copy","请开通翻译功能":"Please open the translation feature","请开通语音转文字功能":"Please open the convert feature","翻译中":"Translating","转换中":"Converting","由IM提供翻译支持":"support by IM","所有人":"All","已达到表情回应上限数量":"You have reached the max reaction limit","等":"and others","人":"users","返回":"Back","关闭":"Close","多选":"Select","合并转发":"Combine Forward","逐条转发":"One-By-One Forward","未选择消息":"No message selected","[草稿]":"[Drafts]","[消息]":"[Message]","[文本]":"[Text]","[自定义消息]":"[Custom Message]","[图片]":"[Image]","[音频]":"[Voice]","[语音]":"[Voice]","[视频]":"[Video]","[文件]":"[File]","[位置]":"[Location]","[地理位置]":"[Location]","[动画表情]":"[Animated Sticker]","[群提示]":"[Group Tip]","[群提示消息]":"[Group Notification]","[聊天记录]":"[Chat History]","[机器人自定义消息]":"[Robot Custom Message]","引用内容已撤回":"The quoted message has been withdrawn","群聊的聊天记录":"Chat history for Group Chat","和":"and","的聊天记录":"chat history","请升级IMSDK到v2.10.1或更高版本查看此消息":"Please upgrade IMSDK to v2.10.1 or higher to view this message","该群聊已被解散":"The group has been dismissed","您已被管理员移出群聊":"You have been removed from the group by the admin.","您已退出该群聊":"You have left the group.","您已被禁止聊天":"you have been forbidden to speak"},TUIConversation:{"发起会话":"Start chat","发起单聊":"New one-to-one chat","发起群聊":"New group chat","请输入userID":"Enter a user ID","删除会话":"Delete","删除后，将清空该聊天的消息记录":"Once deleted, all chat messages will be cleared.","删除后，将清空该群聊的消息记录":"Once deleted, group chat history will be cleared.","系统通知":"System notification","置顶会话":"Pin","取消置顶":"Unpin","消息免打扰":"Mute Notifications","取消免打扰":"Enable Notifications","有人@我":"Someone @ me","@所有人":"@All","条":"strip","我":"me","网络异常，请您检查网络设置":"Network exception, please check the network settings","您已被群管理员移出群聊":"You have been removed from the group chat by the group administrator","该群聊已被解散":"The group chat has been disband","您已退出该群聊":"You have left the group chat"},TUIGroup:{"输入groupID搜索":"Enter groupId search","群名称":"Group name","群ID":"Group ID","加入群聊":"Join","解散群聊":"Dissolution","退出群聊":"Quit","群类型":"Group type","请填写验证信息":"Please fill in the verification information","申请加入":"Apply Join","群公告":"Group notice","群成员":"Group member","群管理":"Manage group","好友工作群":"Work","陌生人社交群":"Public","临时会议群":"Meeting","直播群":"AVChatRoom","社群":"Community","自由加入":"Join freely","需要验证":"Require approval","禁止加群":"Disallow group joining","人":"","确认":"Confirm","群头像":"Group profile photo","加群方式":"Group joining mode","转让群组":"Transfer ownership","退出群组":"Quit group","群管理员":"Group admin","全员禁言":"Mute All","全员禁言开启后，只允许群主和管理员发言。":"If Mute All is enabled, only the group owner and admin can speak.","单独禁言人员":"Mute a member","删除成员":"Remove member","确定从群聊中删除该成员？":"Are you sure you want to remove this member from the group chat?","确定从群聊中删除所选成员？":"Are you sure you want to remove selected member(s) from the group chat?","暂无公告":"No notice","发布":"Post","编辑":"Edit","查看更多":"View more","管理员":"Admin","群主":"Group owner","我":"me","添加成员":"Add member","新增管理员":"Add admin","移除管理员":"Revoke admin","新增禁言用户":"Add muted member","移除禁言用户":"Remove muted member","修改群聊名称":"Edit group name","修改群聊名称后，将在群内通知其他成员":"After modifying the group chat name, other members will be notified in the group","仅限中文、字母、数字和下划线，2-20个字":"Chinese, letters, numbers and underscores only, 2-20 words","请先注册 TUIGroup 模块":"Please register the TUIGroup module first","该用户不存在":"The user does not exist","该用户不在群组内":"The user is not in the group","添加群聊":"Add a group chat","该群组不存在":"The group does not exist","创建群聊，请注册 TUIGroup 模块":"To create a group chat, please register the TUIGroup module","创建成功":"Creation successful","发起多人会话（群聊）":"New group chat","选填":"Optional","取消":"Cancel","创建":"Create","类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主审批。详见":"Similar to a WeChat group. Users can join the group only via invitation by existing members. The invitation does not need to be agreed by the invitee or approved by the group owner. See the documentation for details.","类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见":"Similar to a QQ group. After a public group is created, the group owner can designate group admins. To join the group, a user needs to search the group ID and send a request, which needs to be approved by the group owner or an admin before the user can join the group. See the documentation for details. ","创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见":"After the group is created, a user can join and quit the group freely and can view the messages sent before joining the group. It is suitable for scenarios that integrate Tencent Real-Time Communication (TRTC), such as audio and video conferences and online education. See the documentation for details.","创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见":"After creation, a user can join and quit the group freely. The group can have an unlimited number of members, but it does not store message history. It can be combined with Live Video Broadcasting (LVB) to support on-screen comment scenarios. See the documentation for details. ","创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见":"After creation, you can enter and leave at will, support up to 100,000 people, support historical message storage, and after users search for group ID and initiate a group application, they can join the group without administrator approval. See product documentation for details. ","产品文档":"product documentation","设置群名称":"Group name","请输入群名称":"Enter the group name","设置群ID":"Group ID","请输入群ID":"Enter the group ID","选择群类型":"Group type","陌生人社交群（Public）":"Stranger social group (Public)","临时会议群（Meeting）":"Temporary meeting group (Meeting)","好友工作群（Work）":"Friends work group (Work)","直播群（AVChatroom）":"Live Streaming Group (AVChatroom)","社群（Community）":"Community（Community）","群组创建成功":"Create group success","群组解散成功":"Dismiss group success","禁言设置成功":"Mute all success","取消禁言成功":"Remove mute success","群名称不能为空":"Group name cannot be empty","群名称修改成功":"Group name modified success","群公告字数超出限制，最大长度为150":"The number of characters in the group announcement exceeds the limit, the maximum length is 150"},TUIContact:{"群聊通知":"Group Chat Notifications","系统通知":"System Notifications","我的群聊":"My Group Chats","输入ID":"Enter a groupID/userID","群名称":"Group name","群ID":"Group ID","加入群聊":"Join group chat","解散群聊":"Disband group chat","退出群聊":"Quit group chat","进入群聊":"Enter group chat","群类型":"Group type","请填写验证信息":"Enter the verification info","申请加入":"Request to join","已申请":"Requested","接受":"Accept","拒绝":"Refuse","已处理":"Handled","添加群聊":"add group chat","已加入":"joined","该群组不存在":"The group does not exist","加群":"join","我的好友":"Friend","发送消息":"Send Message","个性签名":"Signature","等待管理员同意":"Successful application, waiting for the administrator to agree to join the group application","加群成功":"Join the group successfully","您已是群成员":"You are already a group member","新的联系人":"New Contacts","黑名单":"Blocked List","无搜索结果":"No Result","客服号":"Customer Service List",ID:"ID","联系人":"User","群聊":"Group","添加好友/群聊":"Add friend/group","备注名":"remark","加入黑名单":"block","删除好友":"Delete friend","等待验证":"waiting for verification","验证信息":"verification info","发送申请":"Send application","加入直播群":"Join AVChatRoom","同意":"Agree","删除好友成功":"Delete friend success","删除好友失败":"Delete friend failed","申请已发送":"Application has been sent","申请发送失败":"Application failed to send","进入会话失败":"Failed to enter session","添加好友成功":"Add friend success","同意好友申请失败":"Failed to agree to friend request","拒绝成功":"Reject friend request success","拒绝好友申请失败":"Failed to reject friend request","解散群聊成功":"Dismissed group success","解散群聊失败":"Dismissed group failed","退出群组成功":"Quit group success","退出群组失败":"Quit group failed","申请入群失败":"Application to join the group failed","加入黑名单失败":"Add to blocklist failed","移除黑名单失败":"Remove from blocklist failed","修改备注失败: 备注长度不得超过 96 字节":"Failed to modify the remark: the length of the remark cannot exceed 96 bytes","修改备注成功":"Remark modified success","修改备注失败":"Remark modified failed"},message:{tip:{"群成员":"group members","加入群组":"joined the group","退出群组":"left the group","被":"by","踢出群组":"was kicked out of the group","成为管理员":"was set as an admin","被撤销管理员":"was revoked","被禁言":" was muted","被取消禁言":"cancel the prohibition","群提示消息":"group prompt message","管理员":"The admin","开启全员禁言":"enabled Mute All","取消全员禁言":"disabled Mute All","成为新的群主":"became the new group owner","修改群名为":"changed the group name to","发布新公告":"posted a new notice","把群公告修改为":"changed the group notice to","申请加入群组":"requested to join the group","成功加入群组":"Successfully joined the group","被拒绝":"The request to join the group was refused","你被管理员":"You","群":"group","解散":"disbanded","创建群":"created the group","邀请你加群":"invite you to join the group","你退出群组":"You left the group","你被":"You were","设置为群":"set as group","的管理员":"as an admin","撤销群":"revoked","的管理员身份":"admin role of the group","同意加群":"agreed to join the group","拒接加群":"refused to join the group","自定义群系统通知":"Custom group system notification"},custom:{"自定义消息":"Custom message","通话时长":"Call duration","通话结束":"Call End","切换语音通话":"Switch voice call","切换视频通话":"Switch video call","发起通话":"Start a call","取消通话":"Cancel","已接听":"Answered","拒绝通话":"Decline","无应答":"No answer","已取消":"Canceled","对方已取消":"Call canceled by caller","已拒绝":"Declined","对方已拒绝":"Call declined by user","对方忙线中":"Line busy","忙线未接听":"\tLine busy. Call not received.","对方无应答":"Call wasn't answered","超时无应答":"Call not answered","对本次服务评价":"Rate this service","查看详情>>":"View details >>"}},component:{"取消":"Cancel","完成":"Done","已选中":"Selected","人":"","保存":"Save","请输入userID":"Enter a userID","请输入groupID":"Enter a groupID","确定":"submit","全选":"All","已在群聊中":"exists","查看更多":"More","图片 url 不存在":"Image url does not exist","已取消":"Cancelled","获取权限失败":"Failed to obtain permission","已保存至相册":"Saved to album","图片下载失败":"Image download failed","暂不支持下载此类型图片":"Downloading this type of pictures is not supported yet"},time:{"周":"week(s) ","天":"day(s)","小时":"hour(s) ","分钟":"minute(s)","刚刚":"Just now","前":" ago","昨天":"Yesterday","星期一":"Monday","星期二":"Tuesday","星期三":"Wednesday","星期四":"Thursday","星期五":"Friday","星期六":"Saturday","星期日":"Sunday","一月":"January","二月":"February","三月":"March","四月":"April","五月":"May","六月":"June","七月":"July","八月":"August","九月":"September","十月":"October","十一月":"November","十二月":"December","一":"Mon","二":"Tues","三":"Wed","四":"Thur","五":"Fri","六":"Sat","日":"Sun"},Evaluate:{"请对本次服务进行评价":"Please rate this service","提交评价":"Feedback","服务评价工具":"Service rate tool","使用":"Build with","自定义消息":"Custom message","搭建":"","星":"Star"},Words:{"请对本次服务进行评价":"Please rate this service","提交评价":"Feedback","常用语-快捷回复工具":"Common Expressions - Quick Reply Tool","使用":"Build with","自定义消息":"Custom message","搭建":"","在吗？在吗？在吗？重要的话说三遍。":"Are you there? ","好久没聊天了，快来和我说说话～":"It’s been a long time. How about you?","好的，就这么说定了。":"Okay. It's a deal.","感恩的心，感谢有你。":"So grateful! ","糟糕！是心动的感觉！":"Oh, no. Flipped.","心疼地抱抱自己，我太难了！":"Give myself a warm hug. ","没关系，别在意，事情过去就过去了。":"Take it easy.","早上好，今天也是让人期待的一天呢！":"Good morning. Have a wonderful day.","熬夜有什么用，又没人陪你聊天，早点休息吧。":"It's better to go to bed early."},TUISearch:{"搜索":"Search","全部":"All","联系人":"Contacts","群聊":"Groups","聊天记录":"Chat History","文本":"Text","文件":"File","其他":"Other","图片/视频":"Image/Video","选择时间":"Select time","今天":"Today","近三天":"Nearly three days","近七天":"Nearly seven days","查看更多":"View more ","条相关":" related ","条与":" related to ","相关的":"keywords","进入聊天":"enter","定位到聊天位置":"Navigate to the chat position","搜索会话内容":"Search in conversation","查看更多历史记录":"View more history message","暂无搜索结果":"No Results","结果":"results","取消":"Cancel","[文本]":"[Text Message]","[图片]":"[Image Message]","[语音]":"[Audio Message]","[视频]":"[Video Message]","[文件]":"[File Message]","[自定义消息]":"[Custom Message]","[系统消息]":"[System Message]","[合并消息]":"[Merged Message]","[位置消息]":"[Position Message]","消息云端搜索失败：":"Message cloud search failed: ","查找联系人失败：":"Failed to find contact: ","查找群聊失败：":"Failed to find group: ","进入会话失败":"Failed to enter conversation"},Emoji:oh}}),ih),rh);let lh;lh=3,oe("warn","at TUIKit/adapter-vue.ts:13","[adapter-vue]: vue version is 3");const ch=e.defineComponent({__name:"index",props:["isGroup"],emits:["openGroupManagement"],setup(t,{emit:n}){const o=n,a=t,i=e.ref(),r=e.ref(!1);pe((()=>{a.isGroup&&o("openGroupManagement")}));const s=getCurrentPages(),l=s[s.length-1].$getAppWebview();a.isGroup||l.setStyle({titleNView:__spreadProps(__spreadValues({},l.getStyle().titleNView),{buttons:[]})});const c=e=>{null==bp||bp.setNavigationBarTitle({title:e||"云通信 IM"})};function u(e){var t;i.value=e,r.value||c(null==(t=null==i?void 0:i.value)?void 0:t.getShowName())}function d(e){var t;r.value=e,r.value?c(vp.t("TUIChat.对方正在输入")):c(null==(t=i.value)?void 0:t.getShowName())}return e.onMounted((()=>{mp.watch(tu.CONV,{currentConversation:u}),mp.watch(tu.CHAT,{typingStatus:d})})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversation:u}),mp.unwatch(tu.CHAT,{typingStatus:d})})),ce((()=>{var e;c(null==(e=i.value)?void 0:e.getShowName())})),(t,n)=>(e.openBlock(),e.createElementBlock("view",{style:{display:"none"}}))}}),uh={product:{label:"产品文档",url:"https://cloud.tencent.com/document/product/269/1499#.E7.BE.A4.E7.BB.84.E5.8A.9F.E8.83.BD"},customMessage:{label:"自定义消息",url:"https://web.sdk.qcloud.com/im/doc/zh-cn/SDK.html#createCustomMessage"},complaint:{label:"点此投诉",url:"https://cloud.tencent.com/apply/p/xc3oaubi98g"},implement:{label:"集成TUICallKit",url:"https://cloud.tencent.com/document/product/269/79861"},purchase:{label:"开通腾讯实时音视频服务",url:"https://cloud.tencent.com/document/product/1640/79968"}},dh="/assets/back.e9626a2e.svg",ph="/assets/video-play.58b451c9.png",hh=e.defineComponent({__name:"Icon",props:{file:{default:""},size:{},width:{default:"20px"},height:{default:"20px"},hotAreaSize:{}},emits:["onClick"],setup(t,{emit:n}){const o=n,a=t,i=e.computed((()=>{if(a.hotAreaSize)return isNaN(Number(a.hotAreaSize))?String(a.hotAreaSize):`${a.hotAreaSize}px`})),r=e.computed((()=>a.size?a.size:a.width)),s=e.computed((()=>a.size?a.size:a.height)),l=e=>{o("onClick",e)};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["common-icon-container",!e.unref(Zp)&&"common-icon-container-mobile"]),style:e.normalizeStyle({padding:e.unref(i)}),onClick:l},[e.unref(Qp)?(e.openBlock(),e.createElementBlock("image",{key:0,class:"common-icon",src:a.file,style:e.normalizeStyle({width:e.unref(r),height:e.unref(s)})},null,12,["src"])):(e.openBlock(),e.createElementBlock("img",{key:1,class:"common-icon",src:a.file,style:e.normalizeStyle({width:e.unref(r),height:e.unref(s)})},null,12,["src"]))],6))}}),fh=ee(hh,[["__scopeId","data-v-77821faf"]]),gh=e.defineComponent({__name:"index",props:{url:{default:"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png"},size:{default:"36px"},borderRadius:{default:"5px"},useSkeletonAnimation:{type:Boolean,default:!1}},emits:["onLoad","onError"],setup(t,{emit:n}){const o=e.ref("https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png"),a=n,i=t,{size:r,url:s,borderRadius:l,useSkeletonAnimation:c}=e.toRefs(i);let u=0;const d=e.ref(!1),p=e.ref(!1);function h(e){d.value=!0,a("onLoad",e)}function f(e){u+=1,u>3||(eh?p.value=!0:e.currentTarget.src=o.value,a("onError",e))}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"avatar-container",style:e.normalizeStyle({width:e.unref(r),height:e.unref(r),borderRadius:e.unref(l)})},[e.unref(eh)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(p)?(e.openBlock(),e.createElementBlock("image",{key:1,class:"avatar-image",src:e.unref(o),onLoad:h,onError:f},null,40,["src"])):(e.openBlock(),e.createElementBlock("image",{key:0,class:"avatar-image",src:e.unref(s)||e.unref(o),onLoad:h,onError:f},null,40,["src"]))],64)):(e.openBlock(),e.createElementBlock("img",{key:1,class:"avatar-image",src:e.unref(s)||e.unref(o),onLoad:h,onError:f},null,40,["src"])),e.unref(c)&&!e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass({placeholder:!0,hidden:e.unref(d),"skeleton-animation":e.unref(c)})},null,2)):e.createCommentVNode("",!0)],4))}}),mh=ee(gh,[["__scopeId","data-v-c79d3f5a"]]);function vh(e,t=new WeakMap){if("object"!=typeof e||null==e)return e;if(t.has(e))return t.get(e);const n=Object.create(Object.getPrototypeOf(e));return Object.keys(e).forEach((o=>{const a=e[o];"object"!=typeof a||null===a?n[o]=a:Array.isArray(a)?n[o]=[...a]:a instanceof Set?n[o]=new Set([...a]):a instanceof Map?n[o]=new Map([...a]):(t.set(e,e),n[o]=vh(a,t))})),n}const _h=e=>{var t;return e.type===gp.TYPES.MSG_CUSTOM&&"group_create"===(null==(t=null==e?void 0:e.getMessageContent())?void 0:t.businessID)};function yh(){return mp.getData(tu.USER,"displayMessageReadReceipt")&&mp.getData(tu.APP,"enabledMessageReadReceipt")}function Ih(e){return Object.assign({},e)}function Ch(e){const t=(new Date).setHours(0,0,0,0),n=new Date((new Date).getFullYear(),0,1,0,0,0,0).getTime(),o=new Date(e),a=864e5,i=t-o.getTime();function r(e){return e<10?"0"+e:e.toString()}if(i<=0)return`${r(o.getHours())}:${r(o.getMinutes())}`;if(i<=a)return`${vp.t("time.昨天")} ${r(o.getHours())}:${r(o.getMinutes())}`;if(i<=5184e5){const e=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][o.getDay()];return`${vp.t("time."+e)} ${r(o.getHours())}:${r(o.getMinutes())}`}return o.getTime()>=n?`${o.getMonth()+1}/${o.getDate()} ${r(o.getHours())}:${r(o.getMinutes())}`:`${o.getFullYear()}/${o.getMonth()+1}/${o.getDate()} ${r(o.getHours())}:${r(o.getMinutes())}`}const kh=ee(e.defineComponent({__name:"message-container",props:{sender:{default:""},avatar:{default:""},type:{},time:{}},setup(t){const n=t,o=gp.TYPES,a=e.computed((()=>[o.MSG_IMAGE,o.MSG_VIDEO,o.MSG_MERGER].includes(n.type)));return(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:"simple-message-container"},[e.createElementVNode("div",{class:"simple-message-avatar"},[e.createVNode(mh,{url:n.avatar},null,8,["url"])]),e.createElementVNode("div",null,[e.createElementVNode("div",{class:"simple-message-sender"},e.toDisplayString(n.sender),1),e.createElementVNode("div",{class:"simple-message-body"},[e.createElementVNode("div",{class:e.normalizeClass({"simple-message-content":!0,"no-padding":e.unref(a)})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],2),e.createElementVNode("div",{class:"timestamp"},e.toDisplayString(e.unref(Ch)(1e3*n.time)),1)])])]))}}),[["__scopeId","data-v-08da82bd"]]),Eh=ee(e.defineComponent({__name:"index",props:{visible:{type:Boolean,default:!0},zIndex:{default:9999},useMask:{type:Boolean,default:!0},maskColor:{default:"rgba(0, 0, 0, 0.6)"},isFullScreen:{type:Boolean,default:!0},width:{default:"auto"},height:{default:"auto"}},emits:["onOverlayClick"],setup(t,{expose:n,emit:o}){const a=o,i=t,r=e.ref(),s=e.ref(i.visible);function l(){a("onOverlayClick")}return e.watch((()=>i.visible),(e=>{e?s.value=!0:setTimeout((()=>{s.value=!1}),150)}),{immediate:!0}),n({overlayDomRef:r}),(t,n)=>e.unref(s)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"overlayDomRef",ref:r,class:"overlay-container",style:e.normalizeStyle({position:i.isFullScreen?"fixed":"absolute",zIndex:i.zIndex})},[i.useMask?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"overlay-mask":!0,"fade-in":i.visible}),style:e.normalizeStyle({backgroundColor:i.maskColor}),onClick:l,onTouchstart:e.withModifiers(l,["prevent","stop"])},null,38)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass({"overlay-content":!0,"full-screen":i.isFullScreen})},[e.renderSlot(t.$slots,"default",{},void 0,!0)],2)],4)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-8f8ba1e5"]]),Th=e.defineComponent({__name:"index",props:{visible:{type:Boolean,default:!0},popDirection:{default:"bottom"},useMask:{type:Boolean,default:!0},isFullScreen:{type:Boolean,default:!0},overlayColor:{},drawerStyle:{default:()=>({})}},emits:["onOverlayClick"],setup(t,{expose:n,emit:o}){var a;const i=o,r=t,s=e.ref(),l=e.ref(),c=e.ref(!1),u=e.ref(r.drawerStyle[r.popDirection]||{});function d(e){i("onOverlayClick",e)}return e.watch((()=>r.visible),(e=>{e?c.value=!0:setTimeout((()=>{c.value=!1}),150)}),{immediate:!0}),n({drawerDomRef:s,overlayDomRef:null==(a=l.value)?void 0:a.overlayDomRef}),(t,n)=>(e.openBlock(),e.createBlock(Eh,{ref_key:"overlayDomInstanceRef",ref:l,visible:r.visible,useMask:r.useMask,maskColor:r.overlayColor,isFullScreen:r.isFullScreen,onOnOverlayClick:d},{default:e.withCtx((()=>[e.unref(c)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"drawerDomRef",ref:s,class:e.normalizeClass({drawer:!0,"origin-bottom":"bottom"===r.popDirection,"origin-right":"right"===r.popDirection,"slide-bottom":t.visible&&"bottom"===r.popDirection,"slide-right":t.visible&&"right"===r.popDirection}),style:e.normalizeStyle({minHeight:e.unref(u).minHeight,maxHeight:e.unref(u).maxHeight,borderRadius:e.unref(u).borderRadius,boxShadow:e.unref(u).boxShadow,width:e.unref(u).width})},[e.createElementVNode("div",{class:"drawer-container"},[e.renderSlot(t.$slots,"default",{},void 0,!0)])],6)):e.createCommentVNode("",!0)])),_:3},8,["visible","useMask","maskColor","isFullScreen"]))}}),Sh=ee(Th,[["__scopeId","data-v-2700752c"]]),Mh={DELETE:"delete",ISPINNED:"ispinned",DISPINNED:"dispinned",MUTE:"mute",NOTMUTE:"notmute"},wh="isC2C",bh="isGroup",Dh={SERVICE:"consultion",EVALUATE:"evaluation",LINK:"text_link",CALL:1,ORDER:"order"},Nh={BASIC:"basic",BIG:"big",CUSTOM:"CUSTOM"},Rh={LEFT:"left",TOP:"top"},Lh={INPUT:"input",TEXTAREA:"textarea",SWITCH:"switch"},Ah={SUBMIT:"submit",CANCEL:"cancel"},Oh="https://web.sdk.qcloud.com/im/assets/face-elem/",Ph=[{emojiGroupID:1,type:Nh.BIG,url:Oh,list:["yz00","yz01","yz02","yz03","yz04","yz05","yz06","yz07","yz08","yz09","yz10","yz11","yz12","yz13","yz14","yz15","yz16","yz17"]},{emojiGroupID:2,type:Nh.BIG,url:Oh,list:["ys00","ys01","ys02","ys03","ys04","ys05","ys06","ys07","ys08","ys09","ys10","ys11","ys12","ys13","ys14","ys15"]},{emojiGroupID:3,type:Nh.BIG,url:Oh,list:["gcs00","gcs01","gcs02","gcs03","gcs04","gcs05","gcs06","gcs07","gcs08","gcs09","gcs10","gcs11","gcs12","gcs13","gcs14","gcs15","gcs16"]}],Uh=__spreadValues(__spreadValues({},Object.fromEntries(null==(t=Object.entries(ah))?void 0:t.map((([e,t])=>[t,e])))),Object.fromEntries(null==(n=Object.entries(oh))?void 0:n.map((([e,t])=>[t,e])))),xh="https://web.sdk.qcloud.com/im/assets/emoji-plugin/",Vh={"[TUIEmoji_Expect]":"emoji_0@2x.png","[TUIEmoji_Blink]":"emoji_1@2x.png","[TUIEmoji_Guffaw]":"emoji_2@2x.png","[TUIEmoji_KindSmile]":"emoji_3@2x.png","[TUIEmoji_Haha]":"emoji_4@2x.png","[TUIEmoji_Cheerful]":"emoji_5@2x.png","[TUIEmoji_Smile]":"emoji_6@2x.png","[TUIEmoji_Sorrow]":"emoji_7@2x.png","[TUIEmoji_Speechless]":"emoji_8@2x.png","[TUIEmoji_Amazed]":"emoji_9@2x.png","[TUIEmoji_Complacent]":"emoji_10@2x.png","[TUIEmoji_Lustful]":"emoji_11@2x.png","[TUIEmoji_Stareyes]":"emoji_12@2x.png","[TUIEmoji_Giggle]":"emoji_13@2x.png","[TUIEmoji_Daemon]":"emoji_14@2x.png","[TUIEmoji_Rage]":"emoji_15@2x.png","[TUIEmoji_Yawn]":"emoji_16@2x.png","[TUIEmoji_TearsLaugh]":"emoji_17@2x.png","[TUIEmoji_Silly]":"emoji_18@2x.png","[TUIEmoji_Wail]":"emoji_19@2x.png","[TUIEmoji_Kiss]":"emoji_20@2x.png","[TUIEmoji_Trapped]":"emoji_21@2x.png","[TUIEmoji_Fear]":"emoji_22@2x.png","[TUIEmoji_BareTeeth]":"emoji_23@2x.png","[TUIEmoji_FlareUp]":"emoji_24@2x.png","[TUIEmoji_Tact]":"emoji_25@2x.png","[TUIEmoji_Shit]":"emoji_26@2x.png","[TUIEmoji_ShutUp]":"emoji_27@2x.png","[TUIEmoji_Sigh]":"emoji_28@2x.png","[TUIEmoji_Hehe]":"emoji_29@2x.png","[TUIEmoji_Silent]":"emoji_30@2x.png","[TUIEmoji_Skull]":"emoji_31@2x.png","[TUIEmoji_Mask]":"emoji_32@2x.png","[TUIEmoji_Beer]":"emoji_33@2x.png","[TUIEmoji_Cake]":"emoji_34@2x.png","[TUIEmoji_RedPacket]":"emoji_35@2x.png","[TUIEmoji_Bombs]":"emoji_36@2x.png","[TUIEmoji_Ai]":"emoji_37@2x.png","[TUIEmoji_Celebrate]":"emoji_38@2x.png","[TUIEmoji_Bless]":"emoji_39@2x.png","[TUIEmoji_Flower]":"emoji_40@2x.png","[TUIEmoji_Watermelon]":"emoji_41@2x.png","[TUIEmoji_Cow]":"emoji_42@2x.png","[TUIEmoji_Fool]":"emoji_43@2x.png","[TUIEmoji_Surprised]":"emoji_44@2x.png","[TUIEmoji_Askance]":"emoji_45@2x.png","[TUIEmoji_Monster]":"emoji_46@2x.png","[TUIEmoji_Pig]":"emoji_47@2x.png","[TUIEmoji_Coffee]":"emoji_48@2x.png","[TUIEmoji_Ok]":"emoji_49@2x.png","[TUIEmoji_Heart]":"emoji_50@2x.png","[TUIEmoji_Sun]":"emoji_51@2x.png","[TUIEmoji_Moon]":"emoji_52@2x.png","[TUIEmoji_Star]":"emoji_53@2x.png","[TUIEmoji_Rich]":"emoji_54@2x.png","[TUIEmoji_Fortune]":"emoji_55@2x.png","[TUIEmoji_857]":"emoji_56@2x.png","[TUIEmoji_666]":"emoji_57@2x.png","[TUIEmoji_Prohibit]":"emoji_58@2x.png","[TUIEmoji_Convinced]":"emoji_59@2x.png","[TUIEmoji_Knife]":"emoji_60@2x.png","[TUIEmoji_Like]":"emoji_61@2x.png"},Bh=[{emojiGroupID:0,type:Nh.BASIC,url:xh,list:Object.keys(Vh)},...Ph],Gh=e=>Xp?ah[e]:vp.t(`Emoji.${e}`),Fh=e=>{if(!e)return"";const t=/(\[.+?\])/g;let n=e;return t.test(e)&&(n=e.replace(t,(e=>Vh[e]?Gh(e):e))),n};__spreadValues({},ah);const zh=e=>{const t=/\[([^\]]+)\]/g,n=[];let o,a=0;for(;null!==(o=t.exec(e));){const i=o.index,r=t.lastIndex,s=o[0];i>a&&n.push({type:"text",content:e.substring(a,i)});const l=xh+Vh[s];l?n.push({type:"image",content:l,emojiKey:s}):n.push({type:"text",content:s}),a=r,t.lastIndex=a}return a<e.length&&n.push({type:"text",content:e.substring(a)}),n},Hh=ee(e.defineComponent({__name:"index",props:{renderData:{},disabled:{type:Boolean,default:!1},messageItem:{default:()=>({})}},emits:["assignMessageIDInUniapp"],setup(t,{emit:n}){const o=n,a=t,i=e.ref(!1);function r(){a.disabled||(eh?o("assignMessageIDInUniapp",a.messageItem.ID):i.value=!0)}function s(){i.value=!1}return(t,n)=>(e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",{class:"message-record-container",onClick:r},[e.createElementVNode("div",{class:"record-title"},e.toDisplayString(a.renderData.title),1),e.createElementVNode("div",{class:"record-abstract-container"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.renderData.abstractList.slice(0,7),((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:"record-abstract-item"},e.toDisplayString(e.unref(Fh)(t)),1)))),128))]),e.createElementVNode("div",{class:"record-footer"},e.toDisplayString(e.unref(vp).t("TUIChat.聊天记录")),1)]),!a.disabled&&e.unref(Zp)?(e.openBlock(),e.createBlock(Eh,{key:0,visible:e.unref(i),onOnOverlayClick:n[0]||(n[0]=e=>i.value=!1)},{default:e.withCtx((()=>[e.createVNode(qh,{isMounted:e.unref(i),renderData:a.renderData,messageID:a.messageItem.ID,onCloseOverlay:s},null,8,["isMounted","renderData","messageID"])])),_:1},8,["visible"])):a.disabled||!e.unref(Jp)||e.unref(eh)?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(Sh,{key:1,visible:e.unref(i),isFullScreen:!0,overlayColor:"transparent",popDirection:"right"},{default:e.withCtx((()=>[e.createVNode(qh,{isMounted:e.unref(i),renderData:a.renderData,messageID:a.messageItem.ID,onCloseOverlay:s},null,8,["isMounted","renderData","messageID"])])),_:1},8,["visible"]))]))}}),[["__scopeId","data-v-5d90bac5"]]),jh=e.defineComponent({__name:"index",props:{messageID:{default:""},isMounted:{type:Boolean,default:!1}},emits:["closeOverlay"],setup(t,{emit:n}){const o=n,a=t,i=gp.TYPES,r=e.ref(!1),s=e.ref([]),l=e.ref({title:"",messageList:[]}),c=e.ref();e.watch((()=>s.value.length),(e=>__async(this,null,(function*(){if(r.value=!1,e<1)return;const t=s.value[s.value.length-1];if(t.downloadKey&&0===t.messageList.length)try{const e=yield Ip.downloadMergedMessages({payload:t,type:gp.TYPES.MSG_MERGER});s.value[s.value.length-1]=e.payload}catch(n){r.value=!0}l.value=s.value[s.value.length-1]})))),e.watch((()=>a.isMounted),(e=>{if(e){if(!a.messageID)throw new Error("messageID is required when first render of simple-message-list.");const e=mp.getMessageModel(a.messageID).getMessage().payload;s.value=[e]}else s.value=[]}),{immediate:!0});const u=e.computed((()=>s.value.length>1)),d=e.computed((()=>{var e;return!!(null==(e=l.value)?void 0:e.messageList)&&l.value.messageList.length>0}));function p(){s.value.pop(),s.value.length<1&&o("closeOverlay")}function h(e){let t="";return e.indexOf("@custom")>-1?t=""+e:(t=Oh+e,-1===t.indexOf("@2x")?t+="@2x.png":t+=".png"),t}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"simple-message-list-container":!0,"simple-message-list-container-mobile":e.unref(th)})},[e.createElementVNode("div",{class:"header-container"},[e.createElementVNode("span",{class:"back",onClick:p},[e.createVNode(fh,{class:"close-icon",file:e.unref(dh),size:"18px"},null,8,["file"]),e.unref(u)?(e.openBlock(),e.createElementBlock("span",{key:0},e.toDisplayString(e.unref(vp).t("TUIChat.返回")),1)):(e.openBlock(),e.createElementBlock("span",{key:1},e.toDisplayString(e.unref(vp).t("TUIChat.关闭")),1))]),e.createElementVNode("span",{class:"title"},e.toDisplayString(e.unref(l).title),1)]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",{key:0}," Load Merge Message Error ")):e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"simpleMessageListRef",ref:c,class:"message-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l).messageList,(t=>(e.openBlock(),e.createElementBlock("div",{key:t.ID,class:e.normalizeClass({"message-item":!0})},[e.createVNode(kh,{sender:t.nick,avatar:t.avatar,type:t.messageBody[0].type,time:t.time},{default:e.withCtx((()=>[t.messageBody[0].type===e.unref(i).MSG_TEXT?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-text"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(zh)(t.messageBody[0].payload.text),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n,class:"message-text-container"},["text"===t.type?(e.openBlock(),e.createElementBlock("span",{key:0,class:"text"},e.toDisplayString(t.content),1)):(e.openBlock(),e.createElementBlock("img",{key:1,class:"simple-emoji",src:t.content,alt:"small-face"},null,8,["src"]))])))),128))])):t.messageBody[0].type===e.unref(i).MSG_IMAGE?(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-image"},[e.createElementVNode("img",{class:"image",src:t.messageBody[0].payload.imageInfoArray[2].url,mode:"widthFix",alt:"image"},null,8,["src"])])):t.messageBody[0].type===e.unref(i).MSG_VIDEO?(e.openBlock(),e.createElementBlock("div",{key:2,class:"message-video"},[e.unref(eh)?(e.openBlock(),e.createElementBlock("div",{key:0,onClick:e=>function(e){if(eh){const t=encodeURIComponent(e);uni.navigateTo({url:`/TUIKit/components/TUIChat/video-play?videoUrl=${t}`})}}(t.messageBody[0].payload.remoteVideoUrl)},[e.createElementVNode("image",{class:"image",src:t.messageBody[0].payload.thumbUrl,mode:"widthFix",alt:"image"},null,8,["src"]),e.createVNode(fh,{class:"video-play-icon",file:e.unref(ph)},null,8,["file"])],8,["onClick"])):(e.openBlock(),e.createElementBlock("video",{key:1,class:"video",controls:"",poster:t.messageBody[0].payload.thumbUrl},[e.createElementVNode("source",{src:t.messageBody[0].payload.remoteVideoUrl,type:"video/mp4"},null,8,["src"])],8,["poster"]))])):t.messageBody[0].type===e.unref(i).MSG_AUDIO?(e.openBlock(),e.createElementBlock("div",{key:3,class:"message-audio"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUIChat.语音"))+" ",1),e.createElementVNode("span",null,e.toDisplayString(t.messageBody[0].payload.second)+"s",1)])):t.messageBody[0].type===e.unref(i).MSG_FACE?(e.openBlock(),e.createElementBlock("div",{key:4,class:"message-face"},[e.createElementVNode("img",{class:"image",src:h(t.messageBody[0].payload.data),alt:"face"},null,8,["src"])])):t.messageBody[0].type===e.unref(i).MSG_FILE?(e.openBlock(),e.createElementBlock("div",{key:5,class:"message-file"},e.toDisplayString(e.unref(vp).t("TUIChat.[文件]")),1)):t.messageBody[0].type===e.unref(i).MSG_LOCATION?(e.openBlock(),e.createElementBlock("div",{key:6},e.toDisplayString(e.unref(vp).t("TUIChat.[地理位置]")),1)):t.messageBody[0].type===e.unref(i).MSG_MERGER?(e.openBlock(),e.createElementBlock("div",{key:7,class:"message-merger",onClickCapture:e=>function(e,t){s.value.push(t.messageBody[0].payload),e.stopPropagation()}(e,t)},[e.createVNode(Hh,{disabled:"",renderData:t.messageBody[0].payload},null,8,["renderData"])],40,["onClickCapture"])):t.messageBody[0].type===e.unref(i).MSG_CUSTOM?(e.openBlock(),e.createElementBlock("div",{key:8},e.toDisplayString(e.unref(vp).t("TUIChat.[自定义消息]")),1)):e.createCommentVNode("",!0)])),_:2},1032,["sender","avatar","type","time"])])))),128))],512)):e.createCommentVNode("",!0)],2))}}),qh=ee(jh,[["__scopeId","data-v-ced897da"]]),Kh="/assets/close-dark.f3809f45.svg",Yh=ee(e.defineComponent({__name:"index",props:{groupID:{default:""}},setup(t){const n=t,o=e.ref(),a=e.ref(0),i=e.ref(!1),r=e.ref([]);function s(){return __async(this,null,(function*(){return(yield Cp.getGroupApplicationList()).data.applicationList.filter((e=>e.groupID===n.groupID))}))}function l(){i.value=!i.value}function c(){return __async(this,null,(function*(){const e=yield s();if(0===e.length)return[];const t=e.map((e=>0===e.applicationType?e.applicant:e.userID)),{data:n}=yield yp.getUserProfile({userIDList:t}),o={};n.forEach((e=>{o[e.userID]=e}));return e.map((e=>{const t=o[0===e.applicationType?e.applicant:e.userID];return{nick:t.nick||t.userID||"anonymous",avatar:t.avatar||"",isRemoved:!1,application:e}}))}))}function u(e,t,n){Cp.handleGroupApplication({handleAction:t,application:e.application}).then((()=>{r.value[n].isRemoved=!0,setTimeout((()=>{r.value.splice(n,1),a.value-=1}),150)})).catch((()=>{}))}function d(){c().then((e=>{r.value=e,a.value=e.length}))}return e.watch(i,(e=>{e&&c().then((e=>{r.value=e,a.value=e.length}))})),e.watch((()=>r.value.length),((e,t)=>{t>0&&0===e&&(i.value=!1)})),e.onMounted((()=>{s().then((e=>{a.value=e.length})),mp.watch(tu.GRP,{groupSystemNoticeList:d})})),e.onUnmounted((()=>{mp.unwatch(tu.GRP,{groupSystemNoticeList:d})})),(t,n)=>(e.openBlock(),e.createElementBlock("div",null,[e.unref(a)>0?(e.openBlock(),e.createElementBlock("div",{key:0,class:"application-tips"},[e.createElementVNode("div",null,e.toDisplayString(e.unref(a))+e.toDisplayString(e.unref(vp).t("TUIChat.条入群申请")),1),e.createElementVNode("div",{class:"application-tips-btn",onClick:l},e.toDisplayString(e.unref(vp).t("TUIChat.点击处理")),1)])):e.createCommentVNode("",!0),e.createVNode(Sh,{ref_key:"drawerDomInstanceRef",ref:o,visible:e.unref(i),zIndex:998,popDirection:e.unref(th)?"bottom":"right",isFullScreen:e.unref(th),overlayColor:e.unref(th)?void 0:"transparent",drawerStyle:{bottom:{minHeight:"60vh",maxHeight:"80vh",borderRadius:"12px 12px 0 0"},right:{width:"360px",borderRadius:"12px 0 0 12px",boxShadow:"0 0 10px 0 #d0d0d0"}},onOnOverlayClick:l},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass({"application-contaienr":!0})},[e.createElementVNode("header",{class:"application-header"},[e.createElementVNode("div",{onClick:l},[e.unref(Zp)?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref(Kh),size:"16px"},null,8,["file"])):(e.openBlock(),e.createElementBlock("div",{key:1},e.toDisplayString(e.unref(vp).t("关闭")),1))])]),e.createElementVNode("main",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:t.nick,class:e.normalizeClass({"application-item":!0,removed:t.isRemoved})},[e.createVNode(mh,{style:{flex:"0 0 auto"},url:t.avatar,useSkeletonAnimation:!0},null,8,["url"]),e.createElementVNode("div",{class:"application-item-info"},[e.createElementVNode("div",{class:"application-item-nick"},e.toDisplayString(t.nick),1),e.createElementVNode("div",{class:"application-item-note"},e.toDisplayString(e.unref(vp).t("TUIChat.申请加入")),1)]),e.createElementVNode("div",{class:"application-item-operation"},[e.createElementVNode("div",{class:"agree",onClick:e=>u(t,"Agree",n)},e.toDisplayString(e.unref(vp).t("TUIChat.同意")),9,["onClick"]),e.createElementVNode("div",{class:"reject",onClick:e=>u(t,"Reject",n)},e.toDisplayString(e.unref(vp).t("TUIChat.拒绝")),9,["onClick"])])],2)))),128))])])])),_:1},8,["visible","popDirection","isFullScreen","overlayColor"])]))}}),[["__scopeId","data-v-b934ca67"]]),$h=ee(e.defineComponent({__name:"message-text",props:{content:{default:()=>({})},messageItem:{default:()=>({})},enableURLHighlight:{type:Boolean,default:!1}},setup(t){const n=t,o=e.ref([]);return e.watch((()=>n.messageItem),((e,t)=>{var a,i,r,s,l,c;(null==e?void 0:e.ID)!==(null==t?void 0:t.ID)&&(n.enableURLHighlight&&Ep.reportFeature(208),n.messageItem.getMessageContent?o.value=null==(a=n.messageItem.getMessageContent())?void 0:a.text:o.value=null==(r=null==(i=mp.getMessageModel(n.messageItem.ID))?void 0:i.getMessageContent())?void 0:r.text,o.value=o.value||(null==(s=n.content)?void 0:s.text),(null==(l=o.value)?void 0:l.length)?o.value=null==(c=o.value.map((e=>{if("img"===e.name&&"custom"===(null==e?void 0:e.type))return oe("warn","at TUIKit/components/TUIChat/message-list/message-elements/message-text.vue:87","CUSTOM_BASIC_EMOJI_URL is required for custom emoji."),e;if(n.enableURLHighlight&&"text"===e.name&&e.text){if(!qp)return oe("warn","at TUIKit/components/TUIChat/message-list/message-elements/message-text.vue:103","parseTextAndValidateUrls not found. Please update @tencentcloud/universal-api to 2.3.7 or higher."),e;const t=qp(e.text);if(t.length)return t.map((e=>({name:e.type,text:e.text,url:e.url})))}return e})))?void 0:c.flat():o.value=[])}),{deep:!0,immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-text-container",e.unref(Zp)&&"text-select"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n},["text"===t.name?(e.openBlock(),e.createElementBlock("span",{key:0,class:"text"},e.toDisplayString(t.text),1)):"url"===t.name?(e.openBlock(),e.createElementBlock("span",{key:1,class:"url-link",onClick:e=>{var n;(n=t.url)&&(eh?bp.navigateTo({url:`/pages/views/webview?url=${n}`}):bp.open(n,"_blank"))}},e.toDisplayString(t.text),9,["onClick"])):(e.openBlock(),e.createElementBlock("img",{key:2,class:"emoji",src:t.src,alt:t.emojiKey},null,8,["src","alt"]))])))),128))],2))}}),[["__scopeId","data-v-71a05f72"]]),Wh=155,Zh=ee(e.defineComponent({__name:"message-image",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},emits:["previewImage"],setup(t,{emit:n}){const o=n,a=t,i=e.ref({width:"auto",height:"auto"}),r=e=>{const{width:t,height:n}=e;if(0===t||0===n)return;let o=0,a=0;t>=n?(o=Wh,a=Wh*n/t):(o=Wh*t/n,a=Wh),i.value.width=o+"px",i.value.height=a+"px"};e.watchEffect((()=>{r(a.content)}));const s=e=>{r(e.detail)},l=()=>{var e;"success"!==(null==(e=a.messageItem)?void 0:e.status)&&1!==a.messageItem.progress||o("previewImage")};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"image-container",onClick:l},[e.createElementVNode("image",{class:"message-image",mode:"aspectFit",src:a.content.url,style:e.normalizeStyle({width:e.unref(i).width,height:e.unref(i).height}),onLoad:s},null,44,["src"])]))}}),[["__scopeId","data-v-ffbab496"]]),Jh="success",Xh="warning",Qh="error",ef="normal",tf=e=>{bp.showToast({title:e.message||"Toast",duration:e.duration||1500,icon:nf(e.type)})},nf=e=>{if(!e)return"none";switch(e){case Qh:case Xh:return"none";case Jh:return"success";default:return"none"}},of=ee(e.defineComponent({__name:"message-audio",props:{broadcastNewAudioSrc:{},messageItem:{default:()=>({})},content:{default:()=>({})}},emits:["getGlobalAudioContext","setAudioPlayed"],setup(t,{emit:n}){const o=n,a=t,i=new Map,r=e.ref(!1);function s(){if(o("getGlobalAudioContext",i,{newAudioSrc:a.content.url}),a.messageItem.hasRiskContent||!a.content.url)return void tf({message:"暂不支持播放"});h()||(i.set("audio",uni.createInnerAudioContext()),function(){const e=h();if(!e)return;e.src=a.content.url,r.value=!1,e.onPlay(c),e.onStop(u),e.onEnded(d),e.onError(p)}()),r.value?l():function(){const e=h();e&&(e.play(),"in"===a.messageItem.flow&&o("setAudioPlayed",a.messageItem.ID))}()}function l(){const e=h();if(e)try{e.stop()}catch(vs){}}function c(){r.value=!0}function u(){r.value=!1}function d(){r.value=!1}function p(){oe("warn","at TUIKit/components/TUIChat/message-list/message-elements/message-audio.vue:156","audio played error")}function h(){return i.get("audio")}return e.onUnmounted((()=>{var e;const t=h();r.value&&l(),null==(e=null==t?void 0:t.destroy)||e.call(t),i.delete("audio")})),e.watch((()=>a.broadcastNewAudioSrc),(e=>{e!==a.content.url&&r.value&&(l(),r.value=!1)})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-audio":!0,reserve:"out"===a.messageItem.flow}),onClick:s},[e.createElementVNode("div",{class:"audio-icon-container"},[e.createElementVNode("div",{class:e.normalizeClass({mask:!0,play:e.unref(r)})},null,2),e.createVNode(fh,{class:"icon",width:"15px",height:"20px",file:e.unref("/assets/msg-audio.ac2cd1c9.svg")},null,8,["file"])]),e.createElementVNode("div",{class:"time",style:e.normalizeStyle({width:5*a.content.second+"px"})},e.toDisplayString(a.content.second||1)+' " ',5)],2))}}),[["__scopeId","data-v-e591cc47"]]),af=ee(e.defineComponent({__name:"message-file",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},setup(t){const n=t,o=()=>{if(n.messageItem.hasRiskContent)return;const e={mode:"cors",headers:new Headers({"Content-Type":"application/x-www-form-urlencoded"})};if(null==window?void 0:window.fetch)fetch(n.content.url,e).then((e=>e.blob())).then((e=>{const t=document.createElement("a"),o=window.URL.createObjectURL(e);t.href=o,t.download=n.content.name,t.click()}));else{const e=document.createElement("a");e.href=n.content.url,e.target="_blank",e.download=n.content.name,e.click()}};return(t,a)=>(e.openBlock(),e.createElementBlock("div",{class:"file-message-montainer",title:e.unref(vp).t("TUIChat.单击下载"),onClick:o},[e.createVNode(fh,{file:e.unref("/assets/file-light.7beeea9d.svg"),class:"file-icon"},null,8,["file"]),e.createElementVNode("div",null,[e.createElementVNode("div",null,e.toDisplayString(n.content.name),1),e.createElementVNode("div",null,e.toDisplayString(n.content.size),1)])],8,["title"]))}}),[["__scopeId","data-v-80cfd099"]]),rf=ee(e.defineComponent({__name:"message-face",props:{content:{type:Object,default:()=>({})}},setup(t){const n=t,o=e.ref(n.content.url);return e.onMounted((()=>{"custom"===n.content.type&&oe("warn","at TUIKit/components/TUIChat/message-list/message-elements/message-face.vue:29","CUSTOM_BIG_EMOJI_URL is required for custom emoji, please check your CUSTOM_BIG_EMOJI_URL.")})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"message-image"},[e.createElementVNode("img",{mode:"aspectFit",class:"message-image",src:e.unref(o)},null,8,["src"])]))}}),[["__scopeId","data-v-aa73bcb5"]]),sf="/assets/star-light.d9a7aedf.png",lf=ee(e.defineComponent({__name:"message-custom",props:{messageItem:{default:void 0},content:{default:void 0}},setup(t){const n=t,o=e.ref(),a=e.ref(),i=e.ref(),r=e.ref({businessID:""});e.watchEffect((()=>{o.value=n.content,a.value=n.messageItem;const{payload:e}=n.messageItem;r.value=e.data||"",r.value=Wp(e.data),e.data===Dh.SERVICE&&(i.value=Wp(e.extension))}));return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"custom"},[e.unref(r).businessID===e.unref(Dh).SERVICE?(e.openBlock(),e.createElementBlock("div",{key:0},[e.createElementVNode("h1",null,[e.createElementVNode("label",null,e.toDisplayString(e.unref(i).title),1),e.unref(i).hyperlinks_text?(e.openBlock(),e.createElementBlock("a",{key:0,href:e.unref(i).hyperlinks_text.value,target:"view_window"},e.toDisplayString(e.unref(i).hyperlinks_text.key),9,["href"])):e.createCommentVNode("",!0)]),e.unref(i).item&&e.unref(i).item.length>0?(e.openBlock(),e.createElementBlock("ul",{key:0},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i).item,((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n},[e.unref($p)(t.value)?(e.openBlock(),e.createElementBlock("a",{key:0,href:t.value,target:"view_window"},e.toDisplayString(t.key),9,["href"])):(e.openBlock(),e.createElementBlock("p",{key:1},e.toDisplayString(t.key),1))])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("article",null,e.toDisplayString(e.unref(i).description),1)])):e.unref(r).businessID===e.unref(Dh).EVALUATE?(e.openBlock(),e.createElementBlock("div",{key:1,class:"evaluate"},[e.createElementVNode("h1",null,e.toDisplayString(e.unref(vp).t("message.custom.对本次服务评价")),1),e.createElementVNode("ul",{class:"evaluate-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Math.max(e.unref(r).score,0),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"evaluate-list-item"},[e.createVNode(fh,{file:e.unref(sf),class:"file-icon"},null,8,["file"])])))),128))]),e.createElementVNode("article",null,e.toDisplayString(e.unref(r).comment),1)])):e.unref(r).businessID===e.unref(Dh).ORDER?(e.openBlock(),e.createElementBlock("div",{key:2,class:"order",onClick:n[0]||(n[0]=t=>{return n=e.unref(r).link,void window.open(n);var n})},[e.createElementVNode("img",{src:e.unref(r).imageUrl},null,8,["src"]),e.createElementVNode("main",null,[e.createElementVNode("h1",null,e.toDisplayString(e.unref(r).title),1),e.createElementVNode("p",null,e.toDisplayString(e.unref(r).description),1),e.createElementVNode("span",null,e.toDisplayString(e.unref(r).price),1)])])):e.unref(r).businessID===e.unref(Dh).LINK?(e.openBlock(),e.createElementBlock("div",{key:3,class:"textLink"},[e.createElementVNode("p",null,e.toDisplayString(e.unref(r).text),1),e.createElementVNode("a",{href:e.unref(r).link,target:"view_window"},e.toDisplayString(e.unref(vp).t("message.custom.查看详情>>")),9,["href"])])):(e.openBlock(),e.createElementBlock("span",{key:4,innerHTML:t.content.custom},null,8,["innerHTML"]))]))}}),[["__scopeId","data-v-ca9ce9df"]]),cf=ee(e.defineComponent({__name:"message-tip",props:{content:{type:Object,default:()=>({})}},setup(t){const n=t,o=e.computed((()=>{var e,t;return(null==(e=n.content)?void 0:e.text)||(null==(t=n.content)?void 0:t.custom)||""}));return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"message-tip"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(o)),1)]))}}),[["__scopeId","data-v-b9dc8c31"]]);class uf{constructor(){this.chatType="",this.features={DownloadFile:!0,CopyMessage:!0,DeleteMessage:!0,RevokeMessage:!0,QuoteMessage:!0,ForwardMessage:!0,TranslateMessage:!0,VoiceToText:!0,MultiSelection:!0,EmojiReaction:!0,InputEmoji:!0,InputStickers:!0,InputImage:!0,InputVoice:!0,InputVideo:!0,InputFile:!0,InputEvaluation:!0,InputQuickReplies:!0,InputMention:!0,MessageSearch:!0,ReadStatus:!0},this.theme="light"}static getInstance(){return uf.instance||(uf.instance=new uf),uf.instance}setChatType(e){this.chatType=e}getChatType(){return this.chatType}hideTUIChatFeatures(e){e&&e.forEach((e=>{this.features[e]&&(this.features[e]=!1)}))}getFeatureConfig(e){return e?this.features[e]:this.features}setTheme(e){this.theme=e}getTheme(){return this.theme}}const df=uf.getInstance();df.hideTUIChatFeatures.bind(df);const pf=ee(e.defineComponent({__name:"index",props:{message:{default:()=>({})}},emits:["openReadUserPanel"],setup(t,{emit:n}){const o=n,a=t,i=df.getFeatureConfig("ReadStatus"),r=gp.TYPES,s=e.ref(mp.getData(tu.USER,"displayMessageReadReceipt"));e.onMounted((()=>{mp.watch(tu.USER,{displayMessageReadReceipt:f})})),e.onUnmounted((()=>{mp.unwatch(tu.USER,{displayMessageReadReceipt:f})}));const l=e.computed((()=>{if(!i)return!1;if(!s.value)return!1;const{ID:e,type:t,flow:n,status:o,hasRiskContent:l,conversationID:c,conversationType:u,needReadReceipt:d=!1}=a.message;if(l)return!1;const{groupProfile:p}=mp.getConversationModel(c)||{};if((null==p?void 0:p.type)===r.GRP_AVCHATROOM||(null==p?void 0:p.type)===r.GRP_COMMUNITY)return!1;if(t===r.MSG_CUSTOM){const t=mp.getMessageModel(e);if(null!==(null==t?void 0:t.getSignalingInfo()))return!1}return"out"===n&&"success"===o&&("GROUP"===u?d:"C2C"===u)})),c=e.computed((()=>{const{conversationType:e,needReadReceipt:t=!1,isPeerRead:n=!1}=a.message,{readCount:o=0,unreadCount:i=0,isPeerRead:r=!1}=a.message.readReceiptInfo;return"C2C"===e?t?r?0:1:n?0:1:"GROUP"===e?t?0===o?1:0===i?2:4:3:1})),u=e.computed((()=>{const{readCount:e=0}=a.message.readReceiptInfo;switch(c.value){case 0:return vp.t("TUIChat.已读");case 1:return vp.t("TUIChat.未读");case 2:return vp.t("TUIChat.全部已读");case 4:return`${e}${vp.t("TUIChat.人已读")}`;default:return""}})),d=e.computed((()=>{const{conversationType:e}=a.message;return"C2C"===e?0!==c.value:"GROUP"===e&&2!==c.value})),p=e.computed((()=>a.message.needReadReceipt&&"GROUP"===a.message.conversationType&&(4===c.value||1===c.value)));function h(){p.value&&o("openReadUserPanel")}function f(e){s.value=e}return(t,n)=>e.withDirectives((e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-label":!0,unread:e.unref(d),"finger-point":e.unref(p)}),onClick:h},[e.createElementVNode("span",null,e.toDisplayString(e.unref(u)),1)],2)),[[e.vShow,e.unref(l)]])}}),[["__scopeId","data-v-999f5a95"]]);var hf=(e=>(e[e.TYPE_NONE=0]="TYPE_NONE",e[e.TYPE_TEXT=1]="TYPE_TEXT",e[e.TYPE_CUSTOM=2]="TYPE_CUSTOM",e[e.TYPE_IMAGE=3]="TYPE_IMAGE",e[e.TYPE_SOUND=4]="TYPE_SOUND",e[e.TYPE_VIDEO=5]="TYPE_VIDEO",e[e.TYPE_FILE=6]="TYPE_FILE",e[e.TYPE_LOCATION=7]="TYPE_LOCATION",e[e.TYPE_FACE=8]="TYPE_FACE",e[e.TYPE_GROUP_TIPS=9]="TYPE_GROUP_TIPS",e[e.TYPE_MERGER=10]="TYPE_MERGER",e))(hf||{});const ff=ee(e.defineComponent({__name:"index",props:{message:{default:()=>({})}},emits:["scrollTo","blinkMessage"],setup(t,{emit:n}){const o=n,a=t;let i=0;const r=e.ref(""),s=e.ref(!1),l=e.ref({}),c=e.computed((()=>{var e;try{const t=JSON.parse((null==(e=a.message)?void 0:e.cloudCustomData)||"{}"),n=mp.getMessageModel(t.messageReply.messageID);return null==n?void 0:n.isRevoked}catch(t){return!0}}));function u(){return __async(this,null,(function*(){var e;if(c.value)return;const t=null==(e=l.value)?void 0:e.messageID,n=mp.getData(tu.CHAT,"messageList").some((e=>e.ID===t));if(t&&n)try{const e=yield zp("#messageScrollList","messageList"),n=yield zp("#tui-"+t,"messageList"),{scrollTop:a}=yield Hp("#messageScrollList","messageList"),r=n.top+a-e.top-i++%2,s=n.top<e.top;if(!eh&&window){const e=document.getElementById("messageScrollList");s&&e&&(e.scrollTop=r)}else eh&&s&&o("scrollTo",r);o("blinkMessage",t)}catch(a){oe("error","at TUIKit/components/TUIChat/message-list/message-elements/message-quote/index.vue:154",a)}else tf({message:vp.t("TUIChat.无法定位到原消息"),type:Xh})}))}return e.onMounted((()=>{var e;try{const t=JSON.parse((null==(e=a.message)?void 0:e.cloudCustomData)||"{}");s.value=Boolean(t.messageReply),s.value&&(l.value=t.messageReply,r.value=function(e){let t="",n="";switch(e.messageType){case hf.TYPE_TEXT:t="[文本]";break;case hf.TYPE_CUSTOM:t="[自定义消息]";break;case hf.TYPE_IMAGE:t="[图片]";break;case hf.TYPE_SOUND:t="[音频]";break;case hf.TYPE_VIDEO:t="[视频]";break;case hf.TYPE_FILE:t="[文件]";break;case hf.TYPE_LOCATION:t="[地理位置]";break;case hf.TYPE_FACE:t="[动画表情]";break;case hf.TYPE_GROUP_TIPS:t="[群提示]";break;case hf.TYPE_MERGER:t="[聊天记录]";break;default:t="[消息]"}[hf.TYPE_TEXT,hf.TYPE_MERGER].includes(e.messageType)&&(n=e.messageAbstract);return n||vp.t(`TUIChat.${t}`)}(l.value))}catch(t){s.value=!1}})),(t,n)=>e.unref(s)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"reference-content":!0,reverse:"out"===t.message.flow}),onClick:u},[e.unref(c)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"revoked-text"},e.toDisplayString(e.unref(vp).t("TUIChat.引用内容已撤回")),1)):(e.openBlock(),e.createElementBlock("div",{key:1,class:"max-double-line"},e.toDisplayString(e.unref(l).messageSender)+": "+e.toDisplayString(e.unref(Fh)(e.unref(r))),1))],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-fdbf055a"]]),gf=class e{constructor(){this.isUseCache=!0,this.translationCache=new Map}static getInstance(){return e.instance||(e.instance=new e),e.instance}get(e){return __async(this,null,(function*(){if(this.isUseCache){const t=this.translationCache.get(e.ID);if(void 0!==t)return t}const t=mp.getMessageModel(e.ID);if(!t)return[];const{text:n}=t.getMessageContent()||{},o=[],a=yield this.getNickList(t);for(let e=0;e<n.length;++e){const t=n[e];if("img"===t.name){o.push({type:"face",value:t.src});continue}const{transSplitingList:i,atNickList:r}=this.getSplitResult(t.text,a);for(let e=0;e<i.length;++e)o.push({type:"text",value:i[e]}),e<r.length&&o.push({type:"mention",value:r[e]})}const i=[],r=o.filter(((e,t)=>"text"===e.type&&""!==e.value.trim()&&(i.push(t),!0))).map((e=>e.value));if(0===r.length)return this.translationCache.set(t.ID,o),o;return(yield this.getTranslationStandard(r)).forEach(((e,t)=>{o[i[t]].value=e})),this.translationCache.set(t.ID,o),o}))}clear(){this.translationCache.clear()}disableCache(){this.isUseCache=!1}enableCache(){this.isUseCache=!0}getTranslationStandard(e){return new Promise(((t,n)=>{Ip.translateText({sourceTextList:e,sourceLanguage:"auto"}).then((e=>{const{data:{translatedTextList:n}}=e;t(n)})).catch((e=>{n(e)}))}))}getNickList(e){return __async(this,null,(function*(){const t=[],{atUserList:n=[]}=e,o=gp.TYPES.MSG_AT_ALL;if(n.includes(o)&&t.push(`@${vp.t("TUIChat.所有人")}`),n.length>0){const{data:e}=yield yp.getUserProfile({userIDList:n});e.forEach((e=>{const n=`@${e.nick||e.userID}`;t.push(n)}))}return[...new Set(t)]}))}getSplitResult(e,t){let n=0;const o=[],a=[];for(;n<e.length;){const i=e.indexOf("@",n);if(-1===i){o.push(e.substring(n));break}let r=!1;for(let s=0;s<t.length;++s){const l=e.indexOf(t[s],i);if(-1!==l&&l===i){o.push(e.substring(n,l)),a.push(t[s]),n=l+t[s].length,r=!0;break}}if(!r){o.push(e.substring(n));break}}return{transSplitingList:o,atNickList:a}}};gf.instance=void 0;const mf=gf.getInstance(),vf=ee(e.defineComponent({__name:"translation-content",props:{message:{default:()=>({})},translationContentVisible:{type:Boolean},isSingleTranslation:{type:Boolean},translationWrapperRef:{}},setup(t){const n=t,o=e.ref(!1),a=e.ref(""),i=e.ref([]);return e.watch((()=>n.translationContentVisible),(e=>{e&&mf.get(n.message).then((e=>{o.value=!0,i.value=e})).catch((e=>{o.value=!0,emits("toggleErrorStatus",!0),a.value=e.message}))}),{immediate:!0}),(t,r)=>(e.openBlock(),e.createElementBlock("div",{class:"message-translation-container"},[e.unref(o)?(e.openBlock(),e.createElementBlock("div",{key:0,id:`translation-content-${n.message.ID}`,class:e.normalizeClass({"translation-content":!0,occur:!0})},[e.unref(i).length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(i),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n},["face"===t.type?(e.openBlock(),e.createElementBlock("img",{key:0,class:"text-face",src:t.value},null,8,["src"])):(e.openBlock(),e.createElementBlock("span",{key:1,class:"text-plain"},e.toDisplayString(t.value),1))])))),128)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(e.unref(a)),1)],64))],8,["id"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass({loading:!0,"loading-end":e.unref(o)})},e.toDisplayString(e.unref(vp).t("TUIChat.翻译中"))+"... ",3)]))}}),[["__scopeId","data-v-4cd59ce5"]]),_f=ee(e.defineComponent({__name:"index",props:{message:{default:()=>({})}},setup(t){const n=t,o=e.ref(!1),a=e.ref(!1),i=e.ref();let r=!0;function s(e){a.value=e}function l(e){if(void 0===e)return;r=!1;const t=e.get(n.message.conversationID)||[];for(let i=0;i<t.length;++i){const{messageID:e,visible:s}=t[i];if(e===n.message.ID&&void 0!==s){1===t.length&&s&&(r=!0),a.value=!1,o.value=s;break}}}return e.onMounted((()=>{mp.watch(tu.CHAT,{translateTextInfo:l})})),e.onUnmounted((()=>{mp.unwatch(tu.CHAT,{translateTextInfo:l})})),(t,l)=>e.unref(o)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"translationWrapperRef",ref:i,class:e.normalizeClass({"message-translation":!0,reverse:"out"===n.message.flow,error:e.unref(a)})},[e.createVNode(vf,{message:n.message,translationContentVisible:e.unref(o),translationWrapperRef:e.unref(i),isSingleTranslation:e.unref(r),onToggleErrorStatus:s},null,8,["message","translationContentVisible","translationWrapperRef","isSingleTranslation"]),e.createElementVNode("div",{class:"copyright"},[e.createVNode(fh,{file:e.unref("/assets/check-sm.bfc05916.svg"),size:"13px"},null,8,["file"]),e.createElementVNode("div",{class:"copyright-text"},e.toDisplayString(e.unref(vp).t("TUIChat.由IM提供翻译支持")),1)])],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-b0897e3b"]]),yf=class e{constructor(){this.isUseCache=!0,this.convertCache=new Map}static getInstance(){return e.instance||(e.instance=new e),e.instance}get(e){return __async(this,null,(function*(){if(this.isUseCache){const t=this.convertCache.get(e.ID);if(void 0!==t)return t}const t=mp.getMessageModel(e.ID);if(!t)return Promise.reject("message not found");const n=yield Ip.convertVoiceToText({message:t});let{data:{result:o}={}}=n;return o?this.convertCache.set(t.ID,o):o="",o}))}clear(){this.convertCache.clear()}disableCache(){this.isUseCache=!1}enableCache(){this.isUseCache=!0}};yf.instance=void 0;const If=yf.getInstance(),Cf=ee(e.defineComponent({__name:"convert-content",props:{message:{default:()=>({})},contentVisible:{type:Boolean}},emits:["toggleErrorStatus"],setup(t,{emit:n}){const o=n,a=t,i=e.ref(!1),r=e.ref("");return e.watch((()=>a.contentVisible),(e=>{e&&If.get(a.message).then((e=>{i.value=!0,r.value=e})).catch((e=>{i.value=!0,o("toggleErrorStatus",!0),r.value=e.message}))}),{immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"message-convert-container"},[e.unref(i)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"convert-content":!0,occur:!0})},e.toDisplayString(e.unref(r)),1)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass({loading:!0,"loading-end":e.unref(i)})},e.toDisplayString(e.unref(vp).t("TUIChat.转换中"))+"... ",3)]))}}),[["__scopeId","data-v-eb032d43"]]),kf=ee(e.defineComponent({__name:"index",props:{message:{default:()=>({})}},setup(t){const n=t,o=e.ref(!1),a=e.ref(!1),i=e.ref();let r=!0;function s(e){a.value=e}function l(e){if(void 0===e)return;r=!1;const t=e.get(n.message.conversationID)||[];for(let i=0;i<t.length;++i){const{messageID:e,visible:s}=t[i];if(e===n.message.ID&&void 0!==s){1===t.length&&s&&(r=!0),a.value=!1,o.value=s;break}}}return e.onMounted((()=>{mp.watch(tu.CHAT,{voiceToTextInfo:l})})),e.onUnmounted((()=>{mp.unwatch(tu.CHAT,{voiceToTextInfo:l})})),(t,l)=>e.unref(o)?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"convertWrapperRef",ref:i,class:e.normalizeClass({"message-convert":!0,reverse:"out"===n.message.flow,error:e.unref(a)})},[e.createVNode(Cf,{message:n.message,contentVisible:e.unref(o),isSingleConvert:e.unref(r),convertWrapperRef:e.unref(i),onToggleErrorStatus:s},null,8,["message","contentVisible","isSingleConvert","convertWrapperRef"])],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-3b11ea73"]]),Ef=ee(e.defineComponent({__name:"index",props:{isSelected:{type:Boolean}},emits:["onChange"],setup(t,{emit:n}){const o=n,a=t;function i(){o("onChange",!a.isSelected)}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"radio-select",onClick:i},[a.isSelected?(e.openBlock(),e.createBlock(fh,{key:1,file:e.unref("/assets/radio.0422f0b5.svg"),size:"20px"},null,8,["file"])):(e.openBlock(),e.createElementBlock("div",{key:0,class:"radio-no-select"}))]))}}),[["__scopeId","data-v-b42245ec"]]),Tf=ee(e.defineComponent({__name:"message-bubble",props:{messageItem:{default:()=>({})},content:{default:()=>({})},classNameList:{default:()=>[]},blinkMessageIDList:{default:()=>[]},isMultipleSelectMode:{type:Boolean,default:!1},isAudioPlayed:{type:Boolean,default:!1},multipleSelectedMessageIDList:{default:()=>[]}},emits:["resendMessage","blinkMessage","setReadReceiptPanelVisible","changeSelectMessageIDList","scrollTo"],setup(t,{emit:n}){const o=n,a=t,i=gp.TYPES,r=[i.MSG_LOCATION,i.MSG_TEXT,i.MSG_CUSTOM,i.MSG_MERGER,i.MSG_FACE],{blinkMessageIDList:s,messageItem:l}=e.toRefs(a),c=e.computed((()=>a.multipleSelectedMessageIDList.includes(l.value.ID))),u=e.computed((()=>"in"===l.value.flow&&"success"===l.value.status&&l.value.type===i.MSG_AUDIO&&!a.isAudioPlayed)),d=e.computed((()=>["message-bubble",c.value?"multiple-selected":"",...a.classNameList])),p=e.computed((()=>[i.MSG_IMAGE,i.MSG_VIDEO,i.MSG_MERGER].includes(l.value.type))),h=e.computed((()=>{let e=vp.t("TUIChat.涉及敏感内容")+", ";return"out"===l.value.flow?e+=vp.t("TUIChat.发送失败"):e+=vp.t(l.value.type===i.MSG_AUDIO?"TUIChat.无法收听":"TUIChat.无法查看"),e})),f=e.computed((()=>{var e,t;return!!(null==(e=l.value)?void 0:e.ID)&&(null==(t=null==s?void 0:s.value)?void 0:t.includes(l.value.ID))}));function g(e){o("changeSelectMessageIDList",{type:e?"add":"remove",messageID:l.value.ID})}function m(e){o("blinkMessage",e)}function v(e){o("scrollTo",e)}function _(){o("setReadReceiptPanelVisible",!0,l.value)}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(e.unref(d))},[a.isMultipleSelectMode?(e.openBlock(),e.createBlock(Ef,{key:0,class:"multiple-select-radio",isSelected:e.unref(c),onOnChange:g},null,8,["isSelected"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass({"control-reverse":"out"===e.unref(l).flow})},[e.createElementVNode("div",{class:"message-bubble-content"},[e.createElementVNode("div",{class:e.normalizeClass(["message-bubble-main-content",["in"===e.unref(l).flow?"":"reverse"]])},[e.createVNode(mh,{useSkeletonAnimation:"",url:e.unref(l).avatar||"",style:{flex:"0 0 auto"}},null,8,["url"]),e.createElementVNode("main",{class:"message-body",onClick:n[1]||(n[1]=e.withModifiers((()=>{}),["stop"]))},["in"===e.unref(l).flow&&"GROUP"===e.unref(l).conversationType?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-body-nick-name"},e.toDisplayString(a.content.showName),1)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["message-body-main","out"===e.unref(l).flow&&"message-body-main-reverse"])},[e.createElementVNode("div",{class:e.normalizeClass(["blink","message-body-content","out"===e.unref(l).flow?"content-out":"content-in",e.unref(l).hasRiskContent&&"content-has-risk",e.unref(p)?"content-no-padding":"",e.unref(p)&&e.unref(f)?"blink-shadow":"",!e.unref(p)&&e.unref(f)?"blink-content":""])},[e.createElementVNode("div",{class:"content-main"},[e.unref(l).type!==e.unref(i).MSG_IMAGE&&e.unref(l).type!==e.unref(i).MSG_VIDEO||!e.unref(l).hasRiskContent?e.renderSlot(t.$slots,"default",{key:1},void 0,!0):(e.openBlock(),e.createElementBlock("img",{key:0,class:e.normalizeClass(["message-risk-replace",!e.unref(Zp)&&"message-risk-replace-h5"]),src:"https://web.sdk.qcloud.com/component/TUIKit/assets/has_risk_default.png"},null,2))]),e.unref(l).hasRiskContent?(e.openBlock(),e.createElementBlock("div",{key:0,class:"content-has-risk-tips"},e.toDisplayString(e.unref(h)),1)):e.createCommentVNode("",!0)],2),e.unref(u)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"audio-unplay-mark"})):e.createCommentVNode("",!0),"fail"===e.unref(l).status||e.unref(l).hasRiskContent?(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-label fail",onClick:n[0]||(n[0]=e=>{var t;(null==(t=l.value)?void 0:t.hasRiskContent)||o("resendMessage")})}," ! ")):e.createCommentVNode("",!0),"unSend"===e.unref(l).status&&r.includes(e.unref(l).type)?(e.openBlock(),e.createBlock(fh,{key:2,class:"message-label loading-circle",file:e.unref("/assets/loading.2a143778.png"),width:"15px",height:"15px"},null,8,["file"])):e.createCommentVNode("",!0),e.createVNode(pf,{class:"message-label align-self-bottom",message:e.unref(Ih)(e.unref(l)),onOpenReadUserPanel:_},null,8,["message"])],2)])],2),e.createElementVNode("div",{class:"message-bubble-extra-content"},[e.createVNode(_f,{class:e.normalizeClass("out"===e.unref(l).flow?"reverse":"flex-row"),message:e.unref(l)},null,8,["class","message"]),e.createVNode(kf,{class:e.normalizeClass("out"===e.unref(l).flow?"reverse":"flex-row"),message:e.unref(l)},null,8,["class","message"]),e.createVNode(ff,{class:e.normalizeClass("out"===e.unref(l).flow?"reverse":"flex-row"),message:e.unref(l),onBlinkMessage:m,onScrollTo:v},null,8,["class","message"])])])],2)],2))}}),[["__scopeId","data-v-0fa8afd1"]]),Sf=ee(e.defineComponent({__name:"message-location",props:{content:{type:Object,default:()=>({})}},setup(t){const n=t,o=e.ref();return e.watchEffect((()=>{o.value=n.content})),(t,n)=>(e.openBlock(),e.createElementBlock("a",{class:"message-location",href:e.unref(o).href,target:"_blank",title:"点击查看详情"},[e.createElementVNode("span",{class:"el-icon-location-outline"},e.toDisplayString(e.unref(o).description),1),e.createElementVNode("img",{src:e.unref(o).url},null,8,["src"])],8,["href"]))}}),[["__scopeId","data-v-f9b994c8"]]),Mf=ee(e.defineComponent({__name:"message-timestamp",props:{currTime:{type:Number,default:0},prevTime:{type:Number,default:0}},setup(t){const n=t,{currTime:o,prevTime:a}=e.toRefs(n),i=e.ref(!1),r=e.ref("");return e.watch((()=>[o.value,a.value]),((e,t)=>{var n,s;(null==e?void 0:e.toString())!==(null==t?void 0:t.toString())&&(r.value=(n=o.value,s=a.value,i.value=!1,n<=0?"":!s||s<=0||n-s>=600?(i.value=!0,Ch(1e3*n)):""))}),{immediate:!0}),(t,n)=>e.unref(i)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-timestamp"},e.toDisplayString(e.unref(r)),1)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-46cc8bf9"]]),wf=ee(e.defineComponent({__name:"message-video",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},setup(t){const n=t;function o(){const e=encodeURIComponent(n.content.url);uni.navigateTo({url:`/TUIKit/components/TUIChat/video-play?videoUrl=${e}`})}return(t,a)=>(e.openBlock(),e.createElementBlock("div",{class:"message-video"},[e.createElementVNode("div",{class:"message-video-box",onClick:o},[e.createElementVNode("image",{src:n.content.snapshotUrl,class:"message-video-box"},null,8,["src"]),"success"===n.messageItem.status||1===n.messageItem.progress?(e.openBlock(),e.createBlock(fh,{key:0,class:"video-play",file:e.unref(ph)},null,8,["file"])):e.createCommentVNode("",!0)])]))}}),[["__scopeId","data-v-5a02d877"]]),bf="/assets/msg-copy.91b797d7.svg";function Df(e){const t=mp.getData(tu.APP,"tasks");e in t&&!t[e]&&(t[e]=!0,mp.update(tu.APP,"tasks",t))}const Nf=ee(e.defineComponent({__name:"index",props:{messageItem:{default:()=>({})},isMultipleSelectMode:{type:Boolean,default:!1}},emits:["toggleMultipleSelectMode"],setup(t,{expose:n,emit:o}){const a=o,i=t,r=df.getFeatureConfig(),s=gp.TYPES,l=e.ref([{key:"open",text:vp.t("TUIChat.打开"),iconUrl:bf,renderCondition(){var e;return!(!r.DownloadFile||!c.value)&&(Zp&&((null==(e=c.value)?void 0:e.type)===s.MSG_FILE||c.value.type===s.MSG_VIDEO||c.value.type===s.MSG_IMAGE))},clickEvent:function(){var e;let t="";switch(null==(e=c.value)?void 0:e.type){case gp.TYPES.MSG_FILE:t=c.value.payload.fileUrl;break;case gp.TYPES.MSG_VIDEO:t=c.value.payload.remoteVideoUrl;break;case gp.TYPES.MSG_IMAGE:t=c.value.payload.imageInfoArray[0].url}null==window||window.open(t,"_blank")}},{key:"copy",text:vp.t("TUIChat.复制"),iconUrl:bf,renderCondition:()=>!(!r.CopyMessage||!c.value)&&c.value.type===s.MSG_TEXT,clickEvent:function(){return __async(this,null,(function*(){var e,t;eh&&(null==bp||bp.setClipboardData({data:Fh(null==(t=null==(e=c.value)?void 0:e.payload)?void 0:t.text)}))}))}},{key:"revoke",text:vp.t("TUIChat.撤回"),iconUrl:"/assets/msg-revoke.a0b46d31.svg",renderCondition:()=>!(!r.RevokeMessage||!c.value)&&("out"===c.value.flow&&"success"===c.value.status),clickEvent:function(){if(!c.value)return;mp.getMessageModel(c.value.ID).revokeMessage().then((()=>{Df("revokeMessage")})).catch((e=>{if(20016===e.code||10031===e.code){const e=vp.t("TUIChat.已过撤回时限");tf({message:e,type:Qh})}}))}},{key:"delete",text:vp.t("TUIChat.删除"),iconUrl:"/assets/msg-del.8e1884b8.svg",renderCondition:()=>!(!r.DeleteMessage||!c.value)&&"success"===c.value.status,clickEvent:function(){if(!c.value)return;mp.getMessageModel(c.value.ID).deleteMessage()}},{key:"forward",text:vp.t("TUIChat.转发"),iconUrl:"/assets/msg-forward.b9d14da1.svg",renderCondition:()=>!(!r.ForwardMessage||!c.value)&&"success"===c.value.status,clickEvent:function(){if(!c.value)return;mp.update(tu.CUSTOM,"singleForwardMessageID",c.value.ID)}},{key:"quote",text:vp.t("TUIChat.引用"),iconUrl:"/assets/msg-quote.6ed4649b.svg",renderCondition(){if(!r.QuoteMessage||!c.value)return!1;const e=mp.getMessageModel(c.value.ID);return"success"===c.value.status&&!e.getSignalingInfo()},clickEvent:function(){if(!c.value)return;c.value.quoteMessage()}},{key:"translate",text:vp.t("TUIChat.翻译"),visible:!1,iconUrl:"/assets/translate.a0cfa550.svg",renderCondition:()=>!(!r.TranslateMessage||!c.value)&&("success"===c.value.status&&c.value.type===s.MSG_TEXT),clickEvent:function(){if(!mp.getData(tu.APP,"enabledTranslationPlugin"))return void tf({message:vp.t("TUIChat.请开通翻译功能"),type:Xh});if(!c.value)return;const e=l.value.findIndex((e=>"translate"===e.key));mp.update(tu.CHAT,"translateTextInfo",{conversationID:c.value.conversationID,messageID:c.value.ID,visible:!l.value[e].visible})}},{key:"convert",text:vp.t("TUIChat.转文字"),visible:!1,iconUrl:"/assets/convertText_zh.ea05cc29.svg",renderCondition:()=>!(!r.VoiceToText||!c.value)&&("success"===c.value.status&&c.value.type===s.MSG_AUDIO),clickEvent:function(){if(!mp.getData(tu.APP,"enabledVoiceToText"))return void tf({message:vp.t("TUIChat.请开通语音转文字功能")});if(!c.value)return;const e=l.value.findIndex((e=>"convert"===e.key));mp.update(tu.CHAT,"voiceToTextInfo",{conversationID:c.value.conversationID,messageID:c.value.ID,visible:!l.value[e].visible})}},{key:"multi-select",text:vp.t("TUIChat.多选"),iconUrl:"/assets/multiple-select.63011d60.svg",renderCondition:()=>!(!r.MultiSelection||!c.value)&&"success"===c.value.status,clickEvent:function(){a("toggleMultipleSelectMode")}}]),c=e.ref(),u=e.ref();e.onMounted((()=>{mp.watch(tu.CHAT,{translateTextInfo:p,voiceToTextInfo:h})})),e.onUnmounted((()=>{mp.unwatch(tu.CHAT,{translateTextInfo:p,voiceToTextInfo:h})})),e.watchEffect((()=>{c.value=mp.getMessageModel(i.messageItem.ID)}));const d=e.computed((()=>{for(let e=0;e<l.value.length;++e)if(l.value[e].renderCondition())return!1;return!0}));function p(e){if(void 0===e)return;const t=e.get(i.messageItem.conversationID)||[],n=l.value.findIndex((e=>"translate"===e.key));for(let o=0;o<t.length;++o){const{messageID:e,visible:a}=t[o];if(e===i.messageItem.ID)return l.value[n].text=vp.t(a?"TUIChat.隐藏":"TUIChat.翻译"),void(l.value[n].visible=!!a)}l.value[n].text=vp.t("TUIChat.翻译")}function h(e){if(void 0===e)return;const t=e.get(i.messageItem.conversationID)||[],n=l.value.findIndex((e=>"convert"===e.key));for(let o=0;o<t.length;++o){const{messageID:e,visible:a}=t[o];if(e===i.messageItem.ID)return l.value[n].text=vp.t(a?"TUIChat.隐藏":"TUIChat.转文字"),void(l.value[n].visible=!!a)}l.value[n].text=vp.t("TUIChat.转文字")}return n({messageToolDom:u}),(t,n)=>e.unref(d)||t.messageItem.hasRiskContent?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"messageToolDom",ref:u,class:e.normalizeClass(["dialog-item",e.unref(Zp)?"dialog-item-web":"dialog-item-h5"])},[e.unref(r).EmojiReaction?e.renderSlot(t.$slots,"TUIEmojiPlugin",{key:0},void 0,!0):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["dialog-item-list",e.unref(Zp)?"dialog-item-list-web":"dialog-item-list-h5"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),((t,n)=>(e.openBlock(),e.createElementBlock(e.Fragment,null,[t.renderCondition()?(e.openBlock(),e.createElementBlock("div",{key:t.key,class:"list-item",onClick:e=>function(e){l.value[e].clickEvent()}(n),onMousedown:e=>{t.key}},[e.createVNode(fh,{file:t.iconUrl,size:"15px"},null,8,["file"]),e.createElementVNode("span",{class:"list-item-text"},e.toDisplayString(t.text),1)],40,["onClick","onMousedown"])):e.createCommentVNode("",!0)],64)))),256))],2)],2))}}),[["__scopeId","data-v-ffb191f4"]]),Rf=ee(e.defineComponent({__name:"message-revoked",props:{isEdit:{type:Boolean,default:()=>!1},messageItem:{type:Object,default:()=>({})}},emits:["messageEdit"],setup(t,{emit:n}){const o=t,a=e.ref(),i=e.ref(!1),r=n;e.watchEffect((()=>{a.value=o.messageItem,i.value=o.isEdit}));const s=()=>{r("messageEdit")};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"revoke"},["in"===e.unref(a).flow?(e.openBlock(),e.createElementBlock("span",{key:0},e.toDisplayString(e.unref(a).nick||e.unref(a).from),1)):e.unref(a).from===e.unref(a).revoker?(e.openBlock(),e.createElementBlock("span",{key:1},e.toDisplayString(e.unref(vp).t("TUIChat.您")),1)):(e.openBlock(),e.createElementBlock("span",{key:2},e.toDisplayString(e.unref(a).revoker),1)),e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUIChat.撤回了一条消息")),1),"out"===e.unref(a).flow&&e.unref(i)?(e.openBlock(),e.createElementBlock("span",{key:3,class:"edit",onClick:s},e.toDisplayString(e.unref(vp).t("TUIChat.重新编辑")),1)):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-3c2423de"]]),Lf={OFFICIAL_ACCOUNT:"1",MINI_APP:"2",MINI_APP_SERVICE_ACCOUNT:"3",BACKEND_INTERNAL:"4",WEB:"5",SESSION_MESSAGE_SLICE:"6",MINI_APP_AUTO:"7",INTERNAL:"8",MENU:"9",MENU_SELECTED:"10",CLIENT_STATE:"11",TYPING_STATE:"12",ROBOT:"13",BRANCH:"15",BRANCH_NUMBER:15,MEMBER:"17",NO_SEAT_ONLINE:"18",END:"19",TIMEOUT:"20",FROM_INPUT:"21",PRODUCT_CARD:"22",SATISFACTION_CON:"23",USER_SATISFACTION:"24"},Af={STAR:1,NUMBER:2},Of="TIMCustomElem";function Pf(e){return function(e){if("string"==typeof e)try{return!!JSON.parse(e)}catch(t){return!1}return!1}(e)?JSON.parse(e):e}function Uf(e){var t;const n=Pf(null==(t=null==e?void 0:e.payload)?void 0:t.data);return 0===Number(null==n?void 0:n.customerServicePlugin)||1===Number(null==n?void 0:n.chatbotPlugin)}const xf=e=>{var t;const n=Pf(null==(t=null==e?void 0:e.payload)?void 0:t.data);return Uf(e)&&n.src===Lf.MENU},Vf=e=>{var t,n;const o=Pf(null==(t=null==e?void 0:e.payload)?void 0:t.data),a=[Lf.MENU,Lf.BRANCH,Lf.BRANCH_NUMBER,Lf.FROM_INPUT,Lf.PRODUCT_CARD],i=(null==e?void 0:e.type)===Of,r=a.includes(null==o?void 0:o.src),s=(null==o?void 0:o.src)===Lf.ROBOT&&-1!==["feedback","updateBotStatus"].indexOf(null==(n=null==o?void 0:o.content)?void 0:n.command);return i&&(!r||s)};const Bf=(o=class{constructor(){__publicField(this,"customerServiceAccounts"),oe("log","at TUIKit/tui-customer-service-plugin/server.ts:12","TUICustomerServer.init ok"),_t.registerService(nt.TUICustomerServicePlugin.SERVICE.NAME,this),_t.registerExtension(nt.TUIContact.EXTENSION.CONTACT_LIST.EXT_ID,this),this.customerServiceAccounts=["@im_agent#online_shopping_mall","@im_agent#online_doctor"]}static getInstance(){return o.instance||(o.instance=new o),o.instance}setCustomerServiceAccounts(e){this.customerServiceAccounts=e}getCustomerServiceAccounts(){return this.customerServiceAccounts}isCustomerConversation(e){const t=e&&e.slice(3)||"";return this.customerServiceAccounts.indexOf(t)>-1}isCustomerServicePluginMessage(e){return!(!e||!this.isCustomerConversation(e.conversationID))&&(Uf(e)||Vf(e))}onGetExtension(e){if(e===nt.TUIContact.EXTENSION.CONTACT_LIST.EXT_ID)return[{weight:0,icon:"",text:"客服号",data:{name:"customer",accountList:this.customerServiceAccounts}}]}onCall(e,t){if(e===nt.TUICustomerServicePlugin.SERVICE.METHOD.ACTIVE_CONVERSATION)this.isCustomerConversation(t.conversationID)&&(_t.callService({serviceName:nt.TUIChat.SERVICE.NAME,method:nt.TUIChat.SERVICE.METHOD.SET_CHAT_TYPE,params:{chatType:"customerService"}}),_t.callService({serviceName:nt.TUIChat.SERVICE.NAME,method:nt.TUIChat.SERVICE.METHOD.SEND_CUSTOM_MESSAGE,params:{to:t.conversationID.slice(3),conversationType:"C2C",payload:{data:JSON.stringify({src:"7"})}}}))}},__publicField(o,"instance"),o).getInstance(),Gf=Bf.isCustomerServicePluginMessage.bind(Bf);function Ff(e){var t;const n=Wp(null==(t=null==e?void 0:e.payload)?void 0:t.data);if(1===(null==n?void 0:n.businessID)&&(null==n?void 0:n.data)){if("av_call"===Wp(n.data).businessID)return!0}return!1}function zf(e){var t;const n=Wp(null==(t=null==e?void 0:e.payload)?void 0:t.data);return"group_room_message"===(null==n?void 0:n.businessID)}function Hf(e){return e.type===gp.TYPES.MSG_CUSTOM&&(Ff(e)||Gf(e)||zf(e)||function(e){var t;const n=Wp(null==(t=null==e?void 0:e.payload)?void 0:t.data);return"ROOM_INVITE_ACTION"===(null==n?void 0:n.businessID)||"tuikit_engine_room"===(null==n?void 0:n.businessID)}(e))}Bf.setCustomerServiceAccounts.bind(Bf),Bf.getCustomerServiceAccounts.bind(Bf);const jf=e.defineComponent({__name:"message-plugin-layout",props:{message:{default:()=>({})},showStyle:{default:""},bubbleClassNameList:{default:()=>[]},blinkMessageIDList:{default:()=>[]}},emits:["resendMessage","handleToggleMessageItem","handleH5LongPress"],setup(t,{emit:n}){const o=t,a=n,i=e.computed((()=>{var e;return mp.getMessageModel(null==(e=o.message)?void 0:e.ID)})),r=(e,t,n=!1)=>{a("handleToggleMessageItem",e,t,n)},s=(e,t,n)=>{a("handleH5LongPress",e,t,n)};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"message-plugin"},["tip"===o.showStyle?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-plugin-tip"},[e.renderSlot(t.$slots,"messageTip",{},void 0,!0)])):"bubble"===o.showStyle?(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-plugin-bubble-content",onLongpress:n[1]||(n[1]=t=>r(t,e.unref(i),!0)),onContextmenu:n[2]||(n[2]=e.withModifiers((t=>r(t,e.unref(i))),["prevent","right"])),onTouchstart:n[3]||(n[3]=t=>s(t,e.unref(i),"touchstart")),onTouchend:n[4]||(n[4]=t=>s(t,e.unref(i),"touchend")),onMouseover:n[5]||(n[5]=t=>s(t,e.unref(i),"touchend"))},[e.createVNode(Tf,{messageItem:e.unref(i),content:e.unref(i).getMessageContent(),blinkMessageIDList:o.blinkMessageIDList,classNameList:o.bubbleClassNameList,onResendMessage:n[0]||(n[0]=t=>{return n=e.unref(i),void a("resendMessage",n);var n})},{messageElement:e.withCtx((()=>[e.unref(eh)?e.createCommentVNode("",!0):e.renderSlot(t.$slots,"messageBubble",{key:0},void 0,!0)])),default:e.withCtx((()=>[e.unref(eh)?e.renderSlot(t.$slots,"messageBubble",{key:0},void 0,!0):e.createCommentVNode("",!0)])),_:3},8,["messageItem","content","blinkMessageIDList","classNameList"])],32)):e.createCommentVNode("",!0)]))}}),qf=ee(jf,[["__scopeId","data-v-93a987ab"]]),Kf=ee(e.defineComponent({__name:"message-call-group",props:{message:{default:()=>({})},signalingInfo:{default:()=>({})},customContent:{default:()=>({})},blinkMessageIDList:{default:()=>[]}},setup(t){const n=t,o=gp.TYPES,a=e.computed((()=>!!n.signalingInfo)),i=e.computed((()=>{var e;return null==(e=n.message)?void 0:e.conversationType})),r=e.computed((()=>{var e;return null==(e=n.customContent)?void 0:e.custom})),s=e.computed((()=>{var e,t;return!!(null==(e=n.message)?void 0:e.ID)&&(null==(t=n.blinkMessageIDList)?void 0:t.includes(n.message.ID))}));return(t,n)=>e.unref(a)&&e.unref(i)===e.unref(o).CONV_GROUP?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"blink-text":e.unref(s)})},e.toDisplayString(e.unref(r)),3)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-674f4c0b"]]),Yf={androidInfo:{},apnsInfo:{}},$f={},Wf={[gp.TYPES.MSG_TEXT]:"[文本]",[gp.TYPES.MSG_FACE]:"[动画表情]",[gp.TYPES.MSG_IMAGE]:"[图片]",[gp.TYPES.MSG_FILE]:"[文件]",[gp.TYPES.MSG_AUDIO]:"[语音]",[gp.TYPES.MSG_VIDEO]:"[视频]",[gp.TYPES.MSG_LOCATION]:"[地理位置]",[gp.TYPES.MSG_MERGER]:"[聊天记录]",[gp.TYPES.MSG_CUSTOM]:"[自定义消息]"};var Zf=(e=>(e.CHAT="chat",e.CALL="call",e))(Zf||{});const Jf=((a=class{constructor(){this.name="OfflinePushInfoManager",this.offlinePushInfo={},this.offlinePushInfo={[Zf.CHAT]:Yf,[Zf.CALL]:$f}}static getInstance(){return a.instance||(a.instance=new a),a.instance}getOfflinePushInfo(e){return Object.values(Zf).includes(e)?this.offlinePushInfo[e]:(oe("error","at TUIKit/components/TUIChat/offlinePushInfoManager/offlinePushInfoManager.ts:32",`${this.name} getOfflinePushInfo scene: ${e} is invalid`),null)}genTitle(e,t){let n=null==e?void 0:e.getShowName();return e.type===gp.TYPES.CONV_C2C&&(n=(null==t?void 0:t.nick)||(null==t?void 0:t.userID)),n}genDesc(e,t){let n="";return e===gp.TYPES.MSG_TEXT&&(n=Fh(t.text)),e===gp.TYPES.MSG_CUSTOM&&(n=t.description),n||vp.t(`TUIChat.${Wf[e]}`)}create(e){var t;const{conversation:n,messageType:o="",payload:a={}}=e||{},i=mp.getData(tu.USER,"userProfile"),r={sender:n.type===gp.TYPES.CONV_GROUP?null==(t=n.groupProfile)?void 0:t.groupID:null==i?void 0:i.userID,nickName:null==i?void 0:i.nick,chatType:n.type===gp.TYPES.CONV_GROUP?2:1,version:1,action:1};return __spreadValues({title:this.genTitle(n,i),description:this.genDesc(o,a),extension:JSON.stringify({entity:r})},this.offlinePushInfo[Zf.CHAT])}}).instance=null,a).getInstance(),Xf=ee(e.defineComponent({__name:"message-call-c2c",props:{message:{type:Object,default:()=>({})},signalingInfo:{type:Object,default:()=>({})},customContent:{type:Object,default:()=>({})}},setup(t){const n=t,o=e.ref(gp.TYPES),a=e.computed((()=>null!=n.signalingInfo)),i=e.computed((()=>{var e,t;switch(null==(t=Wp(null==(e=n.signalingInfo)?void 0:e.data))?void 0:t.call_type){case 1:return{type:1,icon:"/assets/call-voice.f8912d47.svg"};case 2:return{type:2,icon:"/assets/call-video.6c7799e9.svg"}}return{type:0,icon:""}})),r=e.computed((()=>{var e;return null==(e=n.message)?void 0:e.conversationType})),s=e.computed((()=>{var e;return null==(e=n.customContent)?void 0:e.custom})),l=()=>{var e,t,o,a;if(r.value===gp.TYPES.CONV_C2C){const r="out"===(null==(e=n.message)?void 0:e.flow)?null==(t=n.message)?void 0:t.to:null==(o=n.message)?void 0:o.from;_t.callService({serviceName:nt.TUICalling.SERVICE.NAME,method:nt.TUICalling.SERVICE.METHOD.START_CALL,params:{userIDList:[r],type:null==(a=null==i?void 0:i.value)?void 0:a.type,callParams:{offlinePushInfo:Jf.getOfflinePushInfo(Zf.CALL)}}})}};return(n,c)=>e.unref(a)&&e.unref(r)===e.unref(o).CONV_C2C?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["call",["call-"+e.unref(r),"out"===t.message.flow&&"call-reverse"]]),onClick:l},[e.createElementVNode("div",{class:e.normalizeClass(["icon","out"===t.message.flow&&2===e.unref(i).type&&"icon-reverse"])},[e.createVNode(fh,{file:e.unref(i).icon},null,8,["file"])],2),e.createElementVNode("span",{class:"call-content"},e.toDisplayString(e.unref(s)),1)],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-3ce56025"]]);let Qf;Qf=3;const eg=p({__proto__:null,get vueVersion(){return 3}},[h]);var tg=function(e,t){return(tg=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};var ng,og=function(){return og=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var a in t=arguments[n])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e},og.apply(this,arguments)};function ag(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],o=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&o>=e.length&&(e=void 0),{value:e&&e[o++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function ig(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var o,a,i=n.call(e),r=[];try{for(;(void 0===t||t-- >0)&&!(o=i.next()).done;)r.push(o.value)}catch(s){a={error:s}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return r}function rg(e,t,n){if(2===arguments.length)for(var o,a=0,i=t.length;a<i;a++)!o&&a in t||(o||(o=Array.prototype.slice.call(t,0,a)),o[a]=t[a]);return e.concat(o||Array.prototype.slice.call(t))}var sg=[],lg=function(){function e(e){this.active=!0,this.effects=[],this.cleanups=[],this.vm=e}return e.prototype.run=function(e){if(this.active)try{return this.on(),e()}finally{this.off()}},e.prototype.on=function(){this.active&&(sg.push(this),ng=this)},e.prototype.off=function(){this.active&&(sg.pop(),ng=sg[sg.length-1])},e.prototype.stop=function(){this.active&&(this.vm.$destroy(),this.effects.forEach((function(e){return e.stop()})),this.cleanups.forEach((function(e){return e()})),this.active=!1)},e}(),cg=function(e){function t(t){void 0===t&&(t=!1);var n,o=void 0;return function(e){var t=mg;mg=!1;try{e()}finally{mg=t}}((function(){o=Gg(yg())})),n=e.call(this,o)||this,t||function(e,t){var n;if((t=t||ng)&&t.active)return void t.effects.push(e);var o=null===(n=kg())||void 0===n?void 0:n.proxy;o&&o.$on("hook:destroyed",(function(){return e.stop()}))}(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}tg(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}(t,e),t}(lg);function ug(){return ng}function dg(){var e,t;return(null===(e=ug())||void 0===e?void 0:e.vm)||(null===(t=kg())||void 0===t?void 0:t.proxy)}var pg=void 0;try{var hg=require("vue");hg&&_g(hg)?pg=hg:hg&&"default"in hg&&_g(hg.default)&&(pg=hg.default)}catch(tM){}var fg=null,gg=null,mg=!0,vg="__composition_api_installed__";function _g(e){return e&&Vg(e)&&"Vue"===e.name}function yg(){return fg}function Ig(){return fg||pg}function Cg(e){if(mg){var t=gg;null==t||t.scope.off(),null==(gg=e)||gg.scope.on()}}function kg(){return gg}var Eg=new WeakMap;function Tg(e){if(Eg.has(e))return Eg.get(e);var t={proxy:e,update:e.$forceUpdate,type:e.$options,uid:e._uid,emit:e.$emit.bind(e),parent:null,root:null};!function(e){if(!e.scope){var t=new lg(e.proxy);e.scope=t,e.proxy.$on("hook:destroyed",(function(){return t.stop()}))}e.scope}(t);return["data","props","attrs","refs","vnode","slots"].forEach((function(n){bg(t,n,{get:function(){return e["$".concat(n)]}})})),bg(t,"isMounted",{get:function(){return e._isMounted}}),bg(t,"isUnmounted",{get:function(){return e._isDestroyed}}),bg(t,"isDeactivated",{get:function(){return e._inactive}}),bg(t,"emitted",{get:function(){return e._events}}),Eg.set(e,t),e.$parent&&(t.parent=Tg(e.$parent)),e.$root&&(t.root=Tg(e.$root)),t}function Sg(e){return"function"==typeof e&&/native code/.test(e.toString())}var Mg="undefined"!=typeof Symbol&&Sg(Symbol)&&"undefined"!=typeof Reflect&&Sg(Reflect.ownKeys),wg=function(e){return e};function bg(e,t,n){var o=n.get,a=n.set;Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:o||wg,set:a||wg})}function Dg(e,t,n,o){Object.defineProperty(e,t,{value:n,enumerable:!!o,writable:!0,configurable:!0})}function Ng(e,t){return Object.hasOwnProperty.call(e,t)}function Rg(e){return Array.isArray(e)}var Lg,Ag=Object.prototype.toString,Og=function(e){return Ag.call(e)};function Pg(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)&&t<=4294967295}function Ug(e){return null!==e&&"object"==typeof e}function xg(e){return"[object Object]"===function(e){return Object.prototype.toString.call(e)}(e)}function Vg(e){return"function"==typeof e}function Bg(e,t){return t=t||kg()}function Gg(e,t){void 0===t&&(t={});var n=e.config.silent;e.config.silent=!0;var o=new e(t);return e.config.silent=n,o}function Fg(e,t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(e.$scopedSlots[t])return e.$scopedSlots[t].apply(e,n)}}function zg(e){return Mg?Symbol.for(e):e}var Hg=zg("composition-api.preFlushQueue"),jg=zg("composition-api.postFlushQueue"),qg="composition-api.refKey",Kg=new WeakMap,Yg=new WeakMap,$g=new WeakMap;function Wg(e,t,n){var o=yg().util;o.warn;var a=o.defineReactive,i=e.__ob__;function r(){i&&Ug(n)&&!Ng(n,"__ob__")&&dm(n)}if(Rg(e)){if(Pg(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),r(),n;if("length"===t&&n!==e.length)return e.length=n,null==i||i.dep.notify(),n}return t in e&&!(t in Object.prototype)?(e[t]=n,r(),n):e._isVue||i&&i.vmCount?n:i?(a(i.value,t,n),cm(e,t,n),r(),i.dep.notify(),n):(e[t]=n,n)}var Zg=!1;function Jg(e){Zg=e}var Xg=function(){return function(e){bg(this,"value",{get:e.get,set:e.set})}}();function Qg(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1);var o=new Xg(e);n&&(o.effect=!0);var a=Object.seal(o);return t&&$g.set(a,!0),a}function em(e){var t;if(tm(e))return e;var n=fm(((t={})[qg]=e,t));return Qg({get:function(){return n[qg]},set:function(e){return n[qg]=e}})}function tm(e){return e instanceof Xg}function nm(e){return tm(e)?e.value:e}function om(e){if(!xg(e))return e;var t={};for(var n in e)t[n]=am(e,n);return t}function am(e,t){t in e||Wg(e,t,void 0);var n=e[t];return tm(n)?n:Qg({get:function(){return e[t]},set:function(n){return e[t]=n}})}var im="__v_skip";function rm(e){var t;return Boolean(e&&Ng(e,"__ob__")&&"object"==typeof e.__ob__&&(null===(t=e.__ob__)||void 0===t?void 0:t[im]))}function sm(e){var t;return Boolean(e&&Ng(e,"__ob__")&&"object"==typeof e.__ob__&&!(null===(t=e.__ob__)||void 0===t?void 0:t[im]))}function lm(e){if(!(!xg(e)||rm(e)||Rg(e)||tm(e)||(t=e,n=yg(),n&&t instanceof n)||Kg.has(e))){var t,n;Kg.set(e,!0);for(var o=Object.keys(e),a=0;a<o.length;a++)cm(e,o[a])}}function cm(e,t,n){if("__ob__"!==t&&!rm(e[t])){var o,a,i=Object.getOwnPropertyDescriptor(e,t);if(i){if(!1===i.configurable)return;o=i.get,a=i.set,o&&!a||2!==arguments.length||(n=e[t])}lm(n),bg(e,t,{get:function(){var a=o?o.call(e):n;return t!==qg&&tm(a)?a.value:a},set:function(i){o&&!a||(t!==qg&&tm(n)&&!tm(i)?n.value=i:a?(a.call(e,i),n=i):n=i,lm(i))}})}}function um(e){var t,n=Ig();n.observable?t=n.observable(e):t=Gg(n,{data:{$$state:e}})._data.$$state;return Ng(t,"__ob__")||dm(t),t}function dm(e,t){var n,o;if(void 0===t&&(t=new Set),!t.has(e)&&!Ng(e,"__ob__")&&Object.isExtensible(e)){Dg(e,"__ob__",function(e){void 0===e&&(e={});return{value:e,dep:{notify:wg,depend:wg,addSub:wg,removeSub:wg}}}(e)),t.add(e);try{for(var a=ag(Object.keys(e)),i=a.next();!i.done;i=a.next()){var r=e[i.value];(xg(r)||Rg(r))&&!rm(r)&&Object.isExtensible(r)&&dm(r,t)}}catch(s){n={error:s}}finally{try{i&&!i.done&&(o=a.return)&&o.call(a)}finally{if(n)throw n.error}}}}function pm(){return um({}).__ob__}function hm(e){var t,n;if(!Ug(e))return e;if(!xg(e)&&!Rg(e)||rm(e)||!Object.isExtensible(e))return e;var o=um(Rg(e)?[]:{}),a=o.__ob__,i=function(t){var n,i,r=e[t],s=Object.getOwnPropertyDescriptor(e,t);if(s){if(!1===s.configurable)return"continue";n=s.get,i=s.set}bg(o,t,{get:function(){var e;return null===(e=a.dep)||void 0===e||e.depend(),r},set:function(t){var o;n&&!i||(Zg||r!==t)&&(i?i.call(e,t):r=t,null===(o=a.dep)||void 0===o||o.notify())}})};try{for(var r=ag(Object.keys(e)),s=r.next();!s.done;s=r.next()){i(s.value)}}catch(l){t={error:l}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return o}function fm(e){if(!Ug(e))return e;if(!xg(e)&&!Rg(e)||rm(e)||!Object.isExtensible(e))return e;var t=um(e);return lm(t),t}function gm(e){return function(t,n){var o,a=Bg("on".concat((o=e)[0].toUpperCase()+o.slice(1)),n);return a&&function(e,t,n,o){var a=t.proxy.$options,i=e.config.optionMergeStrategies[n],r=function(e,t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var a=kg();Cg(e);try{return t.apply(void 0,rg([],ig(n),!1))}finally{Cg(a)}}}(t,o);return a[n]=i(a[n],r),r}(yg(),a,e,t)}}var mm,vm=gm("beforeMount"),_m=gm("mounted"),ym=gm("beforeUpdate"),Im=gm("updated"),Cm=gm("beforeDestroy"),km=gm("destroyed"),Em=gm("errorCaptured"),Tm=gm("activated"),Sm=gm("deactivated"),Mm=gm("serverPrefetch");function wm(){Nm(this,Hg)}function bm(){Nm(this,jg)}function Dm(){var e=dg();return e?function(e){return void 0!==e[Hg]}(e)||function(e){e[Hg]=[],e[jg]=[],e.$on("hook:beforeUpdate",wm),e.$on("hook:updated",bm)}(e):(mm||(mm=Gg(yg())),e=mm),e}function Nm(e,t){for(var n=e[t],o=0;o<n.length;o++)n[o]();n.length=0}function Rm(e,t,n){var o=function(){e.$nextTick((function(){e[Hg].length&&Nm(e,Hg),e[jg].length&&Nm(e,jg)}))};switch(n){case"pre":o(),e[Hg].push(t);break;case"post":o(),e[jg].push(t);break;default:!function(e,t){throw new Error("[vue-composition-api] ".concat(t))}(0,'flush must be one of ["post", "pre", "sync"], but got '.concat(n))}}function Lm(e,t){var n=e.teardown;e.teardown=function(){for(var o=[],a=0;a<arguments.length;a++)o[a]=arguments[a];n.apply(e,o),t()}}function Am(e,t,n,o){var a,i,r=o.flush,s="sync"===r,l=function(e){i=function(){try{e()}catch(t){!function(e){if("undefined"==typeof window||"undefined"==typeof console)throw e}(t)}}},c=function(){i&&(i(),i=null)},u=function(t){return s||e===mm?t:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return Rm(e,(function(){t.apply(void 0,rg([],ig(n),!1))}),r)}};if(null===n){var d=!1,p=function(e,t,n,o){var a=e._watchers.length;return e.$watch(t,n,{immediate:o.immediateInvokeCallback,deep:o.deep,lazy:o.noRun,sync:o.sync,before:o.before}),e._watchers[a]}(e,(function(){if(!d)try{d=!0,t(l)}finally{d=!1}}),wg,{deep:o.deep||!1,sync:s,before:c});Lm(p,c),p.lazy=!1;var h=p.get.bind(p);return p.get=u(h),function(){p.teardown()}}var f,g=o.deep,m=!1;if(tm(t)?f=function(){return t.value}:sm(t)?(f=function(){return t},g=!0):Rg(t)?(m=!0,f=function(){return t.map((function(e){return tm(e)?e.value:sm(e)?Pm(e):Vg(e)?e():wg}))}):f=Vg(t)?t:wg,g){var v=f;f=function(){return Pm(v())}}var _=function(e,t){if(g||!m||!e.every((function(e,n){return o=e,a=t[n],o===a?0!==o||1/o==1/a:o!=o&&a!=a;var o,a})))return c(),n(e,t,l)},y=u(_);if(o.immediate){var I=y,C=function(e,t){return C=I,_(e,Rg(e)?[]:t)};y=function(e,t){return C(e,t)}}var k=e.$watch(f,y,{immediate:o.immediate,deep:g,sync:s}),E=e._watchers[e._watchers.length-1];return sm(E.value)&&(null===(a=E.value.__ob__)||void 0===a?void 0:a.dep)&&g&&E.value.__ob__.dep.addSub({update:function(){E.run()}}),Lm(E,c),function(){k()}}function Om(e,t){var n=function(e){return og({flush:"pre"},e)}(t);return Am(Dm(),e,null,n)}function Pm(e,t){if(void 0===t&&(t=new Set),!Ug(e)||t.has(e)||Yg.has(e))return e;if(t.add(e),tm(e))Pm(e.value,t);else if(Rg(e))for(var n=0;n<e.length;n++)Pm(e[n],t);else if("[object Set]"===Og(e)||function(e){return"[object Map]"===Og(e)}(e))e.forEach((function(e){Pm(e,t)}));else if(xg(e))for(var o in e)Pm(e[o],t);return e}var Um={};var xm={},Vm=function(e){var t;void 0===e&&(e="$style");var n=kg();if(!n)return xm;var o=null===(t=n.proxy)||void 0===t?void 0:t[e];return o||xm},Bm=Vm;var Gm;function Fm(){return kg().setupContext}var zm={set:function(e,t,n){(e.__composition_api_state__=e.__composition_api_state__||{})[t]=n},get:function(e,t){return(e.__composition_api_state__||{})[t]}};function Hm(e){var t=zm.get(e,"rawBindings")||{};if(t&&Object.keys(t).length){for(var n=e.$refs,o=zm.get(e,"refs")||[],a=0;a<o.length;a++){var i=t[l=o[a]];!n[l]&&i&&tm(i)&&(i.value=null)}var r=Object.keys(n),s=[];for(a=0;a<r.length;a++){var l;i=t[l=r[a]];n[l]&&i&&tm(i)&&(i.value=n[l],s.push(l))}zm.set(e,"refs",s)}}function jm(e){for(var t=[e._vnode];t.length;){var n=t.pop();if(n&&(n.context&&Hm(n.context),n.children))for(var o=0;o<n.children.length;++o)t.push(n.children[o])}}function qm(e,t){var n,o;if(e){var a=zm.get(e,"attrBindings");if(a||t){if(!a){var i=fm({});a={ctx:t,data:i},zm.set(e,"attrBindings",a),bg(t,"attrs",{get:function(){return null==a?void 0:a.data},set:function(){}})}var r=e.$attrs,s=function(t){Ng(a.data,t)||bg(a.data,t,{get:function(){return e.$attrs[t]}})};try{for(var l=ag(Object.keys(r)),c=l.next();!c.done;c=l.next()){s(c.value)}}catch(u){n={error:u}}finally{try{c&&!c.done&&(o=l.return)&&o.call(l)}finally{if(n)throw n.error}}}}}function Km(e,t){var n=e.$options._parentVnode;if(n){for(var o=zm.get(e,"slots")||[],a=function(e,t){var n;if(e){if(e._normalized)return e._normalized;for(var o in n={},e)e[o]&&"$"!==o[0]&&(n[o]=!0)}else n={};for(var o in t)o in n||(n[o]=!0);return n}(n.data.scopedSlots,e.$slots),i=0;i<o.length;i++){a[s=o[i]]||delete t[s]}var r=Object.keys(a);for(i=0;i<r.length;i++){var s;t[s=r[i]]||(t[s]=Fg(e,s))}zm.set(e,"slots",r)}}function Ym(e,t,n){var o=kg();Cg(e);try{return t(e)}catch(a){throw a}finally{Cg(o)}}function $m(e){function t(e,n){if(void 0===n&&(n=new Set),!n.has(e)&&xg(e)&&!tm(e)&&!sm(e)&&!rm(e)){var o=yg().util.defineReactive;Object.keys(e).forEach((function(a){var i=e[a];o(e,a,i),i&&(n.add(i),t(i,n))}))}}function n(e,t){return void 0===t&&(t=new Map),t.has(e)?t.get(e):(t.set(e,!1),Rg(e)&&sm(e)?(t.set(e,!0),!0):!(!xg(e)||rm(e)||tm(e))&&Object.keys(e).some((function(o){return n(e[o],t)})))}e.mixin({beforeCreate:function(){var e=this,o=e.$options,a=o.setup,i=o.render;i&&(o.render=function(){for(var t=this,n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];return Ym(Tg(e),(function(){return i.apply(t,n)}))});if(!a)return;if(!Vg(a))return;var r=o.data;o.data=function(){return function(e,o){void 0===o&&(o={});var a,i=e.$options.setup,r=function(e){var t={slots:{}},n=["emit"];return["root","parent","refs","listeners","isServer","ssrContext"].forEach((function(n){var o="$".concat(n);bg(t,n,{get:function(){return e[o]},set:function(){}})})),qm(e,t),n.forEach((function(n){var o="$".concat(n);bg(t,n,{get:function(){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e[o].apply(e,t)}}})})),t}(e),s=Tg(e);if(s.setupContext=r,Dg(o,"__ob__",pm()),Km(e,r.slots),Ym(s,(function(){a=i(o,r)})),!a)return;if(Vg(a)){var l=a;return void(e.$options.render=function(){return Km(e,r.slots),Ym(s,(function(){return l()}))})}if(Ug(a)){sm(a)&&(a=om(a)),zm.set(e,"rawBindings",a);var c=a;Object.keys(c).forEach((function(o){var a=c[o];if(!tm(a))if(sm(a))Rg(a)&&(a=em(a));else if(Vg(a)){var i=a;a=a.bind(e),Object.keys(i).forEach((function(e){a[e]=i[e]}))}else Ug(a)?n(a)&&t(a):a=em(a);!function(e,t,n){var o=e.$options.props;t in e||o&&Ng(o,t)||(tm(n)?bg(e,t,{get:function(){return n.value},set:function(e){n.value=e}}):bg(e,t,{get:function(){return sm(n)&&n.__ob__.dep.depend(),n},set:function(e){n=e}}))}(e,o,a)}))}}(e,e.$props),Vg(r)?r.call(e,e):r||{}}},mounted:function(){jm(this)},beforeUpdate:function(){qm(this)},updated:function(){jm(this)}})}function Wm(e,t){if(!e)return t;if(!t)return e;for(var n,o,a,i=Mg?Reflect.ownKeys(e):Object.keys(e),r=0;r<i.length;r++)"__ob__"!==(n=i[r])&&(o=t[n],a=e[n],Ng(t,n)?o!==a&&xg(o)&&!tm(o)&&xg(a)&&!tm(a)&&Wm(a,o):t[n]=a);return t}function Zm(e){(function(e){return fg&&Ng(e,vg)})(e)||(e.config.optionMergeStrategies.setup=function(e,t){return function(n,o){return Wm(Vg(e)?e(n,o)||{}:void 0,Vg(t)?t(n,o)||{}:void 0)}},function(e){fg=e,Object.defineProperty(e,vg,{configurable:!0,writable:!0,value:!0})}(e),$m(e))}var Jm={install:function(e){return Zm(e)}};"undefined"!=typeof window&&window.Vue&&window.Vue.use(Jm);const Xm=Object.freeze(Object.defineProperty({__proto__:null,EffectScope:cg,computed:function(e){var t,n,o,a,i=dg();if(Vg(e)?t=e:(t=e.get,n=e.set),i&&!i.$isServer){var r,s=function(){if(!Lg){var e=Gg(yg(),{computed:{value:function(){return 0}}}),t=e._computedWatchers.value.constructor,n=e._data.__ob__.dep.constructor;Lg={Watcher:t,Dep:n},e.$destroy()}return Lg}(),l=s.Watcher,c=s.Dep;a=function(){return r||(r=new l(i,t,wg,{lazy:!0})),r.dirty&&r.evaluate(),c.target&&r.depend(),r.value},o=function(e){n&&n(e)}}else{var u=Gg(yg(),{computed:{$$state:{get:t,set:n}}});i&&i.$on("hook:destroyed",(function(){return u.$destroy()})),a=function(){return u.$$state},o=function(e){u.$$state=e}}return Qg({get:a,set:o},!n,!0)},createApp:function(e,t){void 0===t&&(t=void 0);var n=yg(),o=void 0,a={},i={config:n.config,use:n.use.bind(n),mixin:n.mixin.bind(n),component:n.component.bind(n),provide:function(e,t){return a[e]=t,this},directive:function(e,t){return t?(n.directive(e,t),i):n.directive(e)},mount:function(i,r){return o||((o=new n(og(og({propsData:t},e),{provide:og(og({},a),e.provide)}))).$mount(i,r),o)},unmount:function(){o&&(o.$destroy(),o=void 0)}};return i},createRef:Qg,customRef:function(e){var t=em(0);return Qg(e((function(){t.value}),(function(){++t.value})))},default:Jm,defineAsyncComponent:function(e){Vg(e)&&(e={loader:e});var t=e.loader,n=e.loadingComponent,o=e.errorComponent,a=e.delay,i=void 0===a?200:a,r=e.timeout;e.suspensible;var s=e.onError,l=null,c=0,u=function(){var e;return l||(e=l=t().catch((function(e){if(e=e instanceof Error?e:new Error(String(e)),s)return new Promise((function(t,n){s(e,(function(){return t((c++,l=null,u()))}),(function(){return n(e)}),c+1)}));throw e})).then((function(t){return e!==l&&l?l:(t&&(t.__esModule||"Module"===t[Symbol.toStringTag])&&(t=t.default),t)})))};return function(){return{component:u(),delay:i,timeout:r,error:o,loading:n}}},defineComponent:function(e){return e},del:function(e,t){if(yg().util.warn,Rg(e)&&Pg(t))e.splice(t,1);else{var n=e.__ob__;e._isVue||n&&n.vmCount||Ng(e,t)&&(delete e[t],n&&n.dep.notify())}},effectScope:function(e){return new cg(e)},getCurrentInstance:kg,getCurrentScope:ug,h:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=(null==this?void 0:this.proxy)||(null===(e=kg())||void 0===e?void 0:e.proxy);return o?o.$createElement.apply(o,t):(Gm||(Gm=Gg(yg()).$createElement),Gm.apply(Gm,t))},inject:function(e,t,n){var o;void 0===n&&(n=!1);var a=null===(o=kg())||void 0===o?void 0:o.proxy;if(a){if(!e)return t;var i=function(e,t){for(var n=t;n;){if(n._provided&&Ng(n._provided,e))return n._provided[e];n=n.$parent}return Um}(e,a);return i!==Um?i:arguments.length>1?n&&Vg(t)?t():t:void 0}},isRaw:rm,isReactive:sm,isReadonly:function(e){return $g.has(e)},isRef:tm,markRaw:function(e){if(!xg(e)&&!Rg(e)||!Object.isExtensible(e))return e;var t=pm();return t[im]=!0,Dg(e,"__ob__",t),Yg.set(e,!0),e},nextTick:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return null===(e=yg())||void 0===e?void 0:e.nextTick.apply(this,t)},onActivated:Tm,onBeforeMount:vm,onBeforeUnmount:Cm,onBeforeUpdate:ym,onDeactivated:Sm,onErrorCaptured:Em,onMounted:_m,onScopeDispose:function(e){ng&&ng.cleanups.push(e)},onServerPrefetch:Mm,onUnmounted:km,onUpdated:Im,provide:function(e,t){var n,o=null===(n=Bg())||void 0===n?void 0:n.proxy;if(o){if(!o._provided){var a={};bg(o,"_provided",{get:function(){return a},set:function(e){return Object.assign(a,e)}})}o._provided[e]=t}},proxyRefs:function(e){var t,n,o;if(sm(e))return e;var a=fm(((t={})[qg]=e,t));Dg(a,qg,a[qg],!1);var i=function(e){bg(a,e,{get:function(){return tm(a[qg][e])?a[qg][e].value:a[qg][e]},set:function(t){if(tm(a[qg][e]))return a[qg][e].value=nm(t);a[qg][e]=nm(t)}})};try{for(var r=ag(Object.keys(e)),s=r.next();!s.done;s=r.next()){i(s.value)}}catch(l){n={error:l}}finally{try{s&&!s.done&&(o=r.return)&&o.call(r)}finally{if(n)throw n.error}}return a},reactive:fm,readonly:function(e){return $g.set(e,!0),e},ref:em,set:Wg,shallowReactive:hm,shallowReadonly:function(e){var t,n;if(!Ug(e))return e;if(!xg(e)&&!Rg(e)||!Object.isExtensible(e)&&!tm(e))return e;var o=tm(e)?new Xg({}):sm(e)?um({}):{},a=fm({}).__ob__,i=function(t){var n,i=e[t],r=Object.getOwnPropertyDescriptor(e,t);if(r){if(!1===r.configurable&&!tm(e))return"continue";n=r.get}bg(o,t,{get:function(){var t=n?n.call(e):i;return a.dep.depend(),t},set:function(e){}})};try{for(var r=ag(Object.keys(e)),s=r.next();!s.done;s=r.next()){i(s.value)}}catch(l){t={error:l}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return $g.set(o,!0),o},shallowRef:function(e){var t;if(tm(e))return e;var n=hm(((t={})[qg]=e,t));return Qg({get:function(){return n[qg]},set:function(e){return n[qg]=e}})},toRaw:function(e){var t;return rm(e)||!Object.isExtensible(e)?e:(null===(t=null==e?void 0:e.__ob__)||void 0===t?void 0:t.value)||e},toRef:am,toRefs:om,triggerRef:function(e){tm(e)&&(Jg(!0),e.value=e.value,Jg(!1))},unref:nm,useAttrs:function(){return Fm().attrs},useCSSModule:Bm,useCssModule:Vm,useSlots:function(){return Fm().slots},version:"1.7.2",warn:function(e){var t,n,o,a;n=e,o=null===(t=kg())||void 0===t?void 0:t.proxy,(a=Ig())&&a.util&&a.util.warn(n,o)},watch:function(e,t,n){var o=null;Vg(t)?o=t:(n=t,o=null);var a=function(e){return og({immediate:!1,deep:!1,flush:"pre"},e)}(n);return Am(Dm(),e,o,a)},watchEffect:Om,watchPostEffect:function(e){return Om(e,{flush:"post"})},watchSyncEffect:function(e){return Om(e,{flush:"sync"})}},Symbol.toStringTag,{value:"Module"}));let Qm,ev={default:{}};ev=h||ev;let tv=(e,t)=>({}),nv=(e,t)=>{},ov=()=>{},av=()=>{},iv=e=>e;try{(null==(i=null==ev?void 0:ev.default)?void 0:i.version)&&(null==(s=null==(r=null==ev?void 0:ev.default)?void 0:r.version)?void 0:s.startsWith("2.7."))?Qm=2.7:(null==(l=null==ev?void 0:ev.default)?void 0:l.version)&&(null==(u=null==(c=null==ev?void 0:ev.default)?void 0:c.version)?void 0:u.startsWith("2."))?Qm=2:(Qm=3,tv=null==ev?void 0:ev.createVNode,nv=null==ev?void 0:ev.render,ov=null==ev?void 0:ev.defineProps,av=null==ev?void 0:ev.defineEmits,iv=null==ev?void 0:ev.withDefaults)}catch(nM){Qm=3,tv=null==ev?void 0:ev.createVNode,nv=null==ev?void 0:ev.render,ov=null==ev?void 0:ev.defineProps,av=null==ev?void 0:ev.defineEmits,iv=null==ev?void 0:ev.withDefaults}oe("warn","at TUIKit/tui-customer-service-plugin/adapter-vue-web.ts:64",`[adapter-vue]: vue version is ${Qm}`);let rv=ev;2===Qm&&(rv=Xm);const sv=Object.freeze(Object.defineProperty({__proto__:null,get createVNode(){return tv},get defineEmits(){return av},get defineProps(){return ov},get render(){return nv},get vue(){return rv},get vueVersion(){return Qm},get withDefaults(){return iv}},Symbol.toStringTag,{value:"Module"}));let lv=eg;window&&!window.uni&&(lv=__spreadValues(__spreadValues({},sv),rv));const cv=lv;Gp(),Gp(),Gp();const uv="app"===Gp();const dv=ee({props:{src:{type:String,default:""},width:{type:String,default:"16px"},height:{type:String,default:"16px"}},setup:e=>({props:e,isApp:uv})},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("div",{class:"common-icon-container"},[a.isApp?(e.openBlock(),e.createElementBlock("image",{key:0,class:"common-icon",src:a.props.src,style:e.normalizeStyle({width:a.props.width,height:a.props.height})},null,12,["src"])):(e.openBlock(),e.createElementBlock("img",{key:1,class:"common-icon",src:a.props.src,style:e.normalizeStyle({width:a.props.width,height:a.props.height})},null,12,["src"]))])}],["__scopeId","data-v-2164e32d"]]),{computed:pv}=cv;const hv=ee({components:{Icon:dv},props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:(e,{emit:t})=>({content:pv((()=>{var t;return(null==(t=null==e?void 0:e.payload)?void 0:t.content)||{header:void 0,items:[]}})),handleContentListItemClick:e=>{t("sendMessage",{text:e.content})},iconRight:"/assets/iconRight.eac74a1a.svg"})},[["render",function(t,n,o,a,i,r){const s=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",{class:"branch-card"},[a.content.header||a.content.title?(e.openBlock(),e.createElementBlock("p",{key:0,class:"branch-title"},e.toDisplayString(a.content.header||a.content.title),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.content.items,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:"branch-item",style:e.normalizeStyle({borderWidth:a.content.header?"1px 0 0px 0":"0px 0 1px 0"}),onClick:e=>a.handleContentListItemClick(t)},[e.createTextVNode(e.toDisplayString(t.content)+" ",1),e.createVNode(s,{src:a.iconRight},null,8,["src"])],12,["onClick"])))),128))])}],["__scopeId","data-v-fd712030"]]);const fv=ee({props:{title:{type:String,default:""},list:{type:Array,default:()=>[]}},emits:["input-click"],setup:(e,{emit:t})=>({props:e,listItemClick:e=>{t("input-click",e)}})},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("div",null,[a.props.title?(e.openBlock(),e.createElementBlock("p",{key:0,class:"card-title"},e.toDisplayString(a.props.title),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.props.list,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:"form-branch-item",onClick:e=>a.listItemClick(t)},e.toDisplayString(t.content),9,["onClick"])))),128))])}],["__scopeId","data-v-017a22d5"]]),{ref:gv}=cv;const mv=ee({props:{title:{type:String,default:""}},emits:["input-submit"],setup(e,{emit:t}){const n=gv(!1),o=gv("");return{disabled:n,text:o,listItemClick:()=>{n.value=!0,t("input-submit",o.value)},props:e}}},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("div",null,[e.createElementVNode("div",{class:"card-title"},e.toDisplayString(a.props.title),1),e.createElementVNode("div",{class:"form-input-box"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":n[0]||(n[0]=e=>a.text=e),class:"form-input"},null,512),[[e.vModelText,a.text]]),e.createElementVNode("button",{class:"form-button",disabled:a.disabled,onClick:n[1]||(n[1]=(...e)=>a.listItemClick&&a.listItemClick(...e))},null,8,["disabled"])])])}],["__scopeId","data-v-586471a3"]]),{computed:vv}=cv;const _v=ee({components:{FormBranch:fv,FormInput:mv},props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:(e,{emit:t})=>({content:vv((()=>{var t;return(null==(t=e.payload)?void 0:t.content)||{type:0,header:"",items:[]}})),handleContentListItemClick:e=>{t("sendMessage",{text:e.content})},handleFormSaveInputSubmit:e=>{t("sendMessage",{text:e})}})},[["render",function(t,n,o,a,i,r){const s=e.resolveComponent("FormBranch"),l=e.resolveComponent("FormInput");return 1===a.content.type?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-form"},[e.createVNode(s,{title:a.content.header,list:a.content.items,onInputClick:a.handleContentListItemClick},null,8,["title","list","onInputClick"])])):(e.openBlock(),e.createElementBlock("div",{key:1,class:"message-form"},[e.createVNode(l,{title:a.content.header,onInputSubmit:a.handleFormSaveInputSubmit},null,8,["title","onInputSubmit"])]))}],["__scopeId","data-v-4a584f62"]]);const yv=ee({props:{payload:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:e=>({props:e,isApp:uv,jumpProductCard:()=>{window?window.open(e.payload.content.url,"_blank"):uni&&uni.navigateTo({url:`/TUIKit/components/TUIChat/web-view?url=${e.payload.content.url}`})}})},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("div",{class:"message-product-card",onClick:n[0]||(n[0]=(...e)=>a.jumpProductCard&&a.jumpProductCard(...e))},[a.isApp?(e.openBlock(),e.createElementBlock("image",{key:0,class:"product-img",src:a.props.payload.content.pic},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:1,class:"product-img",src:a.props.payload.content.pic},null,8,["src"])),e.createElementVNode("div",{class:"product-card-information"},[e.createElementVNode("div",{class:"product-card-title"},e.toDisplayString(a.props.payload.content.header),1),e.createElementVNode("div",{class:"product-card-description"},e.toDisplayString(a.props.payload.content.desc),1)])])}],["__scopeId","data-v-eef6c3b9"]]),{computed:Iv}=cv;const Cv=ee({components:{MessageBranch:hv,MessageForm:_v,MessageProductCard:yv},props:{message:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:(e,{emit:t})=>({payload:Iv((()=>{var t,n;return e.message&&Pf(null==(n=null==(t=e.message)?void 0:t.payload)?void 0:n.data)})),sendTextMessage:e=>{t("sendMessage",e)},CUSTOM_MESSAGE_SRC:Lf})},[["render",function(t,n,o,a,i,r){const s=e.resolveComponent("MessageBranch"),l=e.resolveComponent("MessageForm"),c=e.resolveComponent("MessageProductCard");return e.openBlock(),e.createElementBlock("div",{class:"custom"},[a.payload.src===a.CUSTOM_MESSAGE_SRC.BRANCH||a.payload.src===a.CUSTOM_MESSAGE_SRC.BRANCH_NUMBER?(e.openBlock(),e.createElementBlock("div",{key:0},[e.createVNode(s,{payload:a.payload,onSendMessage:a.sendTextMessage},null,8,["payload","onSendMessage"])])):e.createCommentVNode("",!0),a.payload.src===a.CUSTOM_MESSAGE_SRC.FROM_INPUT?(e.openBlock(),e.createElementBlock("div",{key:1},[e.createVNode(l,{payload:a.payload,onSendMessage:a.sendTextMessage},null,8,["payload","onSendMessage"])])):e.createCommentVNode("",!0),a.payload.src===a.CUSTOM_MESSAGE_SRC.PRODUCT_CARD?(e.openBlock(),e.createElementBlock("div",{key:2},[e.createVNode(c,{payload:a.payload},null,8,["payload"])])):e.createCommentVNode("",!0)])}]]),{computed:kv,ref:Ev,watchEffect:Tv}=cv;const Sv=ee({components:{Icon:dv},props:{ratingTemplate:{type:Object,default:()=>({})}},emits:["sendMessage"],setup(e,{emit:t}){const n=Ev(!1),o=Ev(""),a=Ev(-1),i=Ev(-1),r=Ev(!1);Tv((()=>{if(o.value=e.ratingTemplate.sessionId||"",null!=e.ratingTemplate.selected)for(let t=0;t<e.ratingTemplate.menu.length;t++)if(e.ratingTemplate.menu[t].id==e.ratingTemplate.selected.id){n.value=!0,a.value=t;break}Math.floor((new Date).getTime()/1e3)>e.ratingTemplate.expireTime&&(r.value=!0)}));const s=kv((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map((e=>e.content))})),l=kv((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map(((e,t)=>-1!==i.value?t<=i.value?1:0:t<=a.value?1:0))}));return{props:e,hasReply:n,sessionId:o,value:a,hoverValue:i,hasExpire:r,desc:s,starList:l,setValue:e=>{n.value||(a.value=e)},setHoverValue:e=>{n.value||(i.value=e)},submitRatingStar:()=>__async(this,null,(function*(){if(a.value<0)return;const i={data:JSON.stringify({src:Lf.MENU_SELECTED,menuSelected:{id:e.ratingTemplate.menu[a.value].id,content:e.ratingTemplate.menu[a.value].content,sessionId:o.value},customerServicePlugin:0})};n.value=!0,t("sendMessage",i)})),star:"/assets/star.0d13712b.png",starLine:"/assets/starLine.f4211758.png"}}},[["render",function(t,n,o,a,i,r){const s=e.resolveComponent("Icon");return e.openBlock(),e.createElementBlock("div",{class:"message-rating-star"},[e.createElementVNode("p",{class:"rating-head"},e.toDisplayString(a.props.ratingTemplate.head),1),e.createElementVNode("div",{class:"rating-card"},[e.createElementVNode("span",{class:"card-title"},"请对本次服务进行评价"),e.createElementVNode("div",{class:"card-wrapper"},[e.createElementVNode("div",{style:{"max-width":"200px"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.starList,((t,o)=>(e.openBlock(),e.createElementBlock("div",{key:o,style:{display:"inline-block"},onClick:e=>a.setValue(o),onMouseenter:e=>a.setHoverValue(o),onMouseleave:n[0]||(n[0]=e=>a.setHoverValue(-1))},[1===t?(e.openBlock(),e.createBlock(s,{key:0,src:a.star,width:"30px",height:"30px"},null,8,["src"])):(e.openBlock(),e.createBlock(s,{key:1,src:a.starLine,width:"30px",height:"30px"},null,8,["src"]))],40,["onClick","onMouseenter"])))),128))])]),e.createElementVNode("div",{style:{marginTop:"10px",marginBottom:"10px"}},e.toDisplayString(-1===a.hoverValue?-1===a.value?"如果满意请给好评哦～":a.desc[a.value]:a.desc[a.hoverValue]),1),e.createElementVNode("button",{class:"submit-button",disabled:a.hasReply||a.hasExpire,onClick:n[1]||(n[1]=(...e)=>a.submitRatingStar&&a.submitRatingStar(...e))}," 提交评价 ",8,["disabled"])]),a.hasReply?(e.openBlock(),e.createElementBlock("p",{key:0,class:"rating-tail",style:{marginTop:"20px"}},e.toDisplayString(a.props.ratingTemplate.tail),1)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-2f36823b"]]),{computed:Mv,ref:wv,watchEffect:bv}=cv;const Dv=ee({props:{ratingTemplate:{type:Object,default:()=>({})}},emits:["sendMessage"],setup(e,{emit:t}){const n=wv(!1),o=wv(""),a=wv(-1),i=wv(-1),r=wv(!1),s=Mv((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map((e=>e.content))})),l=Mv((()=>{var t;return null==(t=e.ratingTemplate)?void 0:t.menu.map(((e,t)=>t))}));bv((()=>{if(o.value=e.ratingTemplate.sessionId||"",null!=e.ratingTemplate.selected)for(let t=0;t<e.ratingTemplate.menu.length;t++)if(e.ratingTemplate.menu[t].id==e.ratingTemplate.selected.id){n.value=!0,a.value=t;break}Math.floor((new Date).getTime()/1e3)>e.ratingTemplate.expireTime&&(r.value=!0)}));return{props:e,hasReply:n,sessionId:o,selectValue:a,hoverValue:i,hasExpire:r,desc:s,numberList:l,setValue:e=>{n.value||(a.value=e)},setHoverValue:e=>{n.value||(i.value=e)},submitRatingStar:()=>{if(a.value>=0){const i={data:JSON.stringify({src:Lf.MENU_SELECTED,menuSelected:{id:e.ratingTemplate.menu[a.value].id,content:e.ratingTemplate.menu[a.value].content,sessionId:o.value},customerServicePlugin:0})};n.value=!0,t("sendMessage",i)}}}}},[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("div",{class:"message-rating-star"},[e.createElementVNode("p",{class:"rating-head"},e.toDisplayString(a.props.ratingTemplate.head),1),e.createElementVNode("div",{class:"rating-card"},[e.createElementVNode("span",{class:"card-title"},"请对本次服务进行评价"),e.createElementVNode("div",{class:"card-wrapper"},[e.createElementVNode("div",{style:{"max-width":"250px"}},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.numberList,((t,o)=>(e.openBlock(),e.createElementBlock("div",{key:o,class:e.normalizeClass({active:!(o!==a.selectValue&&o!==a.hoverValue),"de-active":o!==a.selectValue&&o!==a.hoverValue}),style:e.normalizeStyle({marginLeft:0===o?"0px":"20px",margin:"5px"}),onClick:e=>a.setValue(o),onMouseenter:e=>a.setHoverValue(o),onMouseleave:n[0]||(n[0]=e=>a.setHoverValue(-1))},e.toDisplayString(t+1),47,["onClick","onMouseenter"])))),128))])]),e.createElementVNode("div",{style:{marginTop:"10px",marginBottom:"10px"}},e.toDisplayString(-1===a.hoverValue?-1===a.selectValue?"如果满意请给好评哦～":a.desc[a.selectValue]:a.desc[a.hoverValue]),1),e.createElementVNode("button",{class:"submit-button",disabled:a.hasReply||a.hasExpire,onClick:n[1]||(n[1]=(...e)=>a.submitRatingStar&&a.submitRatingStar(...e))}," 提交评价 ",8,["disabled"])]),a.hasReply?(e.openBlock(),e.createElementBlock("p",{key:0,class:"rating-tail",style:{marginTop:"20px"}},e.toDisplayString(a.props.ratingTemplate.tail),1)):e.createCommentVNode("",!0)])}],["__scopeId","data-v-4f442567"]]),{computed:Nv}=cv;const Rv=ee({components:{MessageCustomerService:Cv,MessageRating:ee({components:{RatingStar:Sv,RatingNumber:Dv},props:{message:{type:Object,default:()=>({})}},emits:["sendMessage"],setup:(e,{emit:t})=>({sendCustomMessage:e=>{t("sendMessage",e)},ratingTemplate:Nv((()=>{const t=e.message&&Pf(e.message.payload.data);return null==t?void 0:t.menuContent})),RATING_TEMPLATE_TYPE:Af})},[["render",function(t,n,o,a,i,r){const s=e.resolveComponent("RatingStar"),l=e.resolveComponent("RatingNumber");return a.ratingTemplate.type===a.RATING_TEMPLATE_TYPE.STAR?(e.openBlock(),e.createBlock(s,{key:0,ratingTemplate:a.ratingTemplate,onSendMessage:a.sendCustomMessage},null,8,["ratingTemplate","onSendMessage"])):(e.openBlock(),e.createBlock(l,{key:1,ratingTemplate:a.ratingTemplate,onSendMessage:a.sendCustomMessage},null,8,["ratingTemplate","onSendMessage"]))}]])},props:{message:{type:Object,default:()=>({})}},setup:e=>({props:e,sendTextMessage:e=>{_t.callService({serviceName:nt.TUIChat.SERVICE.NAME,method:nt.TUIChat.SERVICE.METHOD.SEND_TEXT_MESSAGE,params:{payload:e}})},sendCustomMessage:e=>{_t.callService({serviceName:nt.TUIChat.SERVICE.NAME,method:nt.TUIChat.SERVICE.METHOD.SEND_CUSTOM_MESSAGE,params:{payload:e}})},isCustomerServiceMessage:Uf,isMessageRating:xf})},[["render",function(t,n,o,a,i,r){const s=e.resolveComponent("MessageRating"),l=e.resolveComponent("MessageCustomerService");return e.openBlock(),e.createElementBlock("div",{class:"message-custom"},[a.isMessageRating(a.props.message)?(e.openBlock(),e.createBlock(s,{key:0,message:a.props.message,onSendMessage:a.sendCustomMessage},null,8,["message","onSendMessage"])):a.isCustomerServiceMessage(a.props.message)?(e.openBlock(),e.createBlock(l,{key:1,message:a.props.message,onSendMessage:a.sendTextMessage},null,8,["message","onSendMessage"])):e.createCommentVNode("",!0)])}]]),Lv=ee(e.defineComponent({__name:"message-customer-service",props:{message:{default:()=>({})}},setup(t){const n=t;return(t,o)=>(e.openBlock(),e.createBlock(Rv,{message:n.message},null,8,["message"]))}}),[["__scopeId","data-v-e0f3b008"]]),Av=ee(e.defineComponent({__name:"message-room-default",props:{message:{default:()=>({})}},setup(t){const n=t;return(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["room-default",e.unref(eh)&&"room-default-uni","in"===n.message.flow?"room-default-in":"room-default-out"])},e.toDisplayString(e.unref(vp).t("message.custom.自定义消息")),3))}}),[["__scopeId","data-v-2b8047ad"]]),Ov=e.defineComponent({__name:"message-plugin",props:{message:{default:()=>({})},blinkMessageIDList:{default:()=>[]}},emits:["resendMessage","handleToggleMessageItem","handleH5LongPress"],setup(t,{emit:n}){const o=t,a=n,i=e.computed((()=>mp.getMessageModel(o.message.ID))),r=e.computed((()=>{var e;return null==(e=null==i?void 0:i.value)?void 0:e.getSignalingInfo()})),s=e.computed((()=>{var e;return null==(e=null==i?void 0:i.value)?void 0:e.getMessageContent()})),l=e.computed((()=>{var e;let t={pluginType:"",showStyle:""};return Ff(i.value)?t={pluginType:"call",showStyle:(null==(e=i.value)?void 0:e.conversationType)===gp.TYPES.CONV_GROUP?"tip":"bubble"}:zf(i.value)?t={pluginType:"room",showStyle:"bubble"}:Gf(i.value)&&(t={pluginType:"customer",showStyle:Vf(i.value)?"":"bubble"}),t})),c=e=>{a("resendMessage",e)},u=(e,t,n=!1)=>{a("handleToggleMessageItem",e,t,n)},d=(e,t,n)=>{a("handleH5LongPress",e,t,n)};return(t,n)=>(e.openBlock(),e.createBlock(qf,{message:o.message,showStyle:e.unref(l).showStyle,bubbleClassNameList:["room"===e.unref(l).pluginType?"message-bubble-room":""],onResendMessage:c,onHandleToggleMessageItem:u,onHandleH5LongPress:d},{messageTip:e.withCtx((()=>[e.createVNode(Kf,{message:o.message,signalingInfo:e.unref(r),customContent:e.unref(s),blinkMessageIDList:o.blinkMessageIDList},null,8,["message","signalingInfo","customContent","blinkMessageIDList"])])),messageBubble:e.withCtx((()=>["call"===e.unref(l).pluginType?(e.openBlock(),e.createBlock(Xf,{key:0,message:o.message,signalingInfo:e.unref(r),customContent:e.unref(s)},null,8,["message","signalingInfo","customContent"])):e.createCommentVNode("",!0),"customer"===e.unref(l).pluginType?(e.openBlock(),e.createBlock(Lv,{key:1,message:o.message},null,8,["message"])):e.createCommentVNode("",!0),"room"===e.unref(l).pluginType?(e.openBlock(),e.createBlock(Av,{key:2,message:o.message},null,8,["message"])):e.createCommentVNode("",!0)])),_:1},8,["message","showStyle","bubbleClassNameList"]))}}),Pv=ee(Ov,[["__scopeId","data-v-06f2aa39"]]),Uv="/assets/icon-close.00e2ef94.svg",xv=ee(e.defineComponent({__name:"index",props:{isFetching:{type:Boolean,default:!1},isTerminateObserve:{type:Boolean,default:!1}},emits:["onExposed"],setup(t,{emit:n}){var o;const a=n,i=t;let r=null;const s=e.ref(),l=(null==(o=e.getCurrentInstance())?void 0:o.proxy)||e.getCurrentInstance();return e.onMounted((()=>{i.isTerminateObserve||(eh?(r=uni.createIntersectionObserver(l).relativeToViewport(),r.observe(".fetch-more-block",(()=>{a("onExposed")}))):(r=new IntersectionObserver((([e])=>{e.isIntersecting&&a("onExposed")}),{threshold:1}),s.value&&r.observe(s.value)))})),e.onUnmounted((()=>{r&&(r.disconnect(),r=null)})),e.watch((()=>i.isTerminateObserve),(e=>{r&&(e?r.disconnect():s.value&&(r.disconnect(),eh?r.observe(".fetch-more-block",(()=>{a("onExposed")})):r.observe(s.value)))})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"selfDomRef",ref:s,class:"fetch-more-block"},[i.isFetching?e.renderSlot(t.$slots,"fetching",{key:0},(()=>[e.createElementVNode("div",null,e.toDisplayString(e.unref(vp).t("TUIChat.正在加载")),1)]),!0):e.renderSlot(t.$slots,"fetchEnd",{key:1},(()=>[e.createElementVNode("div",null,e.toDisplayString(e.unref(vp).t("TUIChat.加载结束")),1)]),!0)],512))}}),[["__scopeId","data-v-fd5944b2"]]),Vv=ee(e.defineComponent({__name:"index",props:{message:{default:()=>({})}},emits:["setReadReceiptPanelVisible"],setup(t,{emit:n}){const o=n,a=t;let i="",r="";const s=["unread","read"],l={unread:!1,read:!1,close:!1},c=e.ref(!1),u=e.ref(!1),d=e.ref(!1),p=e.ref(!1),h=e.ref("unread"),f=e.ref({read:{tabName:vp.t("TUIChat.已读"),count:void 0,memberList:[]},unread:{tabName:vp.t("TUIChat.未读"),count:void 0,memberList:[]},close:{tabName:vp.t("TUIChat.关闭"),count:void 0,memberList:[]}});function g(e="all"){return __async(this,null,(function*(){const t=mp.getMessageModel(a.message.ID);let n={},o={};"all"!==e&&"unread"!==e||(n=yield Ip.getGroupMessageReadMemberList({message:t,filter:1,cursor:i,count:100}),n&&(i=n.data.cursor,n.data.isCompleted&&(l.unread=!0))),"all"!==e&&"read"!==e||(o=yield Ip.getGroupMessageReadMemberList({message:t,filter:0,cursor:r,count:100}),o&&(r=o.data.cursor,o.data.isCompleted&&(l.read=!0)));const{unreadCount:s,readCount:c}=t.readReceiptInfo;return{unreadResult:__spreadValues({count:s},n.data),readResult:__spreadValues({count:c},o.data)}}))}function m(){return __async(this,null,(function*(){if(!l[h.value]&&!c.value&&(c.value=!0,"unread"===h.value||"read"===h.value)){const{unreadResult:e,readResult:t}=yield g(h.value);_();try{f.value.unread.memberList=f.value.unread.memberList.concat(e.unreadUserInfoList||[]),f.value.read.memberList=f.value.read.memberList.concat(t.readUserInfoList||[])}finally{c.value=!1}}}))}function v(){return __async(this,null,(function*(){i="",r="",p.value=!1,l.unread=!1,l.read=!1;const{unreadResult:e,readResult:t}=yield g("all");_(),y("read",t.count,t.readUserInfoList),y("unread",e.count,e.unreadUserInfoList),y("close")}))}function _(){l.read&&l.unread&&(p.value=!0)}function y(e,t,n){f.value[e].count=t,f.value[e].memberList=n||[]}function I(){u.value=!0,setTimeout((()=>{o("setReadReceiptPanelVisible",!1)}),200)}return e.onMounted((()=>__async(this,null,(function*(){yield v(),e.nextTick((()=>{d.value=!0}))})))),e.watch((()=>a.message.readReceiptInfo.readCount),(()=>{v()})),(t,n)=>(e.openBlock(),e.createBlock(Eh,{maskColor:"transparent",onOnOverlayClick:I},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass({"read-receipt-panel":!0,"read-receipt-panel-mobile":e.unref(th),"read-receipt-panel-uni":e.unref(eh),"read-receipt-panel-close-mobile":e.unref(th)&&e.unref(u)})},[e.createElementVNode("div",{class:"header"},[e.createElementVNode("div",{class:"header-text"},e.toDisplayString(e.unref(vp).t("TUIChat.消息详情")),1),e.createElementVNode("div",{class:"header-close-icon"},[e.createVNode(fh,{size:"12px",hotAreaSize:"8",file:e.unref(Uv),onOnClick:I},null,8,["file"])])]),e.createElementVNode("div",{class:"read-status-counter-container"},[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(s,(t=>e.createElementVNode("div",{key:t,class:e.normalizeClass({"read-status-counter":!0,active:t===e.unref(h)}),onClick:e=>function(e){h.value=e}(t)},[e.createElementVNode("div",{class:"status-text"},e.toDisplayString(e.unref(f)[t].tabName),1),e.createElementVNode("div",{class:"status-count"},e.toDisplayString(void 0===e.unref(f)[t].count?"":e.unref(f)[t].count),1)],10,["onClick"]))),64))]),e.createElementVNode("div",{class:"read-status-member-list"},[0===e.unref(f)[e.unref(h)].count&&e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"empty-list-tip"}," - "+e.toDisplayString(e.unref(vp).t("TUIChat.空"))+" - ",1)):e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},["unread"===e.unref(h)?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(f)[e.unref(h)].memberList,(t=>(e.openBlock(),e.createElementBlock("div",{key:t.userID,class:"read-status-member-container"},[e.createVNode(mh,{class:"read-status-avatar",useSkeletonAnimation:"",url:t.avatar||""},null,8,["url"]),e.createElementVNode("div",{class:"username"},e.toDisplayString(t.nick||t.userID),1)])))),128)):e.createCommentVNode("",!0),"read"===e.unref(h)?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(f)[e.unref(h)].memberList,(t=>(e.openBlock(),e.createElementBlock("div",{key:t.userID,class:"read-status-member-container"},[e.createVNode(mh,{class:"read-status-avatar",useSkeletonAnimation:"",url:t.avatar},null,8,["url"]),e.createElementVNode("div",{class:"username"},e.toDisplayString(t.nick||t.userID),1)])))),128)):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0),e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:2,class:"fetch-more-container"},[e.createVNode(xv,{isFetching:e.unref(c),isTerminateObserve:e.unref(p),onOnExposed:m},null,8,["isFetching","isTerminateObserve"])])):e.createCommentVNode("",!0)])],2)])),_:1}))}}),[["__scopeId","data-v-9bc89330"]]),Bv=e.defineComponent({__name:"index",emits:["scrollToLatestMessage"],setup(t,{expose:n,emit:o}){const a=o,i=e.ref([]),r=e.ref(""),s=e.ref(0),l=e.ref(0),c=e.ref(!1),u=e.ref(!1),d=e.ref(!1),p=e.computed((()=>l.value?`${l.value}${vp.t("TUIChat.条新消息")}`:vp.t("TUIChat.回到最新位置")));function h(e){var t,n;i.value=e||[];const o=null==(n=i.value)?void 0:n[(null==(t=i.value)?void 0:t.length)-1];u.value=!!(o&&(null==o?void 0:o.time)<(null==s?void 0:s.value))}function f(e){Array.isArray(e)&&d.value&&e.forEach((e=>{!e||e.conversationID!==r.value||e.isDeleted||e.isRevoked||function(e){var t,n;return"user_typing_status"===(null==(n=Wp(null==(t=e.payload)?void 0:t.data))?void 0:n.businessID)}(e)||(l.value+=1)}))}function g(e){var t;(null==e?void 0:e.conversationID)!==r.value&&m(),r.value=(null==e?void 0:e.conversationID)||"",s.value=(null==(t=null==e?void 0:e.lastMessage)?void 0:t.lastTime)||0}function m(){l.value=0}function v(){void 0!==mp.getData(tu.CHAT,"messageSource")&&mp.update(tu.CHAT,"messageSource",void 0),m(),a("scrollToLatestMessage")}return e.watch((()=>[c.value,u.value]),(()=>{d.value=c.value||u.value,d.value||m()}),{immediate:!0}),e.onMounted((()=>{mp.watch(tu.CHAT,{messageList:h,newMessageList:f}),mp.watch(tu.CONV,{currentConversation:g})})),e.onUnmounted((()=>{mp.unwatch(tu.CHAT,{messageList:h,newMessageList:f}),mp.unwatch(tu.CONV,{currentConversation:g})})),n({judgeScrollOverOneScreen:function(e){return __async(this,null,(function*(){var t,n,o,a,i;if(e.target)try{const{height:r}=(yield zp(`#${null==(t=e.target)?void 0:t.id}`,"messageList"))||{},s=(null==(n=e.target)?void 0:n.scrollHeight)||(null==(o=e.detail)?void 0:o.scrollHeight);if(s-((null==(a=e.target)?void 0:a.scrollTop)||(null==(i=e.detail)?void 0:i.scrollTop)||0)>2*r)return void(c.value=!0);c.value=!1}catch(nM){c.value=!1}}))},isScrollButtonVisible:d}),(t,n)=>e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"scroll-button",onClick:v},[e.createVNode(fh,{width:"10px",height:"10px",file:e.unref("/assets/double-arrow.a1a15b8b.svg")},null,8,["file"]),e.createElementVNode("div",{class:"scroll-button-text"},e.toDisplayString(e.unref(p)),1)])):e.createCommentVNode("",!0)}}),Gv=ee(Bv,[["__scopeId","data-v-d2111ace"]]),Fv=ee(e.defineComponent({__name:"index",props:{show:{type:Boolean,default:!1},isHeaderShow:{type:Boolean,default:!0},isFooterShow:{type:Boolean,default:!0},background:{type:Boolean,default:!0},title:{type:String,default:""},center:{type:Boolean,default:!1}},emits:["update:show","submit"],setup(t,{emit:n}){const o="outside",a="inside",i=t,r=e.ref(!1),s=e.ref(!0),l=e.ref(!0),c=e.ref(!0),u=e.ref("");e.watchEffect((()=>{r.value=i.show,u.value=i.title,s.value=i.isHeaderShow,l.value=i.isFooterShow,c.value=i.background}));const d=n,p=e=>{e===o&&h()},h=()=>{r.value=!r.value,d("update:show",r.value)},f=()=>{d("submit"),h()};return(n,i)=>e.unref(r)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["dialog",[e.unref(Zp)?"":"dialog-h5",t.center?"center":""]]),onClick:i[1]||(i[1]=e.withModifiers((e=>p(o)),["stop","prevent"]))},[e.createElementVNode("main",{class:e.normalizeClass(["dialog-main",[e.unref(c)?"":"dialog-main-back"]]),onClick:i[0]||(i[0]=e.withModifiers((e=>p(a)),["stop","prevent"]))},[e.unref(s)?(e.openBlock(),e.createElementBlock("header",{key:0,class:"dialog-main-header"},[e.createElementVNode("h1",{class:"dialog-main-title"},e.toDisplayString(e.unref(u)),1),e.createElementVNode("i",{class:"icon icon-close",onClick:h})])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["dialog-main-content",[e.unref(eh)&&e.unref(Jp)?"dialog-main-content-uniapp":""]])},[e.renderSlot(n.$slots,"default",{},void 0,!0)],2),e.unref(l)?(e.openBlock(),e.createElementBlock("footer",{key:1,class:"dialog-main-footer"},[e.createElementVNode("button",{class:"btn btn-cancel",onClick:h},e.toDisplayString(e.unref(vp).t("component.取消")),1),e.createElementVNode("button",{class:"btn btn-default",onClick:f},e.toDisplayString(e.unref(vp).t("component.确定")),1)])):e.createCommentVNode("",!0)],2)],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-b016c025"]]),zv=ee(e.defineComponent({__name:"index",props:{content:{default:()=>({})},messageItem:{default:()=>({})}},setup(t){const n=t;return(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:"progress-message"},[e.renderSlot(t.$slots,"default",{},void 0,!0),"unSend"===n.messageItem.status&&n.messageItem.progress<1?(e.openBlock(),e.createElementBlock("div",{key:0,class:"progress-container"},[e.unref(eh)?(e.openBlock(),e.createElementBlock("progress",{key:1,activeColor:"#006EFF",class:"progress-common",percent:Math.round(100*n.messageItem.progress)},null,8,["percent"])):(e.openBlock(),e.createElementBlock("progress",{key:0,class:"progress",value:n.messageItem.progress,max:"1"},null,8,["value"]))])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-587025e1"]]),Hv="Expected a function";function jv(e,t,n){let o=!0,a=!0;if("function"!=typeof e)throw new TypeError(Hv);return n&&Kv(n)&&(o="leading"in n?!!n.leading:o,a="trailing"in n?!!n.trailing:a),qv(e,t,{leading:o,maxWait:t,trailing:a})}function qv(e,t,n){let o,a,i,r,s,l,c=0,u=!1,d=!1,p=!0;if("function"!=typeof e)throw new TypeError(Hv);function h(t){const n=o,i=a;return o=a=void 0,c=t,r=e.apply(i,n),r}function f(e){const n=e-l;return void 0===l||n>=t||n<0||d&&e-c>=i}function g(){const e=Date.now();if(f(e))return m(e);s=setTimeout(g,function(e){const n=e-c,o=t-(e-l);return d?Math.min(o,i-n):o}(e))}function m(e){return s=void 0,p&&o?h(e):(o=a=void 0,r)}function v(){const e=Date.now(),n=f(e);if(o=arguments,a=this,l=e,n){if(void 0===s)return function(e){return c=e,s=setTimeout(g,t),u?h(e):r}(l);if(d)return clearTimeout(s),s=setTimeout(g,t),h(l)}return void 0===s&&(s=setTimeout(g,t)),r}return t=t||0,n&&Kv(n)&&(u=!!n.leading,d="maxWait"in n,i=d?Math.max(n.maxWait||0,t):i,p="trailing"in n?!!n.trailing:p),v.cancel=function(){void 0!==s&&clearTimeout(s),c=0,o=l=a=s=void 0},v.flush=function(){return void 0===s?r:m(Date.now())},v}function Kv(e){const t=typeof e;return null!=e&&("object"==t||"function"==t)}const Yv=class e{constructor(){this.chatStorage=null}static getInstance(){return e.instance||(e.instance=new e),e.instance}getChatStorage(e){if(this.chatStorage||(this.chatStorage=this.getChatStorageFromLocalStorage()),e)return this.chatStorage[e];throw new Error("No key provided")}setChatStorage(t,n){this.chatStorage||(this.chatStorage=this.getChatStorageFromLocalStorage()),this.chatStorage[t]=n;try{eh?bp.setStorageSync(e.CHAT_STORAGE_KEY,JSON.stringify(this.chatStorage)):localStorage.setItem(e.CHAT_STORAGE_KEY,JSON.stringify(this.chatStorage))}catch(nM){throw new Error("Fail to set chat storage")}}getChatStorageFromLocalStorage(){let t="";if(t=eh?bp.getStorageSync(e.CHAT_STORAGE_KEY)||"":localStorage.getItem(e.CHAT_STORAGE_KEY)||"",!t)return{};try{this.chatStorage=JSON.parse(t)}catch(nM){this.chatStorage={}}return this.chatStorage}};Yv.instance=null,Yv.CHAT_STORAGE_KEY="TUI_CHAT_STORAGE";const $v=Yv.getInstance(),Wv=e.defineComponent({__name:"index",props:{isGroup:{type:Boolean,default:!1},groupID:{default:""},isNotInGroup:{type:Boolean,default:!1},isMultipleSelectMode:{type:Boolean,default:!1}},emits:["closeInputToolBar","handleEditor","toggleMultipleSelectMode"],setup(t,{expose:n,emit:o}){var a;const i=o,r=t;let s,l=0,c=null;const u=new Set,d=mp.getData(tu.APP,"isOfficial"),p=(null==(a=e.getCurrentInstance())?void 0:a.proxy)||e.getCurrentInstance(),h=e.ref(),f=e.ref([]),g=e.ref(!1),m=e.ref(""),v=e.ref(""),_=e.ref(5e3),y=e.ref(gp.TYPES),I=e.ref(!1),C=e.ref(!1),k=e.ref([]),E=e.ref(),T=e.ref(),S=e.ref(""),M=e.ref(!1),w=e.ref(),b=e.ref({}),D=e.ref(""),N=e.ref(),R=e.ref(!1),L=e.ref(!1),A=e.ref(),O=()=>{_.value+=300;const e=setTimeout((()=>{_.value+=1,clearTimeout(e)}),300)},P=e=>{if(m.value=e,yh()){const{groupProfile:t}=mp.getConversationModel(e)||{};s=null==t?void 0:t.type}Object.keys(b.value).length>0&&$v.setChatStorage("audioPlayedMapping",b.value)};e.onMounted((()=>{b.value=$v.getChatStorage("audioPlayedMapping")||{},mp.watch(tu.CHAT,{messageList:V,messageSource:G,isCompleted:z}),mp.watch(tu.CONV,{currentConversationID:P}),function(e,t){Fp.set(e,t)}("messageList",p),uni.$on("scroll-to-bottom",B)})),e.onUnmounted((()=>{mp.unwatch(tu.CHAT,{messageList:V,isCompleted:z}),mp.unwatch(tu.CONV,{currentConversationID:P}),null==c||c.disconnect(),c=null,uni.$off("scroll-to-bottom"),Object.keys(b.value).length>0&&$v.setChatStorage("audioPlayedMapping",b.value)}));const U=jv((function(e){var t;null==(t=T.value)||t.judgeScrollOverOneScreen(e)}),500,{leading:!0});function x(e,t){(null==t?void 0:t.newAudioSrc)&&(D.value=t.newAudioSrc)}function V(t){return __async(this,null,(function*(){var n,o,a;null==c||c.disconnect(),h.value=t.filter((e=>!e.isDeleted)).map((e=>(e.vueForRenderKey=`${e.ID}`,e)));const i=null==(o=h.value)?void 0:o[(null==(n=h.value)?void 0:n.length)-1];E.value?F(E.value):I.value||(null==(a=T.value)?void 0:a.isScrollButtonVisible)&&"in"===(null==i?void 0:i.flow)||e.nextTick((()=>{O()})),yh()&&e.nextTick((()=>function(){return __async(this,null,(function*(){h.value&&0!==h.value.length&&s!==y.value.GRP_AVCHATROOM&&s!==y.value.GRP_COMMUNITY&&(null==c||c.disconnect(),c=uni.createIntersectionObserver(p,{threshold:[.7],observeAll:!0}).relativeTo("#messageScrollList",{top:-70}),null==c||c.observe(".message-li.in .message-bubble-container",(e=>{var t;if(u.has(e.id))return;const n=h.value.find((t=>e.id.indexOf(t.ID)>-1));n&&n.needReadReceipt&&"in"===n.flow&&!(null==(t=n.readReceiptInfo)?void 0:t.isPeerRead)&&(Ip.sendMessageReadReceipt([n]),u.add(e.id))})))}))}()))}))}function B(){return __async(this,null,(function*(){try{const{scrollHeight:e}=yield Hp("#messageScrollList","messageList");e?_.value===e?_.value=e+1:_.value=e:O()}catch(nM){O()}}))}function G(e){return __async(this,null,(function*(){E.value=e,F(E.value)}))}function F(t){var n;(null==(n=h.value)?void 0:n.some((e=>(null==e?void 0:e.ID)===(null==t?void 0:t.ID))))&&e.nextTick((()=>__async(this,null,(function*(){yield function(e){return __async(this,null,(function*(){const t=e.ID,n=h.value&&h.value.some((e=>e.ID===t));if(t&&n){const e=setTimeout((()=>__async(this,null,(function*(){try{const n=yield zp("#messageScrollList","messageList"),o=yield zp("#tui-"+t,"messageList"),{scrollTop:a}=yield Hp("#messageScrollList","messageList");W(o.top+a-n.top-l++%2),clearTimeout(e)}catch(nM){}}))),500)}else tf({message:vp.t("TUIChat.无法定位到原消息"),type:Xh})}))}(t),yield $(null==t?void 0:t.ID),E.value=void 0}))))}function z(e){g.value=e}const H=()=>{var t,n;I.value=!0;const o=(null==(n=null==(t=h.value)?void 0:t[0])?void 0:n.ID)||"";Ip.getMessageList().then((()=>{e.nextTick((()=>{S.value=o;const e=setTimeout((()=>{S.value="",I.value=!1,clearTimeout(e)}),500)}))}))},j=(e,t,n,o=!1)=>{r.isMultipleSelectMode||r.isNotInGroup||(o&&(C.value=!0),v.value=t.ID)};let q;const K=(e,t,n,o)=>{if(!r.isMultipleSelectMode&&!r.isNotInGroup&&Jp)switch(o){case"touchstart":q=setTimeout(a,500);break;case"touchend":clearTimeout(q),setTimeout((()=>{C.value=!1}),200)}function a(){clearTimeout(q),j(0,t,0,!0)}},Y=e=>{L.value=!0,A.value=e};function $(e){return new Promise((t=>{if(k.value.indexOf(e)<0){k.value.push(e);const n=setTimeout((()=>{k.value.splice(k.value.indexOf(e),1),clearTimeout(n),t()}),3e3)}}))}function W(e){_.value=e}function Z(e,t){e&&r.isNotInGroup||(N.value=e?t:void 0,R.value=e)}function J(){i("closeInputToolBar")}function X({type:e,messageID:t}){"clearAll"===e?f.value=[]:"add"!==e||f.value.includes(t)?"remove"===e&&(f.value=f.value.filter((e=>e!==t))):f.value.push(t)}function Q(e){w.value=e,M.value=!0}function ee(e){b.value[e]=!0}return e.watch((()=>r.isMultipleSelectMode),(e=>{e||X({type:"clearAll",messageID:""})})),n({oneByOneForwardMessage:function(){mp.update(tu.CUSTOM,"multipleForwardMessageID",{isMergeForward:!1,messageIDList:f.value})},mergeForwardMessage:function(){mp.update(tu.CUSTOM,"multipleForwardMessageID",{isMergeForward:!0,messageIDList:f.value})},scrollToLatestMessage:B}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"tui-chat":!0,"tui-chat-h5":e.unref(th)}),onClick:J},[e.createElementVNode("div",{class:"tui-chat-main"},[e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-chat-safe-tips"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUIChat.【安全提示】本 APP 仅用于体验腾讯云即时通信 IM 产品功能，不可用于业务洽谈与拓展。请勿轻信汇款、中奖等涉及钱款的信息，勿轻易拨打陌生电话，谨防上当受骗。")),1),e.createElementVNode("a",{onClick:n[0]||(n[0]=t=>{e.unref(uh).complaint})},e.toDisplayString(e.unref(vp).t("TUIChat.点此投诉")),1)])):e.createCommentVNode("",!0),t.isGroup?(e.openBlock(),e.createBlock(Yh,{key:r.groupID,groupID:r.groupID},null,8,["groupID"])):e.createCommentVNode("",!0),e.createElementVNode("scroll-view",{id:"messageScrollList",class:"tui-message-list","scroll-y":"true","scroll-top":e.unref(_),"scroll-into-view":`tui-${e.unref(S)}`,onScroll:n[3]||(n[3]=(...t)=>e.unref(U)&&e.unref(U)(...t))},[e.unref(g)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("p",{key:0,class:"message-more",onClick:H},e.toDisplayString(e.unref(vp).t("TUIChat.查看更多")),1)),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(h),((o,a)=>(e.openBlock(),e.createElementBlock("li",{id:`tui-${o.ID}`,key:o.vueForRenderKey,class:e.normalizeClass("message-li "+o.flow)},[e.createVNode(Mf,{currTime:o.time,prevTime:a>0?e.unref(h)[a-1].time:0},null,8,["currTime","prevTime"]),e.createElementVNode("div",{class:"message-item",onClick:n[2]||(n[2]=e=>v.value="")},[o.type===e.unref(y).MSG_GRP_TIP||e.unref(_h)(o)?(e.openBlock(),e.createBlock(cf,{key:0,content:o.getMessageContent()},null,8,["content"])):o.isRevoked||e.unref(Hf)(o)?!o.isRevoked&&e.unref(Hf)(o)?(e.openBlock(),e.createBlock(Pv,{key:2,message:o,onResendMessage:Y,onHandleToggleMessageItem:j,onHandleH5LongPress:K},null,8,["message"])):(e.openBlock(),e.createBlock(Rf,{key:3,isEdit:o.type===e.unref(y).MSG_TEXT,messageItem:o,onMessageEdit:e=>{i("handleEditor",o,"reedit")}},null,8,["isEdit","messageItem","onMessageEdit"])):(e.openBlock(),e.createElementBlock("div",{key:1,id:`msg-bubble-${o.ID}`,class:"message-bubble-container",onLongpress:e=>j(0,o,0,!0),onTouchstart:e=>K(0,o,0,"touchstart"),onTouchend:e=>K(0,o,0,"touchend"),onMouseover:e=>K(0,o,0,"touchend")},[e.createVNode(Tf,{messageItem:e.unref(vh)(o),content:o.getMessageContent(),isAudioPlayed:e.unref(b)[o.ID],blinkMessageIDList:e.unref(k),isMultipleSelectMode:t.isMultipleSelectMode,multipleSelectedMessageIDList:e.unref(f),onResendMessage:e=>Y(o),onBlinkMessage:$,onScrollTo:W,onChangeSelectMessageIDList:X,onSetReadReceiptPanelVisible:Z},{default:e.withCtx((()=>[o.type===e.unref(y).MSG_TEXT?(e.openBlock(),e.createBlock($h,{key:0,content:o.getMessageContent(),messageItem:o},null,8,["content","messageItem"])):o.type===e.unref(y).MSG_IMAGE?(e.openBlock(),e.createBlock(zv,{key:1,content:o.getMessageContent(),messageItem:e.unref(vh)(o)},{default:e.withCtx((()=>[e.createVNode(Zh,{content:o.getMessageContent(),messageItem:o,onPreviewImage:e=>(e=>{if(!h.value)return;const t=[],n=h.value.filter(((e,n)=>!e.isRevoked&&!e.hasRiskContent&&e.type===y.value.MSG_IMAGE&&(t.push(n),!0)));uni.previewImage({current:t.indexOf(e),urls:n.map((e=>{var t;return null==(t=e.payload.imageInfoArray)?void 0:t[2].url})),indicator:"number"})})(a)},null,8,["content","messageItem","onPreviewImage"])])),_:2},1032,["content","messageItem"])):o.type===e.unref(y).MSG_VIDEO?(e.openBlock(),e.createBlock(zv,{key:2,content:o.getMessageContent(),messageItem:e.unref(vh)(o)},{default:e.withCtx((()=>[e.createVNode(wf,{content:o.getMessageContent(),messageItem:o},null,8,["content","messageItem"])])),_:2},1032,["content","messageItem"])):o.type===e.unref(y).MSG_AUDIO?(e.openBlock(),e.createBlock(of,{key:3,content:o.getMessageContent(),messageItem:o,broadcastNewAudioSrc:e.unref(D),onSetAudioPlayed:ee,onGetGlobalAudioContext:x},null,8,["content","messageItem","broadcastNewAudioSrc"])):o.type===e.unref(y).MSG_MERGER?(e.openBlock(),e.createBlock(Hh,{key:4,renderData:o.payload,messageItem:o,onAssignMessageIDInUniapp:Q},null,8,["renderData","messageItem"])):o.type===e.unref(y).MSG_FILE?(e.openBlock(),e.createBlock(af,{key:5,content:o.getMessageContent()},null,8,["content"])):o.type===e.unref(y).MSG_FACE?(e.openBlock(),e.createBlock(rf,{key:6,content:o.getMessageContent()},null,8,["content"])):o.type===e.unref(y).MSG_LOCATION?(e.openBlock(),e.createBlock(Sf,{key:7,content:o.getMessageContent()},null,8,["content"])):o.type===e.unref(y).MSG_CUSTOM?(e.openBlock(),e.createBlock(lf,{key:8,content:o.getMessageContent(),messageItem:o},null,8,["content","messageItem"])):e.createCommentVNode("",!0)])),_:2},1032,["messageItem","content","isAudioPlayed","blinkMessageIDList","isMultipleSelectMode","multipleSelectedMessageIDList","onResendMessage"])],40,["id","onLongpress","onTouchstart","onTouchend","onMouseover"])),o.ID===e.unref(v)?(e.openBlock(),e.createBlock(Nf,{key:4,class:e.normalizeClass({"message-tool":!0,"message-tool-out":"out"===o.flow,"message-tool-in":"in"===o.flow}),messageItem:o,isMultipleSelectMode:t.isMultipleSelectMode,onToggleMultipleSelectMode:n[1]||(n[1]=()=>i("toggleMultipleSelectMode"))},null,8,["class","messageItem","isMultipleSelectMode"])):e.createCommentVNode("",!0)])],10,["id"])))),128))],40,["scroll-top","scroll-into-view"]),e.createVNode(Gv,{ref_key:"scrollButtonInstanceRef",ref:T,onScrollToLatestMessage:B},null,512),e.unref(L)?(e.openBlock(),e.createBlock(Fv,{key:2,show:e.unref(L),isH5:!e.unref(Zp),center:!0,isHeaderShow:e.unref(Zp),onSubmit:n[4]||(n[4]=e=>(L.value=!L.value,void A.value.resendMessage())),"onUpdate:show":n[5]||(n[5]=e=>L.value=e)},{default:e.withCtx((()=>[e.createElementVNode("p",{class:"delDialog-title"},e.toDisplayString(e.unref(vp).t("TUIChat.确认重发该消息？")),1)])),_:1},8,["show","isH5","isHeaderShow"])):e.createCommentVNode("",!0),e.unref(R)?(e.openBlock(),e.createBlock(Vv,{key:3,message:Object.assign({},e.unref(N)),onSetReadReceiptPanelVisible:Z},null,8,["message"])):e.createCommentVNode("",!0),e.createVNode(Sh,{visible:e.unref(M),overlayColor:"transparent",popDirection:"right"},{default:e.withCtx((()=>[e.createVNode(qh,{style:{height:"100%"},isMounted:e.unref(M),messageID:e.unref(w),onCloseOverlay:n[6]||(n[6]=e=>M.value=!1)},null,8,["isMounted","messageID"])])),_:1},8,["visible"])])],2))}}),Zv=ee(Wv,[["__scopeId","data-v-23a5760a"]]),Jv=class e{constructor(){this.quoteMessageMap=new Map}static getInstance(){return e.instance||(e.instance=new e),e.instance}setStore(e,t,n,o){var a,i;if(e&&(this.isEditorNotEmpty(t)||(null==(a=null==o?void 0:o.message)?void 0:a.ID))){let a={};(null==(i=null==o?void 0:o.message)?void 0:i.ID)&&(this.quoteMessageMap.set(o.message.ID,o.message),a={messageID:o.message.ID,type:o.type});const r={conversationID:e,draftInfo:__spreadValues({html:t,abstract:n},a)};_p.setConversationDraft(r),mp.update(tu.CHAT,"quoteMessage",{message:void 0,type:"quote"})}}getStore(e,t){const n=mp.getConversationModel(e);if(n){if(n.conversationID&&n.draftText){const e=Wp(n.draftText);mp.update(tu.CHAT,"quoteMessage",{message:this.quoteMessageMap.get(e.messageID)||void 0,type:e.type}),t(e.html)}_p.setConversationDraft({conversationID:n.conversationID})}}generateAbstract(e){let t="";return null==e||e.forEach((e=>{switch(e.type){case"text":t+=Fh(e.payload.text||"");break;case"image":t+=vp.t("TUIChat.图片");break;case"video":t+=vp.t("TUIChat.视频");break;case"file":t+=vp.t("TUIChat.文件")}})),t}isEditorNotEmpty(e){return e&&!e.includes("is-empty")&&"<p></p>"!==e}};Jv.instance=null;const Xv=Jv.getInstance(),Qv=new Map([[3123,"文本包含本地审核拦截词"],[4004,"图片消息失败,无效的图片格式"],[4005,"文件消息失败,禁止发送违规封禁的文件"],[7004,"文件不存在,请检查文件路径是否正确"],[7005,"文件大小超出了限制,如果上传文件,最大限制是100MB"],[8001,"消息长度超出限制,消息长度不要超过12K"],[80001,"消息或者资料中文本存在敏感内容,发送失败"],[80004,"消息中图片存在敏感内容,发送失败"],[10017,"您已被禁止聊天"]]),e_=(e,t)=>__async(this,null,(function*(){mp.getData(tu.CHAT,"messageSource")&&mp.update(tu.CHAT,"messageSource",void 0),null==e||e.forEach((e=>__async(this,null,(function*(){var n,o,a,i,r,s,l;try{const c={to:(null==(n=null==t?void 0:t.groupProfile)?void 0:n.groupID)||(null==(o=null==t?void 0:t.userProfile)?void 0:o.userID),conversationType:null==t?void 0:t.type,payload:{},needReadReceipt:yh()};let u;const d={offlinePushInfo:{}},p={conversation:t,payload:e.payload,messageType:""};switch(null==e?void 0:e.type){case"text":if(u=JSON.parse(JSON.stringify(null==(a=e.payload)?void 0:a.text)),!u)break;c.payload={text:u},p.messageType=gp.TYPES.MSG_TEXT,d.offlinePushInfo=Jf.create(p),(null==(i=e.payload)?void 0:i.atUserList)?(c.payload.atUserList=e.payload.atUserList,yield Ip.sendTextAtMessage(c,d)):yield Ip.sendTextMessage(c,d);break;case"image":c.payload={file:null==(r=e.payload)?void 0:r.file},p.messageType=gp.TYPES.MSG_IMAGE,d.offlinePushInfo=Jf.create(p),yield Ip.sendImageMessage(c,d);break;case"video":c.payload={file:null==(s=e.payload)?void 0:s.file},p.messageType=gp.TYPES.MSG_VIDEO,d.offlinePushInfo=Jf.create(p),yield Ip.sendVideoMessage(c,d);break;case"file":c.payload={file:null==(l=e.payload)?void 0:l.file},p.messageType=gp.TYPES.MSG_FILE,d.offlinePushInfo=Jf.create(p),yield Ip.sendFileMessage(c,d)}Df("sendMessage")}catch(nM){tf({message:Qv.get(null==nM?void 0:nM.code)?vp.t(`TUIChat.${Qv.get(nM.code)}`):null==nM?void 0:nM.message,type:Qh}),mp.getData(tu.CHAT,"quoteMessage")&&mp.update(tu.CHAT,"quoteMessage",{})}}))))})),t_=e.defineComponent({__name:"message-input-editor",props:{placeholder:{type:String,default:"this is placeholder"},replayOrReferenceMessage:{type:Object,default:()=>({}),required:!1},isMuted:{type:Boolean,default:!0},muteText:{type:String,default:""},enableInput:{type:Boolean,default:!0},enableAt:{type:Boolean,default:!0},enableTyping:{type:Boolean,default:!0},isGroup:{type:Boolean,default:!1}},emits:["onTyping","onFocus","onAt"],setup(t,{expose:n,emit:o}){const a=t,i=o,r=e.ref(""),s=e.ref(),l=e.ref(!0),c=e.ref(!0),u=new Map,d=e.ref(),p=e.ref(""),h=e.ref();e.onMounted((()=>{mp.watch(tu.CONV,{currentConversation:C}),mp.watch(tu.CHAT,{quoteMessage:k}),uni.$on("insert-emoji",(e=>{var t;r.value+=null==(t=null==e?void 0:e.emoji)?void 0:t.name})),uni.$on("send-message-in-emoji-picker",(()=>{f()}))})),e.onUnmounted((()=>{p.value&&Xv.setStore(p.value,r.value,r.value,h.value),uni.$off("insertEmoji"),uni.$off("send-message-in-emoji-picker"),mp.unwatch(tu.CONV,{currentConversation:C}),mp.unwatch(tu.CHAT,{quoteMessage:k}),l.value=!0,d.value=null,p.value="",h.value=null,m()}));const f=()=>{const e=g();m(),e_(e,d.value)},g=()=>{let e=r.value;e=(e=>{if(!e)return"";const t=/(\[.+?\])/g;let n=e;return t.test(e)&&(n=e.replace(t,(e=>Uh[e]||e))),n})(e);const t=[];null==u||u.forEach(((n,o)=>{(null==e?void 0:e.includes("@"+n))&&t.push(o)}));const n={text:e};return(null==t?void 0:t.length)&&(n.atUserList=t),[{type:"text",payload:n}]},m=()=>{r.value="",c.value=!0,null==u||u.clear()},v=e=>{r.value=e},_=()=>{l.value=!0},y=e=>{var t;l.value=!1,i("onFocus",null==(t=null==e?void 0:e.detail)?void 0:t.height)},I=e=>{var t;const n=null==(t=null==e?void 0:e.detail)?void 0:t.value;(()=>{var e;c.value=!(null==(e=null==r?void 0:r.value)?void 0:e.length)})(),a.isGroup&&(n.endsWith("@")||n.endsWith("@\n"))&&(null==bp||bp.hideKeyboard(),i("onAt",!0))};function C(e){const t=p.value;d.value=e,p.value=null==e?void 0:e.conversationID,t!==p.value&&(t&&Xv.setStore(t,r.value,r.value,h.value),m(),p.value&&Xv.getStore(p.value,v))}function k(e){h.value=e}return e.watch((()=>[c.value,l.value]),((e,t)=>{e!==t&&i("onTyping",c.value,l.value)}),{immediate:!0,deep:!0}),n({insertAt:e=>{(null==u?void 0:u.has(null==e?void 0:e.id))||null==u||u.set(null==e?void 0:e.id,null==e?void 0:e.label),r.value+=null==e?void 0:e.label},resetEditor:m,setEditorContent:v,getEditorContent:g}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-input-container":!0,"message-input-container-h5":!e.unref(Zp)})},[a.isMuted?(e.openBlock(),e.createElementBlock("div",{key:0,class:"message-input-mute"},e.toDisplayString(a.muteText),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("input",{id:"editor",ref_key:"inputRef",ref:s,"onUpdate:modelValue":n[0]||(n[0]=t=>e.isRef(r)?r.value=t:null),"adjust-position":!0,"cursor-spacing":"20","confirm-type":"send","confirm-hold":!0,maxlength:"140",type:"text","placeholder-class":"input-placeholder",class:"message-input-area",placeholder:a.placeholder,"auto-blur":"",onConfirm:f,onInput:I,onBlur:_,onFocus:y},null,40,["placeholder"]),[[e.vModelText,e.unref(r)]])],2))}}),n_=ee(t_,[["__scopeId","data-v-05f06d3f"]]),o_=ee(e.defineComponent({__name:"index",props:{show:{type:Boolean,default:!1},modal:{type:Boolean,default:!0},height:{type:String,default:"fit-content"},closeByClickOutside:{type:Boolean,default:!0},borderRadius:{type:String,default:"0px"},title:{type:String,default:""},showHeaderCloseButton:{type:Boolean,default:!1},showFooterSubmitButton:{type:Boolean,default:!1},submitButtonContent:{type:String,default:()=>vp.t("确定")}},emits:["onOpen","onClose","onSubmit"],setup(t,{emit:n}){const o=t,a=n,i=e.ref();e.watch((()=>o.show),((t,n)=>{if(t!==n)switch(t){case!0:a("onOpen",i),e.nextTick((()=>{Jp&&!eh&&o.closeByClickOutside&&Kp.listen({domRefs:i.value,handler:r})}));break;case!1:a("onClose",i)}}));const r=()=>{(eh||Jp)&&a("onClose",i)},s=()=>{a("onSubmit"),r()};return(n,a)=>o.show?(e.openBlock(),e.createElementBlock("div",{key:0},[e.unref(Zp)?e.renderSlot(n.$slots,"default",{key:1},void 0,!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["bottom-popup",!e.unref(Zp)&&"bottom-popup-h5",!e.unref(Zp)&&o.modal&&"bottom-popup-modal",e.unref(eh)&&"bottom-popup-uni"]),onClick:r},[e.createElementVNode("div",{ref_key:"dialogRef",ref:i,class:e.normalizeClass(["bottom-popup-main",!e.unref(Zp)&&"bottom-popup-h5-main"]),style:e.normalizeStyle({height:o.height,borderTopLeftRadius:o.borderRadius,borderTopRightRadius:o.borderRadius}),onClick:a[0]||(a[0]=e.withModifiers((()=>{}),["stop"]))},[t.title||t.showHeaderCloseButton?(e.openBlock(),e.createElementBlock("div",{key:0,class:"header"},[t.title?(e.openBlock(),e.createElementBlock("div",{key:0,class:"header-title"},e.toDisplayString(t.title),1)):e.createCommentVNode("",!0),t.showHeaderCloseButton?(e.openBlock(),e.createElementBlock("div",{key:1,class:"header-close",onClick:r},e.toDisplayString(e.unref(vp).t("关闭")),1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0),e.renderSlot(n.$slots,"default",{},void 0,!0),t.showFooterSubmitButton?(e.openBlock(),e.createElementBlock("div",{key:1,class:"footer"},[e.createElementVNode("div",{class:"footer-submit",onClick:s},e.toDisplayString(t.submitButtonContent),1)])):e.createCommentVNode("",!0)],6)],2))])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-d7b38150"]]),a_=ee(e.defineComponent({__name:"index",emits:["onAtListOpen","insertAt"],setup(t,{expose:n,emit:o}){const a=o,i=e.ref(),r=e.ref(),s=e.ref(!1),l=e.ref(),c=e.ref(),u=e.ref(),d=e.ref(!1),p=e.ref({left:0,top:0}),h=e.ref(0),f=e.ref(""),g={userID:gp.TYPES.MSG_AT_ALL,nick:"所有人",isAll:!0,avatar:"https://web.sdk.qcloud.com/im/assets/images/at.svg"};mp.watch(tu.CONV,{currentConversationID:e=>{var t,n;if(e!==f.value)if(f.value=e,l.value=[],c.value=[],u.value=[],d.value=!1,mp.update(tu.CUSTOM,"memberList",l.value),null==(t=null==f?void 0:f.value)?void 0:t.startsWith("GROUP")){d.value=!0;const e=null==(n=null==f?void 0:f.value)?void 0:n.substring(5);Cp.switchGroup(e)}else Cp.switchGroup("")}}),mp.watch(tu.GRP,{currentGroupMemberList:e=>{l.value=e,c.value=[g,...l.value],u.value=c.value,mp.update(tu.CUSTOM,"memberList",l.value)}});const m=e=>{d.value&&(s.value=e,s.value&&a("onAtListOpen"))};bp.toggleAtList=m,bp.handleAtListPosition=e=>{p.value=e},bp.setCurrentSelectIndex=e=>{var t,n;h.value=e,null==(n=null==(t=r.value)?void 0:t[h.value])||n.scrollIntoView(!1)},bp.setShowMemberList=e=>{u.value=e},n({toggleAtList:m}),e.watch((()=>[p.value,null==i?void 0:i.value]),(()=>{var e;!Jp&&(null==i?void 0:i.value)&&(null==(e=null==i?void 0:i.value)?void 0:e.style)&&(i.value.style.left=p.value.left+"px",i.value.style.top=p.value.top-i.value.clientHeight+"px")}));const v=()=>{s.value=!1,u.value=c.value,p.value={left:0,top:0}},_=e=>(null==e?void 0:e.avatar)||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",y=e=>(null==e?void 0:e.nick)?null==e?void 0:e.nick:null==e?void 0:e.userID;return(t,n)=>(e.openBlock(),e.createBlock(o_,{show:e.unref(s),onOnClose:v},{default:e.withCtx((()=>[e.createElementVNode("div",{ref_key:"MessageInputAt",ref:i,class:e.normalizeClass([e.unref(Zp)?"message-input-at":"message-input-at-h5"])},[e.createElementVNode("div",{ref:"dialog",class:"member-list"},[e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("header",{key:0,class:"member-list-title"},[e.createElementVNode("span",{class:"title"},e.toDisplayString(e.unref(vp).t("TUIChat.选择提醒的人")),1)])),e.createElementVNode("ul",{class:"member-list-box"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(u),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,ref_for:!0,ref_key:"memberListItems",ref:r,class:e.normalizeClass(["member-list-box-body",[n===e.unref(h)&&"selected"]]),onClick:e=>(e=>{var t;if(Zp&&bp.selectItem)bp.selectItem(e);else if(null==(t=null==u?void 0:u.value)?void 0:t.length){const t=null==u?void 0:u.value[e];a("insertAt",{id:null==t?void 0:t.userID,label:(null==t?void 0:t.nick)||(null==t?void 0:t.userID)})}v()})(n)},[e.createElementVNode("img",{class:"member-list-box-body-avatar",src:_(t)},null,8,["src"]),e.createElementVNode("span",{class:"member-list-box-body-name"},e.toDisplayString(y(t)),1)],10,["onClick"])))),128))])],512)],2)])),_:1},8,["show"]))}}),[["__scopeId","data-v-e731d073"]]),i_=e.defineComponent({__name:"message-input-audio",props:{isEnableAudio:{type:Boolean,default:!1}},emits:["changeDisplayType"],setup(t,{emit:n}){const o=n,a=t;let i,r=0,s=!1,l=-1,c=!1,u=!1;const d=null==bp?void 0:bp.getRecorderManager(),p=e.ref(!1),h=e.ref("按住说话"),f=e.ref("正在录音"),g=e.ref(!1),m=e.ref(),v={duration:6e4,sampleRate:44100,numberOfChannels:1,encodeBitRate:192e3,format:"mp3"};function _(){o("changeDisplayType",a.isEnableAudio?"editor":"audio")}function y(e){m.value=e}function I(){k(),C()}function C(){p.value=!1,h.value="按住说话",f.value="正在录音"}function k(e){clearInterval(i),i=void 0,r=0,l=-1,s=!1,(null==e?void 0:e.hasError)||d.stop()}function E(){c&&(u=!0)}function T(){c=!0,d.start(v)}e.onMounted((()=>{d.onStart(w),d.onStop(b),d.onError(D),mp.watch(tu.CONV,{currentConversation:y})})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversation:y})}));const S=jv((function(e){if(p.value){const t=e.changedTouches[e.changedTouches.length-1].pageY;l<0&&(l=t);const n=l-t;n>150?(h.value="抬起取消",f.value="松开手指 取消发送",s=!0):n>50?(h.value="抬起发送",f.value="继续上滑可取消",s=!1):(h.value="抬起发送",f.value="正在录音",s=!1)}}),100);function M(){c=!1,d.stop()}function w(){if(!c)return u=!0,void d.stop();i=setInterval((()=>{r+=1}),1e3),h.value="抬起发送",p.value=!0}function b(e){var t,n,o,a,l;if(u)return u=!1,void I();if(s||!p.value)return void I();clearInterval(i);const c=e.tempFilePath,d=e.duration?e.duration:1e3*r,h=e.fileSize?e.fileSize:48*r/8*1024;if(d<1e3)tf({message:"录音时间太短",type:ef,duration:1500});else{const e={to:(null==(n=null==(t=null==m?void 0:m.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(a=null==(o=null==m?void 0:m.value)?void 0:o.userProfile)?void 0:a.userID),conversationType:null==(l=null==m?void 0:m.value)?void 0:l.type,payload:{file:{duration:d,tempFilePath:c,fileSize:h}},needReadReceipt:yh()};null==Ip||Ip.sendAudioMessage(e)}I()}function D(){k({hasError:!0}),C()}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"message-input-audio":!0,"message-input-audio-open":e.unref(g)})},[e.createVNode(fh,{class:"audio-message-icon",file:e.unref("/assets/audio.3e97d529.svg"),size:"23px",hotAreaSize:"3px",onOnClick:_},null,8,["file"]),a.isEnableAudio?(e.openBlock(),e.createElementBlock("view",{key:0,class:"audio-input-touch-bar",onTouchstart:E,onLongpress:T,onTouchmove:n[0]||(n[0]=(...t)=>e.unref(S)&&e.unref(S)(...t)),onTouchend:M},[e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t(`TUIChat.${e.unref(h)}`)),1),e.unref(p)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"record-modal"},[e.createElementVNode("div",{class:"red-mask"}),e.createElementVNode("view",{class:"float-element moving-slider"}),e.createElementVNode("view",{class:"float-element modal-title"},e.toDisplayString(e.unref(vp).t(`TUIChat.${e.unref(f)}`)),1)])):e.createCommentVNode("",!0)],32)):e.createCommentVNode("",!0)],2))}}),r_=ee(i_,[["__scopeId","data-v-310f714a"]]),s_=ee(e.defineComponent({__name:"index",props:{displayType:{default:"editor"}},setup(t){const n=t,o=gp.TYPES,a=e.ref();e.onMounted((()=>{mp.watch(tu.CHAT,{quoteMessage:s})})),e.onUnmounted((()=>{mp.unwatch(tu.CHAT,{quoteMessage:s})}));const i=e.computed((()=>{var e,t;let n;switch(null==(e=a.value)?void 0:e.type){case o.MSG_TEXT:n=Fh(null==(t=a.value.payload)?void 0:t.text);break;case o.MSG_IMAGE:n=vp.t("TUIChat.图片");break;case o.MSG_AUDIO:n=vp.t("TUIChat.语音");break;case o.MSG_VIDEO:n=vp.t("TUIChat.视频");break;case o.MSG_FILE:n=vp.t("TUIChat.文件");break;case o.MSG_CUSTOM:n=vp.t("TUIChat.自定义");break;case o.MSG_FACE:n=vp.t("TUIChat.表情");break;case o.MSG_MERGER:n=vp.t("TUIChat.聊天记录");break;default:n=vp.t("TUIChat.消息")}return n}));function r(){mp.update(tu.CHAT,"quoteMessage",{message:void 0,type:"quote"})}function s(e){(null==e?void 0:e.message)&&"quote"===(null==e?void 0:e.type)?a.value=e.message:a.value=void 0}return(t,o)=>Boolean(e.unref(a))&&"audio"!==n.displayType?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"input-quote-container":!0,"input-quote-container-uni":e.unref(eh),"input-quote-container-h5":e.unref(Jp)})},[e.createElementVNode("div",{class:"input-quote-content"},[e.createElementVNode("div",{class:"max-one-line"},e.toDisplayString(e.unref(a).nick||e.unref(a).from)+": "+e.toDisplayString(e.unref(i)),1),e.createVNode(fh,{class:"input-quote-close-icon",file:e.unref(Uv),width:"11px",height:"11px",onOnClick:r},null,8,["file"])])],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-6b103290"]]),l_=ee(e.defineComponent({__name:"index",props:{placeholder:{default:"this is placeholder"},isMuted:{type:Boolean,default:!0},muteText:{default:""},enableInput:{type:Boolean,default:!0},enableAt:{type:Boolean,default:!0},enableTyping:{type:Boolean,default:!0},replyOrReference:{default:()=>({})},inputToolbarDisplayType:{default:"none"}},emits:["changeToolbarDisplayType"],setup(t,{expose:n,emit:o}){const a=o,i=t,r=e.ref(),s=e.ref(),l=e.ref(),c=e.ref(!1),u=e.ref("editor"),d=df.getFeatureConfig(),p=e.ref(d.InputVoice),h=e.ref(d.InputEmoji||d.InputStickers),f=e.ref(d.InputImage||d.InputVideo||d.InputEvaluation||d.InputQuickReplies);function g(e){u.value=e,"audio"===e&&a("changeToolbarDisplayType","none")}function m(e){a("changeToolbarDisplayType",e)}e.onMounted((()=>{mp.watch(tu.CONV,{currentConversation:k}),mp.watch(tu.CHAT,{quoteMessage:E})})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversation:k}),mp.unwatch(tu.CHAT,{quoteMessage:E})})),e.watch((()=>i.inputToolbarDisplayType),(e=>{"none"!==e&&g("editor")}));const v=(e,t)=>{((e,t)=>{e||t?Ip.leaveTypingState():Ip.enterTypingState()})(e,t)},_=e=>{var t;null==(t=null==s?void 0:s.value)||t.toggleAtList(e)},y=()=>{Jp&&a("changeToolbarDisplayType","none")},I=e=>{var t,n;(null==(t=null==r?void 0:r.value)?void 0:t.insertAt)&&(null==(n=null==r?void 0:r.value)||n.insertAt(e))},C=()=>{var e,t;(null==(e=null==r?void 0:r.value)?void 0:e.blur)&&(null==(t=null==r?void 0:r.value)||t.blur())};function k(e){var t;l.value=e,c.value=(null==(t=l.value)?void 0:t.type)===gp.TYPES.CONV_GROUP}function E(e){(null==e?void 0:e.message)&&"quote"===(null==e?void 0:e.type)&&g("editor")}return n({insertEmoji:e=>{var t,n;(null==(t=null==r?void 0:r.value)?void 0:t.addEmoji)&&(null==(n=null==r?void 0:r.value)||n.addEmoji(e))},reEdit:e=>{var t,n;null==(t=null==r?void 0:r.value)||t.resetEditor(),null==(n=null==r?void 0:r.value)||n.setEditorContent(e)}}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-input",!e.unref(Zp)&&"message-input-h5"])},[e.createElementVNode("div",{class:"audio-main-content-line"},[(e.unref(Xp)||e.unref(Qp))&&e.unref(p)?(e.openBlock(),e.createBlock(r_,{key:0,class:e.normalizeClass({"message-input-wx-audio-open":"audio"===e.unref(u)}),isEnableAudio:"audio"===e.unref(u),onChangeDisplayType:g},null,8,["class","isEnableAudio"])):e.createCommentVNode("",!0),e.withDirectives(e.createVNode(n_,{ref_key:"editor",ref:r,class:"message-input-editor",placeholder:i.placeholder,isMuted:i.isMuted,muteText:i.muteText,enableInput:i.enableInput,enableAt:i.enableAt,enableTyping:i.enableTyping,isGroup:e.unref(c),onOnTyping:v,onOnAt:_,onOnFocus:y},null,8,["placeholder","isMuted","muteText","enableInput","enableAt","enableTyping","isGroup"]),[[e.vShow,"editor"===e.unref(u)]]),i.enableAt?(e.openBlock(),e.createBlock(a_,{key:1,ref_key:"messageInputAtRef",ref:s,onInsertAt:I,onOnAtListOpen:C},null,512)):e.createCommentVNode("",!0),e.unref(h)?(e.openBlock(),e.createBlock(fh,{key:2,class:"icon icon-face",file:e.unref("/assets/face-uni.e33f5632.png"),size:"23px",hotAreaSize:"3px",onOnClick:n[0]||(n[0]=e=>m("emojiPicker"))},null,8,["file"])):e.createCommentVNode("",!0),e.unref(f)?(e.openBlock(),e.createBlock(fh,{key:3,class:"icon icon-more",file:e.unref("/assets/more-uni.030c2d9a.png"),size:"23px",hotAreaSize:"3px",onOnClick:n[1]||(n[1]=e=>m("tools"))},null,8,["file"])):e.createCommentVNode("",!0)]),e.createElementVNode("div",null,[e.createVNode(s_,{style:{minWidth:0},displayType:e.unref(u)},null,8,["displayType"])])],2))}}),[["__scopeId","data-v-7e9f1b58"]]),c_=ee(e.defineComponent({__name:"index",emits:["oneByOneForwardMessage","mergeForwardMessage","toggleMultipleSelectMode"],setup(t,{emit:n}){const o=n,a=e.ref(th?"25px":"30px");function i(){o("oneByOneForwardMessage")}function r(){o("mergeForwardMessage")}function s(){o("toggleMultipleSelectMode")}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass({"mulitple-select-panel":!0,"mulitple-select-panel-mobile":e.unref(th)})},[e.createElementVNode("div",{class:"forward-button",onClick:i},[e.createVNode(fh,{file:e.unref("/assets/forward-each.9e79e381.svg"),size:e.unref(a)},null,8,["file","size"]),e.createElementVNode("span",{class:e.normalizeClass({"forward-button-text":!0,"forward-button-text-mobile":e.unref(th)})},e.toDisplayString(e.unref(vp).t("TUIChat.逐条转发")),3)]),e.createElementVNode("div",{class:"forward-button",onClick:r},[e.createVNode(fh,{file:e.unref("/assets/forward-merge.eef115cf.svg"),size:e.unref(a)},null,8,["file","size"]),e.createElementVNode("span",{class:e.normalizeClass({"forward-button-text":!0,"forward-button-text-mobile":e.unref(th)})},e.toDisplayString(e.unref(vp).t("TUIChat.合并转发")),3)]),e.createElementVNode("div",{class:"forward-button",onClick:s},[e.createVNode(fh,{class:"cancel-button-icon",file:e.unref("/assets/add-circle.b2afe9dc.svg"),size:e.unref(a)},null,8,["file","size"]),e.createElementVNode("span",{class:e.normalizeClass({"forward-button-text":!0,"forward-button-text-mobile":e.unref(th)})},e.toDisplayString(e.unref(vp).t("TUIChat.取消")),3)])],2))}}),[["__scopeId","data-v-1b003743"]]),u_="/assets/selected.0a1e59e6.svg",d_=e.defineComponent({__name:"index",props:{list:{type:Array,default:()=>[]},selectedList:{type:Array,default:()=>[]},isSearch:{type:Boolean,default:!0},isRadio:{type:Boolean,default:!1},isCustomItem:{type:Boolean,default:!1},title:{type:String,default:""},type:{type:String,default:""},resultShow:{type:Boolean,default:!0},total:{type:Number,default:0},isHiddenBackIcon:{type:Boolean,default:!1}},emits:["search","submit","cancel","getMore"],setup(t,{emit:n}){const o=t,a=e.ref([]),i=e.ref(0),r=e.ref([]),s=e.ref(!0),l=e.ref(!1),c=e.ref(""),u=e.ref("");e.watchEffect((()=>{if(o.isCustomItem)for(let e=0;e<o.list.length;e++)o.list[e].conversationID.indexOf("@TIM#SYSTEM")>-1&&o.list.splice(e,1),a.value=o.list;else a.value=o.list;i.value=o.total?o.total:o.list.length,r.value=o.selectedList&&o.selectedList.length>0?o.selectedList:r.value,s.value=o.isSearch,l.value=o.isCustomItem,c.value=o.title}));const d=n,p=e.computed((()=>a.value.filter((e=>!e.isDisabled)))),h=e=>{u.value=e.target.value||e.detail.value,d("search",u.value)},f=e=>{if(e.isDisabled)return;let t=r.value;const n=t.indexOf(e);if(n>-1)return r.value.splice(n,1);o.isRadio&&(t=[]),t.push(e),r.value=t},g=()=>{r.value.length===p.value.length?r.value=[]:r.value=[...p.value]},m=()=>{d("submit",r.value),u.value=""},v=()=>{d("cancel"),u.value=""},_=()=>{d("getMore")};return(n,d)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["transfer",[e.unref(Zp)?"":"transfer-h5",e.unref(Xp)?"transfer-h5-wechat":""]])},[e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("header",{key:0,class:"transfer-header transfer-h5-header"},[o.isHiddenBackIcon?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,onClick:v},[e.createVNode(fh,{class:"icon",file:e.unref(dh),width:"18px",height:"18px"},null,8,["file"])])),e.createElementVNode("span",{class:"title"},e.toDisplayString(e.unref(c)),1),e.createElementVNode("span",{class:"space"})])),e.createElementVNode("main",{class:"main"},[e.createElementVNode("div",{class:"left"},[e.createElementVNode("header",{class:"transfer-header"},[e.unref(Zp)&&e.unref(s)?(e.openBlock(),e.createElementBlock("input",{key:0,type:"text",value:e.unref(u),placeholder:e.unref(vp).t("component.请输入userID"),enterkeyhint:"search",class:e.normalizeClass([e.unref(eh)?"left-uniapp-input":""]),onKeyup:e.withKeys(h,["enter"])},null,42,["value","placeholder"])):e.createCommentVNode("",!0),!e.unref(Zp)&&e.unref(s)?(e.openBlock(),e.createElementBlock("input",{key:1,type:"text",placeholder:e.unref(vp).t("component.请输入userID"),enterkeyhint:"search",value:e.unref(u),class:e.normalizeClass([e.unref(eh)?"left-uniapp-input":""]),onBlur:h,onConfirm:h},null,42,["placeholder","value"])):e.createCommentVNode("",!0)]),e.createElementVNode("main",{class:"transfer-left-main"},[e.createElementVNode("ul",{class:"transfer-list"},[e.unref(p).length>1&&!t.isRadio?(e.openBlock(),e.createElementBlock("li",{key:0,class:"transfer-list-item",onClick:g},[e.unref(r).length===e.unref(p).length?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref(u_),width:"18px",height:"18px"},null,8,["file"])):(e.openBlock(),e.createElementBlock("i",{key:1,class:"icon-unselected"})),e.createElementVNode("span",{class:"select-all"},e.toDisplayString(e.unref(vp).t("component.全选")),1)])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),(t=>(e.openBlock(),e.createElementBlock("li",{key:t.userID,class:"transfer-list-item",onClick:e=>f(t)},[e.unref(r).indexOf(t)>-1?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref(u_),class:e.normalizeClass([t.isDisabled&&"disabled"]),width:"18px",height:"18px"},null,8,["file","class"])):(e.openBlock(),e.createElementBlock("i",{key:1,class:e.normalizeClass([t.isDisabled&&"disabled","icon-unselected"])},null,2)),e.unref(l)?e.renderSlot(n.$slots,"left",{key:3,data:t},void 0,!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[e.createElementVNode("img",{class:"avatar",src:t.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"]),e.createElementVNode("span",{class:"name"},e.toDisplayString(t.nick||t.userID),1),t.isDisabled?(e.openBlock(),e.createElementBlock("span",{key:0},"（"+e.toDisplayString(e.unref(vp).t("component.已在群中"))+"）",1)):e.createCommentVNode("",!0)],64))],8,["onClick"])))),128)),e.unref(i)>e.unref(a).length?(e.openBlock(),e.createElementBlock("li",{key:1,class:"transfer-list-item more",onClick:_},e.toDisplayString(e.unref(vp).t("component.查看更多")),1)):e.createCommentVNode("",!0)])])]),e.createElementVNode("div",{class:"right"},[e.unref(Zp)?(e.openBlock(),e.createElementBlock("header",{key:0,class:"transfer-header"},e.toDisplayString(e.unref(c)),1)):e.createCommentVNode("",!0),t.resultShow?(e.openBlock(),e.createElementBlock("ul",{key:1,class:"transfer-list"},[e.unref(r).length>0&&e.unref(Zp)?(e.openBlock(),e.createElementBlock("p",{key:0,class:"transfer-text"},e.toDisplayString(e.unref(vp).t("component.已选中"))+e.toDisplayString(e.unref(r).length)+e.toDisplayString(e.unref(vp).t("component.人")),1)):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),((t,o)=>(e.openBlock(),e.createElementBlock("li",{key:o,class:"transfer-list-item space-between"},[e.createElementVNode("aside",{class:"transfer-list-item-content"},[e.unref(l)?e.renderSlot(n.$slots,"right",{key:1,data:t},void 0,!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createElementVNode("img",{class:"avatar",src:t.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"]),e.unref(Zp)?(e.openBlock(),e.createElementBlock("span",{key:0,class:"name"},e.toDisplayString(t.nick||t.userID),1)):e.createCommentVNode("",!0)],64))]),e.unref(Zp)?(e.openBlock(),e.createElementBlock("span",{key:0,onClick:e=>f(t)},[e.createVNode(fh,{file:e.unref("/assets/cancel.aba36dc1.svg"),width:"18px",height:"18px"},null,8,["file"])],8,["onClick"])):e.createCommentVNode("",!0)])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("footer",{class:"transfer-right-footer"},[e.createElementVNode("button",{class:"btn btn-cancel",onClick:v},e.toDisplayString(e.unref(vp).t("component.取消")),1),e.unref(r).length>0?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn",onClick:m},e.toDisplayString(e.unref(vp).t("component.完成")),1)):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn btn-no",onClick:m},e.toDisplayString(e.unref(vp).t("component.完成")),1))])])])],2))}}),p_=ee(d_,[["__scopeId","data-v-63274b4c"]]),h_=e.defineComponent({__name:"index",emits:["toggleMultipleSelectMode"],setup(t,{emit:n}){const o=n;let a=[],i=!1;const r=e.ref(!1),s=e.ref();function l(e){void 0!==e&&(i=!1,a=[e],p())}function c(e){if(!e)return;i=!1;const{isMergeForward:t,messageIDList:n}=e||{};(null==n?void 0:n.length)>0?(i=t,a=n,p()):tf({message:vp.t("TUIChat.未选择消息"),type:Qh})}function u(){mp.update(tu.CUSTOM,"singleForwardMessageID",void 0),mp.update(tu.CUSTOM,"multipleForwardMessageID",void 0)}function d(){u(),r.value=!1}function p(){!function(){const e=mp.getData(tu.CONV,"conversationList");s.value=e.map((e=>({userID:e.conversationID,nick:e.getShowName(),avatar:e.getAvatar()})))}(),r.value=!0}function h(e){if(0===(null==e?void 0:e.length))return;const t=e.map((e=>mp.getConversationModel(e.userID))),n=a.map((e=>mp.getMessageModel(e))).sort(((e,t)=>e.time-t.time)),r=t.map((e=>{const t={conversation:e,messageType:gp.TYPES.MSG_MERGER};return Ip.sendForwardMessage([e],n,{needMerge:i,offlinePushInfo:Jf.create(t),params:{needReadReceipt:yh()}})}));Promise.allSettled(r).then((e=>{for(const t of e){const{status:e}=t;if("rejected"===e){const e=80001===t.reason.code?vp.t("TUIChat.内容包含敏感词汇"):t.reason.message;tf({message:e,type:Qh});break}}})),d(),o("toggleMultipleSelectMode",!1)}return e.onMounted((()=>{mp.watch(tu.CUSTOM,{singleForwardMessageID:l,multipleForwardMessageID:c})})),e.onUnmounted((()=>{mp.unwatch(tu.CUSTOM,{singleForwardMessageID:l,multipleForwardMessageID:c}),u()})),(t,n)=>(e.openBlock(),e.createBlock(Eh,{visible:e.unref(r),useMask:!1},{default:e.withCtx((()=>[e.createVNode(p_,{title:e.unref(vp).t("TUIChat.转发"),isSearch:!1,isCustomItem:!1,list:e.unref(s),isHiddenBackIcon:e.unref(eh),onCancel:d,onSubmit:h},null,8,["title","list","isHiddenBackIcon"])])),_:1},8,["visible"]))}}),f_=ee(e.defineComponent({__name:"index",props:{iconFile:{type:String,required:!0},title:{type:String,default:""},needDialog:{type:Boolean,default:!0},iconWidth:{type:String,default:"20px"},iconHeight:{type:String,default:"20px"},needBottomPopup:{type:Boolean,default:!1}},emits:["onIconClick","onDialogClose","onDialogShow"],setup(t,{expose:n,emit:o}){const a=t,i=o,r=e.ref("dark"===df.getTheme()),s=e.ref(!1),l=e.ref(),c=e.ref(),u=()=>{i("onIconClick",c),Zp&&Kp.listen({domRefs:l.value,handler:d}),a.needDialog&&p(!s.value)},d=()=>{s.value=!1,i("onDialogClose",c)},p=e=>{if(s.value!==e)switch(s.value=e,e){case!0:i("onDialogShow",c);break;case!1:i("onDialogClose",c)}},h=()=>{s.value=!1};return n({toggleDialogDisplay:p}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"toolbarItemRef",ref:l,class:e.normalizeClass(["toolbar-item-container",!e.unref(Zp)&&"toolbar-item-container-h5",e.unref(eh)&&"toolbar-item-container-uni"])},[e.createElementVNode("div",{class:e.normalizeClass(["toolbar-item-container-icon",e.unref(eh)&&"toolbar-item-container-uni-icon"]),onClick:u},[e.createVNode(fh,{file:a.iconFile,class:"icon",width:a.iconWidth,height:a.iconHeight},null,8,["file","width","height"])],2),e.unref(eh)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["toolbar-item-container-uni-title"])},e.toDisplayString(a.title),1)):e.createCommentVNode("",!0),e.withDirectives(e.createElementVNode("div",{ref_key:"dialogRef",ref:c,class:e.normalizeClass(["toolbar-item-container-dialog",e.unref(r)&&"toolbar-item-container-dialog-dark",!e.unref(Zp)&&"toolbar-item-container-h5-dialog",e.unref(eh)&&"toolbar-item-container-uni-dialog"])},[a.needBottomPopup&&!e.unref(Zp)?(e.openBlock(),e.createBlock(o_,{key:0,class:"toolbar-bottom-popup",show:e.unref(s),onTouchmove:n[0]||(n[0]=e.withModifiers((()=>{}),["stop","prevent"])),onOnClose:h},{default:e.withCtx((()=>[e.renderSlot(t.$slots,"default",{},void 0,!0)])),_:3},8,["show"])):e.renderSlot(t.$slots,"default",{key:1},void 0,!0)],2),[[e.vShow,e.unref(s)]])],2))}}),[["__scopeId","data-v-9a9334fa"]]),g_="/assets/camera-uni.e7fd6e1a.png",m_=e.defineComponent({__name:"index",props:{imageSourceType:{type:String,default:"album"}},setup(t){const n=t,o=e.ref(),a=e.ref(),i={web_album:{icon:"dark"===df.getTheme()?"/assets/image-dark.bf322028.svg":"/assets/image-light.3da9cf2c.svg",title:"图片"},uni_album:{icon:"/assets/image-uni.3e951cbb.png",title:"图片"},uni_camera:{icon:g_,title:"拍照"}};mp.watch(tu.CONV,{currentConversation:e=>{a.value=e}});const r=e.computed((()=>eh?"camera"===n.imageSourceType?i.uni_camera:i.uni_album:i.web_album)),s=()=>{var e;eh?Xp&&(null==bp?void 0:bp.chooseMedia)?null==bp||bp.chooseMedia({count:1,mediaType:["image"],sizeType:["original","compressed"],sourceType:[n.imageSourceType],success:function(e){c(e)}}):null==bp||bp.chooseImage({count:1,sourceType:[n.imageSourceType],success:function(e){c(e)}}):(null==(e=o.value)?void 0:e.click)&&o.value.click()},l=e=>{var t,n;(null==(n=null==(t=null==e?void 0:e.target)?void 0:t.files)?void 0:n.length)<=0||(c(null==e?void 0:e.target),e.target.value="")},c=e=>{var t,n,o,i,r;if(!e)return;const s={to:(null==(n=null==(t=null==a?void 0:a.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(i=null==(o=null==a?void 0:a.value)?void 0:o.userProfile)?void 0:i.userID),conversationType:null==(r=null==a?void 0:a.value)?void 0:r.type,payload:{file:e},needReadReceipt:yh()},l={conversation:a.value,payload:s.payload,messageType:gp.TYPES.MSG_IMAGE},c={offlinePushInfo:Jf.create(l)};Ip.sendImageMessage(s,c)};return(t,n)=>(e.openBlock(),e.createBlock(f_,{iconFile:e.unref(r).icon,title:e.unref(r).title,iconWidth:e.unref(eh)?"32px":"20px",iconHeight:e.unref(eh)?"25px":"18px",needDialog:!1,onOnIconClick:s},{default:e.withCtx((()=>[e.unref(eh)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["image-upload",!e.unref(Zp)&&"image-upload-h5"])},[e.createElementVNode("input",{ref_key:"inputRef",ref:o,title:"图片",type:"file","data-type":"image",accept:"image/gif,image/jpeg,image/jpg,image/png,image/bmp,image/webp",onChange:l},null,544)],2))])),_:1},8,["iconFile","title","iconWidth","iconHeight"]))}}),v_=ee(m_,[["__scopeId","data-v-7706ffed"]]),__="/assets/video-uni.0b4d3e53.png",y_=e.defineComponent({__name:"index",props:{videoSourceType:{type:String,default:"album"}},setup(t){const n=t,o=e.ref(),a=e.ref();mp.watch(tu.CONV,{currentConversation:e=>{a.value=e}});const i=()=>{if(!eh){return"dark"===df.getTheme()?"/assets/video-dark.e7ceead3.svg":"/assets/video-light.48615dd3.svg"}switch(n.videoSourceType){case"album":default:return __;case"camera":return g_}},r=()=>{var e,t;eh?Xp&&(null==bp?void 0:bp.chooseMedia)?null==bp||bp.chooseMedia({mediaType:["video"],count:1,sourceType:[n.videoSourceType],maxDuration:60,success:function(e){l(e)}}):null==bp||bp.chooseVideo({count:1,sourceType:[n.videoSourceType],compressed:!1,success:function(e){l(e)}}):(null==(e=null==o?void 0:o.value)?void 0:e.click)&&(null==(t=null==o?void 0:o.value)||t.click())},s=e=>{var t,n;(null==(n=null==(t=null==e?void 0:e.target)?void 0:t.files)?void 0:n.length)<=0||(l(null==e?void 0:e.target),e.target.value="")},l=e=>{var t,n,o,i,r;if(!e)return;const s={to:(null==(n=null==(t=null==a?void 0:a.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(i=null==(o=null==a?void 0:a.value)?void 0:o.userProfile)?void 0:i.userID),conversationType:null==(r=null==a?void 0:a.value)?void 0:r.type,payload:{file:e},needReadReceipt:yh()},l={conversation:a.value,payload:s.payload,messageType:gp.TYPES.MSG_VIDEO},c={offlinePushInfo:Jf.create(l)};Ip.sendVideoMessage(s,c)};return(t,a)=>(e.openBlock(),e.createBlock(f_,{iconFile:i(),title:eh&&"camera"===n.videoSourceType?"录制":"视频",needDialog:!1,iconWidth:e.unref(eh)?"32px":"20px",iconHeight:e.unref(eh)?"album"===n.videoSourceType?"20px":"25px":"18px",onOnIconClick:r},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(["video-upload",!e.unref(Zp)&&"video-upload-h5"])},[e.createElementVNode("input",{ref_key:"inputRef",ref:o,title:"视频",type:"file","data-type":"video",accept:"video/*",onChange:s},null,544)],2)])),_:1},8,["iconFile","title","iconWidth","iconHeight"]))}}),I_=ee(y_,[["__scopeId","data-v-5a843f45"]]),C_={product:{label:"产品文档",url:"https://cloud.tencent.com/document/product/269/1499#.E7.BE.A4.E7.BB.84.E5.8A.9F.E8.83.BD"},customMessage:{label:"自定义消息",url:"https://web.sdk.qcloud.com/im/doc/v3/zh-cn/SDK.html#createCustomMessage"},complaint:{label:"点此投诉",url:"https://cloud.tencent.com/apply/p/xc3oaubi98g"},implement:{label:"集成TUICallKit",url:"https://cloud.tencent.com/document/product/269/79861"},purchase:{label:"开通腾讯实时音视频服务",url:"https://cloud.tencent.com/document/product/1640/79968"}},k_=ee(e.defineComponent({__name:"index",props:{starTotal:{type:Number,default:5}},emits:["onDialogPopupShowOrHide"],setup(t,{emit:n}){const o="dark"===df.getTheme()?"/assets/evalute-dark.e265e635.svg":"/assets/evalute-light.8db79ed8.svg",a=t,i=n,r=e.ref(),s=e.ref(a.starTotal),l=e.ref(-1),c=e.ref(""),u=e.ref();mp.watch(tu.CONV,{currentConversation:e=>{u.value=e}});const d=e.computed((()=>c.value.length||l.value>=0)),p=()=>{i("onDialogPopupShowOrHide",!0)},h=()=>{g(),i("onDialogPopupShowOrHide",!1)},f=()=>{var e;null==(e=null==r?void 0:r.value)||e.toggleDialogDisplay(!1)},g=()=>{l.value=-1,c.value=""},m=()=>{var e,t,n,o,a,i;if(l.value<0&&!c.value.length)return;const s={data:JSON.stringify({businessID:Dh.EVALUATE,version:1,score:l.value+1,comment:c.value}),description:"对本次的服务评价",extension:"对本次的服务评价"},d={to:(null==(t=null==(e=null==u?void 0:u.value)?void 0:e.groupProfile)?void 0:t.groupID)||(null==(o=null==(n=null==u?void 0:u.value)?void 0:n.userProfile)?void 0:o.userID),conversationType:null==(a=null==u?void 0:u.value)?void 0:a.type,payload:s,needReadReceipt:yh()},p={conversation:u.value,payload:d.payload,messageType:gp.TYPES.MSG_CUSTOM},h={offlinePushInfo:Jf.create(p)};Ip.sendCustomMessage(d,h),null==(i=null==r?void 0:r.value)||i.toggleDialogDisplay(!1)};return(t,n)=>(e.openBlock(),e.createBlock(f_,{ref_key:"container",ref:r,iconFile:e.unref(o),title:"评价",needBottomPopup:!0,iconWidth:e.unref(eh)?"26px":"20px",iconHeight:e.unref(eh)?"26px":"20px",onOnDialogShow:p,onOnDialogClose:h},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(["evaluate",!e.unref(Zp)&&"evaluate-h5"])},[e.createElementVNode("div",{class:e.normalizeClass(["evaluate-header",!e.unref(Zp)&&"evaluate-h5-header"])},[e.createElementVNode("div",{class:e.normalizeClass(["evaluate-header-content",!e.unref(Zp)&&"evaluate-h5-header-content"])},e.toDisplayString(e.unref(vp).t("Evaluate.请对本次服务进行评价")),3),e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["evaluate-header-close",!e.unref(Zp)&&"evaluate-h5-header-close"]),onClick:e.withModifiers(f,["stop"])},e.toDisplayString(e.unref(vp).t("关闭")),3))],2),e.createElementVNode("div",{class:e.normalizeClass(["evaluate-content",!e.unref(Zp)&&"evaluate-h5-content"])},[e.createElementVNode("ul",{class:e.normalizeClass(["evaluate-content-list",!e.unref(Zp)&&"evaluate-h5-content-list"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:e.normalizeClass(["evaluate-content-list-item",!e.unref(Zp)&&"evaluate-h5-content-list-item"]),onClick:e.withModifiers((e=>{return t=n,void(l.value===t?l.value=l.value-1:l.value=t);var t}),["stop"])},[n<=e.unref(l)?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref(sf),width:e.unref(Zp)?"20px":"30px",height:e.unref(Zp)?"20px":"30px"},null,8,["file","width","height"])):(e.openBlock(),e.createBlock(fh,{key:1,file:e.unref("/assets/star.8a9a7e2e.png"),width:e.unref(Zp)?"20px":"30px",height:e.unref(Zp)?"20px":"30px"},null,8,["file","width","height"]))],10,["onClick"])))),128))],2),e.withDirectives(e.createElementVNode("textarea",{"onUpdate:modelValue":n[0]||(n[0]=t=>e.isRef(c)?c.value=t:null),class:e.normalizeClass(["evaluate-content-text",!e.unref(Zp)&&"evaluate-h5-content-text"])},null,2),[[e.vModelText,e.unref(c)]]),e.createElementVNode("div",{class:e.normalizeClass(["evaluate-content-button",!e.unref(Zp)&&"evaluate-h5-content-button"])},[e.createElementVNode("button",{class:e.normalizeClass(["btn",e.unref(d)?"btn-valid":"btn-invalid"]),onClick:m},e.toDisplayString(e.unref(vp).t("Evaluate.提交评价")),3)],2)],2),e.createElementVNode("div",{class:e.normalizeClass(["evaluate-adv",!e.unref(Zp)&&"evaluate-h5-adv"])},[e.createTextVNode(e.toDisplayString(e.unref(vp).t("Evaluate.服务评价工具"))+" "+e.toDisplayString("("+e.unref(vp).t("Evaluate.使用"))+" ",1),e.createElementVNode("a",{onClick:n[1]||(n[1]=t=>{return e.unref(C_).customMessage,void((Zp||Jp)&&window.open(null==(n=null==C_?void 0:C_.customMessage)?void 0:n.url));var n})},e.toDisplayString(e.unref(vp).t(`Evaluate.${e.unref(C_).customMessage.label}`)),1),e.createTextVNode(" "+e.toDisplayString(e.unref(vp).t("Evaluate.搭建")+")"),1)],2)],2)])),_:1},8,["iconFile","iconWidth","iconHeight"]))}}),[["__scopeId","data-v-dd3846e5"]]),E_=[{value:"在吗？在吗？在吗？重要的话说三遍。"},{value:"好久没聊天了，快来和我说说话～"},{value:"好的，就这么说定了。"},{value:"感恩的心，感谢有你。"},{value:"糟糕！是心动的感觉！"},{value:"心疼地抱抱自己，我太难了！"},{value:"没关系，别在意，事情过去就过去了。"},{value:"早上好，今天也是让人期待的一天呢！"},{value:"熬夜有什么用，又没人陪你聊天，早点休息吧。"}],T_=ee(e.defineComponent({__name:"index",emits:["onDialogPopupShowOrHide"],setup(t,{emit:n}){const o="dark"===df.getTheme()?"/assets/words-dark.6a706f9a.svg":"/assets/words-light.c8aec883.svg",a=n,i=e.ref(),r=e.ref();mp.watch(tu.CONV,{currentConversation:e=>{i.value=e}});const s=()=>{var e;null==(e=null==r?void 0:r.value)||e.toggleDialogDisplay(!1)},l=()=>{a("onDialogPopupShowOrHide",!0)},c=()=>{a("onDialogPopupShowOrHide",!1)};return(t,n)=>(e.openBlock(),e.createBlock(f_,{ref_key:"container",ref:r,iconFile:e.unref(o),title:"常用语",needBottomPopup:!0,iconWidth:e.unref(eh)?"26px":"20px",iconHeight:e.unref(eh)?"26px":"20px",onOnDialogShow:l,onOnDialogClose:c},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(["words",!e.unref(Zp)&&"words-h5"])},[e.createElementVNode("div",{class:e.normalizeClass(["words-header",!e.unref(Zp)&&"words-h5-header"])},[e.createElementVNode("span",{class:e.normalizeClass(["words-header-title",!e.unref(Zp)&&"words-h5-header-title"])},e.toDisplayString(e.unref(vp).t("Words.常用语-快捷回复工具")),3),e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",{key:0,class:e.normalizeClass(["words-header-close",!e.unref(Zp)&&"words-h5-header-close"]),onClick:s}," 关闭 ",2))],2),e.createElementVNode("ul",{class:e.normalizeClass(["words-list",!e.unref(Zp)&&"words-h5-list"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(E_),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:e.normalizeClass(["words-list-item",!e.unref(Zp)&&"words-h5-list-item"]),onClick:e=>(e=>{var t,n,o,a,s,l;const c={to:(null==(n=null==(t=null==i?void 0:i.value)?void 0:t.groupProfile)?void 0:n.groupID)||(null==(a=null==(o=null==i?void 0:i.value)?void 0:o.userProfile)?void 0:a.userID),conversationType:null==(s=null==i?void 0:i.value)?void 0:s.type,payload:{text:vp.t(`Words.${e.value}`)},needReadReceipt:yh()};Ip.sendTextMessage(c),null==(l=null==r?void 0:r.value)||l.toggleDialogDisplay(!1)})(t)},e.toDisplayString(e.unref(vp).t(`Words.${t.value}`)),11,["onClick"])))),128))],2)],2)])),_:1},8,["iconFile","iconWidth","iconHeight"]))}}),[["__scopeId","data-v-3ec8a7c7"]]),S_=ee(e.defineComponent({__name:"emoji-picker-dialog",emits:["insertEmoji","onClose","sendMessage"],setup(t,{emit:n}){var o;const a="dark"===df.getTheme()?"/assets/face-dark.1ce4b9fa.svg":"/assets/face-light.b3a6acfa.svg",i=n,r=e.ref(0),s=e.ref(),l=e.ref(),c=e.ref(),u=df.getFeatureConfig(),d=e.ref(Bh.filter((e=>e.type===Nh.BASIC?u.InputEmoji:e.type===Nh.BIG||e.type===Nh.CUSTOM?u.InputStickers:void 0))),p=e.ref(null==d?void 0:d.value[0]),h=e.ref(null==(o=null==d?void 0:d.value[0])?void 0:o.list);e.onMounted((()=>{mp.watch(tu.CONV,{currentConversation:m})})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversation:m})}));const f=(e,t)=>{var n,o,a,i,r;const l={to:(null==(o=null==(n=null==s?void 0:s.value)?void 0:n.groupProfile)?void 0:o.groupID)||(null==(i=null==(a=null==s?void 0:s.value)?void 0:a.userProfile)?void 0:i.userID),conversationType:null==(r=null==s?void 0:s.value)?void 0:r.type,payload:{index:t.emojiGroupID,data:t.list[e]},needReadReceipt:yh()};Ip.sendFaceMessage(l)};function g(){uni.$emit("send-message-in-emoji-picker")}function m(e){s.value=e}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"emojiPickerDialog",ref:l,class:e.normalizeClass({"emoji-picker":!0,"emoji-picker-h5":!e.unref(Zp)})},[e.createElementVNode("ul",{ref_key:"emojiPickerListRef",ref:c,class:e.normalizeClass(["emoji-picker-list",!e.unref(Zp)&&"emoji-picker-h5-list"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(h),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"emoji-picker-list-item",onClick:e=>((e,t)=>{var n,o,a;const r={emoji:{key:e,name:Gh(e)},type:null==(n=null==p?void 0:p.value)?void 0:n.type};switch(null==(o=null==p?void 0:p.value)?void 0:o.type){case Nh.BASIC:r.url=(null==(a=null==p?void 0:p.value)?void 0:a.url)+Vh[e],eh?uni.$emit("insert-emoji",r):i("insertEmoji",r);break;case Nh.BIG:case Nh.CUSTOM:f(t,p.value)}Zp&&i("onClose")})(t,n)},[e.unref(p).type===e.unref(Nh).BASIC?(e.openBlock(),e.createElementBlock("img",{key:0,class:"emoji",src:e.unref(p).url+e.unref(Vh)[t]},null,8,["src"])):e.unref(p).type===e.unref(Nh).BIG?(e.openBlock(),e.createElementBlock("img",{key:1,class:"emoji-big",src:e.unref(p).url+t+"@2x.png"},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:2,class:"emoji-custom emoji-big",src:e.unref(p).url+t},null,8,["src"]))],8,["onClick"])))),128))],2),e.createElementVNode("ul",{class:"emoji-picker-tab"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"emoji-picker-tab-item",onClick:e=>(e=>{var t;r.value=e,p.value=null==d?void 0:d.value[e],h.value=null==(t=null==d?void 0:d.value[e])?void 0:t.list,eh||(null==c?void 0:c.value)&&(c.value.scrollTop=0)})(n)},[t.type===e.unref(Nh).BASIC?(e.openBlock(),e.createBlock(fh,{key:0,class:"icon",file:e.unref(a)},null,8,["file"])):t.type===e.unref(Nh).BIG?(e.openBlock(),e.createElementBlock("img",{key:1,class:"icon-big",src:t.url+t.list[0]+"@2x.png"},null,8,["src"])):(e.openBlock(),e.createElementBlock("img",{key:2,class:"icon-custom icon-big",src:t.url+t.list[0]},null,8,["src"]))],8,["onClick"])))),128)),e.unref(eh)?(e.openBlock(),e.createElementBlock("li",{key:0,class:"send-btn",onClick:g}," 发送 ")):e.createCommentVNode("",!0)])],2))}}),[["__scopeId","data-v-e4881e2a"]]),M_=e.defineComponent({__name:"index",props:{type:{type:String,default:""},currentConversation:{type:Object,default:()=>({})},isGroup:{type:Boolean,default:!1}},emits:["submit","cancel"],setup(t,{expose:n,emit:o}){const a=t,i=o,r=e.ref(!1),s=e.ref(""),l=e.ref([]),c=e.ref([]),u=e.ref(""),d={voiceCall:"发起群语音",videoCall:"发起群视频"},p=e.computed((()=>d[a.type]?d[a.type]:""));yp.getUserProfile().then((e=>{var t;(null==(t=null==e?void 0:e.data)?void 0:t.userID)&&(u.value=e.data.userID)})),e.watch((()=>{var e;return[null==(e=null==a?void 0:a.currentConversation)?void 0:e.conversationID,r.value]}),((e,t)=>{e&&e!==t&&(a.isGroup&&r.value?(s.value=a.currentConversation.groupProfile.groupID,Cp.getGroupMemberList({groupID:s.value}).then((e=>{var t,n;l.value=null==(n=null==(t=null==e?void 0:e.data)?void 0:t.memberList)?void 0:n.filter((e=>(null==e?void 0:e.userID)!==u.value)),c.value=l.value}))):(s.value="",l.value=[],c.value=l.value))}),{immediate:!0});const h=e=>{var t;const n=null==(t=l.value)?void 0:t.filter((t=>(null==t?void 0:t.userID)===e));c.value=(null==n?void 0:n.length)?n:l.value},f=e=>{const t=[];null==e||e.forEach((e=>{(null==e?void 0:e.userID)&&t.push(e.userID)})),"voiceCall"===a.type?i("submit",{userIDList:t,groupID:s.value,type:1}):"videoCall"===a.type&&i("submit",{userIDList:t,groupID:s.value,type:2}),c.value=l.value,m(!1)},g=()=>{c.value=l.value,i("cancel"),m(!1)},m=e=>{r.value=e};return n({toggleShow:m}),(t,n)=>(e.openBlock(),e.createBlock(Fv,{show:e.unref(r),isH5:!e.unref(Zp),isHeaderShow:!1,isFooterShow:!1,background:!1,"onUpdate:show":m},{default:e.withCtx((()=>[e.createVNode(p_,{isSearch:!0,title:e.unref(p),list:e.unref(c),isH5:!e.unref(Zp),isRadio:!1,onSearch:h,onSubmit:f,onCancel:g},null,8,["title","list","isH5"])])),_:1},8,["show","isH5"]))}}),w_=ee(e.defineComponent(__spreadProps(__spreadValues({},{options:{styleIsolation:"shared"}}),{__name:"index",props:{displayType:{}},setup(t){const n=t,o=e.ref(),a=e.ref(!1),i=e.ref(""),r=e.ref(),s=e.ref(),l=e.ref([]),c=e.ref(!1),u=df.getFeatureConfig(),d=e.ref(8),p=e.ref(0);e.onMounted((()=>{mp.watch(tu.CUSTOM,{activeConversation:h})})),e.onUnmounted((()=>{mp.unwatch(tu.CUSTOM,{activeConversation:h})}));const h=e=>{var t;e&&e!==(null==(t=o.value)?void 0:t.conversationID)&&(f(),u.InputImage&&u.InputVideo?d.value-=4:(u.InputImage||u.InputVideo)&&(d.value-=2),p.value=d.value,d.value-=l.value.length,1===d.value?c.value=u.InputEvaluation&&u.InputQuickReplies:d.value<1&&(c.value=u.InputEvaluation||u.InputQuickReplies),o.value=mp.getData(tu.CONV,"currentConversation"),a.value=e.startsWith(gp.TYPES.CONV_GROUP))},f=()=>{const e=df.getChatType(),t={chatType:e};e===nt.TUIChat.TYPE.CUSTOMER_SERVICE&&(t.filterVoice=!0,t.filterVideo=!0,Df("customerService")),l.value=[..._t.getExtensionList(nt.TUIChat.EXTENSION.INPUT_MORE.EXT_ID,t)].filter((e=>{var t;return"search"!==(null==(t=null==e?void 0:e.data)?void 0:t.name)||u.MessageSearch})),l.value.forEach((e=>{var t;const n=null==(t=null==e?void 0:e.data)?void 0:t.name;"voiceCall"===n?Ep.reportFeature(203,"voice-call"):"videoCall"===n?Ep.reportFeature(203,"video-call"):"quickRoom"===n&&Ep.reportFeature(204)}))};const g=e=>{var t,n,o;const a=l.value.find((t=>{var n,o;return(null==(n=null==t?void 0:t.data)?void 0:n.name)===(null==(o=null==e?void 0:e.data)?void 0:o.name)}));switch(null==(t=null==a?void 0:a.data)?void 0:t.name){case"voiceCall":m(a,1);break;case"videoCall":m(a,2);break;case"search":null==(o=null==(n=null==a?void 0:a.listener)?void 0:n.onClicked)||o.call(n)}},m=(e,t)=>{var n,l,c,u,d,p,h;i.value=null==(n=null==e?void 0:e.data)?void 0:n.name,(null==(l=null==o?void 0:o.value)?void 0:l.type)===gp.TYPES.CONV_C2C?null==(p=null==(c=null==e?void 0:e.listener)?void 0:c.onClicked)||p.call(c,{userIDList:[null==(d=null==(u=null==o?void 0:o.value)?void 0:u.conversationID)?void 0:d.slice(3)],type:t,callParams:{offlinePushInfo:Jf.getOfflinePushInfo(Zf.CALL)}}):a.value&&(s.value=e,(null==(h=null==r?void 0:r.value)?void 0:h.toggleShow)&&r.value.toggleShow(!0))},v=e=>null==e?void 0:e.icon,_=e=>null==e?void 0:e.text,y=e=>{var t,n,o;null==(o=null==(n=null==(t=s.value)?void 0:t.listener)?void 0:n.onClicked)||o.call(n,__spreadProps(__spreadValues({},e),{callParams:{offlinePushInfo:Jf.getOfflinePushInfo(Zf.CALL)}})),s.value=null},I=()=>{s.value=null},C=e=>{c.value=d.value<=1&&!e};return(t,s)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-input-toolbar","message-input-toolbar-h5","message-input-toolbar-uni"])},["emojiPicker"===n.displayType?(e.openBlock(),e.createElementBlock("div",{key:0},[e.createVNode(S_)])):(e.openBlock(),e.createElementBlock("div",{key:1},[e.createElementVNode("swiper",{class:e.normalizeClass(["message-input-toolbar-swiper"]),"indicator-dots":e.unref(c),autoplay:!1,circular:!1},[e.createElementVNode("swiper-item",{class:e.normalizeClass(["message-input-toolbar-list","message-input-toolbar-h5-list","message-input-toolbar-uni-list"])},[e.unref(u).InputImage?(e.openBlock(),e.createBlock(v_,{key:0,imageSourceType:"camera"})):e.createCommentVNode("",!0),e.unref(u).InputImage?(e.openBlock(),e.createBlock(v_,{key:1,imageSourceType:"album"})):e.createCommentVNode("",!0),e.unref(u).InputVideo?(e.openBlock(),e.createBlock(I_,{key:2,videoSourceType:"album"})):e.createCommentVNode("",!0),e.unref(u).InputVideo?(e.openBlock(),e.createBlock(I_,{key:3,videoSourceType:"camera"})):e.createCommentVNode("",!0),e.unref(l).length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:4},e.renderList(e.unref(l).slice(0,e.unref(p)),((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n},[t?(e.openBlock(),e.createBlock(f_,{key:0,iconFile:v(t),title:_(t),iconWidth:"25px",iconHeight:"25px",needDialog:!1,onOnIconClick:e=>g(t)},null,8,["iconFile","title","onOnIconClick"])):e.createCommentVNode("",!0)])))),128)):e.createCommentVNode("",!0),1===e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:5},[e.unref(u).InputEvaluation?(e.openBlock(),e.createBlock(k_,{key:0,onOnDialogPopupShowOrHide:C})):e.unref(u).InputQuickReplies?(e.openBlock(),e.createBlock(T_,{key:1,onOnDialogPopupShowOrHide:C})):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0),e.unref(d)>1?(e.openBlock(),e.createElementBlock(e.Fragment,{key:6},[e.unref(u).InputEvaluation?(e.openBlock(),e.createBlock(k_,{key:0,onOnDialogPopupShowOrHide:C})):e.createCommentVNode("",!0),e.unref(u).InputQuickReplies?(e.openBlock(),e.createBlock(T_,{key:1,onOnDialogPopupShowOrHide:C})):e.createCommentVNode("",!0)],64)):e.createCommentVNode("",!0)]),e.unref(d)<=1?(e.openBlock(),e.createElementBlock("swiper-item",{key:0,class:e.normalizeClass(["message-input-toolbar-list","message-input-toolbar-h5-list","message-input-toolbar-uni-list"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l).slice(e.unref(p)),((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n},[t?(e.openBlock(),e.createBlock(f_,{key:0,iconFile:v(t),title:_(t),iconWidth:"25px",iconHeight:"25px",needDialog:!1,onOnIconClick:e=>g(t)},null,8,["iconFile","title","onOnIconClick"])):e.createCommentVNode("",!0)])))),128)),1===e.unref(d)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.unref(u).InputQuickReplies?(e.openBlock(),e.createBlock(T_,{key:0,onOnDialogPopupShowOrHide:C})):e.createCommentVNode("",!0)],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.unref(u).InputEvaluation?(e.openBlock(),e.createBlock(k_,{key:0,onOnDialogPopupShowOrHide:C})):e.createCommentVNode("",!0),e.unref(u).InputQuickReplies?(e.openBlock(),e.createBlock(T_,{key:1,onOnDialogPopupShowOrHide:C})):e.createCommentVNode("",!0)],64))])):e.createCommentVNode("",!0)],8,["indicator-dots"])])),e.createVNode(M_,{ref_key:"userSelectorRef",ref:r,type:e.unref(i),currentConversation:e.unref(o),isGroup:e.unref(a),onSubmit:y,onCancel:I},null,8,["type","currentConversation","isGroup"])]))}})),[["__scopeId","data-v-86c56847"]]),b_=ee(e.defineComponent({__name:"index",emits:["closeChat"],setup(t,{emit:n}){ce((e=>{(e=>{const{chat:t}=yt.getContext();if(e&&e.conversationID&&(null==t?void 0:t.isReady())){const{conversationID:t}=e;if(!t.startsWith("C2C")&&!t.startsWith("GROUP"))return void oe("warn","at TUIKit/components/TUIChat/entry-chat-only.ts:22","conversationID from options is invalid.");_p.switchConversation(t)}})(e)})),de((()=>{Promise.resolve().then((()=>{})).catch((()=>{}))}));const o=n,a=e.ref(void 0),i=e.ref(!1),r=e.ref(!1),s=e.ref(),l=e.ref(),c=e.ref(!1),u=e.ref("none"),d=e.ref(),p=e.ref(),h=e.ref([]),f=df.getFeatureConfig();e.onMounted((()=>{mp.watch(tu.CONV,{currentConversation:w})})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversation:w}),v()}));const g=e.computed((()=>!eh||"none"!==u.value)),m=e.computed((()=>{let e="";switch(s.value){case 4:e=vp.t("TUIChat.您已被管理员移出群聊");break;case 5:e=vp.t("TUIChat.该群聊已被解散");break;default:e=vp.t("TUIChat.您已退出该群聊")}return e})),v=()=>{_p.switchConversation("")},_=e=>{o("closeChat",e),v()},y=e=>{var t;null==(t=d.value)||t.insertEmoji(e)},I=(e,t)=>{var n,o,a;if(e&&t)switch(t){case"reference":case"reply":break;case"reedit":(null==(n=null==e?void 0:e.payload)?void 0:n.text)&&(null==(a=null==d?void 0:d.value)||a.reEdit(null==(o=null==e?void 0:e.payload)?void 0:o.text))}},C=()=>{h.value[0].listener.onClicked({groupID:a.value})};function k(e){u.value=u.value===e?"none":e,"none"!==u.value&&eh&&uni.$emit("scroll-to-bottom")}function E(){var e;null==(e=p.value)||e.scrollToLatestMessage()}function T(e){c.value=void 0===e?!c.value:e}function S(){var e;null==(e=p.value)||e.mergeForwardMessage()}function M(){var e;null==(e=p.value)||e.oneByOneForwardMessage()}function w(e){if(function(e){(null==e?void 0:e.operationType)>0?(h.value=[],r.value=!0,s.value=null==e?void 0:e.operationType):(r.value=!1,s.value=void 0)}(e),!e)return;if(l.value===(null==e?void 0:e.conversationID))return;i.value=!1;let t=gp.TYPES.CONV_C2C;const n=e.conversationID;if(n.startsWith(gp.TYPES.CONV_GROUP)&&(t=gp.TYPES.CONV_GROUP,i.value=!0,a.value=n.replace(gp.TYPES.CONV_GROUP,"")),h.value=[],c.value=!1,df.setChatType(t),_t.notifyEvent(nt.TUIChat.EVENT.CHAT_STATE_CHANGED,nt.TUIChat.EVENT_SUB_KEY.CHAT_OPENED,{groupID:a.value}),_t.callService({serviceName:nt.TUICustomerServicePlugin.SERVICE.NAME,method:nt.TUICustomerServicePlugin.SERVICE.METHOD.ACTIVE_CONVERSATION,params:{conversationID:n}}),df.getChatType()===nt.TUIChat.TYPE.ROOM&&!0===df.getFeatureConfig(nt.TUIChat.FEATURE.InputVoice))return df.setTheme("light"),void(l.value="");df.getChatType()===nt.TUIChat.TYPE.GROUP&&(h.value=_t.getExtensionList(nt.TUIChat.EXTENSION.CHAT_HEADER.EXT_ID)),mp.update(tu.CUSTOM,"activeConversation",n),l.value=n}return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"chat"},[e.createElementVNode("div",{class:e.normalizeClass(["tui-chat",!e.unref(Zp)&&"tui-chat-h5"])},[e.unref(l)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-chat-default",!e.unref(Zp)&&"tui-chat-h5-default"])},[e.renderSlot(t.$slots,"default",{},void 0,!0)],2)),e.unref(l)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["tui-chat",!e.unref(Zp)&&"tui-chat-h5"])},[e.createVNode(ch,{class:e.normalizeClass(["tui-chat-header",!e.unref(Zp)&&"tui-chat-H5-header",e.unref(eh)&&"tui-chat-uniapp-header"]),isGroup:e.unref(i),headerExtensionList:e.unref(h),onCloseChat:_,onOpenGroupManagement:C},null,8,["class","isGroup","headerExtensionList"]),e.createVNode(h_,{onToggleMultipleSelectMode:T}),e.createVNode(Zv,{ref_key:"messageListRef",ref:p,class:e.normalizeClass(["tui-chat-message-list",!e.unref(Zp)&&"tui-chat-h5-message-list"]),isGroup:e.unref(i),groupID:e.unref(a),isNotInGroup:e.unref(r),isMultipleSelectMode:e.unref(c),onHandleEditor:I,onCloseInputToolBar:n[0]||(n[0]=()=>k("none")),onToggleMultipleSelectMode:T},null,8,["class","isGroup","groupID","isNotInGroup","isMultipleSelectMode"]),e.unref(r)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"tui-chat-leave-group":!0,"tui-chat-leave-group-mobile":e.unref(th)})},e.toDisplayString(e.unref(m)),3)):e.unref(c)?(e.openBlock(),e.createBlock(c_,{key:1,onOneByOneForwardMessage:M,onMergeForwardMessage:S,onToggleMultipleSelectMode:T})):(e.openBlock(),e.createElementBlock(e.Fragment,{key:2},[e.unref(g)?(e.openBlock(),e.createBlock(w_,{key:0,class:e.normalizeClass(["tui-chat-message-input-toolbar",!e.unref(Zp)&&"tui-chat-h5-message-input-toolbar",e.unref(eh)&&"tui-chat-uni-message-input-toolbar"]),displayType:e.unref(u),onInsertEmoji:y,onChangeToolbarDisplayType:k,onScrollToLatestMessage:E},null,8,["class","displayType"])):e.createCommentVNode("",!0),e.createVNode(l_,{ref_key:"messageInputRef",ref:d,class:e.normalizeClass(["tui-chat-message-input",!e.unref(Zp)&&"tui-chat-h5-message-input",e.unref(eh)&&"tui-chat-uni-message-input",e.unref(Xp)&&"tui-chat-wx-message-input"]),enableAt:e.unref(f).InputMention,isMuted:!1,muteText:e.unref(vp).t("TUIChat.您已被管理员禁言"),placeholder:e.unref(vp).t("TUIChat.请输入消息"),inputToolbarDisplayType:e.unref(u),onChangeToolbarDisplayType:k},null,8,["class","enableAt","muteText","placeholder","inputToolbarDisplayType"])],64))],2)):e.createCommentVNode("",!0),!e.unref(r)&&!e.unref(Qp)&&e.unref(eh)&&e.unref(i)&&e.unref(h).length>0?(e.openBlock(),e.createElementBlock("div",{key:2,class:"group-profile",onClick:C},e.toDisplayString(e.unref(h)[0].text),1)):e.createCommentVNode("",!0)],2)]))}}),[["__scopeId","data-v-1a34cdd3"]]);new class{constructor(){this.currentConversationID="",this.currentMessageList=[],_t.registerService(nt.TUIChat.SERVICE.NAME,this),_t.registerEvent(nt.TUITheme.EVENT.THEME_CHANGED,nt.TUITheme.EVENT_SUB_KEY.CHANGE_SUCCESS,this),_t.registerEvent(nt.TUIChat.EVENT.CHAT_TYPE_CHANGED,nt.TUIChat.EVENT_SUB_KEY.CHANGE_SUCCESS,this),mp.watch(tu.CONV,{currentConversationID:e=>{this.currentConversationID=e}})}onCall(e,t,n){let o;switch(e){case nt.TUIChat.SERVICE.METHOD.UPDATE_MESSAGE_LIST:o=t.message,(null==o?void 0:o.conversationID)===this.currentConversationID&&Ip.updateMessageList([o],"push");break;case nt.TUIChat.SERVICE.METHOD.SEND_CUSTOM_MESSAGE:Ip.sendCustomMessage(t).then((e=>{n&&n(e)}));break;case nt.TUIChat.SERVICE.METHOD.SEND_TEXT_MESSAGE:Ip.sendTextMessage(t).then((e=>{n&&n(e)}));break;case nt.TUIChat.SERVICE.METHOD.SET_CHAT_TYPE:df.setChatType(null==t?void 0:t.chatType);break;case nt.TUIChat.SERVICE.METHOD.CLOSE_MESSAGE_POP_MENU:mp.update(tu.CUSTOM,"isShowMessagePopMenu",!1);break;case nt.TUIChat.SERVICE.METHOD.UPDATE_MESSAGE_INFO:Ip.updateMessageInfo(null==t?void 0:t.userInfo)}}onNotifyEvent(e,t,n){if(e===nt.TUITheme.EVENT.THEME_CHANGED&&t===nt.TUITheme.EVENT_SUB_KEY.CHANGE_SUCCESS)(null==n?void 0:n.theme)&&df.setTheme(n.theme.toLowerCase());if(e===nt.TUIChat.EVENT.CHAT_TYPE_CHANGED&&t===nt.TUIChat.EVENT_SUB_KEY.CHANGE_SUCCESS)(null==n?void 0:n.chatType)&&df.setChatType(null==n?void 0:n.chatType)}};const D_="/assets/search.dabca596.svg",N_="/assets/input-close.3bf506b7.svg",R_=ee(e.defineComponent({__name:"index",props:{placeholder:{type:String,default:()=>vp.t("TUISearch.搜索")},searchType:{type:String,default:"global",validator:e=>["global","conversation"].includes(e)}},setup(t){const n=t,o=e.ref(""),a=e.ref(""),i=e.ref(!1);function r(e){(null==e?void 0:e.searchType)===(null==n?void 0:n.searchType)&&(a.value=null==e?void 0:e.value,o.value=null==e?void 0:e.value)}function s(e){(null==e?void 0:e.searchType)===(null==n?void 0:n.searchType)&&(i.value=null==e?void 0:e.isSearching)}e.onMounted((()=>{mp.watch(tu.SEARCH,{currentSearchInputValue:r,currentSearchingStatus:s})})),e.onUnmounted((()=>{mp.unwatch(tu.SEARCH,{currentSearchInputValue:r,currentSearchingStatus:s})}));const l=()=>{o.value!==a.value&&mp.update(tu.SEARCH,"currentSearchInputValue",{value:o.value,searchType:n.searchType})},c=()=>{i.value=!1,mp.update(tu.SEARCH,"currentSearchingStatus",{isSearching:!1,searchType:n.searchType}),mp.update(tu.SEARCH,"currentSearchInputValue",{value:"",searchType:n.searchType})},u=()=>{mp.update(tu.SEARCH,"currentSearchingStatus",{isSearching:!0,searchType:n.searchType})},d=()=>{var e;null==(e=null==bp?void 0:bp.hideKeyboard)||e.call(bp)};return(t,a)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["tui-search-input-container",!e.unref(Zp)&&"tui-search-input-container-h5","global"===n.searchType?"tui-search-input-container-global":"tui-search-input-container-conversation"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-search-input",!e.unref(Zp)&&"tui-search-input-h5"])},[e.createElementVNode("div",{class:"tui-search-input-left"},[e.createVNode(fh,{class:"icon",file:e.unref(D_),width:"14px",height:"14px"},null,8,["file"])]),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":a[0]||(a[0]=t=>e.isRef(o)?o.value=t:null),class:"tui-search-input-main",type:"text",placeholder:n.placeholder,focus:!1,enterkeyhint:"search",onBlur:d,onKeyup:e.withKeys(l,["enter"]),onConfirm:l,onClick:e.withModifiers(u,["stop","prevent"])},null,40,["placeholder"]),[[e.vModelText,e.unref(o)]]),e.unref(i)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-search-input-right",onClick:c},[e.createVNode(fh,{class:"icon",file:e.unref(N_),width:"14px",height:"14px"},null,8,["file"])])):e.createCommentVNode("",!0)],2),!e.unref(Zp)&&e.unref(i)&&"global"===n.searchType?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-search-input-cancel",!e.unref(Zp)&&"tui-search-input-h5-cancel"]),onClick:c},e.toDisplayString(e.unref(vp).t("TUISearch.取消")),3)):e.createCommentVNode("",!0)],2))}}),[["__scopeId","data-v-d6cac102"]]),L_={allMessage:{key:"allMessage",label:"全部",value:[gp.TYPES.MSG_TEXT,gp.TYPES.MSG_FILE,gp.TYPES.MSG_IMAGE,gp.TYPES.MSG_VIDEO,gp.TYPES.MSG_AUDIO,gp.TYPES.MSG_LOCATION,gp.TYPES.MSG_CUSTOM,gp.TYPES.MSG_MERGER]},textMessage:{key:"textMessage",label:"文本",value:[gp.TYPES.MSG_TEXT]},fileMessage:{key:"fileMessage",label:"文件",value:[gp.TYPES.MSG_FILE]},imageMessage:{key:"imageMessage",label:"图片/视频",value:[gp.TYPES.MSG_IMAGE,gp.TYPES.MSG_VIDEO]},otherMessage:{key:"otherMessage",label:"其他",value:[gp.TYPES.MSG_AUDIO,gp.TYPES.MSG_LOCATION,gp.TYPES.MSG_CUSTOM,gp.TYPES.MSG_MERGER]}};Object.keys(L_).filter((e=>"all"!==e));const A_={global:L_.allMessage,conversation:L_.textMessage},O_=["allMessage","textMessage","fileMessage","otherMessage"],P_=Object.keys(L_).filter((e=>null==O_?void 0:O_.includes(e))).reduce(((e,t)=>(e[t]=L_[t],e)),{}),U_=["textMessage","fileMessage","imageMessage","otherMessage"],x_=Object.keys(L_).filter((e=>null==U_?void 0:U_.includes(e))).reduce(((e,t)=>(e[t]=L_[t],e)),{}),V_=86400,B_={all:{key:"all",label:"全部",value:{timePosition:0,timePeriod:0}},oneDay:{key:"today",label:"今天",value:{timePosition:0,timePeriod:V_}},threeDay:{key:"threeDays",label:"近三天",value:{timePosition:0,timePeriod:259200}},sevenDay:{key:"sevenDays",label:"近七天",value:{timePosition:0,timePeriod:604800}}},G_=B_.all;var F_={exports:{}};!function(e){e.exports=function(e,t,n){var o=t.prototype,a=function(e){return e&&(e.indexOf?e:e.s)},i=function(e,t,n,o,i){var r=e.name?e:e.$locale(),s=a(r[t]),l=a(r[n]),c=s||l.map((function(e){return e.slice(0,o)}));if(!i)return c;var u=r.weekStart;return c.map((function(e,t){return c[(t+(u||0))%7]}))},r=function(){return n.Ls[n.locale()]},s=function(e,t){return e.formats[t]||e.formats[t.toUpperCase()].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,(function(e,t,n){return t||n.slice(1)}))},l=function(){var e=this;return{months:function(t){return t?t.format("MMMM"):i(e,"months")},monthsShort:function(t){return t?t.format("MMM"):i(e,"monthsShort","months",3)},firstDayOfWeek:function(){return e.$locale().weekStart||0},weekdays:function(t){return t?t.format("dddd"):i(e,"weekdays")},weekdaysMin:function(t){return t?t.format("dd"):i(e,"weekdaysMin","weekdays",2)},weekdaysShort:function(t){return t?t.format("ddd"):i(e,"weekdaysShort","weekdays",3)},longDateFormat:function(t){return s(e.$locale(),t)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};o.localeData=function(){return l.bind(this)()},n.localeData=function(){var e=r();return{firstDayOfWeek:function(){return e.weekStart||0},weekdays:function(){return n.weekdays()},weekdaysShort:function(){return n.weekdaysShort()},weekdaysMin:function(){return n.weekdaysMin()},months:function(){return n.months()},monthsShort:function(){return n.monthsShort()},longDateFormat:function(t){return s(e,t)},meridiem:e.meridiem,ordinal:e.ordinal}},n.months=function(){return i(r(),"months")},n.monthsShort=function(){return i(r(),"monthsShort","months",3)},n.weekdays=function(e){return i(r(),"weekdays",null,null,e)},n.weekdaysShort=function(e){return i(r(),"weekdaysShort","weekdays",3,e)},n.weekdaysMin=function(e){return i(r(),"weekdaysMin","weekdays",2,e)}}}(F_);const z_=He(F_.exports);var H_={exports:{}};!function(e){e.exports=function(e,t){t.prototype.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)}}}(H_);const j_=He(H_.exports);var q_={exports:{}};!function(e){e.exports=function(e,t){t.prototype.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)}}}(q_);const K_=He(q_.exports);!function(e){e.exports=function(e){function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var n=t(e),o={name:"zh-cn",weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),ordinal:function(e,t){return"W"===t?e+"周":e+"日"},weekStart:1,yearStart:4,formats:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY/MM/DD",LL:"YYYY年M月D日",LLL:"YYYY年M月D日Ah点mm分",LLLL:"YYYY年M月D日ddddAh点mm分",l:"YYYY/M/D",ll:"YYYY年M月D日",lll:"YYYY年M月D日 HH:mm",llll:"YYYY年M月D日dddd HH:mm"},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},meridiem:function(e,t){var n=100*e+t;return n<600?"凌晨":n<900?"早上":n<1100?"上午":n<1300?"中午":n<1800?"下午":"晚上"}};return n.default.locale(o,null,!0),o}(ta)}({exports:{}});const Y_=ee(e.defineComponent({__name:"date-table",props:{type:{type:String,default:"range"},currentPanelDate:{type:ta.Dayjs,default:()=>na()},date:{type:ta.Dayjs,default:null},startDate:{type:ta.Dayjs,default:null},endDate:{type:ta.Dayjs,default:null}},emits:["pick"],setup(t,{emit:n}){const o=t,a=n,i=e.getCurrentInstance(),r=e.ref([[],[],[],[],[],[]]),s=e.ref(na(o.currentPanelDate||null)),l=e.ref(na(o.date||null)),c=e.ref(na(o.startDate||null)),u=e.ref(na(o.endDate||null)),d=e.computed((()=>na.weekdaysShort())),p=e.computed((()=>d.value.map((e=>e.substring(1))))),h=e.computed((()=>{var e;const t=null==(e=s.value)?void 0:e.startOf("month");return null==t?void 0:t.subtract((null==t?void 0:t.day())||7,"day")})),f=e.computed((()=>{var e,t,n,a,i;const d=r.value,f=p.value.length,g=null==(e=s.value)?void 0:e.startOf("month"),m=(null==g?void 0:g.day())||7,v=null==g?void 0:g.daysInMonth();let _=1;for(let s=0;s<r.value.length;s++)for(let e=0;e<f;e++){const r=null==(t=h.value)?void 0:t.add(_,"day"),p=null==r?void 0:r.date(),f="single"===o.type&&(null==r?void 0:r.format("YYYY-MM-DD"))===(null==(n=l.value)?void 0:n.format("YYYY-MM-DD")),g="range"===o.type&&(null==r?void 0:r.format("YYYY-MM-DD"))===(null==(a=c.value)?void 0:a.format("YYYY-MM-DD")),y="range"===o.type&&(null==r?void 0:r.format("YYYY-MM-DD"))===(null==(i=u.value)?void 0:i.format("YYYY-MM-DD")),I=(null==r?void 0:r.isSameOrBefore(u.value,"day"))&&(null==r?void 0:r.isSameOrAfter(c.value,"day"));let C="normal";_<m?C="prev-month":_-m>=v&&(C="next-month"),d[s][e]={type:C,date:r,text:p,isSelected:f||g||y,isSelectedStart:g,isSelectedEnd:y,isInRange:I},_++}return d}));return e.watch((()=>[o.currentPanelDate,o.date,o.startDate,o.endDate]),(()=>{s.value=na(o.currentPanelDate||null),l.value=na(o.date||null),c.value=na(o.startDate||null),u.value=na(o.endDate||null),e.nextTick((()=>{var e;null==(e=null==i?void 0:i.proxy)||e.$forceUpdate()}))}),{deep:!0,immediate:!0}),(t,n)=>(e.openBlock(),e.createElementBlock("table",{class:e.normalizeClass(["tui-date-table",!e.unref(Zp)&&"tui-date-table-h5"]),cellspacing:"0",cellpadding:"0",role:"grid"},[e.createElementVNode("tbody",{class:"tui-date-table-body"},[e.createElementVNode("tr",{class:"tui-date-table-body-weeks"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(p),(t=>(e.openBlock(),e.createElementBlock("th",{key:t,class:"tui-date-table-body-weeks-item","aria-label":t+"",scope:"col"},e.toDisplayString(e.unref(vp).t(`time.${t}`)),9,["aria-label"])))),128))]),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(f),((t,n)=>(e.openBlock(),e.createElementBlock("tr",{key:n,class:"tui-date-table-body-days"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t,((t,n)=>(e.openBlock(),e.createElementBlock("td",{key:n,class:e.normalizeClass(["tui-date-table-body-days-item",t.type])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-date-table-body-days-item-cell",t.isSelected&&"selected",t.isSelectedStart&&"selected-start",t.isSelectedEnd&&"selected-end",t.isInRange&&"range"]),onClick:e=>{var n;"normal"===(null==(n=t)?void 0:n.type)&&a("pick",n)}},[e.createElementVNode("span",{class:"tui-date-table-body-days-item-cell-text"},e.toDisplayString(t.text),1)],10,["onClick"])],2)))),128))])))),128))])],2))}}),[["__scopeId","data-v-8338dd58"]]),$_=ee(e.defineComponent({__name:"date-picker-panel",props:{type:{type:String,default:"range"},date:{type:ta.Dayjs,default:()=>na()},startDate:{type:ta.Dayjs,default:null},endDate:{type:ta.Dayjs,default:null},rangeType:{type:String,default:""},currentOtherPanelValue:{type:ta.Dayjs,default:null}},emits:["pick","change"],setup(t,{emit:n}){const o=t,a=n,i=e=>e?["tui-date-picker-panel-"+e,!Zp&&"tui-date-picker-panel-h5-"+e]:["tui-date-picker-panel",!Zp&&"tui-date-picker-panel-h5"],r=e.ref(),s=e.computed((()=>{var e;return null==(e=r.value)?void 0:e.get("year")})),l=e.computed((()=>{var e;return null==(e=r.value)?void 0:e.format("MMMM")})),c=e.computed((()=>{var e,t,n;const a=(null==(e=o.currentOtherPanelValue)?void 0:e.year())-1,i=null==(t=o.currentOtherPanelValue)?void 0:t.year(a);return"right"===o.rangeType||(null==(n=r.value)?void 0:n.isBefore(i,"year"))})),u=e.computed((()=>{var e,t,n;const a=(null==(e=o.currentOtherPanelValue)?void 0:e.month())-1,i=null==(t=o.currentOtherPanelValue)?void 0:t.month(a);return"right"===o.rangeType||(null==(n=r.value)?void 0:n.isBefore(i,"month"))})),d=e.computed((()=>{var e,t,n;const a=(null==(e=o.currentOtherPanelValue)?void 0:e.year())+1,i=null==(t=o.currentOtherPanelValue)?void 0:t.year(a);return"left"===o.rangeType||(null==(n=r.value)?void 0:n.isAfter(i,"year"))})),p=e.computed((()=>{var e,t,n;const a=(null==(e=o.currentOtherPanelValue)?void 0:e.month())+1,i=null==(t=o.currentOtherPanelValue)?void 0:t.month(a);return"left"===o.rangeType||(null==(n=r.value)?void 0:n.isAfter(i,"month"))}));function h(e){a("pick",e)}function f(e,t){r.value=na(r.value.toDate()).add(t,e),a("change",r.value)}return e.onBeforeMount((()=>{switch(o.type){case"single":r.value=(o.date&&(null==(e=na(o.date))?void 0:e.isValid())?{date:null==o?void 0:o.date}:{date:na()}).date,a("change",r.value);break;case"range":r.value=(()=>{var e;switch(o.rangeType){case"left":return o.startDate&&na.isDayjs(o.startDate)?{date:null==o?void 0:o.startDate}:{date:na()};case"right":if(o.endDate&&na.isDayjs(o.endDate)&&(null==(e=null==o?void 0:o.endDate)?void 0:e.isAfter(o.startDate,"month")))return{date:null==o?void 0:o.endDate};{const e=(o.startDate||na()).month();return{date:(o.startDate||na()).month(e+1)}}default:return{date:na()}}})().date,a("change",r.value)}var e})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([i("")]),onMouseup:n[4]||(n[4]=e.withModifiers((()=>{}),["stop"]))},[e.createElementVNode("div",{class:e.normalizeClass([i("body")])},[e.createElementVNode("div",{class:e.normalizeClass([i("body-header")])},[e.createElementVNode("div",{class:e.normalizeClass([i("body-header-prev")])},[e.unref(d)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass([i("icon")]),onClick:n[0]||(n[0]=e=>f("year",-1))},[e.createVNode(fh,{file:e.unref("/assets/d-left-arrow.d3dcfc22.svg"),width:"12px",height:"12px"},null,8,["file"])],2)):e.createCommentVNode("",!0),e.unref(p)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass([i("icon")]),onClick:n[1]||(n[1]=e=>f("month",-1))},[e.createVNode(fh,{file:e.unref("/assets/left-arrow.dce2f352.svg"),width:"10px",height:"10px"},null,8,["file"])],2)):e.createCommentVNode("",!0)],2),e.createElementVNode("div",{class:e.normalizeClass([i("body-header-label")])},[e.createElementVNode("div",{class:e.normalizeClass([i("body-header-label-item")])},e.toDisplayString(e.unref(s)),3),e.createElementVNode("div",{class:e.normalizeClass([i("body-header-label-item")])},e.toDisplayString(e.unref(vp).t(`time.${e.unref(l)}`)),3)],2),e.createElementVNode("div",{class:e.normalizeClass([i("body-header-next")])},[e.unref(u)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass([i("icon")]),onClick:n[2]||(n[2]=e=>f("month",1))},[e.createVNode(fh,{file:e.unref("/assets/right-arrow.0091db6c.svg"),width:"10px",height:"10px"},null,8,["file"])],2)):e.createCommentVNode("",!0),e.unref(c)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass([i("icon")]),onClick:n[3]||(n[3]=e=>f("year",1))},[e.createVNode(fh,{file:e.unref("/assets/d-right-arrow.2202133f.svg"),width:"12px",height:"12px"},null,8,["file"])],2)):e.createCommentVNode("",!0)],2)],2),e.createElementVNode("div",{class:e.normalizeClass([i("body-content")])},[e.createVNode(Y_,{type:o.type,date:o.date,startDate:o.startDate,endDate:o.endDate,currentPanelDate:e.unref(r),onPick:h},null,8,["type","date","startDate","endDate","currentPanelDate"])],2)],2)],34))}}),[["__scopeId","data-v-cf4d1290"]]),W_=ee(e.defineComponent({__name:"index",props:{type:{type:String,default:"range"},rangeTableType:{type:String,default:"one"},startPlaceholder:{type:String,default:()=>vp.t("开始时间")},endPlaceholder:{type:String,default:()=>vp.t("开始时间")},popupPosition:{type:String,default:"bottom"},defaultSingleDate:{type:ta.Dayjs,default:null,required:!1}},emits:["pick","change"],setup(t,{emit:n}){na.extend(z_),na.extend(j_),na.extend(K_),na.locale("zh-cn");const o=n,a=t,i=e.ref(!1),r=e.ref("single"===a.type?null==a?void 0:a.defaultSingleDate:null),s=e.ref("single"===a.type?null==a?void 0:a.defaultSingleDate:null),l=e.ref("single"===a.type?null==a?void 0:a.defaultSingleDate:null),c=e.computed((()=>{var e;return null==(e=null==s?void 0:s.value)?void 0:e.format("YYYY/MM/DD")})),u=e.computed((()=>{var e;return null==(e=null==l?void 0:l.value)?void 0:e.format("YYYY/MM/DD")})),d=a.startPlaceholder,p=a.endPlaceholder,h=e.ref(),f=e.ref(),g=e=>{i.value=e},m=e=>{const t=[];return e.forEach((e=>{e?(t.push("tui-date-picker-"+e),!Zp&&t.push("tui-date-picker-h5-"+e)):(t.push("tui-date-picker"),!Zp&&t.push("tui-date-picker-h5"))})),t},v=e=>{var t,n,i;switch(a.type){case"single":s.value=e.date,l.value=e.date,r.value=e.date,o("change",e),o("pick",r.value),setTimeout((()=>{g(!1)}),300);break;case"range":(null==s?void 0:s.value)?(null==l?void 0:l.value)?(s.value=e.date,l.value=null):((null==(t=null==s?void 0:s.value)?void 0:t.isSameOrBefore(e.date,"day"))?l.value=e.date:(l.value=s.value,s.value=e.date),o("pick",{startDate:null==(n=null==s?void 0:s.value)?void 0:n.startOf("date"),endDate:null==(i=null==l?void 0:l.value)?void 0:i.endOf("date")}),setTimeout((()=>{g(!1)}),200)):s.value=e.date,o("change",{startDate:s.value,endDate:l.value,leftCurrentPanel:h.value,rightCurrentPanel:h.value})}},_=e=>{h.value=e,o("change",{startDate:s.value,endDate:l.value,leftCurrentPanel:h.value,rightCurrentPanel:h.value})},y=e=>{f.value=e,o("change",{startDate:s.value,endDate:l.value,leftCurrentPanel:h.value,rightCurrentPanel:h.value})};return(n,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([m([""])])},[e.createElementVNode("div",{class:e.normalizeClass([m(["input"]),e.unref(i)&&m(["input-active"])]),onClick:o[2]||(o[2]=t=>g(!e.unref(i)))},[e.renderSlot(n.$slots,"start-icon",{},void 0,!0),e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>e.isRef(c)?c.value=t:null),placeholder:e.unref(d),class:e.normalizeClass([m(["input-start"])]),style:{"pointer-events":"none"},type:"text",readonly:!0,disabled:e.unref(eh),autocomplete:"false"},null,10,["placeholder","disabled"]),[[e.vModelText,e.unref(c)]]),"single"!==t.type?(e.openBlock(),e.createElementBlock("span",{key:0},"-")):e.createCommentVNode("",!0),"single"!==t.type?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:1,"onUpdate:modelValue":o[1]||(o[1]=t=>e.isRef(u)?u.value=t:null),placeholder:e.unref(p),class:e.normalizeClass([m(["input-end"])]),style:{"pointer-events":"none"},type:"text",readonly:!0,disabled:e.unref(eh),autocomplete:"false"},null,10,["placeholder","disabled"])),[[e.vModelText,e.unref(u)]]):e.createCommentVNode("",!0),e.renderSlot(n.$slots,"end-icon",{},void 0,!0)],2),e.unref(i)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass([m(["dialog"])])},[e.createElementVNode("div",{class:e.normalizeClass([m(["dialog-container","dialog-container-"+t.rangeTableType,"dialog-container-"+t.popupPosition])])},[e.createVNode($_,{type:a.type,rangeType:"left",date:e.unref(r),startDate:e.unref(s),endDate:e.unref(l),currentOtherPanelValue:e.unref(f),onPick:v,onChange:_},null,8,["type","date","startDate","endDate","currentOtherPanelValue"]),"range"===a.type&&e.unref(Zp)&&"two"===t.rangeTableType?(e.openBlock(),e.createBlock($_,{key:0,type:a.type,rangeType:"right",date:e.unref(r),startDate:e.unref(s),endDate:e.unref(l),currentOtherPanelValue:e.unref(h),onPick:v,onChange:y},null,8,["type","date","startDate","endDate","currentOtherPanelValue"])):e.createCommentVNode("",!0)],2)],2)):e.createCommentVNode("",!0)],2))}}),[["__scopeId","data-v-c42974d8"]]),Z_="/assets/down-icon.fbb4047c.svg",J_=ee(e.defineComponent({__name:"index",props:{popupPosition:{type:String,default:"bottom"},searchType:{type:String,default:"global",validator:e=>["global","conversation"].includes(e)}},emits:["searchConfigChange","closeInConversationSearch"],setup(t,{emit:n}){const o=t,a=n,i=e.computed((()=>"conversation"===(null==o?void 0:o.searchType)?x_:P_)),r=e.ref(A_[null==o?void 0:o.searchType]),s=e.ref(G_),l=e.computed((()=>"contact"!==r.value.key&&"group"!==r.value.key)),c=e.computed((()=>Zp&&"global"===o.searchType&&!eh?"two":"one")),u=e.ref(!1);function d(e){(null==e?void 0:e.searchType)===(null==o?void 0:o.searchType)&&(r.value=(null==e?void 0:e.value)||A_[null==o?void 0:o.searchType])}function p(e){(null==e?void 0:e.searchType)===(null==o?void 0:o.searchType)&&(s.value=(null==e?void 0:e.value)||G_)}e.onMounted((()=>{mp.watch(tu.SEARCH,{currentSearchMessageType:d,currentSearchMessageTime:p})})),e.onUnmounted((()=>{mp.unwatch(tu.SEARCH,{currentSearchMessageType:d,currentSearchMessageTime:p})}));const h=()=>{var e;"all"!==(null==(e=s.value)?void 0:e.key)?mp.update(tu.SEARCH,"currentSearchMessageTime",{value:G_,searchType:o.searchType}):u.value=!0},f=e=>{var t,n,a;if("all"===(null==(t=s.value)?void 0:t.key)){const{startDate:t,endDate:i}=e,r=Number(((null==(n=null==i?void 0:i.toDate())?void 0:n.getTime())/1e3).toFixed(0)),l=r-Number(((null==(a=null==t?void 0:t.toDate())?void 0:a.getTime())/1e3).toFixed(0)),c={key:s.value.key,label:s.value.label,value:{timePosition:r,timePeriod:l}};mp.update(tu.SEARCH,"currentSearchMessageTime",{value:c,searchType:o.searchType})}},g=()=>{var e;u.value=!1,"all"===(null==(e=s.value)?void 0:e.key)&&mp.update(tu.SEARCH,"currentSearchMessageTime",{value:G_,searchType:o.searchType})},m=()=>{a("closeInConversationSearch")};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["tui-search-container",!e.unref(Zp)&&"tui-search-container-h5",e.unref(Zp)&&`container-${o.popupPosition}`,`container-${o.searchType}`])},[e.createElementVNode("div",{class:e.normalizeClass([e.unref(Zp)&&`tui-search-container-${o.popupPosition}`,!e.unref(Zp)&&"tui-search-container-h5-main"])},["conversation"!==o.searchType||e.unref(eh)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-search-header"},[e.createElementVNode("div",{class:"tui-search-header-title"},e.toDisplayString(e.unref(vp).t("TUISearch.搜索会话内容")),1),e.createElementVNode("div",{class:"tui-search-header-close",onClick:m},[e.createVNode(fh,{file:e.unref(Kh),width:"14px",height:"14px"},null,8,["file"])])])),e.createElementVNode("div",{class:"tui-search-tabs"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(["tui-search-tabs-item",e.unref(r).key===t.key&&"tui-search-tabs-item-selected"]),onClick:e=>{return n=t,void mp.update(tu.SEARCH,"currentSearchMessageType",{value:n,searchType:o.searchType});var n}},e.toDisplayString(e.unref(vp).t(`TUISearch.${t.label}`)),11,["onClick"])))),128))]),e.renderSlot(t.$slots,"input",{},void 0,!0),e.unref(l)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"tui-search-time"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(B_),((t,a)=>(e.openBlock(),e.createElementBlock("div",{key:a,class:e.normalizeClass(["tui-search-time-item",e.unref(s).key===t.key&&"tui-search-time-item-selected"]),onClick:e=>{return n=t,void(u.value&&"all"===n.key?u.value=!1:(u.value=!1,mp.update(tu.SEARCH,"currentSearchMessageTime",{value:n,searchType:o.searchType})));var n}},["all"===t.key?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-search-time-item-picker"},[e.unref(u)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-search-time-item-all",onClick:e.withModifiers(h,["stop"])},[e.createTextVNode(e.toDisplayString(e.unref(vp).t("TUISearch.选择时间")+":  "+e.unref(vp).t("TUISearch.全部"))+" ",1),e.createVNode(fh,{file:e.unref(Z_),width:"14px",height:"14px"},null,8,["file"])])),e.createElementVNode("div",{onClick:n[0]||(n[0]=e.withModifiers((()=>{}),["stop"]))},[e.unref(u)?(e.openBlock(),e.createBlock(W_,{key:0,type:"range",rangeTableType:e.unref(c),onPick:f},null,8,["rangeTableType"])):e.createCommentVNode("",!0)]),e.unref(u)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"tui-search-time-item-close",onClick:g},[e.createVNode(fh,{class:"icon",file:e.unref(N_),width:"14px",height:"14px"},null,8,["file"])])):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("div",{key:1},e.toDisplayString(e.unref(vp).t(`TUISearch.${t.label}`)),1))],10,["onClick"])))),128))])):e.createCommentVNode("",!0),e.renderSlot(t.$slots,"result",{},void 0,!0)],2)],2))}}),[["__scopeId","data-v-327f0dd2"]]),X_=ee(e.defineComponent({__name:"message-abstract-text",props:{content:{default:()=>[]},highlightType:{default:"font"},displayType:{default:"info"}},setup(t){const n=t,o=e.ref(n.content);return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-abstract-text",`message-abstract-text-${t.highlightType}`,`message-abstract-text-${t.displayType}`])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n,class:e.normalizeClass([t&&t.isHighlight?"highlight":"normal"])},e.toDisplayString(e.unref(Fh)(t.text)),3)))),128))],2))}}),[["__scopeId","data-v-274990bd"]]),Q_=ee(e.defineComponent({__name:"message-abstract-file",props:{contentText:{default:()=>[]},messageContent:{default:()=>({})},displayType:{default:"bubble"}},setup(t){const n=t,o=e.ref(n.contentText),a=e.computed((()=>{var e;const t=null==(e=null==n?void 0:n.messageContent)?void 0:e.url,o=null==t?void 0:t.lastIndexOf("."),a=null==t?void 0:t.substring(o+1);return r(a)})),i=e.computed((()=>{var e;return null==(e=null==n?void 0:n.messageContent)?void 0:e.size})),r=e=>{const t="https://web.sdk.qcloud.com/component/TUIKit/assets/file-",n=["image","pdf","text","ppt","presentation","sheet","zip","word","video","unknown"];let o="",a="";return null==n||n.forEach((n=>{(null==e?void 0:e.includes(n))&&(o=t+n+".svg",a=n)})),{iconSrc:o||t+"unknown.svg",iconType:a||"unknown"}};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-abstract-file",`message-abstract-file-${t.displayType}`])},[e.createElementVNode("div",{class:e.normalizeClass(["message-abstract-file-left"])},[e.createElementVNode("img",{class:e.normalizeClass(["message-abstract-file-left-icon"]),src:e.unref(a).iconSrc},null,8,["src"])]),e.createElementVNode("div",{class:e.normalizeClass(["message-abstract-file-main"])},[e.createElementVNode("div",{class:e.normalizeClass(["message-abstract-file-main-name"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n,class:e.normalizeClass([t&&t.isHighlight?"highlight":"normal"])},e.toDisplayString(t.text),3)))),128))]),e.createElementVNode("div",{class:e.normalizeClass(["message-abstract-file-main-size"])},e.toDisplayString(e.unref(i)),1)])],2))}}),[["__scopeId","data-v-ec8ab332"]]),ey=ee(e.defineComponent({__name:"message-abstract-custom",props:{contentText:{default:()=>[]},message:{default:()=>({})},messageContent:{default:()=>({})}},setup(t){var n,o;const a=t,i=e.ref(null==(n=null==a?void 0:a.message)?void 0:n.payload),r=e.computed((()=>{var e,t;return(null==(e=null==i?void 0:i.value)?void 0:e.data)?Wp(i.value.data):null==(t=null==i?void 0:i.value)?void 0:t.data})),s=e.computed((()=>{var e;return null==(e=null==r?void 0:r.value)?void 0:e.businessID})),l=e.ref(null==a?void 0:a.contentText),c=e.ref((null==(o=null==a?void 0:a.messageContent)?void 0:o.custom)||"[自定义消息]");return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-abstract-custom"]),onClickCapture:n[0]||(n[0]=e.withModifiers((()=>{}),["stop"]))},[e.unref(s)===e.unref(Dh).SERVICE?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["service"])},[e.createElementVNode("h1",{class:e.normalizeClass(["service-header"])},[e.createElementVNode("label",{class:e.normalizeClass(["service-header-title"])},e.toDisplayString(e.unref(r).title),1),e.unref(r).hyperlinks_text?(e.openBlock(),e.createElementBlock("a",{key:0,class:e.normalizeClass(["service-header-link","link"]),href:e.unref(r).hyperlinks_text.value,target:"view_window"},e.toDisplayString(e.unref(r).hyperlinks_text.key),9,["href"])):e.createCommentVNode("",!0)]),e.unref(r).item&&e.unref(r).item.length>0?(e.openBlock(),e.createElementBlock("ul",{key:0,class:e.normalizeClass(["service-list"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r).item,((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:e.normalizeClass(["service-list-item"])},[e.unref($p)(t.value)?(e.openBlock(),e.createElementBlock("a",{key:0,class:e.normalizeClass(["service-list-item-link","link"]),href:t.value,target:"view_window"},e.toDisplayString(t.key),9,["href"])):(e.openBlock(),e.createElementBlock("p",{key:1,class:e.normalizeClass(["service-list-item-key"])},e.toDisplayString(t.key),1))])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["service-description","description"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n,class:e.normalizeClass([t&&t.isHighlight?"highlight":"normal"])},e.toDisplayString(t.text),3)))),128))])])):e.unref(s)===e.unref(Dh).EVALUATE?(e.openBlock(),e.createElementBlock("div",{key:1,class:"evaluate"},[e.createElementVNode("div",{class:e.normalizeClass(["evaluate-description","description"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n,class:e.normalizeClass([t&&t.isHighlight?"highlight":"normal"])},e.toDisplayString(t.text),3)))),128))]),e.unref(r).score?(e.openBlock(),e.createElementBlock("ul",{key:0,class:"evaluate-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(Math.max(e.unref(r).score,0),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"evaluate-list-item"},[e.createVNode(fh,{file:e.unref(sf),class:"file-icon"},null,8,["file"])])))),128))])):e.createCommentVNode("",!0),e.createElementVNode("article",null,e.toDisplayString(e.unref(r).comment),1)])):e.unref(s)===e.unref(Dh).ORDER?(e.openBlock(),e.createElementBlock("div",{key:2,class:"order"},[e.createElementVNode("img",{class:"order-image",src:e.unref(r).imageUrl,alt:""},null,8,["src"]),e.createElementVNode("main",{class:"order-main"},[e.createElementVNode("h1",{class:"order-main-title"},e.toDisplayString(e.unref(r).title),1),e.createElementVNode("div",{class:e.normalizeClass(["order-main-description","description"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(l),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n,class:e.normalizeClass([t&&t.isHighlight?"highlight":"normal"])},e.toDisplayString(t.text),3)))),128))]),e.createElementVNode("span",{class:"order-main-price"},e.toDisplayString(e.unref(r).price),1)])])):e.unref(s)===e.unref(Dh).LINK?(e.openBlock(),e.createElementBlock("div",{key:3,class:"text-link"},[e.createElementVNode("div",{class:e.normalizeClass(["text-link-description","description"])},[e.createElementVNode("p",null,e.toDisplayString(e.unref(r).text),1)]),e.createElementVNode("a",{class:e.normalizeClass(["link"]),href:e.unref(r).link,target:"view_window"},e.toDisplayString(e.unref(vp).t("message.custom.查看详情>>")),9,["href"])])):(e.openBlock(),e.createElementBlock("span",{key:4},e.toDisplayString(e.unref(c)),1))],32))}}),[["__scopeId","data-v-65681342"]]),ty=ee(e.defineComponent({__name:"message-abstract-image",props:{messageContent:{default:()=>({})}},setup(t){const n=t,o=e.computed((()=>n.messageContent.url||""));return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-abstract-image-container"])},[e.createElementVNode("img",{class:e.normalizeClass(["message-abstract-image"]),src:e.unref(o)},null,8,["src"])]))}}),[["__scopeId","data-v-39cdf574"]]),ny=ee(e.defineComponent({__name:"message-abstract-video",props:{messageContent:{default:()=>({})}},setup(t){const n=t,o=e.computed((()=>n.messageContent.snapshotUrl||n.messageContent.url));return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["message-abstract-video"])},[e.createElementVNode("div",{class:"message-abstract-video-box"},[e.createElementVNode("img",{src:e.unref(o),class:e.normalizeClass(["video-snapshot"])},null,8,["src"]),e.createVNode(fh,{file:e.unref(ph),class:"video-play"},null,8,["file"])])]))}}),[["__scopeId","data-v-c3634fb3"]]),oy={[gp.TYPES.MSG_TEXT]:"[文本]",[gp.TYPES.MSG_IMAGE]:"[图片]",[gp.TYPES.MSG_AUDIO]:"[语音]",[gp.TYPES.MSG_VIDEO]:"[视频]",[gp.TYPES.MSG_FILE]:"[文件]",[gp.TYPES.MSG_CUSTOM]:"[自定义消息]",[gp.TYPES.MSG_SYSTEM]:"[系统消息]",[gp.TYPES.MSG_MERGER]:"[合并消息]",[gp.TYPES.MSG_LOCATION]:"[位置消息]"},ay=e=>{const t=(null==e?void 0:e.conversationID)||((null==e?void 0:e.groupID)?`GROUP${null==e?void 0:e.groupID}`:`C2C${null==e?void 0:e.userID}`);_p.switchConversation(t).then((()=>{mp.update(tu.SEARCH,"currentSearchingStatus",{isSearching:!1,searchType:"global"}),mp.update(tu.SEARCH,"currentSearchInputValue",{value:"",searchType:"global"}),eh&&(null==bp||bp.navigateTo({url:"/TUIKit/components/TUIChat/index"}))})).catch((e=>{oe("warn","at TUIKit/components/TUISearch/utils.ts:110","switch conversation failed:",null==e?void 0:e.message),tf({message:vp.t("TUISearch.进入会话失败"),type:Qh,duration:1e3})}))},iy=(e,t)=>{var n;if(!e||!t||!t.length)return[{text:e||"",isHighlight:!1}];const o=[];for(let l=0;l<t.length;l++){const a=null==(n=t[l])?void 0:n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),i=new RegExp(a,"gi");let r;for(;null!==(r=i.exec(e));){const e=r.index,t=r.index+r[0].length-1;o.push([e,t])}}const a=[o[0]];if(o.length>1){o.sort(((e,t)=>e[0]-t[0]));for(let e=1;e<o.length;e++){const t=o[e],n=a[a.length-1];t[0]-1<=n[1]?n[1]=Math.max(n[1],t[1]):a.push(t)}}if(!a[0])return[{text:e,isHighlight:!1}];const i=[];let r=0;for(let l=0;l<a.length;l++){const t=e.substring(r,a[l][0]);t&&i.push({text:t,isHighlight:!1});const n=e.substring(a[l][0],a[l][1]+1);n&&i.push({text:n,isHighlight:!0}),r=a[l][1]+1}const s=e.substring(r);return s&&i.push({text:s,isHighlight:!1}),i},ry=e=>{const t=new Date(1e3*e);return`${t.getFullYear()}-${("0"+(t.getMonth()+1)).slice(-2)}-${("0"+t.getDate()).slice(-2)}`},sy=ee(e.defineComponent({__name:"index",props:{listItem:{default:()=>({})},listItemContent:{default:()=>({})},type:{default:"allMessage"},displayType:{default:"info"},keywordList:{default:()=>[]}},emits:["showResultDetail","navigateToChatPosition"],setup(t,{emit:n}){const o=t,a=n,i=e.ref(gp.TYPES),r=e.ref(""),s=e.ref(""),l=e.ref([]),c=e.ref(""),u=e.ref(!1);e.watchEffect((()=>{var e,t;r.value=(e=>{var t,n,o,a;return e?e.ID?e.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png":e.groupID?e.avatar||`https://web.sdk.qcloud.com/im/assets/images/${null==e?void 0:e.type}.svg`:e.userID?e.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png":(null==(t=null==e?void 0:e.conversation)?void 0:t.conversationID)?"function"==typeof e.conversation.getAvatar?null==(n=e.conversation)?void 0:n.getAvatar():null==(a=null==(o=mp.getConversationModel(e.conversation.conversationID))?void 0:o.getAvatar)?void 0:a.call(o):"":""})(o.listItem),s.value=((e,t)=>{var n,o,a;return e?e.ID?null==t?void 0:t.showName:e.groupID?e.name||e.groupID:e.userID?e.remark||e.nick||e.userID||"":(null==(n=e.conversation)?void 0:n.conversationID)?"function"==typeof e.conversation.getShowName?e.conversation.getShowName():(null==(a=null==(o=mp.getConversationModel(e.conversation.conversationID))?void 0:o.getShowName)?void 0:a.call(o))||e.conversation.conversationID:"":""})(o.listItem,null==o?void 0:o.listItemContent),l.value=((e,t,n,o=!0)=>{var a,i,r,s;if(null==e?void 0:e.groupID)return[{text:"groupID: ",isHighlight:!1},{text:e.groupID,isHighlight:!0}];if(null==e?void 0:e.userID)return[{text:"userID: ",isHighlight:!1},{text:e.userID,isHighlight:!0}];if((null==e?void 0:e.conversation)||(null==e?void 0:e.flow)){if(1===(null==e?void 0:e.messageCount)||(null==e?void 0:e.flow)){const t=(null==e?void 0:e.flow)?e:null==e?void 0:e.messageList[0],s=(null==(a=null==t?void 0:t.payload)?void 0:a.text)||(null==(i=null==t?void 0:t.payload)?void 0:i.fileName)||(null==(r=null==t?void 0:t.payload)?void 0:r.description),l=[];return(null==t?void 0:t.type)&&o&&t.type!==gp.TYPES.MSG_TEXT&&l.push({text:vp.t(`TUISearch.${oy[t.type]}`),isHighlight:!1}),l.push(...iy(s,n)),l}return[{text:`${null==e?void 0:e.messageCount}${vp.t("TUISearch.条相关")}${vp.t(`TUISearch.${"allMessage"===t?"结果":null==(s=L_[t])?void 0:s.label}`)}`,isHighlight:!1}]}return[]})(o.listItem,o.type,o.keywordList,"info"===(null==o?void 0:o.displayType)),c.value=(null==(e=o.listItem)?void 0:e.time)?(e=>{const t=(new Date).setHours(0,0,0,0),n=new Date((new Date).getFullYear(),0,1,0,0,0,0).getTime(),o=new Date(e),a=864e5,i=t-o.getTime();function r(e){return e<10?"0"+e:e.toString()}if(i<=0)return`${r(o.getHours())}:${r(o.getMinutes())}`;if(i<=a)return`${vp.t("time.昨天")} ${r(o.getHours())}:${r(o.getMinutes())}`;if(i<=5184e5){const e=["星期日","星期一","星期二","星期三","星期四","星期五","星期六"][o.getDay()];return`${vp.t("time."+e)} ${r(o.getHours())}:${r(o.getMinutes())}`}return o.getTime()>=n?`${o.getMonth()+1}/${o.getDate()} ${r(o.getHours())}:${r(o.getMinutes())}`:`${o.getFullYear()}/${o.getMonth()+1}/${o.getDate()} ${r(o.getHours())}:${r(o.getMinutes())}`})(1e3*(null==(t=o.listItem)?void 0:t.time)):""}));const d=()=>{var e;"contact"===o.type||"group"===o.type?ay(o.listItem):"info"!==o.displayType||(null==(e=o.listItem)?void 0:e.ID)?h():a("showResultDetail",!0,o.type,o.listItem)},p=e=>{u.value=e},h=()=>{a("navigateToChatPosition",o.listItem)};return(t,n)=>{return e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["search-result-list-item",!e.unref(Zp)&&"search-result-list-item-h5","search-result-list-item-"+t.displayType,e.unref(u)&&"hover-"+t.displayType]),onClick:d,onMouseenter:n[0]||(n[0]=e=>p(!0)),onMouseleave:n[1]||(n[1]=e=>p(!1))},["info"===t.displayType||"bubble"===t.displayType?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass([t.displayType])},[e.createElementVNode("div",{class:e.normalizeClass(t.displayType+"-left")},[e.createElementVNode("img",{class:e.normalizeClass(t.displayType+"-left-avatar"),src:e.unref(r)||"",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,10,["src"])],2),e.createElementVNode("div",{class:e.normalizeClass([t.displayType+"-main"])},[e.createElementVNode("div",{class:e.normalizeClass([t.displayType+"-main-name"])},e.toDisplayString(e.unref(s)),3),e.createElementVNode("div",{class:e.normalizeClass([t.displayType+"-main-content"])},["info"===t.displayType||t.listItem.type===e.unref(i).MSG_TEXT?(e.openBlock(),e.createBlock(X_,{key:0,content:e.unref(l),highlightType:"info"===t.displayType?"font":"background",displayType:t.displayType},null,8,["content","highlightType","displayType"])):t.listItem.type===e.unref(i).MSG_FILE?(e.openBlock(),e.createBlock(Q_,{key:1,contentText:e.unref(l),messageContent:t.listItemContent,displayType:t.displayType},null,8,["contentText","messageContent","displayType"])):t.listItem.type===e.unref(i).MSG_IMAGE?(e.openBlock(),e.createElementBlock("div",{key:2})):t.listItem.type===e.unref(i).MSG_VIDEO?(e.openBlock(),e.createElementBlock("div",{key:3})):t.listItem.type===e.unref(i).MSG_CUSTOM?(e.openBlock(),e.createBlock(ey,{key:4,contentText:e.unref(l),message:t.listItem,messageContent:t.listItemContent},null,8,["contentText","message","messageContent"])):(e.openBlock(),e.createElementBlock("div",{key:5},e.toDisplayString((o=t.listItem,(null==o?void 0:o.type)?vp.t(`TUISearch.${oy[o.type]}`):vp.t("TUISearch.[合并消息]"))),1))],2)],2),e.createElementVNode("div",{class:e.normalizeClass(t.displayType+"-right")},[e.createElementVNode("div",{class:e.normalizeClass(t.displayType+"-right-time")},e.toDisplayString(e.unref(c)),3),"bubble"===t.displayType&&e.unref(u)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(t.displayType+"-right-to"),onClick:e.withModifiers(h,["stop"])},e.toDisplayString(e.unref(vp).t("TUISearch.定位到聊天位置")),3)):e.createCommentVNode("",!0)],2)],2)):"file"===t.displayType?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass([t.displayType])},[e.createElementVNode("div",{class:e.normalizeClass([t.displayType+"-header"])},[e.createElementVNode("img",{class:e.normalizeClass(t.displayType+"-header-avatar"),src:e.unref(r),onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,10,["src"]),e.createElementVNode("div",{class:e.normalizeClass([t.displayType+"-header-name"])},e.toDisplayString(e.unref(s)),3),e.unref(u)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(t.displayType+"-header-to"),onClick:e.withModifiers(h,["stop"])},e.toDisplayString(e.unref(vp).t("TUISearch.定位到聊天位置")),3)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(t.displayType+"-header-time")},e.toDisplayString(e.unref(c)),3)],2),e.createElementVNode("div",{class:e.normalizeClass([t.displayType+"-main-content"])},[e.createVNode(Q_,{contentText:e.unref(l),messageContent:t.listItemContent,displayType:"bubble"},null,8,["contentText","messageContent"])],2)],2)):"image"===t.displayType?(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass([t.displayType])},[e.createElementVNode("div",{class:"image-container",onClick:e.withModifiers(h,["stop"])},[t.listItem.type===e.unref(i).MSG_IMAGE?(e.openBlock(),e.createBlock(ty,{key:0,messageContent:t.listItemContent},null,8,["messageContent"])):t.listItem.type===e.unref(i).MSG_VIDEO?(e.openBlock(),e.createBlock(ny,{key:1,messageContent:t.listItemContent},null,8,["messageContent"])):e.createCommentVNode("",!0),e.unref(u)?(e.openBlock(),e.createElementBlock("div",{key:2,class:"image-container-hover"},[e.createElementVNode("div",{class:"image-container-hover-text"},e.toDisplayString(e.unref(vp).t("TUISearch.定位到聊天位置")),1)])):e.createCommentVNode("",!0)])],2)):e.createCommentVNode("",!0)],34);var o}}}),[["__scopeId","data-v-369777ba"]]),ly=ee(e.defineComponent({__name:"index",setup:t=>(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["search-result-default",!e.unref(Zp)&&"search-result-default-h5"])},[e.createElementVNode("div",{class:"search-result-default-main"},[e.createVNode(fh,{file:e.unref("/assets/search-default.0969a8df.svg"),width:"88px",height:"75px"},null,8,["file"]),e.createElementVNode("div",{class:"default-text"},e.toDisplayString(e.unref(vp).t("TUISearch.暂无搜索结果")),1)])],2))}),[["__scopeId","data-v-bedcd79a"]]),cy=ee(e.defineComponent({__name:"index",props:{width:{type:String,default:"30px"},height:{type:String,default:"30px"},color:{type:String,default:"#D9D9D9"}},setup(t){const n=t;return(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:"tui-loading",style:e.normalizeStyle({width:n.width,height:n.height,border:`2px solid ${n.color}`,borderTopColor:"transparent"})},null,4))}}),[["__scopeId","data-v-2009946b"]]),uy=ee(e.defineComponent({__name:"index",setup:t=>(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["search-result-loading",!e.unref(Zp)&&"search-result-loading-h5"])},[e.createVNode(cy,{width:"40px",height:"40px"})],2))}),[["__scopeId","data-v-3dbb0f84"]]),dy="/assets/right-icon.a24fdba0.svg",py=ee(e.defineComponent({__name:"index",props:{searchType:{type:String,default:"global",validator:e=>["global","conversation"].includes(e)}},setup(t){var n,o;const a=t,i=e.ref([]),r=e.ref(null==(n=A_[a.searchType])?void 0:n.value),s=e.ref(0),l=e.ref(0),c=e.ref("and"),u=e.ref(null==(o=A_[a.searchType])?void 0:o.key),d=e.ref({}),p=e.ref([]),h=e.ref(0),f=e.ref(""),g=e.ref(),m=e.ref([]),v=e.ref(),_=e.ref([]),y=e.ref(!1),I=e.ref(!1),C=e.ref(!1),k=e.computed((()=>{var e,t,n;return!I.value&&("global"===a.searchType?!(!(null==(e=null==i?void 0:i.value)?void 0:e.length)||(null==(t=null==Object?void 0:Object.keys(d.value))?void 0:t.length)):!(null==(n=null==m?void 0:m.value)?void 0:n.length))}));function E(e){"conversation"===a.searchType&&(f.value=e)}function T(e){(null==e?void 0:e.searchType)===(null==a?void 0:a.searchType)&&(i.value=(null==e?void 0:e.value)?e.value.trim().split(/\s+/):[])}function S(e){var t,n,o,i;(null==e?void 0:e.searchType)===(null==a?void 0:a.searchType)&&(u.value=(null==(t=null==e?void 0:e.value)?void 0:t.key)||(null==(n=A_[a.searchType])?void 0:n.key),r.value=(null==(o=null==e?void 0:e.value)?void 0:o.value)||(null==(i=A_[a.searchType])?void 0:i.value))}function M(e){var t,n,o,i;(null==e?void 0:e.searchType)===(null==a?void 0:a.searchType)&&(s.value=null==(n=null==(t=null==e?void 0:e.value)?void 0:t.value)?void 0:n.timePosition,l.value=null==(i=null==(o=null==e?void 0:e.value)?void 0:o.value)?void 0:i.timePeriod)}e.onMounted((()=>{mp.watch(tu.CONV,{currentConversationID:E}),mp.watch(tu.SEARCH,{currentSearchInputValue:T,currentSearchMessageType:S,currentSearchMessageTime:M})})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversationID:E}),mp.unwatch(tu.SEARCH,{currentSearchInputValue:T,currentSearchMessageType:S,currentSearchMessageTime:M})}));const w=e=>{var t,n;(n={keywordList:(null==(t=null==i?void 0:i.value)?void 0:t.length)?i.value:void 0,messageTypeList:"string"==typeof r.value?[r.value]:r.value,timePosition:s.value,timePeriod:l.value,conversationID:(null==e?void 0:e.conversationID)||void 0,cursor:(null==e?void 0:e.cursor)||void 0,keywordListMatchType:c.value},Ip.searchCloudMessages(n).then((e=>e)).catch((e=>(tf({message:vp.t("TUISearch.消息云端搜索失败：")+(null==e?void 0:e.message),type:Qh,duration:3e3}),null)))).then((t=>{var n,o,i,r,s,l,c,f,y,k;if(Df("searchCloudMessage"),null==e?void 0:e.conversationID)g.value=null==t?void 0:t.data,(null==e?void 0:e.cursor)?m.value=[...m.value,...null==(c=null==(l=null==t?void 0:t.data)?void 0:l.searchResultList[0])?void 0:c.messageList]:m.value=null==(y=null==(f=null==t?void 0:t.data)?void 0:f.searchResultList[0])?void 0:y.messageList,v.value=null==(k=null==t?void 0:t.data)?void 0:k.totalCount,"conversation"!==(null==a?void 0:a.searchType)||"fileMessage"!==u.value&&"imageMessage"!==u.value?_.value=[]:_.value=O(m.value);else{(null==e?void 0:e.cursor)?p.value=[...p.value,...t.data.searchResultList]:p.value=null==(n=null==t?void 0:t.data)?void 0:n.searchResultList,h.value=null==(o=null==t?void 0:t.data)?void 0:o.totalCount;const a="all"===u.value?"allMessage":u.value;(null==(i=null==p?void 0:p.value)?void 0:i.length)&&"contact"!==u.value&&"group"!==u.value?d.value=Object.assign({},d.value,{[a]:{key:a,label:L_[a].label,list:"all"===u.value?null==(r=null==p?void 0:p.value)?void 0:r.slice(0,3):null==p?void 0:p.value,cursor:(null==(s=null==t?void 0:t.data)?void 0:s.cursor)||null}}):null==d||delete d.value[a]}I.value=!1,C.value=!1}))},b=((e,t)=>{let n=null;return(...o)=>{null!==n&&(clearTimeout(n),n=null),n=setTimeout((()=>e(...o)),t)}})(w,500),D=()=>{d.value={},g.value={},m.value=[],_.value=[]};e.watch((()=>[i.value,u.value,s.value,l.value]),((e,t)=>{var n,o,r;if(e!==t)if((null==(n=null==i?void 0:i.value)?void 0:n.length)||"global"!==(null==a?void 0:a.searchType))if(I.value=!0,"conversation"===a.searchType)D(),w({conversationID:f.value});else{if(t&&"all"===t[1]&&e&&"allMessage"===e[1])return(null==(o=null==d?void 0:d.value.allMessage)?void 0:o.list)&&(d.value.allMessage.list=null==p?void 0:p.value),null==(r=null==Object?void 0:Object.keys(null==d?void 0:d.value))||r.forEach((e=>{"allMessage"!==e&&(null==d||delete d.value[e])})),void(I.value=!1);y.value=!1,D(),b()}else D()}),{immediate:!0});const N=()=>{var e;w({cursor:null==(e=null==g?void 0:g.value)?void 0:e.cursor,conversationID:null==f?void 0:f.value})},R=(e,t,n)=>{var o;y.value=e,t&&mp.update(tu.SEARCH,"currentSearchMessageType",{value:L_[t],searchType:a.searchType}),f.value=(null==(o=null==n?void 0:n.conversation)?void 0:o.conversationID)||"",v.value=null==n?void 0:n.messageCount,n&&(C.value=!0,b({conversationID:f.value}))},L=e=>{var t;return f.value===(null==(t=null==e?void 0:e.conversation)?void 0:t.conversationID)?["list-item","list-item-selected"]:["list-item"]},A=()=>"conversation"===a.searchType&&"fileMessage"===u.value?"file":"conversation"===a.searchType&&"imageMessage"===u.value?"image":Zp?"bubble":"info",O=e=>{var t,n,o,a;const i=[];if(!(null==e?void 0:e.length))return i;if(1===(null==e?void 0:e.length))return i.push({date:ry(null==(t=e[0])?void 0:t.time),list:e}),i;let r="",s="";for(let l=0;l<(null==e?void 0:e.length);l++)s=ry(null==(n=e[l])?void 0:n.time),r!==s?i.push({date:s,list:[e[l]]}):null==(a=null==(o=i[(null==i?void 0:i.length)-1])?void 0:o.list)||a.push(e[l]),r=s;return i},P=e=>{"global"===a.searchType?(mp.update(tu.SEARCH,"currentSearchingStatus",{isSearching:!1,searchType:a.searchType}),_p.switchConversation(null==e?void 0:e.conversationID).then((()=>{mp.update(tu.CHAT,"messageSource",e),eh&&(null==bp||bp.navigateTo({url:"/TUIKit/components/TUIChat/index"}))}))):"conversation"===a.searchType&&(mp.update(tu.SEARCH,"isShowInConversationSearch",!1),mp.update(tu.CHAT,"messageSource",e),eh&&(null==bp||bp.navigateBack()))},U=e=>`${u}-${e}`;return(t,n)=>e.unref(I)?(e.openBlock(),e.createBlock(uy,{key:0,class:e.normalizeClass(["search-result-loading",!e.unref(Zp)&&"search-result-loading-h5"])},null,8,["class"])):e.unref(k)?(e.openBlock(),e.createBlock(ly,{key:1,class:e.normalizeClass(["search-result-default",!e.unref(Zp)&&"search-result-default-h5"])},null,8,["class"])):(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["tui-search-result",!e.unref(Zp)&&"tui-search-result-h5",e.unref(Zp)&&e.unref(y)&&"tui-search-result-with-border"])},["conversation"===a.searchType||!e.unref(Zp)&&e.unref(y)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-search-result-main"},[e.createElementVNode("div",{class:"tui-search-result-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(d),(t=>(e.openBlock(),e.createElementBlock("div",{key:t.key,class:"tui-search-result-list-item"},["global"===a.searchType?(e.openBlock(),e.createElementBlock("div",{key:0,class:"header"},e.toDisplayString(e.unref(vp).t(`TUISearch.${t.label}`)),1)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list,(n=>(e.openBlock(),e.createElementBlock("div",{key:n.conversation.conversationID,class:e.normalizeClass([L(n)])},["contact"===t.key||"group"===t.key||n.conversation?(e.openBlock(),e.createBlock(sy,{key:0,listItem:n,type:t.key,displayType:"info",keywordList:e.unref(i),onShowResultDetail:R,onNavigateToChatPosition:P},null,8,["listItem","type","keywordList"])):e.createCommentVNode("",!0)],2)))),128))]),"all"===e.unref(u)||t.cursor?(e.openBlock(),e.createElementBlock("div",{key:1,class:"more",onClick:e=>(e=>{"all"===u.value?mp.update(tu.SEARCH,"currentSearchMessageType",{value:L_[e.key],searchType:a.searchType}):w({cursor:(null==e?void 0:e.cursor)||void 0})})(t)},[e.createVNode(fh,{class:"more-icon",file:e.unref(D_),width:"12px",height:"12px"},null,8,["file"]),e.createElementVNode("div",{class:"more-text"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUISearch.查看更多")),1),e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t(`TUISearch.${t.label}`)),1)])],8,["onClick"])):e.createCommentVNode("",!0)])))),128))])])),e.unref(y)||"conversation"===a.searchType?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["tui-search-result-detail","conversation"===a.searchType&&"tui-search-result-in-conversation"])},[e.unref(C)?(e.openBlock(),e.createBlock(uy,{key:0,class:e.normalizeClass(["search-result-loading",!e.unref(Zp)&&"search-result-loading-h5"])},null,8,["class"])):e.createCommentVNode("",!0),!e.unref(C)&&e.unref(y)&&"conversation"!==a.searchType?(e.openBlock(),e.createElementBlock("div",{key:1,class:"tui-search-message-header"},[e.createElementVNode("div",{class:"header-content"},[e.createElementVNode("div",{class:"header-content-count normal"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(v)),1),e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUISearch.条与")),1)]),e.createElementVNode("div",{class:"header-content-keyword"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),((t,n)=>(e.openBlock(),e.createElementBlock("span",{key:n},[e.createElementVNode("span",{class:"normal"},'"'),e.createElementVNode("span",{class:"highlight"},e.toDisplayString(t),1),e.createElementVNode("span",{class:"normal"},'"')])))),128))]),e.createElementVNode("div",{class:"header-content-type normal"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUISearch.相关的")),1),e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t(`TUISearch.${"allMessage"===e.unref(u)?"结果":e.unref(L_)[e.unref(u)].label}`)),1)])]),e.createElementVNode("div",{class:"header-enter",onClick:n[0]||(n[0]=t=>e.unref(ay)({conversationID:e.unref(f)}))},[e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUISearch.进入聊天")),1),e.createVNode(fh,{class:"enter-icon",file:e.unref(dy),width:"14px",height:"14px"},null,8,["file"])])])):e.createCommentVNode("",!0),!e.unref(C)&&e.unref(m)&&e.unref(m)[0]?(e.openBlock(),e.createElementBlock("div",{key:2,class:"tui-search-message-list"},["global"===a.searchType||"imageMessage"!==e.unref(u)&&"fileMessage"!==e.unref(u)?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(e.unref(m),(t=>(e.openBlock(),e.createElementBlock("div",{key:U(t.ID),class:e.normalizeClass(["list-item"])},[e.createVNode(sy,{listItem:t,listItemContent:t.getMessageContent(),type:e.unref(u),displayType:A(),keywordList:e.unref(i),onShowResultDetail:R,onNavigateToChatPosition:P},null,8,["listItem","listItemContent","type","displayType","keywordList"])])))),128)):(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:1},e.renderList(e.unref(_),(t=>(e.openBlock(),e.createElementBlock("div",{key:U(t.date),class:e.normalizeClass(["list-group","fileMessage"===e.unref(u)?"list-group-file":"list-group-image"])},[e.createElementVNode("div",{class:e.normalizeClass(["list-group-date"])},e.toDisplayString(t.date),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list,(t=>(e.openBlock(),e.createElementBlock("div",{key:U(t.ID),class:e.normalizeClass(["list-group-item"])},[e.createVNode(sy,{listItem:t,listItemContent:t.getMessageContent(),type:e.unref(u),displayType:A(),keywordList:e.unref(i),onShowResultDetail:R,onNavigateToChatPosition:P},null,8,["listItem","listItemContent","type","displayType","keywordList"])])))),128))],2)))),128)),e.unref(g)&&e.unref(g).cursor?(e.openBlock(),e.createElementBlock("div",{key:2,class:"more",onClick:N},[e.createVNode(fh,{class:"more-icon",file:e.unref(D_),width:"12px",height:"12px"},null,8,["file"]),e.createElementVNode("div",{class:"more-text"},e.toDisplayString(e.unref(vp).t("TUISearch.查看更多历史记录")),1)])):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0)],2))}}),[["__scopeId","data-v-1998e839"]]),hy=ee(e.defineComponent({__name:"index",props:{searchType:{type:String,default:"global",validator:e=>["global","conversation"].includes(e)}},setup(t){const n=t,o=e.ref(),a=e.ref(!1),i=()=>{a.value=!a.value,!eh&&a.value&&Kp.listen({domRefs:o.value,handler:s})},r=e.ref([]),s=()=>{a.value=!1};return e.onMounted((()=>{r.value=[..._t.getExtensionList(nt.TUISearch.EXTENSION.SEARCH_MORE.EXT_ID)],_t.callService({serviceName:nt.TUIConversation.SERVICE.NAME,method:nt.TUIConversation.SERVICE.METHOD.HIDE_CONVERSATION_HEADER,params:{}})})),e.watch((()=>a.value),(()=>{a.value&&mp.update(tu.SEARCH,"currentSearchingStatus",{isSearching:!1,searchType:n.searchType})})),(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"searchMoreRef",ref:o,class:e.normalizeClass(["tui-search-more",!e.unref(Zp)&&"tui-search-more-h5"])},[e.createElementVNode("div",{class:"more",onClick:n[0]||(n[0]=e=>i())},[e.createVNode(fh,{class:"more-icon",file:e.unref("/assets/search-more.7ecab7ad.svg"),width:e.unref(Zp)?"28px":"34px",height:e.unref(Zp)?"28px":"34px"},null,8,["file","width","height"])]),e.unref(a)?(e.openBlock(),e.createElementBlock("ul",{key:0,class:"tui-search-more-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"list-item",onClick:e=>(e=>{var t;const{listener:n={onClicked:()=>{}}}=e;null==(t=null==n?void 0:n.onClicked)||t.call(n,e),i()})(t)},[t.icon?(e.openBlock(),e.createBlock(fh,{key:0,class:"list-item-icon",file:t.icon},null,8,["file"])):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"list-item-title"},e.toDisplayString(t.text),1)],8,["onClick"])))),128))])):e.createCommentVNode("",!0)],2))}}),[["__scopeId","data-v-52d047f7"]]),fy=ee(e.defineComponent({__name:"index",props:{searchType:{default:()=>eh?"conversation":"global"}},setup(t){const n=t,o=e.ref(),a=e.ref(""),i=e.ref(!1),r=e.ref(eh),s=e.computed((()=>!Zp&&("global"===n.searchType&&i.value||"conversation"===n.searchType&&r.value))),l=e=>{mp.update(tu.SEARCH,"currentSearchInputValue",{value:"",searchType:e}),mp.update(tu.SEARCH,"currentSearchMessageType",{value:A_[e],searchType:e}),mp.update(tu.SEARCH,"currentSearchMessageTime",{value:G_,searchType:e})};function c(e){eh||a.value===e||h(),a.value=e}function u(e){var t,a;(null==e?void 0:e.searchType)===n.searchType&&(i.value=null==e?void 0:e.isSearching,"global"===(null==e?void 0:e.searchType)&&o.value&&Zp&&e.isSearching&&Kp.listen({domRefs:o.value,handler:p}),"global"===(null==e?void 0:e.searchType)&&eh&&(e.isSearching?null==(t=null==bp?void 0:bp.hideTabBar())||t.catch((()=>{})):null==(a=null==bp?void 0:bp.showTabBar())||a.catch((()=>{}))))}function d(e){r.value=!!e,r.value&&l(n.searchType)}function p(){mp.update(tu.SEARCH,"currentSearchingStatus",{isSearching:!1,searchType:n.searchType})}function h(){mp.update(tu.SEARCH,"isShowInConversationSearch",!1)}return e.onMounted((()=>{["global","conversation"].forEach((e=>{l(e)})),mp.watch(tu.CONV,{currentConversationID:c}),mp.watch(tu.SEARCH,{currentSearchingStatus:u,isShowInConversationSearch:d})})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversationID:c}),mp.unwatch(tu.SEARCH,{currentSearchingStatus:u,isShowInConversationSearch:d})})),(t,n)=>"global"===t.searchType||("conversation"===t.searchType||!t.searchType&&e.unref(eh))&&e.unref(r)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-search",!e.unref(Zp)&&"tui-search-h5",`tui-search-main-${t.searchType?t.searchType:"conversation"}`,e.unref(s)&&"tui-search-h5-full-screen"])},["global"===t.searchType?(e.openBlock(),e.createElementBlock("div",{key:0,ref_key:"globalSearchRef",ref:o,class:e.normalizeClass(["tui-search-global",!e.unref(Zp)&&"tui-search-h5-global"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-search-global-header",!e.unref(Zp)&&"tui-search-h5-global-header"])},[e.createVNode(R_,{class:"search-input",searchType:t.searchType},null,8,["searchType"]),e.unref(Zp)||!e.unref(i)?(e.openBlock(),e.createBlock(hy,{key:0,class:"search-more",searchType:t.searchType},null,8,["searchType"])):e.createCommentVNode("",!0)],2),e.unref(i)?(e.openBlock(),e.createBlock(J_,{key:0,class:"search-container",popupPosition:"bottom",searchType:t.searchType},{result:e.withCtx((()=>[e.createVNode(py,{class:"search-result",searchType:t.searchType},null,8,["searchType"])])),_:1},8,["searchType"])):e.createCommentVNode("",!0)],2)):"conversation"===t.searchType&&e.unref(r)||e.unref(eh)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["tui-search-conversation",!e.unref(Zp)&&"tui-search-h5-conversation"])},[e.createVNode(J_,{class:"search-container",popupPosition:"aside",searchType:t.searchType?t.searchType:"conversation",onCloseInConversationSearch:h},{input:e.withCtx((()=>[e.createVNode(R_,{searchType:t.searchType?t.searchType:"conversation"},null,8,["searchType"])])),result:e.withCtx((()=>[e.createVNode(py,{class:"search-result",searchType:t.searchType?t.searchType:"conversation"},null,8,["searchType"])])),_:1},8,["searchType"])],2)):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-ec4b40a3"]]),gy=ee(e.defineComponent({__name:"index",props:{actionsMenuPosition:{},selectedConversation:{},selectedConversationDomRect:{}},emits:["closeConversationActionMenu"],setup(t,{emit:n}){var o,a;const i=n,r=t,s=(null==(o=e.getCurrentInstance())?void 0:o.proxy)||e.getCurrentInstance(),l=e.ref(),c=e.ref(!0),u=e.ref(!1),d=mp.getConversationModel((null==(a=r.selectedConversation)?void 0:a.conversationID)||""),p=e.ref(r.actionsMenuPosition);e.onMounted((()=>{e.nextTick((()=>{var e;if(eh)(null==bp?void 0:bp.createSelectorQuery().in(s)).select("#conversation-actions-menu").boundingClientRect((e=>{var t;e&&(e.bottom>(null==(t=null==bp?void 0:bp.getWindowInfo)?void 0:t.call(bp).windowHeight)&&(p.value=__spreadProps(__spreadValues({},r.actionsMenuPosition),{top:r.actionsMenuPosition.top-(r.actionsMenuPosition.conversationHeight||0)-e.height})),p.value.left+e.width+5>bp.getWindowInfo().windowWidth&&(p.value.left=bp.getWindowInfo().windowWidth-e.width-5)),c.value=!1})).exec();else{const t=null==(e=l.value)?void 0:e.getBoundingClientRect();Zp&&void 0!==r.actionsMenuPosition.left&&(p.value.left=r.actionsMenuPosition.left),t&&t.bottom>window.innerHeight&&(p.value.top=r.actionsMenuPosition.top-(r.actionsMenuPosition.conversationHeight||0)-t.height),c.value=!1}}))}));const h=e.computed((()=>{var e,t;return(null==(e=r.selectedConversation)?void 0:e.type)===gp.TYPES.CONV_C2C?"TUIConversation.删除后，将清空该聊天的消息记录":(null==(t=r.selectedConversation)?void 0:t.type)===gp.TYPES.CONV_GROUP?"TUIConversation.删除后，将清空该群聊的消息记录":""}));const f=e=>{const{name:t}=e,n=d;if(t&&n&&n.conversationID){switch(t){case Mh.DELETE:null==n||n.deleteConversation();break;case Mh.ISPINNED:case Mh.DISPINNED:null==n||n.pinConversation();break;case Mh.MUTE:case Mh.NOTMUTE:null==n||n.muteConversation()}i("closeConversationActionMenu")}},g=e=>{e||i("closeConversationActionMenu"),u.value=e};return(t,n)=>(e.openBlock(),e.createBlock(Eh,{maskColor:"transparent",onOnOverlayClick:n[6]||(n[6]=()=>i("closeConversationActionMenu"))},{default:e.withCtx((()=>[e.createElementVNode("div",{id:"conversation-actions-menu",ref_key:"actionsMenuDomRef",ref:l,class:e.normalizeClass([e.unref(Zp)&&"actions-menu-pc","actions-menu",!e.unref(c)&&"cancel-hidden"]),style:e.normalizeStyle({top:`${e.unref(p).top}px`,left:`${e.unref(p).left}px`})},[e.createElementVNode("div",{class:e.normalizeClass(["actions-menu-item"]),onClick:n[0]||(n[0]=e.withModifiers((e=>{u.value=!0}),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIConversation.删除会话")),1),r.selectedConversation&&r.selectedConversation.isPinned?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["actions-menu-item"]),onClick:n[1]||(n[1]=e.withModifiers((t=>f({name:e.unref(Mh).ISPINNED})),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIConversation.置顶会话")),1)),r.selectedConversation&&r.selectedConversation.isPinned?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["actions-menu-item"]),onClick:n[2]||(n[2]=e.withModifiers((t=>f({name:e.unref(Mh).DISPINNED})),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIConversation.取消置顶")),1)):e.createCommentVNode("",!0),r.selectedConversation&&r.selectedConversation.isMuted?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:2,class:e.normalizeClass(["actions-menu-item"]),onClick:n[3]||(n[3]=e.withModifiers((t=>f({name:e.unref(Mh).MUTE})),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIConversation.消息免打扰")),1)),r.selectedConversation&&r.selectedConversation.isMuted?(e.openBlock(),e.createElementBlock("div",{key:3,class:e.normalizeClass(["actions-menu-item"]),onClick:n[4]||(n[4]=e.withModifiers((t=>f({name:e.unref(Mh).NOTMUTE})),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIConversation.取消免打扰")),1)):e.createCommentVNode("",!0)],6),e.createVNode(Fv,{show:e.unref(u),center:!0,isHeaderShow:e.unref(Zp),onSubmit:n[5]||(n[5]=t=>f({name:e.unref(Mh).DELETE})),"onUpdate:show":g},{default:e.withCtx((()=>[e.createElementVNode("p",{class:"delDialog-title"},e.toDisplayString(e.unref(vp).t(e.unref(h))),1)])),_:1},8,["show","isHeaderShow"])])),_:1}))}}),[["__scopeId","data-v-2fa8668b"]]),vy=e.defineComponent({__name:"index",emits:["handleSwitchConversation","getPassingRef"],setup(t,{expose:n,emit:o}){const a=o,i=e.ref(),r=e.ref(),s=e.ref(),l=e.ref(!1),c=e.ref([]),u=e.ref(),d=e.ref(),p=e.ref({top:0,left:void 0,conversationHeight:void 0}),h=e.ref(!1),f=e.ref();let g=null;e.onMounted((()=>{mp.watch(tu.CONV,{currentConversationID:k,conversationList:C,currentConversation:I}),mp.watch(tu.USER,{displayOnlineStatus:E,userStatusList:T}),eh||!Pp||Zp||function(){if(!d.value)return;!function(e){const{element:t,onLongPress:n,options:o={}}=e;if(!t||!n)throw new Error("addLongPressEventListener missing arguments");const{duration:a=800,eventDelegation:i}=o;let r;function s(){clearTimeout(r),c()}function l(){clearTimeout(r),c()}function c(){t.removeEventListener("pointerup",s),t.removeEventListener("pointermove",l)}t.addEventListener("pointerdown",(e=>{const o=e.target,c=(null==i?void 0:i.subSelector)?o.closest(i.subSelector)||void 0:o,u=e.currentTarget;r=setTimeout((()=>n(e,c,u)),a),t.addEventListener("pointerup",s),t.addEventListener("pointermove",l)}))}({element:d.value,onLongPress:(e,t)=>{const n=Array.from(d.value.children).indexOf(t);v(e,c.value[n],n)},options:{eventDelegation:{subSelector:".tui-conversation-content"}}})}()})),e.onUnmounted((()=>{mp.unwatch(tu.CONV,{currentConversationID:k,conversationList:C,currentConversation:I}),mp.unwatch(tu.USER,{displayOnlineStatus:E,userStatusList:T})}));const m=e=>h.value&&e.type===gp.TYPES.CONV_C2C,v=(e,t,n,o)=>{o&&(e.preventDefault(),eh)||(i.value=t,g=Date.now(),y(e,n))},_=()=>{g&&Date.now()-g>300&&(i.value=void 0,l.value=!1)},y=(e,t)=>{var n;if(eh){void 0===u.value&&a("getPassingRef",u);(null==bp?void 0:bp.createSelectorQuery().in(u.value)).select(`#convlistitem-${t}`).boundingClientRect((t=>{t&&(p.value={top:t.bottom+(Jp?44:0),left:e.touches[0].pageX,conversationHeight:t.height},l.value=!0)})).exec()}else{const t=(null==(n=e.currentTarget||e.target)?void 0:n.getBoundingClientRect())||{};t&&(p.value={top:t.bottom,left:Zp?e.clientX:void 0,conversationHeight:t.height}),l.value=!0}};function I(e){i.value=e}function C(e){c.value=e}function k(e){r.value=e}function E(e){h.value=e}function T(e){0!==e.size&&(f.value=[...e.entries()].reduce(((e,[t,n])=>(e[t]=n,e)),{}))}return n({closeChildren:_}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"conversationListInnerDomRef",ref:d,class:"tui-conversation-list"},[e.unref(l)?(e.openBlock(),e.createBlock(gy,{key:0,selectedConversation:e.unref(i),actionsMenuPosition:e.unref(p),selectedConversationDomRect:e.unref(s),onCloseConversationActionMenu:_},null,8,["selectedConversation","actionsMenuPosition","selectedConversationDomRect"])):e.createCommentVNode("",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(c),((t,n)=>(e.openBlock(),e.createElementBlock("div",{id:`convlistitem-${n}`,key:n,class:e.normalizeClass(["tui-conversation-content",e.unref(th)&&"tui-conversation-content-h5 disable-select"])},[e.createElementVNode("div",{class:e.normalizeClass([e.unref(Zp)&&"isPC","tui-conversation-item",e.unref(r)===t.conversationID&&"tui-conversation-item-selected",t.isPinned&&"tui-conversation-item-pinned"]),onClick:e=>{return n=t.conversationID,a("handleSwitchConversation",n),void _p.switchConversation(n);var n},onLongpress:e=>v(e,t,n),onContextmenu:e=>v(e,t,n,!0)},[e.createElementVNode("aside",{class:"left"},[e.createVNode(mh,{useSkeletonAnimation:"",url:t.getAvatar(),size:"30px"},null,8,["url"]),e.unref(f)&&m(t)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["online-status",Object.keys(e.unref(f)).length>0&&Object.keys(e.unref(f)).includes(t.userProfile.userID)&&1===e.unref(f)[t.userProfile.userID].statusType?"online-status-online":"online-status-offline"])},null,2)):e.createCommentVNode("",!0),t.unreadCount>0&&!t.isMuted?(e.openBlock(),e.createElementBlock("span",{key:1,class:"num"},e.toDisplayString(t.unreadCount>99?"99+":t.unreadCount),1)):e.createCommentVNode("",!0),t.unreadCount>0&&t.isMuted?(e.openBlock(),e.createElementBlock("span",{key:2,class:"num-notify"})):e.createCommentVNode("",!0)]),e.createElementVNode("div",{class:"content"},[e.createElementVNode("div",{class:"content-header"},[e.createElementVNode("label",{class:"content-header-label"},[e.createElementVNode("p",{class:"name"},e.toDisplayString(t.getShowName()),1)]),e.createElementVNode("div",{class:"middle-box"},[t.draftText&&t.conversationID!==e.unref(r)?(e.openBlock(),e.createElementBlock("span",{key:0,class:"middle-box-draft"},e.toDisplayString(e.unref(vp).t("TUIChat.[草稿]")),1)):"GROUP"===t.type&&t.groupAtInfoList&&t.groupAtInfoList.length>0?(e.openBlock(),e.createElementBlock("span",{key:1,class:"middle-box-at"},e.toDisplayString(t.getGroupAtInfo()),1)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:"middle-box-content"},e.toDisplayString(t.getLastMessage("text")),1)])]),e.createElementVNode("div",{class:"content-footer"},[e.createElementVNode("span",{class:"time"},e.toDisplayString(t.getLastMessage("time")),1),t.isMuted?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref("/assets/mute.94c8513a.svg")},null,8,["file"])):e.createCommentVNode("",!0)])])],42,["onClick","onLongpress","onContextmenu"])],10,["id"])))),128))],512))}}),_y=ee(vy,[["__scopeId","data-v-17f6053c"]]),yy="/assets/start-group.6d6b5fbb.svg",Iy="/assets/icon-c2c.d80299ab.svg";class Cy{static getInstance(){return Cy.instance||(Cy.instance=new Cy),Cy.instance}getMenu(){const e=this.generateMenuList();return!Zp&&e.length>0?[{text:vp.t("TUIConversation.发起会话"),data:{name:"all",children:e}}]:e}generateMenuList(){return[{icon:Iy,text:vp.t("TUIConversation.发起单聊"),data:{name:wh},listener:{onClicked:this.createConversation.bind(this)}},{icon:yy,text:vp.t("TUIConversation.发起群聊"),data:{name:bh},listener:{onClicked:this.createConversation.bind(this)}}]}createConversation(e){_t.callService({serviceName:nt.TUIConversation.SERVICE.NAME,method:nt.TUIConversation.SERVICE.METHOD.CREATE_CONVERSATION,params:e})}}const ky=ee(e.defineComponent({__name:"index",setup(t,{expose:n}){const o=e.ref([]),a=e.ref(),i=e.computed((()=>Cy.getInstance().getMenu()));e.onMounted((()=>{o.value=[]}));const r=e=>{const{data:{children:t},listener:n={onClicked:()=>{}}}=e;t?o.value=o.value.length>0?[]:t:(n.onClicked(e),s())},s=()=>{o.value=[]};return n({closeChildren:s}),(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref:e.unref(a),class:"tui-conversation-header"},[e.unref(i).length>0?(e.openBlock(),e.createElementBlock("ul",{key:0,class:"list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"list-item"},[e.createElementVNode("main",{class:"tui-conversation-header-item",onClick:e.withModifiers((e=>r(t)),["stop"])},[t.icon&&!t.data.children?(e.openBlock(),e.createBlock(fh,{key:0,class:"tui-conversation-header-item-icon",file:t.icon},null,8,["file"])):(e.openBlock(),e.createElementBlock("i",{key:1,class:"plus"})),e.createElementVNode("h1",{class:"tui-conversation-header-item-title"},e.toDisplayString(t.text),1)],8,["onClick"])])))),128))])):e.createCommentVNode("",!0),e.unref(o).length>0?(e.openBlock(),e.createElementBlock("ul",{key:1,class:"tui-conversation-header-children list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(o),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"list-item"},[e.createElementVNode("main",{class:"tui-conversation-header-item",onClick:e=>r(t)},[t.icon?(e.openBlock(),e.createBlock(fh,{key:0,class:"tui-conversation-header-item-icon",file:t.icon},null,8,["file"])):e.createCommentVNode("",!0),e.createElementVNode("h1",{class:"tui-conversation-header-item-title"},e.toDisplayString(t.text),1)],8,["onClick"])])))),128))])):e.createCommentVNode("",!0)],512))}}),[["__scopeId","data-v-d2664a8e"]]),Ey=ee(e.defineComponent({__name:"index",setup(t){const n=e.ref(!1);return mp.watch(tu.USER,{netStateChange:e=>{n.value=e===gp.TYPES.NET_STATE_DISCONNECTED}}),(t,o)=>e.unref(n)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"network"},[e.createElementVNode("i",{class:"icon icon-error"},"!"),e.createElementVNode("p",{class:"network-content"},e.toDisplayString(e.unref(vp).t("TUIConversation.网络异常，请您检查网络设置")),1)])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-e9495285"]]),Ty=e.defineComponent({__name:"index",emits:["handleSwitchConversation"],setup(t,{emit:n}){const o=n,a=e.ref(0),i=e.ref(),r=e.ref(),s=e.ref(0),l=e.ref(0),c=e.ref(!0);mp.watch(tu.CONV,{totalUnreadCount:e=>{a.value=e}}),mp.watch(tu.CUSTOM,{isShowConversationHeader:e=>{c.value=!1!==e}});const u=e=>{null==bp||bp.navigateTo({url:"/TUIKit/components/TUIChat/index"}),o("handleSwitchConversation",e)},d=()=>{var e,t;null==(e=null==i?void 0:i.value)||e.closeChildren(),null==(t=null==r?void 0:r.value)||t.closeChildren()},p=()=>{d()};se(d);const h=e=>{s.value=e.changedTouches[0].clientX,l.value=e.changedTouches[0].clientY},f=e=>{const t=e.changedTouches[0].clientX,n=e.changedTouches[0].clientY;let o="";t-s.value>50&&Math.abs(n-l.value)<50?o="right":t-s.value<-50&&Math.abs(n-l.value)<50&&(o="left"),n-l.value>50&&Math.abs(t-s.value)<50?o="down":n-l.value<-50&&Math.abs(t-s.value)<50&&(o="up"),"down"!==o&&"up"!==o||d()},g=e=>{e.value=r.value};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"tui-conversation",onClick:p,onTouchstart:h,onTouchend:f},[e.createVNode(fy,{searchType:"global"}),e.unref(c)?(e.openBlock(),e.createBlock(ky,{key:0,ref_key:"headerRef",ref:i},null,512)):e.createCommentVNode("",!0),e.createVNode(Ey),e.createVNode(_y,{ref_key:"conversationListDomRef",ref:r,class:"tui-conversation-list",onHandleSwitchConversation:u,onGetPassingRef:g},null,512)],32))}}),Sy=ee(Ty,[["__scopeId","data-v-a0598a85"]]);class My{constructor(){this.hideConversationHeader=()=>{mp.update(tu.CUSTOM,"isShowConversationHeader",!1)},_t.registerService(nt.TUIConversation.SERVICE.NAME,this),_t.registerExtension(nt.TUISearch.EXTENSION.SEARCH_MORE.EXT_ID,this),this.onCallParamsMap=new Map,this.onCallCallbackMap=new Map,this.constants=nt}static getInstance(){return My.instance||(My.instance=new My),My.instance}getOnCallParams(e){return this.onCallParamsMap.get(e)}getOnCallCallback(e){return this.onCallCallbackMap.get(e)}onCall(e,t,n){switch(this.onCallParamsMap.set(e,t),this.onCallCallbackMap.set(e,n),e){case nt.TUIConversation.SERVICE.METHOD.CREATE_CONVERSATION:this.createConversation(t);break;case nt.TUIConversation.SERVICE.METHOD.HIDE_CONVERSATION_HEADER:this.hideConversationHeader()}}onGetExtension(e){if(e===nt.TUISearch.EXTENSION.SEARCH_MORE.EXT_ID){return[{weight:100,icon:Iy,text:vp.t("TUIConversation.发起单聊"),data:{name:wh},listener:{onClicked:this.createConversation.bind(this)}},{weight:100,icon:yy,text:vp.t("TUIConversation.发起群聊"),data:{name:bh},listener:{onClicked:this.createConversation.bind(this)}}]}}createConversation(e){_t.callService({serviceName:nt.TUIContact.SERVICE.NAME,method:nt.TUIContact.SERVICE.METHOD.SELECT_FRIEND,params:{title:e.text,isRadio:e.data.name!==bh,isNeedSearch:!mp.getData(tu.APP,"isOfficial")},callback:t=>__async(this,null,(function*(){if(!t||0===t.length)return this.routerForward(null);if(e.data.name===bh)this.createGroup(t);else{const{userID:e}=t[0];yield this.generateConversation(`C2C${e}`),this.routerForward(`C2C${e}`)}}))})}createGroup(e){_t.callService({serviceName:nt.TUIGroup.SERVICE.NAME,method:nt.TUIGroup.SERVICE.METHOD.CREATE_GROUP,params:{title:vp.t("TUIConversation.发起群聊"),memberList:e},callback:e=>__async(this,null,(function*(){let t=null;if(e){const{groupID:n}=e;yield this.generateConversation(`GROUP${n}`),t=`GROUP${n}`}this.routerForward(t)}))})}routerForward(e){return __async(this,null,(function*(){eh&&(yield null==bp?void 0:bp.reLaunch({url:"/TUIKit/components/TUIConversation/index"}),e&&(null==bp||bp.navigateTo({url:"/TUIKit/components/TUIChat/index"})))}))}generateConversation(e){_p.switchConversation(e).then((()=>{e.startsWith("GROUP")&&Df("groupChat"),oe("warn","at TUIKit/components/TUIConversation/server.ts:153","打开会话成功")})).catch((e=>{oe("warn","at TUIKit/components/TUIConversation/server.ts:156","打开会话失败",e.code,e.msg)}))}}new My;new class{constructor(){_t.registerService(nt.TUISearch.SERVICE.NAME,this),_t.registerExtension(nt.TUIChat.EXTENSION.INPUT_MORE.EXT_ID,this)}onCall(e,t){switch(e){case nt.TUISearch.SERVICE.METHOD.SEARCH_GROUP:return this.searchGroup(null==t?void 0:t.groupID);case nt.TUISearch.SERVICE.METHOD.SEARCH_USER:return this.searchUser(null==t?void 0:t.userID);case nt.TUISearch.SERVICE.METHOD.SEARCH_FRIEND:return this.searchFriend(null==t?void 0:t.userID);case nt.TUISearch.SERVICE.METHOD.SEARCH_GROUP_MEMBER:return this.searchGroupMember(null==t?void 0:t.groupID,null==t?void 0:t.userID)}}onGetExtension(e){if(e===nt.TUIChat.EXTENSION.INPUT_MORE.EXT_ID){const e=[],t={weight:3e3,text:"搜索",icon:"https://web.sdk.qcloud.com/component/TUIKit/assets/message-search.svg",data:{name:"search"},listener:{onClicked:()=>{mp.update(tu.SEARCH,"isShowInConversationSearch",!0),eh&&(null==bp||bp.navigateTo({url:"/TUIKit/components/TUISearch/index"}))}}};return e.push(t),e}}searchFriend(e){return __async(this,null,(function*(){return kp.getFriendProfile({userIDList:[e]})}))}searchUser(e){return __async(this,null,(function*(){return yp.getUserProfile({userIDList:[e]})}))}searchGroup(e){return __async(this,null,(function*(){return Cp.searchGroupByID(e)}))}searchGroupMember(e,t){return __async(this,null,(function*(){return Cp.getGroupMemberProfile({groupID:e,userIDList:[t]})}))}};const wy=e.defineComponent({__name:"index",props:{isRadio:{type:Boolean,default:!1},isNeedSearch:{type:Boolean,default:!1},title:{type:String,default:""},userList:{type:Array,default:()=>[]},total:{type:Number,default:0}},emits:["complete","search","getMore"],setup(t,{emit:n}){const o=n,a=t,i=()=>{o("complete",[])},r=e=>{o("complete",e)},s=e=>{o("search",e)},l=()=>{o("getMore")};return(t,n)=>(e.openBlock(),e.createBlock(Fv,{show:!0,isH5:!e.unref(Zp),isHeaderShow:!1,isFooterShow:!1,background:!1,"onUpdate:show":i},{default:e.withCtx((()=>[e.createVNode(p_,{isSearch:a.isNeedSearch,title:a.title,list:a.userList,isH5:!e.unref(Zp),isRadio:a.isRadio,total:a.total,onGetMore:l,onSearch:s,onSubmit:r,onCancel:i},null,8,["isSearch","title","list","isH5","isRadio","total"])])),_:1},8,["isH5"]))}});class by{constructor(){_t.registerService(nt.TUIContact.SERVICE.NAME,this),this.onCallParamsMap=new Map,this.onCallCallbackMap=new Map,this.constants=nt}static getInstance(){return by.instance||(by.instance=new by),by.instance}getOnCallParams(e){return this.onCallParamsMap.get(e)}getOnCallCallback(e){return this.onCallCallbackMap.get(e)}onCall(e,t,n){return __async(this,null,(function*(){this.onCallParamsMap.set(e,t),this.onCallCallbackMap.set(e,n),e===nt.TUIContact.SERVICE.METHOD.SELECT_FRIEND&&(mp.update(tu.CUSTOM,"isShowSelectFriendComponent",!0),eh&&(null==bp||bp.reLaunch({url:"/TUIKit/components/TUIContact/index"})))}))}}const Dy=e.defineComponent({__name:"index",setup(t){const n=by.getInstance(),o=n.constants,a=e.ref(!1),i=e.ref([]),r=e.ref([]),s=e.ref(null),l=e.ref({isRadio:!1,isNeedSearch:!1,title:""});e.watchEffect((()=>{const e=n.getOnCallParams(o.TUIContact.SERVICE.METHOD.SELECT_FRIEND);var t;l.value.title=e.title,l.value.isRadio=e.isRadio,l.value.isNeedSearch=e.isNeedSearch,e.isNeedSearch&&(t=e.isNeedSearch,s.value=_t.getService(o.TUISearch.SERVICE.NAME),s.value?a.value=t:oe("warn","at TUIKit/components/TUIContact/select-friend/index.vue:41","请添加 TUISearch 组件")),kp.getFriendList().then((e=>{i.value=e.data.map((e=>e.profile)),r.value=i.value})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/select-friend/index.vue:57","getFriendList error:",e)}))}));const c=e=>{mp.update(tu.CUSTOM,"isShowSelectFriendComponent",!1);const t=n.getOnCallCallback(o.TUIContact.SERVICE.METHOD.SELECT_FRIEND);t&&t(e)},u=()=>{tf({message:vp.t("TUIGroup.该用户不存在"),type:Qh}),r.value=[...i.value]},d=e=>__async(this,null,(function*(){if(!e)return r.value=i.value;try{const t=yield s.value.searchUser(e);if(!t.data[0])return u();r.value=t.data;const n=i.value.filter((e=>e.userID===t.data[0].userID));i.value=n.length?i.value:[...i.value,...r.value]}catch(nM){return u()}}));return(t,n)=>(e.openBlock(),e.createBlock(wy,{isRadio:e.unref(l).isRadio,isNeedSearch:e.unref(l).isNeedSearch,title:e.unref(l).title,userList:e.unref(r),onSearch:d,onComplete:c},null,8,["isRadio","isNeedSearch","title","userList"]))}}),Ny=ee(e.defineComponent({__name:"index",setup(t){const n=vp.t("TUIContact.输入ID"),o=e.ref(!1),a=e.ref(""),i=e.ref({user:{label:"联系人",list:[]},group:{label:"群聊",list:[]}}),r=qv((function(e){o.value=e}),200),s=()=>__async(this,null,(function*(){a.value&&(_t.callService({serviceName:nt.TUISearch.SERVICE.NAME,method:nt.TUISearch.SERVICE.METHOD.SEARCH_USER,params:{userID:a.value}}).then((e=>{i.value.user.list=e.data})).catch((e=>{i.value.user.list=[],oe("warn","at TUIKit/components/TUIContact/contact-search/index.vue:111","search user error",e)})),_t.callService({serviceName:nt.TUISearch.SERVICE.NAME,method:nt.TUISearch.SERVICE.METHOD.SEARCH_GROUP,params:{groupID:a.value}}).then((e=>{i.value.group.list=[e.data.group]})).catch((e=>{i.value.group.list=[],oe("warn","at TUIKit/components/TUIContact/contact-search/index.vue:125","search group error",e)})))}));return e.watch((()=>i.value),(()=>{mp.update(tu.CUSTOM,"currentContactSearchResult",i.value)}),{deep:!0,immediate:!0}),e.watch((()=>o.value),(()=>{mp.update(tu.CUSTOM,"currentContactSearchingStatus",o.value),o.value&&(a.value="",i.value.user.list=[],i.value.group.list=[])}),{deep:!0,immediate:!0}),bp.updateContactSearch=s,bp.closeSearching=()=>{o.value=!1},(t,i)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["tui-contact-search",!e.unref(Zp)&&"tui-contact-search-h5"])},[e.unref(o)&&e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-contact-search-header",!e.unref(Zp)&&"tui-contact-search-h5-header",e.unref(o)&&"tui-contact-searching-h5-header"]),onClick:i[1]||(i[1]=t=>e.unref(r)(!0))},[e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-search-header-icon",!e.unref(Zp)&&"tui-contact-search-h5-header-icon"]),onClick:i[0]||(i[0]=e.withModifiers((t=>e.unref(r)(!e.unref(o))),["stop"]))},[e.createVNode(fh,{file:e.unref(o)?e.unref(dh):e.unref("/assets/add.ea3b9dc9.svg"),width:e.unref(o)?"20px":"14px",height:e.unref(o)?"20px":"14px"},null,8,["file","width","height"])],2),e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-search-header-title",!e.unref(Zp)&&"tui-contact-search-h5-header-title"])},e.toDisplayString(e.unref(vp).t("TUIContact.添加好友/群聊")),3)],2)),e.unref(o)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["tui-contact-search-main",!e.unref(Zp)&&"tui-contact-search-h5-main"])},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":i[2]||(i[2]=t=>e.isRef(a)?a.value=t:null),class:"tui-contact-search-main-input",type:"text",placeholder:e.unref(n),enterkeyhint:"search",onKeyup:e.withKeys(s,["enter"]),onBlur:s,onConfirm:s},null,40,["placeholder"]),[[e.vModelText,e.unref(a)]]),e.createElementVNode("div",{class:"tui-contact-search-main-cancel",onClick:i[3]||(i[3]=e=>o.value=!1)},e.toDisplayString(e.unref(vp).t("取消")),1)],2)):e.createCommentVNode("",!0)],2))}}),[["__scopeId","data-v-6898dc15"]]),Ry=e=>{var t;return(null==e?void 0:e.avatar)||(null==(t=null==e?void 0:e.profile)?void 0:t.avatar)||(null==e?void 0:e.groupID)&&"https://web.sdk.qcloud.com/im/assets/images/Public.svg"||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png"},Ly=e=>{var t;return(null==e?void 0:e.remark)||(null==e?void 0:e.name)||(null==(t=null==e?void 0:e.profile)?void 0:t.nick)||(null==e?void 0:e.nick)||(null==e?void 0:e.groupID)||(null==e?void 0:e.userID)||""},Ay=e=>{var t;return(null==e?void 0:e.name)||(null==(t=null==e?void 0:e.profile)?void 0:t.nick)||(null==e?void 0:e.nick)||(null==e?void 0:e.groupID)||(null==e?void 0:e.userID)||""},Oy=e=>{var t,n;return(null==e?void 0:e.type)===(null==(t=null==gp?void 0:gp.TYPES)?void 0:t.SNS_APPLICATION_SENT_TO_ME)||(null==e?void 0:e.type)===(null==(n=null==gp?void 0:gp.TYPES)?void 0:n.SNS_APPLICATION_SENT_BY_ME)},Py=e=>{const t=(null==e?void 0:e.groupID)?`GROUP${null==e?void 0:e.groupID}`:`C2C${null==e?void 0:e.userID}`;_p.switchConversation(t).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:200","switch conversation failed:",e),tf({message:vp.t("TUIContact.进入会话失败"),type:Qh})}))},Uy=e=>{kp.acceptFriendApplication({userID:e,type:gp.TYPES.SNS_APPLICATION_AGREE_AND_ADD}).then((()=>{tf({message:vp.t("TUIContact.添加好友成功"),type:Jh})})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:222","accept friend application failed:",e),tf({message:vp.t("TUIContact.同意好友申请失败"),type:Qh})}))},xy=(e,t)=>{Cp.joinGroup({groupID:e,applyMessage:t}).then((e=>{var t;switch(null==(t=null==e?void 0:e.data)?void 0:t.status){case gp.TYPES.JOIN_STATUS_WAIT_APPROVAL:tf({message:vp.t("TUIContact.等待管理员同意"),type:Jh});break;case gp.TYPES.JOIN_STATUS_SUCCESS:tf({message:vp.t("TUIContact.加群成功"),type:Jh});break;case gp.TYPES.JOIN_STATUS_ALREADY_IN_GROUP:tf({message:vp.t("TUIContact.您已是群成员"),type:Jh})}})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:316","join group failed:",e),tf({message:"申请入群失败",type:Qh})}))},Vy=ee(e.defineComponent({__name:"index",props:{item:{default:()=>({})},displayOnlineStatus:{type:Boolean,default:!1}},setup(t){const n=t,o=e.inject("userOnlineStatusMap"),a=e.ref(!1),i={[gp.TYPES.GRP_WORK]:"Work",[gp.TYPES.GRP_AVCHATROOM]:"AVChatRoom",[gp.TYPES.GRP_PUBLIC]:"Public",[gp.TYPES.GRP_MEETING]:"Meeting",[gp.TYPES.GRP_COMMUNITY]:"Community"},r=e.computed((()=>{var e,t,o,a,i,r,s;let l="";return(null==(e=n.item)?void 0:e.type)===(null==(t=null==gp?void 0:gp.TYPES)?void 0:t.SNS_APPLICATION_SENT_TO_ME)||(null==(o=n.item)?void 0:o.type)===(null==(a=null==gp?void 0:gp.TYPES)?void 0:a.SNS_APPLICATION_SENT_BY_ME)?l=(null==(i=n.item)?void 0:i.wording)||"":(null==(r=n.item)?void 0:r.groupID)&&(l=`ID:${null==(s=n.item)?void 0:s.groupID}`),l})),s=e.computed((()=>{var e,t;let o="";return(null==(e=n.item)?void 0:e.groupID)&&(o=i[null==(t=n.item)?void 0:t.type]),o})),l=e.computed((()=>{var e,t,o,a;return(null==(e=n.item)?void 0:e.type)===(null==(t=null==gp?void 0:gp.TYPES)?void 0:t.SNS_APPLICATION_SENT_BY_ME)?{style:"text",label:"等待验证"}:(null==(o=n.item)?void 0:o.type)===(null==(a=null==gp?void 0:gp.TYPES)?void 0:a.SNS_APPLICATION_SENT_TO_ME)&&{style:"button",label:"同意",onClick:()=>{var e;Uy(null==(e=n.item)?void 0:e.userID)}}}));return e.watch((()=>null==o?void 0:o.value),(()=>{var e,t,i;a.value=!!(n.displayOnlineStatus&&(null==o?void 0:o.value)&&(null==(e=n.item)?void 0:e.userID)&&(null==(i=null==(t=o.value)?void 0:t[n.item.userID])?void 0:i.statusType)===gp.TYPES.USER_STATUS_ONLINE)}),{immediate:!0,deep:!0}),(t,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["tui-contact-list-card",!e.unref(Zp)&&"tui-contact-list-card-h5"])},[e.createElementVNode("div",{class:"tui-contact-list-card-left"},[e.createVNode(mh,{class:"tui-contact-list-card-left-avatar",useSkeletonAnimation:"",url:e.unref(Ry)(n.item)},null,8,["url"]),n.displayOnlineStatus&&n.item?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"online-status":!0,"online-status-online":e.unref(a),"online-status-offline":!e.unref(a)})},null,2)):e.createCommentVNode("",!0)]),e.createElementVNode("div",{class:"tui-contact-list-card-main"},[e.createElementVNode("div",{class:"tui-contact-list-card-main-name"},e.toDisplayString(e.unref(Ly)(n.item)),1),e.unref(r)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-contact-list-card-main-other"},e.toDisplayString(e.unref(r)),1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",{class:"tui-contact-list-card-right"},[e.unref(s)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-contact-list-card-right-group-type"},e.toDisplayString(e.unref(s)),1)):e.createCommentVNode("",!0),e.unref(l)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"tui-contact-list-card-right-application"},["text"===e.unref(l).style?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-contact-list-card-right-application-text"},e.toDisplayString(e.unref(vp).t(`TUIContact.${e.unref(l).label}`)),1)):"button"===e.unref(l).style?(e.openBlock(),e.createElementBlock("button",{key:1,class:"tui-contact-list-card-right-application-button",onClick:o[0]||(o[0]=e.withModifiers(((...t)=>e.unref(l).onClick&&e.unref(l).onClick(...t)),["stop"]))},e.toDisplayString(e.unref(vp).t(`TUIContact.${e.unref(l).label}`)),1)):e.createCommentVNode("",!0)])):e.createCommentVNode("",!0)])],2))}}),[["__scopeId","data-v-8e7f4ad8"]]),By=ee(e.defineComponent({__name:"index",setup(t){const n=e.ref(""),o=e.ref({}),a=e.ref({friendApplicationList:{key:"friendApplicationList",title:"新的联系人",list:[],unreadCount:0},blackList:{key:"blackList",title:"黑名单",list:[]},groupList:{key:"groupList",title:"我的群聊",list:[]},friendList:{key:"friendList",title:"我的好友",list:[]}}),i=e.ref(!1),r=e.ref(),s=e.ref(!1),l=e.ref(),c=e.computed((()=>{var e,t,n,o;return!(null==(t=null==(e=null==r?void 0:r.value)?void 0:e.user)?void 0:t.list[0])&&!(null==(o=null==(n=null==r?void 0:r.value)?void 0:n.group)?void 0:o.list[0])}));function u(e){var t,n,r,s,l,c,u,d;if(o.value=e,i.value){let e;(null==(t=o.value)?void 0:t.userID)?e=null==(s=null==(r=null==(n=a.value)?void 0:n.friendList)?void 0:r.list)?void 0:s.find((e=>{var t;return(null==e?void 0:e.userID)===(null==(t=o.value)?void 0:t.userID)})):(null==(l=o.value)?void 0:l.groupID)&&(e=null==(d=null==(u=null==(c=a.value)?void 0:c.groupList)?void 0:u.list)?void 0:d.find((e=>{var t;return(null==e?void 0:e.groupID)===(null==(t=o.value)?void 0:t.groupID)}))),e&&(o.value=e)}mp.update(tu.CUSTOM,"currentContactInfo",o.value)}function d(e){s.value=e}function p(e){(null==e?void 0:e.size)>0&&(l.value=Object.fromEntries(null==e?void 0:e.entries()))}function h(e){if(!e)return;const t=nt.TUIContact.EXTENSION.CONTACT_LIST.EXT_ID,n=_t.getExtensionList(t).find((e=>{const{name:t,accountList:n=[]}=e.data||{};return"customer"===t&&n.length>0}));if(n){const{data:e,text:t}=n,{accountList:o}=e||{};yp.getUserProfile({userIDList:o}).then((e=>{if(e.data.length>0){const n={title:t,list:e.data.map(((e,t)=>__spreadProps(__spreadValues({},e),{renderKey:I("customerList",e,t),infoKeyList:[],btnKeyList:["enterC2CConversation"]}))),key:"customerList"};a.value=__spreadProps(__spreadValues({},a.value),{customerList:n})}})).catch((()=>{}))}}function f(e){y("groupList",e)}function g(e){y("blackList",e)}function m(e){a.value.friendApplicationList.unreadCount=e}function v(e){y("friendList",e)}function _(e){y("friendApplicationList",e)}function y(e,t){a.value[e].list=t,a.value[e].list.map(((t,n)=>t.renderKey=I(e,t,n))),function(e,t){var a,r;if(!(null==(a=o.value)?void 0:a.userID)&&!(null==(r=o.value)?void 0:r.groupID))return;(t===n.value||i.value)&&(o.value=(null==e?void 0:e.find((e=>{var t,n;return(null==e?void 0:e.groupID)&&(null==e?void 0:e.groupID)===(null==(t=o.value)?void 0:t.groupID)||(null==e?void 0:e.userID)&&(null==e?void 0:e.userID)===(null==(n=o.value)?void 0:n.userID)})))||{},mp.update(tu.CUSTOM,"currentContactInfo",o.value))}(a.value[e].list,e)}function I(e,t,n){return`${e}-${t.userID||t.groupID||"index"+n}`}function C(e){r.value=e}function k(e){i.value=e,mp.update(tu.CUSTOM,"currentContactInfo",{}),mp.update(tu.CUSTOM,"currentContactListKey","")}function E(e){o.value=e}function T(e){n.value=e}return e.onMounted((()=>{mp.watch(tu.APP,{enabledCustomerServicePlugin:h}),mp.watch(tu.GRP,{groupList:f}),mp.watch(tu.USER,{userBlacklist:g,displayOnlineStatus:d,userStatusList:p}),mp.watch(tu.FRIEND,{friendList:v,friendApplicationList:_,friendApplicationUnreadCount:m}),mp.watch(tu.CUSTOM,{currentContactSearchingStatus:k,currentContactSearchResult:C,currentContactListKey:T,currentContactInfo:E})})),e.onUnmounted((()=>{mp.unwatch(tu.APP,{enabledCustomerServicePlugin:h}),mp.unwatch(tu.GRP,{groupList:f}),mp.unwatch(tu.USER,{userBlacklist:g,displayOnlineStatus:d,userStatusList:p}),mp.unwatch(tu.FRIEND,{friendList:v,friendApplicationList:_,friendApplicationUnreadCount:m}),mp.unwatch(tu.CUSTOM,{currentContactSearchingStatus:k,currentContactSearchResult:C,currentContactListKey:T,currentContactInfo:E})})),e.provide("userOnlineStatusMap",l),(t,l)=>e.unref(i)?(e.openBlock(),e.createElementBlock("ul",{key:1,class:"tui-contact-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"tui-contact-list-item"},[t.list[0]?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-contact-search-list"},[e.createElementVNode("div",{class:"tui-contact-search-list-title"},e.toDisplayString(e.unref(vp).t(`TUIContact.${t.label}`)),1),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list,((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(["tui-contact-search-list-item",["selected"]]),onClick:e=>u(t)},[e.createVNode(Vy,{item:t,displayOnlineStatus:!1},null,8,["item"])],8,["onClick"])))),128))])):e.createCommentVNode("",!0)])))),128)),e.unref(c)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"tui-contact-search-list-default"},e.toDisplayString(e.unref(vp).t("TUIContact.无搜索结果")),1)):e.createCommentVNode("",!0)])):(e.openBlock(),e.createElementBlock("ul",{key:0,class:e.normalizeClass(["tui-contact-list",!e.unref(Zp)&&"tui-contact-list-h5"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),((t,a)=>(e.openBlock(),e.createElementBlock("li",{key:a,class:"tui-contact-list-item"},[e.createElementVNode("header",{class:"tui-contact-list-item-header",onClick:e=>function(e){n.value===e?(n.value="",o.value={},mp.update(tu.CUSTOM,"currentContactListKey",""),mp.update(tu.CUSTOM,"currentContactInfo",{})):(n.value=e,mp.update(tu.CUSTOM,"currentContactListKey",e),"friendApplicationList"===e&&kp.setFriendApplicationRead())}(a)},[e.createElementVNode("div",{class:"tui-contact-list-item-header-left"},[e.createVNode(fh,{file:e.unref(n)===a?e.unref(Z_):e.unref(dy),width:"16px",height:"16px"},null,8,["file"]),e.createElementVNode("div",null,e.toDisplayString(e.unref(vp).t(`TUIContact.${t.title}`)),1)]),e.createElementVNode("div",{class:"tui-contact-list-item-header-right"},[t.unreadCount?(e.openBlock(),e.createElementBlock("span",{key:0,class:"tui-contact-list-item-header-right-unread"},e.toDisplayString(t.unreadCount),1)):e.createCommentVNode("",!0)])],8,["onClick"]),e.createElementVNode("ul",{class:e.normalizeClass(["tui-contact-list-item-main",e.unref(n)===a?"":"hidden"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.list,(t=>(e.openBlock(),e.createElementBlock("li",{key:t.renderKey,class:e.normalizeClass(["tui-contact-list-item-main-item",["selected"]]),onClick:e=>u(t)},[(e.openBlock(),e.createBlock(Vy,{key:t.renderKey,item:e.unref(vh)(t),displayOnlineStatus:e.unref(s)&&"friendList"===a},null,8,["item","displayOnlineStatus"]))],8,["onClick"])))),128))],2)])))),128))],2))}}),[["__scopeId","data-v-98ec6e9a"]]),Gy={setRemark:{key:"setRemark",label:"备注名",data:"",labelPosition:Rh.LEFT,editable:!0,editType:Lh.INPUT,editing:!1,editSubmitHandler:e=>{var t,n,o,a,i,r;if(null==e?void 0:e.isBothFriend){const r=null==(t=null==e?void 0:e.item)?void 0:t.data;((e,t)=>{var n;(null==(n=null==t?void 0:t.replace(/[^\u0000-\u00ff]/g,"aa"))?void 0:n.length)>96?tf({message:vp.t("TUIContact.修改备注失败: 备注长度不得超过 96 字节"),type:Qh}):kp.updateFriend({userID:e,remark:t}).then((()=>{tf({message:vp.t("TUIContact.修改备注成功"),type:Jh})})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:138","update friend remark failed:",e),tf({message:vp.t("TUIContact.修改备注失败"),type:Qh})}))})(null==(n=null==e?void 0:e.contactInfoData)?void 0:n.userID,r),(null==(o=null==e?void 0:e.item)?void 0:o.editing)&&(e.item.editing=!1),(null==(a=null==e?void 0:e.item)?void 0:a.data)&&(e.item.data=null==(i=null==e?void 0:e.contactInfoData)?void 0:i.remark)}else(null==(r=null==e?void 0:e.item)?void 0:r.editing)&&(e.item.editing=!1)}},blackList:{key:"blackList",label:"加入黑名单",data:!1,labelPosition:Rh.LEFT,editable:!0,editType:Lh.SWITCH,editing:!0,editSubmitHandler:e=>{var t,n,o;(null==e?void 0:e.isInBlackList)?(o=null==(t=null==e?void 0:e.contactInfoData)?void 0:t.userID,yp.removeFromBlacklist({userIDList:[o]}).then((()=>{})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:353","remove from blacklist failed:",e),tf({message:vp.t("TUIContact.移除黑名单失败"),type:Qh})}))):((e=>{yp.addToBlacklist({userIDList:[e]}).then((()=>{})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:333","add to blacklist failed:",e),tf({message:vp.t("TUIContact.加入黑名单失败"),type:Qh})}))})(null==(n=null==e?void 0:e.contactInfoData)?void 0:n.userID),mp.update(tu.CUSTOM,"currentContactListKey","blackList"))}},setWords:{key:"setWords",label:"请填写验证信息",data:"",labelPosition:Rh.TOP,editable:!0,editType:Lh.TEXTAREA,editing:!0},displayWords:{key:"displayWords",label:"验证信息",data:"",labelPosition:Rh.LEFT,editable:!1}},Fy={dismissGroup:{key:"dismissGroup",label:"解散群聊",type:Ah.CANCEL,onClick:e=>{var t,n;n=null==(t=null==e?void 0:e.contactInfoData)?void 0:t.groupID,Cp.dismissGroup(n).then((()=>{tf({message:vp.t("TUIContact.解散群聊成功"),type:Jh}),(null==bp?void 0:bp.updateContactSearch)&&(null==bp||bp.updateContactSearch())})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:259","dismiss group failed:",e),tf({message:vp.t("TUIContact.解散群聊失败"),type:Qh})}))}},quitGroup:{key:"quitGroup",label:"退出群聊",type:Ah.CANCEL,onClick:e=>{var t,n;n=null==(t=null==e?void 0:e.contactInfoData)?void 0:t.groupID,Cp.quitGroup(n).then((()=>{tf({message:vp.t("TUIContact.退出群组成功"),type:Jh})})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:277","quit group failed:",e),tf({message:vp.t("TUIContact.退出群组失败"),type:Qh})}))}},joinGroup:{key:"joinGroup",label:"发送申请",type:Ah.SUBMIT,onClick:e=>{var t,n;xy(null==(t=null==e?void 0:e.contactInfoData)?void 0:t.groupID,null==(n=null==e?void 0:e.contactInfoMoreList[0])?void 0:n.data)}},joinAVChatGroup:{key:"joinAVChatGroup",label:"加入直播群",type:Ah.SUBMIT,onClick:e=>{var t;xy(null==(t=null==e?void 0:e.contactInfoData)?void 0:t.groupID)}},enterGroupConversation:{key:"enterGroupConversation",label:"进入群聊",type:Ah.SUBMIT,onClick:e=>{Py(null==e?void 0:e.contactInfoData)}},addFriend:{key:"addFriend",label:"发送申请",type:Ah.SUBMIT,onClick:e=>{var t,n,o,a;a={to:null==(t=null==e?void 0:e.contactInfoData)?void 0:t.userID,source:"AddSource_Type_Web",remark:null==(n=null==e?void 0:e.contactInfoMoreList[1])?void 0:n.data,wording:null==(o=null==e?void 0:e.contactInfoMoreList[0])?void 0:o.data},kp.addFriend(a).then((()=>{tf({message:vp.t("TUIContact.申请已发送"),type:Jh})})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:185","delete friend failed:",e),tf({message:vp.t("TUIContact.申请发送失败"),type:Qh})}))}},deleteFriend:{key:"deleteFriend",label:"删除好友",type:Ah.CANCEL,onClick:e=>{var t,n;n=null==(t=null==e?void 0:e.contactInfoData)?void 0:t.userID,kp.deleteFriend({userIDList:[n],type:gp.TYPES.SNS_DELETE_TYPE_BOTH}).then((e=>{const{successUserIDList:t}=e.data;t[0].userID===n?tf({message:vp.t("TUIContact.删除好友成功"),type:Jh}):tf({message:vp.t("TUIContact.删除好友失败"),type:Qh})})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:167","delete friend failed:",e),tf({message:vp.t("TUIContact.删除好友失败"),type:Qh})}))}},enterC2CConversation:{key:"enterC2CConversation",label:"发送消息",type:Ah.SUBMIT,onClick:e=>{Py(null==e?void 0:e.contactInfoData)}},acceptFriendApplication:{key:"acceptFriendApplication",label:"同意",type:Ah.SUBMIT,onClick:e=>{var t;Uy(null==(t=null==e?void 0:e.contactInfoData)?void 0:t.userID),mp.update(tu.CUSTOM,"currentContactListKey","friendList")}},refuseFriendApplication:{key:"refuseFriendApplication",label:"拒绝",type:Ah.CANCEL,onClick:e=>{var t,n;n=null==(t=null==e?void 0:e.contactInfoData)?void 0:t.userID,kp.refuseFriendApplication(n).then((()=>{tf({message:vp.t("TUIContact.拒绝成功"),type:Jh})})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:240","accept friend application failed:",e),tf({message:vp.t("TUIContact.拒绝好友申请失败"),type:Qh})}))}}},zy="/assets/edit.4601124c.svg",Hy=ee(e.defineComponent({__name:"index",props:{value:{type:Boolean,default:!1}},setup:t=>(n,o)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["tui-switch",t.value?"tui-switch-checked":"tui-switch-no-checked"])},null,2))}),[["__scopeId","data-v-9b2fa26b"]]),jy=ee(e.defineComponent({__name:"index",emits:["switchConversation"],setup(t,{emit:n}){const o=n,a=e.ref({}),i=e.ref([]),r=e.ref([]),s=e.ref([]),l=e.computed((()=>{var e;return!!(null==(e=a.value)?void 0:e.groupID)})),c=e.computed((()=>Oy(null==a?void 0:a.value))),u=e.ref(!1),d=e.computed((()=>{var e,t;return!!(null==(t=null==(e=a.value)?void 0:e.selfInfo)?void 0:t.userID)})),p=e.computed((()=>{var e;return!l.value&&(null==(e=h.value)?void 0:e.findIndex((e=>{var t;return(null==e?void 0:e.userID)===(null==(t=a.value)?void 0:t.userID)})))>=0})),h=e.ref([]);e.onMounted((()=>{mp.watch(tu.CUSTOM,{currentContactInfo:_}),mp.watch(tu.USER,{userBlacklist:v})})),e.onUnmounted((()=>{mp.unwatch(tu.CUSTOM,{currentContactInfo:_}),mp.unwatch(tu.USER,{userBlacklist:v})}));const f=()=>{mp.update(tu.CUSTOM,"currentContactInfo",{}),mp.update(tu.CUSTOM,"currentContactSearchingStatus",!1),(null==bp?void 0:bp.closeSearching)&&(null==bp||bp.closeSearching())},g=e=>{e.editSubmitHandler&&e.editSubmitHandler({item:e,contactInfoData:a.value,isBothFriend:u.value,isInBlackList:p.value})},m=()=>__async(this,null,(function*(){var e,t,n,o;c.value?(Gy.displayWords.data=(null==(o=a.value)?void 0:o.wording)||"",r.value.push(Gy.displayWords)):((!l.value&&!u.value&&!p.value||l.value&&!d.value&&(null==(e=a.value)?void 0:e.type)!==(null==(t=null==gp?void 0:gp.TYPES)?void 0:t.GRP_AVCHATROOM))&&(Gy.setWords.data="",r.value.push(Gy.setWords)),l.value||p.value||(Gy.setRemark.data=(null==(n=a.value)?void 0:n.remark)||"",Gy.setRemark.editing=!1,r.value.push(Gy.setRemark)),l.value||!u.value&&!p.value||(Gy.blackList.data=p.value||!1,r.value.push(Gy.blackList)))}));function v(e){h.value=e}function _(e){return __async(this,null,(function*(){var t,n;a.value&&e&&JSON.stringify(a.value)===JSON.stringify(e)||(a.value={},i.value=[],r.value=[],s.value=[],a.value=vh(e)||{},a.value&&0!==(null==(t=Object.keys(a.value))?void 0:t.length)&&(i.value=(e=>{var t;const n=[{label:(null==e?void 0:e.groupID)?"群ID":"ID",data:(null==e?void 0:e.groupID)||(null==e?void 0:e.userID)||""}];return Oy(e)||n.push({label:(null==e?void 0:e.groupID)?"群类型":"个性签名",data:(null==e?void 0:e.type)||(null==(t=null==e?void 0:e.profile)?void 0:t.selfSignature)||""}),n})(a.value),u.value=yield(n=a.value,new Promise(((e,t)=>{!(null==n?void 0:n.groupID)&&(null==n?void 0:n.userID)?(null==n?void 0:n.addTime)?e(!0):kp.checkFriend({userIDList:[null==n?void 0:n.userID],type:gp.TYPES.SNS_CHECK_TYPE_BOTH}).then((t=>{var n,o;switch(null==(o=null==(n=null==t?void 0:t.data)?void 0:n.successUserIDList[0])?void 0:o.relation){case gp.TYPES.SNS_TYPE_NO_RELATION:case gp.TYPES.SNS_TYPE_A_WITH_B:case gp.TYPES.SNS_TYPE_B_WITH_A:e(!1);break;case gp.TYPES.SNS_TYPE_BOTH_WAY:e(!0);break;default:e(!1)}})).catch((e=>{oe("warn","at TUIKit/components/TUIContact/utils/index.ts:111","checkFriend error",e),t(e)})):e(!1)}))),m(),(()=>{var e,t,n,o,i,r,h,f,g,m,v,_,y,I,C;p.value||(c.value?(null==(e=a.value)?void 0:e.type)===(null==(t=null==gp?void 0:gp.TYPES)?void 0:t.SNS_APPLICATION_SENT_TO_ME)&&(null==(n=null==s?void 0:s.value)||n.push(Fy.refuseFriendApplication),null==(o=null==s?void 0:s.value)||o.push(Fy.acceptFriendApplication)):l.value&&d.value?("Owner"===(null==(r=null==(i=a.value)?void 0:i.selfInfo)?void 0:r.role)?null==(h=null==s?void 0:s.value)||h.push(Fy.dismissGroup):null==(f=null==s?void 0:s.value)||f.push(Fy.quitGroup),null==(g=null==s?void 0:s.value)||g.push(Fy.enterGroupConversation)):!l.value&&u.value?(null==(m=null==s?void 0:s.value)||m.push(Fy.deleteFriend),null==(v=null==s?void 0:s.value)||v.push(Fy.enterC2CConversation)):l.value?null==(I=null==s?void 0:s.value)||I.push((null==(_=a.value)?void 0:_.type)===(null==(y=null==gp?void 0:gp.TYPES)?void 0:y.GRP_AVCHATROOM)?Fy.joinAVChatGroup:Fy.joinGroup):null==(C=null==s?void 0:s.value)||C.push(Fy.addFriend))})(),e.infoKeyList&&(r.value=e.infoKeyList.map((e=>Gy[e]))),e.btnKeyList&&(s.value=e.btnKeyList.map((e=>Fy[e])))))}))}return(t,n)=>"object"==typeof e.unref(a)&&Object.keys(e.unref(a)).length?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-contact-info",!e.unref(Zp)&&"tui-contact-info-h5"])},[e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-contact-info-header",!e.unref(Zp)&&"tui-contact-info-h5-header"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-header-icon",!e.unref(Zp)&&"tui-contact-info-h5-header-icon"]),onClick:f},[e.createVNode(fh,{file:e.unref(dh)},null,8,["file"])],2),e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-header-title",!e.unref(Zp)&&"tui-contact-info-h5-header-title"])},e.toDisplayString(e.unref(vp).t("TUIContact.添加好友/群聊")),3)],2)),e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-basic",!e.unref(Zp)&&"tui-contact-info-h5-basic"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-basic-text",!e.unref(Zp)&&"tui-contact-info-h5-basic-text"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-basic-text-name",!e.unref(Zp)&&"tui-contact-info-h5-basic-text-name"])},e.toDisplayString(e.unref(Ay)(e.unref(a))),3),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),(t=>(e.openBlock(),e.createElementBlock("div",{key:t.label,class:e.normalizeClass(["tui-contact-info-basic-text-other",!e.unref(Zp)&&"tui-contact-info-h5-basic-text-other"])},e.toDisplayString(`${e.unref(vp).t(`TUIContact.${t.label}`)}:\n          ${t.data}`),3)))),128))],2),e.createElementVNode("img",{class:e.normalizeClass(["tui-contact-info-basic-avatar",!e.unref(Zp)&&"tui-contact-info-h5-basic-avatar"]),src:e.unref(Ry)(e.unref(a))},null,10,["src"])],2),e.unref(r)[0]?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["tui-contact-info-more",!e.unref(Zp)&&"tui-contact-info-h5-more"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(r),(t=>(e.openBlock(),e.createElementBlock("div",{key:t.key,class:e.normalizeClass(["tui-contact-info-more-item",!e.unref(Zp)&&"tui-contact-info-h5-more-item",t.labelPosition===e.unref(Rh).TOP?"tui-contact-info-more-item-top":"tui-contact-info-more-item-left"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-more-item-label",!e.unref(Zp)&&"tui-contact-info-h5-more-item-label"])},e.toDisplayString(`${e.unref(vp).t(`TUIContact.${t.label}`)}`),3),e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-more-item-content",!e.unref(Zp)&&"tui-contact-info-h5-more-item-content"])},[t.editing?t.editType===e.unref(Lh).INPUT?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:1,"onUpdate:modelValue":e=>t.data=e,class:e.normalizeClass(["tui-contact-info-more-item-content-input",!e.unref(Zp)&&"tui-contact-info-h5-more-item-content-input"]),type:"text",onConfirm:e=>g(t),onKeyup:e.withKeys((e=>g(t)),["enter"])},null,42,["onUpdate:modelValue","onConfirm","onKeyup"])),[[e.vModelText,t.data]]):t.editType===e.unref(Lh).TEXTAREA?e.withDirectives((e.openBlock(),e.createElementBlock("textarea",{key:2,"onUpdate:modelValue":e=>t.data=e,class:e.normalizeClass(["tui-contact-info-more-item-content-textarea",!e.unref(Zp)&&"tui-contact-info-h5-more-item-content-textarea"]),"confirm-type":"done"},null,10,["onUpdate:modelValue"])),[[e.vModelText,t.data]]):t.editType===e.unref(Lh).SWITCH?(e.openBlock(),e.createElementBlock("div",{key:3,onClick:e=>g(t)},[e.createVNode(Hy,{value:t.data},null,8,["value"])],8,["onClick"])):e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-contact-info-more-item-content-text",!e.unref(Zp)&&"tui-contact-info-h5-more-item-content-text"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-more-item-content-text-data",!e.unref(Zp)&&"tui-contact-info-h5-more-item-content-text-data"])},e.toDisplayString(t.data),3),t.editable?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-contact-info-more-item-content-text-icon",!e.unref(Zp)&&"tui-contact-info-h5-more-item-content-text-icon"]),onClick:e=>(e=>{e.editing=!0})(t)},[e.createVNode(fh,{file:e.unref(zy),width:"14px",height:"14px"},null,8,["file"])],10,["onClick"])):e.createCommentVNode("",!0)],2))],2)],2)))),128))],2)):e.createCommentVNode("",!0),e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-info-button",!e.unref(Zp)&&"tui-contact-info-h5-button"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),(t=>(e.openBlock(),e.createElementBlock("button",{key:t.key,class:e.normalizeClass(["tui-contact-info-button-item",!e.unref(Zp)&&"tui-contact-info-h5-button-item",t.type===e.unref(Ah).CANCEL?"tui-contact-info-button-item-cancel":"tui-contact-info-button-item-submit"]),onClick:e=>(e=>{e.onClick&&e.onClick({contactInfoData:a.value,contactInfoMoreList:r.value}),"enterGroupConversation"!==e.key&&"enterC2CConversation"!==e.key||(o("switchConversation",a.value),f())})(t)},e.toDisplayString(e.unref(vp).t(`TUIContact.${t.label}`)),11,["onClick"])))),128))],2)],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-e080a159"]]),qy=ee(e.defineComponent({__name:"index",props:{displayType:{type:String,default:"contactList",require:!1}},emits:["switchConversation"],setup(t,{emit:n}){const o=n,a=t,i=e.ref(a.displayType||"contactList"),r=e.ref(!1),s=e.ref(!0),l=e.ref(!0);e.watchEffect((()=>{s.value="selectFriend"!==(null==a?void 0:a.displayType)})),mp.watch(tu.CUSTOM,{isShowSelectFriendComponent:e=>{var t;if(!eh&&"selectFriend"===(null==a?void 0:a.displayType))return r.value=e,void(s.value=!1);e?(r.value=!0,eh&&(i.value="selectFriend",null==bp||bp.hideTabBar())):(r.value=!1,eh&&(i.value=a.displayType,null==(t=null==bp?void 0:bp.showTabBar())||t.catch((()=>{}))))},currentContactInfo:e=>{var t;l.value=Zp||e&&"object"==typeof e&&(null==(t=Object.keys(e))?void 0:t.length)>0}});const c=e=>{eh&&(null==bp||bp.navigateTo({url:"/TUIKit/components/TUIChat/index"})),o("switchConversation",e)};return(t,n)=>e.unref(r)?(e.openBlock(),e.createBlock(Dy,{key:0})):e.unref(s)?(e.openBlock(),e.createElementBlock("div",{key:1,class:e.normalizeClass(["tui-contact",!e.unref(Zp)&&"tui-contact-h5"])},[e.createElementVNode("div",{class:e.normalizeClass(["tui-contact-left",!e.unref(Zp)&&"tui-contact-h5-left"])},[e.createVNode(Ny),e.createVNode(By,{class:e.normalizeClass(["tui-contact-left-list",!e.unref(Zp)&&"tui-contact-h5-left-list"])},null,8,["class"])],2),e.unref(l)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["tui-contact-right",!e.unref(Zp)&&"tui-contact-h5-right"])},[e.createVNode(jy,{onSwitchConversation:c})],2)):e.createCommentVNode("",!0)],2)):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-934ca5de"]]);by.getInstance();const Ky=[{icon:"https://web.sdk.qcloud.com/im/assets/images/Public.svg",label:"陌生人社交群（Public）",type:gp.TYPES.GRP_PUBLIC,detail:"类似 QQ 群，创建后群主可以指定群管理员，用户搜索群 ID 发起加群申请后，需要群主或管理员审批通过才能入群。详见",src:"产品文档"},{icon:"https://web.sdk.qcloud.com/im/assets/images/Meeting.svg",label:"临时会议群（Meeting）",type:gp.TYPES.GRP_MEETING,detail:"创建后可以随意进出，且支持查看入群前消息；适合用于音视频会议场景、在线教育场景等与实时音视频产品结合的场景。详见",src:"产品文档"},{icon:"https://web.sdk.qcloud.com/im/assets/images/Work.svg",label:"好友工作群（Work）",type:gp.TYPES.GRP_WORK,detail:"类似普通微信群，创建后仅支持已在群内的好友邀请加群，且无需被邀请方同意或群主审批。详见",src:"产品文档"},{icon:"https://web.sdk.qcloud.com/im/assets/images/AVChatroom.svg",label:"直播群（AVChatroom）",type:gp.TYPES.GRP_AVCHATROOM,detail:"创建后可以随意进出，没有群成员数量上限，但不支持历史消息存储；适合与直播产品结合，用于弹幕聊天场景。详见",src:"产品文档"},{icon:"https://web.sdk.qcloud.com/im/assets/images/Community.png",label:"社群（Community）",type:gp.TYPES.GRP_COMMUNITY,detail:"创建后可以随意进出，最多支持100000人，支持历史消息存储，用户搜索群 ID 发起加群申请后，无需管理员审批即可进群。详见",src:"产品文档"}],Yy=e=>Ky.filter((t=>t.type===e))[0],$y=ee(e.defineComponent({__name:"index",props:{groupType:{type:String,default:""}},emits:["selectType"],setup(t,{emit:n}){const o=t,a=Ky,i=e.ref(),r=n;e.watchEffect((()=>{i.value=o.groupType}));return(t,n)=>(e.openBlock(),e.createElementBlock("ul",{class:"group-introduction-list select"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),((t,o)=>(e.openBlock(),e.createElementBlock("li",{key:o,class:e.normalizeClass(["select-item",[e.unref(i)===t.type&&"selected"]]),onClick:e=>(e=>{i.value=e.type,r("selectType",e.type)})(t)},[e.createElementVNode("main",{class:"select-item-type"},[e.createElementVNode("div",{class:"select-item-header"},[e.createElementVNode("aside",{class:"left"},[e.createVNode(fh,{class:"icon",file:t.icon},null,8,["file"]),e.createElementVNode("span",{class:"select-item-label"},e.toDisplayString(e.unref(vp).t(`TUIGroup.${t.label}`)),1)]),e.unref(i)===t.type?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref(u_)},null,8,["file"])):e.createCommentVNode("",!0)]),e.createElementVNode("span",{class:"select-item-detail"},e.toDisplayString(e.unref(vp).t(`TUIGroup.${t.detail}`)),1),e.createElementVNode("a",{class:"link",href:e.unref(C_).product.url,target:"_blank",onClick:n[0]||(n[0]=t=>{return n=e.unref(C_).product.url,void(eh||null==bp||bp.open(n));var n})},e.toDisplayString(e.unref(vp).t(`TUIGroup.${t.src}`)),9,["href"])])],10,["onClick"])))),128))]))}}),[["__scopeId","data-v-ade6dc43"]]);class Wy{constructor(){_t.registerService(nt.TUIGroup.SERVICE.NAME,this),_t.registerExtension(nt.TUIChat.EXTENSION.CHAT_HEADER.EXT_ID,this),this.onCallParamsMap=new Map,this.onCallCallbackMap=new Map,this.constants=nt}static getInstance(){return Wy.instance||(Wy.instance=new Wy),Wy.instance}getOnCallParams(e){return this.onCallParamsMap.get(e)}getOnCallCallback(e){return this.onCallCallbackMap.get(e)}onCall(e,t,n){return __async(this,null,(function*(){switch(this.onCallParamsMap.set(e,t),this.onCallCallbackMap.set(e,n),e){case nt.TUIGroup.SERVICE.METHOD.CREATE_GROUP:mp.update(tu.GRP,"isShowCreateComponent",!0),eh&&(null==bp||bp.reLaunch({url:"/TUIKit/components/TUIGroup/index"}));break;case nt.TUIGroup.SERVICE.METHOD.OPEN_GROUP_MANAGEMENT:Cp.switchGroup(t.groupID),mp.update(tu.GRP,"isShowManageComponent",!0),eh&&(null==bp||bp.navigateTo({url:"/TUIKit/components/TUIGroup/index"}));break;case nt.TUIGroup.SERVICE.METHOD.SELECT_GROUP_MEMBER:Cp.switchGroup(t.groupID),mp.update(tu.GRP,"isShowSelectComponent",!0),eh&&(null==bp||bp.navigateTo({url:"/TUIKit/components/TUIGroup/index"}))}}))}onGetExtension(e){const t=[];if(e===nt.TUIChat.EXTENSION.CHAT_HEADER.EXT_ID)t.push({weight:100,icon:"/assets/setting.a15e5daf.svg",text:"更多",data:{},listener:{onClicked:this.groupManage.bind(this)}});return t}groupManage(e){_t.callService({serviceName:nt.TUIGroup.SERVICE.NAME,method:nt.TUIGroup.SERVICE.METHOD.OPEN_GROUP_MANAGEMENT,params:e,callback:()=>{eh&&(null==bp||bp.navigateBack())}})}}const Zy=ee(e.defineComponent({__name:"index",setup(t){const n=Wy.getInstance(),o=n.constants,a=e.reactive({profile:{groupID:"",name:"",type:Ky[0].type,avatar:Ky[0].icon,introduction:"",notification:"",memberList:[],isSupportTopic:!1},groupConfig:{title:"",value:"",key:"",type:"",placeholder:""},isEdit:!1});e.watchEffect((()=>{const e=n.getOnCallParams(o.TUIGroup.SERVICE.METHOD.CREATE_GROUP);a.profile.memberList=e.memberList,a.groupConfig.title=e.title}));const i=e.computed((()=>Yy(a.profile.type))),r=e.computed((()=>{let e="添加群聊";return a.isEdit&&(e=a.groupConfig.title),vp.t(`TUIGroup.${e}`)})),s=e.computed((()=>{const e={name:vp.t("TUIGroup.群名称"),key:"name",placeholder:vp.t("TUIGroup.请输入群名称")},t={name:`${vp.t("TUIGroup.群ID")}(${vp.t("TUIGroup.选填")})`,key:"groupID",placeholder:vp.t("TUIGroup.请输入群ID")};return a.profile.type===gp.TYPES.GRP_COMMUNITY?[e]:[e,t]})),l=e.computed((()=>""===a.profile.name&&!a.isEdit)),c=e=>{a.profile.type!==e&&(a.profile.type=e,a.profile.avatar=Yy(e).icon,a.isEdit&&(a.groupConfig.value=e))},u=e=>__async(this,null,(function*(){try{e.memberList=e.memberList.map((e=>({userID:e.userID}))),e.type===gp.TYPES.GRP_COMMUNITY&&delete e.groupID;const t=yield Cp.createGroup(e),{type:n}=t.data.group;n===gp.TYPES.GRP_AVCHATROOM&&(yield Cp.joinGroup({groupID:t.data.group.groupID,applyMessage:""})),f(t.data.group),tf({message:vp.t("TUIGroup.群组创建成功"),type:Jh})}catch(t){tf({message:t.message,type:Qh})}})),d=()=>{const{profile:e}=a;if(a.isEdit)return a.profile[a.groupConfig.key]=a.groupConfig.value,a.isEdit=!a.isEdit;u(e)},p=()=>{if(a.isEdit)return a.isEdit=!a.isEdit;f(null)},h=e=>{switch(a.isEdit=!a.isEdit,a.groupConfig.key=e,a.groupConfig.value=a.profile[e],e){case"name":a.groupConfig.title="设置群名称",a.groupConfig.placeholder="请输入群名称",a.groupConfig.type="input";break;case"groupID":a.groupConfig.title="设置群ID",a.groupConfig.placeholder="请输入群ID",a.groupConfig.type="input";break;case"type":a.groupConfig.title="选择群类型",a.groupConfig.type="select"}},f=e=>{mp.update(tu.GRP,"isShowCreateComponent",!1);const t=n.getOnCallCallback(o.TUIGroup.SERVICE.METHOD.CREATE_GROUP);t&&t(e)};return(t,n)=>(e.openBlock(),e.createBlock(Fv,{show:!0,isH5:!e.unref(Zp),isHeaderShow:!1,isFooterShow:!1,background:!1,"onUpdate:show":p},{default:e.withCtx((()=>[e.createElementVNode("div",{class:e.normalizeClass(["group",[e.unref(Zp)?"":"group-h5"]])},[e.createElementVNode("div",{class:"group-box"},[e.createElementVNode("header",{class:"group-box-header"},[e.createVNode(fh,{file:e.unref(Zp)?e.unref(Uv):e.unref(dh),class:"icon-close",size:"16px",onOnClick:p},null,8,["file"]),e.createElementVNode("h1",{class:"group-box-header-title"},e.toDisplayString(e.unref(r)),1)]),e.unref(a).isEdit?(e.openBlock(),e.createElementBlock("div",{key:1,class:"group-list group-list-edit"},["input"===e.unref(a).groupConfig.type?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,"onUpdate:modelValue":n[1]||(n[1]=t=>e.unref(a).groupConfig.value=t),class:"group-name-input",type:"text",placeholder:e.unref(vp).t(`TUIGroup.${e.unref(a).groupConfig.placeholder}`)},null,8,["placeholder"])),[[e.vModelText,e.unref(a).groupConfig.value]]):(e.openBlock(),e.createBlock($y,{key:1,class:"group-introduction-list",groupType:e.unref(a).groupConfig.value,onSelectType:c},null,8,["groupType"]))])):(e.openBlock(),e.createElementBlock("ul",{key:0,class:"group-list"},[e.createElementVNode("li",{class:"group-list-item"},[e.createElementVNode("label",{class:"group-list-item-label"},e.toDisplayString(e.unref(vp).t("TUIGroup.群头像")),1),e.createVNode(mh,{url:e.unref(a).profile.avatar},null,8,["url"])]),e.createElementVNode("ul",null,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(s),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"group-list-item"},[e.createElementVNode("label",{class:"group-list-item-label"},e.toDisplayString(t.name),1),e.unref(Zp)?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,"onUpdate:modelValue":n=>e.unref(a).profile[t.key]=n,type:"text",placeholder:t.placeholder},null,8,["onUpdate:modelValue","placeholder"])),[[e.vModelText,e.unref(a).profile[t.key]]]):(e.openBlock(),e.createElementBlock("span",{key:1,class:"group-h5-list-item-content",onClick:e=>h(t.key)},[e.createElementVNode("p",{class:"content"},e.toDisplayString(e.unref(a).profile[t.key]),1),e.createVNode(fh,{file:e.unref(dy)},null,8,["file"])],8,["onClick"]))])))),128)),e.createElementVNode("li",{class:"group-list-introduction"},[e.createElementVNode("div",{class:"group-list-item"},[e.createElementVNode("label",{class:"group-list-item-label"},e.toDisplayString(e.unref(vp).t("TUIGroup.群类型")),1),e.unref(Zp)?(e.openBlock(),e.createBlock($y,{key:0,groupType:e.unref(a).profile.type,onSelectType:c},null,8,["groupType"])):(e.openBlock(),e.createElementBlock("span",{key:1,class:"group-h5-list-item-content",onClick:n[0]||(n[0]=e=>h("type"))},[e.createElementVNode("p",{class:"content"},e.toDisplayString(e.unref(i).label),1),e.createVNode(fh,{file:e.unref(dy)},null,8,["file"])]))]),e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("article",{key:0,class:"group-h5-list-item-introduction"},[e.createElementVNode("label",{class:"introduction-name"},e.toDisplayString(e.unref(i).label)+"：",1),e.createElementVNode("span",{class:"introduction-detail"},e.toDisplayString(e.unref(i).detail),1),e.createElementVNode("a",{href:e.unref(C_).product.url,target:"view_window"},e.toDisplayString(e.unref(vp).t(`TUIGroup.${e.unref(i).src}`)),9,["href"])]))])])])),e.createElementVNode("footer",{class:"group-profile-footer"},[e.unref(Zp)&&!e.unref(a).isEdit?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn-default",onClick:p},e.toDisplayString(e.unref(vp).t("TUIGroup.取消")),1)):e.createCommentVNode("",!0),e.createElementVNode("button",{class:"btn-submit",disabled:e.unref(l),onClick:d},e.toDisplayString(e.unref(vp).t("TUIGroup.确认")),9,["disabled"])])])],2)])),_:1},8,["isH5"]))}}),[["__scopeId","data-v-9db73b24"]]),Jy=ee(e.defineComponent({__name:"index",props:{show:{type:Boolean,default:()=>!1}},emits:["update:show"],setup(t,{emit:n}){const o=t,a=e.ref(!1);e.watchEffect((()=>{a.value=o.show}));const i=n,r=()=>{a.value=!a.value,i("update:show",a.value)};return(t,n)=>e.unref(a)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"mask",onClick:n[0]||(n[0]=e.withModifiers((t=>!e.unref(Xp)&&r),["self"]))},[e.renderSlot(t.$slots,"default",{},void 0,!0)])):e.createCommentVNode("",!0)}}),[["__scopeId","data-v-88e2dfe4"]]),Xy=ee(e.defineComponent({__name:"manage-name",props:{data:{type:Object,default:()=>({})},isAuthor:{type:Boolean,default:!1}},emits:["update"],setup(t,{emit:n}){const o=t,a=e.ref({}),i=e.ref(""),r=e.ref(!1),s=e.ref(null);e.watchEffect((()=>{a.value=o.data}));const l=n,c=()=>{i.value?(i.value!==a.value.name&&(l("update",{key:"name",value:i.value}),a.value.name=i.value,i.value="",tf({message:vp.t("TUIGroup.群名称修改成功"),type:Jh})),u()):tf({message:vp.t("TUIGroup.群名称不能为空"),type:Qh})},u=()=>{o.isAuthor&&(r.value=!r.value),r.value&&(i.value=a.value.name)};return e.watch((()=>r.value),(t=>{t&&e.nextTick((()=>{var e;null==(e=s.value)||e.focus()}))})),(n,o)=>(e.openBlock(),e.createElementBlock("div",{class:"group-name"},[e.createElementVNode("label",null,e.toDisplayString(e.unref(vp).t("TUIGroup.群名称")),1),e.unref(r)?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass({"edit-h5":e.unref(th)})},[e.createElementVNode("main",{class:"edit-h5-main"},[e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("header",{key:0,class:"edit-h5-header"},[e.createElementVNode("aside",{class:"left"},[e.createElementVNode("h1",null,e.toDisplayString(e.unref(vp).t("TUIGroup.修改群聊名称")),1),e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("TUIGroup.修改群聊名称后，将在群内通知其他成员")),1)]),e.createElementVNode("span",{class:"close",onClick:u},e.toDisplayString(e.unref(vp).t("关闭")),1)])),e.createElementVNode("div",{class:"input-box"},[e.unref(r)?e.withDirectives((e.openBlock(),e.createElementBlock("input",{key:0,ref_key:"nameInputRef",ref:s,"onUpdate:modelValue":o[0]||(o[0]=t=>e.isRef(i)?i.value=t:null),class:"input",type:"text",onBlur:c},null,544)),[[e.vModelText,e.unref(i)]]):e.createCommentVNode("",!0),e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("span",{key:1,class:"tip"},e.toDisplayString(e.unref(vp).t("TUIGroup.仅限中文、字母、数字和下划线，2-20个字")),1))]),e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("footer",{key:1,class:"edit-h5-footer"},[e.createElementVNode("button",{class:"btn",onClick:c},e.toDisplayString(e.unref(vp).t("确认")),1)]))])],2)):e.createCommentVNode("",!0),e.unref(r)&&e.unref(Zp)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("p",{key:1,class:"name",onClick:u},[e.createElementVNode("span",null,e.toDisplayString(e.unref(a).name),1),t.isAuthor?(e.openBlock(),e.createBlock(fh,{key:0,class:"icon",file:e.unref(zy),width:"14px",height:"14px"},null,8,["file"])):e.createCommentVNode("",!0)]))]))}}),[["__scopeId","data-v-6019ae09"]]),Qy=ee(e.defineComponent({__name:"manage-notification",props:{data:{type:Object,default:()=>({})},isAuthor:{type:Boolean,default:!1}},emits:["update","close"],setup(t,{emit:n}){const o=t,a=e.ref({}),i=e.ref(""),r=e.ref(!1),s=e.ref(!1);e.watchEffect((()=>{a.value=o.data,i.value=a.value.notification,r.value=o.isAuthor}));const l=n,c=()=>{i.value.length>150?tf({message:vp.t("TUIGroup.群公告字数超出限制，最大长度为150"),type:Qh}):(i.value&&i.value!==a.value.notification&&(l("update",{key:"notification",value:i.value}),e.nextTick((()=>{i.value=""}))),s.value=!s.value)};return(t,n)=>e.unref(eh)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"edit-h5"},[e.createElementVNode("main",{class:"edit-h5-main"},[e.createElementVNode("header",{class:"edit-h5-header"},[e.createElementVNode("aside",{class:"left"},[e.createElementVNode("h1",null,e.toDisplayString(e.unref(vp).t("TUIGroup.群公告")),1)]),e.createElementVNode("span",{class:"close",onClick:n[2]||(n[2]=e=>{l("close","notification")})},e.toDisplayString(e.unref(vp).t("关闭")),1)]),e.createElementVNode("div",{class:"notification"},[e.unref(s)?e.withDirectives((e.openBlock(),e.createElementBlock("textarea",{key:0,"onUpdate:modelValue":n[3]||(n[3]=t=>e.isRef(i)?i.value=t:null),class:e.normalizeClass([e.unref(eh)?"uni-height":"","textarea"]),onKeyup:e.withKeys(c,["enter"])},null,34)),[[e.vModelText,e.unref(i)]]):(e.openBlock(),e.createElementBlock("section",{key:1,class:"row"},[e.unref(a).notification?(e.openBlock(),e.createElementBlock("article",{key:1},e.toDisplayString(e.unref(a).notification),1)):(e.openBlock(),e.createElementBlock("p",{key:0,class:"row-p"},e.toDisplayString(e.unref(vp).t("TUIGroup.暂无公告")),1))])),e.unref(r)?(e.openBlock(),e.createElementBlock("footer",{key:2,class:"footer"},[e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn",onClick:c},e.toDisplayString(e.unref(vp).t("TUIGroup.发布")),1)):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn",onClick:n[4]||(n[4]=t=>s.value=!e.unref(s))},e.toDisplayString(e.unref(vp).t("TUIGroup.编辑")),1))])):e.createCommentVNode("",!0)])])])):(e.openBlock(),e.createElementBlock("main",{key:0,class:"notification"},[e.unref(s)?e.withDirectives((e.openBlock(),e.createElementBlock("textarea",{key:0,"onUpdate:modelValue":n[0]||(n[0]=t=>e.isRef(i)?i.value=t:null),class:"textarea",onKeyup:e.withKeys(c,["enter"])},null,544)),[[e.vModelText,e.unref(i)]]):(e.openBlock(),e.createElementBlock("section",{key:1},[e.unref(a).notification?(e.openBlock(),e.createElementBlock("article",{key:1},e.toDisplayString(e.unref(a).notification),1)):(e.openBlock(),e.createElementBlock("p",{key:0},e.toDisplayString(e.unref(vp).t("TUIGroup.暂无公告")),1))])),e.unref(r)?(e.openBlock(),e.createElementBlock("footer",{key:2},[e.unref(s)?(e.openBlock(),e.createElementBlock("button",{key:0,class:"btn",onClick:c},e.toDisplayString(e.unref(vp).t("TUIGroup.发布")),1)):(e.openBlock(),e.createElementBlock("button",{key:1,class:"btn",onClick:n[1]||(n[1]=t=>s.value=!e.unref(s))},e.toDisplayString(e.unref(vp).t("TUIGroup.编辑")),1))])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-add31611"]]),eI="/assets/del-icon.e0d1d417.svg",tI=ee(e.defineComponent({__name:"manage-member",props:{list:{type:Array,default:()=>[]},total:{type:Number,default:()=>0},isShowDel:{type:Boolean,default:()=>!1},self:{type:Object,default:()=>({})}},emits:["more","del","handleMemberProfileShow","close"],setup(t,{emit:n}){const o=t,a=e.ref(0),i=e.ref([]),r=e.ref(!1),s=e.ref({});e.watchEffect((()=>{a.value=o.total,r.value=o.isShowDel,i.value=o.list,s.value=o.self}));const l=n,c=e=>{let t="";switch(null==e?void 0:e.role){case gp.TYPES.GRP_MBR_ROLE_ADMIN:t=vp.t("TUIGroup.管理员");break;case gp.TYPES.GRP_MBR_ROLE_OWNER:t=vp.t("TUIGroup.群主")}return t&&(t=`(${t})`),e.userID===s.value.userID&&(t+=` (${vp.t("TUIGroup.我")})`),t},u=()=>{l("more")},d=e=>{l("del",[e])},p=e=>{l("handleMemberProfileShow",e)};return(t,n)=>e.unref(eh)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"edit-h5"},[e.createElementVNode("main",{class:"main"},[e.createElementVNode("header",{class:"edit-h5-header"},[e.createElementVNode("aside",{class:"left"},[e.createElementVNode("h1",null,e.toDisplayString(e.unref(vp).t("TUIGroup.群成员")),1)]),e.createElementVNode("span",{class:"close",onClick:n[0]||(n[0]=e=>{l("close","member")})},e.toDisplayString(e.unref(vp).t("关闭")),1)]),e.createElementVNode("div",{class:"member"},[e.createElementVNode("ul",{class:"list list-uniapp"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"list-item"},[e.createElementVNode("aside",{class:"aside",onClick:e=>p(t)},[e.createElementVNode("img",{class:"avatar",src:t.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"]),e.createElementVNode("span",{class:"name"},e.toDisplayString(t.nick||t.userID),1),e.createElementVNode("span",null,e.toDisplayString(c(t)),1)],8,["onClick"]),e.createElementVNode("div",{onClick:e=>d(t)},["Owner"!==t.role&&e.unref(r)?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref(eI),width:"16px",height:"16px"},null,8,["file"])):e.createCommentVNode("",!0)],8,["onClick"])])))),128)),e.unref(i).length<e.unref(a)?(e.openBlock(),e.createElementBlock("li",{key:0,class:"list-item",onClick:u},e.toDisplayString(e.unref(vp).t("TUIGroup.查看更多")),1)):e.createCommentVNode("",!0)])])])])):(e.openBlock(),e.createElementBlock("main",{key:0,class:"member"},[e.createElementVNode("ul",{class:"list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i),((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"list-item"},[e.createElementVNode("aside",{class:"aside",onClick:e=>p(t)},[e.createElementVNode("img",{class:"avatar",src:t.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"]),e.createElementVNode("span",{class:"name"},e.toDisplayString(t.nick||t.userID),1),e.createElementVNode("span",null,e.toDisplayString(c(t)),1)],8,["onClick"]),e.createElementVNode("div",{onClick:e=>d(t)},["Owner"!==t.role&&e.unref(r)?(e.openBlock(),e.createBlock(fh,{key:0,file:e.unref(eI),width:"16px",height:"16px"},null,8,["file"])):e.createCommentVNode("",!0)],8,["onClick"])])))),128)),e.unref(i).length<e.unref(a)?(e.openBlock(),e.createElementBlock("li",{key:0,class:"list-item",onClick:u},e.toDisplayString(e.unref(vp).t("TUIGroup.查看更多")),1)):e.createCommentVNode("",!0)])]))}}),[["__scopeId","data-v-63b3eefe"]]),nI=ee(e.defineComponent({__name:"manage-profile",props:{userInfo:{type:Object,default:()=>({})}},emits:["handleSwitchConversation","close","openConversation"],setup(t,{emit:n}){const o=t,a=e.ref(!1),i=e.ref({});e.watchEffect((()=>{i.value=o.userInfo}));const r=n;e.watch((()=>o.userInfo),((e,t)=>__async(this,null,(function*(){if(e===t)return;const n=yield yp.getUserProfile({userIDList:[o.userInfo.userID]});i.value=null==n?void 0:n.data[0],l()}))),{deep:!0,immediate:!0});const s=(e,t)=>__async(this,null,(function*(){const n=`${t}${e}`;_p.getConversationProfile(n).then((e=>{_p.switchConversation(e.data.conversation.conversationID).then((()=>{mp.update(tu.GRP,"isShowManageComponent",!1),eh&&(null==bp||bp.navigateBack())}))})).catch((e=>{oe("warn","at TUIKit/components/TUIGroup/manage-group/manage-profile.vue:147","获取会话资料失败",e.code,e.msg)}))})),l=()=>__async(this,null,(function*(){i.value.userID&&kp.checkFriend({userIDList:[i.value.userID],type:gp.TYPES.SNS_CHECK_TYPE_BOTH}).then((e=>{var t,n,o;const i=null==(o=null==(n=null==(t=null==e?void 0:e.data)?void 0:t.successUserIDList)?void 0:n[0])?void 0:o.relation;a.value=i===gp.TYPES.SNS_TYPE_BOTH_WAY}))})),c=()=>a.value||!mp.getData(tu.APP,"isOfficial");return(t,n)=>e.unref(eh)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"edit-h5"},[e.createElementVNode("main",{class:"main"},[e.createElementVNode("header",{class:"edit-h5-header"},[e.createElementVNode("aside",{class:"left"},[e.createElementVNode("h1",null,e.toDisplayString(e.unref(vp).t("TUIGroup.群成员")),1)]),e.createElementVNode("span",{class:"close",onClick:n[1]||(n[1]=e=>{r("close","profile")})},e.toDisplayString(e.unref(vp).t("关闭")),1)]),e.createElementVNode("div",{class:"edit-h5-profile"},[e.createElementVNode("div",{class:"memeber-profile-main"},[e.createVNode(mh,{class:"avatar",url:e.unref(i).avatar,size:"60px"},null,8,["url"]),e.createElementVNode("ul",{class:"list"},[e.createElementVNode("h1",null,e.toDisplayString(e.unref(i).nick||e.unref(i).userID),1),e.createElementVNode("li",null,[e.createElementVNode("label",null,"ID："),e.createElementVNode("span",null,e.toDisplayString(e.unref(i).userID),1)]),e.createElementVNode("li",null,[e.createElementVNode("label",null,e.toDisplayString(e.unref(vp).t("TUIContact.个性签名"))+"：",1),e.createElementVNode("span",null,e.toDisplayString(e.unref(i).selfSignature),1)])])]),e.createElementVNode("div",{class:"memeber-profile-footer"},[c()?(e.openBlock(),e.createElementBlock("div",{key:0,class:"button",onClick:n[2]||(n[2]=t=>s(e.unref(i).userID,"C2C"))},e.toDisplayString(e.unref(vp).t("TUIContact.发送消息")),1)):e.createCommentVNode("",!0)])])])])):(e.openBlock(),e.createElementBlock("div",{key:0,class:"memeber-profile"},[e.createElementVNode("div",{class:"memeber-profile-main"},[e.createElementVNode("img",{class:"avatar",src:e.unref(i).avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"]),e.createElementVNode("ul",{class:"list"},[e.createElementVNode("h2",null,e.toDisplayString(e.unref(i).nick||e.unref(i).userID),1),e.createElementVNode("li",null,[e.createElementVNode("label",null,"ID："),e.createElementVNode("span",null,e.toDisplayString(e.unref(i).userID),1)]),e.createElementVNode("li",null,[e.createElementVNode("label",null,e.toDisplayString(e.unref(vp).t("TUIContact.个性签名"))+"：",1),e.createElementVNode("span",null,e.toDisplayString(e.unref(i).selfSignature),1)])])]),e.createElementVNode("div",{class:"memeber-profile-footer"},[c()?(e.openBlock(),e.createElementBlock("div",{key:0,class:"button",onClick:n[0]||(n[0]=t=>s(e.unref(i).userID,"C2C"))},e.toDisplayString(e.unref(vp).t("TUIContact.发送消息")),1)):e.createCommentVNode("",!0)])]))}}),[["__scopeId","data-v-de594aee"]]),oI=ee(e.defineComponent({__name:"index",props:{open:{type:Boolean,default:!1}},emits:["change"],setup(t,{emit:n}){const o=t,a=e.ref(!1),i=n;e.watchEffect((()=>{a.value=o.open}));const r=()=>{a.value=!a.value,i("change",a.value)};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["slider-box",[e.unref(a)&&"slider-open"]]),onClick:r},[e.createElementVNode("span",{class:"slider-block"})],2))}}),[["__scopeId","data-v-d8c9afbe"]]),aI="/assets/plus.dfad243b.svg",iI="/assets/minus.28312fe8.svg",rI=ee(e.defineComponent({__name:"manage-admin",props:{member:{type:Object,default:()=>{}},isSetMuteTime:{type:Boolean,default:()=>!1},currentGroup:{type:Object,default:()=>{}}},emits:["addAdmin","removeAdmin","setAllMuteTime","addMute","removeMute","close"],setup(t,{emit:n}){const o=t,a=e.ref(!1),i=e.ref({admin:[],member:[],muteMember:[]}),r=e.ref();e.watchEffect((()=>{i.value=o.member,a.value=o.isSetMuteTime,r.value=o.currentGroup}));const s=n,l=()=>{s("addAdmin")},c=()=>{s("removeAdmin")},u=e=>{s("setAllMuteTime",e)},d=()=>{s("addMute")},p=()=>{s("removeMute")};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{class:"admin-main"},[e.createElementVNode("div",{class:"admin-manage"},[e.createElementVNode("div",{class:"admin-manage-header"},e.toDisplayString(e.unref(vp).t("TUIGroup.群管理员")),1),e.createElementVNode("ul",{class:"admin-manage-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i).admin,((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"admin-manage-list-item"},[e.createElementVNode("div",{class:"item-main"},[e.createElementVNode("img",{class:"item-main-avatar",src:t.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"])]),e.createElementVNode("div",{class:"item-name"},e.toDisplayString(t.nick||t.userID),1)])))),128)),e.createElementVNode("li",{class:"admin-manage-list-item"},[e.createElementVNode("div",{class:"item-main",onClick:l},[e.createVNode(fh,{file:e.unref(aI),width:"16px",height:"16px"},null,8,["file"])])]),e.createElementVNode("li",{class:"admin-manage-list-item"},[e.unref(i).admin.length>0?(e.openBlock(),e.createElementBlock("div",{key:0,class:"item-main",onClick:c},[e.createVNode(fh,{file:e.unref(iI),width:"16px",height:"16px"},null,8,["file"])])):e.createCommentVNode("",!0)])])]),e.unref(a)?(e.openBlock(),e.createElementBlock("div",{key:0,class:"admin-mute-all"},[e.createElementVNode("div",null,[e.createElementVNode("div",{class:"admin-mute-all-title"},e.toDisplayString(e.unref(vp).t("TUIGroup.全员禁言")),1),e.createElementVNode("div",{class:"admin-mute-all-content"},e.toDisplayString(e.unref(vp).t("TUIGroup.全员禁言开启后，只允许群主和管理员发言。")),1)]),e.createVNode(oI,{open:e.unref(r).muteAllMembers,onChange:u},null,8,["open"])])):e.createCommentVNode("",!0),e.unref(a)?(e.openBlock(),e.createElementBlock("div",{key:1,class:"admin-mute"},[e.createElementVNode("div",{class:"admin-mute-header"},e.toDisplayString(e.unref(vp).t("TUIGroup.单独禁言人员")),1),e.createElementVNode("ul",{class:"admin-mute-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(i).muteMember,((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"admin-mute-list-item"},[e.createElementVNode("div",{class:"item-main"},[e.createElementVNode("img",{class:"item-main-avatar",src:t.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"])]),e.createElementVNode("div",{class:"item-name"},e.toDisplayString(t.nick||t.userID),1)])))),128)),e.createElementVNode("li",{class:"admin-mute-list-item"},[e.createElementVNode("div",{class:"item-main",onClick:d},[e.createVNode(fh,{file:e.unref(aI),width:"16px",height:"16px"},null,8,["file"])])]),e.createElementVNode("li",{class:"admin-mute-list-item"},[e.unref(i).muteMember.length>0?(e.openBlock(),e.createElementBlock("div",{key:0,class:"item-main",onClick:p},[e.createVNode(fh,{file:e.unref(iI),width:"16px",height:"16px"},null,8,["file"])])):e.createCommentVNode("",!0)])])])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-158ad806"]]),sI=e.defineComponent({__name:"index",props:{groupID:{type:String,default:""},groupCurrentTab:{type:String,default:""}},setup(t){const n=Wy.getInstance(),o=n.constants,a=t,i=e.ref(void 0),r=e.ref(""),s=e.ref(""),l=e.ref(""),c=e.ref(!1),u=e.ref(""),d=e.ref({list:[]}),p=e.ref({}),h=e.ref({[gp.TYPES.GRP_WORK]:"好友工作群",[gp.TYPES.GRP_PUBLIC]:"陌生人社交群",[gp.TYPES.GRP_MEETING]:"临时会议群",[gp.TYPES.GRP_AVCHATROOM]:"直播群",[gp.TYPES.GRP_COMMUNITY]:"社群",[gp.TYPES.JOIN_OPTIONS_FREE_ACCESS]:"自由加入",[gp.TYPES.JOIN_OPTIONS_NEED_PERMISSION]:"需要验证",[gp.TYPES.JOIN_OPTIONS_DISABLE_APPLY]:"禁止加群"}),f=e.ref({admin:[],member:[],muteMember:[]}),g=e.ref([]),m=e.ref(""),v=e.ref(!1),_=e.ref(!1),y=e.ref([]),I=e.ref(!1),C=e.ref([]),k=e.ref([]),E=e.ref(),T=e.ref(""),S=e.ref("");e.onMounted((()=>{e.nextTick((()=>{i.value&&!eh&&Kp.listen({domRefs:i.value,handler:te})}))})),mp.watch(tu.GRP,{currentGroup:e=>{var t,n;e&&(E.value=e,T.value=null==(n=null==(t=E.value)?void 0:t.selfInfo)?void 0:n.role)},currentGroupMemberList:e=>{C.value=e,f.value={admin:[],member:[],muteMember:[]},Array.from(e).map((e=>{switch(null==e?void 0:e.role){case gp.TYPES.GRP_MBR_ROLE_ADMIN:f.value.admin.push(e);break;case gp.TYPES.GRP_MBR_ROLE_MEMBER:f.value.member.push(e)}return e}));const t=(new Date).getTime();f.value.muteMember=Array.from(e).filter((e=>1e3*(null==e?void 0:e.muteUntil)-t>0))}}),mp.watch(tu.CONV,{currentConversation:e=>{var t;S.value=null==(t=null==e?void 0:e.groupProfile)?void 0:t.groupID}}),e.watchEffect((()=>{const e=n.getOnCallParams(o.TUIGroup.SERVICE.METHOD.OPEN_GROUP_MANAGEMENT);u.value=(null==e?void 0:e.groupID)||S.value,r.value=a.groupCurrentTab}));const M=e.computed((()=>{let e="";switch(r.value){case"notification":e="群公告";break;case"member":case"profile":e="群成员";break;default:e="群管理"}return e})),w=e.computed((()=>{var e,t;return(null==(t=null==(e=E.value)?void 0:e.selfInfo)?void 0:t.role)===gp.TYPES.GRP_MBR_ROLE_OWNER})),b=e.computed((()=>{var e,t;return(null==(t=null==(e=E.value)?void 0:e.selfInfo)?void 0:t.role)===gp.TYPES.GRP_MBR_ROLE_OWNER})),D=e.computed((()=>{var e;return(null==(e=E.value)?void 0:e.type)===gp.TYPES.GRP_WORK})),N=e.computed((()=>!(D.value||!w.value&&!b.value))),R=e.computed((()=>{var e;return!((null==(e=null==E?void 0:E.value)?void 0:e.type)===gp.TYPES.GRP_AVCHATROOM)})),L=e=>__async(this,null,(function*(){const{key:t,value:n}=e,o={groupID:E.value.groupID,[t]:n};Cp.updateGroupProfile(o).then((e=>{E.value=e.data.group,s.value=""})).catch((e=>{tf({message:null==e?void 0:e.message,type:Qh})}))})),A=e=>{r.value=e,s.value="","member"===r.value&&(l.value="remove"),r.value||(l.value="")},O=()=>{P()},P=e=>__async(this,null,(function*(){var t;y.value=[];let n=[];switch(e){case"add":_.value=!1,n=[...f.value.admin,...f.value.member].map((e=>e.userID)),g.value=(yield U()).filter((e=>e.userID&&n.indexOf(e.userID)<0)),m.value="添加成员";break;case"remove":_.value=!1,g.value=C.value.filter((e=>{var t,n;return e.userID!==(null==(n=null==(t=null==E?void 0:E.value)?void 0:t.selfInfo)?void 0:n.userID)})),m.value="删除成员";break;case"addAdmin":_.value=!0,g.value=f.value.member,m.value="新增管理员";break;case"removeAdmin":_.value=!0,g.value=f.value.admin,m.value="移除管理员";break;case"changeOwner":_.value=!0,g.value=[...f.value.admin,...f.value.member],m.value="转让群组";break;case"addMute":_.value=!0,g.value=f.value.member,"Owner"===E.value.selfInfo.role&&(g.value=[...f.value.admin,...f.value.member]),g.value=null==(t=null==g?void 0:g.value)?void 0:t.filter((e=>{var t,n;return(null==(n=null==(t=null==f?void 0:f.value)?void 0:t.muteMember)?void 0:n.indexOf(e))<0})),m.value="新增禁言用户";break;case"removeMute":_.value=!0,g.value=f.value.muteMember,m.value="移除禁言用户"}e&&(l.value=e),c.value=!c.value})),U=()=>__async(this,null,(function*(){return(yield kp.getFriendList()).data.map((e=>null==e?void 0:e.profile)).filter((e=>!d.value.list.some((t=>t.userID===e.userID))))})),x=e.computed((()=>{var e,t,n;const o=null==(t=null==(e=null==E?void 0:E.value)?void 0:e.selfInfo)?void 0:t.role,a=null==(n=null==E?void 0:E.value)?void 0:n.type;return o===gp.TYPES.GRP_MBR_ROLE_OWNER&&a!==gp.TYPES.GRP_WORK})),V=e.computed((()=>{var e;return(null==(e=null==E?void 0:E.value)?void 0:e.type)===gp.TYPES.GRP_WORK})),B=e.computed((()=>{var e,t;let n=3;return V.value||(n+=1),"Owner"!==(null==(t=null==(e=null==E?void 0:E.value)?void 0:e.selfInfo)?void 0:t.role)&&(n+=1),n})),G=e=>__async(this,null,(function*(){const e={groupID:u.value,count:100,offset:d.value.list.length};yield Cp.getGroupMemberList(e).then((e=>{d.value.list=[...d.value.list,...e.data.memberList]}))})),F=e=>{p.value=e,A("profile")},z=e=>{"remove"===l.value?(k.value=e,I.value=!I.value):Y(e,l.value),c.value=!1},H=e=>__async(this,null,(function*(){yield Cp.dismissGroup(e.groupID),Df("dismissGroup"),tf({message:vp.t("TUIGroup.群组解散成功"),type:Jh}),j()})),j=()=>{eh?null==bp||bp.switchTab({url:"/TUIKit/components/TUIConversation/index"}):(te(),_p.switchConversation())},q=e=>{L({key:"muteAllMembers",value:e}),e?(Df("muteGroup"),tf({message:vp.t("TUIGroup.禁言设置成功"),type:Jh})):tf({message:vp.t("TUIGroup.取消禁言成功"),type:Jh})},K=e=>__async(this,null,(function*(){var t,n;let o={},a={};const i={groupID:u.value,userIDList:[e]};switch(l.value){case"add":try{a=yield Cp.getGroupMemberProfile(i),g.value=g.value.filter((e=>{var t;return e.userID!==(null==(t=o.data[0])?void 0:t.userID)})),g.value=[...g.value,...o.data],(null==(t=null==a?void 0:a.data)?void 0:t.memberList.length)>0&&(g.value=g.value.map((e=>{var t;return e.userID===(null==(t=null==a?void 0:a.data)?void 0:t.memberList[0].userID)&&(e.isDisabled=!0),e})))}catch(nM){const t=vp.t("TUIGroup.该用户不存在");tf({message:t,type:Qh})}break;case"remove":try{if(o=yield Cp.getGroupMemberProfile(i),0===o.data.memberList.length){const e=vp.t("TUIGroup.该用户不在群组内");tf({message:e,type:Qh})}g.value=g.value.filter((e=>{var t,n;return e.userID!==(null==(n=null==(t=null==o?void 0:o.data)?void 0:t.memberList[0])?void 0:n.userID)})),(null==(n=null==o?void 0:o.data)?void 0:n.memberList.length)&&(g.value=[...g.value,...o.data.memberList])}catch(nM){const t=vp.t("TUIGroup.该用户不存在");tf({message:t,type:Qh})}}})),Y=(e,t)=>{const n=[];switch(e.map((e=>(n.push(e.userID),e))),t){case"add":$(n);break;case"remove":X(n);break;case"addAdmin":case"removeAdmin":J(e[0]);break;case"changeOwner":W(n[0]);break;case"addMute":Z(n[0],"add");break;case"removeMute":Z(n[0],"remove")}},$=e=>__async(this,null,(function*(){const t={groupID:u.value,userIDList:e};yield Cp.addGroupMember(t)})),W=e=>__async(this,null,(function*(){const t={groupID:u.value,newOwnerID:e},n=yield Cp.changeGroupOwner(t);E.value={},E.value=n.data.group})),Z=(e,t)=>__async(this,null,(function*(){const n={groupID:u.value,userID:e,muteTime:"add"===t?2592e3:0};yield Cp.setGroupMemberMuteTime(n)})),J=e=>__async(this,null,(function*(){let t="";switch(e.role){case gp.TYPES.GRP_MBR_ROLE_ADMIN:t=gp.TYPES.GRP_MBR_ROLE_MEMBER;break;case gp.TYPES.GRP_MBR_ROLE_MEMBER:t=gp.TYPES.GRP_MBR_ROLE_ADMIN}const n={groupID:u.value,userID:e.userID,role:t};yield Cp.setGroupMemberRole(n)})),X=e=>__async(this,null,(function*(){const t={groupID:u.value,userIDList:e,reason:""};yield Cp.deleteGroupMember(t)})),Q=e=>__async(this,null,(function*(){yield Cp.quitGroup(e.groupID),j()})),ee=()=>{r.value?A(""):te()},te=()=>{mp.update(tu.GRP,"isShowManageComponent",!1);const e=n.getOnCallCallback(o.TUIGroup.SERVICE.METHOD.OPEN_GROUP_MANAGEMENT);e&&e()};return(t,n)=>(e.openBlock(),e.createElementBlock("div",{ref_key:"manageRef",ref:i,class:"manage"},[e.unref(eh)&&"admin"!==e.unref(r)?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("header",{key:0,class:"manage-header"},[e.createVNode(fh,{file:e.unref(dh),onOnClick:ee},null,8,["file"]),e.createElementVNode("div",{class:"manage-header-content"},e.toDisplayString(e.unref(vp).t(`TUIGroup.${e.unref(M)}`)),1),e.createElementVNode("div")])),!e.unref(r)||e.unref(eh)&&"admin"!=e.unref(r)?(e.openBlock(),e.createElementBlock("main",{key:1,class:"main"},[e.createVNode(Xy,{class:"space-top",isAuthor:e.unref(w)||e.unref(b)||e.unref(D),data:e.unref(E),onUpdate:L},null,8,["isAuthor","data"]),e.createElementVNode("div",{class:"user-info space-top"},[e.createElementVNode("header",{class:"user-info-header",onClick:n[0]||(n[0]=e=>A("member"))},[e.createElementVNode("label",{class:"user-info-header-left"},e.toDisplayString(e.unref(vp).t("TUIGroup.群成员")),1),e.createElementVNode("div",{class:"user-info-header-right"},[e.createElementVNode("span",{class:"span"},e.toDisplayString(e.unref(E).memberCount||e.unref(C).length)+" "+e.toDisplayString(e.unref(vp).t("TUIGroup.人")),1),e.createVNode(fh,{file:e.unref(dy)},null,8,["file"])])]),e.createElementVNode("ol",{class:"user-info-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(C).slice(0,e.unref(B)),((t,n)=>(e.openBlock(),e.createElementBlock("dl",{key:n,class:"user-info-list-item"},[e.createElementVNode("dt",{class:"user-info-list-item-main",onClick:e=>F(t)},[e.createElementVNode("img",{class:"avatar",src:t.avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png'"},null,8,["src"])],8,["onClick"]),e.createElementVNode("dd",{class:"user-info-list-item-info"},e.toDisplayString(t.nick||t.userID),1)])))),128)),e.unref(V)?(e.openBlock(),e.createElementBlock("dl",{key:0,class:"user-info-list-item"},[e.createElementVNode("dt",{class:"avatar",onClick:n[1]||(n[1]=e=>P("add"))}," + ")])):e.createCommentVNode("",!0),"Owner"===e.unref(T)?(e.openBlock(),e.createElementBlock("dl",{key:1,class:"user-info-list-item"},[e.createElementVNode("dt",{class:"avatar",onClick:n[2]||(n[2]=e=>P("remove"))}," - ")])):e.createCommentVNode("",!0)])]),e.createElementVNode("ul",{class:"content list space-top",onClick:n[5]||(n[5]=e=>s.value="")},[e.createElementVNode("li",{class:"list-item",onClick:n[3]||(n[3]=e=>A("notification"))},[e.createElementVNode("aside",{class:"aside"},[e.createElementVNode("label",{class:"label"},e.toDisplayString(e.unref(vp).t("TUIGroup.群公告")),1),e.createElementVNode("article",{class:"article"},e.toDisplayString(e.unref(E).notification),1)]),e.createVNode(fh,{file:e.unref(dy),class:"end"},null,8,["file"])]),(e.unref(b)||e.unref(w))&&e.unref(N)?(e.openBlock(),e.createElementBlock("li",{key:0,class:"list-item",onClick:n[4]||(n[4]=e=>A("admin"))},[e.createElementVNode("label",{class:"label"},e.toDisplayString(e.unref(vp).t("TUIGroup.群管理")),1),e.createVNode(fh,{file:e.unref(dy)},null,8,["file"])])):e.createCommentVNode("",!0),e.createElementVNode("li",{class:"list-item"},[e.createElementVNode("label",{class:"label"},e.toDisplayString(e.unref(vp).t("TUIGroup.群ID")),1),e.createElementVNode("div",{class:"groupID"},[e.createElementVNode("span",{class:"span"},e.toDisplayString(e.unref(u)),1)])]),e.createElementVNode("li",{class:"list-item"},[e.createElementVNode("label",{class:"label"},e.toDisplayString(e.unref(vp).t("TUIGroup.群头像")),1),e.createElementVNode("img",{class:"avatar",src:e.unref(E).avatar||"https://web.sdk.qcloud.com/im/demo/TUIkit/web/img/constomer.svg",onerror:"this.onerror=null;this.src='https://web.sdk.qcloud.com/im/demo/TUIkit/web/img/constomer.svg'"},null,8,["src"])]),e.createElementVNode("li",{class:"list-item"},[e.createElementVNode("label",{class:"label"},e.toDisplayString(e.unref(vp).t("TUIGroup.群类型")),1),e.createElementVNode("span",{class:"span"},e.toDisplayString(e.unref(vp).t(`TUIGroup.${e.unref(h)[e.unref(E).type]}`)),1)]),e.createElementVNode("li",{class:"list-item"},[e.createElementVNode("label",{class:"label"},e.toDisplayString(e.unref(vp).t("TUIGroup.加群方式")),1),e.createElementVNode("span",{class:"span"},e.toDisplayString(e.unref(vp).t(`TUIGroup.${e.unref(h)[e.unref(E).joinOption]}`)),1)])]),e.createElementVNode("ul",{class:"footer list space-top"},["Owner"===e.unref(T)&&e.unref(C).length>1?(e.openBlock(),e.createElementBlock("li",{key:0,class:"list-item",onClick:n[6]||(n[6]=e.withModifiers((e=>P("changeOwner")),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIGroup.转让群组")),1)):e.createCommentVNode("",!0),e.unref(x)?(e.openBlock(),e.createElementBlock("li",{key:1,class:"list-item",onClick:n[7]||(n[7]=e.withModifiers((t=>H(e.unref(E))),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIGroup.解散群聊")),1)):(e.openBlock(),e.createElementBlock("li",{key:2,class:"list-item",onClick:n[8]||(n[8]=e.withModifiers((t=>Q(e.unref(E))),["stop"]))},e.toDisplayString(e.unref(vp).t("TUIGroup.退出群组")),1))])])):e.createCommentVNode("",!0),"member"===e.unref(r)?(e.openBlock(),e.createBlock(tI,{key:2,self:e.unref(E).selfInfo,list:e.unref(C),total:~~e.unref(E).memberCount,isShowDel:"Owner"===e.unref(T)&&e.unref(R),onMore:n[9]||(n[9]=e=>G()),onDel:z,onHandleMemberProfileShow:F,onClose:n[10]||(n[10]=e=>A(""))},null,8,["self","list","total","isShowDel"])):e.createCommentVNode("",!0),"profile"===e.unref(r)?(e.openBlock(),e.createBlock(nI,{key:3,userInfo:e.unref(p),onClose:n[11]||(n[11]=e=>A(""))},null,8,["userInfo"])):e.createCommentVNode("",!0),"notification"===e.unref(r)?(e.openBlock(),e.createBlock(Qy,{key:4,isAuthor:e.unref(w)||e.unref(b)||e.unref(D),data:e.unref(E),onUpdate:L,onClose:n[12]||(n[12]=e=>A(""))},null,8,["isAuthor","data"])):e.createCommentVNode("",!0),"admin"===e.unref(r)?e.withDirectives((e.openBlock(),e.createBlock(rI,{key:5,isSetMuteTime:e.unref(N),member:e.unref(f),currentGroup:e.unref(E),onAddAdmin:n[13]||(n[13]=e=>P("addAdmin")),onRemoveAdmin:n[14]||(n[14]=e=>P("removeAdmin")),onSetAllMuteTime:q,onAddMute:n[15]||(n[15]=e=>P("addMute")),onRemoveMute:n[16]||(n[16]=e=>P("removeMute")),onClose:n[17]||(n[17]=e=>A(""))},null,8,["isSetMuteTime","member","currentGroup"])),[[e.vShow,e.unref(b)]]):e.createCommentVNode("",!0),e.createVNode(Jy,{show:e.unref(c),"onUpdate:show":n[18]||(n[18]=e=>c.value=e)},{default:e.withCtx((()=>[e.createVNode(p_,{title:e.unref(vp).t(`TUIGroup.${e.unref(m)}`),list:e.unref(g),isSearch:e.unref(v),isRadio:e.unref(_),selectedList:e.unref(y),isH5:!e.unref(Zp),onSubmit:z,onCancel:O,onSearch:K},null,8,["title","list","isSearch","isRadio","selectedList","isH5"])])),_:1},8,["show"]),e.createVNode(Fv,{class:"deleted-dialog",title:e.unref(vp).t("TUIGroup.删除成员"),show:e.unref(I),isH5:!e.unref(Zp),center:!0,isHeaderShow:e.unref(Zp),onSubmit:n[19]||(n[19]=t=>Y(e.unref(k),"remove")),"onUpdate:show":n[20]||(n[20]=e=>I.value=e)},{default:e.withCtx((()=>[1===e.unref(k).length?(e.openBlock(),e.createElementBlock("p",{key:0,class:"del-dialog-title"},e.toDisplayString(e.unref(vp).t("TUIGroup.确定从群聊中删除该成员？")),1)):e.createCommentVNode("",!0),e.unref(k).length>1?(e.openBlock(),e.createElementBlock("p",{key:1,class:"del-dialog-title"},e.toDisplayString(e.unref(vp).t("TUIGroup.确定从群聊中删除所选成员？")),1)):e.createCommentVNode("",!0)])),_:1},8,["title","show","isH5","isHeaderShow"])],512))}}),lI=ee(sI,[["__scopeId","data-v-cbd83825"]]),cI=e.defineComponent({__name:"index",setup(t){const n=Wy.getInstance(),o=n.constants,a=e.ref(!1),i=e.ref([]),r=e.ref([]),s=e.ref({}),l=e.ref({groupID:"",isRadio:!1,isNeedSearch:!1,title:"",filterUserIDList:[]}),c=e.ref(null);e.watchEffect((()=>{const e=n.getOnCallParams(o.TUIContact.SERVICE.METHOD.SELECT_FRIEND);var t;l.value.groupID=e.groupID,l.value.title=e.title,l.value.isRadio=e.isRadio,l.value.isNeedSearch=e.isNeedSearch,l.value.filterUserIDList=e.filterUserIDList,e.isNeedSearch&&(t=e.isNeedSearch,c.value=_t.getService(o.TUISearch.SERVICE.NAME),c.value?a.value=t:oe("warn","at TUIKit/components/TUIGroup/select-member/index.vue:48","请添加 TUISearch 组件"))})),mp.watch(tu.GRP,{currentGroup:e=>{s.value=e},currentGroupMemberList:e=>{i.value=e.map((e=>{l.value.filterUserIDList.indexOf(e.userID)>-1&&(e.isDisabled=!0)})),r.value=i.value}});const u=()=>__async(this,null,(function*(){const e={groupID:s.value.groupID,count:100,offset:i.value.length};yield Cp.getGroupMemberList(e)})),d=e=>{mp.update(tu.GRP,"isShowSelectComponent",!1);const t=n.getOnCallCallback(o.TUIGroup.SERVICE.METHOD.SELECT_GROUP_MEMBER);t&&t(e)},p=()=>{tf({message:vp.t("TUIGroup.该用户不存在"),type:Qh}),r.value=[...i.value]},h=e=>__async(this,null,(function*(){if(!e)return r.value=i.value;try{const t=yield c.value.searchGroupMember(e);if(!t.data[0])return p();r.value=t.data;const n=i.value.filter((e=>e.userID===t.data[0].userID));i.value=n.length?i.value:[...i.value,...r.value]}catch(nM){return p()}}));return(t,n)=>(e.openBlock(),e.createBlock(wy,{isRadio:e.unref(l).isRadio,isNeedSearch:e.unref(l).isNeedSearch,title:e.unref(l).title,userList:e.unref(r),total:e.unref(s).memberCount,onGetMore:u,onSearch:h,onComplete:d},null,8,["isRadio","isNeedSearch","title","userList","total"]))}}),uI=ee(e.defineComponent({__name:"index",setup(t){const n=e.ref(!1),o=e.ref(!1),a=e.ref(!1);return mp.watch(tu.GRP,{isShowCreateComponent:e=>{n.value=!!e},isShowManageComponent:e=>{o.value=!!e},isShowSelectComponent:e=>{a.value=!!e}}),(t,i)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass([(e.unref(n)||e.unref(o)||e.unref(a))&&"tui-group"])},[e.unref(n)?(e.openBlock(),e.createBlock(Zy,{key:0})):e.createCommentVNode("",!0),e.unref(o)?(e.openBlock(),e.createBlock(lI,{key:1})):e.createCommentVNode("",!0),e.unref(a)?(e.openBlock(),e.createBlock(cI,{key:2})):e.createCommentVNode("",!0)],2))}}),[["__scopeId","data-v-d7656e83"]]);Wy.getInstance();const dI=new class e{constructor(){this.TUIComponents={},this.TUIPlugins={},this.TUICore=_t,this.TUIChatEngine=gp,this.TUIGlobal=bp,this.SDKAppID=0,this.TUIGlobal._isTIMCallKit=!0,_t.registerEvent(nt.TUILogin.EVENT.LOGIN_STATE_CHANGED,nt.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS,this),_t.registerEvent(nt.TUITranslate.EVENT.LANGUAGE_CHANGED,nt.TUITranslate.EVENT_SUB_KEY.CHANGE_SUCCESS,this),_t.registerService(nt.TUITranslatePlugin.SERVICE.NAME,1),_t.registerService(nt.TUIVoiceToTextPlugin.SERVICE.NAME,1)}onNotifyEvent(e,t,n){if(e===nt.TUILogin.EVENT.LOGIN_STATE_CHANGED&&t===nt.TUILogin.EVENT_SUB_KEY.USER_LOGIN_SUCCESS)this.login();if(e===nt.TUITranslate.EVENT.LANGUAGE_CHANGED&&t===nt.TUITranslate.EVENT_SUB_KEY.CHANGE_SUCCESS)(null==n?void 0:n.language)&&vp.changeLanguage(n.language)}init(){e.isInitialized||(e.isInitialized=!0,Qp&&new nh,vp.provideLanguages(__spreadValues({},sh)),vp.useI18n(),bp.TUIComponents=this.TUIComponents,bp.TUIPlugins=this.TUIPlugins,oe("warn","at TUIKit/server.ts:79","[TUIChatKit]: init success."))}login(){const{chat:e,SDKAppID:t,userID:n,userSig:o}=yt.getContext();return this.SDKAppID=t,this.TUIChatEngine.login({chat:e,SDKAppID:t,userID:n,userSig:o}),this.chat=e,this.TUIChatEngine}component(e,t,n){var o,a;return(null==(o=null==this?void 0:this.TUIComponents)?void 0:o.componentName)?oe("warn","at TUIKit/server.ts:108",`[TUIChatKit]: ${null==(a=null==this?void 0:this.TUIComponents)?void 0:a.componentName} component has already been applied to target TUIChatEngine.`):(this.TUIComponents[e]=t,null==n||n.component(e,t)),n&&!bp.Vue&&(bp.Vue=n),this.TUIChatEngine}components(e,t){var n,o;return e&&(null!==(o=e)&&"object"==typeof o)?null==(n=null==Object?void 0:Object.keys(e))||n.forEach((n=>{this.component(n,e[n],t)})):oe("warn","at TUIKit/server.ts:130","[TUIChatKit]: components is empty or not object."),this.TUIChatEngine}use(e,t,n){if(this.TUICore)return this.TUIPlugins[e]?oe("warn","at TUIKit/server.ts:154",`[TUIChatKit]: Plugin ${this.TUIPlugins[e]} has already been applied to target TUIChatEngine.`):t&&Yp(null==t?void 0:t.plugin)?(this.TUIPlugins[e]=t,null==t||t.plugin(this,n)):Yp(t)?(this.TUIPlugins[e]=t,t(this,n)):oe("warn","at TUIKit/server.ts:164",'[TUIChatKit]: A plugin must either be a function or an object with an "plugin" function.'+this.TUIPlugins[e]+"does not comply with the above rules."),this.TUIChatEngine;oe("warn","at TUIKit/server.ts:148",`[TUIChatKit]: Plugin ${this.TUIPlugins[e]} can't be used before init.`)}};dI.init();var pI="undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{},hI=[],fI=[],gI="undefined"!=typeof Uint8Array?Uint8Array:Array,mI=!1;function vI(){mI=!0;for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t=0;t<64;++t)hI[t]=e[t],fI[e.charCodeAt(t)]=t;fI["-".charCodeAt(0)]=62,fI["_".charCodeAt(0)]=63}function _I(e,t,n){for(var o,a,i=[],r=t;r<n;r+=3)o=(e[r]<<16)+(e[r+1]<<8)+e[r+2],i.push(hI[(a=o)>>18&63]+hI[a>>12&63]+hI[a>>6&63]+hI[63&a]);return i.join("")}function yI(e){var t;mI||vI();for(var n=e.length,o=n%3,a="",i=[],r=0,s=n-o;r<s;r+=16383)i.push(_I(e,r,r+16383>s?s:r+16383));return 1===o?(t=e[n-1],a+=hI[t>>2],a+=hI[t<<4&63],a+="=="):2===o&&(t=(e[n-2]<<8)+e[n-1],a+=hI[t>>10],a+=hI[t>>4&63],a+=hI[t<<2&63],a+="="),i.push(a),i.join("")}function II(e,t,n,o,a){var i,r,s=8*a-o-1,l=(1<<s)-1,c=l>>1,u=-7,d=n?a-1:0,p=n?-1:1,h=e[t+d];for(d+=p,i=h&(1<<-u)-1,h>>=-u,u+=s;u>0;i=256*i+e[t+d],d+=p,u-=8);for(r=i&(1<<-u)-1,i>>=-u,u+=o;u>0;r=256*r+e[t+d],d+=p,u-=8);if(0===i)i=1-c;else{if(i===l)return r?NaN:1/0*(h?-1:1);r+=Math.pow(2,o),i-=c}return(h?-1:1)*r*Math.pow(2,i-o)}function CI(e,t,n,o,a,i){var r,s,l,c=8*i-a-1,u=(1<<c)-1,d=u>>1,p=23===a?Math.pow(2,-24)-Math.pow(2,-77):0,h=o?0:i-1,f=o?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,r=u):(r=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-r))<1&&(r--,l*=2),(t+=r+d>=1?p/l:p*Math.pow(2,1-d))*l>=2&&(r++,l/=2),r+d>=u?(s=0,r=u):r+d>=1?(s=(t*l-1)*Math.pow(2,a),r+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,a),r=0));a>=8;e[n+h]=255&s,h+=f,s/=256,a-=8);for(r=r<<a|s,c+=a;c>0;e[n+h]=255&r,h+=f,r/=256,c-=8);e[n+h-f]|=128*g}var kI={}.toString,EI=Array.isArray||function(e){return"[object Array]"==kI.call(e)};function TI(){return MI.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function SI(e,t){if(TI()<t)throw new RangeError("Invalid typed array length");return MI.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=MI.prototype:(null===e&&(e=new MI(t)),e.length=t),e}function MI(e,t,n){if(!(MI.TYPED_ARRAY_SUPPORT||this instanceof MI))return new MI(e,t,n);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return DI(this,e)}return wI(this,e,t,n)}function wI(e,t,n,o){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,o){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(o||0))throw new RangeError("'length' is out of bounds");return t=void 0===n&&void 0===o?new Uint8Array(t):void 0===o?new Uint8Array(t,n):new Uint8Array(t,n,o),MI.TYPED_ARRAY_SUPPORT?(e=t).__proto__=MI.prototype:e=NI(e,t),e}(e,t,n,o):"string"==typeof t?function(e,t,n){if("string"==typeof n&&""!==n||(n="utf8"),!MI.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var o=0|AI(t,n),a=(e=SI(e,o)).write(t,n);return a!==o&&(e=e.slice(0,a)),e}(e,t,n):function(e,t){if(LI(t)){var n=0|RI(t.length);return 0===(e=SI(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||(o=t.length)!=o?SI(e,0):NI(e,t);if("Buffer"===t.type&&EI(t.data))return NI(e,t.data)}var o;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function bI(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function DI(e,t){if(bI(t),e=SI(e,t<0?0:0|RI(t)),!MI.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function NI(e,t){var n=t.length<0?0:0|RI(t.length);e=SI(e,n);for(var o=0;o<n;o+=1)e[o]=255&t[o];return e}function RI(e){if(e>=TI())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+TI().toString(16)+" bytes");return 0|e}function LI(e){return!(null==e||!e._isBuffer)}function AI(e,t){if(LI(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var o=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return rC(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return sC(e).length;default:if(o)return rC(e).length;t=(""+t).toLowerCase(),o=!0}}function OI(e,t,n){var o=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return WI(this,t,n);case"utf8":case"utf-8":return qI(this,t,n);case"ascii":return YI(this,t,n);case"latin1":case"binary":return $I(this,t,n);case"base64":return jI(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ZI(this,t,n);default:if(o)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function PI(e,t,n){var o=e[t];e[t]=e[n],e[n]=o}function UI(e,t,n,o,a){if(0===e.length)return-1;if("string"==typeof n?(o=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=a?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(a)return-1;n=e.length-1}else if(n<0){if(!a)return-1;n=0}if("string"==typeof t&&(t=MI.from(t,o)),LI(t))return 0===t.length?-1:xI(e,t,n,o,a);if("number"==typeof t)return t&=255,MI.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?a?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):xI(e,[t],n,o,a);throw new TypeError("val must be string, number or Buffer")}function xI(e,t,n,o,a){var i,r=1,s=e.length,l=t.length;if(void 0!==o&&("ucs2"===(o=String(o).toLowerCase())||"ucs-2"===o||"utf16le"===o||"utf-16le"===o)){if(e.length<2||t.length<2)return-1;r=2,s/=2,l/=2,n/=2}function c(e,t){return 1===r?e[t]:e.readUInt16BE(t*r)}if(a){var u=-1;for(i=n;i<s;i++)if(c(e,i)===c(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===l)return u*r}else-1!==u&&(i-=i-u),u=-1}else for(n+l>s&&(n=s-l),i=n;i>=0;i--){for(var d=!0,p=0;p<l;p++)if(c(e,i+p)!==c(t,p)){d=!1;break}if(d)return i}return-1}function VI(e,t,n,o){n=Number(n)||0;var a=e.length-n;o?(o=Number(o))>a&&(o=a):o=a;var i=t.length;if(i%2!=0)throw new TypeError("Invalid hex string");o>i/2&&(o=i/2);for(var r=0;r<o;++r){var s=parseInt(t.substr(2*r,2),16);if(isNaN(s))return r;e[n+r]=s}return r}function BI(e,t,n,o){return lC(rC(t,e.length-n),e,n,o)}function GI(e,t,n,o){return lC(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,o)}function FI(e,t,n,o){return GI(e,t,n,o)}function zI(e,t,n,o){return lC(sC(t),e,n,o)}function HI(e,t,n,o){return lC(function(e,t){for(var n,o,a,i=[],r=0;r<e.length&&!((t-=2)<0);++r)o=(n=e.charCodeAt(r))>>8,a=n%256,i.push(a),i.push(o);return i}(t,e.length-n),e,n,o)}function jI(e,t,n){return 0===t&&n===e.length?yI(e):yI(e.slice(t,n))}function qI(e,t,n){n=Math.min(e.length,n);for(var o=[],a=t;a<n;){var i,r,s,l,c=e[a],u=null,d=c>239?4:c>223?3:c>191?2:1;if(a+d<=n)switch(d){case 1:c<128&&(u=c);break;case 2:128==(192&(i=e[a+1]))&&(l=(31&c)<<6|63&i)>127&&(u=l);break;case 3:i=e[a+1],r=e[a+2],128==(192&i)&&128==(192&r)&&(l=(15&c)<<12|(63&i)<<6|63&r)>2047&&(l<55296||l>57343)&&(u=l);break;case 4:i=e[a+1],r=e[a+2],s=e[a+3],128==(192&i)&&128==(192&r)&&128==(192&s)&&(l=(15&c)<<18|(63&i)<<12|(63&r)<<6|63&s)>65535&&l<1114112&&(u=l)}null===u?(u=65533,d=1):u>65535&&(u-=65536,o.push(u>>>10&1023|55296),u=56320|1023&u),o.push(u),a+=d}return function(e){var t=e.length;if(t<=KI)return String.fromCharCode.apply(String,e);for(var n="",o=0;o<t;)n+=String.fromCharCode.apply(String,e.slice(o,o+=KI));return n}(o)}MI.TYPED_ARRAY_SUPPORT=void 0===pI.TYPED_ARRAY_SUPPORT||pI.TYPED_ARRAY_SUPPORT,MI.poolSize=8192,MI._augment=function(e){return e.__proto__=MI.prototype,e},MI.from=function(e,t,n){return wI(null,e,t,n)},MI.TYPED_ARRAY_SUPPORT&&(MI.prototype.__proto__=Uint8Array.prototype,MI.__proto__=Uint8Array),MI.alloc=function(e,t,n){return o=null,i=t,r=n,bI(a=e),a<=0?SI(o,a):void 0!==i?"string"==typeof r?SI(o,a).fill(i,r):SI(o,a).fill(i):SI(o,a);var o,a,i,r},MI.allocUnsafe=function(e){return DI(null,e)},MI.allocUnsafeSlow=function(e){return DI(null,e)},MI.isBuffer=cC,MI.compare=function(e,t){if(!LI(e)||!LI(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,o=t.length,a=0,i=Math.min(n,o);a<i;++a)if(e[a]!==t[a]){n=e[a],o=t[a];break}return n<o?-1:o<n?1:0},MI.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},MI.concat=function(e,t){if(!EI(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return MI.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var o=MI.allocUnsafe(t),a=0;for(n=0;n<e.length;++n){var i=e[n];if(!LI(i))throw new TypeError('"list" argument must be an Array of Buffers');i.copy(o,a),a+=i.length}return o},MI.byteLength=AI,MI.prototype._isBuffer=!0,MI.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)PI(this,t,t+1);return this},MI.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)PI(this,t,t+3),PI(this,t+1,t+2);return this},MI.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)PI(this,t,t+7),PI(this,t+1,t+6),PI(this,t+2,t+5),PI(this,t+3,t+4);return this},MI.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?qI(this,0,e):OI.apply(this,arguments)},MI.prototype.equals=function(e){if(!LI(e))throw new TypeError("Argument must be a Buffer");return this===e||0===MI.compare(this,e)},MI.prototype.inspect=function(){var e="";return this.length>0&&(e=this.toString("hex",0,50).match(/.{2}/g).join(" "),this.length>50&&(e+=" ... ")),"<Buffer "+e+">"},MI.prototype.compare=function(e,t,n,o,a){if(!LI(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===o&&(o=0),void 0===a&&(a=this.length),t<0||n>e.length||o<0||a>this.length)throw new RangeError("out of range index");if(o>=a&&t>=n)return 0;if(o>=a)return-1;if(t>=n)return 1;if(this===e)return 0;for(var i=(a>>>=0)-(o>>>=0),r=(n>>>=0)-(t>>>=0),s=Math.min(i,r),l=this.slice(o,a),c=e.slice(t,n),u=0;u<s;++u)if(l[u]!==c[u]){i=l[u],r=c[u];break}return i<r?-1:r<i?1:0},MI.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},MI.prototype.indexOf=function(e,t,n){return UI(this,e,t,n,!0)},MI.prototype.lastIndexOf=function(e,t,n){return UI(this,e,t,n,!1)},MI.prototype.write=function(e,t,n,o){if(void 0===t)o="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)o=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===o&&(o="utf8")):(o=n,n=void 0)}var a=this.length-t;if((void 0===n||n>a)&&(n=a),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");o||(o="utf8");for(var i=!1;;)switch(o){case"hex":return VI(this,e,t,n);case"utf8":case"utf-8":return BI(this,e,t,n);case"ascii":return GI(this,e,t,n);case"latin1":case"binary":return FI(this,e,t,n);case"base64":return zI(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return HI(this,e,t,n);default:if(i)throw new TypeError("Unknown encoding: "+o);o=(""+o).toLowerCase(),i=!0}},MI.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var KI=4096;function YI(e,t,n){var o="";n=Math.min(e.length,n);for(var a=t;a<n;++a)o+=String.fromCharCode(127&e[a]);return o}function $I(e,t,n){var o="";n=Math.min(e.length,n);for(var a=t;a<n;++a)o+=String.fromCharCode(e[a]);return o}function WI(e,t,n){var o=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>o)&&(n=o);for(var a="",i=t;i<n;++i)a+=iC(e[i]);return a}function ZI(e,t,n){for(var o=e.slice(t,n),a="",i=0;i<o.length;i+=2)a+=String.fromCharCode(o[i]+256*o[i+1]);return a}function JI(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function XI(e,t,n,o,a,i){if(!LI(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw new RangeError('"value" argument is out of bounds');if(n+o>e.length)throw new RangeError("Index out of range")}function QI(e,t,n,o){t<0&&(t=65535+t+1);for(var a=0,i=Math.min(e.length-n,2);a<i;++a)e[n+a]=(t&255<<8*(o?a:1-a))>>>8*(o?a:1-a)}function eC(e,t,n,o){t<0&&(t=4294967295+t+1);for(var a=0,i=Math.min(e.length-n,4);a<i;++a)e[n+a]=t>>>8*(o?a:3-a)&255}function tC(e,t,n,o,a,i){if(n+o>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function nC(e,t,n,o,a){return a||tC(e,0,n,4),CI(e,t,n,o,23,4),n+4}function oC(e,t,n,o,a){return a||tC(e,0,n,8),CI(e,t,n,o,52,8),n+8}MI.prototype.slice=function(e,t){var n,o=this.length;if((e=~~e)<0?(e+=o)<0&&(e=0):e>o&&(e=o),(t=void 0===t?o:~~t)<0?(t+=o)<0&&(t=0):t>o&&(t=o),t<e&&(t=e),MI.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=MI.prototype;else{var a=t-e;n=new MI(a,void 0);for(var i=0;i<a;++i)n[i]=this[i+e]}return n},MI.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||JI(e,t,this.length);for(var o=this[e],a=1,i=0;++i<t&&(a*=256);)o+=this[e+i]*a;return o},MI.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||JI(e,t,this.length);for(var o=this[e+--t],a=1;t>0&&(a*=256);)o+=this[e+--t]*a;return o},MI.prototype.readUInt8=function(e,t){return t||JI(e,1,this.length),this[e]},MI.prototype.readUInt16LE=function(e,t){return t||JI(e,2,this.length),this[e]|this[e+1]<<8},MI.prototype.readUInt16BE=function(e,t){return t||JI(e,2,this.length),this[e]<<8|this[e+1]},MI.prototype.readUInt32LE=function(e,t){return t||JI(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},MI.prototype.readUInt32BE=function(e,t){return t||JI(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},MI.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||JI(e,t,this.length);for(var o=this[e],a=1,i=0;++i<t&&(a*=256);)o+=this[e+i]*a;return o>=(a*=128)&&(o-=Math.pow(2,8*t)),o},MI.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||JI(e,t,this.length);for(var o=t,a=1,i=this[e+--o];o>0&&(a*=256);)i+=this[e+--o]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},MI.prototype.readInt8=function(e,t){return t||JI(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},MI.prototype.readInt16LE=function(e,t){t||JI(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},MI.prototype.readInt16BE=function(e,t){t||JI(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},MI.prototype.readInt32LE=function(e,t){return t||JI(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},MI.prototype.readInt32BE=function(e,t){return t||JI(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},MI.prototype.readFloatLE=function(e,t){return t||JI(e,4,this.length),II(this,e,!0,23,4)},MI.prototype.readFloatBE=function(e,t){return t||JI(e,4,this.length),II(this,e,!1,23,4)},MI.prototype.readDoubleLE=function(e,t){return t||JI(e,8,this.length),II(this,e,!0,52,8)},MI.prototype.readDoubleBE=function(e,t){return t||JI(e,8,this.length),II(this,e,!1,52,8)},MI.prototype.writeUIntLE=function(e,t,n,o){e=+e,t|=0,n|=0,o||XI(this,e,t,n,Math.pow(2,8*n)-1,0);var a=1,i=0;for(this[t]=255&e;++i<n&&(a*=256);)this[t+i]=e/a&255;return t+n},MI.prototype.writeUIntBE=function(e,t,n,o){e=+e,t|=0,n|=0,o||XI(this,e,t,n,Math.pow(2,8*n)-1,0);var a=n-1,i=1;for(this[t+a]=255&e;--a>=0&&(i*=256);)this[t+a]=e/i&255;return t+n},MI.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,1,255,0),MI.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},MI.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,2,65535,0),MI.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):QI(this,e,t,!0),t+2},MI.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,2,65535,0),MI.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):QI(this,e,t,!1),t+2},MI.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,4,4294967295,0),MI.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):eC(this,e,t,!0),t+4},MI.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,4,4294967295,0),MI.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):eC(this,e,t,!1),t+4},MI.prototype.writeIntLE=function(e,t,n,o){if(e=+e,t|=0,!o){var a=Math.pow(2,8*n-1);XI(this,e,t,n,a-1,-a)}var i=0,r=1,s=0;for(this[t]=255&e;++i<n&&(r*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/r|0)-s&255;return t+n},MI.prototype.writeIntBE=function(e,t,n,o){if(e=+e,t|=0,!o){var a=Math.pow(2,8*n-1);XI(this,e,t,n,a-1,-a)}var i=n-1,r=1,s=0;for(this[t+i]=255&e;--i>=0&&(r*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/r|0)-s&255;return t+n},MI.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,1,127,-128),MI.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},MI.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,2,32767,-32768),MI.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):QI(this,e,t,!0),t+2},MI.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,2,32767,-32768),MI.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):QI(this,e,t,!1),t+2},MI.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,4,2147483647,-2147483648),MI.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):eC(this,e,t,!0),t+4},MI.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||XI(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),MI.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):eC(this,e,t,!1),t+4},MI.prototype.writeFloatLE=function(e,t,n){return nC(this,e,t,!0,n)},MI.prototype.writeFloatBE=function(e,t,n){return nC(this,e,t,!1,n)},MI.prototype.writeDoubleLE=function(e,t,n){return oC(this,e,t,!0,n)},MI.prototype.writeDoubleBE=function(e,t,n){return oC(this,e,t,!1,n)},MI.prototype.copy=function(e,t,n,o){if(n||(n=0),o||0===o||(o=this.length),t>=e.length&&(t=e.length),t||(t=0),o>0&&o<n&&(o=n),o===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(o<0)throw new RangeError("sourceEnd out of bounds");o>this.length&&(o=this.length),e.length-t<o-n&&(o=e.length-t+n);var a,i=o-n;if(this===e&&n<t&&t<o)for(a=i-1;a>=0;--a)e[a+t]=this[a+n];else if(i<1e3||!MI.TYPED_ARRAY_SUPPORT)for(a=0;a<i;++a)e[a+t]=this[a+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+i),t);return i},MI.prototype.fill=function(e,t,n,o){if("string"==typeof e){if("string"==typeof t?(o=t,t=0,n=this.length):"string"==typeof n&&(o=n,n=this.length),1===e.length){var a=e.charCodeAt(0);a<256&&(e=a)}if(void 0!==o&&"string"!=typeof o)throw new TypeError("encoding must be a string");if("string"==typeof o&&!MI.isEncoding(o))throw new TypeError("Unknown encoding: "+o)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{var r=LI(e)?e:rC(new MI(e,o).toString()),s=r.length;for(i=0;i<n-t;++i)this[i+t]=r[i%s]}return this};var aC=/[^+\/0-9A-Za-z-_]/g;function iC(e){return e<16?"0"+e.toString(16):e.toString(16)}function rC(e,t){var n;t=t||1/0;for(var o=e.length,a=null,i=[],r=0;r<o;++r){if((n=e.charCodeAt(r))>55295&&n<57344){if(!a){if(n>56319){(t-=3)>-1&&i.push(239,191,189);continue}if(r+1===o){(t-=3)>-1&&i.push(239,191,189);continue}a=n;continue}if(n<56320){(t-=3)>-1&&i.push(239,191,189),a=n;continue}n=65536+(a-55296<<10|n-56320)}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,n<128){if((t-=1)<0)break;i.push(n)}else if(n<2048){if((t-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function sC(e){return function(e){var t,n,o,a,i,r;mI||vI();var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");i="="===e[s-2]?2:"="===e[s-1]?1:0,r=new gI(3*s/4-i),o=i>0?s-4:s;var l=0;for(t=0,n=0;t<o;t+=4,n+=3)a=fI[e.charCodeAt(t)]<<18|fI[e.charCodeAt(t+1)]<<12|fI[e.charCodeAt(t+2)]<<6|fI[e.charCodeAt(t+3)],r[l++]=a>>16&255,r[l++]=a>>8&255,r[l++]=255&a;return 2===i?(a=fI[e.charCodeAt(t)]<<2|fI[e.charCodeAt(t+1)]>>4,r[l++]=255&a):1===i&&(a=fI[e.charCodeAt(t)]<<10|fI[e.charCodeAt(t+1)]<<4|fI[e.charCodeAt(t+2)]>>2,r[l++]=a>>8&255,r[l++]=255&a),r}(function(e){if((e=(t=e,t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")).replace(aC,"")).length<2)return"";for(var t;e.length%4!=0;)e+="=";return e}(e))}function lC(e,t,n,o){for(var a=0;a<o&&!(a+n>=t.length||a>=e.length);++a)t[a+n]=e[a];return a}function cC(e){return null!=e&&(!!e._isBuffer||uC(e)||"function"==typeof(t=e).readFloatLE&&"function"==typeof t.slice&&uC(t.slice(0,0)));var t}function uC(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}function dC(e,t){return e(t={exports:{}},t.exports),t.exports}var pC=dC((function(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f;e.exports=(n=n||(o=Math,a=Object.create||function(){function e(){}return function(t){var n;return e.prototype=t,n=new e,e.prototype=null,n}}(),r=(i={}).lib={},s=r.Base={extend:function(e){var t=a(this);return e&&t.mixIn(e),t.hasOwnProperty("init")&&this.init!==t.init||(t.init=function(){t.$super.init.apply(this,arguments)}),t.init.prototype=t,t.$super=this,t},create:function(){var e=this.extend();return e.init.apply(e,arguments),e},init:function(){},mixIn:function(e){for(var t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);e.hasOwnProperty("toString")&&(this.toString=e.toString)},clone:function(){return this.init.prototype.extend(this)}},l=r.WordArray=s.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:4*e.length},toString:function(e){return(e||u).stringify(this)},concat:function(e){var t=this.words,n=e.words,o=this.sigBytes,a=e.sigBytes;if(this.clamp(),o%4)for(var i=0;i<a;i++){var r=n[i>>>2]>>>24-i%4*8&255;t[o+i>>>2]|=r<<24-(o+i)%4*8}else for(i=0;i<a;i+=4)t[o+i>>>2]=n[i>>>2];return this.sigBytes+=a,this},clamp:function(){var e=this.words,t=this.sigBytes;e[t>>>2]&=4294967295<<32-t%4*8,e.length=o.ceil(t/4)},clone:function(){var e=s.clone.call(this);return e.words=this.words.slice(0),e},random:function(e){for(var t,n=[],a=function(e){var t=987654321,n=4294967295;return function(){var a=((t=36969*(65535&t)+(t>>16)&n)<<16)+(e=18e3*(65535&e)+(e>>16)&n)&n;return a/=4294967296,(a+=.5)*(o.random()>.5?1:-1)}},i=0;i<e;i+=4){var r=a(4294967296*(t||o.random()));t=987654071*r(),n.push(4294967296*r()|0)}return new l.init(n,e)}}),c=i.enc={},u=c.Hex={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;o.push((i>>>4).toString(16)),o.push((15&i).toString(16))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o+=2)n[o>>>3]|=parseInt(e.substr(o,2),16)<<24-o%8*4;return new l.init(n,t/2)}},d=c.Latin1={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a++){var i=t[a>>>2]>>>24-a%4*8&255;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var t=e.length,n=[],o=0;o<t;o++)n[o>>>2]|=(255&e.charCodeAt(o))<<24-o%4*8;return new l.init(n,t)}},p=c.Utf8={stringify:function(e){try{return decodeURIComponent(escape(d.stringify(e)))}catch(t){throw new Error("Malformed UTF-8 data")}},parse:function(e){return d.parse(unescape(encodeURIComponent(e)))}},h=r.BufferedBlockAlgorithm=s.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(e){"string"==typeof e&&(e=p.parse(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes},_process:function(e){var t=this._data,n=t.words,a=t.sigBytes,i=this.blockSize,r=a/(4*i),s=(r=e?o.ceil(r):o.max((0|r)-this._minBufferSize,0))*i,c=o.min(4*s,a);if(s){for(var u=0;u<s;u+=i)this._doProcessBlock(n,u);var d=n.splice(0,s);t.sigBytes-=c}return new l.init(d,c)},clone:function(){var e=s.clone.call(this);return e._data=this._data.clone(),e},_minBufferSize:0}),r.Hasher=h.extend({cfg:s.extend(),init:function(e){this.cfg=this.cfg.extend(e),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(e){return this._append(e),this._process(),this},finalize:function(e){return e&&this._append(e),this._doFinalize()},blockSize:16,_createHelper:function(e){return function(t,n){return new e.init(n).finalize(t)}},_createHmacHelper:function(e){return function(t,n){return new f.HMAC.init(e,n).finalize(t)}}}),f=i.algo={},i),n)})),hC=(dC((function(e,t){var n,o,a,i,r,s;e.exports=(a=(o=n=pC).lib,i=a.Base,r=a.WordArray,(s=o.x64={}).Word=i.extend({init:function(e,t){this.high=e,this.low=t}}),s.WordArray=i.extend({init:function(e,t){e=this.words=e||[],this.sigBytes=null!=t?t:8*e.length},toX32:function(){for(var e=this.words,t=e.length,n=[],o=0;o<t;o++){var a=e[o];n.push(a.high),n.push(a.low)}return r.create(n,this.sigBytes)},clone:function(){for(var e=i.clone.call(this),t=e.words=this.words.slice(0),n=t.length,o=0;o<n;o++)t[o]=t[o].clone();return e}}),n)})),dC((function(e,t){var n;e.exports=(n=pC,function(){if("function"==typeof ArrayBuffer){var e=n.lib.WordArray,t=e.init;(e.init=function(e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),(e instanceof Int8Array||"undefined"!=typeof Uint8ClampedArray&&e instanceof Uint8ClampedArray||e instanceof Int16Array||e instanceof Uint16Array||e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array)&&(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength)),e instanceof Uint8Array){for(var n=e.byteLength,o=[],a=0;a<n;a++)o[a>>>2]|=e[a]<<24-a%4*8;t.call(this,o,n)}else t.apply(this,arguments)}).prototype=e}}(),n.lib.WordArray)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib.WordArray,o=e.enc;function a(e){return e<<8&4278255360|e>>>8&16711935}o.Utf16=o.Utf16BE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],a=0;a<n;a+=2){var i=t[a>>>2]>>>16-a%4*8&65535;o.push(String.fromCharCode(i))}return o.join("")},parse:function(e){for(var n=e.length,o=[],a=0;a<n;a++)o[a>>>1]|=e.charCodeAt(a)<<16-a%2*16;return t.create(o,2*n)}},o.Utf16LE={stringify:function(e){for(var t=e.words,n=e.sigBytes,o=[],i=0;i<n;i+=2){var r=a(t[i>>>2]>>>16-i%4*8&65535);o.push(String.fromCharCode(r))}return o.join("")},parse:function(e){for(var n=e.length,o=[],i=0;i<n;i++)o[i>>>1]|=a(e.charCodeAt(i)<<16-i%2*16);return t.create(o,2*n)}}}(),n.enc.Utf16)})),dC((function(e,t){var n,o,a;e.exports=(a=(o=n=pC).lib.WordArray,o.enc.Base64={stringify:function(e){var t=e.words,n=e.sigBytes,o=this._map;e.clamp();for(var a=[],i=0;i<n;i+=3)for(var r=(t[i>>>2]>>>24-i%4*8&255)<<16|(t[i+1>>>2]>>>24-(i+1)%4*8&255)<<8|t[i+2>>>2]>>>24-(i+2)%4*8&255,s=0;s<4&&i+.75*s<n;s++)a.push(o.charAt(r>>>6*(3-s)&63));var l=o.charAt(64);if(l)for(;a.length%4;)a.push(l);return a.join("")},parse:function(e){var t=e.length,n=this._map,o=this._reverseMap;if(!o){o=this._reverseMap=[];for(var i=0;i<n.length;i++)o[n.charCodeAt(i)]=i}var r=n.charAt(64);if(r){var s=e.indexOf(r);-1!==s&&(t=s)}return function(e,t,n){for(var o=[],i=0,r=0;r<t;r++)if(r%4){var s=n[e.charCodeAt(r-1)]<<r%4*2,l=n[e.charCodeAt(r)]>>>6-r%4*2;o[i>>>2]|=(s|l)<<24-i%4*8,i++}return a.create(o,i)}(e,t,o)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="},n.enc.Base64)})),dC((function(e,t){var n;e.exports=(n=pC,function(e){var t=n,o=t.lib,a=o.WordArray,i=o.Hasher,r=t.algo,s=[];!function(){for(var t=0;t<64;t++)s[t]=4294967296*e.abs(e.sin(t+1))|0}();var l=r.MD5=i.extend({_doReset:function(){this._hash=new a.init([1732584193,4023233417,2562383102,271733878])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,a=e[o];e[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var i=this._hash.words,r=e[t+0],l=e[t+1],h=e[t+2],f=e[t+3],g=e[t+4],m=e[t+5],v=e[t+6],_=e[t+7],y=e[t+8],I=e[t+9],C=e[t+10],k=e[t+11],E=e[t+12],T=e[t+13],S=e[t+14],M=e[t+15],w=i[0],b=i[1],D=i[2],N=i[3];w=c(w,b,D,N,r,7,s[0]),N=c(N,w,b,D,l,12,s[1]),D=c(D,N,w,b,h,17,s[2]),b=c(b,D,N,w,f,22,s[3]),w=c(w,b,D,N,g,7,s[4]),N=c(N,w,b,D,m,12,s[5]),D=c(D,N,w,b,v,17,s[6]),b=c(b,D,N,w,_,22,s[7]),w=c(w,b,D,N,y,7,s[8]),N=c(N,w,b,D,I,12,s[9]),D=c(D,N,w,b,C,17,s[10]),b=c(b,D,N,w,k,22,s[11]),w=c(w,b,D,N,E,7,s[12]),N=c(N,w,b,D,T,12,s[13]),D=c(D,N,w,b,S,17,s[14]),w=u(w,b=c(b,D,N,w,M,22,s[15]),D,N,l,5,s[16]),N=u(N,w,b,D,v,9,s[17]),D=u(D,N,w,b,k,14,s[18]),b=u(b,D,N,w,r,20,s[19]),w=u(w,b,D,N,m,5,s[20]),N=u(N,w,b,D,C,9,s[21]),D=u(D,N,w,b,M,14,s[22]),b=u(b,D,N,w,g,20,s[23]),w=u(w,b,D,N,I,5,s[24]),N=u(N,w,b,D,S,9,s[25]),D=u(D,N,w,b,f,14,s[26]),b=u(b,D,N,w,y,20,s[27]),w=u(w,b,D,N,T,5,s[28]),N=u(N,w,b,D,h,9,s[29]),D=u(D,N,w,b,_,14,s[30]),w=d(w,b=u(b,D,N,w,E,20,s[31]),D,N,m,4,s[32]),N=d(N,w,b,D,y,11,s[33]),D=d(D,N,w,b,k,16,s[34]),b=d(b,D,N,w,S,23,s[35]),w=d(w,b,D,N,l,4,s[36]),N=d(N,w,b,D,g,11,s[37]),D=d(D,N,w,b,_,16,s[38]),b=d(b,D,N,w,C,23,s[39]),w=d(w,b,D,N,T,4,s[40]),N=d(N,w,b,D,r,11,s[41]),D=d(D,N,w,b,f,16,s[42]),b=d(b,D,N,w,v,23,s[43]),w=d(w,b,D,N,I,4,s[44]),N=d(N,w,b,D,E,11,s[45]),D=d(D,N,w,b,M,16,s[46]),w=p(w,b=d(b,D,N,w,h,23,s[47]),D,N,r,6,s[48]),N=p(N,w,b,D,_,10,s[49]),D=p(D,N,w,b,S,15,s[50]),b=p(b,D,N,w,m,21,s[51]),w=p(w,b,D,N,E,6,s[52]),N=p(N,w,b,D,f,10,s[53]),D=p(D,N,w,b,C,15,s[54]),b=p(b,D,N,w,l,21,s[55]),w=p(w,b,D,N,y,6,s[56]),N=p(N,w,b,D,M,10,s[57]),D=p(D,N,w,b,v,15,s[58]),b=p(b,D,N,w,T,21,s[59]),w=p(w,b,D,N,g,6,s[60]),N=p(N,w,b,D,k,10,s[61]),D=p(D,N,w,b,h,15,s[62]),b=p(b,D,N,w,I,21,s[63]),i[0]=i[0]+w|0,i[1]=i[1]+b|0,i[2]=i[2]+D|0,i[3]=i[3]+N|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,a=8*t.sigBytes;n[a>>>5]|=128<<24-a%32;var i=e.floor(o/4294967296),r=o;n[15+(a+64>>>9<<4)]=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),n[14+(a+64>>>9<<4)]=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),t.sigBytes=4*(n.length+1),this._process();for(var s=this._hash,l=s.words,c=0;c<4;c++){var u=l[c];l[c]=16711935&(u<<8|u>>>24)|4278255360&(u<<24|u>>>8)}return s},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});function c(e,t,n,o,a,i,r){var s=e+(t&n|~t&o)+a+r;return(s<<i|s>>>32-i)+t}function u(e,t,n,o,a,i,r){var s=e+(t&o|n&~o)+a+r;return(s<<i|s>>>32-i)+t}function d(e,t,n,o,a,i,r){var s=e+(t^n^o)+a+r;return(s<<i|s>>>32-i)+t}function p(e,t,n,o,a,i,r){var s=e+(n^(t|~o))+a+r;return(s<<i|s>>>32-i)+t}t.MD5=i._createHelper(l),t.HmacMD5=i._createHmacHelper(l)}(Math),n.MD5)})),dC((function(e,t){var n,o,a,i,r,s,l,c;e.exports=(a=(o=n=pC).lib,i=a.WordArray,r=a.Hasher,s=o.algo,l=[],c=s.SHA1=r.extend({_doReset:function(){this._hash=new i.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],c=0;c<80;c++){if(c<16)l[c]=0|e[t+c];else{var u=l[c-3]^l[c-8]^l[c-14]^l[c-16];l[c]=u<<1|u>>>31}var d=(o<<5|o>>>27)+s+l[c];d+=c<20?1518500249+(a&i|~a&r):c<40?1859775393+(a^i^r):c<60?(a&i|a&r|i&r)-1894007588:(a^i^r)-899497514,s=r,r=i,i=a<<30|a>>>2,a=o,o=d}n[0]=n[0]+o|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+r|0,n[4]=n[4]+s|0},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=Math.floor(n/4294967296),t[15+(o+64>>>9<<4)]=n,e.sigBytes=4*t.length,this._process(),this._hash},clone:function(){var e=r.clone.call(this);return e._hash=this._hash.clone(),e}}),o.SHA1=r._createHelper(c),o.HmacSHA1=r._createHmacHelper(c),n.SHA1)})),dC((function(e,t){var n;e.exports=(n=pC,function(e){var t=n,o=t.lib,a=o.WordArray,i=o.Hasher,r=t.algo,s=[],l=[];!function(){function t(t){for(var n=e.sqrt(t),o=2;o<=n;o++)if(!(t%o))return!1;return!0}function n(e){return 4294967296*(e-(0|e))|0}for(var o=2,a=0;a<64;)t(o)&&(a<8&&(s[a]=n(e.pow(o,.5))),l[a]=n(e.pow(o,1/3)),a++),o++}();var c=[],u=r.SHA256=i.extend({_doReset:function(){this._hash=new a.init(s.slice(0))},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=0;h<64;h++){if(h<16)c[h]=0|e[t+h];else{var f=c[h-15],g=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,m=c[h-2],v=(m<<15|m>>>17)^(m<<13|m>>>19)^m>>>10;c[h]=g+c[h-7]+v+c[h-16]}var _=o&a^o&i^a&i,y=(o<<30|o>>>2)^(o<<19|o>>>13)^(o<<10|o>>>22),I=p+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&u^~s&d)+l[h]+c[h];p=d,d=u,u=s,s=r+I|0,r=i,i=a,a=o,o=I+(y+_)|0}n[0]=n[0]+o|0,n[1]=n[1]+a|0,n[2]=n[2]+i|0,n[3]=n[3]+r|0,n[4]=n[4]+s|0,n[5]=n[5]+u|0,n[6]=n[6]+d|0,n[7]=n[7]+p|0},_doFinalize:function(){var t=this._data,n=t.words,o=8*this._nDataBytes,a=8*t.sigBytes;return n[a>>>5]|=128<<24-a%32,n[14+(a+64>>>9<<4)]=e.floor(o/4294967296),n[15+(a+64>>>9<<4)]=o,t.sigBytes=4*n.length,this._process(),this._hash},clone:function(){var e=i.clone.call(this);return e._hash=this._hash.clone(),e}});t.SHA256=i._createHelper(u),t.HmacSHA256=i._createHmacHelper(u)}(Math),n.SHA256)})),dC((function(e,t){var n,o,a,i,r,s;e.exports=(a=(o=n=pC).lib.WordArray,i=o.algo,r=i.SHA256,s=i.SHA224=r.extend({_doReset:function(){this._hash=new a.init([3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428])},_doFinalize:function(){var e=r._doFinalize.call(this);return e.sigBytes-=4,e}}),o.SHA224=r._createHelper(s),o.HmacSHA224=r._createHmacHelper(s),n.SHA224)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib.Hasher,o=e.x64,a=o.Word,i=o.WordArray,r=e.algo;function s(){return a.create.apply(a,arguments)}var l=[s(1116352408,3609767458),s(1899447441,602891725),s(3049323471,3964484399),s(3921009573,2173295548),s(961987163,4081628472),s(1508970993,3053834265),s(2453635748,2937671579),s(2870763221,3664609560),s(3624381080,2734883394),s(310598401,1164996542),s(607225278,1323610764),s(1426881987,3590304994),s(1925078388,4068182383),s(2162078206,991336113),s(2614888103,633803317),s(3248222580,3479774868),s(3835390401,2666613458),s(4022224774,944711139),s(264347078,2341262773),s(604807628,2007800933),s(770255983,1495990901),s(1249150122,1856431235),s(1555081692,3175218132),s(1996064986,2198950837),s(2554220882,3999719339),s(2821834349,766784016),s(2952996808,2566594879),s(3210313671,3203337956),s(3336571891,1034457026),s(3584528711,2466948901),s(113926993,3758326383),s(338241895,168717936),s(666307205,1188179964),s(773529912,1546045734),s(1294757372,1522805485),s(1396182291,2643833823),s(1695183700,2343527390),s(1986661051,1014477480),s(2177026350,1206759142),s(2456956037,344077627),s(2730485921,1290863460),s(2820302411,3158454273),s(3259730800,3505952657),s(3345764771,106217008),s(3516065817,3606008344),s(3600352804,1432725776),s(4094571909,1467031594),s(275423344,851169720),s(430227734,3100823752),s(506948616,1363258195),s(659060556,3750685593),s(883997877,3785050280),s(958139571,3318307427),s(1322822218,3812723403),s(1537002063,2003034995),s(1747873779,3602036899),s(1955562222,1575990012),s(2024104815,1125592928),s(2227730452,2716904306),s(2361852424,442776044),s(2428436474,593698344),s(2756734187,3733110249),s(3204031479,2999351573),s(3329325298,3815920427),s(3391569614,3928383900),s(3515267271,566280711),s(3940187606,3454069534),s(4118630271,4000239992),s(116418474,1914138554),s(174292421,2731055270),s(289380356,3203993006),s(460393269,320620315),s(685471733,587496836),s(852142971,1086792851),s(1017036298,365543100),s(1126000580,2618297676),s(1288033470,3409855158),s(1501505948,4234509866),s(1607167915,987167468),s(1816402316,1246189591)],c=[];!function(){for(var e=0;e<80;e++)c[e]=s()}();var u=r.SHA512=t.extend({_doReset:function(){this._hash=new i.init([new a.init(1779033703,4089235720),new a.init(3144134277,2227873595),new a.init(1013904242,4271175723),new a.init(2773480762,1595750129),new a.init(1359893119,2917565137),new a.init(2600822924,725511199),new a.init(528734635,4215389547),new a.init(1541459225,327033209)])},_doProcessBlock:function(e,t){for(var n=this._hash.words,o=n[0],a=n[1],i=n[2],r=n[3],s=n[4],u=n[5],d=n[6],p=n[7],h=o.high,f=o.low,g=a.high,m=a.low,v=i.high,_=i.low,y=r.high,I=r.low,C=s.high,k=s.low,E=u.high,T=u.low,S=d.high,M=d.low,w=p.high,b=p.low,D=h,N=f,R=g,L=m,A=v,O=_,P=y,U=I,x=C,V=k,B=E,G=T,F=S,z=M,H=w,j=b,q=0;q<80;q++){var K=c[q];if(q<16)var Y=K.high=0|e[t+2*q],$=K.low=0|e[t+2*q+1];else{var W=c[q-15],Z=W.high,J=W.low,X=(Z>>>1|J<<31)^(Z>>>8|J<<24)^Z>>>7,Q=(J>>>1|Z<<31)^(J>>>8|Z<<24)^(J>>>7|Z<<25),ee=c[q-2],te=ee.high,ne=ee.low,oe=(te>>>19|ne<<13)^(te<<3|ne>>>29)^te>>>6,ae=(ne>>>19|te<<13)^(ne<<3|te>>>29)^(ne>>>6|te<<26),ie=c[q-7],re=ie.high,se=ie.low,le=c[q-16],ce=le.high,ue=le.low;Y=(Y=(Y=X+re+(($=Q+se)>>>0<Q>>>0?1:0))+oe+(($+=ae)>>>0<ae>>>0?1:0))+ce+(($+=ue)>>>0<ue>>>0?1:0),K.high=Y,K.low=$}var de,pe=x&B^~x&F,he=V&G^~V&z,fe=D&R^D&A^R&A,ge=N&L^N&O^L&O,me=(D>>>28|N<<4)^(D<<30|N>>>2)^(D<<25|N>>>7),ve=(N>>>28|D<<4)^(N<<30|D>>>2)^(N<<25|D>>>7),_e=(x>>>14|V<<18)^(x>>>18|V<<14)^(x<<23|V>>>9),ye=(V>>>14|x<<18)^(V>>>18|x<<14)^(V<<23|x>>>9),Ie=l[q],Ce=Ie.high,ke=Ie.low,Ee=H+_e+((de=j+ye)>>>0<j>>>0?1:0),Te=ve+ge;H=F,j=z,F=B,z=G,B=x,G=V,x=P+(Ee=(Ee=(Ee=Ee+pe+((de+=he)>>>0<he>>>0?1:0))+Ce+((de+=ke)>>>0<ke>>>0?1:0))+Y+((de+=$)>>>0<$>>>0?1:0))+((V=U+de|0)>>>0<U>>>0?1:0)|0,P=A,U=O,A=R,O=L,R=D,L=N,D=Ee+(me+fe+(Te>>>0<ve>>>0?1:0))+((N=de+Te|0)>>>0<de>>>0?1:0)|0}f=o.low=f+N,o.high=h+D+(f>>>0<N>>>0?1:0),m=a.low=m+L,a.high=g+R+(m>>>0<L>>>0?1:0),_=i.low=_+O,i.high=v+A+(_>>>0<O>>>0?1:0),I=r.low=I+U,r.high=y+P+(I>>>0<U>>>0?1:0),k=s.low=k+V,s.high=C+x+(k>>>0<V>>>0?1:0),T=u.low=T+G,u.high=E+B+(T>>>0<G>>>0?1:0),M=d.low=M+z,d.high=S+F+(M>>>0<z>>>0?1:0),b=p.low=b+j,p.high=w+H+(b>>>0<j>>>0?1:0)},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;return t[o>>>5]|=128<<24-o%32,t[30+(o+128>>>10<<5)]=Math.floor(n/4294967296),t[31+(o+128>>>10<<5)]=n,e.sigBytes=4*t.length,this._process(),this._hash.toX32()},clone:function(){var e=t.clone.call(this);return e._hash=this._hash.clone(),e},blockSize:32});e.SHA512=t._createHelper(u),e.HmacSHA512=t._createHmacHelper(u)}(),n.SHA512)})),dC((function(e,t){var n,o,a,i,r,s,l,c;e.exports=(a=(o=n=pC).x64,i=a.Word,r=a.WordArray,s=o.algo,l=s.SHA512,c=s.SHA384=l.extend({_doReset:function(){this._hash=new r.init([new i.init(3418070365,3238371032),new i.init(1654270250,914150663),new i.init(2438529370,812702999),new i.init(355462360,4144912697),new i.init(1731405415,4290775857),new i.init(2394180231,1750603025),new i.init(3675008525,1694076839),new i.init(1203062813,3204075428)])},_doFinalize:function(){var e=l._doFinalize.call(this);return e.sigBytes-=16,e}}),o.SHA384=l._createHelper(c),o.HmacSHA384=l._createHmacHelper(c),n.SHA384)})),dC((function(e,t){var n;e.exports=(n=pC,function(e){var t=n,o=t.lib,a=o.WordArray,i=o.Hasher,r=t.x64.Word,s=t.algo,l=[],c=[],u=[];!function(){for(var e=1,t=0,n=0;n<24;n++){l[e+5*t]=(n+1)*(n+2)/2%64;var o=(2*e+3*t)%5;e=t%5,t=o}for(e=0;e<5;e++)for(t=0;t<5;t++)c[e+5*t]=t+(2*e+3*t)%5*5;for(var a=1,i=0;i<24;i++){for(var s=0,d=0,p=0;p<7;p++){if(1&a){var h=(1<<p)-1;h<32?d^=1<<h:s^=1<<h-32}128&a?a=a<<1^113:a<<=1}u[i]=r.create(s,d)}}();var d=[];!function(){for(var e=0;e<25;e++)d[e]=r.create()}();var p=s.SHA3=i.extend({cfg:i.cfg.extend({outputLength:512}),_doReset:function(){for(var e=this._state=[],t=0;t<25;t++)e[t]=new r.init;this.blockSize=(1600-2*this.cfg.outputLength)/32},_doProcessBlock:function(e,t){for(var n=this._state,o=this.blockSize/2,a=0;a<o;a++){var i=e[t+2*a],r=e[t+2*a+1];i=16711935&(i<<8|i>>>24)|4278255360&(i<<24|i>>>8),r=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),(b=n[a]).high^=r,b.low^=i}for(var s=0;s<24;s++){for(var p=0;p<5;p++){for(var h=0,f=0,g=0;g<5;g++)h^=(b=n[p+5*g]).high,f^=b.low;var m=d[p];m.high=h,m.low=f}for(p=0;p<5;p++){var v=d[(p+4)%5],_=d[(p+1)%5],y=_.high,I=_.low;for(h=v.high^(y<<1|I>>>31),f=v.low^(I<<1|y>>>31),g=0;g<5;g++)(b=n[p+5*g]).high^=h,b.low^=f}for(var C=1;C<25;C++){var k=(b=n[C]).high,E=b.low,T=l[C];T<32?(h=k<<T|E>>>32-T,f=E<<T|k>>>32-T):(h=E<<T-32|k>>>64-T,f=k<<T-32|E>>>64-T);var S=d[c[C]];S.high=h,S.low=f}var M=d[0],w=n[0];for(M.high=w.high,M.low=w.low,p=0;p<5;p++)for(g=0;g<5;g++){var b=n[C=p+5*g],D=d[C],N=d[(p+1)%5+5*g],R=d[(p+2)%5+5*g];b.high=D.high^~N.high&R.high,b.low=D.low^~N.low&R.low}b=n[0];var L=u[s];b.high^=L.high,b.low^=L.low}},_doFinalize:function(){var t=this._data,n=t.words,o=(this._nDataBytes,8*t.sigBytes),i=32*this.blockSize;n[o>>>5]|=1<<24-o%32,n[(e.ceil((o+1)/i)*i>>>5)-1]|=128,t.sigBytes=4*n.length,this._process();for(var r=this._state,s=this.cfg.outputLength/8,l=s/8,c=[],u=0;u<l;u++){var d=r[u],p=d.high,h=d.low;p=16711935&(p<<8|p>>>24)|4278255360&(p<<24|p>>>8),h=16711935&(h<<8|h>>>24)|4278255360&(h<<24|h>>>8),c.push(h),c.push(p)}return new a.init(c,s)},clone:function(){for(var e=i.clone.call(this),t=e._state=this._state.slice(0),n=0;n<25;n++)t[n]=t[n].clone();return e}});t.SHA3=i._createHelper(p),t.HmacSHA3=i._createHmacHelper(p)}(Math),n.SHA3)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib,o=t.WordArray,a=t.Hasher,i=e.algo,r=o.create([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13]),s=o.create([5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11]),l=o.create([11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6]),c=o.create([8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]),u=o.create([0,1518500249,1859775393,2400959708,2840853838]),d=o.create([1352829926,1548603684,1836072691,2053994217,0]),p=i.RIPEMD160=a.extend({_doReset:function(){this._hash=o.create([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(e,t){for(var n=0;n<16;n++){var o=t+n,a=e[o];e[o]=16711935&(a<<8|a>>>24)|4278255360&(a<<24|a>>>8)}var i,p,y,I,C,k,E,T,S,M,w,b=this._hash.words,D=u.words,N=d.words,R=r.words,L=s.words,A=l.words,O=c.words;for(k=i=b[0],E=p=b[1],T=y=b[2],S=I=b[3],M=C=b[4],n=0;n<80;n+=1)w=i+e[t+R[n]]|0,w+=n<16?h(p,y,I)+D[0]:n<32?f(p,y,I)+D[1]:n<48?g(p,y,I)+D[2]:n<64?m(p,y,I)+D[3]:v(p,y,I)+D[4],w=(w=_(w|=0,A[n]))+C|0,i=C,C=I,I=_(y,10),y=p,p=w,w=k+e[t+L[n]]|0,w+=n<16?v(E,T,S)+N[0]:n<32?m(E,T,S)+N[1]:n<48?g(E,T,S)+N[2]:n<64?f(E,T,S)+N[3]:h(E,T,S)+N[4],w=(w=_(w|=0,O[n]))+M|0,k=M,M=S,S=_(T,10),T=E,E=w;w=b[1]+y+S|0,b[1]=b[2]+I+M|0,b[2]=b[3]+C+k|0,b[3]=b[4]+i+E|0,b[4]=b[0]+p+T|0,b[0]=w},_doFinalize:function(){var e=this._data,t=e.words,n=8*this._nDataBytes,o=8*e.sigBytes;t[o>>>5]|=128<<24-o%32,t[14+(o+64>>>9<<4)]=16711935&(n<<8|n>>>24)|4278255360&(n<<24|n>>>8),e.sigBytes=4*(t.length+1),this._process();for(var a=this._hash,i=a.words,r=0;r<5;r++){var s=i[r];i[r]=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8)}return a},clone:function(){var e=a.clone.call(this);return e._hash=this._hash.clone(),e}});function h(e,t,n){return e^t^n}function f(e,t,n){return e&t|~e&n}function g(e,t,n){return(e|~t)^n}function m(e,t,n){return e&n|t&~n}function v(e,t,n){return e^(t|~n)}function _(e,t){return e<<t|e>>>32-t}e.RIPEMD160=a._createHelper(p),e.HmacRIPEMD160=a._createHmacHelper(p)}(),n.RIPEMD160)})),dC((function(e,t){var n,o,a,i;e.exports=(o=(n=pC).lib.Base,a=n.enc,i=a.Utf8,void(n.algo.HMAC=o.extend({init:function(e,t){e=this._hasher=new e.init,"string"==typeof t&&(t=i.parse(t));var n=e.blockSize,o=4*n;t.sigBytes>o&&(t=e.finalize(t)),t.clamp();for(var a=this._oKey=t.clone(),r=this._iKey=t.clone(),s=a.words,l=r.words,c=0;c<n;c++)s[c]^=1549556828,l[c]^=909522486;a.sigBytes=r.sigBytes=o,this.reset()},reset:function(){var e=this._hasher;e.reset(),e.update(this._iKey)},update:function(e){return this._hasher.update(e),this},finalize:function(e){var t=this._hasher,n=t.finalize(e);return t.reset(),t.finalize(this._oKey.clone().concat(n))}})))})),dC((function(e,t){var n,o,a,i,r,s,l,c,u;e.exports=(i=(a=(o=n=pC).lib).Base,r=a.WordArray,l=(s=o.algo).SHA1,c=s.HMAC,u=s.PBKDF2=i.extend({cfg:i.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=c.create(n.hasher,e),a=r.create(),i=r.create([1]),s=a.words,l=i.words,u=n.keySize,d=n.iterations;s.length<u;){var p=o.update(t).finalize(i);o.reset();for(var h=p.words,f=h.length,g=p,m=1;m<d;m++){g=o.finalize(g),o.reset();for(var v=g.words,_=0;_<f;_++)h[_]^=v[_]}a.concat(p),l[0]++}return a.sigBytes=4*u,a}}),o.PBKDF2=function(e,t,n){return u.create(n).compute(e,t)},n.PBKDF2)})),dC((function(e,t){var n,o,a,i,r,s,l,c;e.exports=(i=(a=(o=n=pC).lib).Base,r=a.WordArray,l=(s=o.algo).MD5,c=s.EvpKDF=i.extend({cfg:i.extend({keySize:4,hasher:l,iterations:1}),init:function(e){this.cfg=this.cfg.extend(e)},compute:function(e,t){for(var n=this.cfg,o=n.hasher.create(),a=r.create(),i=a.words,s=n.keySize,l=n.iterations;i.length<s;){c&&o.update(c);var c=o.update(e).finalize(t);o.reset();for(var u=1;u<l;u++)c=o.finalize(c),o.reset();a.concat(c)}return a.sigBytes=4*s,a}}),o.EvpKDF=function(e,t,n){return c.create(n).compute(e,t)},n.EvpKDF)})),dC((function(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f,g,m,v,_,y,I,C,k,E,T;e.exports=void((n=pC).lib.Cipher||(o=n,a=o.lib,i=a.Base,r=a.WordArray,s=a.BufferedBlockAlgorithm,l=o.enc,l.Utf8,c=l.Base64,u=o.algo,d=u.EvpKDF,p=a.Cipher=s.extend({cfg:i.extend(),createEncryptor:function(e,t){return this.create(this._ENC_XFORM_MODE,e,t)},createDecryptor:function(e,t){return this.create(this._DEC_XFORM_MODE,e,t)},init:function(e,t,n){this.cfg=this.cfg.extend(n),this._xformMode=e,this._key=t,this.reset()},reset:function(){s.reset.call(this),this._doReset()},process:function(e){return this._append(e),this._process()},finalize:function(e){return e&&this._append(e),this._doFinalize()},keySize:4,ivSize:4,_ENC_XFORM_MODE:1,_DEC_XFORM_MODE:2,_createHelper:function(){function e(e){return"string"==typeof e?T:C}return function(t){return{encrypt:function(n,o,a){return e(o).encrypt(t,n,o,a)},decrypt:function(n,o,a){return e(o).decrypt(t,n,o,a)}}}}()}),a.StreamCipher=p.extend({_doFinalize:function(){return this._process(!0)},blockSize:1}),h=o.mode={},f=a.BlockCipherMode=i.extend({createEncryptor:function(e,t){return this.Encryptor.create(e,t)},createDecryptor:function(e,t){return this.Decryptor.create(e,t)},init:function(e,t){this._cipher=e,this._iv=t}}),g=h.CBC=function(){var e=f.extend();function t(e,t,n){var o=this._iv;if(o){var a=o;this._iv=undefined}else a=this._prevBlock;for(var i=0;i<n;i++)e[t+i]^=a[i]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize;t.call(this,e,n,a),o.encryptBlock(e,n),this._prevBlock=e.slice(n,n+a)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize,i=e.slice(n,n+a);o.decryptBlock(e,n),t.call(this,e,n,a),this._prevBlock=i}}),e}(),m=o.pad={},v=m.Pkcs7={pad:function(e,t){for(var n=4*t,o=n-e.sigBytes%n,a=o<<24|o<<16|o<<8|o,i=[],s=0;s<o;s+=4)i.push(a);var l=r.create(i,o);e.concat(l)},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},a.BlockCipher=p.extend({cfg:p.cfg.extend({mode:g,padding:v}),reset:function(){p.reset.call(this);var e=this.cfg,t=e.iv,n=e.mode;if(this._xformMode==this._ENC_XFORM_MODE)var o=n.createEncryptor;else{o=n.createDecryptor;this._minBufferSize=1}this._mode&&this._mode.__creator==o?this._mode.init(this,t&&t.words):(this._mode=o.call(n,this,t&&t.words),this._mode.__creator=o)},_doProcessBlock:function(e,t){this._mode.processBlock(e,t)},_doFinalize:function(){var e=this.cfg.padding;if(this._xformMode==this._ENC_XFORM_MODE){e.pad(this._data,this.blockSize);var t=this._process(!0)}else{t=this._process(!0);e.unpad(t)}return t},blockSize:4}),_=a.CipherParams=i.extend({init:function(e){this.mixIn(e)},toString:function(e){return(e||this.formatter).stringify(this)}}),y=o.format={},I=y.OpenSSL={stringify:function(e){var t=e.ciphertext,n=e.salt;if(n)var o=r.create([1398893684,1701076831]).concat(n).concat(t);else o=t;return o.toString(c)},parse:function(e){var t=c.parse(e),n=t.words;if(1398893684==n[0]&&1701076831==n[1]){var o=r.create(n.slice(2,4));n.splice(0,4),t.sigBytes-=16}return _.create({ciphertext:t,salt:o})}},C=a.SerializableCipher=i.extend({cfg:i.extend({format:I}),encrypt:function(e,t,n,o){o=this.cfg.extend(o);var a=e.createEncryptor(n,o),i=a.finalize(t),r=a.cfg;return _.create({ciphertext:i,key:n,iv:r.iv,algorithm:e,mode:r.mode,padding:r.padding,blockSize:e.blockSize,formatter:o.format})},decrypt:function(e,t,n,o){return o=this.cfg.extend(o),t=this._parse(t,o.format),e.createDecryptor(n,o).finalize(t.ciphertext)},_parse:function(e,t){return"string"==typeof e?t.parse(e,this):e}}),k=o.kdf={},E=k.OpenSSL={execute:function(e,t,n,o){o||(o=r.random(8));var a=d.create({keySize:t+n}).compute(e,o),i=r.create(a.words.slice(t),4*n);return a.sigBytes=4*t,_.create({key:a,iv:i,salt:o})}},T=a.PasswordBasedCipher=C.extend({cfg:C.cfg.extend({kdf:E}),encrypt:function(e,t,n,o){var a=(o=this.cfg.extend(o)).kdf.execute(n,e.keySize,e.ivSize);o.iv=a.iv;var i=C.encrypt.call(this,e,t,a.key,o);return i.mixIn(a),i},decrypt:function(e,t,n,o){o=this.cfg.extend(o),t=this._parse(t,o.format);var a=o.kdf.execute(n,e.keySize,e.ivSize,t.salt);return o.iv=a.iv,C.decrypt.call(this,e,t,a.key,o)}})))})),dC((function(e,t){var n;e.exports=((n=pC).mode.CFB=function(){var e=n.lib.BlockCipherMode.extend();function t(e,t,n,o){var a=this._iv;if(a){var i=a.slice(0);this._iv=void 0}else i=this._prevBlock;o.encryptBlock(i,0);for(var r=0;r<n;r++)e[t+r]^=i[r]}return e.Encryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize;t.call(this,e,n,a,o),this._prevBlock=e.slice(n,n+a)}}),e.Decryptor=e.extend({processBlock:function(e,n){var o=this._cipher,a=o.blockSize,i=e.slice(n,n+a);t.call(this,e,n,a,o),this._prevBlock=i}}),e}(),n.mode.CFB)})),dC((function(e,t){var n,o,a;e.exports=((n=pC).mode.CTR=(a=(o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,a=this._iv,i=this._counter;a&&(i=this._counter=a.slice(0),this._iv=void 0);var r=i.slice(0);n.encryptBlock(r,0),i[o-1]=i[o-1]+1|0;for(var s=0;s<o;s++)e[t+s]^=r[s]}}),o.Decryptor=a,o),n.mode.CTR)})),dC((function(e,t){var n;e.exports=((n=pC).mode.CTRGladman=function(){var e=n.lib.BlockCipherMode.extend();function t(e){if(255&~(e>>24))e+=1<<24;else{var t=e>>16&255,n=e>>8&255,o=255&e;255===t?(t=0,255===n?(n=0,255===o?o=0:++o):++n):++t,e=0,e+=t<<16,e+=n<<8,e+=o}return e}var o=e.Encryptor=e.extend({processBlock:function(e,n){var o,a=this._cipher,i=a.blockSize,r=this._iv,s=this._counter;r&&(s=this._counter=r.slice(0),this._iv=void 0),0===((o=s)[0]=t(o[0]))&&(o[1]=t(o[1]));var l=s.slice(0);a.encryptBlock(l,0);for(var c=0;c<i;c++)e[n+c]^=l[c]}});return e.Decryptor=o,e}(),n.mode.CTRGladman)})),dC((function(e,t){var n,o,a;e.exports=((n=pC).mode.OFB=(a=(o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){var n=this._cipher,o=n.blockSize,a=this._iv,i=this._keystream;a&&(i=this._keystream=a.slice(0),this._iv=void 0),n.encryptBlock(i,0);for(var r=0;r<o;r++)e[t+r]^=i[r]}}),o.Decryptor=a,o),n.mode.OFB)})),dC((function(e,t){var n,o;e.exports=((n=pC).mode.ECB=((o=n.lib.BlockCipherMode.extend()).Encryptor=o.extend({processBlock:function(e,t){this._cipher.encryptBlock(e,t)}}),o.Decryptor=o.extend({processBlock:function(e,t){this._cipher.decryptBlock(e,t)}}),o),n.mode.ECB)})),dC((function(e,t){var n;e.exports=((n=pC).pad.AnsiX923={pad:function(e,t){var n=e.sigBytes,o=4*t,a=o-n%o,i=n+a-1;e.clamp(),e.words[i>>>2]|=a<<24-i%4*8,e.sigBytes+=a},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Ansix923)})),dC((function(e,t){var n;e.exports=((n=pC).pad.Iso10126={pad:function(e,t){var o=4*t,a=o-e.sigBytes%o;e.concat(n.lib.WordArray.random(a-1)).concat(n.lib.WordArray.create([a<<24],1))},unpad:function(e){var t=255&e.words[e.sigBytes-1>>>2];e.sigBytes-=t}},n.pad.Iso10126)})),dC((function(e,t){var n;e.exports=((n=pC).pad.Iso97971={pad:function(e,t){e.concat(n.lib.WordArray.create([2147483648],1)),n.pad.ZeroPadding.pad(e,t)},unpad:function(e){n.pad.ZeroPadding.unpad(e),e.sigBytes--}},n.pad.Iso97971)})),dC((function(e,t){var n;e.exports=((n=pC).pad.ZeroPadding={pad:function(e,t){var n=4*t;e.clamp(),e.sigBytes+=n-(e.sigBytes%n||n)},unpad:function(e){for(var t=e.words,n=e.sigBytes-1;!(t[n>>>2]>>>24-n%4*8&255);)n--;e.sigBytes=n+1}},n.pad.ZeroPadding)})),dC((function(e,t){var n;e.exports=((n=pC).pad.NoPadding={pad:function(){},unpad:function(){}},n.pad.NoPadding)})),dC((function(e,t){var n,o,a,i;e.exports=(a=(o=n=pC).lib.CipherParams,i=o.enc.Hex,o.format.Hex={stringify:function(e){return e.ciphertext.toString(i)},parse:function(e){var t=i.parse(e);return a.create({ciphertext:t})}},n.format.Hex)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib.BlockCipher,o=e.algo,a=[],i=[],r=[],s=[],l=[],c=[],u=[],d=[],p=[],h=[];!function(){for(var e=[],t=0;t<256;t++)e[t]=t<128?t<<1:t<<1^283;var n=0,o=0;for(t=0;t<256;t++){var f=o^o<<1^o<<2^o<<3^o<<4;f=f>>>8^255&f^99,a[n]=f,i[f]=n;var g=e[n],m=e[g],v=e[m],_=257*e[f]^16843008*f;r[n]=_<<24|_>>>8,s[n]=_<<16|_>>>16,l[n]=_<<8|_>>>24,c[n]=_,_=16843009*v^65537*m^257*g^16843008*n,u[f]=_<<24|_>>>8,d[f]=_<<16|_>>>16,p[f]=_<<8|_>>>24,h[f]=_,n?(n=g^e[e[e[v^g]]],o^=e[e[o]]):n=o=1}}();var f=[0,1,2,4,8,16,32,64,128,27,54],g=o.AES=t.extend({_doReset:function(){if(!this._nRounds||this._keyPriorReset!==this._key){for(var e=this._keyPriorReset=this._key,t=e.words,n=e.sigBytes/4,o=4*((this._nRounds=n+6)+1),i=this._keySchedule=[],r=0;r<o;r++)if(r<n)i[r]=t[r];else{var s=i[r-1];r%n?n>6&&r%n==4&&(s=a[s>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s]):(s=a[(s=s<<8|s>>>24)>>>24]<<24|a[s>>>16&255]<<16|a[s>>>8&255]<<8|a[255&s],s^=f[r/n|0]<<24),i[r]=i[r-n]^s}for(var l=this._invKeySchedule=[],c=0;c<o;c++)r=o-c,s=c%4?i[r]:i[r-4],l[c]=c<4||r<=4?s:u[a[s>>>24]]^d[a[s>>>16&255]]^p[a[s>>>8&255]]^h[a[255&s]]}},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._keySchedule,r,s,l,c,a)},decryptBlock:function(e,t){var n=e[t+1];e[t+1]=e[t+3],e[t+3]=n,this._doCryptBlock(e,t,this._invKeySchedule,u,d,p,h,i),n=e[t+1],e[t+1]=e[t+3],e[t+3]=n},_doCryptBlock:function(e,t,n,o,a,i,r,s){for(var l=this._nRounds,c=e[t]^n[0],u=e[t+1]^n[1],d=e[t+2]^n[2],p=e[t+3]^n[3],h=4,f=1;f<l;f++){var g=o[c>>>24]^a[u>>>16&255]^i[d>>>8&255]^r[255&p]^n[h++],m=o[u>>>24]^a[d>>>16&255]^i[p>>>8&255]^r[255&c]^n[h++],v=o[d>>>24]^a[p>>>16&255]^i[c>>>8&255]^r[255&u]^n[h++],_=o[p>>>24]^a[c>>>16&255]^i[u>>>8&255]^r[255&d]^n[h++];c=g,u=m,d=v,p=_}g=(s[c>>>24]<<24|s[u>>>16&255]<<16|s[d>>>8&255]<<8|s[255&p])^n[h++],m=(s[u>>>24]<<24|s[d>>>16&255]<<16|s[p>>>8&255]<<8|s[255&c])^n[h++],v=(s[d>>>24]<<24|s[p>>>16&255]<<16|s[c>>>8&255]<<8|s[255&u])^n[h++],_=(s[p>>>24]<<24|s[c>>>16&255]<<16|s[u>>>8&255]<<8|s[255&d])^n[h++],e[t]=g,e[t+1]=m,e[t+2]=v,e[t+3]=_},keySize:8});e.AES=t._createHelper(g)}(),n.AES)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib,o=t.WordArray,a=t.BlockCipher,i=e.algo,r=[57,49,41,33,25,17,9,1,58,50,42,34,26,18,10,2,59,51,43,35,27,19,11,3,60,52,44,36,63,55,47,39,31,23,15,7,62,54,46,38,30,22,14,6,61,53,45,37,29,21,13,5,28,20,12,4],s=[14,17,11,24,1,5,3,28,15,6,21,10,23,19,12,4,26,8,16,7,27,20,13,2,41,52,31,37,47,55,30,40,51,45,33,48,44,49,39,56,34,53,46,42,50,36,29,32],l=[1,2,4,6,8,10,12,14,15,17,19,21,23,25,27,28],c=[{0:8421888,268435456:32768,536870912:8421378,805306368:2,1073741824:512,1342177280:8421890,1610612736:8389122,1879048192:8388608,2147483648:514,2415919104:8389120,2684354560:33280,2952790016:8421376,3221225472:32770,3489660928:8388610,3758096384:0,4026531840:33282,134217728:0,402653184:8421890,671088640:33282,939524096:32768,1207959552:8421888,1476395008:512,1744830464:8421378,2013265920:2,2281701376:8389120,2550136832:33280,2818572288:8421376,3087007744:8389122,3355443200:8388610,3623878656:32770,3892314112:514,4160749568:8388608,1:32768,268435457:2,536870913:8421888,805306369:8388608,1073741825:8421378,1342177281:33280,1610612737:512,1879048193:8389122,2147483649:8421890,2415919105:8421376,2684354561:8388610,2952790017:33282,3221225473:514,3489660929:8389120,3758096385:32770,4026531841:0,134217729:8421890,402653185:8421376,671088641:8388608,939524097:512,1207959553:32768,1476395009:8388610,1744830465:2,2013265921:33282,2281701377:32770,2550136833:8389122,2818572289:514,3087007745:8421888,3355443201:8389120,3623878657:0,3892314113:33280,4160749569:8421378},{0:1074282512,16777216:16384,33554432:524288,50331648:1074266128,67108864:1073741840,83886080:1074282496,100663296:1073758208,117440512:16,134217728:540672,150994944:1073758224,167772160:1073741824,184549376:540688,201326592:524304,218103808:0,234881024:16400,251658240:1074266112,8388608:1073758208,25165824:540688,41943040:16,58720256:1073758224,75497472:1074282512,92274688:1073741824,109051904:524288,125829120:1074266128,142606336:524304,159383552:0,176160768:16384,192937984:1074266112,209715200:1073741840,226492416:540672,243269632:1074282496,260046848:16400,268435456:0,285212672:1074266128,301989888:1073758224,318767104:1074282496,335544320:1074266112,352321536:16,369098752:540688,385875968:16384,402653184:16400,419430400:524288,436207616:524304,452984832:1073741840,469762048:540672,486539264:1073758208,503316480:1073741824,520093696:1074282512,276824064:540688,293601280:524288,310378496:1074266112,327155712:16384,343932928:1073758208,360710144:1074282512,377487360:16,394264576:1073741824,411041792:1074282496,427819008:1073741840,444596224:1073758224,461373440:524304,478150656:0,494927872:16400,511705088:1074266128,528482304:540672},{0:260,1048576:0,2097152:67109120,3145728:65796,4194304:65540,5242880:67108868,6291456:67174660,7340032:67174400,8388608:67108864,9437184:67174656,10485760:65792,11534336:67174404,12582912:67109124,13631488:65536,14680064:4,15728640:256,524288:67174656,1572864:67174404,2621440:0,3670016:67109120,4718592:67108868,5767168:65536,6815744:65540,7864320:260,8912896:4,9961472:256,11010048:67174400,12058624:65796,13107200:65792,14155776:67109124,15204352:67174660,16252928:67108864,16777216:67174656,17825792:65540,18874368:65536,19922944:67109120,20971520:256,22020096:67174660,23068672:67108868,24117248:0,25165824:67109124,26214400:67108864,27262976:4,28311552:65792,29360128:67174400,30408704:260,31457280:65796,32505856:67174404,17301504:67108864,18350080:260,19398656:67174656,20447232:0,21495808:65540,22544384:67109120,23592960:256,24641536:67174404,25690112:65536,26738688:67174660,27787264:65796,28835840:67108868,29884416:67109124,30932992:67174400,31981568:4,33030144:65792},{0:2151682048,65536:2147487808,131072:4198464,196608:2151677952,262144:0,327680:4198400,393216:2147483712,458752:4194368,524288:2147483648,589824:4194304,655360:64,720896:2147487744,786432:2151678016,851968:4160,917504:4096,983040:2151682112,32768:2147487808,98304:64,163840:2151678016,229376:2147487744,294912:4198400,360448:2151682112,425984:0,491520:2151677952,557056:4096,622592:2151682048,688128:4194304,753664:4160,819200:2147483648,884736:4194368,950272:4198464,1015808:2147483712,1048576:4194368,1114112:4198400,1179648:2147483712,1245184:0,1310720:4160,1376256:2151678016,1441792:2151682048,1507328:2147487808,1572864:2151682112,1638400:2147483648,1703936:2151677952,1769472:4198464,1835008:2147487744,1900544:4194304,1966080:64,2031616:4096,1081344:2151677952,1146880:2151682112,1212416:0,1277952:4198400,1343488:4194368,1409024:2147483648,1474560:2147487808,1540096:64,1605632:2147483712,1671168:4096,1736704:2147487744,1802240:2151678016,1867776:4160,1933312:2151682048,1998848:4194304,2064384:4198464},{0:128,4096:17039360,8192:262144,12288:536870912,16384:537133184,20480:16777344,24576:553648256,28672:262272,32768:16777216,36864:537133056,40960:536871040,45056:553910400,49152:553910272,53248:0,57344:17039488,61440:553648128,2048:17039488,6144:553648256,10240:128,14336:17039360,18432:262144,22528:537133184,26624:553910272,30720:536870912,34816:537133056,38912:0,43008:553910400,47104:16777344,51200:536871040,55296:553648128,59392:16777216,63488:262272,65536:262144,69632:128,73728:536870912,77824:553648256,81920:16777344,86016:553910272,90112:537133184,94208:16777216,98304:553910400,102400:553648128,106496:17039360,110592:537133056,114688:262272,118784:536871040,122880:0,126976:17039488,67584:553648256,71680:16777216,75776:17039360,79872:537133184,83968:536870912,88064:17039488,92160:128,96256:553910272,100352:262272,104448:553910400,108544:0,112640:553648128,116736:16777344,120832:262144,124928:537133056,129024:536871040},{0:268435464,256:8192,512:270532608,768:270540808,1024:268443648,1280:2097152,1536:2097160,1792:268435456,2048:0,2304:268443656,2560:2105344,2816:8,3072:270532616,3328:2105352,3584:8200,3840:270540800,128:270532608,384:270540808,640:8,896:2097152,1152:2105352,1408:268435464,1664:268443648,1920:8200,2176:2097160,2432:8192,2688:268443656,2944:270532616,3200:0,3456:270540800,3712:2105344,3968:268435456,4096:268443648,4352:270532616,4608:270540808,4864:8200,5120:2097152,5376:268435456,5632:268435464,5888:2105344,6144:2105352,6400:0,6656:8,6912:270532608,7168:8192,7424:268443656,7680:270540800,7936:2097160,4224:8,4480:2105344,4736:2097152,4992:268435464,5248:268443648,5504:8200,5760:270540808,6016:270532608,6272:270540800,6528:270532616,6784:8192,7040:2105352,7296:2097160,7552:0,7808:268435456,8064:268443656},{0:1048576,16:33555457,32:1024,48:1049601,64:34604033,80:0,96:1,112:34603009,128:33555456,144:1048577,160:33554433,176:34604032,192:34603008,208:1025,224:1049600,240:33554432,8:34603009,24:0,40:33555457,56:34604032,72:1048576,88:33554433,104:33554432,120:1025,136:1049601,152:33555456,168:34603008,184:1048577,200:1024,216:34604033,232:1,248:1049600,256:33554432,272:1048576,288:33555457,304:34603009,320:1048577,336:33555456,352:34604032,368:1049601,384:1025,400:34604033,416:1049600,432:1,448:0,464:34603008,480:33554433,496:1024,264:1049600,280:33555457,296:34603009,312:1,328:33554432,344:1048576,360:1025,376:34604032,392:33554433,408:34603008,424:0,440:34604033,456:1049601,472:1024,488:33555456,504:1048577},{0:134219808,1:131072,2:134217728,3:32,4:131104,5:134350880,6:134350848,7:2048,8:134348800,9:134219776,10:133120,11:134348832,12:2080,13:0,14:134217760,15:133152,2147483648:2048,2147483649:134350880,2147483650:134219808,2147483651:134217728,2147483652:134348800,2147483653:133120,2147483654:133152,2147483655:32,2147483656:134217760,2147483657:2080,2147483658:131104,2147483659:134350848,2147483660:0,2147483661:134348832,2147483662:134219776,2147483663:131072,16:133152,17:134350848,18:32,19:2048,20:134219776,21:134217760,22:134348832,23:131072,24:0,25:131104,26:134348800,27:134219808,28:134350880,29:133120,30:2080,31:134217728,2147483664:131072,2147483665:2048,2147483666:134348832,2147483667:133152,2147483668:32,2147483669:134348800,2147483670:134217728,2147483671:134219808,2147483672:134350880,2147483673:134217760,2147483674:134219776,2147483675:0,2147483676:133120,2147483677:2080,2147483678:131104,2147483679:134350848}],u=[4160749569,528482304,33030144,2064384,129024,8064,504,2147483679],d=i.DES=a.extend({_doReset:function(){for(var e=this._key.words,t=[],n=0;n<56;n++){var o=r[n]-1;t[n]=e[o>>>5]>>>31-o%32&1}for(var a=this._subKeys=[],i=0;i<16;i++){var c=a[i]=[],u=l[i];for(n=0;n<24;n++)c[n/6|0]|=t[(s[n]-1+u)%28]<<31-n%6,c[4+(n/6|0)]|=t[28+(s[n+24]-1+u)%28]<<31-n%6;for(c[0]=c[0]<<1|c[0]>>>31,n=1;n<7;n++)c[n]=c[n]>>>4*(n-1)+3;c[7]=c[7]<<5|c[7]>>>27}var d=this._invSubKeys=[];for(n=0;n<16;n++)d[n]=a[15-n]},encryptBlock:function(e,t){this._doCryptBlock(e,t,this._subKeys)},decryptBlock:function(e,t){this._doCryptBlock(e,t,this._invSubKeys)},_doCryptBlock:function(e,t,n){this._lBlock=e[t],this._rBlock=e[t+1],p.call(this,4,252645135),p.call(this,16,65535),h.call(this,2,858993459),h.call(this,8,16711935),p.call(this,1,1431655765);for(var o=0;o<16;o++){for(var a=n[o],i=this._lBlock,r=this._rBlock,s=0,l=0;l<8;l++)s|=c[l][((r^a[l])&u[l])>>>0];this._lBlock=r,this._rBlock=i^s}var d=this._lBlock;this._lBlock=this._rBlock,this._rBlock=d,p.call(this,1,1431655765),h.call(this,8,16711935),h.call(this,2,858993459),p.call(this,16,65535),p.call(this,4,252645135),e[t]=this._lBlock,e[t+1]=this._rBlock},keySize:2,ivSize:2,blockSize:2});function p(e,t){var n=(this._lBlock>>>e^this._rBlock)&t;this._rBlock^=n,this._lBlock^=n<<e}function h(e,t){var n=(this._rBlock>>>e^this._lBlock)&t;this._lBlock^=n,this._rBlock^=n<<e}e.DES=a._createHelper(d);var f=i.TripleDES=a.extend({_doReset:function(){var e=this._key.words;this._des1=d.createEncryptor(o.create(e.slice(0,2))),this._des2=d.createEncryptor(o.create(e.slice(2,4))),this._des3=d.createEncryptor(o.create(e.slice(4,6)))},encryptBlock:function(e,t){this._des1.encryptBlock(e,t),this._des2.decryptBlock(e,t),this._des3.encryptBlock(e,t)},decryptBlock:function(e,t){this._des3.decryptBlock(e,t),this._des2.encryptBlock(e,t),this._des1.decryptBlock(e,t)},keySize:6,ivSize:2,blockSize:2});e.TripleDES=a._createHelper(f)}(),n.TripleDES)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,a=o.RC4=t.extend({_doReset:function(){for(var e=this._key,t=e.words,n=e.sigBytes,o=this._S=[],a=0;a<256;a++)o[a]=a;a=0;for(var i=0;a<256;a++){var r=a%n,s=t[r>>>2]>>>24-r%4*8&255;i=(i+o[a]+s)%256;var l=o[a];o[a]=o[i],o[i]=l}this._i=this._j=0},_doProcessBlock:function(e,t){e[t]^=i.call(this)},keySize:8,ivSize:0});function i(){for(var e=this._S,t=this._i,n=this._j,o=0,a=0;a<4;a++){n=(n+e[t=(t+1)%256])%256;var i=e[t];e[t]=e[n],e[n]=i,o|=e[(e[t]+e[n])%256]<<24-8*a}return this._i=t,this._j=n,o}e.RC4=t._createHelper(a);var r=o.RC4Drop=a.extend({cfg:a.cfg.extend({drop:192}),_doReset:function(){a._doReset.call(this);for(var e=this.cfg.drop;e>0;e--)i.call(this)}});e.RC4Drop=t._createHelper(r)}(),n.RC4)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,a=[],i=[],r=[],s=o.Rabbit=t.extend({_doReset:function(){for(var e=this._key.words,t=this.cfg.iv,n=0;n<4;n++)e[n]=16711935&(e[n]<<8|e[n]>>>24)|4278255360&(e[n]<<24|e[n]>>>8);var o=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],a=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];for(this._b=0,n=0;n<4;n++)l.call(this);for(n=0;n<8;n++)a[n]^=o[n+4&7];if(t){var i=t.words,r=i[0],s=i[1],c=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(a[0]^=c,a[1]^=d,a[2]^=u,a[3]^=p,a[4]^=c,a[5]^=d,a[6]^=u,a[7]^=p,n=0;n<4;n++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)a[o]=16711935&(a[o]<<8|a[o]>>>24)|4278255360&(a[o]<<24|a[o]>>>8),e[t+o]^=a[o]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],a=65535&o,s=o>>>16,l=((a*a>>>17)+a*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);r[n]=l^c}e[0]=r[0]+(r[7]<<16|r[7]>>>16)+(r[6]<<16|r[6]>>>16)|0,e[1]=r[1]+(r[0]<<8|r[0]>>>24)+r[7]|0,e[2]=r[2]+(r[1]<<16|r[1]>>>16)+(r[0]<<16|r[0]>>>16)|0,e[3]=r[3]+(r[2]<<8|r[2]>>>24)+r[1]|0,e[4]=r[4]+(r[3]<<16|r[3]>>>16)+(r[2]<<16|r[2]>>>16)|0,e[5]=r[5]+(r[4]<<8|r[4]>>>24)+r[3]|0,e[6]=r[6]+(r[5]<<16|r[5]>>>16)+(r[4]<<16|r[4]>>>16)|0,e[7]=r[7]+(r[6]<<8|r[6]>>>24)+r[5]|0}e.Rabbit=t._createHelper(s)}(),n.Rabbit)})),dC((function(e,t){var n;e.exports=(n=pC,function(){var e=n,t=e.lib.StreamCipher,o=e.algo,a=[],i=[],r=[],s=o.RabbitLegacy=t.extend({_doReset:function(){var e=this._key.words,t=this.cfg.iv,n=this._X=[e[0],e[3]<<16|e[2]>>>16,e[1],e[0]<<16|e[3]>>>16,e[2],e[1]<<16|e[0]>>>16,e[3],e[2]<<16|e[1]>>>16],o=this._C=[e[2]<<16|e[2]>>>16,4294901760&e[0]|65535&e[1],e[3]<<16|e[3]>>>16,4294901760&e[1]|65535&e[2],e[0]<<16|e[0]>>>16,4294901760&e[2]|65535&e[3],e[1]<<16|e[1]>>>16,4294901760&e[3]|65535&e[0]];this._b=0;for(var a=0;a<4;a++)l.call(this);for(a=0;a<8;a++)o[a]^=n[a+4&7];if(t){var i=t.words,r=i[0],s=i[1],c=16711935&(r<<8|r>>>24)|4278255360&(r<<24|r>>>8),u=16711935&(s<<8|s>>>24)|4278255360&(s<<24|s>>>8),d=c>>>16|4294901760&u,p=u<<16|65535&c;for(o[0]^=c,o[1]^=d,o[2]^=u,o[3]^=p,o[4]^=c,o[5]^=d,o[6]^=u,o[7]^=p,a=0;a<4;a++)l.call(this)}},_doProcessBlock:function(e,t){var n=this._X;l.call(this),a[0]=n[0]^n[5]>>>16^n[3]<<16,a[1]=n[2]^n[7]>>>16^n[5]<<16,a[2]=n[4]^n[1]>>>16^n[7]<<16,a[3]=n[6]^n[3]>>>16^n[1]<<16;for(var o=0;o<4;o++)a[o]=16711935&(a[o]<<8|a[o]>>>24)|4278255360&(a[o]<<24|a[o]>>>8),e[t+o]^=a[o]},blockSize:4,ivSize:2});function l(){for(var e=this._X,t=this._C,n=0;n<8;n++)i[n]=t[n];for(t[0]=t[0]+1295307597+this._b|0,t[1]=t[1]+3545052371+(t[0]>>>0<i[0]>>>0?1:0)|0,t[2]=t[2]+886263092+(t[1]>>>0<i[1]>>>0?1:0)|0,t[3]=t[3]+1295307597+(t[2]>>>0<i[2]>>>0?1:0)|0,t[4]=t[4]+3545052371+(t[3]>>>0<i[3]>>>0?1:0)|0,t[5]=t[5]+886263092+(t[4]>>>0<i[4]>>>0?1:0)|0,t[6]=t[6]+1295307597+(t[5]>>>0<i[5]>>>0?1:0)|0,t[7]=t[7]+3545052371+(t[6]>>>0<i[6]>>>0?1:0)|0,this._b=t[7]>>>0<i[7]>>>0?1:0,n=0;n<8;n++){var o=e[n]+t[n],a=65535&o,s=o>>>16,l=((a*a>>>17)+a*s>>>15)+s*s,c=((4294901760&o)*o|0)+((65535&o)*o|0);r[n]=l^c}e[0]=r[0]+(r[7]<<16|r[7]>>>16)+(r[6]<<16|r[6]>>>16)|0,e[1]=r[1]+(r[0]<<8|r[0]>>>24)+r[7]|0,e[2]=r[2]+(r[1]<<16|r[1]>>>16)+(r[0]<<16|r[0]>>>16)|0,e[3]=r[3]+(r[2]<<8|r[2]>>>24)+r[1]|0,e[4]=r[4]+(r[3]<<16|r[3]>>>16)+(r[2]<<16|r[2]>>>16)|0,e[5]=r[5]+(r[4]<<8|r[4]>>>24)+r[3]|0,e[6]=r[6]+(r[5]<<16|r[5]>>>16)+(r[4]<<16|r[4]>>>16)|0,e[7]=r[7]+(r[6]<<8|r[6]>>>24)+r[5]|0}e.RabbitLegacy=t._createHelper(s)}(),n.RabbitLegacy)})),dC((function(e,t){e.exports=pC})));function fC(){throw new Error("setTimeout has not been defined")}function gC(){throw new Error("clearTimeout has not been defined")}var mC=fC,vC=gC;function _C(e){if(mC===setTimeout)return setTimeout(e,0);if((mC===fC||!mC)&&setTimeout)return mC=setTimeout,setTimeout(e,0);try{return mC(e,0)}catch(t){try{return mC.call(null,e,0)}catch(n){return mC.call(this,e,0)}}}"function"==typeof pI.setTimeout&&(mC=setTimeout),"function"==typeof pI.clearTimeout&&(vC=clearTimeout);var yC,IC=[],CC=!1,kC=-1;function EC(){CC&&yC&&(CC=!1,yC.length?IC=yC.concat(IC):kC=-1,IC.length&&TC())}function TC(){if(!CC){var e=_C(EC);CC=!0;for(var t=IC.length;t;){for(yC=IC,IC=[];++kC<t;)yC&&yC[kC].run();kC=-1,t=IC.length}yC=null,CC=!1,function(e){if(vC===clearTimeout)return clearTimeout(e);if((vC===gC||!vC)&&clearTimeout)return vC=clearTimeout,clearTimeout(e);try{vC(e)}catch(t){try{return vC.call(null,e)}catch(n){return vC.call(this,e)}}}(e)}}function SC(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];IC.push(new MC(e,t)),1!==IC.length||CC||_C(TC)}function MC(e,t){this.fun=e,this.array=t}MC.prototype.run=function(){this.fun.apply(null,this.array)};var wC=pI.performance||{};function bC(){}function DC(){DC.init.call(this)}function NC(e){return void 0===e._maxListeners?DC.defaultMaxListeners:e._maxListeners}function RC(e,t,n,o){var a,i,r,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((i=e._events)?(i.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),i=e._events),r=i[t]):(i=e._events=new bC,e._eventsCount=0),r){if("function"==typeof r?r=i[t]=o?[n,r]:[r,n]:o?r.unshift(n):r.push(n),!r.warned&&(a=NC(e))&&a>0&&r.length>a){r.warned=!0;var l=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+t+" listeners added. Use emitter.setMaxListeners() to increase limit");l.name="MaxListenersExceededWarning",l.emitter=e,l.type=t,l.count=r.length,s=l,"function"==typeof console.warn?oe("warn","at sdk/lib-generate-test-usersig-es.min.js:2",s):oe("log","at sdk/lib-generate-test-usersig-es.min.js:2",s)}}else r=i[t]=n,++e._eventsCount;return e}function LC(e,t,n){var o=!1;function a(){e.removeListener(t,a),o||(o=!0,n.apply(e,arguments))}return a.listener=n,a}function AC(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function OC(e,t){for(var n=new Array(t);t--;)n[t]=e[t];return n}wC.now||wC.mozNow||wC.msNow||wC.oNow||wC.webkitNow,bC.prototype=Object.create(null),DC.EventEmitter=DC,DC.usingDomains=!1,DC.prototype.domain=void 0,DC.prototype._events=void 0,DC.prototype._maxListeners=void 0,DC.defaultMaxListeners=10,DC.init=function(){this.domain=null,DC.usingDomains&&(void 0).active&&(void 0).Domain,this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=new bC,this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},DC.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},DC.prototype.getMaxListeners=function(){return NC(this)},DC.prototype.emit=function(e){var t,n,o,a,i,r,s,l="error"===e;if(r=this._events)l=l&&null==r.error;else if(!l)return!1;if(s=this.domain,l){if(t=arguments[1],!s){if(t instanceof Error)throw t;var c=new Error('Uncaught, unspecified "error" event. ('+t+")");throw c.context=t,c}return t||(t=new Error('Uncaught, unspecified "error" event')),t.domainEmitter=this,t.domain=s,t.domainThrown=!1,s.emit("error",t),!1}if(!(n=r[e]))return!1;var u="function"==typeof n;switch(o=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var o=e.length,a=OC(e,o),i=0;i<o;++i)a[i].call(n)}(n,u,this);break;case 2:!function(e,t,n,o){if(t)e.call(n,o);else for(var a=e.length,i=OC(e,a),r=0;r<a;++r)i[r].call(n,o)}(n,u,this,arguments[1]);break;case 3:!function(e,t,n,o,a){if(t)e.call(n,o,a);else for(var i=e.length,r=OC(e,i),s=0;s<i;++s)r[s].call(n,o,a)}(n,u,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,o,a,i){if(t)e.call(n,o,a,i);else for(var r=e.length,s=OC(e,r),l=0;l<r;++l)s[l].call(n,o,a,i)}(n,u,this,arguments[1],arguments[2],arguments[3]);break;default:for(a=new Array(o-1),i=1;i<o;i++)a[i-1]=arguments[i];!function(e,t,n,o){if(t)e.apply(n,o);else for(var a=e.length,i=OC(e,a),r=0;r<a;++r)i[r].apply(n,o)}(n,u,this,a)}return!0},DC.prototype.addListener=function(e,t){return RC(this,e,t,!1)},DC.prototype.on=DC.prototype.addListener,DC.prototype.prependListener=function(e,t){return RC(this,e,t,!0)},DC.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,LC(this,e,t)),this},DC.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,LC(this,e,t)),this},DC.prototype.removeListener=function(e,t){var n,o,a,i,r;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(o=this._events))return this;if(!(n=o[e]))return this;if(n===t||n.listener&&n.listener===t)0==--this._eventsCount?this._events=new bC:(delete o[e],o.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,i=n.length;i-- >0;)if(n[i]===t||n[i].listener&&n[i].listener===t){r=n[i].listener,a=i;break}if(a<0)return this;if(1===n.length){if(n[0]=void 0,0==--this._eventsCount)return this._events=new bC,this;delete o[e]}else!function(e,t){for(var n=t,o=n+1,a=e.length;o<a;n+=1,o+=1)e[n]=e[o];e.pop()}(n,a);o.removeListener&&this.emit("removeListener",e,r||t)}return this},DC.prototype.removeAllListeners=function(e){var t,n;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=new bC,this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=new bC:delete n[e]),this;if(0===arguments.length){for(var o,a=Object.keys(n),i=0;i<a.length;++i)"removeListener"!==(o=a[i])&&this.removeAllListeners(o);return this.removeAllListeners("removeListener"),this._events=new bC,this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)do{this.removeListener(e,t[t.length-1])}while(t[0]);return this},DC.prototype.listeners=function(e){var t,n=this._events;return n&&(t=n[e])?"function"==typeof t?[t.listener||t]:function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(t):[]},DC.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):AC.call(e,t)},DC.prototype.listenerCount=AC,DC.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]};var PC="function"==typeof Object.create?function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:function(e,t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e},UC=/%[sdj%]/g;function xC(e){if(!WC(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(FC(arguments[n]));return t.join(" ")}n=1;for(var o=arguments,a=o.length,i=String(e).replace(UC,(function(e){if("%%"===e)return"%";if(n>=a)return e;switch(e){case"%s":return String(o[n++]);case"%d":return Number(o[n++]);case"%j":try{return JSON.stringify(o[n++])}catch(t){return"[Circular]"}default:return e}})),r=o[n];n<a;r=o[++n])$C(r)||!XC(r)?i+=" "+r:i+=" "+FC(r);return i}function VC(e,t){if(ZC(pI.process))return function(){return VC(e,t).apply(this,arguments)};var n=!1;return function(){return n||(oe("error","at sdk/lib-generate-test-usersig-es.min.js:2",t),n=!0),e.apply(this,arguments)}}var BC,GC={};function FC(e,t){var n={seen:[],stylize:HC};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),YC(t)?n.showHidden=t:t&&function(e,t){if(!t||!XC(t))return e;for(var n=Object.keys(t),o=n.length;o--;)e[n[o]]=t[n[o]]}(n,t),ZC(n.showHidden)&&(n.showHidden=!1),ZC(n.depth)&&(n.depth=2),ZC(n.colors)&&(n.colors=!1),ZC(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=zC),jC(n,e,n.depth)}function zC(e,t){var n=FC.styles[t];return n?"["+FC.colors[n][0]+"m"+e+"["+FC.colors[n][1]+"m":e}function HC(e,t){return e}function jC(e,t,n){if(e.customInspect&&t&&tk(t.inspect)&&t.inspect!==FC&&(!t.constructor||t.constructor.prototype!==t)){var o=t.inspect(n,e);return WC(o)||(o=jC(e,o,n)),o}var a=function(e,t){if(ZC(t))return e.stylize("undefined","undefined");if(WC(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}return"number"==typeof t?e.stylize(""+t,"number"):YC(t)?e.stylize(""+t,"boolean"):$C(t)?e.stylize("null","null"):void 0}(e,t);if(a)return a;var i,r=Object.keys(t),s=(i={},r.forEach((function(e,t){i[e]=!0})),i);if(e.showHidden&&(r=Object.getOwnPropertyNames(t)),ek(t)&&(r.indexOf("message")>=0||r.indexOf("description")>=0))return qC(t);if(0===r.length){if(tk(t)){var l=t.name?": "+t.name:"";return e.stylize("[Function"+l+"]","special")}if(JC(t))return e.stylize(RegExp.prototype.toString.call(t),"regexp");if(QC(t))return e.stylize(Date.prototype.toString.call(t),"date");if(ek(t))return qC(t)}var c,u,d="",p=!1,h=["{","}"];return c=t,Array.isArray(c)&&(p=!0,h=["[","]"]),tk(t)&&(d=" [Function"+(t.name?": "+t.name:"")+"]"),JC(t)&&(d=" "+RegExp.prototype.toString.call(t)),QC(t)&&(d=" "+Date.prototype.toUTCString.call(t)),ek(t)&&(d=" "+qC(t)),0!==r.length||p&&0!=t.length?n<0?JC(t)?e.stylize(RegExp.prototype.toString.call(t),"regexp"):e.stylize("[Object]","special"):(e.seen.push(t),u=p?function(e,t,n,o,a){for(var i=[],r=0,s=t.length;r<s;++r)ok(t,String(r))?i.push(KC(e,t,n,o,String(r),!0)):i.push("");return a.forEach((function(a){a.match(/^\d+$/)||i.push(KC(e,t,n,o,a,!0))})),i}(e,t,n,s,r):r.map((function(o){return KC(e,t,n,s,o,p)})),e.seen.pop(),function(e,t,n){return e.reduce((function(e,t){return t.indexOf("\n"),e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60?n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1]:n[0]+t+" "+e.join(", ")+" "+n[1]}(u,d,h)):h[0]+d+h[1]}function qC(e){return"["+Error.prototype.toString.call(e)+"]"}function KC(e,t,n,o,a,i){var r,s,l;if((l=Object.getOwnPropertyDescriptor(t,a)||{value:t[a]}).get?s=l.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):l.set&&(s=e.stylize("[Setter]","special")),ok(o,a)||(r="["+a+"]"),s||(e.seen.indexOf(l.value)<0?(s=$C(n)?jC(e,l.value,null):jC(e,l.value,n-1)).indexOf("\n")>-1&&(s=i?s.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+s.split("\n").map((function(e){return"   "+e})).join("\n")):s=e.stylize("[Circular]","special")),ZC(r)){if(i&&a.match(/^\d+$/))return s;(r=JSON.stringify(""+a)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(r=r.substr(1,r.length-2),r=e.stylize(r,"name")):(r=r.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),r=e.stylize(r,"string"))}return r+": "+s}function YC(e){return"boolean"==typeof e}function $C(e){return null===e}function WC(e){return"string"==typeof e}function ZC(e){return void 0===e}function JC(e){return XC(e)&&"[object RegExp]"===nk(e)}function XC(e){return"object"==typeof e&&null!==e}function QC(e){return XC(e)&&"[object Date]"===nk(e)}function ek(e){return XC(e)&&("[object Error]"===nk(e)||e instanceof Error)}function tk(e){return"function"==typeof e}function nk(e){return Object.prototype.toString.call(e)}function ok(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function ak(){this.head=null,this.tail=null,this.length=0}FC.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},FC.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},ak.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},ak.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},ak.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},ak.prototype.clear=function(){this.head=this.tail=null,this.length=0},ak.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,n=""+t.data;t=t.next;)n+=e+t.data;return n},ak.prototype.concat=function(e){if(0===this.length)return MI.alloc(0);if(1===this.length)return this.head.data;for(var t=MI.allocUnsafe(e>>>0),n=this.head,o=0;n;)n.data.copy(t,o),o+=n.data.length,n=n.next;return t};var ik=MI.isEncoding||function(e){switch(e&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function rk(e){switch(this.encoding=(e||"utf8").toLowerCase().replace(/[-_]/,""),function(e){if(e&&!ik(e))throw new Error("Unknown encoding: "+e)}(e),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=lk;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=ck;break;default:return void(this.write=sk)}this.charBuffer=new MI(6),this.charReceived=0,this.charLength=0}function sk(e){return e.toString(this.encoding)}function lk(e){this.charReceived=e.length%2,this.charLength=this.charReceived?2:0}function ck(e){this.charReceived=e.length%3,this.charLength=this.charReceived?3:0}rk.prototype.write=function(e){for(var t="";this.charLength;){var n=e.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:e.length;if(e.copy(this.charBuffer,this.charReceived,0,n),this.charReceived+=n,this.charReceived<this.charLength)return"";if(e=e.slice(n,e.length),!((o=(t=this.charBuffer.slice(0,this.charLength).toString(this.encoding)).charCodeAt(t.length-1))>=55296&&o<=56319)){if(this.charReceived=this.charLength=0,0===e.length)return t;break}this.charLength+=this.surrogateSize,t=""}this.detectIncompleteChar(e);var o,a=e.length;if(this.charLength&&(e.copy(this.charBuffer,0,e.length-this.charReceived,a),a-=this.charReceived),a=(t+=e.toString(this.encoding,0,a)).length-1,(o=t.charCodeAt(a))>=55296&&o<=56319){var i=this.surrogateSize;return this.charLength+=i,this.charReceived+=i,this.charBuffer.copy(this.charBuffer,i,0,i),e.copy(this.charBuffer,0,0,i),t.substring(0,a)}return t},rk.prototype.detectIncompleteChar=function(e){for(var t=e.length>=3?3:e.length;t>0;t--){var n=e[e.length-t];if(1==t&&n>>5==6){this.charLength=2;break}if(t<=2&&n>>4==14){this.charLength=3;break}if(t<=3&&n>>3==30){this.charLength=4;break}}this.charReceived=t},rk.prototype.end=function(e){var t="";if(e&&e.length&&(t=this.write(e)),this.charReceived){var n=this.charReceived,o=this.charBuffer,a=this.encoding;t+=o.slice(0,n).toString(a)}return t},pk.ReadableState=dk;var uk=function(e){return ZC(BC)&&(BC=""),e=e.toUpperCase(),GC[e]||(new RegExp("\\b"+e+"\\b","i").test(BC)?GC[e]=function(){var t=xC.apply(null,arguments);oe("error","at sdk/lib-generate-test-usersig-es.min.js:2","%s %d: %s",e,0,t)}:GC[e]=function(){}),GC[e]}("stream");function dk(e,t){e=e||{},this.objectMode=!!e.objectMode,t instanceof Gk&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:o,this.highWaterMark=~~this.highWaterMark,this.buffer=new ak,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(this.decoder=new rk(e.encoding),this.encoding=e.encoding)}function pk(e){if(!(this instanceof pk))return new pk(e);this._readableState=new dk(e,this),this.readable=!0,e&&"function"==typeof e.read&&(this._read=e.read),DC.call(this)}function hk(e,t,n,o,a){var i,r,s,l=(i=t,s=null,cC(r=n)||"string"==typeof r||null==r||i.objectMode||(s=new TypeError("Invalid non-string/buffer chunk")),s);if(l)e.emit("error",l);else if(null===n)t.reading=!1,function(e,t){if(!t.ended){if(t.decoder){var n=t.decoder.end();n&&n.length&&(t.buffer.push(n),t.length+=t.objectMode?1:n.length)}t.ended=!0,mk(e)}}(e,t);else if(t.objectMode||n&&n.length>0)if(t.ended&&!a){var c=new Error("stream.push() after EOF");e.emit("error",c)}else if(t.endEmitted&&a){var u=new Error("stream.unshift() after end event");e.emit("error",u)}else{var d;!t.decoder||a||o||(n=t.decoder.write(n),d=!t.objectMode&&0===n.length),a||(t.reading=!1),d||(t.flowing&&0===t.length&&!t.sync?(e.emit("data",n),e.read(0)):(t.length+=t.objectMode?1:n.length,a?t.buffer.unshift(n):t.buffer.push(n),t.needReadable&&mk(e))),function(e,t){t.readingMore||(t.readingMore=!0,SC(_k,e,t))}(e,t)}else a||(t.reading=!1);return function(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}(t)}PC(pk,DC),pk.prototype.push=function(e,t){var n=this._readableState;return n.objectMode||"string"!=typeof e||(t=t||n.defaultEncoding)!==n.encoding&&(e=MI.from(e,t),t=""),hk(this,n,e,t,!1)},pk.prototype.unshift=function(e){return hk(this,this._readableState,e,"",!0)},pk.prototype.isPaused=function(){return!1===this._readableState.flowing},pk.prototype.setEncoding=function(e){return this._readableState.decoder=new rk(e),this._readableState.encoding=e,this};var fk=8388608;function gk(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!=e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=((n=e)>=fk?n=fk:(n--,n|=n>>>1,n|=n>>>2,n|=n>>>4,n|=n>>>8,n|=n>>>16,n++),n)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0));var n}function mk(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(uk("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?SC(vk,e):vk(e))}function vk(e){uk("emit readable"),e.emit("readable"),Ck(e)}function _k(e,t){for(var n=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(uk("maybeReadMore read 0"),e.read(0),n!==t.length);)n=t.length;t.readingMore=!1}function yk(e){uk("readable nexttick read 0"),e.read(0)}function Ik(e,t){t.reading||(uk("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),Ck(e),t.flowing&&!t.reading&&e.read(0)}function Ck(e){var t=e._readableState;for(uk("flow",t.flowing);t.flowing&&null!==e.read(););}function kk(e,t){return 0===t.length?null:(t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):(n=e,o=t.buffer,a=t.decoder,n<o.head.data.length?(i=o.head.data.slice(0,n),o.head.data=o.head.data.slice(n)):i=n===o.head.data.length?o.shift():a?function(e,t){var n=t.head,o=1,a=n.data;for(e-=a.length;n=n.next;){var i=n.data,r=e>i.length?i.length:e;if(r===i.length?a+=i:a+=i.slice(0,e),0==(e-=r)){r===i.length?(++o,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=i.slice(r));break}++o}return t.length-=o,a}(n,o):function(e,t){var n=MI.allocUnsafe(e),o=t.head,a=1;for(o.data.copy(n),e-=o.data.length;o=o.next;){var i=o.data,r=e>i.length?i.length:e;if(i.copy(n,n.length-e,0,r),0==(e-=r)){r===i.length?(++a,o.next?t.head=o.next:t.head=t.tail=null):(t.head=o,o.data=i.slice(r));break}++a}return t.length-=a,n}(n,o),r=i),r);var n,o,a,i,r}function Ek(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,SC(Tk,t,e))}function Tk(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function Sk(e,t){for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function Mk(){}function wk(e,t,n){this.chunk=e,this.encoding=t,this.callback=n,this.next=null}function bk(e,t){Object.defineProperty(this,"buffer",{get:VC((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.")}),e=e||{},this.objectMode=!!e.objectMode,t instanceof Gk&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,o=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:o,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var a=!1===e.decodeStrings;this.decodeStrings=!a,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){!function(e,t){var n,o=e._writableState,a=o.sync,i=o.writecb;if((n=o).writing=!1,n.writecb=null,n.length-=n.writelen,n.writelen=0,t)!function(e,t,n,o,a){--t.pendingcb,n?SC(a,o):a(o),e._writableState.errorEmitted=!0,e.emit("error",o)}(e,o,a,t,i);else{var r=Ak(o);r||o.corked||o.bufferProcessing||!o.bufferedRequest||Lk(e,o),a?SC(Rk,e,o,r,i):Rk(e,o,r,i)}}(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Uk(this)}function Dk(e){if(!(this instanceof Dk||this instanceof Gk))return new Dk(e);this._writableState=new bk(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev)),DC.call(this)}function Nk(e,t,n,o,a,i,r){t.writelen=o,t.writecb=r,t.writing=!0,t.sync=!0,n?e._writev(a,t.onwrite):e._write(a,i,t.onwrite),t.sync=!1}function Rk(e,t,n,o){var a,i;n||(a=e,0===(i=t).length&&i.needDrain&&(i.needDrain=!1,a.emit("drain"))),t.pendingcb--,o(),Pk(e,t)}function Lk(e,t){t.bufferProcessing=!0;var n=t.bufferedRequest;if(e._writev&&n&&n.next){var o=t.bufferedRequestCount,a=new Array(o),i=t.corkedRequestsFree;i.entry=n;for(var r=0;n;)a[r]=n,n=n.next,r+=1;Nk(e,t,!0,t.length,a,"",i.finish),t.pendingcb++,t.lastBufferedRequest=null,i.next?(t.corkedRequestsFree=i.next,i.next=null):t.corkedRequestsFree=new Uk(t)}else{for(;n;){var s=n.chunk,l=n.encoding,c=n.callback;if(Nk(e,t,!1,t.objectMode?1:s.length,s,l,c),n=n.next,t.writing)break}null===n&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=n,t.bufferProcessing=!1}function Ak(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function Ok(e,t){t.prefinished||(t.prefinished=!0,e.emit("prefinish"))}function Pk(e,t){var n=Ak(t);return n&&(0===t.pendingcb?(Ok(e,t),t.finished=!0,e.emit("finish")):Ok(e,t)),n}function Uk(e){var t=this;this.next=null,this.entry=null,this.finish=function(n){var o=t.entry;for(t.entry=null;o;){var a=o.callback;e.pendingcb--,a(n),o=o.next}e.corkedRequestsFree?e.corkedRequestsFree.next=t:e.corkedRequestsFree=t}}pk.prototype.read=function(e){uk("read",e),e=parseInt(e,10);var t=this._readableState,n=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return uk("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?Ek(this):mk(this),null;if(0===(e=gk(e,t))&&t.ended)return 0===t.length&&Ek(this),null;var o,a=t.needReadable;return uk("need readable",a),(0===t.length||t.length-e<t.highWaterMark)&&uk("length less than watermark",a=!0),t.ended||t.reading?uk("reading or ended",a=!1):a&&(uk("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=gk(n,t))),null===(o=e>0?kk(e,t):null)?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),n!==e&&t.ended&&Ek(this)),null!==o&&this.emit("data",o),o},pk.prototype._read=function(e){this.emit("error",new Error("not implemented"))},pk.prototype.pipe=function(e,t){var n=this,o=this._readableState;switch(o.pipesCount){case 0:o.pipes=e;break;case 1:o.pipes=[o.pipes,e];break;default:o.pipes.push(e)}o.pipesCount+=1,uk("pipe count=%d opts=%j",o.pipesCount,t);var a=t&&!1===t.end?c:r;function i(e){uk("onunpipe"),e===n&&c()}function r(){uk("onend"),e.end()}o.endEmitted?SC(a):n.once("end",a),e.on("unpipe",i);var s=function(e){return function(){var t=e._readableState;uk("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&e.listeners("data").length&&(t.flowing=!0,Ck(e))}}(n);e.on("drain",s);var l=!1;function c(){uk("cleanup"),e.removeListener("close",h),e.removeListener("finish",f),e.removeListener("drain",s),e.removeListener("error",p),e.removeListener("unpipe",i),n.removeListener("end",r),n.removeListener("end",c),n.removeListener("data",d),l=!0,!o.awaitDrain||e._writableState&&!e._writableState.needDrain||s()}var u=!1;function d(t){uk("ondata"),u=!1,!1!==e.write(t)||u||((1===o.pipesCount&&o.pipes===e||o.pipesCount>1&&-1!==Sk(o.pipes,e))&&!l&&(uk("false write response, pause",n._readableState.awaitDrain),n._readableState.awaitDrain++,u=!0),n.pause())}function p(t){uk("onerror",t),g(),e.removeListener("error",p),0===e.listeners("error").length&&e.emit("error",t)}function h(){e.removeListener("finish",f),g()}function f(){uk("onfinish"),e.removeListener("close",h),g()}function g(){uk("unpipe"),n.unpipe(e)}return n.on("data",d),function(e,t,n){if("function"==typeof e.prependListener)return e.prependListener(t,n);e._events&&e._events[t]?Array.isArray(e._events[t])?e._events[t].unshift(n):e._events[t]=[n,e._events[t]]:e.on(t,n)}(e,"error",p),e.once("close",h),e.once("finish",f),e.emit("pipe",n),o.flowing||(uk("pipe resume"),n.resume()),e},pk.prototype.unpipe=function(e){var t=this._readableState;if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes||(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this)),this;if(!e){var n=t.pipes,o=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var a=0;a<o;a++)n[a].emit("unpipe",this);return this}var i=Sk(t.pipes,e);return-1===i||(t.pipes.splice(i,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this)),this},pk.prototype.on=function(e,t){var n=DC.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var o=this._readableState;o.endEmitted||o.readableListening||(o.readableListening=o.needReadable=!0,o.emittedReadable=!1,o.reading?o.length&&mk(this):SC(yk,this))}return n},pk.prototype.addListener=pk.prototype.on,pk.prototype.resume=function(){var e,t,n=this._readableState;return n.flowing||(uk("resume"),n.flowing=!0,e=this,(t=n).resumeScheduled||(t.resumeScheduled=!0,SC(Ik,e,t))),this},pk.prototype.pause=function(){return uk("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(uk("pause"),this._readableState.flowing=!1,this.emit("pause")),this},pk.prototype.wrap=function(e){var t=this._readableState,n=!1,o=this;for(var a in e.on("end",(function(){if(uk("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&o.push(e)}o.push(null)})),e.on("data",(function(a){uk("wrapped data"),t.decoder&&(a=t.decoder.write(a)),t.objectMode&&null==a||(t.objectMode||a&&a.length)&&(o.push(a)||(n=!0,e.pause()))})),e)void 0===this[a]&&"function"==typeof e[a]&&(this[a]=function(t){return function(){return e[t].apply(e,arguments)}}(a));return function(e,t){for(var n=0,o=e.length;n<o;n++)t(e[n])}(["error","close","destroy","pause","resume"],(function(t){e.on(t,o.emit.bind(o,t))})),o._read=function(t){uk("wrapped _read",t),n&&(n=!1,e.resume())},o},pk._fromList=kk,Dk.WritableState=bk,PC(Dk,DC),bk.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},Dk.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},Dk.prototype.write=function(e,t,n){var o,a,i,r=this._writableState,s=!1;return"function"==typeof t&&(n=t,t=null),MI.isBuffer(e)?t="buffer":t||(t=r.defaultEncoding),"function"!=typeof n&&(n=Mk),r.ended?(o=this,a=n,i=new Error("write after end"),o.emit("error",i),SC(a,i)):function(e,t,n,o){var a=!0,i=!1;return null===n?i=new TypeError("May not write null values to stream"):MI.isBuffer(n)||"string"==typeof n||void 0===n||t.objectMode||(i=new TypeError("Invalid non-string/buffer chunk")),i&&(e.emit("error",i),SC(o,i),a=!1),a}(this,r,e,n)&&(r.pendingcb++,s=function(e,t,n,o,a){var i,r,s;r=n,s=o,(i=t).objectMode||!1===i.decodeStrings||"string"!=typeof r||(r=MI.from(r,s)),n=r,MI.isBuffer(n)&&(o="buffer");var l=t.objectMode?1:n.length;t.length+=l;var c=t.length<t.highWaterMark;if(c||(t.needDrain=!0),t.writing||t.corked){var u=t.lastBufferedRequest;t.lastBufferedRequest=new wk(n,o,a),u?u.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else Nk(e,t,!1,l,n,o,a);return c}(this,r,e,t,n)),s},Dk.prototype.cork=function(){this._writableState.corked++},Dk.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||Lk(this,e))},Dk.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},Dk.prototype._write=function(e,t,n){n(new Error("not implemented"))},Dk.prototype._writev=null,Dk.prototype.end=function(e,t,n){var o,a,i,r=this._writableState;"function"==typeof e?(n=e,e=null,t=null):"function"==typeof t&&(n=t,t=null),null!=e&&this.write(e,t),r.corked&&(r.corked=1,this.uncork()),r.ending||r.finished||(o=this,i=n,(a=r).ending=!0,Pk(o,a),i&&(a.finished?SC(i):o.once("finish",i)),a.ended=!0,o.writable=!1)},PC(Gk,pk);for(var xk=Object.keys(Dk.prototype),Vk=0;Vk<xk.length;Vk++){var Bk=xk[Vk];Gk.prototype[Bk]||(Gk.prototype[Bk]=Dk.prototype[Bk])}function Gk(e){if(!(this instanceof Gk))return new Gk(e);pk.call(this,e),Dk.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",Fk)}function Fk(){this.allowHalfOpen||this._writableState.ended||SC(zk,this)}function zk(e){e.end()}function Hk(e){this.afterTransform=function(t,n){return function(e,t,n){var o=e._transformState;o.transforming=!1;var a=o.writecb;if(!a)return e.emit("error",new Error("no writecb in Transform class"));o.writechunk=null,o.writecb=null,null!=n&&e.push(n),a(t);var i=e._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&e._read(i.highWaterMark)}(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function jk(e){if(!(this instanceof jk))return new jk(e);Gk.call(this,e),this._transformState=new Hk(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",(function(){"function"==typeof this._flush?this._flush((function(e){qk(t,e)})):qk(t)}))}function qk(e,t){if(t)return e.emit("error",t);var n=e._writableState,o=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(o.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}function Kk(e){if(!(this instanceof Kk))return new Kk(e);jk.call(this,e)}function Yk(){DC.call(this)}PC(jk,Gk),jk.prototype.push=function(e,t){return this._transformState.needTransform=!1,Gk.prototype.push.call(this,e,t)},jk.prototype._transform=function(e,t,n){throw new Error("Not implemented")},jk.prototype._write=function(e,t,n){var o=this._transformState;if(o.writecb=n,o.writechunk=e,o.writeencoding=t,!o.transforming){var a=this._readableState;(o.needTransform||a.needReadable||a.length<a.highWaterMark)&&this._read(a.highWaterMark)}},jk.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},PC(Kk,jk),Kk.prototype._transform=function(e,t,n){n(null,e)},PC(Yk,DC),Yk.Readable=pk,Yk.Writable=Dk,Yk.Duplex=Gk,Yk.Transform=jk,Yk.PassThrough=Kk,Yk.Stream=Yk,Yk.prototype.pipe=function(e,t){var n=this;function o(t){e.writable&&!1===e.write(t)&&n.pause&&n.pause()}function a(){n.readable&&n.resume&&n.resume()}n.on("data",o),e.on("drain",a),e._isStdio||t&&!1===t.end||(n.on("end",r),n.on("close",s));var i=!1;function r(){i||(i=!0,e.end())}function s(){i||(i=!0,"function"==typeof e.destroy&&e.destroy())}function l(e){if(c(),0===DC.listenerCount(this,"error"))throw e}function c(){n.removeListener("data",o),e.removeListener("drain",a),n.removeListener("end",r),n.removeListener("close",s),n.removeListener("error",l),e.removeListener("error",l),n.removeListener("end",c),n.removeListener("close",c),e.removeListener("close",c)}return n.on("error",l),e.on("error",l),n.on("end",c),n.on("close",c),e.on("close",c),e.emit("pipe",n),e};var $k={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"};function Wk(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}function Zk(e,t,n,o,a){if(t.subarray&&e.subarray)e.set(t.subarray(n,n+o),a);else for(var i=0;i<o;i++)e[a+i]=t[n+i]}var Jk=Uint8Array,Xk=Uint16Array,Qk=Int32Array;function eE(e){for(var t=e.length;--t>=0;)e[t]=0}var tE=256,nE=286,oE=30,aE=15,iE=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],rE=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],sE=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],lE=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],cE=new Array(576);eE(cE);var uE=new Array(60);eE(uE);var dE=new Array(512);eE(dE);var pE=new Array(256);eE(pE);var hE=new Array(29);eE(hE);var fE,gE,mE,vE=new Array(oE);function _E(e,t,n,o,a){this.static_tree=e,this.extra_bits=t,this.extra_base=n,this.elems=o,this.max_length=a,this.has_stree=e&&e.length}function yE(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function IE(e){return e<256?dE[e]:dE[256+(e>>>7)]}function CE(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function kE(e,t,n){e.bi_valid>16-n?(e.bi_buf|=t<<e.bi_valid&65535,CE(e,e.bi_buf),e.bi_buf=t>>16-e.bi_valid,e.bi_valid+=n-16):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=n)}function EE(e,t,n){kE(e,n[2*t],n[2*t+1])}function TE(e,t){var n=0;do{n|=1&e,e>>>=1,n<<=1}while(--t>0);return n>>>1}function SE(e,t,n){var o,a,i=new Array(16),r=0;for(o=1;o<=aE;o++)i[o]=r=r+n[o-1]<<1;for(a=0;a<=t;a++){var s=e[2*a+1];0!==s&&(e[2*a]=TE(i[s]++,s))}}function ME(e){var t;for(t=0;t<nE;t++)e.dyn_ltree[2*t]=0;for(t=0;t<oE;t++)e.dyn_dtree[2*t]=0;for(t=0;t<19;t++)e.bl_tree[2*t]=0;e.dyn_ltree[512]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function wE(e){e.bi_valid>8?CE(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function bE(e,t,n,o){var a=2*t,i=2*n;return e[a]<e[i]||e[a]===e[i]&&o[t]<=o[n]}function DE(e,t,n){for(var o=e.heap[n],a=n<<1;a<=e.heap_len&&(a<e.heap_len&&bE(t,e.heap[a+1],e.heap[a],e.depth)&&a++,!bE(t,o,e.heap[a],e.depth));)e.heap[n]=e.heap[a],n=a,a<<=1;e.heap[n]=o}function NE(e,t,n){var o,a,i,r,s=0;if(0!==e.last_lit)do{o=e.pending_buf[e.d_buf+2*s]<<8|e.pending_buf[e.d_buf+2*s+1],a=e.pending_buf[e.l_buf+s],s++,0===o?EE(e,a,t):(EE(e,(i=pE[a])+tE+1,t),0!==(r=iE[i])&&kE(e,a-=hE[i],r),EE(e,i=IE(--o),n),0!==(r=rE[i])&&kE(e,o-=vE[i],r))}while(s<e.last_lit);EE(e,256,t)}function RE(e,t){var n,o,a,i=t.dyn_tree,r=t.stat_desc.static_tree,s=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=573,n=0;n<l;n++)0!==i[2*n]?(e.heap[++e.heap_len]=c=n,e.depth[n]=0):i[2*n+1]=0;for(;e.heap_len<2;)i[2*(a=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[a]=0,e.opt_len--,s&&(e.static_len-=r[2*a+1]);for(t.max_code=c,n=e.heap_len>>1;n>=1;n--)DE(e,i,n);a=l;do{n=e.heap[1],e.heap[1]=e.heap[e.heap_len--],DE(e,i,1),o=e.heap[1],e.heap[--e.heap_max]=n,e.heap[--e.heap_max]=o,i[2*a]=i[2*n]+i[2*o],e.depth[a]=(e.depth[n]>=e.depth[o]?e.depth[n]:e.depth[o])+1,i[2*n+1]=i[2*o+1]=a,e.heap[1]=a++,DE(e,i,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],function(e,t){var n,o,a,i,r,s,l=t.dyn_tree,c=t.max_code,u=t.stat_desc.static_tree,d=t.stat_desc.has_stree,p=t.stat_desc.extra_bits,h=t.stat_desc.extra_base,f=t.stat_desc.max_length,g=0;for(i=0;i<=aE;i++)e.bl_count[i]=0;for(l[2*e.heap[e.heap_max]+1]=0,n=e.heap_max+1;n<573;n++)(i=l[2*l[2*(o=e.heap[n])+1]+1]+1)>f&&(i=f,g++),l[2*o+1]=i,o>c||(e.bl_count[i]++,r=0,o>=h&&(r=p[o-h]),s=l[2*o],e.opt_len+=s*(i+r),d&&(e.static_len+=s*(u[2*o+1]+r)));if(0!==g){do{for(i=f-1;0===e.bl_count[i];)i--;e.bl_count[i]--,e.bl_count[i+1]+=2,e.bl_count[f]--,g-=2}while(g>0);for(i=f;0!==i;i--)for(o=e.bl_count[i];0!==o;)(a=e.heap[--n])>c||(l[2*a+1]!==i&&(e.opt_len+=(i-l[2*a+1])*l[2*a],l[2*a+1]=i),o--)}}(e,t),SE(i,c,e.bl_count)}function LE(e,t,n){var o,a,i=-1,r=t[1],s=0,l=7,c=4;for(0===r&&(l=138,c=3),t[2*(n+1)+1]=65535,o=0;o<=n;o++)a=r,r=t[2*(o+1)+1],++s<l&&a===r||(s<c?e.bl_tree[2*a]+=s:0!==a?(a!==i&&e.bl_tree[2*a]++,e.bl_tree[32]++):s<=10?e.bl_tree[34]++:e.bl_tree[36]++,s=0,i=a,0===r?(l=138,c=3):a===r?(l=6,c=3):(l=7,c=4))}function AE(e,t,n){var o,a,i=-1,r=t[1],s=0,l=7,c=4;for(0===r&&(l=138,c=3),o=0;o<=n;o++)if(a=r,r=t[2*(o+1)+1],!(++s<l&&a===r)){if(s<c)do{EE(e,a,e.bl_tree)}while(0!=--s);else 0!==a?(a!==i&&(EE(e,a,e.bl_tree),s--),EE(e,16,e.bl_tree),kE(e,s-3,2)):s<=10?(EE(e,17,e.bl_tree),kE(e,s-3,3)):(EE(e,18,e.bl_tree),kE(e,s-11,7));s=0,i=a,0===r?(l=138,c=3):a===r?(l=6,c=3):(l=7,c=4)}}eE(vE);var OE=!1;function PE(e,t,n,o){var a,i,r;kE(e,0+(o?1:0),3),i=t,r=n,wE(a=e),CE(a,r),CE(a,~r),Zk(a.pending_buf,a.window,i,r,a.pending),a.pending+=r}function UE(e,t,n){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&n,e.last_lit++,0===t?e.dyn_ltree[2*n]++:(e.matches++,t--,e.dyn_ltree[2*(pE[n]+tE+1)]++,e.dyn_dtree[2*IE(t)]++),e.last_lit===e.lit_bufsize-1}function xE(e,t,n,o){for(var a=65535&e,i=e>>>16&65535,r=0;0!==n;){n-=r=n>2e3?2e3:n;do{i=i+(a=a+t[o++]|0)|0}while(--r);a%=65521,i%=65521}return a|i<<16}var VE=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var o=0;o<8;o++)e=1&e?3988292384^e>>>1:e>>>1;t[n]=e}return t}();function BE(e,t,n,o){var a=VE,i=o+n;e^=-1;for(var r=o;r<i;r++)e=e>>>8^a[255&(e^t[r])];return~e}var GE,FE=-2,zE=258,HE=262,jE=103,qE=113,KE=666;function YE(e,t){return e.msg=$k[t],t}function $E(e){return(e<<1)-(e>4?9:0)}function WE(e){for(var t=e.length;--t>=0;)e[t]=0}function ZE(e){var t=e.state,n=t.pending;n>e.avail_out&&(n=e.avail_out),0!==n&&(Zk(e.output,t.pending_buf,t.pending_out,n,e.next_out),e.next_out+=n,t.pending_out+=n,e.total_out+=n,e.avail_out-=n,t.pending-=n,0===t.pending&&(t.pending_out=0))}function JE(e,t){(function(e,t,n,o){var a,i,r=0;e.level>0?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,n=4093624447;for(t=0;t<=31;t++,n>>>=1)if(1&n&&0!==e.dyn_ltree[2*t])return 0;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return 1;for(t=32;t<tE;t++)if(0!==e.dyn_ltree[2*t])return 1;return 0}(e)),RE(e,e.l_desc),RE(e,e.d_desc),r=function(e){var t;for(LE(e,e.dyn_ltree,e.l_desc.max_code),LE(e,e.dyn_dtree,e.d_desc.max_code),RE(e,e.bl_desc),t=18;t>=3&&0===e.bl_tree[2*lE[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),a=e.opt_len+3+7>>>3,(i=e.static_len+3+7>>>3)<=a&&(a=i)):a=i=n+5,n+4<=a&&-1!==t?PE(e,t,n,o):4===e.strategy||i===a?(kE(e,2+(o?1:0),3),NE(e,cE,uE)):(kE(e,4+(o?1:0),3),function(e,t,n,o){var a;for(kE(e,t-257,5),kE(e,n-1,5),kE(e,o-4,4),a=0;a<o;a++)kE(e,e.bl_tree[2*lE[a]+1],3);AE(e,e.dyn_ltree,t-1),AE(e,e.dyn_dtree,n-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,r+1),NE(e,e.dyn_ltree,e.dyn_dtree)),ME(e),o&&wE(e)})(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,ZE(e.strm)}function XE(e,t){e.pending_buf[e.pending++]=t}function QE(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function eT(e,t){var n,o,a=e.max_chain_length,i=e.strstart,r=e.prev_length,s=e.nice_match,l=e.strstart>e.w_size-HE?e.strstart-(e.w_size-HE):0,c=e.window,u=e.w_mask,d=e.prev,p=e.strstart+zE,h=c[i+r-1],f=c[i+r];e.prev_length>=e.good_match&&(a>>=2),s>e.lookahead&&(s=e.lookahead);do{if(c[(n=t)+r]===f&&c[n+r-1]===h&&c[n]===c[i]&&c[++n]===c[i+1]){i+=2,n++;do{}while(c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&c[++i]===c[++n]&&i<p);if(o=zE-(p-i),i=p-zE,o>r){if(e.match_start=t,r=o,o>=s)break;h=c[i+r-1],f=c[i+r]}}}while((t=d[t&u])>l&&0!=--a);return r<=e.lookahead?r:e.lookahead}function tT(e){var t,n,o,a,i,r,s,l,c,u,d=e.w_size;do{if(a=e.window_size-e.lookahead-e.strstart,e.strstart>=d+(d-HE)){Zk(e.window,e.window,d,d,0),e.match_start-=d,e.strstart-=d,e.block_start-=d,t=n=e.hash_size;do{o=e.head[--t],e.head[t]=o>=d?o-d:0}while(--n);t=n=d;do{o=e.prev[--t],e.prev[t]=o>=d?o-d:0}while(--n);a+=d}if(0===e.strm.avail_in)break;if(r=e.strm,s=e.window,l=e.strstart+e.lookahead,c=a,u=void 0,(u=r.avail_in)>c&&(u=c),n=0===u?0:(r.avail_in-=u,Zk(s,r.input,r.next_in,u,l),1===r.state.wrap?r.adler=xE(r.adler,s,u,l):2===r.state.wrap&&(r.adler=BE(r.adler,s,u,l)),r.next_in+=u,r.total_in+=u,u),e.lookahead+=n,e.lookahead+e.insert>=3)for(i=e.strstart-e.insert,e.ins_h=e.window[i],e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[i+3-1])&e.hash_mask,e.prev[i&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=i,i++,e.insert--,!(e.lookahead+e.insert<3)););}while(e.lookahead<HE&&0!==e.strm.avail_in)}function nT(e,t){for(var n,o;;){if(e.lookahead<HE){if(tT(e),e.lookahead<HE&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==n&&e.strstart-n<=e.w_size-HE&&(e.match_length=eT(e,n)),e.match_length>=3)if(o=UE(e,e.strstart-e.match_start,e.match_length-3),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=3){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else o=UE(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(JE(e,!1),0===e.strm.avail_out))return 1}return e.insert=e.strstart<2?e.strstart:2,4===t?(JE(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JE(e,!1),0===e.strm.avail_out)?1:2}function oT(e,t){for(var n,o,a;;){if(e.lookahead<HE){if(tT(e),e.lookahead<HE&&0===t)return 1;if(0===e.lookahead)break}if(n=0,e.lookahead>=3&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=2,0!==n&&e.prev_length<e.max_lazy_match&&e.strstart-n<=e.w_size-HE&&(e.match_length=eT(e,n),e.match_length<=5&&(1===e.strategy||3===e.match_length&&e.strstart-e.match_start>4096)&&(e.match_length=2)),e.prev_length>=3&&e.match_length<=e.prev_length){a=e.strstart+e.lookahead-3,o=UE(e,e.strstart-1-e.prev_match,e.prev_length-3),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=a&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+3-1])&e.hash_mask,n=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=2,e.strstart++,o&&(JE(e,!1),0===e.strm.avail_out))return 1}else if(e.match_available){if((o=UE(e,0,e.window[e.strstart-1]))&&JE(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return 1}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=UE(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<2?e.strstart:2,4===t?(JE(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JE(e,!1),0===e.strm.avail_out)?1:2}function aT(e,t,n,o,a){this.good_length=e,this.max_lazy=t,this.nice_length=n,this.max_chain=o,this.func=a}function iT(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=8,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Xk(1146),this.dyn_dtree=new Xk(122),this.bl_tree=new Xk(78),WE(this.dyn_ltree),WE(this.dyn_dtree),WE(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Xk(16),this.heap=new Xk(573),WE(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Xk(573),WE(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function rT(e){var t,n,o,a=(n=e)&&n.state?(n.total_in=n.total_out=0,n.data_type=2,(o=n.state).pending=0,o.pending_out=0,o.wrap<0&&(o.wrap=-o.wrap),o.status=o.wrap?42:qE,n.adler=2===o.wrap?0:1,o.last_flush=0,function(e){OE||(function(){var e,t,n,o,a,i=new Array(16);for(n=0,o=0;o<28;o++)for(hE[o]=n,e=0;e<1<<iE[o];e++)pE[n++]=o;for(pE[n-1]=o,a=0,o=0;o<16;o++)for(vE[o]=a,e=0;e<1<<rE[o];e++)dE[a++]=o;for(a>>=7;o<oE;o++)for(vE[o]=a<<7,e=0;e<1<<rE[o]-7;e++)dE[256+a++]=o;for(t=0;t<=aE;t++)i[t]=0;for(e=0;e<=143;)cE[2*e+1]=8,e++,i[8]++;for(;e<=255;)cE[2*e+1]=9,e++,i[9]++;for(;e<=279;)cE[2*e+1]=7,e++,i[7]++;for(;e<=287;)cE[2*e+1]=8,e++,i[8]++;for(SE(cE,287,i),e=0;e<oE;e++)uE[2*e+1]=5,uE[2*e]=TE(e,5);fE=new _E(cE,iE,257,nE,aE),gE=new _E(uE,rE,0,oE,aE),mE=new _E(new Array(0),sE,0,19,7)}(),OE=!0),e.l_desc=new yE(e.dyn_ltree,fE),e.d_desc=new yE(e.dyn_dtree,gE),e.bl_desc=new yE(e.bl_tree,mE),e.bi_buf=0,e.bi_valid=0,ME(e)}(o),0):YE(n,FE);return 0===a&&((t=e.state).window_size=2*t.w_size,WE(t.head),t.max_lazy_match=GE[t.level].max_lazy,t.good_match=GE[t.level].good_length,t.nice_match=GE[t.level].nice_length,t.max_chain_length=GE[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=2,t.match_available=0,t.ins_h=0),a}function sT(e,t){var n,o,a,i;if(!e||!e.state||t>5||t<0)return e?YE(e,FE):FE;if(o=e.state,!e.output||!e.input&&0!==e.avail_in||o.status===KE&&4!==t)return YE(e,0===e.avail_out?-5:FE);if(o.strm=e,n=o.last_flush,o.last_flush=t,42===o.status)if(2===o.wrap)e.adler=0,XE(o,31),XE(o,139),XE(o,8),o.gzhead?(XE(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),XE(o,255&o.gzhead.time),XE(o,o.gzhead.time>>8&255),XE(o,o.gzhead.time>>16&255),XE(o,o.gzhead.time>>24&255),XE(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),XE(o,255&o.gzhead.os),o.gzhead.extra&&o.gzhead.extra.length&&(XE(o,255&o.gzhead.extra.length),XE(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=BE(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=69):(XE(o,0),XE(o,0),XE(o,0),XE(o,0),XE(o,0),XE(o,9===o.level?2:o.strategy>=2||o.level<2?4:0),XE(o,3),o.status=qE);else{var r=8+(o.w_bits-8<<4)<<8;r|=(o.strategy>=2||o.level<2?0:o.level<6?1:6===o.level?2:3)<<6,0!==o.strstart&&(r|=32),r+=31-r%31,o.status=qE,QE(o,r),0!==o.strstart&&(QE(o,e.adler>>>16),QE(o,65535&e.adler)),e.adler=1}if(69===o.status)if(o.gzhead.extra){for(a=o.pending;o.gzindex<(65535&o.gzhead.extra.length)&&(o.pending!==o.pending_buf_size||(o.gzhead.hcrc&&o.pending>a&&(e.adler=BE(e.adler,o.pending_buf,o.pending-a,a)),ZE(e),a=o.pending,o.pending!==o.pending_buf_size));)XE(o,255&o.gzhead.extra[o.gzindex]),o.gzindex++;o.gzhead.hcrc&&o.pending>a&&(e.adler=BE(e.adler,o.pending_buf,o.pending-a,a)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=73)}else o.status=73;if(73===o.status)if(o.gzhead.name){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=BE(e.adler,o.pending_buf,o.pending-a,a)),ZE(e),a=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.name.length?255&o.gzhead.name.charCodeAt(o.gzindex++):0,XE(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>a&&(e.adler=BE(e.adler,o.pending_buf,o.pending-a,a)),0===i&&(o.gzindex=0,o.status=91)}else o.status=91;if(91===o.status)if(o.gzhead.comment){a=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>a&&(e.adler=BE(e.adler,o.pending_buf,o.pending-a,a)),ZE(e),a=o.pending,o.pending===o.pending_buf_size)){i=1;break}i=o.gzindex<o.gzhead.comment.length?255&o.gzhead.comment.charCodeAt(o.gzindex++):0,XE(o,i)}while(0!==i);o.gzhead.hcrc&&o.pending>a&&(e.adler=BE(e.adler,o.pending_buf,o.pending-a,a)),0===i&&(o.status=jE)}else o.status=jE;if(o.status===jE&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&ZE(e),o.pending+2<=o.pending_buf_size&&(XE(o,255&e.adler),XE(o,e.adler>>8&255),e.adler=0,o.status=qE)):o.status=qE),0!==o.pending){if(ZE(e),0===e.avail_out)return o.last_flush=-1,0}else if(0===e.avail_in&&$E(t)<=$E(n)&&4!==t)return YE(e,-5);if(o.status===KE&&0!==e.avail_in)return YE(e,-5);if(0!==e.avail_in||0!==o.lookahead||0!==t&&o.status!==KE){var s=2===o.strategy?function(e,t){for(var n;;){if(0===e.lookahead&&(tT(e),0===e.lookahead)){if(0===t)return 1;break}if(e.match_length=0,n=UE(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,n&&(JE(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(JE(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JE(e,!1),0===e.strm.avail_out)?1:2}(o,t):3===o.strategy?function(e,t){for(var n,o,a,i,r=e.window;;){if(e.lookahead<=zE){if(tT(e),e.lookahead<=zE&&0===t)return 1;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=3&&e.strstart>0&&(o=r[a=e.strstart-1])===r[++a]&&o===r[++a]&&o===r[++a]){i=e.strstart+zE;do{}while(o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&o===r[++a]&&a<i);e.match_length=zE-(i-a),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=3?(n=UE(e,1,e.match_length-3),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(n=UE(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),n&&(JE(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(JE(e,!0),0===e.strm.avail_out?3:4):e.last_lit&&(JE(e,!1),0===e.strm.avail_out)?1:2}(o,t):GE[o.level].func(o,t);if(3!==s&&4!==s||(o.status=KE),1===s||3===s)return 0===e.avail_out&&(o.last_flush=-1),0;if(2===s&&(1===t?function(e){var t;kE(e,2,3),EE(e,256,cE),16===(t=e).bi_valid?(CE(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}(o):5!==t&&(PE(o,0,0,!1),3===t&&(WE(o.head),0===o.lookahead&&(o.strstart=0,o.block_start=0,o.insert=0))),ZE(e),0===e.avail_out))return o.last_flush=-1,0}return 4!==t?0:o.wrap<=0?1:(2===o.wrap?(XE(o,255&e.adler),XE(o,e.adler>>8&255),XE(o,e.adler>>16&255),XE(o,e.adler>>24&255),XE(o,255&e.total_in),XE(o,e.total_in>>8&255),XE(o,e.total_in>>16&255),XE(o,e.total_in>>24&255)):(QE(o,e.adler>>>16),QE(o,65535&e.adler)),ZE(e),o.wrap>0&&(o.wrap=-o.wrap),0!==o.pending?0:1)}GE=[new aT(0,0,0,0,(function(e,t){var n=65535;for(n>e.pending_buf_size-5&&(n=e.pending_buf_size-5);;){if(e.lookahead<=1){if(tT(e),0===e.lookahead&&0===t)return 1;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var o=e.block_start+n;if((0===e.strstart||e.strstart>=o)&&(e.lookahead=e.strstart-o,e.strstart=o,JE(e,!1),0===e.strm.avail_out))return 1;if(e.strstart-e.block_start>=e.w_size-HE&&(JE(e,!1),0===e.strm.avail_out))return 1}return e.insert=0,4===t?(JE(e,!0),0===e.strm.avail_out?3:4):(e.strstart>e.block_start&&(JE(e,!1),e.strm.avail_out),1)})),new aT(4,4,8,4,nT),new aT(4,5,16,8,nT),new aT(4,6,32,32,nT),new aT(4,4,16,16,oT),new aT(8,16,32,32,oT),new aT(8,16,128,128,oT),new aT(8,32,128,256,oT),new aT(32,128,258,1024,oT),new aT(32,258,258,4096,oT)];function lT(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f,g,m,v,_,y,I,C,k,E,T,S,M;n=e.state,o=e.next_in,S=e.input,a=o+(e.avail_in-5),i=e.next_out,M=e.output,r=i-(t-e.avail_out),s=i+(e.avail_out-257),l=n.dmax,c=n.wsize,u=n.whave,d=n.wnext,p=n.window,h=n.hold,f=n.bits,g=n.lencode,m=n.distcode,v=(1<<n.lenbits)-1,_=(1<<n.distbits)-1;e:do{f<15&&(h+=S[o++]<<f,f+=8,h+=S[o++]<<f,f+=8),y=g[h&v];t:for(;;){if(h>>>=I=y>>>24,f-=I,0==(I=y>>>16&255))M[i++]=65535&y;else{if(!(16&I)){if(!(64&I)){y=g[(65535&y)+(h&(1<<I)-1)];continue t}if(32&I){n.mode=12;break e}e.msg="invalid literal/length code",n.mode=30;break e}C=65535&y,(I&=15)&&(f<I&&(h+=S[o++]<<f,f+=8),C+=h&(1<<I)-1,h>>>=I,f-=I),f<15&&(h+=S[o++]<<f,f+=8,h+=S[o++]<<f,f+=8),y=m[h&_];n:for(;;){if(h>>>=I=y>>>24,f-=I,!(16&(I=y>>>16&255))){if(!(64&I)){y=m[(65535&y)+(h&(1<<I)-1)];continue n}e.msg="invalid distance code",n.mode=30;break e}if(k=65535&y,f<(I&=15)&&(h+=S[o++]<<f,(f+=8)<I&&(h+=S[o++]<<f,f+=8)),(k+=h&(1<<I)-1)>l){e.msg="invalid distance too far back",n.mode=30;break e}if(h>>>=I,f-=I,k>(I=i-r)){if((I=k-I)>u&&n.sane){e.msg="invalid distance too far back",n.mode=30;break e}if(E=0,T=p,0===d){if(E+=c-I,I<C){C-=I;do{M[i++]=p[E++]}while(--I);E=i-k,T=M}}else if(d<I){if(E+=c+d-I,(I-=d)<C){C-=I;do{M[i++]=p[E++]}while(--I);if(E=0,d<C){C-=I=d;do{M[i++]=p[E++]}while(--I);E=i-k,T=M}}}else if(E+=d-I,I<C){C-=I;do{M[i++]=p[E++]}while(--I);E=i-k,T=M}for(;C>2;)M[i++]=T[E++],M[i++]=T[E++],M[i++]=T[E++],C-=3;C&&(M[i++]=T[E++],C>1&&(M[i++]=T[E++]))}else{E=i-k;do{M[i++]=M[E++],M[i++]=M[E++],M[i++]=M[E++],C-=3}while(C>2);C&&(M[i++]=M[E++],C>1&&(M[i++]=M[E++]))}break}}break}}while(o<a&&i<s);o-=C=f>>3,h&=(1<<(f-=C<<3))-1,e.next_in=o,e.next_out=i,e.avail_in=o<a?a-o+5:5-(o-a),e.avail_out=i<s?s-i+257:257-(i-s),n.hold=h,n.bits=f}var cT=15,uT=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],dT=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],pT=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],hT=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];function fT(e,t,n,o,a,i,r,s){var l,c,u,d,p,h,f,g,m,v=s.bits,_=0,y=0,I=0,C=0,k=0,E=0,T=0,S=0,M=0,w=0,b=null,D=0,N=new Xk(16),R=new Xk(16),L=null,A=0;for(_=0;_<=cT;_++)N[_]=0;for(y=0;y<o;y++)N[t[n+y]]++;for(k=v,C=cT;C>=1&&0===N[C];C--);if(k>C&&(k=C),0===C)return a[i++]=20971520,a[i++]=20971520,s.bits=1,0;for(I=1;I<C&&0===N[I];I++);for(k<I&&(k=I),S=1,_=1;_<=cT;_++)if(S<<=1,(S-=N[_])<0)return-1;if(S>0&&(0===e||1!==C))return-1;for(R[1]=0,_=1;_<cT;_++)R[_+1]=R[_]+N[_];for(y=0;y<o;y++)0!==t[n+y]&&(r[R[t[n+y]]++]=y);if(0===e?(b=L=r,h=19):1===e?(b=uT,D-=257,L=dT,A-=257,h=256):(b=pT,L=hT,h=-1),w=0,y=0,_=I,p=i,E=k,T=0,u=-1,d=(M=1<<k)-1,1===e&&M>852||2===e&&M>592)return 1;for(;;){f=_-T,r[y]<h?(g=0,m=r[y]):r[y]>h?(g=L[A+r[y]],m=b[D+r[y]]):(g=96,m=0),l=1<<_-T,I=c=1<<E;do{a[p+(w>>T)+(c-=l)]=f<<24|g<<16|m}while(0!==c);for(l=1<<_-1;w&l;)l>>=1;if(0!==l?(w&=l-1,w+=l):w=0,y++,0==--N[_]){if(_===C)break;_=t[n+r[y]]}if(_>k&&(w&d)!==u){for(0===T&&(T=k),p+=I,S=1<<(E=_-T);E+T<C&&!((S-=N[E+T])<=0);)E++,S<<=1;if(M+=1<<E,1===e&&M>852||2===e&&M>592)return 1;a[u=w&d]=k<<24|E<<16|p-i}}return 0!==w&&(a[p+w]=_-T<<24|64<<16),s.bits=k,0}var gT=-2,mT=12,vT=30;function _T(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function yT(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Xk(320),this.work=new Xk(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function IT(e){var t,n,o;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,(n=e)&&n.state?(o=n.state,n.total_in=n.total_out=o.total=0,n.msg="",o.wrap&&(n.adler=1&o.wrap),o.mode=1,o.last=0,o.havedict=0,o.dmax=32768,o.head=null,o.hold=0,o.bits=0,o.lencode=o.lendyn=new Qk(852),o.distcode=o.distdyn=new Qk(592),o.sane=1,o.back=-1,0):gT):gT}var CT,kT,ET=!0;function TT(e){if(ET){var t;for(CT=new Qk(512),kT=new Qk(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(fT(1,e.lens,0,288,CT,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;fT(2,e.lens,0,32,kT,0,e.work,{bits:5}),ET=!1}e.lencode=CT,e.lenbits=9,e.distcode=kT,e.distbits=5}var ST;function MT(e){if(e<1||e>7)throw new TypeError("Bad argument");this.mode=e,this.init_done=!1,this.write_in_progress=!1,this.pending_close=!1,this.windowBits=0,this.level=0,this.memLevel=0,this.strategy=0,this.dictionary=null}function wT(e,t){for(var n=0;n<e.length;n++)this[t+n]=e[n]}MT.prototype.init=function(e,t,n,o,a){var i;switch(this.windowBits=e,this.level=t,this.memLevel=n,this.strategy=o,3!==this.mode&&4!==this.mode||(this.windowBits+=16),7===this.mode&&(this.windowBits+=32),5!==this.mode&&6!==this.mode||(this.windowBits=-this.windowBits),this.strm=new Wk,this.mode){case 1:case 3:case 5:i=function(e,t,n,o,a,i){if(!e)return FE;var r=1;if(-1===t&&(t=6),o<0?(r=0,o=-o):o>15&&(r=2,o-=16),a<1||a>9||o<8||o>15||t<0||t>9||i<0||i>4)return YE(e,FE);8===o&&(o=9);var s=new iT;return e.state=s,s.strm=e,s.wrap=r,s.gzhead=null,s.w_bits=o,s.w_size=1<<s.w_bits,s.w_mask=s.w_size-1,s.hash_bits=a+7,s.hash_size=1<<s.hash_bits,s.hash_mask=s.hash_size-1,s.hash_shift=~~((s.hash_bits+3-1)/3),s.window=new Jk(2*s.w_size),s.head=new Xk(s.hash_size),s.prev=new Xk(s.w_size),s.lit_bufsize=1<<a+6,s.pending_buf_size=4*s.lit_bufsize,s.pending_buf=new Jk(s.pending_buf_size),s.d_buf=1*s.lit_bufsize,s.l_buf=3*s.lit_bufsize,s.level=t,s.strategy=i,s.method=8,rT(e)}(this.strm,this.level,0,this.windowBits,this.memLevel,this.strategy);break;case 2:case 4:case 6:case 7:i=function(e,t){var n,o,a,i,r,s;return e?(o=new yT,e.state=o,o.window=null,0!==(i=t,n=(a=e)&&a.state?(s=a.state,i<0?(r=0,i=-i):(r=1+(i>>4),i<48&&(i&=15)),i&&(i<8||i>15)?gT:(null!==s.window&&s.wbits!==i&&(s.window=null),s.wrap=r,s.wbits=i,IT(a))):gT)&&(e.state=null),n):gT}(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}0===i?(this.write_in_progress=!1,this.init_done=!0):this._error(i)},MT.prototype.params=function(){throw new Error("deflateParams Not supported")},MT.prototype._writeCheck=function(){if(!this.init_done)throw new Error("write before init");if(0===this.mode)throw new Error("already finalized");if(this.write_in_progress)throw new Error("write already in progress");if(this.pending_close)throw new Error("close is pending")},MT.prototype.write=function(e,t,n,o,a,i,r){this._writeCheck(),this.write_in_progress=!0;var s=this;return SC((function(){s.write_in_progress=!1;var l=s._write(e,t,n,o,a,i,r);s.callback(l[0],l[1]),s.pending_close&&s.close()})),this},MT.prototype.writeSync=function(e,t,n,o,a,i,r){return this._writeCheck(),this._write(e,t,n,o,a,i,r)},MT.prototype._write=function(e,t,n,o,a,i,r){if(this.write_in_progress=!0,0!==e&&1!==e&&2!==e&&3!==e&&4!==e&&5!==e)throw new Error("Invalid flush value");null==t&&(t=new MI(0),o=0,n=0),a._set?a.set=a._set:a.set=wT;var s,l=this.strm;switch(l.avail_in=o,l.input=t,l.next_in=n,l.avail_out=r,l.output=a,l.next_out=i,this.mode){case 1:case 3:case 5:s=sT(l,e);break;case 7:case 2:case 4:case 6:s=function(e,t){var n,o,a,i,r,s,l,c,u,d,p,h,f,g,m,v,_,y,I,C,k,E,T,S,M,w,b,D,N,R,L=0,A=new Jk(4),O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return gT;(n=e.state).mode===mT&&(n.mode=13),r=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,u=n.bits,d=s,p=l,E=0;e:for(;;)switch(n.mode){case 1:if(0===n.wrap){n.mode=13;break}for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(2&n.wrap&&35615===c){n.check=0,A[0]=255&c,A[1]=c>>>8&255,n.check=BE(n.check,A,2,0),c=0,u=0,n.mode=2;break}if(n.flags=0,n.head&&(n.head.done=!1),!(1&n.wrap)||(((255&c)<<8)+(c>>8))%31){e.msg="incorrect header check",n.mode=vT;break}if(8!=(15&c)){e.msg="unknown compression method",n.mode=vT;break}if(u-=4,k=8+(15&(c>>>=4)),0===n.wbits)n.wbits=k;else if(k>n.wbits){e.msg="invalid window size",n.mode=vT;break}n.dmax=1<<k,e.adler=n.check=1,n.mode=512&c?10:mT,c=0,u=0;break;case 2:for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(n.flags=c,8!=(255&n.flags)){e.msg="unknown compression method",n.mode=vT;break}if(57344&n.flags){e.msg="unknown header flags set",n.mode=vT;break}n.head&&(n.head.text=c>>8&1),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,n.check=BE(n.check,A,2,0)),c=0,u=0,n.mode=3;case 3:for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.head&&(n.head.time=c),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,A[2]=c>>>16&255,A[3]=c>>>24&255,n.check=BE(n.check,A,4,0)),c=0,u=0,n.mode=4;case 4:for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.head&&(n.head.xflags=255&c,n.head.os=c>>8),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,n.check=BE(n.check,A,2,0)),c=0,u=0,n.mode=5;case 5:if(1024&n.flags){for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.length=c,n.head&&(n.head.extra_len=c),512&n.flags&&(A[0]=255&c,A[1]=c>>>8&255,n.check=BE(n.check,A,2,0)),c=0,u=0}else n.head&&(n.head.extra=null);n.mode=6;case 6:if(1024&n.flags&&((h=n.length)>s&&(h=s),h&&(n.head&&(k=n.head.extra_len-n.length,n.head.extra||(n.head.extra=new Array(n.head.extra_len)),Zk(n.head.extra,o,i,h,k)),512&n.flags&&(n.check=BE(n.check,o,h,i)),s-=h,i+=h,n.length-=h),n.length))break e;n.length=0,n.mode=7;case 7:if(2048&n.flags){if(0===s)break e;h=0;do{k=o[i+h++],n.head&&k&&n.length<65536&&(n.head.name+=String.fromCharCode(k))}while(k&&h<s);if(512&n.flags&&(n.check=BE(n.check,o,h,i)),s-=h,i+=h,k)break e}else n.head&&(n.head.name=null);n.length=0,n.mode=8;case 8:if(4096&n.flags){if(0===s)break e;h=0;do{k=o[i+h++],n.head&&k&&n.length<65536&&(n.head.comment+=String.fromCharCode(k))}while(k&&h<s);if(512&n.flags&&(n.check=BE(n.check,o,h,i)),s-=h,i+=h,k)break e}else n.head&&(n.head.comment=null);n.mode=9;case 9:if(512&n.flags){for(;u<16;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c!==(65535&n.check)){e.msg="header crc mismatch",n.mode=vT;break}c=0,u=0}n.head&&(n.head.hcrc=n.flags>>9&1,n.head.done=!0),e.adler=n.check=0,n.mode=mT;break;case 10:for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}e.adler=n.check=_T(c),c=0,u=0,n.mode=11;case 11:if(0===n.havedict)return e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,2;e.adler=n.check=1,n.mode=mT;case mT:if(5===t||6===t)break e;case 13:if(n.last){c>>>=7&u,u-=7&u,n.mode=27;break}for(;u<3;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}switch(n.last=1&c,u-=1,3&(c>>>=1)){case 0:n.mode=14;break;case 1:if(TT(n),n.mode=20,6===t){c>>>=2,u-=2;break e}break;case 2:n.mode=17;break;case 3:e.msg="invalid block type",n.mode=vT}c>>>=2,u-=2;break;case 14:for(c>>>=7&u,u-=7&u;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if((65535&c)!=(c>>>16^65535)){e.msg="invalid stored block lengths",n.mode=vT;break}if(n.length=65535&c,c=0,u=0,n.mode=15,6===t)break e;case 15:n.mode=16;case 16:if(h=n.length){if(h>s&&(h=s),h>l&&(h=l),0===h)break e;Zk(a,o,i,h,r),s-=h,i+=h,l-=h,r+=h,n.length-=h;break}n.mode=mT;break;case 17:for(;u<14;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(n.nlen=257+(31&c),c>>>=5,u-=5,n.ndist=1+(31&c),c>>>=5,u-=5,n.ncode=4+(15&c),c>>>=4,u-=4,n.nlen>286||n.ndist>30){e.msg="too many length or distance symbols",n.mode=vT;break}n.have=0,n.mode=18;case 18:for(;n.have<n.ncode;){for(;u<3;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.lens[O[n.have++]]=7&c,c>>>=3,u-=3}for(;n.have<19;)n.lens[O[n.have++]]=0;if(n.lencode=n.lendyn,n.lenbits=7,T={bits:n.lenbits},E=fT(0,n.lens,0,19,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid code lengths set",n.mode=vT;break}n.have=0,n.mode=19;case 19:for(;n.have<n.nlen+n.ndist;){for(;v=(L=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&L,!((m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(_<16)c>>>=m,u-=m,n.lens[n.have++]=_;else{if(16===_){for(S=m+2;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c>>>=m,u-=m,0===n.have){e.msg="invalid bit length repeat",n.mode=vT;break}k=n.lens[n.have-1],h=3+(3&c),c>>>=2,u-=2}else if(17===_){for(S=m+3;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}u-=m,k=0,h=3+(7&(c>>>=m)),c>>>=3,u-=3}else{for(S=m+7;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}u-=m,k=0,h=11+(127&(c>>>=m)),c>>>=7,u-=7}if(n.have+h>n.nlen+n.ndist){e.msg="invalid bit length repeat",n.mode=vT;break}for(;h--;)n.lens[n.have++]=k}}if(n.mode===vT)break;if(0===n.lens[256]){e.msg="invalid code -- missing end-of-block",n.mode=vT;break}if(n.lenbits=9,T={bits:n.lenbits},E=fT(1,n.lens,0,n.nlen,n.lencode,0,n.work,T),n.lenbits=T.bits,E){e.msg="invalid literal/lengths set",n.mode=vT;break}if(n.distbits=6,n.distcode=n.distdyn,T={bits:n.distbits},E=fT(2,n.lens,n.nlen,n.ndist,n.distcode,0,n.work,T),n.distbits=T.bits,E){e.msg="invalid distances set",n.mode=vT;break}if(n.mode=20,6===t)break e;case 20:n.mode=21;case 21:if(s>=6&&l>=258){e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,lT(e,p),r=e.next_out,a=e.output,l=e.avail_out,i=e.next_in,o=e.input,s=e.avail_in,c=n.hold,u=n.bits,n.mode===mT&&(n.back=-1);break}for(n.back=0;v=(L=n.lencode[c&(1<<n.lenbits)-1])>>>16&255,_=65535&L,!((m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(v&&!(240&v)){for(y=m,I=v,C=_;v=(L=n.lencode[C+((c&(1<<y+I)-1)>>y)])>>>16&255,_=65535&L,!(y+(m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}c>>>=y,u-=y,n.back+=y}if(c>>>=m,u-=m,n.back+=m,n.length=_,0===v){n.mode=26;break}if(32&v){n.back=-1,n.mode=mT;break}if(64&v){e.msg="invalid literal/length code",n.mode=vT;break}n.extra=15&v,n.mode=22;case 22:if(n.extra){for(S=n.extra;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.length+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}n.was=n.length,n.mode=23;case 23:for(;v=(L=n.distcode[c&(1<<n.distbits)-1])>>>16&255,_=65535&L,!((m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(!(240&v)){for(y=m,I=v,C=_;v=(L=n.distcode[C+((c&(1<<y+I)-1)>>y)])>>>16&255,_=65535&L,!(y+(m=L>>>24)<=u);){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}c>>>=y,u-=y,n.back+=y}if(c>>>=m,u-=m,n.back+=m,64&v){e.msg="invalid distance code",n.mode=vT;break}n.offset=_,n.extra=15&v,n.mode=24;case 24:if(n.extra){for(S=n.extra;u<S;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}n.offset+=c&(1<<n.extra)-1,c>>>=n.extra,u-=n.extra,n.back+=n.extra}if(n.offset>n.dmax){e.msg="invalid distance too far back",n.mode=vT;break}n.mode=25;case 25:if(0===l)break e;if(h=p-l,n.offset>h){if((h=n.offset-h)>n.whave&&n.sane){e.msg="invalid distance too far back",n.mode=vT;break}h>n.wnext?(h-=n.wnext,f=n.wsize-h):f=n.wnext-h,h>n.length&&(h=n.length),g=n.window}else g=a,f=r-n.offset,h=n.length;h>l&&(h=l),l-=h,n.length-=h;do{a[r++]=g[f++]}while(--h);0===n.length&&(n.mode=21);break;case 26:if(0===l)break e;a[r++]=n.length,l--,n.mode=21;break;case 27:if(n.wrap){for(;u<32;){if(0===s)break e;s--,c|=o[i++]<<u,u+=8}if(p-=l,e.total_out+=p,n.total+=p,p&&(e.adler=n.check=n.flags?BE(n.check,a,p,r-p):xE(n.check,a,p,r-p)),p=l,(n.flags?c:_T(c))!==n.check){e.msg="incorrect data check",n.mode=vT;break}c=0,u=0}n.mode=28;case 28:if(n.wrap&&n.flags){for(;u<32;){if(0===s)break e;s--,c+=o[i++]<<u,u+=8}if(c!==(4294967295&n.total)){e.msg="incorrect length check",n.mode=vT;break}c=0,u=0}n.mode=29;case 29:E=1;break e;case vT:E=-3;break e;case 31:return-4;default:return gT}return e.next_out=r,e.avail_out=l,e.next_in=i,e.avail_in=s,n.hold=c,n.bits=u,(n.wsize||p!==e.avail_out&&n.mode<vT&&(n.mode<27||4!==t))&&(M=e,w=e.output,b=e.next_out,D=p-e.avail_out,null===(R=M.state).window&&(R.wsize=1<<R.wbits,R.wnext=0,R.whave=0,R.window=new Jk(R.wsize)),D>=R.wsize?(Zk(R.window,w,b-R.wsize,R.wsize,0),R.wnext=0,R.whave=R.wsize):((N=R.wsize-R.wnext)>D&&(N=D),Zk(R.window,w,b-D,N,R.wnext),(D-=N)?(Zk(R.window,w,b-D,D,0),R.wnext=D,R.whave=R.wsize):(R.wnext+=N,R.wnext===R.wsize&&(R.wnext=0),R.whave<R.wsize&&(R.whave+=N)))),d-=e.avail_in,p-=e.avail_out,e.total_in+=d,e.total_out+=p,n.total+=p,n.wrap&&p&&(e.adler=n.check=n.flags?BE(n.check,a,p,e.next_out-p):xE(n.check,a,p,e.next_out-p)),e.data_type=n.bits+(n.last?64:0)+(n.mode===mT?128:0)+(20===n.mode||15===n.mode?256:0),(0===d&&0===p||4===t)&&0===E&&(E=-5),E}(l,e);break;default:throw new Error("Unknown mode "+this.mode)}return 1!==s&&0!==s&&this._error(s),this.write_in_progress=!1,[l.avail_in,l.avail_out]},MT.prototype.close=function(){this.write_in_progress?this.pending_close=!0:(this.pending_close=!1,1===this.mode||3===this.mode||5===this.mode?function(e){var t;e&&e.state&&(42!==(t=e.state.status)&&69!==t&&73!==t&&91!==t&&t!==jE&&t!==qE&&t!==KE?YE(e,FE):(e.state=null,t===qE&&YE(e,-3)))}(this.strm):function(e){if(!e||!e.state)return gT;var t=e.state;t.window&&(t.window=null),e.state=null}(this.strm),this.mode=0)},MT.prototype.reset=function(){switch(this.mode){case 1:case 5:ST=rT(this.strm);break;case 2:case 6:ST=IT(this.strm)}0!==ST&&this._error(ST)},MT.prototype._error=function(e){this.onerror($k[e]+": "+this.strm.msg,e),this.write_in_progress=!1,this.pending_close&&this.close()};var bT=Object.freeze({NONE:0,DEFLATE:1,INFLATE:2,GZIP:3,GUNZIP:4,DEFLATERAW:5,INFLATERAW:6,UNZIP:7,Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8,Zlib:MT}),DT={};Object.keys(bT).forEach((function(e){DT[e]=bT[e]})),DT.Z_MIN_WINDOWBITS=8,DT.Z_MAX_WINDOWBITS=15,DT.Z_DEFAULT_WINDOWBITS=15,DT.Z_MIN_CHUNK=64,DT.Z_MAX_CHUNK=1/0,DT.Z_DEFAULT_CHUNK=16384,DT.Z_MIN_MEMLEVEL=1,DT.Z_MAX_MEMLEVEL=9,DT.Z_DEFAULT_MEMLEVEL=8,DT.Z_MIN_LEVEL=-1,DT.Z_MAX_LEVEL=9,DT.Z_DEFAULT_LEVEL=DT.Z_DEFAULT_COMPRESSION;var NT={Z_OK:DT.Z_OK,Z_STREAM_END:DT.Z_STREAM_END,Z_NEED_DICT:DT.Z_NEED_DICT,Z_ERRNO:DT.Z_ERRNO,Z_STREAM_ERROR:DT.Z_STREAM_ERROR,Z_DATA_ERROR:DT.Z_DATA_ERROR,Z_MEM_ERROR:DT.Z_MEM_ERROR,Z_BUF_ERROR:DT.Z_BUF_ERROR,Z_VERSION_ERROR:DT.Z_VERSION_ERROR};function RT(e,t){if("string"==typeof t&&(t=new MI(t)),!cC(t))throw new TypeError("Not a string or buffer");var n=DT.Z_FINISH;return e._processChunk(t,n)}function LT(e){if(!(this instanceof LT))return new LT(e);BT.call(this,e,DT.DEFLATE)}function AT(e){if(!(this instanceof AT))return new AT(e);BT.call(this,e,DT.INFLATE)}function OT(e){if(!(this instanceof OT))return new OT(e);BT.call(this,e,DT.GZIP)}function PT(e){if(!(this instanceof PT))return new PT(e);BT.call(this,e,DT.GUNZIP)}function UT(e){if(!(this instanceof UT))return new UT(e);BT.call(this,e,DT.DEFLATERAW)}function xT(e){if(!(this instanceof xT))return new xT(e);BT.call(this,e,DT.INFLATERAW)}function VT(e){if(!(this instanceof VT))return new VT(e);BT.call(this,e,DT.UNZIP)}function BT(e,t){if(this._opts=e=e||{},this._chunkSize=e.chunkSize||DT.Z_DEFAULT_CHUNK,jk.call(this,e),e.flush&&e.flush!==DT.Z_NO_FLUSH&&e.flush!==DT.Z_PARTIAL_FLUSH&&e.flush!==DT.Z_SYNC_FLUSH&&e.flush!==DT.Z_FULL_FLUSH&&e.flush!==DT.Z_FINISH&&e.flush!==DT.Z_BLOCK)throw new Error("Invalid flush flag: "+e.flush);if(this._flushFlag=e.flush||DT.Z_NO_FLUSH,e.chunkSize&&(e.chunkSize<DT.Z_MIN_CHUNK||e.chunkSize>DT.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<DT.Z_MIN_WINDOWBITS||e.windowBits>DT.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<DT.Z_MIN_LEVEL||e.level>DT.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<DT.Z_MIN_MEMLEVEL||e.memLevel>DT.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=DT.Z_FILTERED&&e.strategy!=DT.Z_HUFFMAN_ONLY&&e.strategy!=DT.Z_RLE&&e.strategy!=DT.Z_FIXED&&e.strategy!=DT.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!cC(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._binding=new DT.Zlib(t);var n=this;this._hadError=!1,this._binding.onerror=function(e,t){n._binding=null,n._hadError=!0;var o=new Error(e);o.errno=t,o.code=DT.codes[t],n.emit("error",o)};var o=DT.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(o=e.level);var a=DT.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(a=e.strategy),this._binding.init(e.windowBits||DT.Z_DEFAULT_WINDOWBITS,o,e.memLevel||DT.Z_DEFAULT_MEMLEVEL,a,e.dictionary),this._buffer=new MI(this._chunkSize),this._offset=0,this._closed=!1,this._level=o,this._strategy=a,this.once("end",this.close)}Object.keys(NT).forEach((function(e){NT[NT[e]]=e})),PC(BT,jk),BT.prototype.params=function(e,t,n){if(e<DT.Z_MIN_LEVEL||e>DT.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+e);if(t!=DT.Z_FILTERED&&t!=DT.Z_HUFFMAN_ONLY&&t!=DT.Z_RLE&&t!=DT.Z_FIXED&&t!=DT.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+t);if(this._level!==e||this._strategy!==t){var o=this;this.flush(DT.Z_SYNC_FLUSH,(function(){o._binding.params(e,t),o._hadError||(o._level=e,o._strategy=t,n&&n())}))}else SC(n)},BT.prototype.reset=function(){return this._binding.reset()},BT.prototype._flush=function(e){this._transform(new MI(0),"",e)},BT.prototype.flush=function(e,t){var n=this._writableState;if(("function"==typeof e||void 0===e&&!t)&&(t=e,e=DT.Z_FULL_FLUSH),n.ended)t&&SC(t);else if(n.ending)t&&this.once("end",t);else if(n.needDrain){var o=this;this.once("drain",(function(){o.flush(t)}))}else this._flushFlag=e,this.write(new MI(0),"",t)},BT.prototype.close=function(e){if(e&&SC(e),!this._closed){this._closed=!0,this._binding.close();var t=this;SC((function(){t.emit("close")}))}},BT.prototype._transform=function(e,t,n){var o,a=this._writableState,i=(a.ending||a.ended)&&(!e||a.length===e.length);if(null===!e&&!cC(e))return n(new Error("invalid input"));i?o=DT.Z_FINISH:(o=this._flushFlag,e.length>=a.length&&(this._flushFlag=this._opts.flush||DT.Z_NO_FLUSH)),this._processChunk(e,o,n)},BT.prototype._processChunk=function(e,t,n){var o=e&&e.length,a=this._chunkSize-this._offset,i=0,r=this,s="function"==typeof n;if(!s){var l,c=[],u=0;this.on("error",(function(e){l=e}));do{var d=this._binding.writeSync(t,e,i,o,this._buffer,this._offset,a)}while(!this._hadError&&f(d[0],d[1]));if(this._hadError)throw l;var p=MI.concat(c,u);return this.close(),p}var h=this._binding.write(t,e,i,o,this._buffer,this._offset,a);function f(l,d){if(!r._hadError){var p=a-d;if(function(e){if(!e)throw new Error("have should not go down")}(p>=0),p>0){var h=r._buffer.slice(r._offset,r._offset+p);r._offset+=p,s?r.push(h):(c.push(h),u+=h.length)}if((0===d||r._offset>=r._chunkSize)&&(a=r._chunkSize,r._offset=0,r._buffer=new MI(r._chunkSize)),0===d){if(i+=o-l,o=l,!s)return!0;var g=r._binding.write(t,e,i,o,r._buffer,r._offset,r._chunkSize);return g.callback=f,void(g.buffer=e)}if(!s)return!1;n()}}h.buffer=e,h.callback=f},PC(LT,BT),PC(AT,BT),PC(OT,BT),PC(PT,BT),PC(UT,BT),PC(xT,BT),PC(VT,BT);var GT=function(e,t){return RT(new LT(t),e)},FT=function(e,t){return RT(new AT(t),e)};class zT{constructor(e,t,n){this.SDKAPPID=e,this.EXPIRETIME=n,this.PRIVATEKEY=t}genTestUserSig(e){return this._isNumber(this.SDKAPPID)?this._isString(this.PRIVATEKEY)?this._isString(e)?this._isNumber(this.EXPIRETIME)?(oe("log","at sdk/lib-generate-test-usersig-es.min.js:2","sdkAppID="+this.SDKAPPID+" key="+this.PRIVATEKEY+" userID="+e+" expire="+this.EXPIRETIME),this.genSigWithUserbuf(e,this.EXPIRETIME,null)):(oe("error","at sdk/lib-generate-test-usersig-es.min.js:2","expireTime must be a number"),""):(oe("error","at sdk/lib-generate-test-usersig-es.min.js:2","userID must be a string"),""):(oe("error","at sdk/lib-generate-test-usersig-es.min.js:2","privateKey must be a string"),""):(oe("error","at sdk/lib-generate-test-usersig-es.min.js:2","sdkAppID must be a number"),"")}newBuffer(e,t){return MI.from?MI.from(e,t):new MI(e,t)}unescape(e){return e.replace(/_/g,"=").replace(/\-/g,"/").replace(/\*/g,"+")}escape(e){return e.replace(/\+/g,"*").replace(/\//g,"-").replace(/=/g,"_")}encode(e){return this.escape(this.newBuffer(e).toString("base64"))}decode(e){return this.newBuffer(this.unescape(e),"base64")}base64encode(e){return this.newBuffer(e).toString("base64")}base64decode(e){return this.newBuffer(e,"base64").toString()}_hmacsha256(e,t,n,o){let a="TLS.identifier:"+e+"\n";a+="TLS.sdkappid:"+this.SDKAPPID+"\n",a+="TLS.time:"+t+"\n",a+="TLS.expire:"+n+"\n",null!=o&&(a+="TLS.userbuf:"+o+"\n");let i=hC.HmacSHA256(a,this.PRIVATEKEY);return hC.enc.Base64.stringify(i)}_utc(){return Math.round(Date.now()/1e3)}_isNumber(e){return null!==e&&("number"==typeof e&&!isNaN(e-0)||"object"==typeof e&&e.constructor===Number)}_isString(e){return"string"==typeof e}genSigWithUserbuf(e,t,n){let o=this._utc(),a={"TLS.ver":"2.0","TLS.identifier":e,"TLS.sdkappid":this.SDKAPPID,"TLS.time":o,"TLS.expire":t},i="";if(null!=n){let r=this.base64encode(n);a["TLS.userbuf"]=r,i=this._hmacsha256(e,o,t,r)}else i=this._hmacsha256(e,o,t,null);a["TLS.sig"]=i;let r=JSON.stringify(a),s=GT(this.newBuffer(r)).toString("base64"),l=this.escape(s);return oe("log","at sdk/lib-generate-test-usersig-es.min.js:2","ret="+l),l}validate(e){let t=this.decode(e);oe("log","at sdk/lib-generate-test-usersig-es.min.js:2","validate ret="+FT(t))}}const HT=e=>{const t=It();if(e||t.userInfo.appId){const n=e||t.userInfo.appId;dI.init();const o=(e=>{const{SDKAppID:t,secretKey:n,userID:o}=e;return{SDKAppID:t,userSig:new zT(t,n,604800).genTestUserSig(o)}})({SDKAppID:1600073144,secretKey:"a86f6b8102c5c379b78baf4961923ade96af7d3ec4c34fb317099942067e63c7",userID:n});yt.login({SDKAppID:1600073144,userID:n,userSig:o.userSig,useUploadPlugin:!0,framework:"vue3"}).catch((e=>{oe("log","at utils/TUIKit.ts:27",e)}))}},jT=e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(20,15,20,15),o=It(),a=Ct(),i=e.reactive({uuid:"",code:"",phone:"",agree:!1}),r=e.ref(!0),s=e.ref({}),l=e.ref(null),c=e.ref(60),u=e.ref(!0),d=e.computed((()=>/^1[3-9]\d{9}$/.test(i.phone)&&u.value)),p=()=>__async(this,null,(function*(){u.value=!1,c.value=60,l.value=setInterval((()=>{c.value>0?c.value-=1:clearInterval(l.value)}),1e3);const e=yield Ma(i.phone);i.uuid=e.uuid})),h=e.computed((()=>/^1[3-9]\d{9}$/.test(i.phone)&&i.code)),f=()=>__async(this,null,(function*(){i.agree?new Promise(((e,t)=>{"android"===uni.getSystemInfoSync().platform?plus.android.requestPermissions(["android.permission.ACCESS_FINE_LOCATION"],(n=>{n.deniedAlways.length>0?t(Error("用户永久拒绝了定位权限")):n.deniedPresent.length>0?t(Error("用户本次拒绝了定位权限")):e(!0)}),(e=>{t(e)})):e(!0)})).then((()=>{uni.showLoading({title:"用户登录中...",mask:!0}),uni.getLocation({type:"gcj02",success:e=>__async(this,null,(function*(){const{token:t}=yield wa({uuid:i.uuid,code:i.code,phone:i.phone,latitude:e.latitude,longitude:e.longitude});o.setToken(t);const n=yield sa();o.setUserInfo(n.data);const r=yield ia();a.setDataMap(r.data),HT(n.data.appId),uni.hideLoading(),uni.switchTab({url:"/pages/connect/index"})})),fail:e=>__async(this,null,(function*(){oe("error","at pages/login/index.vue:211","获取位置信息失败",e);const{token:t}=yield wa({uuid:i.uuid,code:i.code,phone:i.phone,latitude:22.5445741,longitude:114.0545429});o.setToken(t);const n=yield sa();o.setUserInfo(n.data);const r=yield ia();a.setDataMap(r.data),HT(n.data.appId),uni.hideLoading(),uni.switchTab({url:"/pages/connect/index"})}))})})):uni.showToast({icon:"none",title:"请勾选同意《用户须知》和《隐私协议》！"})}));return e.onMounted((()=>{(()=>{const e=uni.createAnimation({duration:2e3,timingFunction:"ease-in-out"});e.opacity(0).step(),s.value=e.export()})(),setTimeout((()=>{r.value=!1}),1500)})),e.onBeforeUnmount((()=>{l.value&&clearInterval(l.value)})),(t,o)=>{const a=ae(e.resolveDynamicComponent("wd-img"),te),l=ae(e.resolveDynamicComponent("wd-input"),lo),g=ae(e.resolveDynamicComponent("wd-button"),Te),m=ae(e.resolveDynamicComponent("wd-checkbox"),qo),v=ae(e.resolveDynamicComponent("wd-text"),me);return e.openBlock(),e.createElementBlock("view",{class:"login_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.unref(r)?(e.openBlock(),e.createElementBlock("view",{key:0,animation:e.unref(s),class:"weclome"},[e.createElementVNode("view",{class:"title"},"欢迎来到梦缘婚恋"),e.createElementVNode("view",{class:"copyright"},"©版权（copyright）梦缘婚恋有限公司")],8,["animation"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"loginForm"},[e.createElementVNode("view",{class:"formItem mb-16px"},[e.createVNode(a,{class:"w-24px h-24px mr-8px",src:"/static/images/phone2.png"}),e.createVNode(l,{class:"flex-1",type:"number",modelValue:i.phone,"onUpdate:modelValue":o[0]||(o[0]=e=>i.phone=e),placeholder:"请输入手机号码"},null,8,["modelValue"])]),e.createElementVNode("view",{class:"formItem"},[e.createElementVNode("view",{class:"w-100% flex items-center justify-between"},[e.createVNode(a,{class:"w-24px h-24px mr-8px",src:"/static/images/code.png"}),e.createVNode(l,{class:"flex-1",type:"number",modelValue:i.code,"onUpdate:modelValue":o[1]||(o[1]=e=>i.code=e),placeholder:"请输入验证码"},null,8,["modelValue"]),e.createVNode(g,{class:"codeBtn ml-10px min-w-100px",type:"text",size:"small",disabled:!d.value,onClick:p},{default:e.withCtx((()=>[e.unref(u)?(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode("获取验证码")],64)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode("重新获取（"+e.toDisplayString(e.unref(c))+" ）",1)],64))])),_:1},8,["disabled"])])]),e.createElementVNode("view",{class:"w-100% mt-30px"},[e.createVNode(g,{class:"login_btn w-100%",type:"error",size:"large",disabled:!h.value,onClick:f},{default:e.withCtx((()=>[e.createTextVNode(" 登录/注册 ")])),_:1},8,["disabled"])]),e.createElementVNode("view",{class:"policy"},[e.createVNode(m,{shape:"square",modelValue:i.agree,"onUpdate:modelValue":o[2]||(o[2]=e=>i.agree=e)},null,8,["modelValue"]),e.createElementVNode("view",{class:"text"},[e.createTextVNode(" 登录注册即表示同意 "),e.createVNode(v,{text:"《用户须知》",color:"#000000"}),e.createVNode(v,{text:"《隐私协议》",color:"#000000"})])])]))],4)}}}),qT=ee(jT,[["__scopeId","data-v-a2c41c13"]]),KT=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,80,15),o=()=>{uni.navigateTo({url:"/pages/notice/index"})},a=e.ref(!1),i=()=>{a.value=!0};return e.onMounted((()=>{uni.hideTabBar({animation:!1})})),(t,r)=>{const s=ae(e.resolveDynamicComponent("wd-img"),te),l=ae(e.resolveDynamicComponent("wd-icon"),_e),c=ae(e.resolveDynamicComponent("wd-badge"),Fa),u=ae(e.resolveDynamicComponent("z-paging"),to),d=ae(e.resolveDynamicComponent("wd-button"),Te),p=ae(e.resolveDynamicComponent("wd-overlay"),io);return e.openBlock(),e.createElementBlock("view",{class:"message_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},"消息"),e.createElementVNode("view",{class:"body"},[e.createVNode(u,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"tip"},[e.createElementVNode("view",{class:"message_icon"},[e.createVNode(s,{class:"w-21px h-16px",src:"/static/images/message3.png"})]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"text"},[e.createElementVNode("view",{class:"title"},"打开推送，及时接受消息"),e.createElementVNode("view",{class:"desc"},"交友成功率提高10倍")]),e.createVNode(l,{name:"close",size:"12px",color:"#9395A4"})])]),e.createElementVNode("view",{class:"tip"},[e.createVNode(s,{class:"w-40px h-40px mr-10px",src:"/static/images/bell.png"}),e.createElementVNode("view",{class:"content",onClick:o},[e.createElementVNode("view",{class:"text"},"消息通知"),e.createVNode(c,{"custom-class":"badge",modelValue:"12","bg-color":"#fd5b59"})])]),(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(20,(t=>e.createElementVNode("view",{key:t,class:"messageItem",onClick:i},[e.createElementVNode("view",{class:"left"},[e.createVNode(s,{class:"avatar",src:"/static/images/image.png"}),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"user"},[e.createElementVNode("view",{class:"name"},"石榴籽儿"),e.createVNode(s,{class:"icon",src:"/static/images/vip.png"}),e.createVNode(s,{class:"icon",src:"/static/images/checked.png"})]),e.createElementVNode("view",{class:"content"},"你好呀，可以认识一下吗？")])]),e.createElementVNode("view",{class:"right"},[e.createElementVNode("view",{class:"time"},"20:20"),e.createVNode(c,{"custom-class":"badge",modelValue:"123","bg-color":"#fd5b59"})])]))),64))])),_:1})]),e.createVNode(p,{show:a.value,onClick:r[0]||(r[0]=e=>a.value=!1)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"dialog_wrapper"},[e.createElementVNode("view",{class:"block"},[e.createVNode(s,{class:"w-48px h-48px mt-20px",src:"/static/images/bell.png"}),e.createElementVNode("view",{class:"text"},"开通会员VIP才可以互相聊天哦~"),e.createElementVNode("view",{class:"btns"},[e.createVNode(d,{class:"cancel"},{default:e.withCtx((()=>[e.createTextVNode("暂不开通")])),_:1}),e.createVNode(d,{class:"confirm"},{default:e.withCtx((()=>[e.createTextVNode("立即开通")])),_:1})])])])])),_:1},8,["show"]),e.createVNode(ai)],4)}}}),[["__scopeId","data-v-7c5049b0"]]);const YT=ee({},[["render",function(t,n){const o=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"noticecard"},[e.createVNode(o,{class:"w-40px h-40px mr-10px",src:"/static/images/bell.png"}),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"title"},"精准匹配遇见幸福"),e.createElementVNode("view",{class:"detail"},"哈喽，您的会员服务还剩7天到期，请您及时续费会员继续体验~"),e.createVNode(o,{class:"w-100% h-174px mt-10px",src:"/static/images/image2.png"}),e.createElementVNode("view",{class:"time mt-10px"},"2024-12-20 12:00:00")])])}],["__scopeId","data-v-e8a14760"]]),$T=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et();return(t,o)=>{const a=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"notice_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createVNode(a,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock(e.Fragment,null,e.renderList(10,(t=>e.createElementVNode("view",{class:"card",key:t},[e.createVNode(YT)]))),64))])),_:1})],4)}}}),[["__scopeId","data-v-4a890764"]]),WT=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,80,15),o=It(),a=()=>{uni.setClipboardData({data:o.userInfo.appId,success:()=>{uni.showToast({icon:"none",title:"复制成功"})},fail:()=>{uni.showToast({icon:"none",title:"复制失败"})}})},i=()=>{uni.navigateTo({url:"/pages/profile/index?type=own"})},r=e=>{uni.navigateTo({url:`/pages/person/index?type=${e}`})},s=e=>{uni.navigateTo({url:`/pages/${e}/index`})},l=()=>{uni.navigateTo({url:"/pages/baseInfo/index?type=check"})},c=()=>{uni.navigateTo({url:"/pages/settings/index"})};return e.onMounted((()=>{uni.hideTabBar({animation:!1})})),re((()=>__async(this,null,(function*(){const e=yield sa();o.setUserInfo(e.data)})))),(t,u)=>{const d=ae(e.resolveDynamicComponent("wd-img"),te),p=ae(e.resolveDynamicComponent("wd-icon"),_e);return e.openBlock(),e.createElementBlock("view",{class:"own_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"setting"},[e.createVNode(d,{class:"icon",src:"/static/images/message.png"}),e.createVNode(d,{class:"icon",src:"/static/images/settings.png",onClick:c})]),e.createElementVNode("view",{class:"own"},[e.createVNode(d,{class:"avatar",src:e.unref(o).userInfo.avatar},null,8,["src"]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"name"},e.toDisplayString(e.unref(o).userInfo.nickName),1),e.createElementVNode("view",{class:"id"},[e.createElementVNode("view",{class:"number"},"梦缘ID："+e.toDisplayString(e.unref(o).userInfo.appId),1),e.createElementVNode("view",{class:"copy",onClick:a},"复制")]),e.createElementVNode("view",{class:"status"},["1"===e.unref(o).userInfo.vipOpean?(e.openBlock(),e.createBlock(d,{key:0,class:"icon",src:"/static/images/vip.png"})):e.createCommentVNode("",!0),"1"===e.unref(o).userInfo.hasRealName?(e.openBlock(),e.createBlock(d,{key:1,class:"icon",src:"/static/images/checked.png"})):e.createCommentVNode("",!0)])]),e.createElementVNode("view",{class:"right",onClick:i},[e.createTextVNode(" 查看 "),e.createVNode(p,{name:"arrow-right",size:"14px",color:"#9395a4"})])])]),e.createElementVNode("view",{class:"func"},[e.createElementVNode("view",{class:"item",onClick:u[0]||(u[0]=e=>r("1"))},[e.createElementVNode("view",{class:"num"},e.toDisplayString(e.unref(o).userInfo.followCount||0),1),e.createElementVNode("view",{class:"text"},"我关注的")]),e.createElementVNode("view",{class:"item",onClick:u[1]||(u[1]=e=>r("2"))},[e.createElementVNode("view",{class:"num"},e.toDisplayString(e.unref(o).userInfo.bothFollow||0),1),e.createElementVNode("view",{class:"text"},"互相喜欢")]),e.createElementVNode("view",{class:"item",onClick:u[2]||(u[2]=e=>r("3"))},[e.createElementVNode("view",{class:"num"},e.toDisplayString(e.unref(o).userInfo.fansCount||0),1),e.createElementVNode("view",{class:"text"},"喜欢我的")]),e.createElementVNode("view",{class:"item",onClick:u[3]||(u[3]=e=>r("4"))},[e.createElementVNode("view",{class:"num"},e.toDisplayString(e.unref(o).userInfo.visitCount||0),1),e.createElementVNode("view",{class:"text"},"最近访客")])]),e.createElementVNode("view",{class:"ad"},[e.createVNode(d,{class:"icon",src:"/static/images/ad.png"})]),e.createElementVNode("view",{class:"menu"},[e.createElementVNode("view",{class:"item",onClick:l},[e.createVNode(d,{class:"icon",src:"/static/images/base.png"}),e.createElementVNode("view",{class:"entry"},[e.createTextVNode(" 基本资料 "),e.createVNode(d,{class:"icon2",src:"/static/images/arrow2.png"})])]),e.createElementVNode("view",{class:"item",onClick:u[4]||(u[4]=e=>s("wallet"))},[e.createVNode(d,{class:"icon",src:"/static/images/wallet.png"}),e.createElementVNode("view",{class:"entry"},[e.createTextVNode(" 我的钱包 "),e.createVNode(d,{class:"icon2",src:"/static/images/arrow2.png"})])]),e.createElementVNode("view",{class:"item",onClick:u[5]||(u[5]=e=>s("validate"))},[e.createVNode(d,{class:"icon",src:"/static/images/validate.png"}),e.createElementVNode("view",{class:"entry"},[e.createTextVNode(" 认证中心 "),e.createVNode(d,{class:"icon2",src:"/static/images/arrow2.png"})])]),e.createElementVNode("view",{class:"item",onClick:u[6]||(u[6]=e=>s("invite"))},[e.createVNode(d,{class:"icon",src:"/static/images/share.png"}),e.createElementVNode("view",{class:"entry"},[e.createTextVNode(" 邀请好友 "),e.createVNode(d,{class:"icon2",src:"/static/images/arrow2.png"})])])]),e.createElementVNode("view",{class:"menu2"},[e.createElementVNode("view",{class:"item",onClick:u[7]||(u[7]=e=>{return t="COM_QUALIFY",void uni.navigateTo({url:`/pages/policy/index?code=${t}`});var t})},[e.createVNode(d,{class:"icon",src:"/static/images/folder.png"}),e.createElementVNode("view",{class:"entry"},[e.createTextVNode(" 企业资质 "),e.createVNode(d,{class:"icon2",src:"/static/images/arrow2.png"})])]),e.createElementVNode("view",{class:"item",onClick:u[8]||(u[8]=e=>s("invite"))},[e.createVNode(d,{class:"icon",src:"/static/images/thumbUp.png"}),e.createElementVNode("view",{class:"entry"},[e.createTextVNode(" 去评分 "),e.createVNode(d,{class:"icon2",src:"/static/images/arrow2.png"})])]),e.createElementVNode("view",{class:"item",onClick:u[9]||(u[9]=e=>s("suggestion"))},[e.createVNode(d,{class:"icon",src:"/static/images/email.png"}),e.createElementVNode("view",{class:"entry"},[e.createTextVNode(" 建议反馈 "),e.createVNode(d,{class:"icon2",src:"/static/images/arrow2.png"})])])]),e.createVNode(ai)],4)}}}),[["__scopeId","data-v-8450fa67"]]),ZT=ee(e.defineComponent({__name:"user2",props:{userData:{type:Object,default:()=>({})}},setup(t){const n=t,o=e.computed((()=>0===n.userData.sex?"/static/images/female.png":"/static/images/male.png"));return(n,a)=>{const i=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"user2card"},[t.userData.avatar?(e.openBlock(),e.createBlock(i,{key:0,class:"w-50px h-50px mr-6px rounded-[50%] overflow-hidden",src:t.userData.avatar},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"w-50px h-50px mr-6px rounded-[50%] overflow-hidden bg-gray-200 flex items-center justify-center text-[8px] text-gray-400"}," 暂无头像 ")),e.createElementVNode("view",{class:"h-100% flex-1 flex items-center justify-between"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"title"},[e.createElementVNode("view",{class:"name"},e.toDisplayString(t.userData.nickName),1),"1"===t.userData.vipOpean?(e.openBlock(),e.createBlock(i,{key:0,class:"icon",src:"/static/images/vip.png"})):e.createCommentVNode("",!0),"1"===t.userData.hasRealName?(e.openBlock(),e.createBlock(i,{key:1,class:"icon",src:"/static/images/checked.png"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"line1"},[e.createElementVNode("view",null,e.toDisplayString(t.userData.locationName)+" · "+e.toDisplayString(t.userData.distance?t.userData.distance.toFixed(2):"0.00")+"km ",1),e.createElementVNode("view",{class:"divider"}),e.createVNode(i,{class:"w-12px h-12px",src:e.unref(o)},null,8,["src"]),e.createElementVNode("view",null,"·"+e.toDisplayString(t.userData.age)+"岁",1)]),e.createElementVNode("view",{class:"line2"},[e.createElementVNode("view",{class:"type"},"近期活跃")])]),e.createElementVNode("view",{class:"right"},[e.createVNode(i,{class:"icon",src:"/static/images/heart.png"}),e.createTextVNode(" 打招呼 ")])])])}}}),[["__scopeId","data-v-2b39d6bf"]]),JT=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o={1:"我的关注",2:"互相喜欢 ",3:"喜欢我的 ",4:"最近访客"},a={1:ca,2:da,3:ua,4:pa},i=e.ref(""),r=e.ref(""),s=e.ref(""),l=e.ref([]),c=e.ref(!1),u=e.ref(null),d=()=>{uni.navigateBack()},p=()=>__async(this,null,(function*(){c.value=!0;const{rows:e}=yield a[i.value]({keyword:s.value});l.value=e,u.value.complete(l.value),c.value=!1}));return ce((e=>{i.value=e.type,r.value=o[e.type],p()})),(t,o)=>{const a=ae(e.resolveDynamicComponent("wd-img"),te),i=ae(e.resolveDynamicComponent("wd-search"),Fo),h=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"person_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(a,{class:"back",src:"/static/images/back.png",onClick:d}),e.createElementVNode("view",{class:"title"},e.toDisplayString(r.value),1)]),e.createElementVNode("view",{class:"search_wrapper"},[e.createVNode(i,{"placeholder-left":"","hide-cancel":"",placeholder:"请输入昵称或用户ID",modelValue:s.value,"onUpdate:modelValue":o[0]||(o[0]=e=>s.value=e),onSearch:p},null,8,["modelValue"])]),e.createElementVNode("view",{class:"list"},[e.createVNode(h,{class:"list_scroll",ref_key:"userListRef",ref:u,fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1,modelValue:l.value,"onUpdate:modelValue":o[1]||(o[1]=e=>l.value=e),"show-loading-more-no-more-view":l.value.length>0,"refresher-complete-text":"刷新完成","refresher-default-text":"下拉刷新","refresher-pulling-text":"释放刷新","refresher-refreshing-text":"加载中...","loading-more-no-more-text":"没有更多数据啦~",onQuery:p},{default:e.withCtx((()=>[!c.value&&l.value.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(l.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"card",key:n},[e.createVNode(ZT,{userData:t,onClick:e=>{return n=t,void uni.navigateTo({url:`/pages/profile/index?type=other&id=${n.userId}`});var n}},null,8,["userData","onClick"])])))),128)):e.createCommentVNode("",!0),c.value||0!==l.value.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty"},[e.createVNode(a,{class:"w-200px h-200px",src:"/static/images/empty.png"}),e.createTextVNode(" 暂无用户数据 ")]))])),_:1},8,["modelValue","show-loading-more-no-more-view"])])],4)}}}),[["__scopeId","data-v-6bcce4d4"]]),XT=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.ref(""),a=e.ref(""),i={COM_QUALIFY:"企业资质",AUTHORIZATION_LETTER:"授权书",INFORMATION_FOR_USERS:"用户协议",PRIVACY_POLICY:"隐私政策",USER_CONDUCT:"用户行为规范",MEMBERSHIP_AGREEMENT:"会员协议",PERMISSION_LIST:"权限获取清单",THIRD_PARTY_SDK_LIST:"三方SDK清单",INFORMATION_SHARING_LIST:"信息共享清单",REGISTRATION_COMMITMENT:"注册承诺函"},r=()=>{uni.navigateBack()};return ce((e=>__async(this,null,(function*(){o.value=i[e.code];const{data:t}=yield(n={code:e.code},aa.post("/prod-api/app/documents/detail",n));var n;a.value=decodeURIComponent(t.content)})))),(t,i)=>{const s=ae(e.resolveDynamicComponent("wd-img"),te),l=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"policy_contianer",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(s,{class:"back",src:"/static/images/back.png",onClick:r}),e.createElementVNode("view",{class:"title"},e.toDisplayString(o.value),1)]),e.createVNode(l,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createElementVNode("rich-text",{class:"ql-editor",nodes:a.value},null,8,["nodes"])])),_:1})],4)}}}),[["__scopeId","data-v-0571247f"]]),QT=e=>{(e.$renderjs||(e.$renderjs=[])).push("domVideoPlayer"),(e.$renderjsModules||(e.$renderjsModules={})).domVideoPlayer="6f44a48a"},eS={props:{src:{type:String,default:""},autoplay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},controls:{type:Boolean,default:!1},controlsList:{type:String,default:""},objectFit:{type:String,default:"contain"},muted:{type:Boolean,default:!1},playbackRate:{type:Number,default:1},isLoading:{type:Boolean,default:!1},poster:{type:String,default:""},isLog:{type:Boolean,default:!0},id:{type:String,default:""}},data:()=>({randomNum:Math.floor(1e8*Math.random()),videoSrc:"",eventCommand:null,renderFunc:{name:null,params:null},currentTime:0,duration:0,playing:!1}),mounted(){},watch:{src:{handler(e){e&&setTimeout((()=>{this.videoSrc=e}),0)},immediate:!0}},computed:{videoWrapperId(){return`video-wrapper-${this.randomNum}`},viewportProps(){return{autoplay:this.autoplay,muted:this.muted,controls:this.controls,controlsList:this.controlsList,loop:this.loop,objectFit:this.objectFit,poster:this.poster,isLoading:this.isLoading,playbackRate:this.playbackRate}}},methods:{videoWrapperClick(e){this.$emit("video-click",e)},eventEmit({event:e,data:t}){this.$emit(e,t)},setViewData({key:e,value:t}){e&&this.$set(this,e,t)},resetEventCommand(){this.eventCommand=null},play(){this.eventCommand="play"},pause(){this.eventCommand="pause"},resetFunc(){this.renderFunc={name:null,params:null}},remove(e){this.renderFunc={name:"removeHandler",params:e}},fullScreen(e){this.renderFunc={name:"fullScreenHandler",params:e}},toSeek(e,t=!1){this.renderFunc={name:"toSeekHandler",params:{sec:e,isDelay:t}}}}};QT(eS);const tS=ee(eS,[["render",function(t,n,o,a,i,r){return e.openBlock(),e.createElementBlock("view",{class:"player-wrapper",id:r.videoWrapperId,parentId:o.id,randomNum:e.wp(i.randomNum),"change:randomNum":t.domVideoPlayer.randomNumChange,viewportProps:e.wp(r.viewportProps),"change:viewportProps":t.domVideoPlayer.viewportChange,videoSrc:e.wp(i.videoSrc),"change:videoSrc":t.domVideoPlayer.initVideoPlayer,command:e.wp(i.eventCommand),"change:command":t.domVideoPlayer.triggerCommand,func:e.wp(i.renderFunc),"change:func":t.domVideoPlayer.triggerFunc,onClick:n[0]||(n[0]=(...e)=>r.videoWrapperClick&&r.videoWrapperClick(...e))},null,8,["id","parentId","randomNum","change:randomNum","viewportProps","change:viewportProps","videoSrc","change:videoSrc","command","change:command","func","change:func"])}],["__scopeId","data-v-80454b7a"]]),nS=ee(e.defineComponent({__name:"post",props:{canShare:{type:Boolean,default:!0},canNavigate:{type:Boolean,default:!0},userData:{type:Object,default:()=>({})},postData:{type:Object,required:!0}},emits:["refreshData"],setup(t,{emit:n}){const o=It(),a=t,i=n,r=()=>{var e;e={postId:a.postData.id},aa.post("/prod-api/app/post/like",e)},s=()=>{o.userInfo.userId===a.userData.userId?uni.navigateTo({url:"/pages/profile/index?type=own"}):uni.navigateTo({url:`/pages/profile/index?type=other&id=${a.userData.userId}`})},l=()=>__async(this,null,(function*(){a.userData.hasFollow?yield fa(a.userData.userId):yield ha(a.userData.userId),i("refreshData")})),c=()=>{a.canNavigate&&uni.navigateTo({url:`/pages/postDetail/index?id=${a.postData.id}`})};return(n,a)=>{const i=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"statuscard"},[t.userData.avatar?(e.openBlock(),e.createBlock(i,{key:0,class:"w-56px h-56px mr-8px rounded-[50%] overflow-hidden",src:t.userData.avatar},null,8,["src"])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"w-56px h-56px mr-8px rounded-[50%] overflow-hidden bg-gray-200 flex items-center justify-center text-[10px] text-gray-400"}," 暂无头像 ")),e.createElementVNode("view",{class:"body"},[e.createElementVNode("view",{class:"top"},[e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"left",onClick:s},[e.createElementVNode("view",{class:"line"},[e.createElementVNode("view",{class:"name"},e.toDisplayString(t.userData.nickName),1),"1"===t.userData.vipOpean?(e.openBlock(),e.createBlock(i,{key:0,class:"w-40px h-15px ml-5px mr-5px",src:"/static/images/vip.png"})):e.createCommentVNode("",!0),"1"===t.userData.hasRealName?(e.openBlock(),e.createBlock(i,{key:1,class:"w-40px h-15px",src:"/static/images/checked.png"})):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"line2"},e.toDisplayString(t.postData.createTime),1)]),e.createElementVNode("view",{class:"right"},[e.unref(o).userInfo.userId!==t.userData.userId?(e.openBlock(),e.createElementBlock("view",{key:0,class:e.normalizeClass([t.userData.hasFollow?"unFocus":"focus"]),onClick:l},e.toDisplayString(t.userData.hasFollow?"取消关注":"关注"),3)):e.createCommentVNode("",!0),t.canShare?(e.openBlock(),e.createBlock(i,{key:1,class:"w-4px h-18px ml-10px",src:"/static/images/more2.png"})):e.createCommentVNode("",!0)])])]),e.createElementVNode("view",{class:"middle mt-5px"},[e.createElementVNode("view",{class:"title",onClick:c},e.toDisplayString(t.postData.postText),1),e.createElementVNode("view",{class:"content"},[t.postData.postImages&&t.postData.postImages.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(t.postData.postImages,((n,o)=>(e.openBlock(),e.createBlock(i,{key:o,class:"w-90px h-90px rounded-5px mr-5px mb-5px overflow-hidden",src:n,onClick:e=>{return n=t.postData.postImages,a=o,void uni.previewImage({current:a,urls:n});var n,a}},null,8,["src","onClick"])))),128)):e.createCommentVNode("",!0),t.postData.postVideos&&t.postData.postVideos.length>0?(e.openBlock(),e.createBlock(e.unref(tS),{key:1,controls:"",objectFit:"cover",style:{width:"100%",height:"220px"},src:t.postData.postVideos[0]},null,8,["src"])):e.createCommentVNode("",!0)]),t.postData.location?(e.openBlock(),e.createElementBlock("view",{key:0,class:"location"},[e.createVNode(i,{class:"w-22px h-22px",src:"/static/images/location.png"}),e.createTextVNode(" "+e.toDisplayString(t.postData.location),1)])):e.createCommentVNode("",!0)]),e.createElementVNode("view",{class:"bottom"},[e.createElementVNode("view",{class:"item",onClick:c},[e.createVNode(i,{class:"w-19px h-19px mr-5px",src:"/static/images/message2.png"}),e.createTextVNode(" "+e.toDisplayString(t.postData.commentCount),1)]),e.createElementVNode("view",{class:"item"},[e.createVNode(i,{class:"w-19px h-19px mr-5px",src:t.postData.hasLike?"/static/images/heart3.png":"/static/images/heart2.png",onClick:r},null,8,["src"]),e.createTextVNode(" "+e.toDisplayString(t.postData.likeCount),1)])])])])}}}),[["__scopeId","data-v-25600bda"]]),oS=ee(e.defineComponent({__name:"index",props:{commentData:{type:Object,required:!0},isReply:{type:Boolean},replyId:{type:Number}},emits:["on-operate-comment","on-reply-target-comment"],setup(t,{emit:n}){const o=n,a=()=>{o("on-operate-comment")},i=()=>{o("on-reply-target-comment")};return(n,o)=>{const r=ae(e.resolveDynamicComponent("wd-img"),te);return e.openBlock(),e.createElementBlock("view",{class:"comment_container root"},[e.createElementVNode("view",{class:"comment_body"},[e.createElementVNode("view",{class:"left"},[e.createVNode(r,{class:"w-[50px] h-[50px] rounded-[50%] overflow-hidden",src:t.commentData.sysUser.avatar},null,8,["src"])]),e.createElementVNode("view",{class:"right"},[e.createElementVNode("view",{class:"name"},e.toDisplayString(t.commentData.sysUser.nickName),1),e.createElementVNode("view",{class:"commentContent",onLongpress:a},e.toDisplayString(t.commentData.commentContent),33),e.createElementVNode("view",{class:"status"},[e.createElementVNode("view",{class:"time"},e.toDisplayString(t.commentData.createTime)+" · "+e.toDisplayString(t.commentData.sysUser.locationCity),1),t.commentData.level<1?(e.openBlock(),e.createElementBlock("view",{key:0,onClick:i},e.toDisplayString(t.isReply&&t.replyId===t.commentData.parentId?"取消回复":"回复"),1)):e.createCommentVNode("",!0)]),t.commentData.children&&t.commentData.children.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(t.commentData.children,((t,n)=>(e.openBlock(),e.createBlock(oS,{class:"leaf",key:n,commentData:t},null,8,["commentData"])))),128)):e.createCommentVNode("",!0)])])])}}}),[["__scopeId","data-v-9761364f"]]),aS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et();It();const o=e.ref(0),a=e.ref({}),i=e.ref({}),r=e.ref(!0),s=()=>{r.value=!1},l=e.ref(""),c=()=>{uni.navigateBack()},u=e.ref(0),d=e.ref(!1),p=e.ref(""),h=e.ref(!1),f=e=>__async(this,null,(function*(){d.value?g():(d.value=!0,u.value=e.parentId,p.value=e.sysUser.nickName,h.value=!0)})),g=()=>{u.value=0,d.value=!1,p.value="",l.value="",h.value=!1},m=()=>__async(this,null,(function*(){yield(e=>aa.post("/prod-api/app/post/comment",e))(u.value?{parentId:u.value,postId:a.value.id,commentContent:l.value}:{postId:a.value.id,commentContent:l.value}),yield _(),g(),uni.showToast({title:"评论成功！",icon:"none"})})),v=()=>{uni.showToast({title:"长按事件触发",icon:"none"})},_=()=>__async(this,null,(function*(){const{data:e}=yield(t=o.value,aa.get(`/prod-api/app/post/${t}`));var t;a.value=e,i.value=e.sysUser}));return ce((e=>{o.value=e.id,_()})),(t,o)=>{const g=ae(e.resolveDynamicComponent("wd-img"),te),y=ae(e.resolveDynamicComponent("wd-icon"),_e),I=ae(e.resolveDynamicComponent("z-paging"),to),C=ae(e.resolveDynamicComponent("wd-input"),lo),k=ae(e.resolveDynamicComponent("wd-button"),Te);return e.openBlock(),e.createElementBlock("view",{class:"postDetail_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(g,{class:"back",src:"/static/images/back.png",onClick:c}),e.createElementVNode("view",{class:"title"},"动态详情"),e.createVNode(g,{class:"more",src:"/static/images/more.png"})]),e.createElementVNode("view",{class:"body"},[e.createVNode(I,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"detail"},[e.createVNode(nS,{canShare:!1,canNavigate:!1,postData:a.value,userData:i.value,onRefreshData:_},null,8,["postData","userData"])]),e.withDirectives(e.createElementVNode("view",{class:"tip"},[e.createElementVNode("view",null,"长按评论可以举报/删除哦"),e.createVNode(y,{name:"close",size:"12px",onClick:s})],512),[[e.vShow,r.value]]),a.value.postComments&&a.value.postComments.length>0?(e.openBlock(),e.createElementBlock("view",{key:0,class:"comment"},[e.createElementVNode("view",{class:"title"},"全部评论（"+e.toDisplayString(a.value.postComments.length)+"）",1),e.createElementVNode("view",{class:"list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(a.value.postComments,((t,n)=>(e.openBlock(),e.createBlock(oS,{key:n,isReply:d.value,replyId:u.value,commentData:t,onOnOperateComment:v,onOnReplyTargetComment:e=>f(t)},null,8,["isReply","replyId","commentData","onOnReplyTargetComment"])))),128))])])):(e.openBlock(),e.createElementBlock("view",{key:1,class:"noComment"},"暂时没有评论，快来给他/她评论吧~"))])),_:1})]),e.createElementVNode("view",{class:"bottom"},[e.createVNode(C,{modelValue:l.value,"onUpdate:modelValue":o[0]||(o[0]=e=>l.value=e),"prefix-icon":"edit",focus:h.value,placeholder:u.value?`回复：${p.value}`:"主动评论，才能相识~"},null,8,["modelValue","focus","placeholder"]),e.createVNode(k,{style:{width:"60px",background:"linear-gradient(90deg, #fe8574 0%, #fd1674 100%)"},size:"small",onClick:m},{default:e.withCtx((()=>[e.createTextVNode(" 发送 ")])),_:1})])],4)}}}),[["__scopeId","data-v-5b1a346d"]]),iS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=It(),a=Ct(),i=e.reactive({id:0,isOwn:!0}),r=e.ref(!1),s=e.ref({}),l=e.ref({}),c=()=>{uni.navigateBack()},u=()=>{uni.navigateTo({url:"/pages/baseInfo/index?type=edit"})},d=()=>__async(this,null,(function*(){s.value.hasFollow?yield fa(s.value.userId):yield ha(s.value.userId),yield p()})),p=()=>__async(this,null,(function*(){const e=yield(t=i.id,aa.get(`/prod-api/app/user/${t}`));var t;s.value=e.data})),h=()=>{_p.switchConversation(`C2C${s.value.appId}`).then((()=>{uni.navigateTo({url:"/TUIKit/components/TUIChat/index"})}))},f=()=>__async(this,null,(function*(){try{r.value=!0,i.isOwn?s.value=o.userInfo:yield p();const e={};a.dataMap.tags.forEach((t=>{e[t.code]=t.info})),l.value=e,r.value=!1}catch(e){r.value=!1}}));return ce((e=>{i.id=e.id,i.isOwn="own"===e.type})),re((()=>{f()})),(t,o)=>{const a=ae(e.resolveDynamicComponent("wd-img"),te),f=ae(e.resolveDynamicComponent("wd-icon"),_e),g=ae(e.resolveDynamicComponent("wd-loading"),uo),m=ae(e.resolveDynamicComponent("wd-button"),Te),v=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"profile_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(a,{class:"back",src:"/static/images/back.png",onClick:c}),e.createElementVNode("view",{class:"title"},e.toDisplayString(e.unref(i).isOwn?"我的主页":"Ta的主页"),1),e.unref(i).isOwn?(e.openBlock(),e.createElementBlock("view",{key:0,class:"edit",onClick:u},[e.createVNode(f,{class:"mr-2px",name:"edit",size:"13px",color:"#ffffff"}),e.createTextVNode(" 编辑资料 ")])):(e.openBlock(),e.createBlock(a,{key:1,class:"more",src:"/static/images/more.png"}))]),e.createElementVNode("view",{class:"body"},[r.value?(e.openBlock(),e.createBlock(g,{key:0,color:"#fd2b58"})):(e.openBlock(),e.createBlock(v,{key:1,class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createVNode(a,{class:"avatar",src:s.value.avatar},null,8,["src"]),e.createElementVNode("view",{class:"name"},e.toDisplayString(s.value.nickName),1),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"tags"},["1"===s.value.vipOpean?(e.openBlock(),e.createBlock(a,{key:0,class:"icon1",src:"/static/images/vip.png"})):e.createCommentVNode("",!0),"1"===s.value.hasRealName?(e.openBlock(),e.createBlock(a,{key:1,class:"icon2",src:"/static/images/checked.png"})):e.createCommentVNode("",!0),e.createElementVNode("view",{class:e.normalizeClass(["base","1"===s.value.sex?"male":"female"])},[e.createVNode(a,{class:"icon",src:"1"===s.value.sex?"/static/images/male2.png":"/static/images/female2.png"},null,8,["src"]),e.createTextVNode(" "+e.toDisplayString(s.value.age)+"岁 ",1)],2)]),e.createElementVNode("view",{class:"sys"},[e.createElementVNode("view",{class:"ip"}," IP属地："+e.toDisplayString(s.value.locationProvince)+e.toDisplayString(s.value.locationCity),1),e.createElementVNode("view",{class:"id"},"梦缘ID："+e.toDisplayString(s.value.appId),1)]),e.unref(i).isOwn?e.createCommentVNode("",!0):(e.openBlock(),e.createBlock(m,{key:0,class:e.normalizeClass(["w-102px","h-32px","mt-10px",s.value.hasFollow?"btnColor2":"btnColor"]),onClick:d},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(s.value.hasFollow?"取消关注":"关注"),1)])),_:1},8,["class"])),e.createElementVNode("view",{class:"desc mt-10px"},e.toDisplayString(s.value.userDesc),1)]),e.createElementVNode("view",{class:"show"},[e.createElementVNode("view",{class:"tags"},[s.value.clientUserTags.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(s.value.clientUserTags,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"tag",key:n},e.toDisplayString(l.value[t]),1)))),128)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"noTags"},"暂无标签..."))]),e.createElementVNode("view",{class:"pictures"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(s.value.clientUserImages.slice(0,5),((t,n)=>(e.openBlock(),e.createBlock(a,{class:e.normalizeClass(["w-64px h-64px rounded-[5px] overflow-hidden",[4===n?"":"mr-10px"]]),key:n,src:t},null,8,["class","src"])))),128)),e.createElementVNode("view",{class:"mask"},[e.createElementVNode("view",{class:"num"},"+"+e.toDisplayString(s.value.clientUserImages.length),1)])])]),e.createElementVNode("view",{class:"status"},[e.createElementVNode("view",{class:"title"},"状态"),s.value.posts&&s.value.posts.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(s.value.posts,((t,n)=>(e.openBlock(),e.createBlock(nS,{key:n,postData:t,userData:s.value,onRefreshData:p},null,8,["postData","userData"])))),128)):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty"},[e.createVNode(a,{class:"w-200px h-200px",src:"/static/images/empty.png"}),e.createTextVNode(" Ta还未发表过动态 ")]))])])),_:1}))]),r.value||e.unref(i).isOwn?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:0,class:"btn"},[e.createVNode(m,{class:"btnColor w-80%",size:"large",onClick:h},{default:e.withCtx((()=>[e.createTextVNode(" Hi~ 打招呼 ")])),_:1})]))],4)}}}),[["__scopeId","data-v-34677a48"]]),rS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.ref(!0),a=e.ref(""),i=e.ref(!1),r=e.ref([{name:"发布图片",index:"picture"},{name:"发布视频",index:"video"}]),s=e.reactive({postText:"",postMedia:[],latitude:0,longitude:0,location:""}),l=e.ref(!1),c=()=>{l.value=!0,uni.getLocation({type:"wgs84",success:e=>__async(this,null,(function*(){const{data:t}=yield ra({latitude:e.latitude,longitude:e.longitude});s.latitude=e.latitude,s.longitude=e.longitude,s.location=t.locationName,l.value=!1})),fail:e=>{oe("error","at pages/publish/index.vue:107","获取位置信息失败",e)}})},u=()=>{s.postText="",s.postMedia=[],a.value="",o.value=!0,i.value=!1,uni.switchTab({url:"/pages/connect/index"})},d=e=>{s.postMedia=e},p=()=>__async(this,null,(function*(){yield(e=>aa.post("/prod-api/app/post",e))(__spreadValues({location:s.location,latitude:s.latitude,longitude:s.longitude,postText:s.postText},"picture"===a.value?{postImages:s.postMedia.map((e=>e.url))}:{postVideos:s.postMedia.map((e=>e.url))})),uni.showToast({title:"发布成功！",icon:"none"}),u()})),h=({item:e,index:t})=>{o.value=!1,a.value=e.index};return e.onMounted((()=>{uni.hideTabBar({animation:!1})})),re((()=>{i.value=!0})),(t,f)=>{const g=ae(e.resolveDynamicComponent("wd-icon"),_e),m=ae(e.resolveDynamicComponent("wd-button"),Te),v=ae(e.resolveDynamicComponent("wd-textarea"),Vt),_=ae(e.resolveDynamicComponent("z-paging"),to),y=ae(e.resolveDynamicComponent("wd-action-sheet"),xo);return e.openBlock(),e.createElementBlock("view",{class:"publish_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(g,{class:"back",name:"close",size:"16px",onClick:u}),e.createElementVNode("view",{class:"title"},"发帖"),e.createVNode(m,{class:"btnColor w-60px",size:"small",onClick:p},{default:e.withCtx((()=>[e.createTextVNode("发布")])),_:1})]),e.unref(a)?(e.openBlock(),e.createElementBlock("view",{key:0,class:"body"},[e.createVNode(_,{fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createVNode(v,{"show-word-limit":"",maxlength:120,placeholder:"每天发动态，对象找的快~",modelValue:e.unref(s).postText,"onUpdate:modelValue":f[0]||(f[0]=t=>e.unref(s).postText=t)},null,8,["modelValue"]),e.createElementVNode("view",{class:e.normalizeClass(["media",e.unref(a)])},[e.createVNode(Ia,{type:e.unref(a),limit:"picture"===e.unref(a)?9:1,fileList:e.unref(s).postMedia,onUpdateFileList:d},null,8,["type","limit","fileList"])],2),e.createElementVNode("view",{class:"location"},[e.createVNode(m,{size:"small",icon:"location",loading:e.unref(l),class:e.normalizeClass([e.unref(s).location?"active":"inactive"]),onClick:c},{default:e.withCtx((()=>[e.createTextVNode(e.toDisplayString(e.unref(s).location||"你在哪里"),1)])),_:1},8,["loading","class"])])])),_:1})])):(e.openBlock(),e.createBlock(y,{key:1,modelValue:e.unref(i),"onUpdate:modelValue":f[1]||(f[1]=t=>e.isRef(i)?i.value=t:null),"cancel-text":"取消发布",actions:e.unref(r),"close-on-click-modal":!1,onSelect:h,onCancel:u},null,8,["modelValue","actions"])),e.withDirectives(e.createVNode(ai,null,null,512),[[e.vShow,e.unref(o)]])],4)}}}),[["__scopeId","data-v-1034daf3"]]),sS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.reactive({name:"",idcard:"",isCheck:!1}),a=e.computed((()=>o.name&&o.idcard&&o.isCheck)),i=e.ref(!1),r=()=>{i.value=!0},s=()=>__async(this,null,(function*(){yield(({name:e,idcard:t})=>aa.get("/prod-api/common/real-name/verification",{name:e,idcard:t}))({name:encodeURIComponent(o.name),idcard:o.idcard})})),l=()=>{uni.navigateBack()},c=()=>{i.value=!1};return(t,u)=>{const d=ae(e.resolveDynamicComponent("wd-img"),te),p=ae(e.resolveDynamicComponent("wd-input"),lo),h=ae(e.resolveDynamicComponent("wd-text"),me),f=ae(e.resolveDynamicComponent("wd-button"),Te),g=ae(e.resolveDynamicComponent("wd-checkbox"),qo),m=ae(e.resolveDynamicComponent("z-paging"),to),v=ae(e.resolveDynamicComponent("wd-overlay"),io);return e.openBlock(),e.createElementBlock("view",{class:"realcheck_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(d,{class:"back",src:"/static/images/back.png",onClick:r}),e.createElementVNode("view",{class:"title"},"实名认证")]),e.createElementVNode("view",{class:"body"},[e.createVNode(m,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"curPhone"},"认证后你可以获得更多的曝光和推荐"),e.createElementVNode("view",{class:"form"},[e.createElementVNode("view",{class:"formItem"},[e.createElementVNode("view",{class:"label"},[e.createVNode(d,{class:"w-24px h-24px mr-8px",src:"/static/images/user.png"}),e.createTextVNode(" 姓名 ")]),e.createVNode(p,{modelValue:o.name,"onUpdate:modelValue":u[0]||(u[0]=e=>o.name=e),placeholder:"请输入姓名"},null,8,["modelValue"])]),e.createElementVNode("view",{class:"formItem"},[e.createElementVNode("view",{class:"label"},[e.createVNode(d,{class:"w-24px h-24px mr-8px",src:"/static/images/user2.png"}),e.createTextVNode(" 身份证号码 ")]),e.createVNode(p,{type:"number",modelValue:o.idcard,"onUpdate:modelValue":u[1]||(u[1]=e=>o.idcard=e),placeholder:"请输入身份证号码"},null,8,["modelValue"])])]),e.createElementVNode("view",{class:"tip"},[e.createElementVNode("view",{class:"title"},"温馨提示："),e.createVNode(h),e.createVNode(h,{size:"14px",text:"1、根据《互联网直播服务管理规定》《移动互联网应用程序信息服务管理规定》的相关要求，为了提高用户推荐时信息的真实性，保障您或其他用户的安全，或维护功能/服务的安全稳定，需要您提供真实身份信息（真实姓名、身份证件号码、个人生物识别信息）以完成实名认证。现经您主动申请并授权同意，我们将通过第三方服务商提供实名认证验证服务。因个人姓名、身份证号码及个人生物识别信息为个人敏感信息，根据相关法律法规要求，请您仔细阅读以下授权书内容，勾选“我已阅读并同意”完成授权，我们会对信息严格保密，信息将会存储至本账号不再正常使用；\n    2、用户本人主动向平台提供本人个人信息申请实名验证的，须保证提供的为用户本人真实合法有效的身份信息，禁止以任何形式买卖、伪造、篡改、盗用个人信息，请您严肃交友，诚信参与；\n    3、客服电话：**************。",color:"#686A7A"})]),e.createVNode(f,{class:"confirmBtn",block:"",disabled:!e.unref(a),onClick:s},{default:e.withCtx((()=>[e.createTextVNode(" 下一步 ")])),_:1},8,["disabled"]),e.createElementVNode("view",{class:"confirm"},[e.createVNode(g,{modelValue:o.isCheck,"onUpdate:modelValue":u[2]||(u[2]=e=>o.isCheck=e),shape:"square"},null,8,["modelValue"]),e.createElementVNode("view",{class:"content"},[e.createTextVNode(" 我已阅读并同意 "),e.createVNode(h,{text:"《实名认证授权书》",decoration:"underline",color:"#fd2b58",onClick:u[3]||(u[3]=e=>{return t="AUTHORIZATION_LETTER",void uni.navigateTo({url:`/pages/policy/index?code=${t}`});var t})})])])])),_:1})]),e.createVNode(v,{show:e.unref(i),onClick:u[4]||(u[4]=e=>i.value=!1)},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"dialog_wrapper"},[e.createElementVNode("view",{class:"block"},[e.createVNode(d,{class:"w-48px h-48px mt-15px mb-5px",src:"/static/images/bell.png"}),e.createElementVNode("view",{class:"text"},[e.createElementVNode("view",{class:"title"},"真的要离开吗"),e.createElementVNode("view",{class:"desc"},"完成认证可以认识更多实名用户哦~")]),e.createElementVNode("view",{class:"btns"},[e.createVNode(f,{class:"cancel",onClick:l},{default:e.withCtx((()=>[e.createTextVNode("残忍离开")])),_:1}),e.createVNode(f,{class:"confirm",onClick:c},{default:e.withCtx((()=>[e.createTextVNode("继续认证")])),_:1})])])])])),_:1},8,["show"])],4)}}}),[["__scopeId","data-v-c267cfb3"]]),lS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.ref(!1),a=e.ref(""),i=e.ref(null),r=e.ref([]),s=()=>{uni.navigateBack()},l=()=>__async(this,null,(function*(){o.value=!0;const{rows:e}=yield ni({keyWord:a.value});r.value=e,i.value.complete(r.value),o.value=!1}));return re((()=>{l()})),(t,c)=>{const u=ae(e.resolveDynamicComponent("wd-img"),te),d=ae(e.resolveDynamicComponent("wd-search"),Fo),p=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"search_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(u,{class:"back",src:"/static/images/back.png",onClick:s}),e.createVNode(d,{"placeholder-left":"","hide-cancel":"",placeholder:"请输入昵称或用户ID",modelValue:a.value,"onUpdate:modelValue":c[0]||(c[0]=e=>a.value=e),onSearch:l},null,8,["modelValue"])]),e.createElementVNode("view",{class:"list"},[e.createVNode(p,{class:"list_scroll",ref_key:"userListRef",ref:i,modelValue:r.value,"onUpdate:modelValue":c[1]||(c[1]=e=>r.value=e),fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1,"show-loading-more-no-more-view":r.value.length>0,"refresher-complete-text":"刷新完成","refresher-default-text":"下拉刷新","refresher-pulling-text":"释放刷新","refresher-refreshing-text":"加载中...","loading-more-no-more-text":"没有更多数据啦~",onQuery:l},{default:e.withCtx((()=>[!o.value&&r.value.length>0?(e.openBlock(!0),e.createElementBlock(e.Fragment,{key:0},e.renderList(r.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"card",key:n},[e.createVNode(ZT,{userData:t,onClick:e=>{return n=t,void uni.navigateTo({url:`/pages/profile/index?type=other&id=${n.userId}`});var n}},null,8,["userData","onClick"])])))),128)):e.createCommentVNode("",!0),o.value||0!==r.value.length?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("view",{key:1,class:"empty"},[e.createVNode(u,{class:"w-200px h-200px",src:"/static/images/empty.png"}),e.createTextVNode(" 暂无搜索到的用户 ")]))])),_:1},8,["modelValue","show-loading-more-no-more-view"])])],4)}}}),[["__scopeId","data-v-b1829552"]]),cS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=It(),a=e=>{uni.navigateTo({url:`/pages/policy/index?code=${e}`})},i=()=>{o.logout(),uni.reLaunch({url:"/pages/asplash/index"})};return(t,o)=>{const r=ae(e.resolveDynamicComponent("wd-icon"),_e),s=ae(e.resolveDynamicComponent("wd-text"),me),l=ae(e.resolveDynamicComponent("wd-button"),Te),c=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"settings_contianer",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"options"},[e.createVNode(c,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[e.createElementVNode("view",{class:"optWrapper top"},[e.createElementVNode("view",{class:"optItem"},[e.createTextVNode(" 自动回复设置 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem",onClick:o[0]||(o[0]=e=>a("USER_CONDUCT"))},[e.createTextVNode(" 安全指南 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem",onClick:o[1]||(o[1]=e=>a("USER_CONDUCT"))},[e.createTextVNode(" 用户行为规范 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem"},[e.createTextVNode(" 黑名单 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})])]),e.createElementVNode("view",{class:"optWrapper middle"},[e.createElementVNode("view",{class:"optItem",onClick:o[2]||(o[2]=e=>a("INFORMATION_FOR_USERS"))},[e.createTextVNode(" 用户须知 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem",onClick:o[3]||(o[3]=e=>a("PRIVACY_POLICY"))},[e.createTextVNode(" 隐私政策 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem",onClick:o[4]||(o[4]=e=>a("PERMISSION_LIST"))},[e.createTextVNode(" 权限获取清单 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem",onClick:o[5]||(o[5]=e=>a("THIRD_PARTY_SDK_LIST"))},[e.createTextVNode(" 三方SDK清单 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem",onClick:o[6]||(o[6]=e=>a("INFORMATION_SHARING_LIST"))},[e.createTextVNode(" 信息共享清单 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem",onClick:o[7]||(o[7]=e=>a("REGISTRATION_COMMITMENT"))},[e.createTextVNode(" 注册承诺函 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})]),e.createElementVNode("view",{class:"optItem"},[e.createTextVNode(" 系统权限管理 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})])]),e.createElementVNode("view",{class:"optWrapper bottom"},[e.createElementVNode("view",{class:"optItem"},[e.createTextVNode(" 当前版本 "),e.createElementVNode("view",{class:"flex items-center"},[e.createVNode(s,{class:"mr-5px",text:"版本号1.0.0",color:"#FD2B58",size:"14px"}),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})])]),e.createElementVNode("view",{class:"optItem"},[e.createTextVNode(" 注销账号 "),e.createVNode(r,{name:"arrow-right",size:"14px",color:"#9395a4"})])]),e.createVNode(l,{class:"logoutBtn",block:"",onClick:i},{default:e.withCtx((()=>[e.createTextVNode("退出登录")])),_:1})])),_:1})])],4)}}}),[["__scopeId","data-v-fdbde08a"]]),uS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,80,15),o=e.ref("square"),a=e.ref(null),i=e.ref([]),r=()=>__async(this,null,(function*(){const e=yield(t={postType:o.value},aa.get("/prod-api/app/post/list",t));var t;i.value=e.rows,a.value.complete(i.value)}));return e.watch(o,(e=>{r()})),e.onMounted((()=>{uni.hideTabBar({animation:!1})})),(t,s)=>{const l=ae(e.resolveDynamicComponent("wd-tab"),Ba),c=ae(e.resolveDynamicComponent("wd-tabs"),$a),u=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"square_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"tab_wrapper"},[e.createVNode(c,{class:"tab",modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e)},{default:e.withCtx((()=>[e.createVNode(l,{title:"关注",name:"follow"}),e.createVNode(l,{title:"广场",name:"square"}),e.createVNode(l,{title:"同城",name:"sameCity"})])),_:1},8,["modelValue"])]),e.createElementVNode("view",{class:"body"},[e.createVNode(u,{class:"list_scroll",ref_key:"postListRef",ref:a,modelValue:i.value,"onUpdate:modelValue":s[1]||(s[1]=e=>i.value=e),fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1,onQuery:r},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(i.value,((t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"card",key:n},[e.createVNode(nS,{postData:t,userData:t.sysUser,onRefreshData:r},null,8,["postData","userData"])])))),128))])),_:1},8,["modelValue"])]),e.createVNode(ai)],4)}}}),[["__scopeId","data-v-eabe36b4"]]),dS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.ref(""),a=()=>{uni.navigateBack()},i=()=>__async(this,null,(function*(){var e;yield(e={remark:o.value},aa.post("/prod-api/app/advice",e)),uni.showToast({title:"提交成功！",icon:"none",duration:2e3,success:()=>{uni.navigateBack()}})}));return(t,r)=>{const s=ae(e.resolveDynamicComponent("wd-img"),te),l=ae(e.resolveDynamicComponent("wd-textarea"),Vt);return e.openBlock(),e.createElementBlock("view",{class:"suggestion_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(s,{class:"back",src:"/static/images/back.png",onClick:a}),e.createElementVNode("view",{class:"title"},"建议反馈"),e.createElementVNode("view",{class:"manage",onClick:i},"提交")]),e.createElementVNode("view",{class:"content"},[e.createVNode(l,{"custom-class":"textarea",modelValue:o.value,"onUpdate:modelValue":r[0]||(r[0]=e=>o.value=e),placeholder:"请输入您的意见和建议内容"},null,8,["modelValue"])])],4)}}}),[["__scopeId","data-v-9c9ade94"]]),pS=__spreadProps(__spreadValues({},X),{color:String,contentPosition:J("center"),dashed:Boolean,vertical:$(!1),hairline:$(!0)}),hS=ee(e.defineComponent(__spreadProps(__spreadValues({},{name:"wd-divider",options:{virtualHost:!0,addGlobalClass:!0,styleIsolation:"shared"}}),{props:pS,setup(t){const n=t,o=e.useSlots(),a=e.computed((()=>{const{color:e}=n,t={};return e&&(t.color=e),`${P(t)};${n.customStyle}`})),i=e.computed((()=>{const e="wd-divider";return{[e]:!0,"is-dashed":n.dashed,"is-hairline":n.hairline,[`${e}--vertical`]:n.vertical,[`${e}--center`]:!n.vertical&&!!o.default,[`${e}--left`]:!n.vertical&&"left"===n.contentPosition,[`${e}--right`]:!n.vertical&&"right"===n.contentPosition,[n.customClass]:!!n.customClass}}));return(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:e.normalizeClass(i.value),style:e.normalizeStyle(a.value)},[t.vertical?e.createCommentVNode("",!0):e.renderSlot(t.$slots,"default",{key:0},void 0,!0)],6))}})),[["__scopeId","data-v-92b83235"]]),fS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15);return(t,o)=>{const a=ae(e.resolveDynamicComponent("wd-img"),te),i=ae(e.resolveDynamicComponent("wd-divider"),hS);return e.openBlock(),e.createElementBlock("view",{class:"systemauth_contianer",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"link"},[e.createElementVNode("view",{class:"iconBg"},[e.createVNode(a,{class:"w-24px h-24px",src:"/static/images/system1.png"})]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"line1"},"位置"),e.createElementVNode("view",{class:"line2"},"动态中展示位置")])]),e.createElementVNode("view",{class:"link"},[e.createElementVNode("view",{class:"iconBg"},[e.createVNode(a,{class:"w-24px h-24px",src:"/static/images/system2.png"})]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"line1"},"照片"),e.createElementVNode("view",{class:"line2"},"发送相册内的图片与视频等功能")])]),e.createElementVNode("view",{class:"link"},[e.createElementVNode("view",{class:"iconBg"},[e.createVNode(a,{class:"w-24px h-24px",src:"/static/images/system3.png"})]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"line1"},"相机"),e.createElementVNode("view",{class:"line2"},"拍摄后发送图片相亲等功能")])]),e.createVNode(i,null,{default:e.withCtx((()=>[e.createTextVNode("仅展示能查询到的已授权系统权限")])),_:1}),e.createElementVNode("view",{class:"setting"},"前往系统设置")],4)}}}),[["__scopeId","data-v-18167e04"]]),gS=ee(e.defineComponent({__name:"index",setup(t){const n=It(),{pagePadding:o}=Et(0,15,0,15),a=()=>{uni.navigateTo({url:"/pages/bindphone/index"})},i=()=>{uni.navigateTo({url:"/pages/realcheck/index"})};return(t,r)=>{const s=ae(e.resolveDynamicComponent("wd-img"),te),l=ae(e.resolveDynamicComponent("wd-icon"),_e);return e.openBlock(),e.createElementBlock("view",{class:"validate_container",style:e.normalizeStyle({padding:e.unref(o)})},[e.createElementVNode("view",{class:"validate_item"},[e.createElementVNode("view",{class:"iconBg active"},[e.createVNode(s,{class:"w-30px h-30px",src:"/static/images/phone.png"})]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"title active"},"手机绑定（已认证）"),e.createElementVNode("view",{class:"desc"},"防止账号丢失")]),e.createElementVNode("view",{class:"right"},[e.createElementVNode("view",{class:"entry",onClick:a},[e.createElementVNode("view",{class:"text"},"去换绑"),e.createVNode(l,{name:"arrow-right",size:"12px",color:"#fd1674"})]),e.createElementVNode("view",{class:"phone"},e.toDisplayString(e.unref(Sa)(e.unref(n).userInfo.phonenumber)),1)])])]),e.createElementVNode("view",{class:"validate_item"},[e.createElementVNode("view",{class:"iconBg noactive"},[e.createVNode(s,{class:"w-30px h-30px",src:"/static/images/phone.png"})]),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"title noactive"},"实名认证"),e.createElementVNode("view",{class:"desc"},"提高交友成功率")]),e.createElementVNode("view",{class:"right2",onClick:i},[e.createElementVNode("view",{class:"text"},"去认证"),e.createVNode(l,{name:"arrow-right",size:"12px",color:"#fd1674"})])])])],4)}}}),[["__scopeId","data-v-0dc2c126"]]),mS={adv:{label:"首购低至1折, 复购7.5折起! 立即选购",url:"https://cloud.tencent.com/act/pro/imnew?from=16262"},demo:{label:"体验更多Demo",url:"https://cloud.tencent.com/document/product/269/36852"},im:{label:"访问官网",url:"https://cloud.tencent.com/product/im"},privacy:{label:"隐私条例",url:"https://web.sdk.qcloud.com/document/Tencent-IM-Privacy-Protection-Guidelines.html"},agreement:{label:"用户协议",url:"https://web.sdk.qcloud.com/document/Tencent-IM-User-Agreement.html"},product:{label:"产品文档",url:"https://cloud.tencent.com/document/product/269/1499#.E7.BE.A4.E7.BB.84.E5.8A.9F.E8.83.BD"},customMessage:{label:"自定义消息",url:"https://web.sdk.qcloud.com/im/doc/zh-cn/SDK.html#createCustomMessage"},contact:{label:"联系我们",url:"https://cloud.tencent.com/document/product/269/20043"},intl:{label:"国际站",url:"https://web.sdk.qcloud.com/im/demo/en/index.html#/home"},stepList:[{label:"创建项目",url:"https://cloud.tencent.com/document/product/269/68493#.E6.AD.A5.E9.AA.A41.EF.BC.9A.E5.88.9B.E5.BB.BA.E9.A1.B9.E7.9B.AE"},{label:"下载TUIKit组件",url:"https://cloud.tencent.com/document/product/269/68493#.E6.AD.A5.E9.AA.A42.EF.BC.9A.E4.B8.8B.E8.BD.BD-tuikit-.E7.BB.84.E4.BB.B6"},{label:"引入TUIKit组件",url:"https://cloud.tencent.com/document/product/269/68493#.E6.AD.A5.E9.AA.A43.EF.BC.9A.E5.BC.95.E5.85.A5-tuikit-.E7.BB.84.E4.BB.B6"},{label:"获取SDKAppID",url:"https://cloud.tencent.com/document/product/269/68493#.E6.AD.A5.E9.AA.A44.EF.BC.9A-.E8.8E.B7.E5.8F.96-sdkappid-.E3.80.81.E5.AF.86.E9.92.A5.E4.B8.8E-userid"},{label:"调用TUIKit组件",url:"https://cloud.tencent.com/document/product/269/68493#.E6.AD.A5.E9.AA.A45.EF.BC.9A.E8.B0.83.E7.94.A8-tuikit-.E7.BB.84.E4.BB.B6"},{label:"启动项目",url:"https://cloud.tencent.com/document/product/269/68493#.E6.AD.A5.E9.AA.A46.EF.BC.9A.E5.90.AF.E5.8A.A8.E9.A1.B9.E7.9B.AE"},{label:"发送您的第一条消息",url:"https://cloud.tencent.com/document/product/269/68493#.E6.AD.A5.E9.AA.A47.EF.BC.9A.E5.8F.91.E9.80.81.E6.82.A8.E7.9A.84.E7.AC.AC.E4.B8.80.E6.9D.A1.E6.B6.88.E6.81.AF"}],advList:[{label:" IM 首购低至0.9折",subLabel:"复购7.5折起",btnText:"立即选购",url:"https://cloud.tencent.com/act/pro/imnew?from=16262"}]},vS=ee(e.defineComponent({__name:"login",setup(t){const n=e.ref(!1),o=e.ref(""),a=()=>{n.value=!n.value},i=()=>{const e=function(e){const{SDKAppID:t,secretKey:n,userID:o}=e;return{SDKAppID:t,userSig:new Zc(t,n,604800).genTestUserSig(o)}}({SDKAppID:uni.$chat_SDKAppID,secretKey:uni.$chat_secretKey,userID:o.value}),t={SDKAppID:uni.$chat_SDKAppID,userID:o.value,userSig:e.userSig,useUploadPlugin:!0,framework:"vue3",TIMPush:uni.$TIMPush,pushConfig:{androidConfig:uni.$TIMPushConfigs,iOSConfig:{iOSBusinessID:""}}};r(t)},r=e=>{o.value?n.value?(e=>yt.login(e).then((t=>(null==uni||uni.navigateTo({url:"/TUIKit/components/TUIConversation/index",success:()=>{null==uni||uni.$emit("uikitLogin",t)}}),yp.switchUserStatus({displayOnlineStatus:!0}),null==uni||uni.setStorage({key:"userInfo",data:JSON.stringify(__spreadProps(__spreadValues({},e),{TIMPush:void 0,pushConfig:{}}))}),t))))(e).catch((()=>{uni.showToast({title:vp.t("Login.登录失败"),icon:"none"})})):uni.showToast({title:vp.t("Login.请先勾选用户协议"),icon:"none"}):uni.showToast({title:vp.t("Login.请输入userID"),icon:"none"})},s=e=>{var t;Zp||Jp?window.open(e):Qp&&(null==(t=null==plus?void 0:plus.runtime)||t.openURL(e))};return(t,r)=>(e.openBlock(),e.createElementBlock("div",{class:"login-h5"},[e.createElementVNode("main",{class:"login-main"},[e.createElementVNode("div",{class:"login-main-content"},[e.createElementVNode("div",{"label-width":"0",class:"login-form"},[e.createElementVNode("div",{class:"login-title"},[e.createVNode(fh,{file:e.unref("/assets/logo-back.fc67487d.svg"),width:"60px",height:"60px"},null,8,["file"]),e.createElementVNode("p",null,e.toDisplayString(e.unref(vp).t("免费体验")),1)]),e.createElementVNode("div",{class:"login-from-item"},[e.withDirectives(e.createElementVNode("input",{"onUpdate:modelValue":r[0]||(r[0]=t=>e.isRef(o)?o.value=t:null),placeholder:e.unref(vp).t("请输入userID"),type:"string",class:"login-input-uniapp"},null,8,["placeholder"]),[[e.vModelText,e.unref(o)]])]),e.createElementVNode("div",{class:"login-from-item"},[e.createElementVNode("div",{class:"checked-text"},[e.createElementVNode("div",{class:"private-switch",onClick:a},[e.unref(n)?(e.openBlock(),e.createElementBlock("image",{key:0,class:"selected-icon icon-default",src:"/assets/selected.0a1e59e6.svg"})):(e.openBlock(),e.createElementBlock("i",{key:1,class:"icon-unselected icon-default"}))]),e.createElementVNode("div",{class:"private-content"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(vp).t("我已阅读并同意")),1),e.createElementVNode("a",{class:"private-content-link",onClick:r[1]||(r[1]=t=>s(e.unref(mS).privacy.url))}," 《"+e.toDisplayString(e.unref(vp).t(`${e.unref(mS).privacy.label}`))+"》 ",1),e.createTextVNode(" "+e.toDisplayString(e.unref(vp).t("和"))+" ",1),e.createElementVNode("a",{class:"private-content-link",onClick:r[2]||(r[2]=t=>s(e.unref(mS).agreement.url))}," 《"+e.toDisplayString(e.unref(vp).t(`${e.unref(mS).agreement.label}`))+"》 ",1)])])]),e.createElementVNode("div",{class:"login-btn"},[e.createElementVNode("button",{class:"btn btn-primary",onClick:i},e.toDisplayString(e.unref(vp).t("登录")),1)]),e.createElementVNode("footer",{class:"login-form-footer"},[e.createElementVNode("a",{onClick:r[3]||(r[3]=t=>s(e.unref(mS).demo.url))},e.toDisplayString(e.unref(vp).t(`${e.unref(mS).demo.label}`)),1)])])])]),e.createElementVNode("div",{class:"login-footer"},[e.createElementVNode("ul",{class:"login-footer-list"},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(mS).advList,((t,n)=>(e.openBlock(),e.createElementBlock("li",{key:n,class:"login-footer-list-item"},[e.createElementVNode("a",{class:"login-footer-list-item-link",onClick:e=>s(t)},[e.createElementVNode("aside",{class:"aside"},[e.createElementVNode("h1",{class:"h1"},e.toDisplayString(`${t.label}`),1),t.subLabel?(e.openBlock(),e.createElementBlock("h1",{key:0,class:"sub h1"},e.toDisplayString(`${t.subLabel}`),1)):e.createCommentVNode("",!0)]),e.createElementVNode("span",{class:"span"},[e.createElementVNode("text",{class:"text"},e.toDisplayString(e.unref(vp).t(`${t.btnText}`)),1)])],8,["onClick"])])))),128))])])]))}}),[["__scopeId","data-v-5c6cad7a"]]);const _S=ee(e.defineComponent({__name:"profile",props:{displayType:{type:String,default:"all"},showSetting:{type:Boolean,default:!1}},setup(t){const n=e.ref(),o=e.ref({}),a=e.ref({editProfile:{value:"editProfile",label:"编辑资料（暂未开放）",onClick:e=>{oe("warn","at pages/views/profile.vue:166","编辑资料功能努力开发中，敬请期待")}},allowType:{value:"allowType",label:"加我为好友时",selectedChild:"",childrenShowType:"bottomPopup",showChildren:!1,onClick:e=>{Zp||(e.showChildren=!0)},children:{[gp.TYPES.ALLOW_TYPE_ALLOW_ANY]:{value:gp.TYPES.ALLOW_TYPE_ALLOW_ANY,label:"同意任何用户加好友",onClick:e=>{s({allowType:e.value})}},[gp.TYPES.ALLOW_TYPE_NEED_CONFIRM]:{value:gp.TYPES.ALLOW_TYPE_NEED_CONFIRM,label:"需要验证",onClick:e=>{s({allowType:e.value})}},[gp.TYPES.ALLOW_TYPE_DENY_ANY]:{value:gp.TYPES.ALLOW_TYPE_DENY_ANY,label:"拒绝任何人加好友",onClick:e=>{s({allowType:e.value})}}}},displayMessageReadReceipt:{value:"displayMessageReadReceipt",label:"消息阅读状态",selectedChild:"userLevelReadReceiptOpen",childrenShowType:"bottomPopup",showChildren:!1,onClick(e){Zp||(e.showChildren=!0)},children:{userLevelReadReceiptOpen:{value:"userLevelReadReceiptOpen",label:"开启",onClick(){l(!0)}},userLevelReadReceiptClose:{value:"userLevelReadReceiptClose",label:"关闭",onClick(){l(!1)}}}},displayOnlineStatus:{value:"displayOnlineStatus",label:"显示在线状态",selectedChild:"userLevelOnlineStatusOpen",childrenShowType:"bottomPopup",showChildren:!1,onClick(e){Zp||(e.showChildren=!0)},children:{userLevelOnlineStatusOpen:{value:"userLevelOnlineStatusOpen",label:"开启",onClick(){c(!0)}},userLevelOnlineStatusClose:{value:"userLevelOnlineStatusClose",label:"关闭",onClick(){c(!1)}}}},translateLanguage:{value:"translateLanguage",label:"翻译语言",selectedChild:"zh",childrenShowType:"bottomPopup",showChildren:!1,onClick(e){Zp||(e.showChildren=!0)},children:{zh:{value:"zh",label:"中文",onClick(){u("zh")}},en:{value:"en",label:"English",onClick(){u("en")}},jp:{value:"jp",label:"日本語",onClick(){u("jp")}},kr:{value:"kr",label:"한국인",onClick(){u("kr")}}}},exit:{value:"exit",label:"退出登录",onClick:e=>{yt.logout().then((()=>{uni.removeStorage({key:"userInfo"}),new Promise(((e,t)=>{wx.removeStorage({key:"token",success:e,fail:t})})),null==bp||bp.reLaunch({url:"/pages/views/login"})}))}}}),i=e=>{(null==e?void 0:e.onClick)&&"function"==typeof(null==e?void 0:e.onClick)&&e.onClick(e)},r=e=>{var t;return null==(t=null==e?void 0:e.children[null==e?void 0:e.selectedChild])?void 0:t.label},s=e=>{yp.updateMyProfile(e).then((t=>{tf({message:"更新用户资料成功",type:Jh,duration:0}),"allowType"in e&&(a.value.allowType.showChildren=!1)})).catch((e=>{oe("warn","at pages/views/profile.vue:346","更新用户资料失败",e),tf({message:"更新用户资料失败",type:Qh,duration:0})}))};function l(e){mp.update(tu.USER,"displayMessageReadReceipt",e),a.value.displayMessageReadReceipt.showChildren=!1}function c(e){yp.switchUserStatus({displayOnlineStatus:e}),a.value.displayOnlineStatus.showChildren=!1}function u(e){mf.clear(),Ip.setTranslationLanguage(e),a.value.translateLanguage.selectedChild=e,a.value.translateLanguage.showChildren=!1}return mp.watch(tu.USER,{userProfile:e=>{var t,n;o.value=e,(null==(t=null==o?void 0:o.value)?void 0:t.allowType)&&(a.value.allowType.selectedChild=null==(n=null==o?void 0:o.value)?void 0:n.allowType)},displayMessageReadReceipt(e){a.value.displayMessageReadReceipt.selectedChild=e?"userLevelReadReceiptOpen":"userLevelReadReceiptClose"},displayOnlineStatus(e){a.value.displayOnlineStatus.selectedChild=e?"userLevelOnlineStatusOpen":"userLevelOnlineStatusClose"}}),e.onMounted((()=>{yp.getUserProfile().then((e=>{o.value=e.data}))})),se((()=>{var e;for(const t in a.value)(null==(e=null==a?void 0:a.value[t])?void 0:e.hasOwnProperty("showChildren"))&&(a.value[t].showChildren=!1)})),(s,l)=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["TUI-profile",!e.unref(Zp)&&"TUI-profile-h5"])},["setting"!==t.displayType?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["TUI-profile-basic",!e.unref(Zp)&&"TUI-profile-h5-basic"])},[e.createElementVNode("img",{class:e.normalizeClass(["TUI-profile-basic-avatar",!e.unref(Zp)&&"TUI-profile-h5-basic-avatar"]),src:e.unref(o).avatar||"https://web.sdk.qcloud.com/component/TUIKit/assets/avatar_21.png"},null,10,["src"]),e.createElementVNode("div",{class:e.normalizeClass(["TUI-profile-basic-info",!e.unref(Zp)&&"TUI-profile-h5-basic-info"])},[e.createElementVNode("div",{class:e.normalizeClass(["TUI-profile-basic-info-nick",!e.unref(Zp)&&"TUI-profile-h5-basic-info-nick"])},e.toDisplayString(e.unref(o).nick||"-"),3),e.createElementVNode("div",{class:e.normalizeClass(["TUI-profile-basic-info-id",!e.unref(Zp)&&"TUI-profile-h5-basic-info-id"])},[e.createElementVNode("label",{class:e.normalizeClass(["TUI-profile-basic-info-id-label",!e.unref(Zp)&&"TUI-profile-h5-basic-info-id-label"])},e.toDisplayString("用户ID")+": ",2),e.createElementVNode("div",{class:e.normalizeClass(["TUI-profile-basic-info-id-value",!e.unref(Zp)&&"TUI-profile-h5-basic-info-id-value"])},e.toDisplayString(e.unref(o).userID),3)],2)],2)],2)):e.createCommentVNode("",!0),"profile"===t.displayType||e.unref(Zp)&&!t.showSetting?e.createCommentVNode("",!0):(e.openBlock(),e.createElementBlock("div",{key:1,ref_key:"settingDomRef",ref:n,class:e.normalizeClass(["TUI-profile-setting",!e.unref(Zp)&&"TUI-profile-h5-setting"])},[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(e.unref(a),((t,n)=>(e.openBlock(),e.createElementBlock("div",{key:n,class:e.normalizeClass(["TUI-profile-setting-item",!e.unref(Zp)&&"TUI-profile-h5-setting-item","exit"===t.value&&"TUI-profile-h5-setting-item-exit"])},[e.createElementVNode("div",{class:e.normalizeClass(["TUI-profile-setting-item-label",!e.unref(Zp)&&"TUI-profile-h5-setting-item-label"]),onClick:e=>i(t)},[e.createElementVNode("div",{class:e.normalizeClass(["label-left"])},[e.createElementVNode("div",{class:e.normalizeClass(["label-title"])},e.toDisplayString(t.label),1),t.children&&!e.unref(Zp)&&"switch"===t.childrenShowType?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["label-desc"])},e.toDisplayString(t.value),1)):e.createCommentVNode("",!0)]),e.createElementVNode("div",{class:e.normalizeClass(["label-right"])},[!e.unref(Zp)&&t.children&&t.selectedChild&&"bottomPopup"===t.childrenShowType?(e.openBlock(),e.createElementBlock("div",{key:0,class:e.normalizeClass(["TUI-profile-setting-item-label-value",!e.unref(Zp)&&"TUI-profile-h5-setting-item-label-value"])},e.toDisplayString(r(t)),3)):e.createCommentVNode("",!0),t.children?(e.openBlock(),e.createBlock(fh,{key:1,file:e.unref(dy),width:"14px",height:"14px",style:{width:"14px",height:"14px",display:"flex"}},null,8,["file"])):e.createCommentVNode("",!0)])],10,["onClick"]),t.children&&!e.unref(Zp)&&"bottomPopup"===t.childrenShowType?(e.openBlock(),e.createBlock(o_,{key:0,show:t.showChildren,onOnClose:e=>(e=>{e.showChildren=!1})(t)},{default:e.withCtx((()=>[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.children,(t=>(e.openBlock(),e.createElementBlock("div",{class:e.normalizeClass(["TUI-profile-setting-item-bottom-popup",!e.unref(Zp)&&"TUI-profile-h5-setting-item-bottom-popup"]),onClick:e=>i(t)},e.toDisplayString(t.label),11,["onClick"])))),256))])),_:2},1032,["show","onOnClose"])):e.createCommentVNode("",!0)],2)))),128))],2))],2))}}),[["__scopeId","data-v-d3e942be"]]),yS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(),o=e.ref(!1),a=()=>{uni.navigateBack()};return(t,i)=>{const r=ae(e.resolveDynamicComponent("wd-img"),te),s=ae(e.resolveDynamicComponent("wd-button"),Te),l=ae(e.resolveDynamicComponent("wd-checkbox"),qo),c=ae(e.resolveDynamicComponent("wd-text"),me);return e.openBlock(),e.createElementBlock("view",{class:"vip_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(r,{class:"back",src:"/static/images/back.png",onClick:a}),e.createElementVNode("view",{class:"title"},"开通会员")]),e.createElementVNode("view",{class:"info"},[e.createElementVNode("view",{class:"top"},[e.createElementVNode("view",{class:"base"},[e.createVNode(r,{class:"w-56px h-56px",src:"/static/images/image.png"}),e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"name"},"石榴籽儿"),e.createElementVNode("view",{class:"status"},"未开通会员")])]),e.createVNode(r,{class:"diamond w-100px h-100px",src:"/static/images/diamond.png"})]),e.createElementVNode("view",{class:"bottom"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"line1"},"查看/回复全部消息"),e.createElementVNode("view",{class:"line2"},"本产品为自动订阅服务，您可随时取消")]),e.createVNode(s,{class:"colorBtn",size:"small"},{default:e.withCtx((()=>[e.createTextVNode("开通")])),_:1})])]),e.createElementVNode("view",{class:"list_scroll"},[e.createElementVNode("view",{class:"selectItem"},[e.createVNode(r,{class:"selectTag w-52px h-20px",src:"/static/images/viptag.png"}),e.createElementVNode("view",{class:"selectItem_header"},"会员月卡"),e.createElementVNode("view",{class:"selectItem_body"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"amt"},"¥98"),e.createElementVNode("view",{class:"type"},"/月")]),e.createElementVNode("view",{class:"tip"},"体验必选")])]),e.createElementVNode("view",{class:"selectItem active"},[e.createElementVNode("view",{class:"selectItem_header"},"会员季卡"),e.createElementVNode("view",{class:"selectItem_body"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"amt"},"¥268"),e.createElementVNode("view",{class:"type"},"/季度")])])]),e.createElementVNode("view",{class:"selectItem"},[e.createElementVNode("view",{class:"selectItem_header"},"会员半年卡"),e.createElementVNode("view",{class:"selectItem_body"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"amt"},"¥498"),e.createElementVNode("view",{class:"type"},"/6个月")])])]),e.createElementVNode("view",{class:"selectItem"},[e.createElementVNode("view",{class:"selectItem_header"},"会员全年卡"),e.createElementVNode("view",{class:"selectItem_body"},[e.createElementVNode("view",{class:"content"},[e.createElementVNode("view",{class:"amt"},"¥998"),e.createElementVNode("view",{class:"type"},"/12个月")])])])]),e.createElementVNode("view",{class:"selectInfo"},[e.createElementVNode("view",{class:"title"},"含3项特权："),e.createElementVNode("view",{class:"selectInfoItem"},[e.createElementVNode("view",{class:"iconWrapper"},[e.createVNode(r,{class:"w-30px h-30px",src:"/static/images/message.png"})]),e.createElementVNode("view",{class:"selectInfoContent"},[e.createElementVNode("view",{class:"selectInfoContent_title"},"解锁消息功能"),e.createElementVNode("view",{class:"selectInfoContent_desc"},"和Ta聊天不受限制")])]),e.createElementVNode("view",{class:"selectInfoItem"},[e.createElementVNode("view",{class:"iconWrapper"},[e.createVNode(r,{class:"w-30px h-30px",src:"/static/images/message.png"})]),e.createElementVNode("view",{class:"selectInfoContent"},[e.createElementVNode("view",{class:"selectInfoContent_title"},"解锁消息功能"),e.createElementVNode("view",{class:"selectInfoContent_desc"},"和Ta聊天不受限制")])]),e.createElementVNode("view",{class:"selectInfoItem"},[e.createElementVNode("view",{class:"iconWrapper"},[e.createVNode(r,{class:"w-30px h-30px",src:"/static/images/message.png"})]),e.createElementVNode("view",{class:"selectInfoContent"},[e.createElementVNode("view",{class:"selectInfoContent_title"},"解锁消息功能"),e.createElementVNode("view",{class:"selectInfoContent_desc"},"和Ta聊天不受限制")])])]),e.createVNode(s,{class:"confirmBtn",block:""},{default:e.withCtx((()=>[e.createTextVNode("¥268 立即开通")])),_:1}),e.createElementVNode("view",{class:"policy"},[e.createVNode(l,{modelValue:o.value,"onUpdate:modelValue":i[0]||(i[0]=e=>o.value=e),shape:"square"},null,8,["modelValue"]),e.createElementVNode("view",{class:"content"},"请阅读并同意连续签订协议，¥268/月成为月度会员")]),e.createElementVNode("view",{class:"bottom"},[e.createVNode(c,{size:"12px",text:"联系我们",decoration:"underline"}),e.createElementVNode("view",{class:"divider"}),e.createVNode(c,{size:"12px",text:"会员协议",decoration:"underline"}),e.createElementVNode("view",{class:"divider"}),e.createVNode(c,{size:"12px",text:"隐私政策",decoration:"underline"})])],4)}}}),[["__scopeId","data-v-b4e35b70"]]),IS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=()=>{uni.navigateBack()};return(t,a)=>{const i=ae(e.resolveDynamicComponent("wd-img"),te),r=ae(e.resolveDynamicComponent("wd-button"),Te),s=ae(e.resolveDynamicComponent("z-paging"),to);return e.openBlock(),e.createElementBlock("view",{class:"wallet_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(i,{class:"back",src:"/static/images/back.png",onClick:o}),e.createElementVNode("view",{class:"title"},"我的钱包")]),e.createElementVNode("view",{class:"money"},[e.createElementVNode("view",{class:"left"},[e.createElementVNode("view",{class:"title"},"余额（元）"),e.createElementVNode("view",{class:"amt"},"0.00")]),e.createElementVNode("view",{class:"right"},[e.createVNode(r,{class:"btnColor",size:"small"},{default:e.withCtx((()=>[e.createTextVNode("提现")])),_:1})])]),e.createElementVNode("view",{class:"body"},[e.createElementVNode("view",{class:"title"},"钱包变动明细"),e.createVNode(s,{class:"list_scroll",fixed:!1,"scroll-y":!0,"scroll-view":!0,"show-scrollbar":!1},{default:e.withCtx((()=>[(e.openBlock(),e.createElementBlock("view",{key:0,class:"empty"},[e.createVNode(i,{class:"w-200px h-200px",src:"/static/images/empty.png"}),e.createTextVNode(" 暂无明细 ")]))])),_:1})])],4)}}}),[["__scopeId","data-v-694d6896"]]),CS=ee(e.defineComponent({__name:"index",setup(t){const{pagePadding:n}=Et(0,15,0,15),o=e.ref(""),a=e.reactive({wechat:!1,alipay:!1}),i=()=>{uni.navigateBack()},r=e=>{Object.keys(a).forEach((t=>{a[t]=t===e}))};return(t,s)=>{const l=ae(e.resolveDynamicComponent("wd-img"),te),c=ae(e.resolveDynamicComponent("wd-input"),lo),u=ae(e.resolveDynamicComponent("wd-button"),Te);return e.openBlock(),e.createElementBlock("view",{class:"withdraw_container",style:e.normalizeStyle({padding:e.unref(n)})},[e.createElementVNode("view",{class:"header"},[e.createVNode(l,{class:"back",src:"/static/images/back.png",onClick:i}),e.createElementVNode("view",{class:"title"},"提现")]),e.createElementVNode("view",{class:"money"},[e.createElementVNode("view",{class:"title"},"提现金额"),e.createVNode(c,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=e=>o.value=e),"use-prefix-slot":"",placeholder:"请输入提现金额"},{prefix:e.withCtx((()=>[e.createElementVNode("view",{class:"icon"},"￥")])),_:1},8,["modelValue"]),e.createElementVNode("view",{class:"desc"},"提现金额:¥50,000(即到账金额，当日最高可提现¥10,000)")]),e.createElementVNode("view",{class:"body"},[e.createElementVNode("view",{class:"title"},"提现方式"),e.createElementVNode("view",{class:"detailItem"},[e.createElementVNode("view",{class:"detailItem_left"},[e.createVNode(l,{class:"w-32px h-32px",src:"/static/images/wechat.png"}),e.createElementVNode("view",{class:"payment"},"微信")]),e.createElementVNode("view",{class:e.normalizeClass(["checkbox",e.unref(a).wechat?"active":"noactive"]),onClick:s[1]||(s[1]=e=>r("wechat"))},[e.withDirectives(e.createVNode(l,{class:"w-18px h-18px",src:"/static/images/check.png"},null,512),[[e.vShow,e.unref(a).wechat]])],2)]),e.createElementVNode("view",{class:"detailItem"},[e.createElementVNode("view",{class:"detailItem_left"},[e.createVNode(l,{class:"w-32px h-32px",src:"/static/images/alipay.png"}),e.createElementVNode("view",{class:"payment"},"支付宝")]),e.createElementVNode("view",{class:e.normalizeClass(["checkbox",e.unref(a).alipay?"active":"noactive"]),onClick:s[2]||(s[2]=e=>r("alipay"))},[e.withDirectives(e.createVNode(l,{class:"w-18px h-18px",src:"/static/images/check.png"},null,512),[[e.vShow,e.unref(a).alipay]])],2)])]),e.createElementVNode("view",{class:"tip"},[e.createElementVNode("view",{class:"tip_title"},"温馨提示："),e.createElementVNode("view",{class:"tip_desc"},"您发起的提现申请会在2-3个工作日审核完成，请耐心等待。")]),e.createVNode(u,{class:"confirmBtn",block:""},{default:e.withCtx((()=>[e.createTextVNode("立即提现")])),_:1})],4)}}}),[["__scopeId","data-v-c0a833f1"]]),kS=ee(e.defineComponent({__name:"video-play",setup(t){const n=e.ref(),o=e.ref(!1),a=e.ref();return ce((e=>{const t=decodeURIComponent(null==e?void 0:e.videoUrl);n.value=t,o.value=!0})),ue((()=>{o.value=!0,a.value=bp.createVideoContext("videoEle")})),(t,a)=>(e.openBlock(),e.createElementBlock("div",{class:"dialog-video"},[e.unref(o)?(e.openBlock(),e.createElementBlock("video",{key:0,id:"videoEle",class:"video-box",src:e.unref(n),controls:"",autoplay:""},null,8,["src"])):e.createCommentVNode("",!0)]))}}),[["__scopeId","data-v-620b9795"]]),ES=e.defineComponent({__name:"web-view",setup(t){const n=e.ref("");return ce((e=>{n.value=e&&e.url})),(t,o)=>(e.openBlock(),e.createElementBlock("web-view",{src:e.unref(n)},null,8,["src"]))}});__definePage("pages/asplash/index",Tt),__definePage("pages/autoapply/index",ro),__definePage("pages/baseInfo/index",Ca),__definePage("pages/bindphone/index",ba),__definePage("pages/block/index",Na),__definePage("pages/connect/index",fi),__definePage("pages/connectus/index",gi),__definePage("pages/invite/index",mi),__definePage("pages/inviteList/index",_i),__definePage("pages/login/index",qT),__definePage("pages/message/index",KT),__definePage("pages/notice/index",$T),__definePage("pages/own/index",WT),__definePage("pages/person/index",JT),__definePage("pages/policy/index",XT),__definePage("pages/postDetail/index",aS),__definePage("pages/profile/index",iS),__definePage("pages/publish/index",rS),__definePage("pages/realcheck/index",sS),__definePage("pages/search/index",lS),__definePage("pages/settings/index",cS),__definePage("pages/square/index",uS),__definePage("pages/suggestion/index",dS),__definePage("pages/systemauth/index",fS),__definePage("pages/validate/index",gS),__definePage("pages/views/login",vS),__definePage("pages/views/profile",_S),__definePage("pages/vip/index",yS),__definePage("pages/wallet/index",IS),__definePage("pages/withdraw/index",CS),__definePage("TUIKit/components/TUIConversation/index",Sy),__definePage("TUIKit/components/TUIChat/index",b_),__definePage("TUIKit/components/TUIContact/index",qy),__definePage("TUIKit/components/TUIChat/video-play",kS),__definePage("TUIKit/components/TUIChat/web-view",ES),__definePage("TUIKit/components/TUIGroup/index",uI),__definePage("TUIKit/components/TUISearch/index",fy);const TS=e.defineComponent({__name:"App",setup:e=>(le((()=>{HT()})),()=>{})}),SS={invoke({url:e}){const t=e.split("?")[0];let n=[];n=Ta;if(!n.includes(t))return!0;if(It().isLogined)return!0;const o=`/pages/login/index?redirect=${encodeURIComponent(e)}`;return uni.navigateTo({url:o}),!1}},MS={install(){uni.addInterceptor("navigateTo",SS),uni.addInterceptor("reLaunch",SS),uni.addInterceptor("redirectTo",SS),uni.addInterceptor("switchTab",SS)}};var wS=Object.prototype.hasOwnProperty,bS=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}(),DS=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},o=0;o<e.length;++o)void 0!==e[o]&&(n[o]=e[o]);return n},NS={arrayToObject:DS,assign:function(e,t){return Object.keys(t).reduce((function(e,n){return e[n]=t[n],e}),e)},compact:function(e){for(var t=[{obj:{o:e},prop:"o"}],n=[],o=0;o<t.length;++o)for(var a=t[o],i=a.obj[a.prop],r=Object.keys(i),s=0;s<r.length;++s){var l=r[s],c=i[l];"object"==typeof c&&null!==c&&-1===n.indexOf(c)&&(t.push({obj:i,prop:l}),n.push(c))}return function(e){for(var t;e.length;){var n=e.pop();if(t=n.obj[n.prop],Array.isArray(t)){for(var o=[],a=0;a<t.length;++a)void 0!==t[a]&&o.push(t[a]);n.obj[n.prop]=o}}return t}(t)},decode:function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(vs){return e}},encode:function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",o=0;o<t.length;++o){var a=t.charCodeAt(o);45===a||46===a||95===a||126===a||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?n+=t.charAt(o):a<128?n+=bS[a]:a<2048?n+=bS[192|a>>6]+bS[128|63&a]:a<55296||a>=57344?n+=bS[224|a>>12]+bS[128|a>>6&63]+bS[128|63&a]:(o+=1,a=65536+((1023&a)<<10|1023&t.charCodeAt(o)),n+=bS[240|a>>18]+bS[128|a>>12&63]+bS[128|a>>6&63]+bS[128|63&a])}return n},isBuffer:function(e){return null!=e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))},isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},merge:function e(t,n,o){if(!n)return t;if("object"!=typeof n){if(Array.isArray(t))t.push(n);else{if(!t||"object"!=typeof t)return[t,n];(o&&(o.plainObjects||o.allowPrototypes)||!wS.call(Object.prototype,n))&&(t[n]=!0)}return t}if(!t||"object"!=typeof t)return[t].concat(n);var a=t;return Array.isArray(t)&&!Array.isArray(n)&&(a=DS(t,o)),Array.isArray(t)&&Array.isArray(n)?(n.forEach((function(n,a){if(wS.call(t,a)){var i=t[a];i&&"object"==typeof i&&n&&"object"==typeof n?t[a]=e(i,n,o):t.push(n)}else t[a]=n})),t):Object.keys(n).reduce((function(t,a){var i=n[a];return wS.call(t,a)?t[a]=e(t[a],i,o):t[a]=i,t}),a)}},RS=String.prototype.replace,LS=/%20/g,AS={default:"RFC3986",formatters:{RFC1738:function(e){return RS.call(e,LS,"+")},RFC3986:function(e){return String(e)}},RFC1738:"RFC1738",RFC3986:"RFC3986"},OS=NS,PS=AS,US={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},xS=Array.isArray,VS=Array.prototype.push,BS=function(e,t){VS.apply(e,xS(t)?t:[t])},GS=Date.prototype.toISOString,FS={delimiter:"&",encode:!0,encoder:OS.encode,encodeValuesOnly:!1,serializeDate:function(e){return GS.call(e)},skipNulls:!1,strictNullHandling:!1},zS=function e(t,n,o,a,i,r,s,l,c,u,d,p){var h=t;if("function"==typeof s?h=s(n,h):h instanceof Date&&(h=u(h)),null===h){if(a)return r&&!p?r(n,FS.encoder):n;h=""}if("string"==typeof h||"number"==typeof h||"boolean"==typeof h||OS.isBuffer(h))return r?[d(p?n:r(n,FS.encoder))+"="+d(r(h,FS.encoder))]:[d(n)+"="+d(String(h))];var f,g=[];if(void 0===h)return g;if(xS(s))f=s;else{var m=Object.keys(h);f=l?m.sort(l):m}for(var v=0;v<f.length;++v){var _=f[v];i&&null===h[_]||(xS(h)?BS(g,e(h[_],o(n,_),o,a,i,r,s,l,c,u,d,p)):BS(g,e(h[_],n+(c?"."+_:"["+_+"]"),o,a,i,r,s,l,c,u,d,p)))}return g},HS=NS,jS=Object.prototype.hasOwnProperty,qS={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:HS.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},KS=function(e,t,n){if(e){var o=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,a=/(\[[^[\]]*])/g,i=/(\[[^[\]]*])/.exec(o),r=i?o.slice(0,i.index):o,s=[];if(r){if(!n.plainObjects&&jS.call(Object.prototype,r)&&!n.allowPrototypes)return;s.push(r)}for(var l=0;null!==(i=a.exec(o))&&l<n.depth;){if(l+=1,!n.plainObjects&&jS.call(Object.prototype,i[1].slice(1,-1))&&!n.allowPrototypes)return;s.push(i[1])}return i&&s.push("["+o.slice(i.index)+"]"),function(e,t,n){for(var o=t,a=e.length-1;a>=0;--a){var i,r=e[a];if("[]"===r&&n.parseArrays)i=[].concat(o);else{i=n.plainObjects?Object.create(null):{};var s="["===r.charAt(0)&&"]"===r.charAt(r.length-1)?r.slice(1,-1):r,l=parseInt(s,10);n.parseArrays||""!==s?!isNaN(l)&&r!==s&&String(l)===s&&l>=0&&n.parseArrays&&l<=n.arrayLimit?(i=[])[l]=o:"__proto__"!==s&&(i[s]=o):i={0:o}}o=i}return o}(s,t,n)}};const YS=He({formats:AS,parse:function(e,t){var n=t?HS.assign({},t):{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.ignoreQueryPrefix=!0===n.ignoreQueryPrefix,n.delimiter="string"==typeof n.delimiter||HS.isRegExp(n.delimiter)?n.delimiter:qS.delimiter,n.depth="number"==typeof n.depth?n.depth:qS.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:qS.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:qS.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:qS.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:qS.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:qS.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:qS.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:qS.strictNullHandling,""===e||null==e)return n.plainObjects?Object.create(null):{};for(var o="string"==typeof e?function(e,t){for(var n={},o=t.ignoreQueryPrefix?e.replace(/^\?/,""):e,a=t.parameterLimit===1/0?void 0:t.parameterLimit,i=o.split(t.delimiter,a),r=0;r<i.length;++r){var s,l,c=i[r],u=c.indexOf("]="),d=-1===u?c.indexOf("="):u+1;-1===d?(s=t.decoder(c,qS.decoder),l=t.strictNullHandling?null:""):(s=t.decoder(c.slice(0,d),qS.decoder),l=t.decoder(c.slice(d+1),qS.decoder)),jS.call(n,s)?n[s]=[].concat(n[s]).concat(l):n[s]=l}return n}(e,n):e,a=n.plainObjects?Object.create(null):{},i=Object.keys(o),r=0;r<i.length;++r){var s=i[r],l=KS(s,o[s],n);a=HS.merge(a,l,n)}return HS.compact(a)},stringify:function(e,t){var n=e,o=t?OS.assign({},t):{};if(null!==o.encoder&&void 0!==o.encoder&&"function"!=typeof o.encoder)throw new TypeError("Encoder has to be a function.");var a=void 0===o.delimiter?FS.delimiter:o.delimiter,i="boolean"==typeof o.strictNullHandling?o.strictNullHandling:FS.strictNullHandling,r="boolean"==typeof o.skipNulls?o.skipNulls:FS.skipNulls,s="boolean"==typeof o.encode?o.encode:FS.encode,l="function"==typeof o.encoder?o.encoder:FS.encoder,c="function"==typeof o.sort?o.sort:null,u=void 0!==o.allowDots&&o.allowDots,d="function"==typeof o.serializeDate?o.serializeDate:FS.serializeDate,p="boolean"==typeof o.encodeValuesOnly?o.encodeValuesOnly:FS.encodeValuesOnly;if(void 0===o.format)o.format=PS.default;else if(!Object.prototype.hasOwnProperty.call(PS.formatters,o.format))throw new TypeError("Unknown format option provided.");var h,f,g=PS.formatters[o.format];"function"==typeof o.filter?n=(f=o.filter)("",n):xS(o.filter)&&(h=f=o.filter);var m,v=[];if("object"!=typeof n||null===n)return"";m=o.arrayFormat in US?o.arrayFormat:"indices"in o?o.indices?"indices":"repeat":"indices";var _=US[m];h||(h=Object.keys(n)),c&&h.sort(c);for(var y=0;y<h.length;++y){var I=h[y];r&&null===n[I]||BS(v,zS(n[I],I,_,i,r,s?l:null,f,c,u,d,g,p))}var C=v.join(a),k=!0===o.addQueryPrefix?"?":"";return C.length>0?k+C:""}}),$S=(()=>{let e="http://app.shanghaimy.cn";if(oa){const{miniProgram:{envVersion:t}}=uni.getAccountInfoSync();switch(t){case"develop":case"trial":case"release":e="http://app.shanghaimy.cn"}}return e})(),WS={invoke(e){if(e.query){const t=YS.stringify(e.query);e.url.includes("?")?e.url+=`&${t}`:e.url+=`?${t}`}e.url.startsWith("http")||(e.url=$S+e.url),e.timeout=3e4,e.header=__spreadValues({platform:"app"},e.header);const t=It();t.token&&(e.header.Authorization=`Bearer ${t.token}`)}},ZS={install(){uni.addInterceptor("request",WS),uni.addInterceptor("uploadFile",WS)}},JS={install(){"function"!=typeof Array.prototype.at&&(Array.prototype.at=function(e){return e<0?this[this.length+e]:e>=this.length?void 0:this[e]})}};const{app:XS,Vuex:QS,Pinia:eM}=function(){const t=e.createVueApp(TS);return t.use(kt),t.use(MS),t.use(ZS),t.use(JS),{app:t}}();uni.Vuex=QS,uni.Pinia=eM,XS.provide("__globalStyles",__uniConfig.styles),XS._component.mpType="app",XS._component.render=()=>{},XS.mount("#app")}(Vue);
